2013-03-11  Glenn Morris  <rgm@gnu.org>

	* Merge in all changes up to version 24.3 release.

2013-03-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* recentf.el (recentf-save-file): Use locate-user-emacs-file (bug#13870).

2013-03-11  Thierry Volpiatto  <thierry.volpiatto@gmail.com>

	* net/net-utils.el (net-utils-remove-ctrl-m-filter):
	Use with-current-buffer and don't move point.
	(net-utils-run-simple): Remove useless code.
	(net-utils-remove-ctl-m): Remove unused custom.

2013-03-11  Per Starbäck  <starback@stp.lingfil.uu.se>

	* international/characters.el (glyphless-set-char-table-range): New fun.
	(update-glyphless-char-display): Use it (bug#13744).

2013-03-11  Teodor Zlatanov  <tzz@lifelogs.com>

	* progmodes/cfengine.el: Update for CFEngine 3.4.2 and higher:
	namespaces in the syntax, indent closer for hanging brace
	correctly, allow single-quote delimited 'strings', and make
	`cfengine3-mode' the default.

2013-03-11  Jean-Philippe Gravel  <jpgravel@gmail.com>

	* progmodes/gdb-mi.el: Speed up initialization (bug#10580).
	Use lexical-binding.  Fix up docstring according to conventions.
	(gdbmi-debug-mode): New var.
	(gdbmi-start-with, gdbmi-same-start, gdbmi-is-number, gdbmi-bnf-init)
	(gdbmi-bnf-output, gdbmi-bnf-skip-unrecognized, gdbmi-bnf-gdb-prompt)
	(gdbmi-bnf-result-record, gdbmi-bnf-out-of-band-record)
	(gdbmi-bnf-async-record, gdbmi-bnf-stream-record)
	(gdbmi-bnf-console-stream-output, gdbmi-bnf-target-stream-output)
	(gdbmi-bnf-log-stream-output, gdbmi-bnf-result-and-async-record-impl)
	(gdbmi-bnf-incomplete-record-result): New functions.
	(gdb-car<): Remove function.
	(gdbmi-record-list): Remove variable.
	(gdbmi-bnf-state, gdbmi-bnf-offset): New vars.
	(gdbmi-bnf-result-state-configs): New const.
	(gud-gdbmi-marker-filter): Rewrite.
	(gdb-ignored-notification, gdb-thread-created, gdb-thread-exited)
	(gdb-thread-selected, gdb-running, gdb-starting, gdb-stopped):
	Add `token' argument.
	(gdb-done, gdb-error): New functions.
	(gdb-done-or-error): Add `is-complete' argument.  Change arg order.

2013-03-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* term/xterm.el (xterm--report-background-handler): Don't burp
	upon timeout.
	(xterm--version-handler): Extract from terminal-init-xterm.
	(xterm--query): Don't mishandle timeout.  Remove debugging messages.
	Allow multiple handlers.
	(terminal-init-xterm): Handle OSX's Terminal.app's incorrect answer.

	* term/xterm.el: Don't discard input (bug#6758).  Use lexical-binding.
	(xterm--report-background-handler, xterm--query): New functions.
	(terminal-init-xterm): Use them.

2013-03-11  Michael R. Mauger  <michael@mauger.com>

	* progmodes/sql.el: Version 3.2
	Please note that my address changed to <michael@mauger.com>;
	the <mmaug@yahoo.com> address remains active.
	(sql-connection-alist): Updates documentation to fix bug#13715.
	(sql-connect): Handle missing `sql-connection-alist' correctly.
	(sql-mode-oracle-font-lock-keywords): Add missing keywords.
	(sql-magic-go, sql-magic-semicolon): Mark with `delete-selection'
	property.
	(sql-default-value): New function.
	(sql-get-login-ext, sql-get-login): Fixes bug where buffer-local
	values were not used.
	(sql-rename-buffer): Make sure alternate buffer name has no text
	properties.
	(sql-input-sender, sql-execute-feature): Fetch variable with
	`buffer-local-value' rather than `with-current-buffer'.
	(sql-*): Use #' function syntax consistently.
	(sql-*): Use message/error/user-error consistently.

2013-03-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* xt-mouse.el (xterm-mouse-event-read): Remove.
	(xterm-mouse--read-event-sequence-1000)
	(xterm-mouse--read-event-sequence-1006): Use read-event instead.

2013-03-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* term/xterm.el (xterm-function-map): Support format used with
	formatOtherKeys=1 (bug#13839).

	* emacs-lisp/byte-run.el (dont-compile): Declare obsolete.
	(with-no-warnings): Use `declare'.

	* whitespace.el (whitespace-enable-predicate): New variable.
	(whitespace-enable-predicate): Use it.

	* comint.el (comint-send-input, comint-snapshot-last-prompt)
	(comint-output-filter, comint-update-fence):
	Use with-silent-modifications.

2013-03-10  Jambunathan K  <kjambunathan@gmail.com>

	* replace.el (occur-read-regexp-defaults-function): New var.
	(occur-read-regexp-defaults): New defun.
	(occur-read-primary-args): Propagate above change (bug#13892).

2013-03-09  Stefan Monnier  <monnier@iro.umontreal.ca>

	* mouse.el (mouse-drag-track): Remove left-over debugging code.

2013-03-09  Michael Albinus  <michael.albinus@gmx.de>

	Major rewrite due to changed D-Bus interface of GVFS 1.14.

	* net/tramp-gvfs.el (top): Extend check for gvfs availability.
	(tramp-gvfs-methods-mounttracker, tramp-gvfs-listmounts)
	(tramp-gvfs-mountlocation, tramp-gvfs-mountlocation-signature):
	New defconst.
	(tramp-gvfs-file-name-handler-alist) [directory-files]
	[directory-files-and-attributes, file-exists-p, file-modes]:
	Use Tramp default handler.
	[file-acl, file-selinux-context, process-file, set-file-acl]:
	[set-file-modes, set-file-selinux-context, shell-command]:
	[start-file-process]: Remove handler.
	[verify-visited-file-modtime]: New handler.
	(tramp-gvfs-dbus-string-to-byte-array)
	(tramp-gvfs-dbus-byte-array-to-string): New defuns.  Replace all
	calls of `dbus-string-to-byte-array' and
	`tramp-gvfs-dbus-byte-array-to-string'.
	(tramp-gvfs-handle-copy-file)
	(tramp-gvfs-handle-delete-directory)
	(tramp-gvfs-handle-delete-file, tramp-gvfs-handle-file-attributes)
	(tramp-gvfs-handle-file-directory-p)
	(tramp-gvfs-handle-file-executable-p)
	(tramp-gvfs-handle-file-name-all-completions)
	(tramp-gvfs-handle-file-readable-p)
	(tramp-gvfs-handle-file-writable-p)
	(tramp-gvfs-handle-insert-directory)
	(tramp-gvfs-handle-insert-file-contents)
	(tramp-gvfs-handle-make-directory, tramp-gvfs-handle-rename-file)
	(tramp-gvfs-handle-set-visited-file-modtime)
	(tramp-gvfs-handle-write-region): Rewrite.
	(tramp-gvfs-handle-file-acl)
	(tramp-gvfs-handle-file-selinux-context)
	(tramp-gvfs-handle-process-file, tramp-gvfs-handle-set-file-acl)
	(tramp-gvfs-handle-set-file-modes)
	(tramp-gvfs-handle-set-file-selinux-context)
	(tramp-gvfs-handle-shell-command)
	(tramp-gvfs-handle-start-file-process)
	(tramp-gvfs-handle-verify-visited-file-modtime): Remove defuns.
	(tramp-gvfs-url-file-name): Do not use `file-truename', we work
	over the symlinks.  Fix user handling.
	(top, tramp-gvfs-handler-mounted-unmounted): Handle different names
	of the D-Bus signals.
	(tramp-gvfs-connection-mounted-p): Handle different names of the
	D-Bus methods.
	(tramp-gvfs-mount-spec-entry): New defun.
	(tramp-gvfs-mount-spec): Use it.
	(tramp-gvfs-maybe-open-connection): Check, that in case of "smb"
	there is a share name.  Handle different names of the D-Bus
	signals and methods.  Set connection properties needed for
	`tramp-check-cached-permissions'.
	(tramp-gvfs-send-command): Apply `tramp-gvfs-maybe-open-connection'.
	Return t or nil.

	* net/tramp.el (tramp-backtrace): Move up.
	(tramp-error): Dump a backtrace into the debug buffer when
	`tramp-verbose > 9.
	(tramp-file-mode-type-map, tramp-file-mode-from-int)
	(tramp-file-mode-permissions, tramp-get-local-uid)
	(tramp-get-local-gid, tramp-check-cached-permissions): Move from
	tramp-sh.el.

	* net/tramp-sh.el (tramp-file-mode-type-map)
	(tramp-check-cached-permissions, tramp-file-mode-from-int)
	(tramp-file-mode-permissions, tramp-get-local-uid)
	(tramp-get-local-gid): Move to tramp.el.

2013-03-09  Stefan Monnier  <monnier@iro.umontreal.ca>

	Separate mouse-1-click-follows-link from mouse-drag-region.
	* mouse.el (mouse--down-1-maybe-follows-link): New function.
	(key-translation-map): Use it to implement mouse-1-click-follows-link.
	(mouse-drag-line, mouse-drag-track):
	Remove mouse-1-click-follows-link code.
	(mouse--remap-link-click-p): Remove.

2013-03-08  Jambunathan K  <kjambunathan@gmail.com>

	* hi-lock.el (hi-lock-read-regexp-defaults-function): New var.
	(hi-lock-read-regexp-defaults): New defun.
	(hi-lock-line-face-buffer, hi-lock-face-buffer)
	(hi-lock-face-phrase-buffer): Propagate above change.
	Update docstring (bug#13892).

	* subr.el (find-tag-default-as-regexp): New defun.
	* replace.el (read-regexp): Propagate above change.

2013-03-08  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-units.el (calc-convert-units): Fix the way that default
	new units are stored.

2013-03-07  Matthias Meulien  <orontee@gmail.com>

	* bookmark.el: Define a face to highlight bookmark names in
	bookmark menu buffers, where the default is a bold face similarly
	to buffer names in buffer menu buffers.
	(bookmark-menu-bookmark): New face to highlight bookmark names.
	(bookmark-insert-location): Remove duplicated text property to
	conform to buffer list (see `list-buffers').
	(bookmark-bmenu-list, bookmark-bmenu-hide-filenames): Apply face
	`bookmark-menu-bookmark' to bookmark names.

2013-03-07  Matthias Meulien  <orontee@gmail.com>
	    Karl Fogel  <kfogel@red-bean.com>

	* bookmark.el: Display the bookmark list header similarly to the
	buffer list header (see `list-buffers'), where the default is now
	an immovable/immutable header line.
	(bookmark-bmenu-use-header-line): New variable.
	(bookmark-bmenu-inline-header-height): New name for
	`bookmark-bmenu-header-height', to avoid confusion with the code
	for the new immovable header.  All references changed.
	(bookmark-bmenu-set-header): New function.
	(bookmark-bmenu-list, bookmark-bmenu-toggle-filenames):
	Conditionalize header construction accordingly.
	(bookmark-bmenu-ensure-position): Conditionalize the skipping of
	the inline header height.
	(bookmark-bmenu-show-filenames, bookmark-bmenu-hide-filenames):
	Conditionalize the skipping of the inline header height.

2013-03-07  Dmitry Gutov  <dgutov@yandex.ru>

	* progmodes/js.el (js--multi-line-declaration-indentation):
	Merge from js2-mode (https://github.com/mooz/js2-mode/issues/89).

2013-03-06  Dmitry Gutov  <dgutov@yandex.ru>

	* progmodes/ruby-mode.el (ruby-syntax-propertize-function):
	Only propertize regexp when not inside a string (Bug#13885).

2013-03-06  Alan Mackenzie  <acm@muc.de>

	Correct the position of point in some line-up functions.
	* progmodes/cc-align.el (c-lineup-whitesmith-in-block)
	(c-lineup-assignments, c-lineup-gcc-asm-reg ): Take position of
	point at column 0 rather than at a random place in the line.

2013-03-05  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-compat.el (tramp-compat-delete-directory):
	Implement TRASH argument.

2013-03-05  Dmitry Gutov  <dgutov@yandex.ru>

	Keep pre-existing highlighting in completion candidates (Bug#13250).
	* minibuffer.el (completions-first-difference): State that the
	face is "added" in the docstring.
	(completions-common-part): Same.  And don't inherit from default.
	(completion-hilit-commonality): Prepend 'completions-common-part
	and 'completion-first-difference faces to the 'face property,
	instead of replacing the value(s).
	(completion--insert-strings): Same with 'completions-annotations face.
	(completion-hilit-commonality): Use 'face instead of
	'font-lock-face, because it gets priority if the completion
	strings already have 'face set.

2013-03-04  Alan Mackenzie  <acm@muc.de>

	Replace `last-command-event' by `last-command-char' in XEmacs.
	* progmodes/cc-defs.el (c-last-command-char): New macro.
	* progmodes/cc-align.el (c-semi&comma-inside-parenlist)
	(c-semi&comma-no-newlines-before-nonblanks)
	(c-semi&comma-no-newlines-for-oneline-inliners): Use the new macro
	in place of `last-command-event'.
	* progmodes/cc-cmds.el (c-electric-pound, c-electric-brace)
	(c-electric-slash, c-electric-semi&comma, c-electric-lt-gt)
	(c-electric-paren, c-electric-continued-statement): Use the new
	macro in place of `last-command-event'.

2013-03-04  Glenn Morris  <rgm@gnu.org>

	* files.el (inhibit-local-variables-regexps):
	Add .diff and .patch.  (Bug#13862)

2013-03-03  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-adb.el (tramp-adb-maybe-open-connection):
	Cache, whether the "su" command is available on the device.

2013-03-01  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-adb.el (tramp-adb-prompt): Extend regexp.
	(tramp-adb-handle-process-file): Remove superfluous setting.
	(tramp-adb-command-exit-status): Handle case that COMMAND is nil.
	(tramp-adb-barf-unless-okay): Use `tramp-adb-command-exit-status'.
	(tramp-adb-maybe-open-connection): Apply "su" if user is defined.

2013-03-01  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/ispell.el: Fix nitpicks and byte-compiler warnings.
	(ispell-print-if-debug): Build `format' in.  Avoid end-of-buffer.
	(ispell-parse-hunspell-affix-file): Avoid beginning-of-buffer.
	Use dict-key rather than dict-name for the error message.

2013-03-01  Thierry Volpiatto  <thierry.volpiatto@gmail.com>

	* net/net-utils.el (net-utils-run-simple): Don't display-buffer
	when reverting (bug#13831).

2013-03-01  Agustín Martín Domingo  <agustin.martin@hispalinux.es>

	* textmodes/ispell.el (ispell-find-hunspell-dictionaries):
	Always expand affix-file before storing to protect against changed
	`default-directory'.
	(ispell-print-if-debug): Make sure message is printed at the end
	of the debug buffer.

2013-03-01  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-obsolete-methods): New defconst.
	(tramp-warned-obsolete-methods): New defvar.
	(tramp-find-method): Check for obsolete methods.  Map them to a
	replacement method if appropriate.

	* net/tramp-sh.el (tramp-methods) [scp1, scp2, ssh1, ssh2, plink1]:
	Remove methods.
	(top): Remove completion functions for "scp1", "scp2", "ssh1",
	"ssh2" and "plink1".

2013-02-28  Dale Sedivec  <dale@codefu.org>

	* textmodes/sgml-mode.el (sgml-syntax-propertize-function):
	Return valid syntax-table property value when converting
	quotes within text from string syntax to punctuation syntax (bug#13844).

2013-02-28  Juri Linkov  <juri@jurta.org>

	* dired-aux.el (dired-diff): If file at point is a backup file,
	use its original as the default value, and reverse the order
	of arguments to the `diff' call.  Doc fix.  (Bug#13772)

2013-02-28  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-adb.el (tramp-adb-sdk-dir): Remove.  Replaced by ...
	(tramp-adb-program): New defcustom.  Remove function.  Adapt calls.

2013-02-28  Agustín Martín Domingo  <agustin.martin@hispalinux.es>

	Initial support for hunspell dictionaries auto-detection (Bug#13639)

	* textmodes/ispell.el (ispell-find-hunspell-dictionaries):
	Ask hunspell about available and default dictionaries.
	(ispell-parse-hunspell-affix-file): Extract relevant info from
	hunspell affix file.
	(ispell-hunspell-fill-dictionary-entry): Fill non-initialized
	`ispell-dictionary-alist' entry for given dictionary after info
	provided by `ispell-parse-hunspell-affix-file'.
	(ispell-hunspell-dict-paths-alist): New defvar to contain an alist
	of parsed hunspell dicts and associated affix files.
	(ispell-hunspell-dictionary-alist): New defvar to contain an alist
	of parsed hunspell dicts and associated parameters.
	(ispell-set-spellchecker-params):
	Call `ispell-find-hunspell-dictionaries' if hunspell and not
	previously done.
	(ispell-start-process):
	Call `ispell-hunspell-fill-dictionary-entry' for current
	dictionary if it is not initialized.

2013-02-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* imenu.el: Comment nitpicks.

2013-02-28  Sam Steingold  <sds@gnu.org>

	* vc/diff-mode.el (diff-hunk-file-names): Handle filenames with spaces.
	See <http://stackoverflow.com/questions/14720205>.

2013-02-28  Thierry Volpiatto  <thierry.volpiatto@gmail.com>

	* net/net-utils.el (net-utils--revert-function): New fun (bug#13831).
	(net-utils-mode): Use it.
	(net-utils--revert-cmd): New var.
	(net-utils-run-simple): Set it, and remove bogus interactive spec.
	(traceroute): Use net-utils-run-simple.

2013-02-28  Glenn Morris  <rgm@gnu.org>

	* textmodes/paragraphs.el (mark-paragraph): Doc fix.

2013-02-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* doc-view.el: Preserve h&v scroll across C-c C-c C-c C-c.
	(doc-view-fallback-mode): Remove overlays here.
	(doc-view-toggle-display): Instead of here.  Don't throw away
	image-mode-winprops-alist.
	(doc-view-goto-page): Don't mess with hscroll.

2013-02-27  Thierry Volpiatto  <thierry.volpiatto@gmail.com>

	* font-lock.el (lisp-font-lock-keywords-2): Fix highlighting of
	&optional (bug#13819).

2013-02-27  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-adb.el (tramp-adb-parse-device-names)
	(tramp-adb-maybe-open-connection): Add timeouts.  (Bug#13299)

2013-02-26  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-sh.el (tramp-sh-handle-insert-directory):
	Add "2>/dev/null" to the ls command, in case "en_US.utf8" is not
	defined.  POSIX environments fall back to the "C" locale then and
	emit a warning, which shall be suppressed.

2013-02-26  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/easy-mmode.el (define-globalized-minor-mode): Tweak logic.
	(easy-mmode-set-keymap-parents): Use make-composed-keymap.

2013-02-25  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/bytecomp.el (byte-compile-file): Use let.

2013-02-25  Juri Linkov  <juri@jurta.org>

	* replace.el (read-regexp): Let-bind `default' to the first
	element of `defaults' if it's a list, otherwise it should be
	a string or nil.  Let-bind `suggestions' to `defaults' if it's
	a list, otherwise make a list with the string value.  Doc fix.
	(Bug#13805)

2013-02-25  Eli Zaretskii  <eliz@gnu.org>

	* emacs-lisp/bytecomp.el (byte-recompile-directory): Reject files
	that match "\`\.#", to avoid compiling lock files, even if they
	are readable (as they are on MS-Windows).

2013-02-25  Stefan Monnier  <monnier@iro.umontreal.ca>

	* files.el (basic-save-buffer): Remove redundant directory-creation.

2013-02-24  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-ext.el (math-to-radians-2, math-from-radians-2):
	Add option to force `pi' to remain symbolic.
	* calc/calcalg2.el (calcFunc-sin, calcFunc-cos, calcFunc-tan)
	(calcFunc-cot, calcFunc-csc, calcFunc-sec, calcFunc-arcsin)
	(calcFunc-arccos, calcFunc-arctan): Use symbolic `pi' in the
	derivatives, when necessary.

2013-02-23  Peter Kleiweg  <p.c.j.kleiweg@rug.nl>

	* progmodes/ps-mode.el (ps-mode-version): Bump to 1.1i.
	(ps-mode-octal-region): Use string-make-unibyte.

2013-02-23  Glenn Morris  <rgm@gnu.org>

	* emulation/viper-cmd.el (viper-submit-report):
	* progmodes/ps-mode.el (ps-mode-maintainer-address):
	* progmodes/vera-mode.el (vera-mode-help-address):
	* textmodes/artist.el (artist-maintainer-address):
	* textmodes/reftex.el (reftex-report-bug):
	* vc/ediff-util.el (ediff-submit-report):
	Add bug-gnu-emacs to bug report address.

	* progmodes/simula.el (simula-mode-menu, simula-mode-map):
	Remove bug report entries.
	(simula-mode-help-address, simula-submit-bug-report): Make obsolete.

	* emacs-lisp/bytecomp.el (byte-compile-level): New.
	(byte-compile-file, byte-compile-from-buffer):
	Use separate input/output buffers for each level of recursive
	byte-compile-file calls.  (Bug#13787)

2013-02-23  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-methods): Fix docstring.
	(tramp-ssh-controlmaster-options): Rename it from
	`tramp-ssh-controlmaster-template'.  Return a string.
	(tramp-default-method): Adapt check for
	`tramp-ssh-controlmaster-options'.

	* net/tramp-sh.el (tramp-methods):
	Replace `tramp-ssh-controlmaster-template' by "%c".
	(tramp-do-copy-or-rename-file-out-of-band)
	(tramp-maybe-open-connection): Use it in format spec.  Ensure,
	that it is applied for the first hop only.

2013-02-22  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-lazy-highlight-new-loop):
	Set `isearch-lazy-highlight-start' and `isearch-lazy-highlight-end'
	to `isearch-other-end' if it is not nil.  (Bug#13402)

	* replace.el (replace-highlight): Let-bind `isearch-other-end'
	to `match-beg'.

	* textmodes/ispell.el (ispell-highlight-spelling-error-overlay):
	Let-bind `isearch-other-end' to `start', `isearch-forward' to t
	and `isearch-error' to nil.

2013-03-16  Fabián Ezequiel Gallina  <fgallina@cuca>

	* progmodes/python.el (python-info-current-defun):
	Enhance match-data cluttering prevention.

2013-02-22  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-tramp-file-p): Fix docstring.

	* net/tramp-sh.el (tramp-sh-handle-insert-directory):
	Handle multibyte file names.

2013-02-22  Glenn Morris  <rgm@gnu.org>

	* textmodes/sgml-mode.el (sgml-xml-mode): Move before use.
	(sgml-transformation-function): Give it a :set function.
	(sgml-tag): Doc fix.

	* cmuscheme.el (scheme-buffer):
	* progmodes/inf-lisp.el (inferior-lisp-buffer):
	* progmodes/tcl.el (inferior-tcl-buffer):
	* textmodes/tex-mode.el (tex-command): Doc fixes.

	* image-mode.el (image-mode): Add mouse bindings for mode-line-process.

	* htmlfontify.el (hfy-default-header): Encode title string.  (Bug#7457)

2013-02-21  Bastien Guerry  <bzg@gnu.org>

	* cmuscheme.el (scheme-buffer): Fix docstring.  (Bug#13778)

2013-02-21  Fabián Ezequiel Gallina  <fgallina@cuca>

	* progmodes/python.el (python-info-current-defun):
	Enhance match-data cluttering prevention.

2013-02-21  Glenn Morris  <rgm@gnu.org>

	* net/tramp.el (tramp-get-debug-buffer): Ensure outline.el is not
	loaded while outline-regexp is let bound.  (Bug#9584)

2013-02-21  Fabián Ezequiel Gallina  <fgallina@cuca>

	* progmodes/python.el (python-info-current-defun): Fix failed
	defun name retrieval because of unwanted match-data cluttering.

2013-02-21  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-ssh-controlmaster-template): Make it a
	defconst.  Apply independent check for ControlPersist.

	* net/tramp-sh.el (tramp-sh-handle-set-file-times): Set $UTC only
	temporarily, via "env".

2013-02-21  Glenn Morris  <rgm@gnu.org>

	* info.el (Info-enable-edit): Remove.
	(Info-edit): Disable it rather than using Info-enable.
	(Info-edit-mode-hook, Info-edit-map, Info-edit-mode, Info-edit)
	(Info-cease-edit): Make editing of Info files obsolete.

	* informat.el (Info-tagify):
	Handle buffers not visiting files.  (Bug#13763)

2013-02-21  Juanma Barranquero  <lekktu@gmail.com>

	* calc/calc-graph.el (calc-graph-show-dumb): Fix typo.

2013-02-21  Glenn Morris  <rgm@gnu.org>

	* files.el (basic-save-buffer): Move check for existing parent
	directory after hooks.  (Bug#13773)

2013-02-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* simple.el (command-execute): Move from C.  Add obsolete check.
	(extended-command-history): Move from C.

2013-02-20  Ulrich Müller  <ulm@gentoo.org>

	* jka-cmpr-hook.el (jka-compr-compression-info-list)
	(jka-compr-mode-alist-additions): Handle .txz suffix for
	XZ-compressed tar archives (bug#13770).

2013-02-20  Bastien Guerry  <bzg@gnu.org>

	* outline.el (outline-regexp, outline-heading-end-regexp):
	Make variables, not options (bug#13731).

2013-02-20  Glenn Morris  <rgm@gnu.org>

	* image.el (image-current-frame): Change from variable to function.
	(image-show-frame): Rename from image-nth-frame.  Update callers.
	* image-mode.el (image-multi-frame): New variable.
	(image-mode-map, image-mode, image-goto-frame):
	Use image-multi-frame rather than image-current-frame.
	(image-mode, image-goto-frame): Use image-current-frame as
	function rather than as variable.

	* emacs-lisp/cl-lib.el (cl-floatp-safe): Make it an alias for floatp.
	* emacs-lisp/cl-macs.el (cl--make-type-test)
	(cl--compiler-macro-assoc): Use floatp rather than cl-floatp-safe.

2013-02-19  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-cache.el (tramp-get-hash-table): New defun.
	(tramp-get-file-property, tramp-set-file-property)
	(tramp-get-connection-property, tramp-set-connection-property): Use it.
	(tramp-flush-file-property, tramp-flush-directory-property):
	Rename argument to KEY.
	(tramp-flush-connection-property): Simplify a little bit.
	(tramp-connection-property-p): New defun.
	(top): Reapply saved values only if there isn't a corresponding
	entry in `tramp-connection-properties'.

2013-02-19  Fabián Ezequiel Gallina  <fgallina@cuca>

	* progmodes/python.el (python-indent-context):
	Fix python-info-line-ends-backslash-p call.
	(python-info-line-ends-backslash-p)
	(python-info-beginning-of-backslash): Respect line-number argument.
	(python-info-current-line-comment-p):
	Fix behavior when not at beginning-of-line.
	(python-util-position): Remove function.
	(python-util-goto-line): New function.

2013-02-19  Michael Albinus  <michael.albinus@gmx.de>

	* eshell/em-unix.el (eshell/su): Require tramp.
	(eshell/sudo): Require tramp.  Remove now unnecessary check.

	* net/tramp-sh.el (tramp-sh-handle-start-file-process): Let-bind
	`tramp-current-connection' in order to avoid an error when several
	commands are invoked in a short time in eshell and friends.

2013-02-19  Stefan Monnier  <monnier@iro.umontreal.ca>

	Cleanup some of EIEIO's namespace.
	* emacs-lisp/eieio.el (eieio--define-field-accessors): New macro.
	Use it to define all the class-* and object-* field accessors (renamed
	to eieio--class-* and eieio--object-*).  Update all uses.
	(eieio--class-num-slots, eieio--object-num-slots): Rename from
	class-num-slots and object-num-slots.
	(eieio--check-type): New macro.
	(eieio-defclass, eieio-oref, eieio-oref-default, same-class-p)
	(object-of-class-p, child-of-class-p, object-slots, class-slot-initarg)
	(eieio-oset, eieio-oset-default, object-assoc, object-assoc-list)
	(object-assoc-list-safe): Use it.
	(eieio-defclass): Tighten regexp.
	(eieio--defmethod): Use `memq'.  Signal an error for unknown method kind.
	Remove unreachable code.
	(object-class-fast): Declare obsolete.
	(eieio-class-name, eieio-object-name, eieio-object-set-name-string)
	(eieio-object-class, eieio-object-class-name, eieio-class-parents)
	(eieio-class-children, eieio-class-precedence-list, eieio-class-parent):
	Rename from class-name, object-name, object-set-name-string,
	object-class, object-class-name, class-parents, class-children,
	class-precedence-list, class-parent; with obsolete alias.
	(class-of, class-direct-superclasses, class-direct-subclasses):
	Declare obsolete.
	(eieio-defmethod): Use `memq'; remove unreachable code.
	* emacs-lisp/eieio-base.el (eieio-persistent-read):
	* emacs-lisp/eieio-opt.el (eieio-class-button, eieio-describe-generic)
	(eieio-browse-tree, eieio-browse): Use eieio--check-type.

2013-02-18  Aidan Gauland  <aidalgol@no8wireless.co.nz>

	* eshell/em-cmpl.el: Correct "context-related help" keybinding in
	commentary.

2013-02-18  Michael Heerdegen  <michael_heerdegen@web.de>

	* emacs-lisp/eldoc.el (eldoc-highlight-function-argument):
	Use font-lock-keyword-face for macros and special forms (bug#8345).

2013-02-17  Didier Verna  <didier@didierverna.net>

	* net/network-stream.el (network-stream-open-starttls):
	Check that response to the starttls-command is non-nil.  (Bug#13706)

2013-02-17  Stefan Monnier  <monnier@iro.umontreal.ca>

	* font-lock.el (lisp-font-lock-keywords-1, lisp-font-lock-keywords-2):
	Don't assume all identifier chars have syntax word.
	* emacs-lisp/lisp-mode.el (lisp-mode-variables):
	Remove bar-not-symbol.  Adjust callers.
	(lisp-mode-variables): Don't set a font-lock-syntax-table.

2013-02-17  Leo Liu  <sdl.web@gmail.com>

	* net/rcirc.el (rcirc-keepalive): Fix invalid timer error.

2013-02-17  Glenn Morris  <rgm@gnu.org>

	* menu-bar.el (menu-bar-tools-menu): Fix case of EDE entry.

	* image-mode.el (image-mode-map): Add image-dired menu entry.

	* image-dired.el (tumme): Make this alias obsolete.

2013-02-16  Glenn Morris  <rgm@gnu.org>

	* image.el (image-animated-types): Remove.
	(image-multi-frame-p): Rename from image-animated-p, and generalize.
	(image-animated-p): Make obsolete alias.
	(image-animate, image-nth-frame, image-animate-timeout):
	Use image-multi-frame-p.
	(image-animate-timeout): If no delay, use image-default-frame-delay.
	* image-mode.el (image-mode, image-toggle-animation):
	Use image-multi-frame-p.  (Bug#763, bug#10739)
	(image-mode): Adjust startup message for a multi-frame image.

	* image-mode.el (image-mode-map): Give it a menu.

2013-02-16  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-cache.el (tramp-connection-properties): New customer
	option.
	(tramp-get-connection-property): Use it.

	* net/tramp-compat.el (top): Require 'trampver.

	* net/tramp-sh.el (tramp-remote-process-environment):
	Set tramp-autoload cookie.

2013-02-16  Kevin Ryde  <user42@zip.com.au>

	* info-look.el (info-lookup-select-mode): If major-mode has no
	info-lookup-alist entry then search up derived-mode-parent (bug#8660).

2013-02-16  Jambunathan K  <kjambunathan@gmail.com>

	* replace.el (read-regexp): Tighten the regexp that matches tag.
	When tag is retrieved with `find-tag-default', use regexp that
	matches tag at point.  Also update docstring (Bug#13687).

2013-02-16  Eli Zaretskii  <eliz@gnu.org>

	* autorevert.el (auto-revert-notify-add-watch): With 'w32notify',
	add watch for the file, not its parent directory, since w32notify
	sets up the watch for the directory internally.  (Bug#13725)

2013-02-16  Glenn Morris  <rgm@gnu.org>

	* image.el (image-default-frame-delay): New variable.
	(image-animated-p): Use image-default-frame-delay.
	(image-minimum-frame-delay): New constant.
	(image-animate-timeout): Use image-minimum-frame-delay.

	* image.el (image-nth-frame): New, split from image-animate-timeout.
	(image-animate-timeout): Use image-nth-frame.
	* image-mode.el (image-goto-frame, image-next-frame)
	(image-previous-frame): New commands.
	(image-mode-map): Add new frame commands.

2013-02-16  Jonas Bernoulli  <jonas@bernoul.li>

	* emacs-lisp/tabulated-list.el (tabulated-list-print-col):
	If col-desc already has help-echo, use it.  (Bug#13563)

2013-02-16  Glenn Morris  <rgm@gnu.org>

	* image.el (image-current-frame): New variable.
	(image-animate-timeout): Set image-current-frame.
	* image-mode.el (image-mode): For animated images,
	display a frame counter via mode-line-process.

	* font-lock.el (lisp-font-lock-keywords-1): Add defvar-local.

2013-02-15  Stefan Monnier  <monnier@iro.umontreal.ca>

	* simple.el (eval-expression): Let `exp' set the mark (bug#13724).

2013-02-15  Alan Mackenzie  <acm@muc.de>

	* emacs-lisp/easy-mmode.el (define-globalized-minor-mode): When a
	global minor mode has been enabled, call the minor mode function
	for a new buffer once only, after the major mode hook, whilst
	allowing that hook explicitly to disable the minor mode.
	(MODE-disable-in-buffer): New (generated) function.
	(disable-MODE): New (generated) buffer local variable.

2013-02-15  Jambunathan K  <kjambunathan@gmail.com>

	* iswitchb.el (iswitchb-read-buffer): Bind `C-.' and `C-,' to
	`iswitchb-next-match' and `iswitchb-prev-match' resply.
	* ido.el (ido-init-completion-maps): Bind `C-.' and `C-,' to
	`ido-next-match' and `ido-prev-match' resply.
	* icomplete.el (icomplete-minibuffer-map): Unbind `C-s' and `C-r'.
	Bind `C-.' and `C-,' to `icomplete-forward-completions' and
	`icomplete-backward-completions' (Bug#13708).

2013-02-15  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/easy-mmode.el (define-minor-mode): Doc fix.

2013-02-15  Stefan Monnier  <monnier@iro.umontreal.ca>

	* net/goto-addr.el (goto-address-fontify): Add start and end args.
	(goto-address-fontify-region): Use them instead of narrowing, so
	syntax-ppss has access to the whole buffer.

2013-02-15  Fabián Ezequiel Gallina  <fgallina@cuca>

	* progmodes/python.el: Explain how to restore "cc-mode"-like
	forward-sexp movement in header documentation (Bug#13642).
	(python-nav--forward-sexp): Behave like emacs-lisp-mode in
	comments and strings (GH bug 114).

2013-02-15  Fabián Ezequiel Gallina  <fgallina@cuca>

	* progmodes/python.el (python-info-current-defun): Fix current
	defun detection (Bug#13618).

2013-02-15  Chong Yidong  <cyd@gnu.org>

	* xml.el (xml-parse-string): Fix typo in handling of bad character
	references.

2013-02-15  Glenn Morris  <rgm@gnu.org>

	* play/fortune.el (fortune-compile): Simplify and fix previous change.

2013-02-14  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-debug-message):
	Add `tramp-condition-case-unless-debug'.
	(tramp-debug-on-error): New defvar.
	(tramp-condition-case-unless-debug): New defun.
	(tramp-file-name-handler): Use it.

2013-02-14  Juri Linkov  <juri@jurta.org>

	* info.el (Info-isearch-filter): Treat non-nil values of
	`search-invisible' including its default value `open'
	like the value `t' to match hidden text.  (Bug#13402)

2013-02-14  Glenn Morris  <rgm@gnu.org>

	* help-fns.el (find-lisp-object-file-name): Give special treatment
	to all ~/.foo.elc files, not just ~/.emacs.  (Bug#9007)

2013-02-14  David Biesack  <sasdjb@d72933.na.sas.com>  (tiny change)

	* net/quickurl.el (quickurl-save-urls):
	Ensure quickurl-urls is not truncated on printing.  (Bug#9276)

2013-02-14  Dmitry Gutov  <dgutov@yandex.ru>

	* progmodes/ruby-mode.el (ruby-parse-partial): Don't increase
	depth for unfinished percent literal.  Not using it in the caller.
	(ruby-move-to-block): Jump over multiline literals of all types,
	ignoring code-looking contents inside them.
	(ruby-add-log-current-method): Improve performance at the expense
	of accuracy.  `ruby-block-contains-point' is relatively slow, so
	only use it for method and singleton class blocks.

2013-02-13  Michael Albinus  <michael.albinus@gmx.de>

	Use ControlMaster where applicable.  (Bug#13677)

	* net/tramp.el (tramp-ssh-controlmaster-template): New defvar,
	replacing `tramp-detect-ssh-controlmaster'.
	(tramp-default-method): Use it.

	* net/tramp-sh.el (tramp-methods) [scp, scp1, scp2, scpx, sftp]:
	[rsync, ssh, ssh1, ssh2, sshx]: Add ControlPath and ControlMaster
	arguments.
	[scpc, rsyncc]: Remove methods.
	(top): Remove completion functions for "scpc", "rsyncc", "ssh1_old"
	and "ssh2_old".
	(tramp-do-copy-or-rename-file-out-of-band): Change trace level.
	(tramp-maybe-open-connection): Reuse tmpfile for ControlPath.

2013-02-13  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/package.el (package--initialized): Move before first use.

2013-02-13  Jambunathan K  <kjambunathan@gmail.com>

	* icomplete.el (icomplete-hide-common-prefix): New user option.
	(icomplete-first-match): New face.
	(icomplete-completions): Correct handling of "complete but not
	unique" (Bug#12638).

2013-02-13  YE Qianchuan  <stool.ye@gmail.com>  (tiny change)

	* descr-text.el (describe-char): Display the script (bug#13698).

2013-02-13  Stefan Monnier  <monnier@iro.umontreal.ca>

	* tmm.el: Use lexical-binding and current-active-maps.
	(tmm-menubar): Use map-keymap and pcase.
	(tmm--completion-table): New function.
	(tmm-prompt): Use it to fix the menu order.
	(tmm-get-keybind): Use current-active-maps.

2013-02-13  Christopher Schmidt  <christopher@ch.ristopher.com>

	Add dired-hide-details-mode.  (Bug#6799)

	* locate.el (locate-mode): Set parent mode property to dired-mode.

	* find-dired.el (find-dired): Call dired-insert-set-properties on
	initial information line.  Set process mark on end of buffer.
	(find-dired-sentinel):
	Call dired-insert-set-properties on summary.

	* dired.el (dired-hide-details-hide-symlink-targets)
	(dired-hide-details-hide-information-lines): New options.
	(dired-insert-directory):
	Set properties after final treatment of output.
	(dired-insert-set-properties):
	Set dired-hide-details-* properties.
	(dired-mode-map): Bind dired-hide-details-mode.
	(dired-mode): Set buffer-invisibility-spec to a list.
	(dired-next-line): Skip hidden lines.
	(dired-previous-line): Use dired-next-line.
	(dired-hide-details-mode): New minor mode.
	(dired-hide-details-update-invisibility-spec): New function.

2013-02-13  Glenn Morris  <rgm@gnu.org>

	* play/yow.el: Move to obsolete/.  (Bug#9384)

2013-02-13  Juri Linkov  <juri@jurta.org>

	* vc/ediff-util.el (ediff-recenter): Use `select-frame-set-input-focus'
	to select `ediff-control-frame' and set input focus correctly on Xfce.
	(Bug#12218)

2013-02-13  Juri Linkov  <juri@jurta.org>

	* image-mode.el (image-mode-map):
	* doc-view.el (doc-view-mode-map):
	* vc/ediff-util.el (ediff-setup-keymap):
	Make S-SPC scroll in the opposite sense to SPC.  (Bug#2145)

2013-02-13  Dmitry Gutov  <dgutov@yandex.ru>

	* progmodes/ruby-mode.el (ruby-move-to-block): Improve performance.
	Instead of recalculating indentation fully for each line, sum up
	indentation depth based only on visited lines.
	(ruby-parse-partial): Increase the depth after "do" even when END
	is right after it.
	(ruby-parse-partial): When END is in the middle of a percent
	literal, increase the depth if the delimiter chars belong to the
	paren syntax class.

2013-02-13  Kirill A. Korinskiy  <catap@catap.ru>

	* play/fortune.el (fortune-compile): Also make the compiled file
	if it does not exist at all, not just if it is old.  (Bug#5338)

2013-02-13  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/package.el (package-menu-execute): Doc fix.

2013-02-13  Yves Baumes  <ybaumes@gmail.com>  (tiny change)

	* emacs-lisp/package.el (package-menu-execute):
	Add optional noquery argument.  (Bug#13625)

2013-02-13  Michael Albinus  <michael.albinus@gmx.de>

	* net/ange-ftp.el (ange-ftp-make-directory): Don't raise an error,
	if DIR exists and PARENTS is non-nil.

2013-02-13  Juanma Barranquero  <lekktu@gmail.com>

	* progmodes/js.el (js--multi-line-declaration-indentation):
	Silence byte-compiler warning.

2013-02-12  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-adb.el (tramp-adb-handle-start-file-process): Rewrite.

	* net/tramp-compat.el (top): Declare `remote-file-name-inhibit-cache'
	only if it doesn't exist.

	* net/tramp-sh.el (tramp-sh-handle-start-file-process):
	Set process marker.

2013-02-12  Tassilo Horn  <tsdh@gnu.org>

	* doc-view.el (doc-view-odf->pdf-converter-soffice): Use separate
	UserInstallation when calling soffice to work around LibreOffice
	bug 37531.

2013-02-12  Glenn Morris  <rgm@gnu.org>

	* files.el (basic-save-buffer):
	Offer to create a non-existing directory.  (Bug#3016)

	* calc/calc-graph.el (calc-graph-show-dumb):
	* calendar/calendar.el (calendar-mode-map):
	* cus-edit.el (custom-mode-map):
	* ehelp.el (electric-help-map):
	* emulation/vip.el (vip-mode-map):
	* epa.el (epa-key-list-mode-map):
	* info.el (Info-mode-map):
	* mail/rmail.el (rmail-mode-map):
	* mail/rmailsum.el (rmail-summary-mode-map):
	* man.el (Man-mode-map):
	* net/newst-plainview.el (newsticker-mode-map):
	* progmodes/cpp.el (cpp-edit-mode-map):
	* progmodes/grep.el (grep-mode-map):
	* progmodes/idlw-help.el (idlwave-help-mode-map):
	* simple.el (special-mode-map):
	* startup.el (splash-screen-keymap):
	* view.el (view-mode-map):
	Make S-SPC scroll in the opposite sense to SPC.  (Bug#2145)

2013-02-11  Elias Pipping  <pipping@lavabit.com>

	* doc-view.el (doc-view-current-cache-dir): Beware % escapes
	(bug#13679).

2013-02-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* cus-start.el (all): Remove inhibit-local-menu-bar-menus.

2013-02-11  Glenn Morris  <rgm@gnu.org>

	* vc/diff.el (diff-use-labels): New variable.
	(diff-no-select): Use --label rather than -L, and first
	check that it is supported.  (Bug#11067)

	* files.el (enable-dir-local-variables): New variable.
	(hack-dir-local-variables): Respect enable-dir-local-variables.
	* tutorial.el (help-with-tutorial):
	Ignore directory-local variables.  (Bug#11127)

	* vc/vc-svn.el (vc-svn-command): Move --non-interactive from here...
	(vc-svn-global-switches): ... to here.  (Bug#13513)

2013-02-10  Christopher Schmidt  <christopher@ch.ristopher.com>

	* minibuf-eldef.el (minibuffer-default--in-prompt-regexps):
	Handle "foo (bar, default: xxx): " prompts.

2013-02-10  Chong Yidong  <cyd@gnu.org>

	* files.el (basic-save-buffer-1): Do not set
	buffer-file-coding-system-explicit (Bug#4533).

	* mail/emacsbug.el (report-emacs-bug): Change binding of
	report-emacs-bug-insert-to-mailer to C-c M-i (Bug#13510).

2013-02-09  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc.el (calc-allow-units-as-numbers): New variable.
	* calc/calc-units.el (calc-convert-units): Use new variable.

2013-02-09  Eli Zaretskii  <eliz@gnu.org>

	* subr.el (buffer-file-type, default-buffer-file-type): Remove.

	* net/ange-ftp.el (ange-ftp-insert-file-contents): Don't reference
	buffer-file-type.

	* mail/feedmail.el (feedmail-force-binary-write): Doc fix.
	(feedmail-run-the-queue, feedmail-dump-message-to-queue)
	(feedmail-send-it-immediately): Don't bind buffer-file-type, bind
	coding-system-for-write instead.

	* jka-compr.el (jka-compr-write-region): Don't bind
	buffer-file-type.

	* emacs-lisp/bytecomp.el (byte-compile-file): Don't bind
	buffer-file-type.

	* files.el (file-name-buffer-file-type-alist): Remove defvar.
	(insert-file-contents-literally): Remove reference to
	file-name-buffer-file-type-alist.

	* dos-w32.el (file-name-buffer-file-type-alist): Deprecate and
	make-obsolete.
	(find-buffer-file-type-match, find-buffer-file-type): Remove.
	(find-buffer-file-type-coding-system): Remove references to
	find-buffer-file-type-match, find-buffer-file-type, and
	buffer-file-type.
	Don't put find-buffer-file-type-coding-system into
	file-coding-system-alist.
	(find-file-binary, find-file-text): Bind coding-system-for-read
	instead of file-name-buffer-file-type-alist.

2013-02-09  Jambunathan K  <kjambunathan@gmail.com>

	* doc-view.el: Use (and prefer) soffice as default ODF->PDF
	converter (Bug#13622).
	(doc-view-unoconv-program): Make obsolete alias.
	(doc-view-odf->pdf-converter-program): New variable.
	(doc-view-odf->pdf-converter-function): New variable.
	(doc-view-mode-p): Use it.
	(doc-view-odf->pdf-converter-unoconv):
	Rename from `doc-view-odf->pdf-converter-unoconv'.
	(doc-view-odf->pdf-converter-soffice): New function.
	(doc-view-convert-current-doc):
	Use `doc-view-odf->pdf-converter-function'.

2013-02-09  Chong Yidong  <cyd@gnu.org>

	* minibuffer.el (minibuffer-inactive-mode-map): Bind mouse-1 to
	view-echo-area-messages (Bug#13340).

	* help.el (view-echo-area-messages): Use display-buffer.

	* dired-x.el (dired-do-run-mail): Prompt for confirmation
	(Bug#13561).

2013-02-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/byte-run.el (eval-when-compile, eval-and-compile):
	Eval body right away, now that we do eager macroexpansion (bug#13605).

	* simple.el (end-of-buffer): Don't touch unrelated windows (bug#13466).
	(fundamental-mode): Use run-mode-hooks.

	* eshell/esh-proc.el (eshell/kill): Fix last change.
	* eshell/em-ls.el (eshell-ls-dir): Fix use of CL in last change.

2013-02-08  Aidan Gauland  <aidalgol@no8wireless.co.nz>

	* eshell/esh-proc.el (eshell/kill): Rewrite.

	* eshell/em-ls.el (show-almost-all): Declare.
	(eshell-do-ls): Add support for -A argument.

2013-02-08  Jambunathan K  <kjambunathan@gmail.com>

	* icomplete.el (icomplete-forward-completions)
	(icomplete-backward-completions): Handle corner case (bug#13602).

2013-02-07  Michael Albinus  <michael.albinus@gmx.de>

	* vc/vc-hooks.el (vc-find-file-hook): `buffer-file-truename' can
	be nil.  Handle this.  (Bug#13636)

2013-02-07  Richard Stallman  <rms@gnu.org>

	* mail/rmail.el (rmail-variables): Specify `no-conversion' for
	`save-buffer-coding-system'.

2013-02-07  Alan Mackenzie  <acm@muc.de>

	Fix bug in state cache mechanism.  Remove 'BOD "strategy".  Refactor.
	* progmodes/cc-engine.el (c-get-fallback-scan-pos): Remove.
	(c-parse-state-get-strategy): Don't return 'BOD any more.
	(c-append-lower-brace-pair-to-state-cache):
	Extra parameter HERE instead of narrowing.
	Widen to top of buffer before searching backwards for a brace pair.
	(c-state-push-any-brace-pair): Add HERE parameter to function call.
	(c-append-to-state-cache): Extra parameter HERE in place of narrowing.
	Narrow to parameter HERE, in place of being called narrowed.
	(c-remove-stale-state-cache): Extra parameter HERE in place of
	narrowing.  Check there's an open brace in the cache before
	searching for its match.
	(c-invalidate-state-cache-1): Add HERE parameter to function call.
	(c-parse-state-1): Don't narrow here for 'forward strategy,
	instead passing extra parameter HERE to several functions.
	Remove 'BOD strategy.

2013-02-06  Nicolas Richard  <theonewiththeevillook@yahoo.fr>  (tiny change)

	* emacs-lisp/package.el (describe-package-1): Tell what archive is
	used to install the package.

2013-02-06  Glenn Morris  <rgm@gnu.org>

	* vc/vc-hooks.el (vc-find-file-hook): Don't ask about following links
	if we can't get user input.  (Bug#6567)

	* startup.el (command-line): If simple.el is missing,
	test and warn about for some possible causes.

2013-02-05  Jan Djärv  <jan.h.d@swipnet.se>

	* cus-start.el (all): Add ns-use-native-fullscreen.

2013-02-05  Glenn Morris  <rgm@gnu.org>

	* profiler.el (profiler-report-mode-map): Add a restart menu entry.

	* play/gamegrid.el (gamegrid-add-score-with-update-game-score):
	Fix directory creation in fallback case.

2013-02-04  Thierry Volpiatto  <thierry.volpiatto@gmail.com>

	* vc/vc.el (vc-next-action): Fix inf-loop (bug#13610).
	(vc-update-change-log): Use dolist.

2013-02-04  Chong Yidong  <cyd@gnu.org>

	* thingatpt.el: Rewrite the URL detection routines, absorbing some
	code from ffap.el.
	(thing-at-point-beginning-of-url-regexp): New var.
	(thing-at-point-uri-schemes): Update list of URI schemes.
	(thing-at-point-url-regexp): Variable deleted.
	(thing-at-point-markedup-url-regexp): Disallow newlines.
	(thing-at-point-newsgroup-regexp)
	(thing-at-point-newsgroup-heads)
	(thing-at-point-default-mail-uri-scheme): New variables.
	(thing-at-point-bounds-of-url-at-point): Rewrite.  Use ffap's
	method to find the possible bounds of the URI at point.
	New optional argument to find ill-formed URIs.
	(thing-at-point-url-at-point): Rewrite.  New arguments for finding
	ill-formed URIs.  Use thing-at-point-bounds-of-url-at-point, and
	the scheme-adding heuristics from ffap-url-at-point.
	(thing-at-point--bounds-of-well-formed-url): New function.
	Do parens matching to decide whether to include parens in the URI
	(Bug#9153).

	* ffap.el: Require thingatpt.
	(ffap-url-at-point): Delegate URI detection to thing-at-point.
	All URI-valid characters are now recognized (Bug#5673).
	(ffap-string-at-point): Use use-region-p.
	(ffap-url-regexp): Extra character is handled by thing-at-point.
	(ffap-string-at-point-mode-alist): Allow parentheses.
	(ffap-newsgroup-regexp, ffap-newsgroup-heads, ffap-newsgroup-p):
	Convert to aliases; code moved to thingatpt.el.
	(ffap-gnus-hook): Use setq-local.

2013-02-04  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/ert.el (ert--explain-format-atom):
	Don't try to print non-characters as characters.  (Bug#13543)

2013-02-03  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-debug-message): Extend function exclude list.
	(tramp-backtrace): New defun.
	(tramp-handle-insert-file-contents): Use `visit' when inserting
	the local copy.

	* net/tramp-sh.el (tramp-sh-handle-set-visited-file-modtime):
	Use `remote-file-name-inhibit-cache'.

2013-02-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/cperl-mode.el (cperl-mode): Avoid byte-compile warning
	(bug#13614).

	* subr.el (internal--called-interactively-p--get-frame): Avoid filling
	current-load-list (bug#13366).

2013-02-02  Christopher Schmidt  <christopher@ch.ristopher.com>

	* progmodes/compile.el (compilation-error-regexp-alist-alist):
	Identify g++ template instantiation trace.  (Bug#12287)
	(compilation-mode-hook, compilation-start-hook)
	(compilation-window-height): Simplify docstrings.  (Bug#13379)

2013-02-02  Stefan Monnier  <monnier@iro.umontreal.ca>

	* mouse.el (mouse-drag-track): Always deactivate the mark before
	running the final event's command since that command is in charge of
	activating the mark if needed (bug#13523).

2013-02-02  Juri Linkov  <juri@jurta.org>

	* replace.el (perform-replace): Move let-bindings of isearch-*
	variables deeper to the loop that searches for the next match.
	Add bindings for `isearch-nonincremental' and `isearch-adjusted'.
	Use `isearch-search-fun-default' instead of `isearch-search-fun'.
	(Bug#13579)

	* isearch.el (isearch-search-fun-default): Check for null
	first element of isearch-cmds as a precaution when it's used
	with inactive isearch.

2013-02-02  Andrew W. Nosenko  <andrew.w.nosenko@gmail.com>  (tiny change)

	* net/tramp.el (tramp-check-for-regexp): Avoid "Args out of range"
	error when buffer in question is narrowed so position 1 is out of
	visible part.

2013-02-02  Glenn Morris  <rgm@gnu.org>

	* textmodes/remember.el (remember-clipboard): Doc fix.

2013-02-02  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/make-mode.el (makefile-fill-paragraph): Reset syntax-table
	properties (bug#13179).

2013-02-02  Juri Linkov  <juri@jurta.org>

	* progmodes/grep.el (grep-regexp-alist): Use variable grep-match-face
	instead of hard-coded default face `match'.  (Bug#9438)

2013-02-01  Christopher Schmidt  <christopher@ch.ristopher.com>

	* vc/vc-arch.el (vc-arch-registered):
	* vc/vc-bzr.el (vc-bzr-registered):
	* vc/vc-cvs.el (vc-cvs-registered):
	* vc/vc-git.el (vc-git-registered):
	* vc/vc-hg.el (vc-hg-registered):
	* vc/vc-mtn.el (vc-mtn-registered):
	* vc/vc-svn.el (vc-svn-registered): Suppress load messages.
	(Bug#13139)

	* info.el (Info-next-reference, Info-prev-reference): Add numeric
	prefix argument.  (Bug#11656)

2013-02-01  Stefan Monnier  <monnier@iro.umontreal.ca>

	* help-fns.el (help-split-fundoc): Don't insert byte-compiled body.

2013-02-01  Glenn Morris  <rgm@gnu.org>

	* vc/vc-hooks.el (vc-menu-map): Disable vc-rollback menu item
	if the backend is known not to support it.

	* imenu.el (imenu-default-create-index-function):
	Tweak infinite loop test to check for forward motion as well as none.

2013-02-01  Alex Harsanyi  <AlexHarsanyi@gmail.com>

	* net/soap-client.el (soap-invoke): Encode the string for
	`url-request-data' as UTF-8.
	Fixes <http://code.google.com/p/emacs-soap-client/issues/detail?id=16>.

2013-02-01  Glenn Morris  <rgm@gnu.org>

	* calc/calc-help.el (calc-view-news): Use view-emacs-news.

	* calc/README, calc/README.prev: Rename/merge to etc/CALC-NEWS.

2013-01-31  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-tramp-file-p): Comment check for
	`string-as-unibyte'.  The function does not exist on XEmacs, and
	likely we need another approach.

	* net/tramp-sh.el (tramp-compute-multi-hops): Check, whether
	`tramp-gw-*' variables are bound.

2013-01-31  Glenn Morris  <rgm@gnu.org>

	* files.el (basic-save-buffer-2): Choose coding system for
	writing the file before backing it up, to reduce delay between
	backing up and writing the new version.  (Bug#13522)

2013-01-31  Michal Nazarewicz  <mina86@mina86.com>

	* simple.el (cycle-spacing): New command.
	(just-one-space): Use it.

2013-01-31  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/opascal.el: Rename from delphi.el.  Use lexical-binding.
	(opascal-newline-always-indents): Remove custom.
	(opascal-tab, opascal-newline): Remove commands.
	(opascal-new-comment-line): Insert "\n" instead of calling newline.
	(opascal-mode-map): Keep default bindings for RET and TAB and DEL.
	(opascal-save-match-data): Remove, use save-match-data instead.
	(opascal-save-state): Use with-silent-modifications.

	* progmodes/pascal.el (pascal-mode-syntax-table): Accept //..\n comments
	(bug#13585).

2013-01-30  Juri Linkov  <juri@jurta.org>

	* frame.el (toggle-frame-maximized, toggle-frame-fullscreen):
	Use fullboth as an alias for fullscreen.  Suggested by Jan Djärv in
	<https://lists.gnu.org/r/emacs-devel/2013-01/msg00203.html>.

2013-01-30  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/make-mode.el (makefile-backslash-region): Don't compute
	column if we're just deleting the backslashes.
	(makefile-fill-paragraph): Use eolp.

2013-01-30  Michael Albinus  <michael.albinus@gmx.de>

	* autorevert.el (auto-revert-use-notify): Fix docstring.

2013-01-30  Leo Liu  <sdl.web@gmail.com>

	* imenu.el (imenu--truncate-items): Fix subalist checking (bug#13576).

2013-01-30  Glenn Morris  <rgm@gnu.org>

	* mouse.el (mouse-drag-line): Avoid pushing same event onto
	unread-command-events twice in some cases.  This tries to implement
	the 2012-07-26 changes in a different way.  (Bug#13560)

2013-01-30  Fabián Ezequiel Gallina  <fgallina@cuca>

	* progmodes/python.el
	(python-pdbtrack-comint-output-filter-function): Enhancements on
	stacktrace detection.  (thanks @gnovak)

2013-01-30  Stefan Monnier  <monnier@iro.umontreal.ca>

	* jit-lock.el (jit-lock-stealth-chunk-start): Don't widen (bug#13542).
	(jit-lock-mode, jit-lock-functions, jit-lock-context-unfontify-pos):
	Use defvar-local.
	(jit-lock-register): Use setq-local.

2013-01-30  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-units.el (math-default-units-table): Remove initial value.
	(calc-convert-units): Treat expressions where all the units cancel as
	if they didn't have units.

2013-01-30  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-process-connection-type): Fix docstring.
	(tramp-completion-reread-directory-timeout): Fix type.
	(tramp-connection-min-time-diff): New defcustom.

	* net/tramp-sh.el (tramp-maybe-open-connection): Use it.

2013-01-30  Glenn Morris  <rgm@gnu.org>

	* imenu.el (imenu-default-create-index-function):
	Put back a version of the infinite loop test removed 2013-01-23.

2013-01-30  Fabián Ezequiel Gallina  <fgallina@cuca>

	* progmodes/python.el (python-shell-parse-command):
	Find python-shell-interpreter with modified environment.

2013-01-30  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/cl.el (cl-set-getf): Add compatibility alias.

2013-01-29  Alan Mackenzie  <acm@muc.de>

	Amend to fontify /regexp/s in actions correctly.
	* progmodes/cc-awk.el (c-awk-harmless-char-re)
	(c-awk-harmless-string*-re, c-awk-harmless-string*-here-re):
	Braces, parens and semicolons are no longer included.
	(c-awk-harmless-line-char-re, c-awk-harmless-line-string*-re):
	What used to be these variables without "-line" in the name.
	(c-awk-neutral-re): { is no longer neutral.  Escaped newlines now are.
	(c-awk-non-arith-op-bra-re): Now also matches {.
	(c-awk-pre-exp-alphanum-kwd-re): New regexp to match "print",
	"return", and "case".
	(c-awk-kwd-regexp-sign-re): New, to match "print", etc., followed
	by /.
	(c-awk-syntax-tablify-/): Check special cases "print /re/", etc.
	(c-awk-set-syntax-table-properties): Extend FSM to handle {,},(,),;.

2013-01-29  Michael Albinus  <michael.albinus@gmx.de>

	* autorevert.el (auto-revert-use-notify):
	Use `custom-initialize-default' for initialization.  (Bug#13583)

	* net/ange-ftp.el (ange-ftp-skip-msgs): Add another message.

	* net/tramp-sh.el (tramp-sh-handle-start-file-process):
	Catch `suppress'.  Otherwise, `tramp-run-real-handler' might be called
	in `tramp-file-name-handler'.
	(tramp-gw-tunnel-method, tramp-gw-socks-method): Declare for
	compatibility.
	(tramp-compute-multi-hops): Check, whether
	`tramp-gw-tunnel-method' and `tramp-gw-socks-method' are non-nil.

2013-01-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* hi-lock.el (hi-lock-unface-buffer): Don't assume `face' is a symbol
	(bug#13297).

2013-01-27  Dmitry Gutov  <dgutov@yandex.ru>

	* progmodes/ruby-mode.el (ruby-font-lock-keywords): Remove some
	checks made superfluous by the \_< operator.
	* progmodes/ruby-mode.el (ruby-move-to-block): Work with (maybe
	temporarily) broken indentation.
	* progmodes/ruby-mode.el (ruby-font-lock-keywords):
	Highlight nested constants, too.  \_< broke that.

2013-01-27  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* progmodes/ruby-mode.el (ruby-font-lock-keywords): Use "\\_<"
	instead of "\\b".

2013-01-27  Michael Albinus  <michael.albinus@gmx.de>

	* autorevert.el (auto-revert-handler): Notifications which result
	from a saved file shall not be taken into account.  (Bug#13557)

2013-01-26  Andreas Schwab  <schwab@linux-m68k.org>

	* emacs-lisp/lisp-mode.el (lisp-mode-variables): Add optional
	parameter BAR-NOT-SYMBOL to control syntax of | for font-lock.
	(lisp-mode): Pass t for it.  (Bug#13556)

2013-01-25  Alan Mackenzie  <acm@muc.de>

	AWK Mode: Fix indentation bug at top level.  Bug #12274.

	* progmodes/cc-engine.el (c-guess-basic-syntax): Move CASE 5P to
	just before CASE 5D.

2013-01-25  Dmitry Antipov  <dmantipov@yandex.ru>

	* net/socks.el (socks-nslookup-host): Use string-to-number.

2013-01-25  Michael Albinus  <michael.albinus@gmx.de>

	* autorevert.el (auto-revert-remote-files)
	(auto-revert-notify-exclude-dir-regexp): New defcustoms.
	(auto-revert-notify-enabled, auto-revert-use-notify)
	(auto-revert-notify-watch-descriptor-hash-list)
	(auto-revert-notify-modified-p, auto-revert-notify-event-p)
	(auto-revert-notify-event-descriptor)
	(auto-revert-notify-event-action)
	(auto-revert-notify-event-file-name): Doc fix.
	(global-auto-revert-mode): Reorder checks.
	(auto-revert-notify-rm-watch): Respect changed values of
	`auto-revert-notify-watch-descriptor-hash-list'.
	(auto-revert-notify-add-watch): Check for
	`auto-revert-notify-exclude-dir-regexp'.  Adapt filters for
	`inotify-add-watch'.  Watch `default-directory' instead of
	`buffer-file-name'.  `auto-revert-notify-watch-descriptor-hash-list'
	has a changed meaning now.  (Bug#13540)
	(auto-revert-notify-handler): Change implementation wrt events
	returning from a directory.
	(auto-revert-handler): Reorder implementation for checks of remote
	files.
	(auto-revert-buffers): Fix parentheses error.

2013-01-25  Fabián Ezequiel Gallina  <fgallina@cuca>

	* progmodes/python.el: Enhancements to header documentation about
	skeletons.  (Bug#5716)

	* imenu.el (imenu-default-create-index-function): Remove useless
	infinite loop check.  (Bug#13438)

2013-01-25  Alan Mackenzie  <acm@muc.de>

	Fix a bug in the state cache mechanism.  Refactor this a bit.

	* progmodes/cc-engine.el (c-parse-state-get-strategy): Remove the
	`cache-pos' element from the return value.
	(c-append-lower-brace-pair-to-state-cache): "Narrow" to end of
	buffer to enable proper searching from beyond HERE.  Amend the
	test for detecting the sought brace pair.  Amend the value written
	to the "brace desert cache" when the brace isn't found.
	(c-remove-stale-state-cache): Rename `good-pos' to `start-point',
	and several other variables analogously.
	(c-remove-stale-state-cache-backwards): Change `cache-pos' from a
	parameter to a locally calculated variable.
	(c-parse-state-1): Change the calling conventions to the two
	defuns involving `cache-pos'.

2013-01-25  Chong Yidong  <cyd@gnu.org>

	* xml.el (xml-entity-or-char-ref-re): Fix regexp.

2013-01-24  Aaron Ecay  <aaronecay@gmail.com>  (tiny change)

	* paren.el (show-paren-function): Make sure to set 'priority and
	'face only if the overlay does exist.

2013-01-24  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-tramp-file-p): Check, whether NAME is unibyte.

	* net/tramp-sh.el (tramp-sh-handle-set-file-acl): Do not suppress
	basic attributes.
	(tramp-sh-handle-set-file-acl): Improve error checking.

2013-01-24  Dmitry Antipov  <dmantipov@yandex.ru>

	* doc-view.el (doc-view-display): Force mode line update until all
	document is converted.  Suggested by Stefan Monnier (Bug#13164).

2013-01-23  Bastien Guerry  <bzg@gnu.org>

	* paren.el (show-paren-function): Make sure an overlay exists
	before trying to delete it.  Also use `pos' as a position only
	when it is an integer.

2013-01-23  Dmitry Antipov  <dmantipov@yandex.ru>

	* play/gametree.el (gametree-break-line-here): Use point-marker.

2013-01-22  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-cmds.el (tramp-bug, tramp-append-tramp-buffers):
	Mark descriptive parts with `display' property.

2013-01-21  Agustín Martín Domingo  <agustin.martin@hispalinux.es>

	* textmodes/ispell.el (ispell-hunspell-dictionary-equivs-alist):
	New variable to map standard dict names to hunspell ones.
	(ispell-set-spellchecker-params): Make sure specific dict names
	are used for standard dicts with hunspell.

2013-01-21  Tassilo Horn  <tsdh@gnu.org>

	* textmodes/reftex-cite.el (reftex-format-citation): Add format
	chars for note (%N) and url (%U).
	* textmodes/reftex-vars.el (reftex-cite-format): Document them.

2013-01-21  Juri Linkov  <juri@jurta.org>

	* frame.el: Bind `f10' in `esc-map' to `toggle-frame-maximized'
	in addition to existing separate binding `meta f10' in `global-map'.
	(Bug#13484)

2013-01-21  Michael Albinus  <michael.albinus@gmx.de>

	Improve XEmacs compatibility.

	* net/tramp.el (tramp-replace-environment-variables): Make it a defun.

	* net/tramp-adb.el (top): Require `time-date'.
	(tramp-adb-ls-output-time-less-p): Use `tramp-time-less-p'.
	(tramp-adb-handle-copy-file, tramp-adb-handle-rename-file):
	Use `tramp-file-name-handler'.
	(tramp-adb-maybe-open-connection):
	Use `tramp-compat-set-process-query-on-exit-flag'.

	* net/tramp-sh.el (tramp-sh-handle-file-acl):
	Use `tramp-compat-funcall'.

	* net/tramp-smb.el (tramp-smb-handle-file-acl): Use `looking-at' and
	`tramp-compat-funcall'.

2013-01-21  Jürgen Hötzel  <juergen@archlinux.org>

	* net/tramp-adb.el (tramp-adb-handle-start-file-process): Complete
	reimplementation using "adb shell command ..." instead of running
	remote shell interactively.

2013-01-20  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/lisp-mode.el (emacs-lisp-mode-map):
	Add native profiler menu entries.

	* profiler.el (profiler-running-p): New function.
	(profiler-cpu-profile): Use profiler-running-p.
	(profiler-report-mode-map): Add some more menu entries.

2013-01-19  Glenn Morris  <rgm@gnu.org>

	* mail/unrmail.el (unrmail): Do not mangle the mbox From line;
	fixes 2012-12-07 change.  (Bug#13499)

2013-01-19  Leo Liu  <sdl.web@gmail.com>

	* dired.el (dired-get-marked-files): Prune erroneous values due to
	last change.  (Bug#13152)

2013-01-19  Glenn Morris  <rgm@gnu.org>

	* progmodes/etags.el (tags-table-check-computed-list):
	Preserve point in tags buffer.  (Bug#13412)

	* emacs-lisp/lisp-mode.el (lisp-indent-function): Doc fix.

2013-01-19  Christian Wittern  <cwittern@gmail.com>  (tiny change)
	    Chong Yidong  <cyd@gnu.org>

	* image-mode.el (image-next-file, image-previous-file):
	New commands (Bug#8453).
	(image-mode-map): Bind them to n and p.
	(image-mode--images-in-directory): New helper function.

2013-01-19  Chong Yidong  <cyd@gnu.org>

	* image-mode.el (image-mode-fit-frame): Add a frame argument.
	Suggested by Drew Adams (Bug#7730).  Handle window decorations;
	save and restore the old window configuration.

2013-01-18  Leo Liu  <sdl.web@gmail.com>

	* progmodes/js.el: Tweak autoload cookie for alias.

2013-01-17  Michael Albinus  <michael.albinus@gmx.de>

	* autorevert.el (auto-revert-notify-watch-descriptor): Make it
	buffer local, again.  This was lost with the fix on 2013-01-12.

2013-01-17  Jürgen Hötzel  <juergen@archlinux.org>

	* eshell/esh-util.el (eshell-path-env): Make it buffer local, in
	order to support several eshell buffers in parallel.

2013-01-17  Michael Albinus  <michael.albinus@gmx.de>

	* autorevert.el (auto-revert-use-notify): In the :set function, do
	not modify `kill-buffer-hook'.
	(auto-revert-notify-rm-watch):
	Remove `auto-revert-notify-rm-watch' from `kill-buffer-hook'.
	(auto-revert-notify-add-watch): Do not call
	`auto-revert-notify-rm-watch', but add it to a buffer local
	`kill-buffer-hook'.

2013-01-16  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/trace.el (trace--read-args): Use a closure and an honest
	call to `eval' rather than a backquoted lambda.

2013-01-15  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/nadvice.el (advice--tweak): Make it possible for `tweak'
	to return an explicit nil.
	(advice--remove-function): Change accordingly.

	* emacs-lisp/advice.el (ad-preactivate-advice): Adjust the cleanup to
	the use of nadvice.el.

	* progmodes/which-func.el (which-function): Silence imenu errors
	(bug#13433).

2013-01-15  Michael R. Mauger  <mmaug@yahoo.com>

	* progmodes/sql.el (sql-imenu-generic-expression):
	(sql-mode-font-lock-object-name): Match schema qualified names.
	(sql-connect): Use string keys.
	(sql-product-interactive): Wait for interpreter prompt.
	(sql-comint-oracle): Set process coding based on NLS_LANG.

2013-01-15  Michael R. Mauger  <mmaug@yahoo.com>

	* progmodes/sql.el (sql-output-to-send): Remove, unused.
	(sql-interactive-remove-continuation-prompt):
	(sql-send-magic-terminator, sql-interactive-mode): Remove references.

2013-01-14  Leo Liu  <sdl.web@gmail.com>

	* calendar/calendar.el (calendar-redraw): Sync window-point and point.
	(Bug#13420)

2013-01-14  Glenn Morris  <rgm@gnu.org>

	* progmodes/compile.el (compilation-error-regexp-alist-alist):
	Fix interpretation of gnu line.col1-col2 format.  (Bug#13335)

2013-01-13  Fabián Ezequiel Gallina  <fgallina@cuca>

	* progmodes/python.el (python-nav-end-of-statement):
	Fix cornercase when handling multiline strings.

2013-01-13  Richard Stallman  <rms@gnu.org>

	* mail/sendmail.el (mail-position-on-field): Add doc string.

	* mail/rmailmm.el (rmail-insert-mime-forwarded-message):
	Get current message boundaries and pass them to
	message-forward-make-body-mime.  Minor style changes.

2013-01-13  Eli Zaretskii  <eliz@gnu.org>

	* cus-start.el (all): Avoid warnings about
	scroll-bar-adjust-thumb-portion on platforms where it is not defined.

2013-01-11  Jan Djärv  <jan.h.d@swipnet.se>

	* cus-start.el (all): Add scroll-bar-adjust-thumb-portion.

2013-01-13  Stefan Monnier  <monnier@iro.umontreal.ca>

	* jit-lock.el (jit-lock-debug-mode): New minor mode.
	(jit-lock--debug-fontifying): New var.
	(jit-lock--debug-fontify): New function.
	* subr.el (condition-case-unless-debug): Don't prevent catching the
	error, just let the debbugger run.
	* emacs-lisp/timer.el (timer-event-handler): Don't prevent debugging
	timer code and don't drop errors silently.

2013-01-12  Michael Albinus  <michael.albinus@gmx.de>

	* autorevert.el (auto-revert-notify-watch-descriptor): Give it
	`permanent-local' property.
	(auto-revert-notify-handler): Use `file-equal-p'.

2013-01-12  Eli Zaretskii  <eliz@gnu.org>

	* autorevert.el (auto-revert-notify-handler): Fix filtering of
	file notification by ACTION.  For filtering by file name, compare
	only the non-directory part of the file name.

2013-01-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* autorevert.el: Use cl-lib instead of cl.

	* vc/vc-bzr.el (vc-bzr--sanitize-header): New function (bug#13307).
	(vc-bzr-checkin): Use it.
	* vc/log-edit.el (log-edit-extract-headers): Don't presume FUNCTION
	will preserve match-data.

2013-01-11  Felix H. Dahlke  <fhd@ubercode.de>

	* progmodes/js.el: Fix multiline declarations's indentation (bug#8576).
	(js--declaration-keyword-re): New var.
	(js--multi-line-declaration-indentation): New function.
	(js--proper-indentation): Use it.

2013-01-11  Aaron S. Hawley  <Aaron.Hawley@vtinfo.com>

	* calc/calc.el (calc-highlight-selections-with-faces)
	 (calc-dispatch):
	* comint.el (comint-history-isearch-message):
	* emacs-lisp/edebug.el (edebug-read, edebug-eval-defun):
	* ffap.el (ffap-string-at-point-region, ffap-next)
	(ffap-string-at-point, ffap-string-around)
	(ffap-copy-string-as-kill, ffap-highlight-overlay)
	(ffap-literally):
	* font-lock.el (font-lock-keywords-alist)
	(font-lock-removed-keywords-alist):
	* help-mode.el (help-xref-symbol-regexp):
	* info.el (Info-find-emacs-command-nodes):
	* international/mule.el (add-to-coding-system-list):
	* isearch.el (isearch-message-function, isearch-fail-pos):
	* misearch.el (multi-isearch-next-buffer-function):
	* newcomment.el (comment-box):
	* printing.el (pr-txt-printer-alist, pr-ps-printer-alist)
	(pr-setting-database):
	* progmodes/cc-fonts.el (c-font-lock-keywords-3)
	(c++-font-lock-keywords-3, objc-font-lock-keywords-3)
	(java-font-lock-keywords-3, idl-font-lock-keywords-3)
	(pike-font-lock-keywords-3):
	* progmodes/compile.el (compile):
	* progmodes/etags.el (tags-table-files)
	(tags-table-files-function, tags-included-tables-function):
	* progmodes/gdb-mi.el (gdb, gdb-setup-windows)
	(gdb-restore-windows):
	* ps-print.el (ps-even-or-odd-pages, ps-spool-buffer-with-faces)
	(ps-n-up-filling-database):
	* server.el (server-buffer, server-log):
	* simple.el (newline, delete-backward-char, delete-forward-char)
	(minibuffer-history-isearch-message, kill-line, track-eol)
	(temporary-goal-column):
	* textmodes/flyspell.el (flyspell-mark-duplications-flag)
	(flyspell-default-deplacement-commands):
	* textmodes/ispell.el (ispell-accept-output):
	* textmodes/sgml-mode.el (html-tag-help):
	* vc/compare-w.el (compare-ignore-whitespace)
	(compare-ignore-case, compare-windows-dehighlight):
	* vc/diff.el (diff):
	* whitespace.el (whitespace-point)
	(whitespace-font-lock-refontify, whitespace-bob-marker)
	(whitespace-eob-marker): Fix ambiguous doc string cross-reference(s).

2013-01-11  Michael Albinus  <michael.albinus@gmx.de>

	* autorevert.el (top): Require 'cl in order to pacify byte compiler.
	(auto-revert-notify-rm-watch): Ignore errors.
	(auto-revert-notify-add-watch): Ignore errors.  Use '(modify) for
	inotify, and '(size last-write-time) for w32notify.
	Set buffer-local `auto-revert-use-notify' to nil when adding a file
	watch fails - this is a fallback to the file modification check.
	(auto-revert-notify-event-p, auto-revert-notify-event-descriptor)
	(auto-revert-notify-event-action)
	(auto-revert-notify-event-file-name): New defuns.
	(auto-revert-notify-handler): Use them.  Implement first
	plausibility checks.
	(auto-revert-handler): Handle also `auto-revert-tail-mode'.

2013-01-11  Julien Danjou  <julien@danjou.info>

	* color.el (color-rgb-to-hsv): Fix conversion computing in case min and
	max are almost equal.  Also return the correct value for V which is
	already between 0 and 1.

2013-01-11  Dmitry Antipov  <dmantipov@yandex.ru>

	* emacs-lisp/ert.el (ert-run-test): Use point-max-marker.

2013-01-11  Eli Zaretskii  <eliz@gnu.org>

	* autorevert.el (auto-revert-notify-rm-watch)
	(auto-revert-notify-add-watch): Fix typos in w32notify function
	names.

2013-01-10  Michael Albinus  <michael.albinus@gmx.de>

	* autorevert.el (auto-revert-notify-enabled): Move up.
	(auto-revert-use-notify): New defcustom.
	(auto-revert-mode, global-auto-revert-mode)
	(auto-revert-notify-add-watch, auto-revert-handler)
	(auto-revert-buffers): Use `auto-revert-use-notify' instead of
	`auto-revert-notify-enabled'.

2013-01-10  Elias Pipping  <pipping@exherbo.org>

	* files.el (auto-mode-alist): Use doc-view for djvu files (bug#13164).
	* doc-view.el (doc-view-document->bitmap):
	Use doc-view-single-page-converter-function instead of
	single-page-converter arg; adjust callers.

2013-01-10  Feng Li  <fengli@gmail.com>  (tiny change)

	* progmodes/which-func.el (which-function): Understand Semantic's use
	of overlays in imenu--index-alist.

2013-01-10  Wolfgang Jenkner  <wjenkner@inode.at>

	* man.el: Handle different "man -k" behaviors (bug#13160).  Use utf-8.
	(Man-man-k-use-anchor): New var.
	(Man-parse-man-k): New function.
	(Man-completion-table): Use it.
	(man): Flush the completion cache between uses.

2013-01-10  Michael Albinus  <michael.albinus@gmx.de>

	* autorevert.el: Add file watch support.
	(auto-revert-notify-enabled): New defconst.
	(auto-revert-notify-watch-descriptor-hash-list)
	(auto-revert-notify-watch-descriptor)
	(auto-revert-notify-modified-p): New defvars.
	(auto-revert-notify-rm-watch, auto-revert-notify-add-watch)
	(auto-revert-notify-handler): New defuns.
	(auto-revert-mode, global-auto-revert-mode): Remove file watches
	when mode is disabled.
	(auto-revert-handler): Check for `auto-revert-notify-modified-p'.
	(auto-revert-buffers): Add file watches for active buffers.

2013-01-10  Dmitry Antipov  <dmantipov@yandex.ru>

	* cus-start.el (toplevel): Only allow float values for
	scroll-up-aggressively and scroll-down-aggressively.
	Allow any number for line-spacing.

2013-01-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* doc-view.el (doc-view-pdfdraw-program): Allow "pdfdraw" name.
	(doc-view-pdf->png-converter-function): Use mupdf if available.
	(doc-view-djvu->png-converter-function)
	(doc-view-ps->png-converter-function): Remove.
	(doc-view--image-file-pattern): Replace doc-view--image-file-extension.
	(doc-view-goto-page, doc-view-convert-current-doc, doc-view-display)
	(doc-view-already-converted-p): Adjust accordingly.
	(doc-view-mode-p): Simplify.
	(doc-view-enlarge): Use setq-local.
	(doc-view-pdf->png-converter-ghostscript)
	(doc-view-djvu->png-converter-ddjvu)
	(doc-view-pdf->png-converter-mupdf): Rework to call
	doc-view-start-process directly.
	(doc-view-pdf/ps->png): Simplify accordingly.
	(doc-view-pdf->png-1, doc-view-djvu->png-1): Remove.
	(doc-view-document->bitmap): Rename from doc-view-document->png.
	(doc-view-convert-current-doc): Merge pdf and djvu cases.
	(doc-view-set-slice-from-bounding-box): Fix completion table.
	(doc-view-mode): Use add-hook for after-revert-hook.

2013-01-10  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/authors.el (authors-ignored-files)
	(authors-valid-file-names, authors-renamed-files-alist):
	Add some more entries.

2013-01-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* image-mode.el (image-mode-winprops): Don't throw away the fallback
	`t' pseudo-window entry.

2013-01-10  Alan Mackenzie  <acm@muc.de>

	Fix bugs in the c-parse-state mechanism.  Reuse some markers
	instead of continually generating new ones.

	* progmodes/cc-engine.el (c-state-old-cpp-beg-marker)
	(c-state-old-cpp-end-marker): New variables.
	(c-append-lower-brace-pair-to-state-cache): Start a backward
	search for "}" definitively outside CPP constructs.
	(c-remove-stale-state-cache): Inform the caller of a need to
	search back for a brace pair in certain circumstances.
	(c-state-maybe-marker): New macro.
	(c-parse-state): Reuse markers when appropriate.

2013-01-10  Glenn Morris  <rgm@gnu.org>

	* simple.el (execute-extended-command): Doc fix.
	Bind prefix-arg around read-extended-command, for prompt.  (Bug#13395)

2013-01-10  Chong Yidong  <cyd@gnu.org>

	* faces.el (read-face-name): Doc fix.

2013-01-10  Roland Winkler  <winkler@gnu.org>

	* emacs-lisp/crm.el: Allow any regexp for separators.
	(crm-default-separator): All spaces around the default comma separator.
	(crm--completion-command): New macro.
	(crm-completion-help, crm-complete, crm-complete-word): Use it.
	(crm-complete-and-exit): Handle non-single-char separators.

2013-01-09  Elias Pipping  <pipping@lavabit.com>

	* doc-view.el: Add support for DjVu (bug#13164).
	(doc-view-djvu->png-converter-function): New config var.
	(doc-view-single-page-converter-function, doc-view--image-type)
	(doc-view--image-file-extension): New vars.
	(doc-view-mode): Initialize them.
	(doc-view-goto-page): Use them.
	(doc-view-mode-p): Add support for ddjvu.
	(doc-view-djvu->png-converter-ddjvu, doc-view-djvu->png-1)
	(doc-view-set-up-single-converter): New funs.
	(doc-view-pdf/ps->png): Extend for djvu.
	(doc-view-document->png): Rename from doc-view-pdf->png.
	(doc-view-convert-current-doc): Handle djvu.
	(doc-view-insert-image, doc-view-display)
	(doc-view-already-converted-p): Don't hardcode png.
	(doc-view-set-doc-type): Recognize djvu docs.

2013-01-09  Elias Pipping  <pipping@lavabit.com>

	* doc-view.el: Add support for mupdf converter (bug#13164).
	(doc-view-pdfdraw-program, doc-view-pdf->png-converter-function)
	(doc-view-ps->png-converter-function): New config vars.
	(doc-view-pdf->png-converter-ghostscript)
	(doc-view-ps->png-converter-ghostscript)
	(doc-view-pdf->png-converter-mupdf): New functions.
	(doc-view-pdf/ps->png, doc-view-pdf->png-1): Use them.

2013-01-09  Jürgen Hötzel  <juergen@archlinux.org>

	* net/tramp.el (tramp-eshell-directory-change): Check remote-path
	first in session cache: When `tramp-own-remote-path' is in
	`tramp-remote-path', the remote path is only set in the session
	cache.

2013-01-09  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/trace.el (trace-function-foreground)
	(trace-function-background): Doc fix.

2013-01-09  Juri Linkov  <juri@jurta.org>

	* international/mule-cmds.el (read-char-by-name): Move let-binding
	of completion-ignore-case around completing-read to fix regression
	exhibited by the test case `C-x 8 RET *acc TAB' and caused by
	`string-match-p' using the nil value of `case-fold-search' and
	`completion-ignore-case' in `completion-pcm--all-completions'.
	(Bug#12615).

2013-01-09  Glenn Morris  <rgm@gnu.org>

	* progmodes/compile.el (compilation-parse-errors):
	Fix typo.  (Bug#13369)

2013-01-09  Vitalie Spinu  <spinuvit@gmail.com>  (tiny change)

	* comint.el (comint-send-input): Check size of buffer before
	waiting for process output, in case already accepted.  (Bug#13290)

2013-01-09  Paul Eggert  <eggert@cs.ucla.edu>

	Spelling fixes.
	* net/tramp-adb.el (tramp-adb-get-toolbox):
	Fix misspelling of 'unknown'.

2013-01-08  Juri Linkov  <juri@jurta.org>

	* textmodes/flyspell.el (flyspell-incorrect, flyspell-duplicate):
	* progmodes/flymake.el (flymake-errline, flymake-warnline):
	Use underline style wave on terminals that support it.  (Bug#13000)

2013-01-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/pcase.el (pcase--split-equal): Also take advantage if
	the predicate returns nil.

	* simple.el: Use lexical-binding.
	(primitive-undo): Use pcase.
	(minibuffer-history-isearch-push-state): Use a closure.

2013-01-08  Aaron S. Hawley  <aaron.s.hawley@gmail.com>

	* simple.el (primitive-undo): Move from undo.c.

2013-01-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc/pcvs.el (cvs-cleanup-collection): Extend meaning of `rm-handled'.
	(cvs-mode-remove-handled): Use it (bug#13380).

	* emacs-lisp/nadvice.el (advice--tweak): New function.
	(advice--remove-function, advice--subst-main): Use it.

	* emacs-lisp/advice.el: Update commentary.

2013-01-08  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-adb.el (tramp-adb-file-name-handler-alist):
	Remove spurious entry.

2013-01-08  Glenn Morris  <rgm@gnu.org>

	* net/tramp.el (tramp-default-host-alist): Add :version.

2013-01-08  Juri Linkov  <juri@jurta.org>

	* info.el (Info-read-node-name-2): Don't duplicate suffixes for
	single completion.  (Bug#12456)
	(info--manual-names): Expand node completions into an explicit list
	before appending it to another list.  Filter out internal buffers
	with the leading space in the buffer name.  (Bug#10771)

2013-01-08  Juri Linkov  <juri@jurta.org>

	* info.el (Info-read-node-name-1): Allow empty node name in (FILENAME)
	that defaults to the Top node.
	(Info-goto-node, Info-read-node-name): Doc fix to mention that
	the short format (FILENAME) goes to the Top node.
	(Info-build-node-completions): Rename arg `file' to `filename'.
	(Bug#13365)

2013-01-07  Bastien Guerry  <bzg@gnu.org>

	* menu-bar.el (menu-bar-search-documentation-menu):
	Use `apropos-user-option' and fix the help message.

2013-01-07  Bastien Guerry  <bzg@gnu.org>

	* apropos.el (apropos-do-all): Update docstring.
	(apropos-user-option-button): New face.
	(apropos-user-option): Rename from `apropos-variable' and update
	docstring.
	(apropos-variable): Rewrite, now show all variables by default.
	(apropos-print): Mention "User option" instead of "Variable" when
	printing doc for user options.  (Bug#13276)

2013-01-07  Jürgen Hötzel  <juergen@archlinux.org>

	* net/tramp-adb.el (tramp-do-parse-file-attributes-with-ls):
	Handle filename correctly, when parsing "source -> target" symlink
	output.
	(tramp-adb-handle-set-file-times): New defun.

2013-01-07  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/advice.el (ad-activate-advised-definition): Refresh the
	advice list when the interactive-spec of ad-Advice-* changes.

2013-01-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* wid-edit.el (widget-default-get): Work for inlined elements.
	(Bug#12670)

2013-01-07  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-default-host-alist): New defcustom.
	(tramp-find-host): Use it.
	(tramp-eshell-directory-change): Move from tramp-sh.el.  Add to
	`eshell-directory-change-hook'.

	* net/tramp-adb.el (top): Add adb specific entry in
	`tramp-default-host-alist'.
	(tramp-adb-file-name-host): Remove function.
	(tramp-adb-execute-adb-command, tramp-adb-maybe-open-connection):
	Use `tramp-file-name-host' instead of `tramp-adb-file-name-host'.

	* net/tramp-sh.el: Move eshell integration code to tramp.el.

2013-01-06  Jürgen Hötzel  <juergen@archlinux.org>

	* net/tramp-adb.el (tramp-methods): Add `tramp-tmpdir' entry.

2013-01-06  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-adb.el (tramp-adb-ls-toolbox-regexp): The file size can
	consist of more than one digit.
	(tramp-adb-file-name-handler-alist):
	Use `tramp-handle-file-exists-p' consistently.
	(tramp-adb-file-name-handler): Don't tweak `tramp-default-host'.
	(tramp-adb-handle-file-exists-p): Remove function.
	(tramp-adb-file-name-host): New defun.
	(tramp-adb-execute-adb-command, tramp-adb-maybe-open-connection):
	Use it.
	(tramp-adb-maybe-open-connection): Set "remote-path" property.

2013-01-06  Chong Yidong  <cyd@gnu.org>

	* vc/vc.el (vc-next-action): Detect buffer modifications
	conflicting with locking VCS operation (Bug#11490).

	* vc/vc-hooks.el (vc-after-save): DTRT for locking VCSes.

2013-01-05  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-adb.el (tramp-do-parse-file-attributes-with-ls):
	(tramp-adb-handle-directory-files-and-attributes): Fix typos.

2013-01-05  Jürgen Hötzel  <juergen@archlinux.org>

	* net/tramp-adb.el (tramp-adb-handle-file-attributes): More robust
	parsing of ls output using regular expression (handle filenames
	with spaces).  Use virtual device number.
	(tramp-do-parse-file-attributes-with-ls): New defun (Code
	cleanup).

2013-01-04  Daiki Ueno  <ueno@gnu.org>

	* epg.el: Silence byte-compiler warnings.
	(epg--start): Use delete-char instead of delete-backward-char.
	(epg-wait-for-completion): Pass FRAME arg to redraw-frame.

2013-01-04  Daiki Ueno  <ueno@gnu.org>

	* epg.el (epg--start): Don't call "tty" program on W32 platforms.
	Suggested by Eli Zaretskii  <eliz@gnu.org>.

2013-01-04  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-sh.el (tramp-set-file-uid-gid): UID and GID must be
	non-negative integers.  Otherwise, the default values are used.
	(tramp-convert-file-attributes): Convert uid and gid to integers.

2013-01-04  Glenn Morris  <rgm@gnu.org>

	* term.el (term-handle-colors-array): Ensure face attributes
	are fully specified, not nil.  (Bug#13337)

	* term.el (term-default-fg-color, term-default-bg-color):
	Fix custom type.

	* progmodes/etags.el (tags-compression-info-list): Doc fix.
	(tag-find-file-of-tag-noselect): Check auto-compression-mode
	rather than 'jka-compr being loaded.  (Bug#13338)

2013-01-04  Wesley Dawson  <whd@lavabit.com>  (tiny change)

	* icomplete.el (icomplete-completions):
	Honor icomplete-prospects-height once more following
	2012-11-29 changes.  (Bug#13224)

2013-01-04  Stefan Monnier  <monnier@iro.umontreal.ca>

	* subr.el (internal--called-interactively-p--get-frame): Find aliases
	of called-interactively-p as well (bug#13237).

	* view.el (view--enable, view--disable): Rename from view-mode-enable
	and view-mode-disable and assume it's called from view-mode.
	(view-mode-enable, view-mode-disable): Redefine as obsolete
	compatibility layer above view-mode.
	(view-mode-enter): Call `view-mode'.

	* files.el (after-find-file): Call `view-mode'.

	* doc-view.el (doc-view-scale-internally): New var.
	(doc-view-enlarge, doc-view-insert-image): Obey it.

2013-01-03  Daiki Ueno  <ueno@gnu.org>

	* epg.el (epg--start): Ignore errors when /dev/fd/0 does not
	exist.  (Bug#13344)

2013-01-03  Glenn Morris  <rgm@gnu.org>

	* mail/rmail.el (rmail-set-header-1): Ignore case.
	Handle multi-line headers.  (Bug#13330)

	* progmodes/make-mode.el (makefile-fill-paragraph): Add doc.
	Handle paragraph starting at beginning of buffer.

	* subr.el (eval-after-load): Don't purecopy the form, so that it
	can be nconc'd later on; reverts 2009-11-11 change.  (Bug#13331)

	* emacs-lisp/byte-run.el (defun): Place cl declarations
	after any interactive spec.  (Bug#13265)

2013-01-02  Andreas Schwab  <schwab@linux-m68k.org>

	* emacs-lisp/byte-run.el (defmacro): Use same argument parsing as
	defun.  Don't check for DECL if DOCSTRING isn't a string.
	(defun): Likewise.

2013-01-02  Glenn Morris  <rgm@gnu.org>

	* eshell/em-cmpl.el (eshell-pcomplete):
	More thoroughly imitate pcomplete.  (Bug#13293)

	* files.el (parse-colon-path): Doc fix.  (Bug#12351)
	Return nil for empty path elements.  (Bug#13296)

2013-01-02  Fabián Ezequiel Gallina  <fgallina@cuca>

	* progmodes/python.el (python-nav-end-of-statement): Rewrite in
	order to improve efficiency (Based on Daniel Colascione's
	<dancol@dancol.org> patch).  (Bug#13182)

2013-01-02  Glenn Morris  <rgm@gnu.org>

	* vc/log-edit.el (log-edit-header-contents-regexp): Add doc string.

2013-01-02  Andreas Schwab  <schwab@linux-m68k.org>

	* emacs-lisp/byte-run.el (defmacro): Don't lose final nil if
	neither DOCSTRING nor DECL was given.  (Bug#13316)

2013-01-02  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-sh.el (tramp-sh-handle-set-file-acl): Add argument to
	`error' call.
	(tramp-do-copy-or-rename-file): Ignore errors when calling
	`set-file-extended-attributes'.

	* net/tramp-smb.el (tramp-smb-file-name-handler-alist):
	Add handler for `file-acl'.
	(tramp-smb-handle-file-acl): New defun.

2013-01-02  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/README: Mention ISO 8601 week-numbering dates.

2013-01-01  Martin Rudalics  <rudalics@gmx.at>

	* view.el (view-mode-enable): New argument run-view-mode-hook.
	Run view-mode-hook only when it's non-nil (Bug#13315).
	(view-mode-enter): Call view-mode-enable with run-view-mode-hook
	argument t.

2012-12-31  Jürgen Hötzel  <juergen@archlinux.org>

	* net/tramp-adb.el (tramp-adb-maybe-open-connection): Handle errors
	(No device connected, invalid device name).  (Bug #13299)

2012-12-31  Martin Rudalics  <rudalics@gmx.at>

	* window.el (window-resizable--p): Rename to window-resizable-p.
	(window-resize-no-error): New function.

	* mail/rmail.el (rmail-maybe-display-summary): Restore behavior
	broken in fix from 2012-12-28.

2012-12-31  Stefan Monnier  <monnier@iro.umontreal.ca>

	* subr.el (special-form-p): Don't signal errors on undef aliases.

2012-12-31  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-forms.el (math-parse-date): Try using
	`math-parse-iso-date' when it looks like it might be needed.
	Allow times of 24:00.
	(math-parse-date-validate, math-parse-iso-date-validate): Allow times
	of 24:00.

2012-12-30  Glenn Morris  <rgm@gnu.org>

	* net/mairix.el (rmail, rmail-summary-displayed, rmail-summary):
	Remove unnecessary/buggy autoloads (missing interactive).  (Bug#13294)
	(rmail-summary-displayed, rmail-summary): Declare.
	(mairix-rmail-display): Just require rmail.

2012-12-30  Chong Yidong  <cyd@gnu.org>

	* emacs-lisp/package.el (package-untar-buffer): Improve integrity
	check for the tarball contents.

2012-12-30  Matt Fidler  <matt.fidler@alcon.com>  (tiny change)

	* emacs-lisp/package.el (package-untar-buffer): Handle problematic
	tarfile content listings (Bug#13136).

2012-12-30  Mark Lillibridge  <mark.lillibridge@hp.com>

	* mail/rmailmm.el (rmail-insert-mime-forwarded-message):
	Insert the undecoded text of the message being forwarded.  (Bug#9521)

2012-12-30  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-sh.el (tramp-set-file-uid-gid): Convert UID and GID to
	integers, if they are real numbers.  (Bug#13282)

	* net/tramp-sh.el (tramp-sh-handle-set-file-selinux-context):
	Return `t' on success.

	* net/tramp-smb.el (tramp-smb-file-name-handler-alist):
	Add handler for `set-file-selinux-context'.

2012-12-29  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-sh.el (tramp-sh-handle-file-acl): Suppress basic attributes.
	(tramp-sh-handle-set-file-acl): Return `t' on success.

2012-12-29  Eli Zaretskii  <eliz@gnu.org>

	* files.el (backup-buffer-copy, basic-save-buffer-2):
	If set-file-extended-attributes fails, fall back on set-file-modes
	instead of signaling an error.  (Bug#13298)
	(basic-save-buffer): Likewise.

2012-12-29  Fabián Ezequiel Gallina  <fgallina@cuca>

	* progmodes/python.el: Support other commands triggering
	python-indent-line so indentation cycling continues to work.
	(python-indent-trigger-commands): New defcustom.
	(python-indent-line): Use it.

2012-12-29  Fabián Ezequiel Gallina  <fgallina@cuca>

	* progmodes/python.el (python-shell-send-region): Add blank lines
	for non sent code so backtraces remain correct.

2012-12-29  Fabián Ezequiel Gallina  <fgallina@cuca>

	* progmodes/python.el: Remove cl dependency.
	(python-syntax-count-quotes): Replace incf call.
	(python-fill-string): Replace setf call.

2012-12-29  Damien Cassou  <damien.cassou@gmail.com>

	* info.el (info-other-window): New arg, for consistency with info.

2012-12-28  Martin Rudalics  <rudalics@gmx.at>

	* mail/rmail.el (rmail-maybe-display-summary):
	Rewrite (Bug#13066).

2012-12-28  Andreas Schwab  <schwab@linux-m68k.org>

	* epg.el (epg--start): Modify process-environment locally.

2012-12-28  Daiki Ueno  <ueno@gnu.org>

	* epg.el: Support pinentry-curses.
	Suggested by Werner Koch in
	<https://lists.gnu.org/r/emacs-devel/2007-02/msg00755.html>.
	(epg-agent-file, epg-agent-mtime): New variable.
	(epg--start): Record the modified time of gpg-agent socket file,
	to restore Emacs frame after pinentry-curses termination.
	(epg-wait-for-completion): Restore Emacs frame here.

2012-12-27  Juri Linkov  <juri@jurta.org>

	* info.el (Info-file-completions): New variable.
	(Info-read-node-name-1): Complete node names in the Info file
	when a file name is given.  Call `Info-build-node-completions'
	with a file name.
	(Info-build-node-completions): Add new arg `file'.  When it is
	non-nil, visit it in a temporary buffer and cache its completions in
	`Info-current-file-completions'.  Move most of the function body to
	`Info-build-node-completions-1'.
	(Info-build-node-completions-1): New function with the body from
	`Info-build-node-completions'.  (Bug#12456)

2012-12-27  Juri Linkov  <juri@jurta.org>

	* frame.el (frame-maximization-style): Remove user option.
	(cycle-frame-maximized): Remove function.
	(toggle-frame-maximized): Rewrite and bind to M-<f10>.
	(toggle-frame-fullscreen): New command bound to <f11> instead of
	`toggle-frame-maximized'.
	https://lists.gnu.org/r/emacs-devel/2012-12/msg00703.html

2012-12-27  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-handle-file-accessible-directory-p): New defun.

	* net/tramp-adb.el (tramp-adb-file-name-handler-alist):
	* net/tramp-gvfs.el (tramp-gvfs-file-name-handler-alist):
	* net/tramp-sh.el (tramp-sh-file-name-handler-alist): Add handler
	for `file-accessible-directory-p'.  (Bug#13275)

2012-12-27  Sam Steingold  <sds@gnu.org>

	* progmodes/cperl-mode.el (cperl-calculate-indent): Do not stagger
	continuations, see <http://stackoverflow.com/questions/3582436>.

2012-12-27  Dmitry Gutov  <dgutov@yandex.ru>

	* progmodes/ruby-mode.el (ruby-indent-beg-re): Only allow "class",
	"module" and "def" to have indentation before them.
	Regression from 2012-09-07T04:15:56Z!dgutov@yandex.ru (see the new test).

	* progmodes/ruby-mode.el: Bump the version to 1.2 (Bug#13200).

2012-12-27  Alan Mackenzie  <acm@muc.de>

	Speed up fontification where there's large brace blocks.
	* progmodes/cc-fonts.el (c-font-lock-enclosing-decls): Add a limit
	to a call of c-beginning-of-decl-1.

2012-12-27  Vitalie Spinu  <spinuvit@gmail.com>  (tiny change)

	* comint.el (comint-adjust-window-point): New function.
	(comint-postoutput-scroll-to-bottom):
	Call comint-adjust-window-point (Bug#13248).

2012-12-26  Dmitry Gutov  <dgutov@yandex.ru>

	* progmodes/ruby-mode.el (auto-mode-alist): `purecopy' the
	Rakefile regexp.
	(auto-mode-alist): Associate .gemspec files with ruby-mode
	(https://bugs.ruby-lang.org/issues/5453).

2012-12-26  Jürgen Hötzel  <juergen@archlinux.org>

	* net/tramp-adb.el (tramp-adb-get-ls-command): New defun.
	Suppress coloring, if possible (required for BusyBox based systems like
	CyanogenMod).
	(tramp-adb-handle-file-attributes)
	(tramp-adb-handle-insert-directory)
	(tramp-adb-handle-file-name-all-completions): Use it.
	(tramp-adb-get-toolbox): New defun.  Check for remote shell
	implementation (BusyBox or Toolbox).

2012-12-24  Constantin Kulikov  <zxnotdead@gmail.com>  (tiny change)

	* startup.el (initial-buffer-choice): Allow function as value
	(Bug#13251).
	(command-line-1): Handle case where initial-buffer-choice
	specifies a function.
	* server.el (server-execute): Handle case where
	initial-buffer-choice specifies a function.

2012-12-24  Lars Ingebrigtsen  <larsi@gnus.org>

	* mail/smtpmail.el (smtpmail-try-auth-method): Refactored out into
	its own function.
	(smtpmail-try-auth-methods): Forget the user name/password if the
	login is unsuccessful (bug#12424).

2012-12-22  Michael Albinus  <michael.albinus@gmx.de>

	* notifications.el (notifications-notify): Protect body with
	`with-demoted-errors'.

	* net/tramp-adb.el (tramp-adb-maybe-open-connection):
	Check properties of remote device.  Restart connection, if there is a
	change.

2012-12-21  Chong Yidong  <cyd@gnu.org>

	* sort.el (sort-subr): Doc fix (Bug#13056).

2012-12-21  Bastien Guerry  <bzg@gnu.org>

	* progmodes/etags.el (tags-search): Fix typo.  Bug #13232.

2012-12-21  Michael Albinus  <michael.albinus@gmx.de>

	* simple.el (process-file): Overwrite stderr file, if exists.

2012-12-21  Daiki Ueno  <ueno@gnu.org>

	* epg.el (epg--start): Print GPG_AGENT_INFO in the debug buffer.
	(epg-error): Set `error-message' property.

2012-12-21  Chong Yidong  <cyd@gnu.org>

	* international/mule-cmds.el (read-char-by-name): Signal an error
	if the user does not supply a valid character (Bug#13177).

	* simple.el (transpose-subr-1): Preserve marker positions by
	changing the insertion sequence (Bug#13122).

2012-12-21  Kelly Dean  <kellydeanch@yahoo.com>  (tiny change)

	* simple.el (kill-region): Deactivate mark even for empty regions
	(Bug#13169).

2012-12-21  Chong Yidong  <cyd@gnu.org>

	* help-fns.el (describe-variable): Make sure we get the right
	buffer name (Bug#13105).  Suggested by Kelly Dean.

2012-12-20  Michael R. Mauger  <mmaug@yahoo.com>

	* comint.el (comint-redirect-previous-input-string): New variable.
	(comint-redirect-setup, comint-redirect-cleanup)
	(comint-redirect-preoutput-filter): Use it.  Fixes redirection bug.
	(comint-redirect-preoutput-filter): Fix verbose message.

2012-12-20  Michael Albinus  <michael.albinus@gmx.de>

	* progmodes/grep.el (rgrep): Escape command line.  Sometimes, it
	is too long for Tramp.  See discussion in
	<http://thread.gmane.org/gmane.emacs.tramp/8233/focus=8244>.

	* progmodes/compile.el (compilation-start): Remove line escape
	template.

2012-12-20  Dmitry Antipov  <dmantipov@yandex.ru>

	* vc/ediff-ptch.el (ediff-map-patch-buffer): Use `point-min-marker'.
	Adjust comment.

2012-12-19  Jonas Bernoulli  <jonas@bernoul.li>

	* emacs-lisp/lisp-mnt.el (lm-section-end): Always end before the
	following non-comment text (bug#13207).
	(lm-header-multiline): Continuation lines need to be indented more than
	the first line.
	(lm-homepage): New function.
	(lm-with-file): Don't be confused if narrowing is in effect.

2012-12-19  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc/diff-mode.el (diff-post-command-hook): Don't ignore changes at the
	very beginning of a hunk (e.g. killing the first line).

2012-12-19  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-sh.el (tramp-sh-handle-file-acl): Delete empty lines
	and text properties from returned ACL string.
	(tramp-sh-handle-set-file-acl): Do not use additional parentheses
	for "setfacl" command.

2012-12-18  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-error-with-buffer): Give a hint to use
	`tramp-cleanup-this-connection', when the process has died.
	(Bug#13151)

2012-12-17  Stefan Monnier  <monnier@iro.umontreal.ca>

	* icomplete.el (icomplete-completions): Also use … to truncate prefix.

2012-12-17  Kevin Ryde  <user42@zip.com.au>

	* files.el (auto-save-file-name-p): Use \` and \' (bug#13186).

2012-12-17  Michael Albinus  <michael.albinus@gmx.de>

	Add support for preserving ACL entries of files.

	* net/tramp.el (tramp-file-name-for-operation): Add `file-acl' and
	`set-file-acl' handlers.

	* net/tramp-adb.el (tramp-adb-handle-copy-file):
	Handle PRESERVE-EXTENDED-ATTRIBUTES.

	* net/tramp-compat.el (tramp-compat-copy-file):
	Handle PRESERVE-EXTENDED-ATTRIBUTES.

	* net/tramp-gvfs.el (tramp-gvfs-file-name-handler-alist):
	Add `file-acl' and `set-file-acl' handlers.
	(tramp-gvfs-handle-copy-file):
	Handle PRESERVE-EXTENDED-ATTRIBUTES.
	(tramp-gvfs-handle-file-acl, tramp-gvfs-handle-set-file-acl):
	New defuns.

	* net/tramp-sh.el (tramp-sh-file-name-handler-alist):
	Add `file-acl' and `set-file-acl' handlers.
	(tramp-remote-acl-p, tramp-sh-handle-file-acl)
	(tramp-sh-handle-set-file-acl): New defuns.
	(tramp-sh-handle-copy-file, tramp-do-copy-or-rename-file):
	Handle PRESERVE-EXTENDED-ATTRIBUTES.

	* net/tramp-smb.el (tramp-smb-file-name-handler-alist):
	Add `file-acl' and `set-file-acl' handlers.
	(tramp-smb-handle-copy-file): Handle PRESERVE-EXTENDED-ATTRIBUTES.

2012-12-17  Kelly Dean  <kellydeanch@yahoo.com>  (tiny change)

	* help-macro.el (make-help-screen): Instead of switch-to-buffer
	use pop-to-buffer with NORECORD argument t.  As buffer name, use
	*Metahelp* with a leading space (Bug#13146).

2012-12-16  Romain Francoise  <romain@orebokech.com>

	* files.el (file-extended-attributes)
	(set-file-extended-attributes): New functions.
	(backup-buffer): Use them to handle both SELinux context and ACL
	entries.
	(backup-buffer-copy): Work with an alist of extended attributes,
	rather than an SELinux context.
	(basic-save-buffer-2): Ditto.

2012-12-16  Timo Myyrä  <timo.myyra@gmail.com>

	* battery.el (battery-bsd-apm): New function.

2012-12-16  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc.el (calc-standard-date-formats): Adjust one of the
	standard date formats.

2012-12-15  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-mode-map): Bind `C-x 8 RET' to
	`isearch-insert-char-by-name'.
	(with-isearch-suspended): New defmacro with body mostly from
	`isearch-edit-string' except the part that sets
	`isearch-new-string' and `isearch-new-message'.
	(isearch-edit-string): Use new macro `with-isearch-suspended' with
	body that sets `isearch-new-string' and `isearch-new-message'.
	(isearch-insert-char-by-name): New command.
	* international/mule-cmds.el (read-char-by-name): Let-bind
	`enable-recursive-minibuffers' to t.
	https://lists.gnu.org/r/emacs-devel/2012-12/msg00234.html

2012-12-15  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-delete-char, isearch-del-char): Doc fix.
	(Bug#13175)

2012-12-15  Christopher Schmidt  <christopher@ch.ristopher.com>

	* dired-x.el (dired-guess-shell-command): Put colon at the end of
	the prompt.  (Bug#13045)

2012-12-14  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/macroexp.el (macroexp--warn-and-return):
	Try to include filename in non-bytecomp warning.  (Bug#13132)

2012-12-14  Paul Eggert  <eggert@cs.ucla.edu>

	Fix permissions bugs with setgid directories etc.  (Bug#13125)
	* files.el (backup-buffer): Don't rely on 9th output of
	file-attributes, as it's now a placeholder.  Instead, use the new
	optional arg of file-ownership-preserved-p.
	(file-ownership-preserved-p): New optional arg GROUP.
	Fix mishandling of setuid directories that would cause this
	function to return t when it should have returned nil.
	Document what happens if the file does not exist, and when
	it's not known whether the ownership will be preserved.
	* net/tramp-sh.el (tramp-sh-handle-file-ownership-preserved-p):
	Likewise.
	(tramp-get-local-gid): Use group-gid for integer, as that's
	faster and more reliable.

2012-12-14  Julien Danjou  <julien@danjou.info>

	* progmodes/sql.el (sql-mode-postgres-font-lock-keywords):
	Update keywords list, data type and PL/pgSQL.

2012-12-14  Dave Abrahams  <dave@boostpro.com>

	* vc/ediff-util.el (ediff-buffer-type): New function.
	(ediff-clone-buffer-for-current-diff-comparison): Compute the buf-type
	rather than taking it as an argument.
	(ediff-inferior-compare-regions): Adjust calls accordingly (bug#11319).

2012-12-14  Ryan Crum  <ryan.crum@eleostech.com>

	* json.el: Add pretty-print option (bug#12634).
	(json-encoding-separator, json-encoding-default-indentation)
	(json--encoding-current-indentation, json-encoding-pretty-print)
	(json-encoding-lisp-style-closings): New vars.
	(json--with-indentation): New macro.
	(json-encode-hash-table, json-encode-alist, json-encode-plist)
	(json-encode-array): Use it to obey json-encoding-pretty-print.
	(json-pretty-print-buffer, json-pretty-print): New commands.

2012-12-14  Dmitry Gutov  <dgutov@yandex.ru>

	* progmodes/ruby-mode.el (ruby-syntax-propertize-function):
	Extract `ruby-syntax-propertize-expansions'.
	(ruby-syntax-propertize-expansions): Only change syntax on
	certain string delimiters, to punctuation.  This way the common
	functions like forward-word and thing-at-point still work.
	(ruby-match-expression-expansion): Improve readability.
	(ruby-block-contains-point): New function.
	(ruby-add-log-current-method): Handle several edge cases.

2012-12-13  Juanma Barranquero  <lekktu@gmail.com>

	* emacs-lisp/edebug.el (edebug-unload-function): Make sure that
	unload-feature finishes even when aborting an ongoing edebug session.
	Also, do not worry about edebug-mode, unload-feature takes care of it.

2012-12-13  Andreas Schwab  <schwab@suse.de>

	* net/tls.el (tls-program): Update customize type.

2012-12-13  Juanma Barranquero  <lekktu@gmail.com>

	* emacs-lisp/edebug.el (edebug--require-cl-read): New function.
	(edebug-setup-hook, cl-read-load-hooks): Use it.
	(edebug-unload-function): New function.  (Bug#13163)

2012-12-13  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-adb.el (tramp-adb-file-name-p): Make it a defsubst.
	Otherwise, there could be errors in autoloading.  (Bug#13151)

2012-12-13  Jürgen Hötzel  <juergen@archlinux.org>

	* net/tramp-adb.el (tramp-adb-wait-for-output): Remove spurious " ^H"
	sequences.

2012-12-13  Alan Mackenzie  <acm@muc.de>

	Make CC Mode not hang when _some_ lines end in CRLF.  Bug #11841.
	* progmodes/cc-engine.el (c-backward-comments): Add code to work
	around `forward-comment' not recognizing ^M as whitespace.

2012-12-13  Fabián Ezequiel Gallina  <fgallina@cuca>

	* progmodes/python.el (python-skeleton-class)
	(python-skeleton-def): Do not add space after defun name.

2012-12-13  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/cl.el (letf): Make it an alias of cl-letf.
	(cl--symbol-function): Remove (now that funbound is like nil).

2012-12-12  Glenn Morris  <rgm@gnu.org>

	* button.el (button--area-button-p): Fix typo.

2012-12-12  Sam Steingold  <sds@gnu.org>

	* frame.el (frame-maximization-style): New user option.
	(toggle-frame-maximized): Toggle frame maximization according to
	`frame-maximization-style', bound to <f11>.
	(cycle-frame-maximized): Cycle between all maximization styles and
	non-maximized frame, bound to shift-<f11>.

2012-12-12  David Cadé  <codename68@gmail.com>

	* mpc.el (mpc-format): Use truncate-string-to-width (bug#13143).

2012-12-12  Jonas Bernoulli  <jonas@bernoul.li>

	* emacs-lisp/eieio.el: Prettier object pretty-printing (bug#13115).
	(eieio-override-prin1): Don't quote kewords and booleans.
	(object-write) <eieio-default-superclass>: Don't put closing parens
	on new line, avoid needless empty lines, align values that are objects
	with the slot keyword (instead of beginning on the same line).
	(eieio-list-prin1): Align value with slot keyword; increase
	eieio-print-depth before printing members of the list.

2012-12-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* mail/emacsbug.el (report-emacs-bug): Move the intangible text to
	a display text-property.
	(report-emacs-bug-hook): Don't bother deleting it any more.

	* hilit-chg.el (highlight-save-buffer-state): Delete.
	Use with-silent-modifications instead.
	(hilit-chg-set-face-on-change): Only fixup the text that's modified.

	* button.el: Handle buttons in display text-properties.
	(button--area-button-p, button--area-button-string):
	Use (STRING . STRING-POS) representation instead of just STRING.

2012-12-11  Eli Zaretskii  <eliz@gnu.org>

	* makefile.w32-in (compile4-SH): Fix a typo that caused term
	subdirectory be skipped.

2012-12-11  Glenn Morris  <rgm@gnu.org>

	* net/rcirc.el (rcirc-urls, rcirc-condition-filter): Doc fixes.

	* progmodes/f90.el (f90-line-continued, f90-indent-region):
	Treat preprocessor lines embedded in continuations like comments.
	(f90-indent-line): Special-case preprocessor lines.  (Bug#13138)

2012-12-11  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc.el (calc-standard-date-formats): Add more date
	formats.
	* calc/calc-forms.el (math-parse-iso-date): New function.
	(math-parse-date): Use `math-parse-iso-date' when appropriate.
	(math-parse-iso-date-validate): Add extra error checking.
	(calc-date-notation): Add ability to access new date formats.

2012-12-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* hi-lock.el (hi-lock--regexps-at-point): Fix boundary case for
	font-lock as well as when there's no text-property.

2012-12-10  Jambunathan K  <kjambunathan@gmail.com>

	* hi-lock.el: Refine the choice of default face.
	(hi-lock-keyword->face): New function.  Use it wherever we used
	cadadadr instead.
	(hi-lock--regexps-at-point): Ignore faces that can't come from hi-lock.
	(hi-lock--last-face): Remove var.
	(hi-lock--unused-faces): New var to replace it.
	(hi-lock-read-face-name): Use/maintain it.
	(hi-lock-unface-buffer): Maintain it.  Fix error for the C-u case.
	(hi-lock-set-pattern): Ignore new rule if it has the same regexp even
	if it has another face.

2012-12-10  Eli Zaretskii  <eliz@gnu.org>

	* subr.el (w32notify-handle-event): New function.
	(inotify-handle-event): Doc fix.

2012-12-10  Rüdiger Sonderfeld  <ruediger@c-plusplus.de>

	* subr.el (inotify-event-p, inotify-handle-event): New functions.

2012-12-10  Dani Moncayo  <dmoncayo@gmail.com>

	* simple.el (just-one-space): Doc fix.

2012-12-10  Eli Zaretskii  <eliz@gnu.org>

	* textmodes/texinfo.el (texinfo-enable-quote-envs): Add "smallexample".

2012-12-10  Le Wang  <l26wang@gmail.com>

	* hilit-chg.el (hilit-chg-set-face-on-change): Don't burp in
	narrowed buffer (bug#12361).

2012-12-10  Juanma Barranquero  <lekktu@gmail.com>

	* vc/vc-hooks.el (vc-state): Doc fix.

2012-12-10  Glenn Morris  <rgm@gnu.org>

	* mail/rmail.el (rmail-maybe-display-summary):
	Preserve buffer, in case select-window changes it.  (Bug#13066)

2012-12-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/cl.el, emacs-lisp/cl-lib.el: Move cl-unload-function and
	cl-load-hook where they belong.

2012-12-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/cl-lib.el (cl-declaim): Paren typo.

2012-12-09  Eli Zaretskii  <eliz@gnu.org>

	Parallelize byte compilation on MS-Windows.
	* makefile.w32-in (WINS_BASIC1, WINS_BASIC2, WINS_BASIC3)
	(WINS_BASIC4): New variables, subdivide subdirectories into 4 parts.
	(WINS_BASIC): Define as concatenation of the above.
	(compile): Subdivide into 4 separate and independent jobs that can
	be run in parallel.
	(compile0-CMD, compile0-SH): New targets for compiling
	COMPILE_FIRST files, which are prerequisites for the rest of the
	byte-compilation.
	(compile1-CMD, compile2-CMD, compile3-CMD, compile4-CMD):
	New targets for parallel compilation with cmd.exe.
	(compile1-SH, compile2-SH, compile3-SH, compile4-SH): Ditto for
	compiling under a Unixy shell.

2012-12-09  Chong Yidong  <cyd@gnu.org>

	* simple.el (set-mark-default-inactive): Delete this
	accidentally-introduced option.
	(set-mark-command, exchange-point-and-mark): Remove calls.

2012-12-09  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/lisp-mode.el (eval-defun-1): Doc fix.
	Respect a defcustom's :set function, if appropriate.  (Bug#109)
	(eval-defun): Doc fix.

2012-12-08  Juri Linkov  <juri@jurta.org>

	* info.el (Info-copy-current-node-name, Info-breadcrumbs)
	(Info-fontify-node, Info-bookmark-make-record): Remove the
	file extension from Info-current-file (Bug#13016).

2012-12-07  Stefan Monnier  <monnier@iro.umontreal.ca>

	* hi-lock.el (hi-lock-unface-buffer): If there's no matching regexp at
	point, still provide some default.
	(hi-lock--regexps-at-point): Don't enforce a "hi-lock-" prefix on face
	names, since we don't use it right now.  Actually return the list.
	(hi-lock-file-patterns, hi-lock-interactive-patterns): Use defvar-local.

2012-12-07  Chong Yidong  <cyd@gnu.org>

	* novice.el (disabled-command-function): Remove a spurious help
	xref (Bug#13043).  Suggested by Kelly Dean.

	* subr.el (text-clone-maintain): Fix clone overlay deletion when a
	syntax is specified (Bug#13025).

	* info.el (Info-set-mode-line): Remove the file extension from
	Info-current-file if there is one (Bug#13016).

2012-12-07  Glenn Morris  <rgm@gnu.org>

	* mail/rmail.el (rmail-mime-decoded): New permanent local.
	(rmail-show-message-1): Set rmail-mime-decoded when appropriate.
	* mail/rmailedit.el (rmail-cease-edit): Respect rmail-mbox-format
	and rmail-mime-decoded.  (Bug#9841)

	* mail/unrmail.el (unrmail-mbox-format): New option.  (Bug#6574)
	(batch-unrmail, unrmail): Doc fixes.
	(unrmail): Respect unrmail-mbox-format.
	* mail/rmail.el (rmail-mbox-format): New option.
	(rmail-show-message-1): Respect rmail-mbox-format.

2012-12-07  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/cl-macs.el (cl-tagbody): New macro.

2012-12-06  Stefan Monnier  <monnier@iro.umontreal.ca>

	Further cleanup of the "cl-" namespace.  Fit CL in 80 columns.
	* emacs-lisp/cl-macs.el (cl--pop2, cl--optimize-safety)
	(cl--optimize-speed, cl--not-toplevel, cl--parse-loop-clause)
	(cl--expand-do-loop, cl--proclaim-history, cl--declare-stack)
	(cl--do-proclaim, cl--proclaims-deferred): Rename from the "cl-" prefix.
	(cl-progv): Don't rely on dynamic scoping to find the body.
	* emacs-lisp/cl-lib.el (cl--optimize-speed, cl--optimize-safety)
	(cl--proclaims-deferred): Rename from the "cl-" prefix.
	(cl-declaim): Use backquotes.
	* emacs-lisp/cl-extra.el (cl-make-random-state, cl-random-state-p):
	Use "cl--" prefix for the object's tag.

	* ses.el: Use advice-add/remove.
	(ses--advice-copy-region-as-kill, ses--advice-yank): New functions.
	(copy-region-as-kill, yank): Use advice-add.
	(ses-unload-function): Use advice-remove.

2012-12-06  Jonas Bernoulli  <jonas@bernoul.li>

	* button.el: Make them work in header-lines (bug#12817).
	(button-map): Add bindings for header-line and mode-line use.
	(button-get, button-put, button-label): `button' may now be a string.
	(button-activate): Don't make it a defsubst.
	(button--area-button-p, button--area-button-string): New functions.
	(make-text-button): Fix the return value when `beg' was a string.
	(push-button): Handle the mode-line case.

2012-12-06  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/sql.el: Use cl-lib and lexical-binding; various cleanup.
	(sql-signum): Remove.  Use `cl-signum' instead.
	(sql-read-passwd): Remove; use read-passwd instread.
	(sql-get-login-ext): Use read-string.
	(sql-get-login): Use dolist and pcase.
	(sql--completion-table): Rename from sql-try-completion.
	Use complete-with-action.
	(sql-mode): Don't change abbrev-all-caps globally.
	(sql-connect): Don't rely on dynamic scoping for `new-name'.
	(sql-postgres-completion-object): Initialize vars in their `let'.
	(sql-comint-sybase, sql-comint-sqlite, sql-comint-mysql)
	(sql-comint-solid, sql-comint-ms, sql-comint-postgres)
	(sql-comint-interbase): Use a single append, without setq.
	(sql-comint-linter): Same, and unwind-protect the LINTER_MBX var.

	* hi-lock.el: Rework the default face and the serialize regexp code.
	(hi-lock--auto-select-face-defaults): Remove.
	(hi-lock-string-serialize-serial): Remove.
	(hi-lock--hashcons-hash): Rename from hi-lock-string-serialize-hash;
	make weak.
	(hi-lock--hashcons): Rename from hi-lock-string-serialize, return an
	equal string.
	(hi-lock-set-pattern): Adjust accordingly.
	(hi-lock--regexps-at-point): Simplify accordingly.
	(hi-lock--auto-select-face-defaults): Remove.
	(hi-lock--last-face): New var to replace it.
	(hi-lock-read-face-name): Rewrite (bug#11095).
	(hi-lock-unface-buffer): Arrange for the face to be the next default.

2012-12-06  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-replace-environment-variables):
	Hide compiler warning.
	(tramp-file-name-for-operation): Remove `executable-find',
	`start-process', `call-process' and `call-process-region'.

	* net/tramp-compat.el (top): Don't require 'tramp-util and 'tramp-vc.

	* net/tramp-gvfs.el (tramp-gvfs-dbus-event-error): Ensure backward
	compatibility.

	* net/tramp-sh.el (top): Remove `tramp-sh-handle-call-process-region'.

2012-12-06  Chong Yidong  <cyd@gnu.org>

	* ffap.el (ffap-replace-file-component): Fix typo.

2012-12-06  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/octave-mod.el (octave-mark-block): Move out of tokens and
	fix open-paren-like token test (bug#12785).

2012-12-06  Glenn Morris  <rgm@gnu.org>

	* mail/rmailsum.el (rmail-new-summary): Tweak for
	rmail-maybe-display-summary changing buffer.  (Bug#13066)

2012-12-06  Juri Linkov  <juri@jurta.org>

	* info.el (Info-fontify-node): Don't hide the last newline.
	(Bug#12272)

2012-12-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mail/mailabbrev.el (mail-abbrev-expand-wrapper): Work in minibuffer
	so as to enable message-read-from-minibuffer to expand mail aliases.

2012-12-06  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuf-eldef.el (minibuf-eldef-update-minibuffer): Don't mess with
	the `intangible' property.
	Suggested by Christopher Schmidt <christopher@ch.ristopher.com>

2012-12-05  Deniz Dogan  <deniz@dogan.se>

	* net/rcirc.el (rcirc-urls): Update documentation.
	(rcirc-condition-filter): New function.
	(rcirc-browse-url, rcirc-markup-urls): Use only URLs before point
	and exclude consecutive duplicate URLs (Bug#6082).

2012-12-05  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-sh.el (tramp-do-copy-or-rename-file-out-of-band):
	Check return code of copy command.

	* net/tramp-adb.el (tramp-adb-sdk-dir, tramp-adb-prompt):
	Use group `tramp'.  Add version.

2012-12-05  Chong Yidong  <cyd@gnu.org>

	* ffap.el (ffap-url-regexp): Don't require matching at front of
	string (Bug#4952).
	(ffap-url-p): If only a substring matches, return that.
	(ffap-url-at-point): Use the return value of ffap-url-p.
	(ffap-read-file-or-url, ffap-read-file-or-url-internal)
	(find-file-at-point, dired-at-point, dired-at-point-prompter)
	(ffap-guess-file-name-at-point): Likewise.
	(ffap-replace-file-component): Fix typo.

	* info.el (info-display-manual): Add existing Info buffers, whose
	files may not be in Info-directory-list, to the completion.
	(info--manual-names): New helper function.

2012-12-05  Glenn Morris  <rgm@gnu.org>

	* vc/vc-hg.el (vc-hg-resolve-when-done, vc-hg-find-file-hook):
	New functions, for detecting and resolving conflicts.  (Bug#10709)

2012-12-04  Jambunathan K  <kjambunathan@gmail.com>

	* hi-lock.el (hi-lock-auto-select-face): New user variable.
	(hi-lock-auto-select-face-defaults): New buffer local variable.
	(hi-lock-read-face-name): Honor `hi-lock-auto-select-face'.
	(hi-lock-unface-buffer): Prompt user with useful defaults.
	With prefix arg, unhighlight all hi-lock patterns in buffer.

2012-12-04  Stefan Monnier  <monnier@iro.umontreal.ca>

	* obsolete/terminal.el, obsolete/longlines.el: Add obsolecence info.

2012-12-04  Michael Albinus  <michael.albinus@gmx.de>

	* Makefile.in (TRAMP_SRC):
	* makefile.w32-in (TRAMP_SRC): Add tramp-adb.el.

2012-12-04  Juergen Hoetzel  <juergen@archlinux.org>

	* net/tramp-adb.el: New package.

2012-12-04  Chong Yidong  <cyd@gnu.org>

	* terminal.el: Move to obsolete/.

	* longlines.el: Move to obsolete/.

	* vc/ediff-diff.el (ediff-extract-diffs, ediff-extract-diffs3):
	Remove code referring to longlines mode.

2012-12-03  Juri Linkov  <juri@jurta.org>

	* sort.el (delete-duplicate-lines): New command.  (Bug#13032)

2012-12-03  Agustín Martín Domingo  <agustin.martin@hispalinux.es>

	* textmodes/ispell.el (ispell-init-process)
	(ispell-start-process, ispell-internal-change-dictionary):
	Make sure personal dictionary name is expanded after initial
	`default-directory' value.  Use expanded strings for
	keep/restart checks and for value (Bug#13019).

2012-12-03  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-forms.el (math-date-to-iso-dt): Fix weekday number.

2012-12-03  Leo Liu  <sdl.web@gmail.com>

	* files.el (dir-locals-read-from-file): Check file non-empty
	before reading.  (Bug#13038)

2012-12-03  Glenn Morris  <rgm@gnu.org>

	* jka-cmpr-hook.el (jka-compr-get-compression-info):
	Remove any version extension before checking filename.  (Bug#13006)
	(jka-compr-compression-info-list): Belated :version bump.

2012-12-03  Chong Yidong  <cyd@gnu.org>

	* simple.el (transient-mark-mode): Doc fix (Bug#11523).

	* buff-menu.el (Buffer-menu-delete-backwards, Buffer-menu-mode)
	(buffer-menu): Doc fix (Bug#12294).

2012-12-03  Roland Winkler  <winkler@gnu.org>

	* calendar/diary-lib.el (diary-header-line-format): Use keybinding
	of diary-show-all-entries in the diary buffer (Bug#12994).

2012-12-03  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-sh.el (tramp-perl-encode): Use "read STDIN" instead of
	"<STDIN>".  This is binary safe.

2012-12-03  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-forms.el (math-absolute-from-iso-dt)
	(math-date-to-iso-dt, math-parse-iso-date-validate)
	(math-iso-dt-to-date): New functions.
	(math-fd-iso-dt, math-fd-isoyear, math-fd-isoweek)
	(math-fd-isoweekday): New variables.
	(calc-date-notation, math-parse-standard-date, math-format-date)
	(math-format-date-part): Add support for more formatting codes.

2012-12-02  Dmitry Gutov  <dgutov@yandex.ru>

	* vc/vc.el (vc-delete-file, vc-rename-file): Default to the
	current buffer's file name when called interactively (Bug#12488).

2012-12-02  Juri Linkov  <juri@jurta.org>

	* info.el (info-display-manual): Don't clobber an existing Info
	buffer (Bug#10770).  Add completion (Bug#10771).

2012-12-01  Yuya Nishihara  <yuya@tcha.org>  (tiny change)

	* vc/vc-hooks.el (vc-find-file-hook): Expand buffer-file-truename
	before using it for comparison (Bug#5297).

2012-12-01  Jari Aalto  <jari.aalto@cante.net>

	* textmodes/css-mode.el (css-current-defun-name): New function.
	(css-mode): Use it.

	* textmodes/sgml-mode.el (html-current-defun-name): New function.
	(html-mode): Use it.

2012-12-01  Chong Yidong  <cyd@gnu.org>

	Modularize add-log-current-defun (Bug#2224).
	Suggested by Jari Aalto.

	* vc/add-log.el (add-log-current-defun-function): Doc fix.
	(add-log-current-defun): Move mode-specific code to other files.
	(add-log-lisp-like-modes, add-log-c-like-modes)
	(add-log-tex-like-modes): Variables deleted.

	* emacs-lisp/lisp-mode.el (lisp-current-defun-name): New.
	(lisp-mode-variables): Use it.

	* progmodes/cc-mode.el (c-common-init):
	* progmodes/cperl-mode.el (cperl-mode): Set a value for
	add-log-current-defun-function.

	* progmodes/m4-mode.el (m4-current-defun-name): New function.
	(m4-mode): Use it.

	* progmodes/perl-mode.el (perl-current-defun-name): New.
	(perl-mode): Use it.

	* progmodes/scheme.el (scheme-mode-variables, dsssl-mode):
	Use lisp-current-defun-name.

	* textmodes/tex-mode.el (tex-current-defun-name): New.
	(tex-common-initialization): Use it.

	* textmodes/texinfo.el (texinfo-current-defun-name): New.
	(texinfo-mode): Use it.

2012-12-01  Chong Yidong  <cyd@gnu.org>

	* emacs-lisp/lisp-mode.el (lisp-mode-variables, lisp-mode):
	* progmodes/autoconf.el (autoconf-mode):
	* progmodes/js.el (js-mode):
	* progmodes/make-mode.el (makefile-mode, makefile-makepp-mode)
	(makefile-bsdmake-mode, makefile-imake-mode, makefile-browse):
	* progmodes/perl-mode.el (perl-mode):
	* progmodes/sh-script.el (sh-mode, sh-set-shell):
	* textmodes/css-mode.el (css-mode):
	* textmodes/sgml-mode.el (html-mode, sgml-mode)
	(sgml-tags-invisible, sgml-guess-indent):
	* textmodes/tex-mode.el (tex-common-initialization)
	(latex-complete-bibtex-keys, tex-shell, tex-main-file)
	(doctex-mode, plain-tex-mode, latex-mode):
	* textmodes/texinfo.el (texinfo-mode): Use setq-local.

2012-12-01  Kirk Kelsey  <kirk.kelsey@0x4b.net>

	* vc/vc-hg.el (vc-hg-next-revision):
	Ensure use of default "tip" output format.  (Bug#6968)

2012-12-01  Kim F. Storm  <storm@cua.dk>

	* startup.el (fancy-startup-tail): Add a clickable link
	(Bug#2176).

2012-12-01  Chong Yidong  <cyd@gnu.org>

	* startup.el (fancy-startup-tail): Improve the message about
	auto-save files (Bug#2176).

	* files.el (recover-session): Improve the descriptive message, and
	use substitute-command-keys.

2012-12-01  Glenn Morris  <rgm@gnu.org>

	* ido.el (ido-file-internal):
	Handle other-window, other-frame for dired.  (Bug#13036)

2012-11-30  Glenn Morris  <rgm@gnu.org>

	* icomplete.el (icomplete-separator): Fix :version.

2012-11-30  Chong Yidong  <cyd@gnu.org>

	* shell.el (shell): For C-u M-x shell, use an inactive shell
	buffer as the default (Bug#1975).
	(shell-apply-ansi-color, shell-reapply-ansi-color): New functions.
	(shell-mode): Use them to reapply ansi colorization if Shell mode
	is re-enabled.

2012-11-30  Yuriy Vostrikov  <delamonpansie@gmail.com>  (tiny change)

	* vc/vc-git.el (vc-git-command): Disable the pager (Bug#6137).

2012-11-30  Samuel Bronson  <naesten@gmail.com>

	* progmodes/grep.el (grep-compute-defaults): Do not pass the -e
	flag to xargs, for compatibility with BSD xargs (Bug#11703).

2012-11-30  Toru TSUNEYOSHI  <t_tuneyosi@hotmail.com>

	* textmodes/fill.el (fill-region-as-paragraph): Handle overshoot
	by move-to-column (Bug#3234).

2012-11-30  Chong Yidong  <cyd@gnu.org>

	* longlines.el (longlines-wrap-line, longlines-encode-region):
	Preserve text properties (Bug#1425).

2012-11-30  OKAZAKI Tetsurou  <okazaki.tetsurou@gmail.com>  (tiny change)

	* vc/vc.el (vc-register): Allow registering a file which is
	already registered with a different backend (Bug#10589).

2012-11-29  Jambunathan K  <kjambunathan@gmail.com>
	    Stefan Monnier  <monnier@iro.umontreal.ca>

	* icomplete.el: Change separator; add ido-style commands.
	(icomplete-show-key-bindings): Remove custom var.
	(icomplete-get-keys): Remove function.
	(icomplete-forward-completions, icomplete-backward-completions):
	New commands.
	(icomplete-minibuffer-map): New var.
	(icomplete-minibuffer-setup): Use it.
	(icomplete-exhibit): Don't delay if the list of completions is known.
	(icomplete-separator): New custom.
	(icomplete-completions): Use it.
	* minibuffer.el (completion-all-sorted-completions): Delete duplicates.
	(minibuffer-force-complete-and-exit): New command.
	(minibuffer--complete-and-exit): New function extracted from
	minibuffer-complete-and-exit.
	(minibuffer-complete-and-exit): Use it.

	* progmodes/etags.el (visit-tags-table-buffer): Give a more precise
	error message when the file doesn't exist (bug#12974).

2012-11-29  Kelly Dean  <kellydeanch@yahoo.com>  (tiny change)

	* simple.el (activate-mark): Run activate-mark-hook (bug#13027).

2012-11-29  Glenn Morris  <rgm@gnu.org>

	* files.el (hack-dir-local-variables): Warn if try to set
	coding via dir-locals, since it doesn't work.  (Bug#7169)

	Add desktop support for restoring vc-dir buffers.  (Bug#10606)
	* vc/vc-dir.el (vc-dir-mode): Autoload it (for desktop restore).
	Set buffer-local value of desktop-save-buffer.
	(vc-dir-desktop-buffer-misc-data, vc-dir-restore-desktop-buffer):
	New functions.
	(desktop-buffer-mode-handlers): Add vc-dir-mode entry.
	* desktop.el (desktop-save-buffer-p): Treat vc-dir like dired.

	* files.el (inhibit-local-variables-ignore-case): New.  (Bug#10610)
	(inhibit-local-variables-p): Use inhibit-local-variables-ignore-case.
	Doc fix.
	(inhibit-local-variables-regexps, inhibit-local-variables-suffixes):
	Doc fixes.

2012-11-28  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-forms.el (calc-date-notation): Fix regexp
	used to find time codes.  Fix symbol for seconds.

2012-11-27  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/derived.el (derived-mode-make-docstring):
	Don't mention "abbrev" or "syntax" if nil.  (Bug#11277)

2012-11-27  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/table.el (table-insert): Don't use `symbol-name' on
	lexically scoped variables (bug#13005).

2012-11-27  Glenn Morris  <rgm@gnu.org>

	* vc/vc-hooks.el (vc-mistrust-permissions):
	Default to t, to avoid data-loss.  (Bug#11490)

2012-11-27  Fabián Ezequiel Gallina  <fgallina@cuca>

	* progmodes/python.el (python-indent-guess-indent-offset):
	If indentation is guessed make python-indent-offset buffer-local.

	Fix Imenu regression.
	* progmodes/python.el (python-nav-beginning-of-defun):
	Fix forward movement when statement(s) separates point from defun.
	(python-imenu-prev-index-position): New function.

2012-11-27  Eli Zaretskii  <eliz@gnu.org>

	* subr.el (buffer-file-type): Declare with defvar-local.  Doc fix.

	* dos-w32.el (find-file-not-found-set-buffer-file-coding-system):
	Don't set buffer-file-type.  Return nil.  (Bug#12989)

2012-11-27  Glenn Morris  <rgm@gnu.org>

	* hippie-exp.el (hippie-expand-try-functions-list):
	Re-autoload it.  (Bug#12982)

2012-11-27  Eli Zaretskii  <eliz@gnu.org>

	* descr-text.el (describe-char-padded-string):
	Call internal-char-font only on GUI frames.  (Bug#11964)

2012-11-27  Andreas Schwab  <schwab@linux-m68k.org>

	* buff-menu.el (Buffer-menu-buffer+size-width): Fix customize type
	and obsoletion message.

2012-11-27  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/cl-macs.el (cl--transform-lambda): Add back `declare' in
	the constructs to keep outside of the `cl-block' (bug#12977).

2012-11-27  Chong Yidong  <cyd@gnu.org>

	* mouse.el (mouse-drag-line): Even if the line is not draggable,
	keep reading until we get the up-event anyway, in order to process
	the up-event for mouse-1-click-follows-link (Bug#12971).

2012-11-26  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/advice.el (ad-should-compile): Don't compile advice if the
	base function is not yet defined (bug#12965).
	(ad-activate-advised-definition): Use ad-compile-function.
	(ad-activate): Use cond.

2012-11-25  Leo Liu  <sdl.web@gmail.com>

	* textmodes/sgml-mode.el (sgml-tag): Fix indentation for closing tag.
	(Bug#12979)

2012-11-24  Vincent Belaïche  <vincentb1@users.sourceforge.net>

	* textmodes/reftex-parse.el (reftex-parse-from-file): Use variable
	reftex-section-info-function in order to be compatible with
	Texinfo integration.

	* textmodes/reftex.el (reftex-section-pre-regexp)
	(reftex-section-post-regexp, reftex-section-info-function):
	New variable.
	(reftex-compile-variables): Use variables reftex-section-pre-regexp,
	reftex-section-post-regexp, and reftex-section-info-function in order
	to be compatible with Texinfo integration.

	* textmodes/reftex-toc.el (reftex-toc-promote-action):
	use reftex-section-pre-regexp variable in order to be compatible with
	Texinfo integration.

2012-11-25  Chong Yidong  <cyd@gnu.org>

	* faces.el: Make face-spec-set more analogous to setq.
	(face-spec-set): Change the third arg to specify whether this
	function is being called via defface, customize, or a third party.
	Set the appropriate symbol properties.  Clear the override spec if
	setting via Custom.  Initialize face if necessary.  (Bug#4988)
	(face-spec-recalc): Allow theme faces to completely replace the
	defface spec, in the same way as custom faces (Bug#8454).

	* cus-face.el (custom-declare-face): Move face initialization to
	face-spec-set.
	(custom-theme-set-faces): Don't initialize the face name here, as
	that is now done in face-spec-set.

	* cus-edit.el (custom-face-set, custom-face-mark-to-save)
	(custom-face-reset-saved, custom-face-mark-to-reset-standard):
	Simplify by using the new arg to face-spec-set.

	* emacs-lisp/lisp-mode.el (eval-defun-1): When evaluating defface,
	reset face-override-spec too, and use custom-declare-face.

2012-11-24  Jan Djärv  <jan.h.d@swipnet.se>

	* term/ns-win.el (ns-initialize-window-system): Move creation of
	fontsets here (Bug#11964).

2012-11-24  Vincent Belaïche  <vincentb1@users.sourceforge.net>

	* ses.el (ses-rename-cell): Correct bug on mode-line update after
	cell renaming.

2012-11-24  Chong Yidong  <cyd@gnu.org>

	* woman.el (woman-default-faces, woman-monochrome-faces): Mark as
	obsolete.

	* custom.el (custom-theme-set-variables): Use a topological sort
	for ordering by custom dependencies (Bug#12952).
	(custom--sort-vars, custom--sort-vars-1): New functions.

2012-11-24  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/bytecomp.el (byte-compile-file): Setup default value for
	lexical-binding (bug#12938).

2012-11-24  Wolfgang Jenkner  <wjenkner@inode.at>

	* image-mode.el (image-transform-check-size): Use assertions only
	for images of type imagemagick.

	Otherwise no error, image-transform-fit-to-{width,height} is
	silently ignored, as before.  Doc fix.

2012-11-24  Chong Yidong  <cyd@gnu.org>

	* faces.el (color-defined-p): Doc fix (Bug#12853).

2012-11-24  Juri Linkov  <juri@jurta.org>

	* dired.el (dired-mark): Add optional arg `interactive'.
	Check for `use-region-p' if `interactive' is non-nil.
	(dired-unmark, dired-flag-file-deletion): Add optional arg
	`interactive'.  Call `dired-mark' with the arg `interactive'.
	(Bug#10624)

	* wdired.el: Revert 2012-10-17 change partly and replace it with
	Patch by Christopher Schmidt <christopher@ch.ristopher.com>.
	(wdired-finish-edit): Add marks for new file names to
	`wdired-old-marks'.  Restore marks using `dired-mark-remembered'
	after `revert-buffer'.
	(wdired-do-renames): Remove calls to `dired-remove-file',
	`dired-add-file', `dired-add-entry'.  (Bug#11795)

2012-11-24  Alan Mackenzie  <acm@muc.de>

	* progmodes/cc-defs.el (c-version): Bump to 5.32.4.

	Fix bugs in the state cache.  Enhance a debugging mechanism.
	* progmodes/cc-engine.el (c-parse-state-get-strategy): Don't use
	"brace at column zero" strategy for C++.
	(c-append-lower-brace-pair-to-state-cache): Repair algorithm.
	(c-parse-state-point): New variable.
	(c-record-parse-state-state): Record old parse state with
	`copy-tree'.  Record previous value of point.
	(c-debug-parse-state-double-cons): New debugging function.
	(c-debug-parse-state): Call the above new function.
	(c-toggle-parse-state-debug): Output a confirmatory message.

	* progmodes/cc-mode.el (c-before-change, c-after-change):
	Call c-invalidate-state-cache from `c-before-change' instead of
	`c-after-change'.

2012-11-23  Chong Yidong  <cyd@gnu.org>

	* find-cmd.el (find-constituents): Add executable, ipath,
	readable, samefile, writable, daystart, regextype (Bug#12856).

2012-11-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/ert.el, emacs-lisp/ert-x.el: Use cl-lib and lexical-binding.

2012-11-22  Paul Eggert  <eggert@cs.ucla.edu>

	* calc/calc.el (calc-gregorian-switch): Move to after calc-refresh
	definition.  This fixes a bootstrap failure.
	(calc-gregorian-switch): In menu, put dates before regions.
	This is easier to follow, lines up better in the menu, and lets us
	coalesce regions that switch at the same time.  Give country
	names, not "Vatican", as that's better for non-expert users.
	Use names that are stable between the date of switch and now, e.g.,
	Bohemia and Moravia (which existed then and now) and not
	Czechoslovakia (which didn't exist then and doesn't exist now).
	What is now the U.S. mostly did not switch at the same time as
	Britain, so omit the U.S.  Correct spelling of "Britain".
	Catholic Switzerland was too much of a mess, so omit it.

2012-11-22  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc.el (calc-gregorian-switch): Refresh the Calc buffer
	after the variable is changed.

2012-11-21  Daniel Colascione  <dancol@dancol.org>

	* progmodes/sql.el (sql-mode-font-lock-object-name): Support IF NOT EXISTS
	in SQL declarations for font-lock.
	(sql-imenu-generic-expression): Teach imenu about IF NOT EXISTS.

2012-11-21  Glenn Morris  <rgm@gnu.org>

	* faces.el (face-underline-p, face-inverse-video-p, face-bold-p)
	(face-italic-p): Add optional argument "inherit".

	* faces.el (set-face-inverse-video, set-face-bold, set-face-italic):
	Remove -p suffix from names, for consistency with other set-face-*.
	(set-face-inverse-video): Fix interactive spec.
	* play/gamegrid.el (gamegrid-make-mono-tty-face):
	* textmodes/table.el (table--update-cell-face):
	Use set-face-inverse-video rather than now obsolete alias.

2012-11-21  Eli Zaretskii  <eliz@gnu.org>

	* simple.el (line-move): Don't call line-move-partial if
	scroll-conservatively is in effect.  (Bug#12927)

2012-11-21  Stefan Monnier  <monnier@iro.umontreal.ca>

	* eshell/em-cmpl.el (eshell-pcomplete): Refine fix for bug#12838:
	Fallback on completion-at-point rather than
	pcomplete-expand-and-complete, and only if pcomplete actually failed.
	(eshell-cmpl-initialize): Setup completion-at-point.

	* pcomplete.el (pcomplete--entries): Obey pcomplete-ignore-case.

	* emacs-lisp/ert.el (ert--expand-should-1): Adapt to cl-lib.

2012-11-21  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-sh.el (tramp-do-copy-or-rename-file): If both files
	are remote, check out-of-band property for both.

2012-11-21  Stefan Monnier  <monnier@iro.umontreal.ca>

	* window.el (switch-to-buffer): Re-add the warning that was lost in the
	code rewrite.

2012-11-21  Paul Eggert  <eggert@cs.ucla.edu>

	More minor time fixes.
	* calendar/time-date.el: Commentary fix.
	* net/tramp-sh.el (tramp-do-file-attributes-with-ls): Undo last change;
	too much other code depends on (0 0) time stamps.
	* net/tramp.el (tramp-time-less-p, tramp-time-subtract):
	Add a couple of FIXME comments.

	Minor cleanup for times as lists of four integers.
	* files.el (dir-locals-directory-cache):
	* ps-bdf.el (bdf-file-mod-time, bdf-read-font-info):
	Doc fixes.
	* net/tramp-sh.el (tramp-do-file-attributes-with-ls):
	* ps-bdf.el (bdf-file-newer-than-time):
	Process four-integers time stamps, not two.  Doc fixes.

2012-11-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* uniquify.el (uniquify-managed): Use defvar-local.
	(rename-buffer, create-file-buffer): Advise with advice-add.
	(uniquify-unload-function): Unadvise accordingly.

	* emacs-lisp/trace.el: Rewrite, use nadvice and lexical-binding.
	(trace-buffer): Don't purecopy.
	(trace-entry-message, trace-exit-message): Add `context' arg.
	(trace--timer): New var.
	(trace-make-advice): Adjust for use in nadvice.
	Add `context' argument.  Delay `display-buffer' via a timer.
	(trace-function-internal): Use advice-add.
	(trace--read-args): New function.
	(trace-function-foreground, trace-function-background): Use it.
	(trace-function): Rename to trace-function-foreground and redefine as
	an alias to that new name.
	(untrace-function, untrace-all): Adjust to the use of nadvice.

	* emacs-lisp/bytecomp.el (byte-compile): Fix handling of closures.

	* emacs-lisp/byte-run.el (defun-declarations-alist): Fix last change.

	* subr.el (called-interactively-p-functions): New var.
	(internal--called-interactively-p--get-frame): New macro.
	(called-interactively-p, interactive-p): Rewrite in Lisp.
	* emacs-lisp/nadvice.el (advice--called-interactively-skip): New fun.
	(called-interactively-p-functions): Use it.
	* emacs-lisp/edebug.el (edebug--called-interactively-skip): New fun.
	(called-interactively-p-functions): Use it.
	* allout.el (allout-called-interactively-p): Don't assume
	called-interactively-p is a subr.

2012-11-20  Glenn Morris  <rgm@gnu.org>

	* profiler.el (profiler-report-mode-map): Add a menu.
	No need to bind `q' because we derive from special-mode.
	(profiler-report-find-entry): Handle calls from the menu-bar.

2012-11-19  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/byte-run.el (defun-declarations-alist):
	Allow a compiler-macro to be a lambda expression.

	* progmodes/python.el: Use cl-lib.  Move var declarations outside of
	eval-when-compile.
	(python-syntax-context): Add compiler-macro.
	(python-font-lock-keywords): Simplify with De Morgan.

	* vc/diff-mode.el (diff-hunk): Don't make useless timers.

	* files.el (load-file): Require match in minibuffer selection, as was
	the case in Emacs-20 before we changed the spec to allow .elc files
	(bug#12935).

	* json.el: Don't require cl since we don't use it.
	* color.el: Don't require cl.
	(color-complement): `caddr' -> `nth 2'.

	* calendar/time-date.el (time-to-seconds): De-obsolete.

2012-11-19  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-forms.el (math-leap-year-p): Fix formula for negative
	year numbers.
	(math-date-to-julian-dt): Adjust the initial approximation for the
	year to deal with the new definition of the DATE.

2012-11-19  Daniel Colascione  <dancol@dancol.org>

	* term/w32-win.el (cygwin-convert-path-from-windows):
	Accommodate rename of cygwin_convert_path* to
	cygwin_convert_file_name*.

2012-11-18  Chong Yidong  <cyd@gnu.org>

	* filecache.el (file-cache--read-list): New function.
	(file-cache-add-directory-list, file-cache-add-file-list)
	(file-cache-delete-file-list, file-cache-delete-directory-list):
	Use it to read a list of files or directories (Bug#12846).
	(file-cache-add-file, file-cache-add-directory)
	(file-cache-delete-file-list, file-cache-delete-file-regexp)
	(file-cache-delete-directory): Print an message.

2012-11-18  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-forms.el (math-date-to-dt): Use integer date when
	calling `math-date-to-julian-dt' and 'math-date-to-gregorian-dt'.

2012-11-18  Glenn Morris  <rgm@gnu.org>

	* image.el (insert-image, insert-sliced-image): Doc fix.

2012-11-18  Chong Yidong  <cyd@gnu.org>

	* emacs-lisp/syntax.el (syntax-propertize-function): Doc fix
	(Bug#12810).

2012-11-18  OKAZAKI Tetsurou  <okazaki.tetsurou@gmail.com>  (tiny change)

	* vc/vc-svn.el (vc-svn-merge-news): Properly parse the merge
	response when the target file is in a subdirectory (Bug#12757).

2012-11-18  Chong Yidong  <cyd@gnu.org>

	* filecache.el (file-cache-add-file-list): Doc fix (Bug#12694).

2012-11-18  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/cl-lib.el (face-underline-p):
	Use set-face-underline rather than the alias set-face-underline-p.

	* window.el (with-temp-buffer-window): Doc fix.
	* subr.el (with-output-to-temp-buffer):
	Add doc xref to with-temp-buffer-window.

2012-11-18  Juanma Barranquero  <lekktu@gmail.com>

	* woman.el (woman-non-underline-faces): Use `set-face-underline'.
	* calc/calc.el (math-format-date-cache): Declare.

2012-11-17  Paul Eggert  <eggert@cs.ucla.edu>

	Calc by default uses the Gregorian calendar for all dates (Bug#12633).
	It also uses January 1, 1 AD as its day number 1.
	* calc/calc-forms.el (math-julian-date-beginning)
	(math-julian-date-beginning-int): Implement this.

2012-11-17  Juanma Barranquero  <lekktu@gmail.com>

	* descr-text.el (quail-find-key):
	* dired.el (desktop-file-name):
	* dirtrack.el (shell-prefixed-directory-name, shell-process-cd):
	* generic-x.el (comint-mode, comint-exec):
	* image-dired.el (widget-forward):
	* info.el (speedbar-add-expansion-list, speedbar-center-buffer-smartly)
	(speedbar-change-expand-button-char)
	(speedbar-change-initial-expansion-list, speedbar-delete-subblock)
	(speedbar-make-specialized-keymap, speedbar-make-tag-line):
	* printing.el (easy-menu-add-item, easy-menu-remove-item)
	(widget-field-action, widget-value-set):
	* speedbar.el (imenu--make-index-alist):
	* term.el (ring-empty-p, ring-ref, ring-insert-at-beginning)
	(ring-length, ring-insert):
	* vcursor.el (compare-windows-skip-whitespace):
	* woman.el (dired-get-filename):
	Declare functions.

	* term/w32-win.el (cygwin-convert-path-from-windows): Fix declaration.

2012-11-17  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc.el (calc-gregorian-switch): New variable.

	* calc/calc-forms.el (math-day-in-year, math-dt-before-p)
	(math-absolute-from-gregorian-dt, math-absolute-from-julian-dt)
	(math-date-to-julian-dt, math-date-to-gregorian-dt): New functions.
	(math-leap-year-p): Add option to distinguish between Julian
	and Gregorian calendars.
	(math-day-number): Use `math-day-in-year' to do the computations.
	(math-absolute-from-dt): Rename from `math-absolute-from-date'.
	Use `math-absolute-from-gregorian' and `math-absolute-from-julian'
	to do the computations.
	(math-date-to-dt): Use `math-date-to-julian-dt' and
	`math-date-to-gregorian-dt' to do the computations.
	(calcFunc-weekday, math-format-date-part): Use the new version of
	the DATE to determine the weekday.
	(calcFunc-newmonth, calcFunc-newyear): Use `calc-gregorian-switch'
	when necessary.

2012-11-17  Eli Zaretskii  <eliz@gnu.org>

	* term/w32-win.el (w32-handle-dropped-file): Use 'file://' only on
	Cygwin; otherwise use 'file:'.  (Bug#12914)
	(cygwin-convert-path-from-windows): Declare, to avoid
	byte-compiler warnings.

2012-11-17  Andreas Politz  <politza@fh-trier.de>

	* ibuffer.el (ibuffer-mark-forward, ibuffer-unmark-forward)
	(ibuffer-unmark-backward, ibuffer-mark-interactive): Support plain
	prefix and negative numeric prefix args (Bug#12795).

2012-11-17  Stephen Berman  <stephen.berman@gmx.net>

	* play/gamegrid.el (gamegrid-add-score-with-update-game-score-1):
	Don't signal an error with a score that is too low to add to the
	list of top scores.  (Bug#12779)

2012-11-17  Chong Yidong  <cyd@gnu.org>

	* help-mode.el (help-xref-interned): End on point-min (Bug#12737).

	* filecache.el (file-cache-add-file): Handle relative file name in
	the argument (Bug#12694).

2012-11-16  Jürgen Hötzel  <juergen@archlinux.org>  (tiny change)

	* eshell/em-unix.el (eshell/mkdir): Handle "--parents" (bug#12897).

2012-11-16  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/advice.el (ad-make-advised-definition): Improve last fix.

	* emacs-lisp/cl-lib.el: Set more meaningful version number.

2012-11-16  Martin Rudalics  <rudalics@gmx.at>

	* window.el (enlarge-window, shrink-window): Don't mention return
	value in doc-string (Bug#12896).
	(window--display-buffer): Don't resize frames - it won't work
	with all window managers and defeat pop-up-frame-alist.
	(display-buffer-alist): In doc-string explain that CONDITION can
	be a function and which arguments are passed to it (Bug#12854).
	(display-buffer-assq-regexp): New argument ACTION.  Handle lambda
	expressions (Bug#12854).
	(display-buffer): Pass ACTION argument to
	display-buffer-assq-regexp.

2012-11-16  Glenn Morris  <rgm@gnu.org>

	* window.el (fit-frame-to-buffer-bottom-margin)
	(fit-frame-to-buffer, fit-window-to-buffer): Doc fixes.

	* faces.el (face-underline-p): Use face-attribute-specified-or.

2012-11-16  Juanma Barranquero  <lekktu@gmail.com>

	* emacs-lisp/cl-macs.el (cl-loop, cl-do, cl-do*): Doc fixes.

2012-11-16  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/cl-macs.el (cl-flet, cl-flet*): Fix docstring (bug#12895).

2012-11-16  Glenn Morris  <rgm@gnu.org>

	* eshell/em-cmpl.el (eshell-pcomplete): New command.  (Bug#12838)
	(eshell-cmpl-initialize): Bind eshell-pcomplete to TAB, C-i.

	* faces.el (face-underline-p): Doc fix.  Handle :underline being
	things other than `t' (a string, a list).
	(face-inverse-video-p): Doc fix.
	(set-face-underline): Rename it back from set-face-underline-p.
	Doc fix.  Allow interactive input of values other than t.
	(read-face-attribute): Apply formatting to :underline,
	since like :box and :stipple it can take list values.

	* term.el (ansi-term): Don't let C-x escape-char binding
	clobber the more standard C-c binding.  (Bug#12842)

	* subr.el (set-temporary-overlay-map): Doc fix.

2012-11-16  Martin Rudalics  <rudalics@gmx.at>

	* window.el (record-window-buffer)
	(display-buffer-record-window): When copying the markers to
	window-point preserve window-point-insertion-type.  (Bug#12588)

2012-11-16  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/eieio-datadebug.el (eieio-debug-methodinvoke):
	* net/tramp-gvfs.el (tramp-gvfs-dbus-event-error):
	Use new names for hooks rather than obsolete aliases.

2012-11-15  Daniel Colascione  <dancol@dancol.org>

	* term/w32-win.el (w32-handle-dropped-file): Use a "file://"
	prefix instead of "file:" so that when FILE-NAME begins with "//",
	as it does when the target file is on a network share, url-handler
	isn't confused.

2012-11-15  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/advice.el (ad-definition-type): Make sure we don't use
	a preactivated advice from an old advice.el; they're not compatible!

2012-11-15  Katsumi Yamaoka  <yamaoka@jpl.org>

	* emacs-lisp/nadvice.el (advice--make-interactive-form):
	Fix string-spec case.

	* emacs-lisp/advice.el (ad-make-advised-definition): Fix undefined case.

2012-11-15  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/nadvice.el: Add buffer-local support to add-function.
	(advice--buffer-local-function-sample): New var.
	(advice--set-buffer-local, advice--buffer-local): New functions.
	(add-function, remove-function): Use them.

2012-11-15  Drew Adams  <drew.adams@oracle.com>

	* imenu.el (imenu--split-submenus): Use imenu--subalist-p (bug#12717).

2012-11-15  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/cl-macs.el (cl--transform-lambda): Defend against
	potential binding of print-gensym to t, and prettify (back)quotes in
	case they appear in args's default values (bug#12884).

2012-11-14  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/nadvice.el: Add around advice for interactive specs.
	(advice-eval-interactive-spec): New function.
	(advice--make-interactive-form): Support around advice (bug#12844).

2012-11-14  Dmitry Gutov  <dgutov@yandex.ru>

	* progmodes/ruby-mode.el (ruby-expr-beg): Make heredoc detection
	more strict.  Add docstring.
	(ruby-expression-expansion-re): Extract from
	`ruby-match-expression-expansion'.
	(ruby-syntax-propertize-function): After everything else, search
	for expansions in string literals, mark their insides as
	whitespace syntax and save match data for font-lock.
	(ruby-font-lock-keywords): Use the 2nd group from expression
	expansion matches.
	(ruby-match-expression-expansion): Use the match data saved to the
	text property in ruby-syntax-propertize-function.

2012-11-14  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/gv.el (setf): Fix debug spec for multiple assignments
	(bug#12879).

2012-11-13  Dmitry Gutov  <dgutov@yandex.ru>

	* progmodes/ruby-mode.el (ruby-move-to-block): Looks for a block
	start/end keyword a bit harder.  Works with different values of N.
	Add more comments.
	(ruby-end-of-block): Update accordingly.

2012-11-13  Stefan Monnier  <monnier@iro.umontreal.ca>

	* woman.el (woman-file-name): Don't mess with unread-command-events
	(bug#12861).

	* emacs-lisp/advice.el: Layer on top of nadvice.el.
	Remove out of date self-require hack.
	(ad-do-advised-functions): Use simple `dolist'.
	(ad-advice-name, ad-advice-protected, ad-advice-enabled)
	(ad-advice-definition): Redefine as functions.
	(ad-advice-classes): Move before first use.
	(ad-make-origname, ad-set-orig-definition, ad-clear-orig-definition)
	(ad-make-mapped-call, ad-make-advised-docstring)
	(ad-make-plain-docstring, ad--defalias-fset): Remove functions.
	(ad-make-advicefunname, ad-clear-advicefunname-definition): New funs.
	(ad-get-orig-definition): Rewrite.
	(ad-make-advised-definition-docstring): Change base docstring.
	(ad-real-orig-definition): Rewrite.
	(ad-map-arglists): Change name of called function.
	(ad--make-advised-docstring): Redirect `function' from ad-Advice-...
	(ad-make-advised-definition): Simplify.
	(ad-assemble-advised-definition): Tweak for new calling context.
	(ad-activate-advised-definition): Setup ad-Advice-* i.s.o ad-Orig-*.
	(ad--defalias-fset): Rename from ad-handle-definition.  Make it set the
	function and call ad-activate if needed.
	(ad-activate, ad-deactivate): Don't call ad-handle-definition any more.
	(ad-recover): Clear ad-Advice-* instead of ad-Orig-*.
	(ad-compile-function): Compile ad-Advice-*.
	(ad-activate-on-top-level, ad-with-auto-activation-disabled): Remove.
	(ad-start-advice, ad-stop-advice): Remove.

2012-11-13  Dmitry Gutov  <dgutov@yandex.ru>

	* progmodes/ruby-mode.el (ruby-add-log-current-method): Print the
	period before class method names, not after.  Remove handling of
	one impossible case.  Add comments.

2012-11-13  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/advice.el: Remove support for freezing.
	(ad-make-freeze-docstring, ad-make-freeze-definition): Remove functions.
	(ad-make-single-advice-docstring, ad-defadvice-flags, defadvice):
	Remove support for `freeze'.

	* emacs-lisp/cl.el (dolist, dotimes, declare): Use advice-add to
	override the default.
	* emacs-lisp/cl-macs.el (cl-dolist, cl-dotimes): Rewrite without using
	cl--dotimes/dolist.
	* subr.el (dolist, dotimes, declare): Redefine them normally, even when
	`cl' is loaded.

	* emacs-lisp/nadvice.el (advice--normalize): New function, extracted
	from add-advice.
	(advice--strip-macro): New function.
	(advice--defalias-fset): Use them to handle macros.
	(advice-add): Use them.
	(advice-member-p): Correctly handle macros.

2012-11-13  Dmitry Gutov  <dgutov@yandex.ru>

	* progmodes/ruby-mode.el (ruby-font-lock-keywords):
	Never font-lock the beginning of singleton class as heredoc.

2012-11-13  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/gv.el (gv-define-simple-setter): One more fix (bug#12871).

2012-11-13  Wolfgang Jenkner  <wjenkner@inode.at>

	* ansi-color.el (ansi-color-apply-sequence): Implement SGR codes
	39 and 49 (bug#12792).  Also, treat unimplemented parameters as 0,
	thereby restoring the behavior of revisions prior to 2012-08-15T03:33:55Z!monnier@iro.umontreal.ca.

2012-11-13  Fabián Ezequiel Gallina  <fgallina@cuca>

	Fix end-of-defun misbehavior.
	* progmodes/python.el (python-nav-beginning-of-defun): Rename from
	python-beginning-of-defun-function.  Handle nested defuns
	correctly.
	(python-nav-end-of-defun): Rename from
	python-end-of-defun-function.  Ensure forward movement.
	(python-info-current-defun): Reimplement to work as intended
	with new fixed python-nav-{end,beginning}-of-defun.  Stop scanning
	parent defuns as soon as possible.

2012-11-13  Glenn Morris  <rgm@gnu.org>

	* progmodes/flymake.el (flymake-error-bitmap)
	(flymake-warning-bitmap, flymake-fringe-indicator-position): Doc fixes.
	(flymake-error-bitmap, flymake-warning-bitmap): Fix :types.

2012-11-13  Dmitry Gutov  <dgutov@yandex.ru>

	* progmodes/ruby-mode.el (ruby-move-to-block): When moving
	backward, always stop at indentation.  Reverts the change from
	2012-08-12T22:06:56Z!monnier@iro.umontreal.ca (Bug#12851).

2012-11-13  Glenn Morris  <rgm@gnu.org>

	* ibuffer.el (ibuffer-mode-map, ibuffer-mode):
	Add ibuffer-filter-by-derived-mode.

	* ibuffer.el (ibuffer-mode-map): Don't have two menu items with
	the same name shadowing each other.

	* window.el (with-temp-buffer-window): Doc tweak.

	* emacs-lisp/debug.el (debugger-bury-or-kill): Doc tweak.

	* help.el (temp-buffer-max-height):
	* window.el (fit-frame-to-buffer, fit-frame-to-buffer-bottom-margin):
	* emacs-lisp/debug.el (debugger-bury-or-kill): Fix :version.

2012-11-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/nadvice.el: New package.
	* subr.el (special-form-p): New function.
	* emacs-lisp/elp.el: Use lexical-binding and advice-add.
	(elp-all-instrumented-list): Remove var.
	(elp-not-profilable): Remove elp-wrapper.
	(elp-profilable-p): Use autoloadp and special-form-p.
	(elp--advice-name): New const.
	(elp-instrument-function): Use advice-add.
	(elp--instrumented-p): New predicate.
	(elp-restore-function): Use advice-remove.
	(elp-restore-all, elp-reset-all): Use mapatoms.
	(elp-set-master): Use elp--instrumented-p.
	(elp--make-wrapper): Rename from elp-wrapper, return a function
	suitable for advice-add.  Use cl-inf.
	(elp-results): Use mapatoms+elp--instrumented-p.
	* emacs-lisp/debug.el: Use lexical-binding and advice-add.
	(debug-function-list): Remove var.
	(debug): Rename arg, and then let-bind it explicitly inside.
	(debugger-setup-buffer): Rename arg.
	(debugger-setup-buffer): Adjust counts to new debug-on-entry setup.
	(debugger-frame-number): Adjust to new debug-on-entry setup.
	(debug--implement-debug-on-entry): Rename from
	implement-debug-on-entry, add argument.
	(debugger-special-form-p): Remove, use special-form-p instead.
	(debug-on-entry): Use advice-add.
	(debug--function-list): New function.
	(cancel-debug-on-entry): Use it, along with advice-remove.
	(debug-arglist, debug-convert-byte-code, debug-on-entry-1): Remove.
	(debugger-list-functions): Use debug--function-list instead of
	debug-function-list.
	* emacs-lisp/advice.el (ad-save-real-definition): Remove, unused.
	(ad-special-form-p): Remove, use special-form-p instead.
	(ad-set-advice-info): Use add-function and remove-function.
	(ad--defalias-fset): Adjust accordingly.

2012-11-10  Glenn Morris  <rgm@gnu.org>

	* mail/emacsbug.el (report-emacs-bug-tracker-url)
	(report-emacs-bug-bug-alist, report-emacs-bug-choice-widget)
	(report-emacs-bug-create-existing-bugs-buffer)
	(report-emacs-bug-parse-query-results)
	(report-emacs-bug-query-existing-bugs): Remove.  (Bug#7449)

	* term.el (term-default-fg-color, term-default-bg-color):
	Make obsolete, rather than just saying "deprecated" in the doc.

	* term.el (term): Rename from `term-face'.
	(term-current-face, ansi-term-color-vector)
	(term-default-fg-color, term-default-bg-color, term-ansi-reset):
	Update all users.

2012-11-10  Jan Djärv  <jan.h.d@swipnet.se>

	* server.el (server-create-window-system-frame): Handle Nextstep
	specially (Bug#12780).

2012-11-10  Glenn Morris  <rgm@gnu.org>

	* mail/emacsbug.el (report-emacs-bug-query-existing-bugs):
	Unautoload, and make obsolete.  (Bug#7449)

2012-11-10  Chong Yidong  <cyd@gnu.org>

	* vc/diff-mode.el (diff-delete-trailing-whitespace): Rewrite, and
	rename from diff-remove-trailing-whitespace (Bug#12831).

2012-11-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/advice.el: Require `cl-lib' at run-time to fix
	miscompilation of trace.el.

2012-11-10  Glenn Morris  <rgm@gnu.org>

	* vc/diff-mode.el (diff-remove-trailing-whitespace): Doc fix.

2012-11-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/gv.el (gv-define-simple-setter): Fix last change
	(bug#12812).

2012-11-10  Chong Yidong  <cyd@gnu.org>

	* minibuf-eldef.el (minibuffer-eldef-shorten-default): Convert to
	a defcustom with an appropriate :set function.
	(minibuffer-default--in-prompt-regexps): New function.

2012-11-10  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/cl.el (define-setf-expander, defsetf)
	(define-modify-macro): Doc fixes.

	* emacs-lisp/gv.el (gv-letplace): Fix doc typo.
	(gv-define-simple-setter): Update doc of `fix-return'.

2012-11-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/gv.el (gv-define-simple-setter): Don't evaluate `val'
	twice when `fix-return' is set (bug#12813).

	* emacs-lisp/cl.el (defsetf): Pass the third arg to
	gv-define-simple-setter (bug#12812).

	* woman.el (woman-decode-region): Disable adaptive-fill when rendering
	(bug#12756).

2012-11-10  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/gv.el (gv-define-setter): Fix doc typo.

	* emacs-lisp/cl-extra.el (cl-prettyexpand):
	* emacs-lisp/cl-lib.el (cl-proclaim, cl-declaim):
	* emacs-lisp/cl-macs.el (cl-destructuring-bind, cl-locally)
	(cl-the, cl-compiler-macroexpand): Add basic doc strings.

	* emacs-lisp/cl-extra.el (cl-maplist, cl-mapcan): Doc fix.

2012-11-10  Leo Liu  <sdl.web@gmail.com>

	* ido.el (ido-set-matches-1): Improve flex matching performance by
	removing backtracking in the regexp (suggested by Stefan).  (Bug#12796)

2012-11-09  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/advice.el (ad-set-advice-info): Set defalias-fset-function.
	(ad--defalias-fset): New function.
	(ad-safe-fset): Remove.
	(ad-make-freeze-definition): Use cl-letf*.

2012-11-09  Stefan Monnier  <monnier@iro.umontreal.ca>

	* subr.el (dolist): Don't bind VAR in RESULT.

	* emacs-lisp/advice.el: Miscellaneous cleanup.  Use lexical-binding.
	(fset, documentation): Don't save real def since we don't advise.
	(ad-do-advised-functions): Remove problematic `result-form'.
	(ad-safe-fset): `ad-real-fset' => `fset'.
	(ad-read-advised-function): Don't assume that ad-do-advised-functions
	uses CL's dolist internally.
	(ad-arglist): Remove unused arg `name'.
	(ad-docstring, ad-make-advised-docstring):
	`ad-real-documentation' => `documentation'.
	(warning-suppress-types): Declare.
	(ad-set-arguments): Simple CSE.
	(ad-recover-normality): Sanity check.

	* emacs-lisp/bytecomp.el (byte-compile-out-toplevel): Don't turn
	(funcall '(lambda ..) ..) into ((lambda ..) ..).

2012-11-09  Vincent Belaïche  <vincentb1@users.sourceforge.net>

	* ses.el: Symbol to coordinate mapping is made by symbol property
	`ses-cell'.  This means that the same mapping is done for all SES
	sheets.  That is good enough for cells with standard A1 names, but
	not for named cell.  So a hash map is added for the latter.
	(defconst ses-localvars): Add local variable ses--named-cell-hashmap
	(ses-sym-rowcol): Use hashmap for named cell.
	(ses-is-cell-sym-p): New defun.
	(ses-decode-cell-symbol): New defun.
	(ses-create-cell-variable): Add cell to hashmap when name is not
	A1-like.
	(ses-rename-cell): Check that cell new name is not already in
	spreadsheet with the use of ses-is-cell-sym-p
	(ses-rename-cell): Use hash map for named cells, but accept also
	renaming back to A1-like.

2012-11-09  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/advice.el: Use new dynamic docstrings.
	(ad-make-advised-definition-docstring, ad-advised-definition-p):
	Use dynamic-docstring-function instead of ad-advice-info.
	(ad--make-advised-docstring): New function extracted from
	ad-make-advised-docstring.
	(ad-make-advised-docstring): Use it.
	* progmodes/sql.el (sql--make-help-docstring): New function, extracted
	from sql-help.
	(sql-help): Use it with dynamic-docstring-function.

	* env.el (env--substitute-vars-regexp): Don't use rx (for bootstrap).

2012-11-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* files.el (hack-one-local-variable--obsolete): New function.
	(hack-one-local-variable): Use it for obsolete settings.

	* subr.el (locate-user-emacs-file): If both old and new name exist, use
	the new name.

	* progmodes/js.el (js--filling-paragraph): New var.
	(c-forward-sws, c-backward-sws, c-beginning-of-macro): Advise.
	(js-c-fill-paragraph): Prefer advice to cl-letf so the rebinding is
	less sneaky.

2012-11-08  Julien Danjou  <julien@danjou.info>

	* progmodes/ruby-mode.el (auto-mode-alist): Add Rakefile in
	`auto-mode-alist' (Bug#12835).

2012-11-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/perl-mode.el (perl-prettify-symbols): New defcustom.
	(perl--prettify-symbols-alist): New const.
	(perl--font-lock-compose-symbol, perl--font-lock-symbols-keywords):
	New functions.
	(perl-font-lock-keywords-2): Use them.
	(perl-electric-noindent-p): New function.
	(perl-mode): Use it to set up electric-indent-mode.
	(perl-electric-terminator, perl-indent-command): Mark obsolete.
	(perl-mode-map): Remove bindings for them.
	(perl-imenu-generic-expression, perl-outline-level):
	Match functions&packages in column>0.

	* env.el (env--substitute-vars-regexp): New const.
	(substitute-env-vars): Use it.  Add `only-defined' arg.
	* net/tramp.el (tramp-replace-environment-variables): Use it.

	* emacs-lisp/bytecomp.el (byte-compile-initial-macro-environment):
	Byte-compile *before* eval in eval-and-compile.
	(byte-compile-log-warning): Remove redundant inhibit-read-only.
	(byte-compile-file-form-autoload): Don't hide actual definition.
	(byte-compile-maybe-guarded): Accept `functionp' as well.

	* emacs-lisp/gv.el (gv-ref, gv-deref): New function and macro.

2012-11-07  Michael Albinus  <michael.albinus@gmx.de>

	* notifications.el (notifications-get-server-information-method):
	New defconst.
	(notifications-get-capabilities): Fix docstring.
	(notifications-get-server-information): New defun.

2012-11-06  Agustín Martín Domingo  <agustin.martin@hispalinux.es>

	* textmodes/ispell.el (ispell-region): Standard re-indent for better
	readability.

	* textmodes/ispell.el: Experimental support for support debugging.
	(ispell-create-debug-buffer): Create a `ispell-debug-buffer' debug
	buffer for ispell.
	(ispell-print-if-debug): New function to print stuff to
	`ispell-debug-buffer' if debugging is enabled.
	(ispell-region, ispell-process-line): Use `ispell-print-if-debug' to
	show some debugging info.
	(ispell-buffer-with-debug): New function that creates a debugging
	buffer and calls `ispell-buffer' with debugging enabled.

	* textmodes/ispell.el (ispell-region): Do not prefix sent string by
	comment in autoconf mode.  (Bug#12768)

2012-11-06  Dmitry Antipov  <dmantipov@yandex.ru>

	* emacs-lisp/byte-opt.el (toplevel): Add compare-window-configurations,
	frame-first-window, frame-root-window, frame-selected-window,
	minibuffer-selected-window, minibuffer-window,
	window-absolute-pixel-edges, window-at, window-body-height,
	window-body-width, window-display-table, window-combination-limit,
	window-frame, window-fringes, window-inside-absolute-pixel-edges,
	window-inside-edges, window-inside-pixel-edges, window-left-child,
	window-left-column, window-margins, window-next-buffers,
	window-next-sibling, window-new-normal, window-new-total,
	window-normal-size, window-parameter, window-parameters, window-parent,
	window-pixel-edges, window-point, window-prev-buffers,
	window-prev-sibling, window-redisplay-end-trigger, window-scroll-bars,
	window-start, window-text-height, window-top-child, window-top-line,
	window-total-height, window-total-width and window-use-time to the list
	of functions without side-effects.
	(toplevel): Add window-valid-p to the list of error-free functions
	without side-effects.

2012-11-05  Agustín Martín Domingo  <agustin.martin@hispalinux.es>

	* textmodes/ispell.el (ispell-program-name):
	Update spellchecker parameters when customized.

2012-11-04  Glenn Morris  <rgm@gnu.org>

	* vc/vc-svn.el (vc-svn-state-heuristic): Avoid calling svn.  (Bug#7850)

2012-11-04  Chong Yidong  <cyd@gnu.org>

	* bookmark.el (bookmark-bmenu-switch-other-window): Avoid binding
	same-window-* variables.

2012-11-04  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-help-for-help, isearch-describe-bindings)
	(isearch-describe-key, isearch-describe-mode): Use a display
	action instead of binding same-window-* variables (Bug#10040).

2012-11-03  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/cl-macs.el (cl-parse-loop-clause):
	Rename handler properties back from cl-- to cl-.  (Bug#12788)

	* emacs-lisp/cl-macs.el (cl-do-all-symbols): Add doc string.

2012-11-03  Eli Zaretskii  <eliz@gnu.org>

	* term/pc-win.el: Don't load term/internal from here.

	* loadup.el: Load term/internal from here.

2012-11-03  Fabián Ezequiel Gallina  <fgallina@cuca>

	* progmodes/python.el (inferior-python-mode): Fix hang in
	jit-lock (Bug#12645).

2012-11-03  Martin Rudalics  <rudalics@gmx.at>

	* window.el (switch-to-visible-buffer)
	(switch-to-buffer-preserve-window-point): Fix doc-strings.

2012-11-03  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/cl-lib.el (cl--random-time):
	Rename from cl-random-time.  (Bug#12773)
	(cl--gensym-counter, cl--random-state): Update callers.
	* emacs-lisp/cl-extra.el (cl-make-random-state): Update callers.

2012-11-03  Chong Yidong  <cyd@gnu.org>

	* cus-start.el: Make cursor-type customizable (Bug#11633).

2012-11-02  Glenn Morris  <rgm@gnu.org>

	* filecache.el: No need to load find-lisp when compiling.
	(find-lisp-find-files): Autoload it.
	(file-cache-add-directory-recursively): Don't require find-lisp.

	* image.el (image-type-from-file-name): Trivial simplification.

	* emacs-lisp/bytecomp.el (byte-compile-eval):
	Decouple "noruntime" and "cl-functions" warnings.

2012-11-01  Stephen Berman  <stephen.berman@gmx.net>

	* play/gomoku.el (gomoku-display-statistics): Update mode line
	only if in Gomoku buffer; don't capitalize "won" (Bug#12771).

2012-10-31  Martin Rudalics  <rudalics@gmx.at>

	* window.el (quit-restore-window): If the window has been
	created on an existing frame and ended up as the sole window on
	that frame, do not delete it (Bug#12764).

2012-10-31  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/sh-script.el (sh--inside-noncommand-expression):
	Rename from sh--inside-arithmetic-expression, handle more cases
	(bug#11263).

	* progmodes/sh-script.el (sh--inside-arithmetic-expression): New func.
	(sh-font-lock-open-heredoc): Use it (bug#12770).

2012-10-30  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/cl-extra.el (cl-mapc): Add autoload cookie.  Doc fix.

	* emacs-lisp/cl.el (letf): Doc fix.  (Bug#12760)

2012-10-29  Chong Yidong  <cyd@gnu.org>

	* isearch.el (isearch-other-meta-char): Ensure that a reprocessed
	function key is stored in a keyboard macro (Bug#4894).

	* thingatpt.el (number-at-point): Apply a thing-at-point property.

2012-10-29  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc/diff-mode.el (diff-context->unified): Don't get confused by "hunk
	header comments".
	(diff-unified->context, diff-context->unified)
	(diff-reverse-direction, diff-fixup-modifs): Use `use-region-p'.

	* emacs-lisp/cl.el (letf): Add missing indent rules (bug#12759).

	* files.el (find-alternate-file): Only ask one question (bug#12487).

2012-10-29  Chong Yidong  <cyd@gnu.org>

	* vc/vc-hooks.el (vc-file-clearprops): Kill vc-parent-buffer.
	Suggested by Dan Nicolaescu (Bug#6326).

	* info.el (Info-complete-menu-item): Avoid duplicates (Bug#12705).

	* startup.el (fancy-about-screen): Don't message (Bug#12680).

	* thingatpt.el (thing-at-point): Doc fix (Bug#12691).

	* imenu.el (imenu): Inhibit push-mark message (Bug#12726).

	* face-remap.el (face-remap-add-relative): Handle the case where a
	face-remapping-alist entry is a cons cell (Bug#12762).

2012-10-29  Kevin Ryde  <user42@zip.com.au>

	* woman.el (woman-parse-numeric-value): Handle picas correctly
	(Bug#12639).

2012-10-29  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/cl.el (defsetf): Doc fix.

2012-10-29  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/sh-script.el (sh-font-lock-paren): Also put punctuation
	syntax to the matching opener, if any (bug#12547).
	(sh-smie-sh-forward-token, sh-smie-sh-backward-token): Recognize this
	matching open as a "case-(".
	(sh-smie-rc-grammar): Add a corresponding rule for it.

2012-10-28  Daniel Hackney  <dan@haxney.org>

	* emacs-lisp/package.el (package-generate-autoloads): Kill buffer
	"PKGNAME-autoloads.el" in case we created it.

2012-10-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuffer.el (completion--sifn-requote): Rewrite to handle things
	like Tramp's "/foo:~bar//baz" -> "/scpc:foo:/baz" mapping (bug#11714).
	(completion--twq-all): Disable too-strict assertions.

	* tmm.el (tmm-prompt): Use map-keymap (bug#12744).

2012-10-27  Eli Zaretskii  <eliz@gnu.org>

	* profiler.el (profiler-report-make-entry-part): Fix help-echo
	text to match the real keybindings.

2012-10-27  Juri Linkov  <juri@jurta.org>

	* wdired.el (wdired-keep-marker-rename): New defcustom.
	(wdired-do-renames): Use it instead of `dired-keep-marker-rename'.
	(Bug#11795)

	* dired.el (dired-keep-marker-rename): Add reference to
	`wdired-keep-marker-rename' in the docstring.
	Add default character value ?R to display initially in
	Customization UI instead of ?@.

2012-10-27  Martin Rudalics  <rudalics@gmx.at>

	* window.el (display-buffer): In doc-string describe
	window-height and window-width alist entries.

	* time.el (display-time-world): Restore fit-window-to-buffer
	behavior.

2012-10-27  Chong Yidong  <cyd@gnu.org>

	* subr.el (insert-buffer-substring-as-yank): Doc fix.

2012-10-26  Jambunathan K  <kjambunathan@gmail.com>

	* minibuffer.el (completion-category-overrides): New completion
	category `bookmark' (bug#11131).

2012-10-26  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/advice.el (ad-assemble-advised-definition):
	Silence bogus compiler warnings for ad-do-it.

	* bookmark.el (bookmark-completing-read): Set the completion category
	to `bookmark' (bug#11131).

2012-10-26  Bastien Guerry  <bzg@altern.org>
	    Stefan Monnier  <monnier@iro.umontreal.ca>

	* face-remap.el: Use lexical-binding.
	(text-scale-adjust): Improve docstring.  Use itself for the temporary
	overlay-map bindings, so as to repeat the "Use..." message each time.

2012-10-26  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/macroexp.el (macroexp--expand-all):
	Obey byte-compile-warning-enabled-p (bug#12486).

	* vc/diff-mode.el (diff-end-of-hunk): Also skip potential "no LF at eol".
	(diff-refine-hunk): Similarly, handle the "no LF at eol" (bug#12584).

2012-10-26  Martin Rudalics  <rudalics@gmx.at>

	* mouse.el (mouse-drag-line): Move last form into preceding when
	clause (Bug#12731).

	* help.el (resize-temp-buffer-window): Fix doc-string.

2012-10-25  David Engster  <deng@randomsample.de>

	* emacs-lisp/eieio.el (eieio-update-lisp-imenu-expression):
	Remove.  This feature is already integrated in imenu.

	* emacs-lisp/eieio-opt.el: Remove require for `button' since it is
	always loaded.  Require `speedbar' unconditionally.

2012-10-25  Stefan Monnier  <monnier@iro.umontreal.ca>

	* dired.el (dired-get-marked-files): Allow ! on . and .. (bug#12725).

	* minibuffer.el (minibuffer-force-complete): Fix thinko.

	* net/ldap.el (ldap-search-internal): The official ldif format starts
	with a "version: 1" header (bug#12724).

	* emacs-lisp/package.el (package-installed-p): Warn if not ready
	(bug#12721).

2012-10-25  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/cl-macs.el (cl-progv): Doc fix.

2012-10-24  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuffer.el (minibuffer-force-complete): Use one more marker
	for the temporary-overlay-map command (bug#12619).

2012-10-24  Chong Yidong  <cyd@gnu.org>

	* time.el (display-time-world-mode): Derive from special-mode.
	(display-time-world): Use display-buffer (Bug#12708).
	(display-time-world-mode-map): Variable deleted.
	(display-time-world-display): Wrap the final delete-char inside
	inhibit-read-only.

2012-10-24  Chong Yidong  <cyd@gnu.org>

	* dired.el (dired-mark, dired-unmark, dired-flag-file-deletion):
	Doc fix.

	* emacs-lisp/easymenu.el (easy-menu-define): Doc fix (Bug#12628).

2012-10-24  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuffer.el (completion--all-sorted-completions-location): New var.
	(completion--cache-all-sorted-completions)
	(completion--flush-all-sorted-completions): Use it.
	(completion-in-region, completion-in-region--postch)
	(completion-at-point, completion-help-at-point): Use markers in
	completion-in-region--data (bug#12619).

2012-10-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/compile.el (compilation-start): Try to handle common
	quoting of `cd' argument (bug#12640).

	* vc/diff-mode.el (diff-hunk): `save-excursion' while refining
	(bug#12671).

2012-10-23  Glenn Morris  <rgm@gnu.org>

	* progmodes/gud.el (gud-menu-map):
	Check gdb-active-process is bound.  (Bug#12358)

2012-10-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* repeat.el (repeat): Set real-this-command (bug#12232).

	* htmlfontify.el (hfy-post-html-hook):
	* filesets.el (filesets-cache-fill-content-hook):
	* arc-mode.el (archive-extract-hook):
	* progmodes/cc-mode.el (c-prepare-bug-report-hook):
	* net/rcirc.el (rcirc-sentinel-functions)
	(rcirc-receive-message-functions, rcirc-activity-functions)
	(rcirc-print-functions):
	* net/dbus.el (dbus-event-error-functions):
	* emacs-lisp/eieio.el (eieio-pre-method-execution-functions):
	* emacs-lisp/checkdoc.el (checkdoc-style-functions)
	(checkdoc-comment-style-functions): Don't use "-hooks" suffix.
	* term/sun.el (sun-raw-prefix-hooks):
	* mail/sendmail.el (mail-yank-hooks): Use make-obsolete-variable.

2012-10-23  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-smb.el (tramp-smb-maybe-open-connection):
	Set `tramp-chunksize' to 1.  This improves the performance.
	(tramp-smb-wait-for-output): Add timeout to
	`tramp-accept-process-output' calls.

2012-10-23  Chong Yidong  <cyd@gnu.org>

	* faces.el (font-list-limit): Define as an obsolete variable.

	* startup.el (command-line):
	* cus-start.el: Don't refer to font-list-limit.

	* newcomment.el (comment-normalize-vars): Doc fix (Bug#12583).

2012-10-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* subr.el (internal-temp-output-buffer-show): Rename from
	temp-output-buffer-show, since previously compiled files expect this name.

2012-10-23  Glenn Morris  <rgm@gnu.org>

	* image.el (image-type-from-file-name): If multiple types match,
	return the first one that is supported.  (Bug#9045)

2012-10-22  Glenn Morris  <rgm@gnu.org>

	* image.el (imagemagick-enabled-types): Doc fix.

2012-10-22  Takafumi Arakaki  <aka.tkf@gmail.com>  (tiny change)

	* progmodes/which-func.el (which-func-current): The hash-table may have
	an explicit nil (bug#12338).

2012-10-22  Stefan Monnier  <monnier@iro.umontreal.ca>

	* electric.el (electric-pair-delete-selection-self-insert-function):
	Rename to electric-pair-will-use-region, return a boolean.
	(electric-pair-mode): Adjust accordingly.  Don't require delsel.

	* delsel.el (delete-selection-helper): Use a function instead of a hook.
	(delete-selection-pre-hook): Use use-region-p.
	(delete-selection-self-insert-function): Remove.
	(self-insert-command): Obey self-insert-uses-region-functions.
	(self-insert-iso): Revert to previous setting, since we don't actually
	know what that command does.
	(delete-selection-self-insert-hooks): Remove.

2012-10-22  Simon Law  <sfllaw@sfllaw.ca>  (tiny change)

	* delsel.el (delete-selection-helper): New function, extracted from
	delete-selection-pre-hook.
	(delete-selection-pre-hook): Use it.
	(delete-selection-self-insert-function): New function.
	(delete-selection-self-insert-hooks): New hook.
	(self-insert-command, self-insert-iso): Use it.
	* electric.el (electric-pair-syntax): New function, extracted from
	electric-pair-post-self-insert-function.
	(electric-pair-post-self-insert-function): Use it.
	(electric-pair-delete-selection-self-insert-function): New function.
	(electric-pair-mode): Require delsel and setup
	delete-selection-self-insert-hooks (bug#11520).

2012-10-20  Chong Yidong  <cyd@gnu.org>

	* vc/vc.el (vc-diff-internal): Set up Diff mode even if there are
	no changes to show (Bug#12586).

	* eshell/esh-cmd.el (eshell-rewrite-for-command): Copy the body
	list explicitly (Bug#12571).

2012-10-20  Arne Jørgensen  <arne@arnested.dk>

	* progmodes/flymake.el (flymake-create-temp-inplace):
	Use file-truename.

2012-10-20  Eli Zaretskii  <eliz@gnu.org>

	* loadup.el: Update comment about uncompiled Lisp files.  (Bug#12395)

2012-10-20  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-units.el (math-extract-units): Properly extract powers
	of units.

2012-10-20  Daniel Colascione  <dancol@dancol.org>

	* frame.el (make-frame): Set x-display-name as we used to in order
	to unbreak creating an X11 frame from an Emacs daemon started
	without a display.

2012-10-19  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuffer.el (minibuffer-force-complete): Make the next completion use
	the same completion-field (bug#12221).

2012-10-19  Martin Rudalics  <rudalics@gmx.at>

	* emacs-lisp/debug.el (debug): Record height of debugger window
	also when debugger will be back (Bug#8789).

2012-10-18  Chong Yidong  <cyd@gnu.org>

	* progmodes/gdb-mi.el (gdb-display-buffer-other-frame-action):
	Convert to defcustom.
	(gdb-get-source-file): Don't bind pop-up-windows.

	* progmodes/gud.el (gud-display-line): Don't specially re-use
	other frames for the gdb-mi case (Bug#12648).

2012-10-18  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/advice.el: Clean up commentary a bit.
	(ad-do-advised-functions, ad-with-originals): Use `declare'.
	(byte-code-function-p): Never redefine.

	* emacs-lisp/gv.el (cond): Same fix as before for `if'.

2012-10-18  Glenn Morris  <rgm@gnu.org>

	* dired.el (dired-sort-toggle): Some ls implementations only allow
	a single option string.  (Bug#12666)

	* minibuffer.el (completion-cycle-threshold): Doc fix.

2012-10-17  Kenichi Handa  <handa@gnu.org>

	* international/mule.el (set-keyboard-coding-system):
	Recover input meta mode when the new coding system doesn not use 8-bit.
	Supply TERMINAL arg to set-input-meta-mode.

2012-10-17  Michael Heerdegen  <michael_heerdegen@web.de>

	* wdired.el (wdired-old-marks): New variable.
	(wdired-change-to-wdired-mode): Locally set wdired-old-marks.
	(wdired-do-renames): Move point with renamed file and don't lose
	mark status (Bug#11795).

2012-10-16  Juri Linkov  <juri@jurta.org>

	* replace.el (query-replace-help): Mention multi-buffer replacement
	keys in the Help message.  (Bug#12655)

2012-10-15  Chong Yidong  <cyd@gnu.org>

	* emacs-lisp/byte-run.el (defsubst): Doc fix.

2012-10-14  Eli Zaretskii  <eliz@gnu.org>

	* window.el (display-buffer): Doc fix.

	* progmodes/compile.el (compilation-error-regexp-alist-alist):
	Adjust the msft regexp to the output of Studio 2010, and move msft
	before edg-1.  See the discussion on emacs-devel,
	https://lists.gnu.org/r/emacs-devel/2012-09/msg00579.html,
	for the details.

2012-10-14  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/eieio.el (eieio-oset-default, eieio-oset, oset-default)
	(oset): Move uses of object-class-fast macro after its definition.

	* emacs-lisp/gv.el (if): Don't use closures in non-lexical-binding code.

2012-10-13  Chong Yidong  <cyd@gnu.org>

	* textmodes/ispell.el (ispell-pdict-save): If flyspell-mode is
	enabled, re-enable it (Bug#11963).

2012-10-13  Martin Rudalics  <rudalics@gmx.at>

	* emacs-lisp/debug.el (debug): When debugger-will-be-back is
	non-nil, restore window configuration (Bug#12623).

2012-10-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* help-fns.el (describe-variable, describe-function-1):
	* help-mode.el (help-make-xrefs): Remove error handler, made unneeded.

	* emacs-lisp/eieio.el (lisp-imenu-generic-expression): Fix typo.

2012-10-12  Glenn Morris  <rgm@gnu.org>

	* mail/rmailsum.el (rmail-header-summary):
	Fix 2010-11-26 test for multiline Subject: field.  (Bug#12625)

2012-10-12  Fabián Ezequiel Gallina  <fgallina@cuca>

	* progmodes/python.el (python-mode-map):
	Replace subtitute-key-definition with proper command remapping.
	(python-nav--up-list): Fix behavior for blocks on the same level.

2012-10-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* help-fns.el (describe-function-1): Handle autoloads w/o docstrings.

	* emacs-lisp/bytecomp.el (byte-compile-eval): Adjust to long-ago
	changes to the format of load-history.

	* international/mule-cmds.el (read-char-by-name): Move let-binding of
	completion-ignore-case in case that var is buffer-local (bug#12615).

2012-10-11  Kenichi Handa  <handa@gnu.org>

	* international/eucjp-ms.el: Re-generated.

2012-10-10  Kenichi Handa  <handa@gnu.org>

	* select.el (xselect--encode-string): If a coding is specified for
	selection, and that is compatible with COMPOUND_TEXT, use it.

2012-10-10  Martin Rudalics  <rudalics@gmx.at>

	* window.el (switch-to-buffer-preserve-window-point): New option.
	(switch-to-buffer):
	Obey `switch-to-buffer-preserve-window-point' (Bug#4041).

2012-10-09  Stefan Monnier  <monnier@iro.umontreal.ca>

	* newcomment.el (comment-start-skip, comment-end-skip, comment-end):
	Don't document nil as a useful value (bug#12583).

2012-10-09  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-debug-message):
	Remove "tramp-with-progress-reporter" from regexp of ignored functions.
	(with-tramp-progress-reporter): Rename from
	`tramp-with-progress-reporter'.
	(with-tramp-file-property, with-tramp-connection-property):
	Move from tramp-cache.el, rename from `with-file-property' and
	`with-connection-property', respectively.

	* net/tramp-cache.el: Remove `with-file-property' and
	`with-connection-property'.

	* net/tramp.el:
	* net/tramp-gvfs.el:
	* net/tramp-sh.el:
	* net/tramp-smb.el: Adapt callees.

	* net/trampver.el: Update release number.

2012-10-09  Glenn Morris  <rgm@gnu.org>

	* w32-fns.el (set-message-beep):
	* term/w32-win.el (set-message-beep): Update declarations.

2012-10-09  Stefan Monnier  <monnier@iro.umontreal.ca>

	* bindings.el (mode-line-toggle-read-only, mode-line-toggle-modified)
	(mode-line-widen, mode-line-input-method-map)
	(mode-line-coding-system-map, mode-line-remote)
	(mode-line-unbury-buffer, mode-line-bury-buffer)
	(mode-line-next-buffer, mode-line-previous-buffer):
	Replace save-selected-window+select-window => with-selected-window.

	* progmodes/cc-bytecomp.el (cc-bytecomp-defmacro): Remove, unused.
	* progmodes/cc-vars.el (bq-process): Remove, unused.

	* emacs-lisp/cl-macs.el (cl-defstruct): Obey the :read-only property.

2012-10-09  Fabián Ezequiel Gallina  <fgallina@cuca>

	Implemented `backward-up-list'-like navigation.
	* progmodes/python.el (python-nav-up-list)
	(python-nav-backward-up-list): New functions.
	(python-mode-map): Define substitute key for backward-up-list to
	python-nav-backward-up-list.

2012-10-08  Fabián Ezequiel Gallina  <fgallina@cuca>

	* progmodes/python.el (python-fill-paragraph): Rename from
	python-fill-paragraph-function.  Fixed fill-paragraph for
	decorators (Bug#12605).

2012-10-08  Fabián Ezequiel Gallina  <fgallina@cuca>

	* progmodes/python.el (python-shell-output-filter): Handle extra
	carriage return in OSX (Bug#12409).

2012-10-08  Fabián Ezequiel Gallina  <fgallina@cuca>

	Fix shell handling of unbalanced quotes and parens in output.
	* progmodes/python.el (python-rx-constituents): Add string-delimiter.
	(python-syntax-propertize-function): Use it.
	(python-shell-output-syntax-table): New var.
	(inferior-python-mode): Prevent unbalanced parens/quotes from
	previous output mess with current input context.

2012-10-08  Juanma Barranquero  <lekktu@gmail.com>

	* generic-x.el (javascript-generic-mode, javascript-generic-mode-hook):
	Make obsolete aliases of js-mode and js-mode-hook (from js.el).

2012-10-08  Michael Albinus  <michael.albinus@gmx.de>

	* ffap.el (ffap-replace-file-component): Support Tramp file name
	syntax, not only ange-ftp's one.

2012-10-08  Glenn Morris  <rgm@gnu.org>

	* cus-start.el (message-log-max): Set :version.

	* calendar/calendar.el (calendar-intermonth-header): Doc fix.

2012-10-08  Martin Rudalics  <rudalics@gmx.at>

	* emacs-lisp/edebug.el (edebug-pop-to-buffer): Don't try to split
	the minibuffer window (Bug#10851).

2012-10-08  Fabián Ezequiel Gallina  <fgallina@cuca>

	Enhancements on forward-sexp movement.
	* progmodes/python.el (python-nav-beginning-of-statement)
	(python-nav-end-of-statement): Return point-marker.
	(python-nav-forward-sexp): lisp-like forward-sexp behavior.
	(python-info-current-symbol)
	(python-info-statement-starts-block-p): Rename from
	python-info-beginning-of-block-p.
	(python-info-statement-ends-block-p): Rename from
	python-info-end-of-block-p.
	(python-info-beginning-of-statement-p)
	(python-info-end-of-statement-p)
	(python-info-beginning-of-block-p, python-info-end-of-block-p):
	New functions.

2012-10-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* comint.el (comint-preinput-scroll-to-bottom): Preserve the
	frame-selected-windows.

2012-10-08  Daniel Colascione  <dancol@dancol.org>

	* battery.el (battery-status-function): Check for
	w32-battery-status itself, not system-time windows-nt.

	* frame.el: Require cl-lib.
	(display-format-alist): New variable mapping frame types to
	functions that initialize them.
	(window-system-for-display): New function: interprets
	display-format-alist.
	(make-frame-on-display): Remove existing display-selection logic
	and just forward to make-frame, which will now DTRT.
	(make-frame): Restructure to use window-system-for-display to
	figure out how to create a frame on a given display.
	(display-mouse-p): Look for frame-type w32, not a particular
	system-type.

	* loadup.el: Load w32 lisp code when we have the w32 feature.

	* mouse.el (mouse-yank-primarY): Look for frame-type w32, not
	system-type windows-nt.

	* server.el (server-create-window-system-frame): Look for window type.
	(server-proces-filter): Only force a window system when windows-nt
	_and_ w32.  Explain why.

	* simple.el (normal-erase-is-backspace-mode): Add w32 to the list
	of window systems we configure for the mode.

	* startup.el (command-line): Mark window system is initialized
	after we've done it.

	* term/common-win.el (x-select-text): Look for w32, not windows-nt.

	* term/ns-win.el: Require cl-lib.  Add ourselves to
	display-format-alist.
	(ns-initialize-window-system): Assert we're not initialized twice.

	* term/w32-win.el: Enable lexical binding; require cl-lib; add
	ourselves to display-format-alist.
	(w32-handle-dropped-file): Convert incoming dropped files from
	Windows paths to Cygwin ones before passing them on to the rest of
	Emacs.
	(w32-drag-n-drop): New parameter new-frame.  Simplify logic.
	(w32-initialize-window-system): Assert we're not initialized twice.

	* term/x-win.el: Require cl-lib; add ourselves to display-format-alist.
	(x-initialize-window-system): Assert we're not initialized twice.

	* w32-common-fns.el: New File.
	(w32-version, w32-using-nt, w32-get-clipboard-data)
	(w32-set-clipboard-data, x-set-selection, x-get-selection)
	(w32-charset-info-alist, x-last-selected, text)
	(x-get-selection-value, x-selection-value): Move here.

	* w32-fns.el: Require w32-common-fns.
	(w32-version, w32-using-nt, w32-get-clipboard-data)
	(w32-set-clipboard-data, x-set-selection, x-get-selection)
	(w32-charset-info-alist, x-last-selected, text)
	(x-get-selection-value, x-selection-value): Move to
	w32-common-fns.

	* w32-vars.el:
	(w32-allow-system-shell, w32-system-shells): Define only in
	non-cygwin case.

2012-10-07  Stefan Monnier  <monnier@iro.umontreal.ca>

	* subr.el (read-passwd-map): Don't use `defconst' (bug#12597).
	(read-passwd): Remove a few more potential sources of leaks.

2012-10-07  Fabián Ezequiel Gallina  <fgallina@cuca>

	* progmodes/python.el (inferior-python-mode)
	(python-shell-make-comint): Fix initialization of local
	variables copied from parent buffer.

2012-10-07  Jan Djärv  <jan.h.d@swipnet.se>

	* term/ns-win.el (ns-read-file-name): Update declaration to match
	nsfns.m.
	(ns-respond-to-change-font): Change fontsize separately so we are sure
	it is set when font is acted upon.

2012-10-07  Fabián Ezequiel Gallina  <fgallina@cuca>

	Enhancements to indentation.
	* progmodes/python.el (python-indent-context): Give priority to
	inside-string context.  Make comments indentation markers.
	(python-indent-region): Do not mess with strings, unless it's the
	enclosing set of quotes.

2012-10-07  Stefan Monnier  <monnier@iro.umontreal.ca>

	* window.el (internal--before-save-selected-window)
	(internal--after-save-selected-window): New functions extracted from
	save-selected-window.  Make sure we return the `alist' we construct.
	(save-selected-window): Use them.

	* textmodes/tex-mode.el (tex-recenter-output-buffer):
	Use with-selected-window.

	* emacs-lisp/autoload.el (make-autoload): Add `cl-defmacro' to the
	forms that define macros (bug#12593).

2012-10-07  Kenichi Handa  <handa@gnu.org>

	* international/mule-conf.el (compound-text-with-extensions):
	Add :mime-charset property as x-ctext.

2012-10-07  Stefan Merten  <smerten@oekonux.de>

	* textmodes/rst.el (rst-new-adornment-down, rst-indent-field)
	(rst-indent-literal-normal, rst-indent-literal-minimized)
	(rst-indent-comment): Correct :version tag.
	(rst-official-cvs-rev): Correct version string.

2012-10-07  Glenn Morris  <rgm@gnu.org>

	* mail/rmailmm.el (rmail-mime-process-multipart):
	Do not confuse a multipart message with an epilogue
	with a "truncated" one; fixes 2011-06-27 change.  (Bug#10101)

2012-10-07  Fabián Ezequiel Gallina  <fgallina@cuca>

	Fix shell output retrieval and comint-prompt-regexp init.
	* progmodes/python.el (inferior-python-mode):
	(python-shell-make-comint): Fix initialization of
	comint-prompt-regexp from copied file local variables.
	(python-shell-fetched-lines): Remove var.
	(python-shell-output-filter-in-progress): Rename from
	python-shell-fetch-lines-in-progress.
	(python-shell-output-filter-buffer): Rename from
	python-shell-fetch-lines-string.
	(python-shell-fetch-lines-filter): Delete function.
	(python-shell-output-filter): New function.
	(python-shell-send-string-no-output): Use them.

2012-10-07  Glenn Morris  <rgm@gnu.org>

	* hi-lock.el (hi-lock-process-phrase):
	Try to make it less fragile.  (Bug#7161)

	* hi-lock.el (hi-lock-face-phrase-buffer): Doc fix.

2012-10-06  Glenn Morris  <rgm@gnu.org>

	* ehelp.el (electric-help-mode): Use help-mode rather than
	non-existent mode `help'.
	(electric-help-map): Use button-buffer-map.  (Bug#10917)

	* textmodes/reftex-vars.el (reftex-create-bibtex-header)
	(reftex-create-bibtex-footer): Fix custom types.

	* progmodes/sh-script.el (sh-indent-after-continuation):
	Add explicit :group.

	* textmodes/rst.el (rst-preferred-decorations)
	(rst-shift-basic-offset): Clarify obsolescence versions.

	* profiler.el (profiler): Add missing group :version tag.
	* avoid.el (mouse-avoidance-banish-position):
	* proced.el (proced-renice-command):
	* calc/calc.el (calc-ensure-consistent-units):
	* calendar/icalendar.el (icalendar-import-format-uid):
	* net/tramp.el (tramp-save-ad-hoc-proxies):
	* progmodes/bug-reference.el (bug-reference-bug-regexp):
	* progmodes/flymake.el (flymake-error-bitmap)
	(flymake-warning-bitmap, flymake-fringe-indicator-position):
	* progmodes/sh-script.el (sh-indent-after-continuation):
	* progmodes/verilog-mode.el (verilog-auto-template-warn-unused)
	(verilog-before-save-font-hook, verilog-after-save-font-hook):
	* progmodes/vhdl-mode.el (vhdl-makefile-default-targets)
	(vhdl-array-index-record-field-in-sensitivity-list)
	(vhdl-indent-comment-like-next-code-line):
	* textmodes/reftex-vars.el (reftex-ref-style-alist)
	(reftex-ref-macro-prompt, reftex-ref-style-default-list)
	(reftex-cite-key-separator, reftex-create-bibtex-header)
	(reftex-create-bibtex-footer):
	* textmodes/rst.el (rst-new-adornment-down, rst-indent-field)
	(rst-indent-literal-normal, rst-indent-literal-minimized)
	(rst-indent-comment): Add missing custom :version tags.

	* calendar/timeclock.el (timeclock-modeline-display):
	Add missing obsolete alias for renamed user option.

	* strokes.el (strokes-modeline-string):
	* emulation/crisp.el (crisp-mode-modeline-string):
	* eshell/esh-mode.el (eshell-status-in-modeline):
	Aliases to defcustoms must come before the defcustom.

	* calendar/cal-tex.el (cal-tex-diary, cal-tex-cursor-week)
	(cal-tex-cursor-week2, cal-tex-cursor-week-iso)
	(cal-tex-cursor-week-monday): Doc fixes.
	(cal-tex-cursor-week2-summary): Doc fix.
	Rename from cal-tex-cursor-week-at-a-glance.

	* calendar/cal-menu.el (cal-menu-context-mouse-menu):
	Tweak week descriptions.  Add cal-tex-cursor-week2-summary.

	* calendar/calendar.el (calendar-mode-map):
	Add cal-tex-cursor-week2-summary.

2012-10-06  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/cl-macs.el (cl-defstruct): Improve docstring.

	* subr.el (read-passwd-map): New var.
	(read-passwd): Use `read-string' again.
	* minibuffer.el (delete-minibuffer-contents): Make it interactive.

2012-10-06  Jambunathan K  <kjambunathan@gmail.com>

	* register.el (append-to-register, prepend-to-register):
	Deactivate mark, as does `copy-to-register' (bug#12389).

2012-10-06  Chong Yidong  <cyd@gnu.org>

	* files.el (auto-mode-alist): Add .by and .wy (Semantic grammars).

2012-10-06  Ikumi Keita  <ikumi@ikumi.que.jp>  (tiny change)

	* international/characters.el: Fix simple mistake ((car chars) ->
	elt), delete duplicated code.

2012-10-06  Glenn Morris  <rgm@gnu.org>

	* subr.el (read-passwd): Allow C-u to erase entry.  (Bug#12570)

2012-10-06  Julian Scheid  <julians37@gmail.com>  (tiny change)

	* color.el (color-hsl-to-rgb): Fix incorrect results for
	small and large hue values.  (Bug#12559)

2012-10-05  Fabián Ezequiel Gallina  <fgallina@cuca>

	Enhancements to docstring formatting when filling paragraphs.
	* progmodes/python.el (python-fill-docstring-style): Rename from
	python-fill-string-style.  Added new style.
	(python-fill-string): Use new style.  Better checks for
	docstrings.

2012-10-05  Glenn Morris  <rgm@gnu.org>

	* net/newst-treeview.el (newsticker-group-move-feed): Doc fix.

	* color.el (color-name-to-rgb, color-rgb-to-hex)
	(color-hue-to-rgb, color-hsl-to-rgb, color-rgb-to-hsv)
	(color-rgb-to-hsl, color-srgb-to-xyz, color-saturate-hsl)
	(color-desaturate-hsl, color-desaturate-name, color-lighten-hsl)
	(color-lighten-name, color-darken-hsl, color-darken-name): Doc fixes.

	* emacs-lisp/timer.el (with-timeout): Add missing progn.  (Bug#12577)

2012-10-05  Juanma Barranquero  <lekktu@gmail.com>

	* ido.el (ido-directory-too-big-p): Pass dir through file-truename
	to get the correct size across symlinks.

	* ido.el (ido-buffer-disable-smart-matches): Fix typo in docstring.

2012-10-04  Juri Linkov  <juri@jurta.org>

	* replace.el (query-replace-interactive): Declare obsolete.
	(query-replace-read-from): Add the last incremental search string
	to the list of default values accessible via M-n.
	(map-query-replace-regexp): Use `read-regexp'.
	(query-replace, query-replace-regexp, query-replace-regexp-eval)
	(map-query-replace-regexp, replace-string, replace-regexp):
	Fix docstrings to replace mentions of `query-replace-interactive'
	with alternatives.  (Bug#12526)

2012-10-04  Juri Linkov  <juri@jurta.org>

	* dired.el (dired-shrink-to-fit): Declare obsolete.  (Bug#1806)
	(dired-pop-to-buffer): Declare obsolete.
	(dired-mark-pop-up): Doc fix.

2012-10-04  Fabián Ezequiel Gallina  <fgallina@cuca>

	Allow user to set docstring style for fill-paragraph.
	* progmodes/python.el
	(python-fill-comment-function, python-fill-string-function)
	(python-fill-decorator-function, python-fill-paren-function):
	Remove :safe for defcustoms.
	(python-fill-string-style): New defcustom
	(python-fill-paragraph-function): Enhance context detection.
	(python-fill-string): Honor python-fill-string-style settings.

2012-10-04  Martin Rudalics  <rudalics@gmx.at>

	* emacs-lisp/edebug.el (edebug-pop-to-buffer): Select window
	after setting its buffer (Bug#10805).

2012-10-03  Fabián Ezequiel Gallina  <fgallina@cuca>

	Fix cornercase for string syntax.
	* progmodes/python.el (python-syntax-propertize-function):
	Simplify and enhance the regexp for unescaped quotes.  Now it also
	matches quotes in weird situations like the single quote in
	"something\"'".
	(python-syntax-stringify): Simplify num-quotes detecting code.

2012-10-03  Glenn Morris  <rgm@gnu.org>

	* help-macro.el (three-step-help):
	Revert 2012-09-29 change.  (Bug#12567)

2012-10-03  Martin Rudalics  <rudalics@gmx.at>

	* menu-bar.el (kill-this-buffer): Don't do anything when
	`menu-frame' is not alive or visible (Bug#8184).

	* emacs-lisp/debug.el (debug): When quitting the debugger window
	restore current buffer (Bug#12502).

2012-10-02  Chong Yidong  <cyd@gnu.org>

	* progmodes/hideif.el (hif-lookup, hif-defined):
	Handle semantic-c-takeover-hideif.

2012-10-02  Paul Eggert  <eggert@cs.ucla.edu>

	Change sampling interval units from ms to ns.
	* profiler.el (profiler-sampling-interval): Change units
	from ms to ns, multiplying the default by 1000000 so that
	it remains 1 ms.
	(profiler-report-cpu-line-format): Give enough room for
	the maximum counters on 64-bit hosts.
	(profiler-report-render-calltree-1): Call them "CPU samples",
	not "Time (ms)", since they are not milliseconds now (and
	never really were).

2012-10-02  Sergio Durigan Junior  <sergiodj@riseup.net>  (tiny change)

	* net/eudcb-bbdb.el (eudc-bbdb-format-record-as-result):
	Fix querying BBDB for entries without a last name (Bug#11580).

2012-10-02  Chong Yidong  <cyd@gnu.org>

	* emacs-lisp/eieio.el: Restore Version header.

2012-10-02  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc/diff-mode.el (diff--auto-refine-data): New var.
	(diff-hunk): Use it to delay refinement.
	(diff-mode): Remove overlays when we turn off font-lock.

	* textmodes/table.el: Use lexical-binding, dolist, define-minor-mode.
	(table-initialize-table-fixed-width-mode)
	(table-set-table-fixed-width-mode): Remove functions.
	(table-command-list): Move initialization into declaration.
	(table--tweak-menu-for-xemacs): Move defun outside mapcar.
	(table-with-cache-buffer): Use `declare'.
	(table-span-cell): Simplify via CSE.
	(table-fixed-width-mode): Use define-minor-mode.
	(table-call-interactively, table-funcall, table-apply): Remove.
	(table-function): New function, to replace them.

	* bookmark.el (bookmark-search-pattern): Remove var.
	(bookmark-read-search-input): Remove function.
	(bookmark-bmenu-search): Reimplement using a minibuffer.

	* faces.el (modeline): Remove obsolete face name.

	* vc/add-log.el (add-log-buffer-file-name-function): Demote to defvar
	and give a non-nil default value.
	(add-change-log-entry): Simplify accordingly.

2012-10-01  Dmitry Gutov  <dgutov@yandex.ru>

	* vc/vc-git.el (vc-git-log-edit-toggle-signoff): New function.
	(vc-git-log-edit-toggle-amend): New function.
	(vc-git-log-edit-toggle-signoff): New function.
	(vc-git-log-edit-mode): New major mode.
	(vc-git-log-edit-mode-map): Keymap for it.
	(vc-git-checkin): Handle "Amend" and "Sign-Off" headers.

	* vc/log-edit.el (log-edit-font-lock-keywords): Allow hyphens in
	header names.
	(log-edit-toggle-header): New function.
	(log-edit-extract-headers): Accept function values in HEADERS alist.

2012-10-01  David Engster  <deng@randomsample.de>

	* emacs-lisp/eieio-opt.el (eieio-describe-class): Add filename
	from symbol property and change message to be more consistent with
	Emacs proper.
	(eieio-describe-generic): Add filename for each implementation.
	Fix indices for generic and normal methods.
	(eieio-method-def, eieio-class-def): New buttons.
	(eieio-help-find-method-definition)
	(eieio-help-find-class-definition): New functions.
	(eieio-help-mode-augmentation-maybee): Add buttons to filenames of
	class, constructor and method definitions.

	* emacs-lisp/eieio.el (eieiomt-add, eieio-defclass): Save file
	information in symbol property.
	(scoped-class): Remove.
	(eieio-slot-name-index, call-next-method): Check if it is bound.

2012-10-01  Leo P. White  <lpw25@cam.ac.uk>

	* emacs-lisp/eieio-custom.el (eieio-custom-mode-map): New option.
	(eieio-custom-mode): New major mode.
	(eieio-customize-object): Use it.

2012-10-01  Eric Ludlam  <zappo@gnu.org>

	* emacs-lisp/eieio-base.el (eieio-persistent-read): New input args
	specifying the expected class, and whether subclassing is allowed.
	(eieio-persistent-convert-list-to-object):
	(eieio-persistent-validate/fix-slot-value)
	(eieio-persistent-slot-type-is-class-p): New functions.
	(eieio-named::slot-missing): Doc fix.

	* emacs-lisp/eieio-datadebug.el (data-debug/eieio-insert-slots):
	Stop using unused publd variable.

	* emacs-lisp/eieio-speedbar.el (eieio-speedbar-handle-click):
	(eieio-speedbar-description, eieio-speedbar-derive-line-path)
	(eieio-speedbar-object-buttonname, eieio-speedbar-make-tag-line)
	(eieio-speedbar-handle-click): Do not specify a class for the
	method.  Fixes method invocation order problems with EDE.

2012-10-01  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/bytecomp.el (byte-compiler-abbreviate-file): New function.
	(byte-compile-warning-prefix, byte-compile-file): Use it (bug#12508).

2012-10-01  Karl Fogel  <kfogel@red-bean.com>

	* bookmark.el (bookmark-version-control): Give tags in the
	:type choices (Bug#12309), and improve doc string.
	(bookmark-write-file): Bind `print-circle' to `t' to allow
	circular custom bookmark types.  (Bug#12503)

2012-10-01  Paul Eggert  <eggert@cs.ucla.edu>

	Revert the FOLLOW-SYMLINKS change for file-attributes.
	* files.el (remote-file-name-inhibit-cache, after-find-file):
	* time.el (display-time-file-nonempty-p): Undo last change.

	* profiler.el (profiler-sampling-interval): Change default back to 1.
	See Stefan Monnier in
	<https://lists.gnu.org/r/emacs-devel/2012-09/msg00863.html>.

2012-10-01  Fabián Ezequiel Gallina  <fgallina@cuca>

	Shell output catching a la gud-gdb.
	* progmodes/python.el (python-shell-fetch-lines-in-progress)
	(python-shell-fetch-lines-string, python-shell-fetched-lines):
	New Vars.
	(python-shell-fetch-lines-filter): New function.
	(python-shell-send-string-no-output): Use them.

2012-09-30  Tomohiro Matsuyama  <tomo@cx4a.org>

	* profiler.el (profiler-sampling-interval): Rename from
	profiler-sample-interval.
	(profiler-sampling-interval): Default to 10.
	(profiler-find-profile): New command (was profiler-find-log).
	(profiler-find-profile-other-window): New command.
	(profiler-find-profile-other-frame): New command.
	(profiler-profile): Introduce API-level data structure.

2012-09-30  Paul Eggert  <eggert@cs.ucla.edu>

	file-attributes has a new optional arg FOLLOW-SYMLINKS.
	* files.el (remote-file-name-inhibit-cache):
	* time.el (display-time-file-nonempty-p): Use it.
	* files.el (after-find-file): Don't chase links before calling
	file-exists-p, as file-exists-p already does the right thing.

2012-09-30  Ralf Angeli  <angeli@caeruleus.net>

	Merge from standalone RefTeX repository.

	The following ChangeLog entries are shortened versions of the
	original ones with file paths adapted.  A not so strongly edited
	version of the original ChangeLog can be found in the commit log.

	* textmodes/reftex-auc.el: Move `provide' call to bottom of file.
	(reftex-arg-cite): Use `reftex-cite-key-separator'.
	Correctly handle new value type returned by `reftex-citation'.

	* textmodes/reftex-cite.el (reftex-create-bibtex-file): Make sure
	that entries with whitespace at various places are found.
	Doc fix.  Include entries that are cross-referenced from cited entries.
	Include @String definitions in the resulting bib file.  Add header
	and footer defined in `reftex-create-bibtex-header' and
	`reftex-create-bibtex-footer'.
	(reftex-do-citation): Make it possible again to insert
	non-existent entries.  Save match data when asking for optional
	arguments.  Return all keys, not just the first one.
	(reftex-all-used-citation-keys): Fix regexp to correctly extract
	all citations in the same line.
	(reftex-parse-bibtex-entry): Accept additional optional argument
	`raw' and keep quotes or braces if it is non-nil.  Match fields
	containing hyphens besides word constituents.
	(reftex-get-string-refs): New function.
	(reftex-extract-bib-entries): Check if BibTeX file changed on disk
	and ask if it should be reread in case it did.
	(reftex-pop-to-bibtex-entry)
	(reftex-extract-bib-entries-from-thebibliography): Match \bibitem
	entries with spaces or tabs in front of arguments.
	(reftex-pop-to-bibtex-entry, reftex-extract-bib-entries)
	(reftex-parse-bibtex-entry, reftex-create-bibtex-file):
	Match entries containing numbers and symbol constituents.
	(reftex-do-citation, reftex-figure-out-cite-format):
	Use `reftex-cite-key-separator'.

	* textmodes/reftex-dcr.el: Move provide statement to end of file.
	(reftex-mouse-view-crossref): Explain why point is set.

	* textmodes/reftex-global.el: Whitespace changes.

	* textmodes/reftex-index.el: Move provide statement to end of
	file.
	(reftex-index-selection-or-word): Use `reftex-region-active-p'.
	(reftex-index-visit-phrases-buffer): Set marker when visiting
	buffer.  This allows for returning from the phrases file to the
	file one was just editing instead of the file where the last
	phrases was added from.
	(reftex-index-phrases-syntax-table): New variable.  Give ?\"
	punctuation syntax as it usually is not used as string quote in
	TeX-related modes and may occur unmatched.  The change also
	prevents fontification of quoted content.
	(reftex-index-phrases-mode): Use it.

	* textmodes/reftex-parse.el (reftex-parse-from-file):
	Move backward one char if a `\' was matched after a section macro.
	(reftex-parse-from-file): Use beginning of match instead of end as
	bound.

	* textmodes/reftex-ref.el: Adapt creation of
	`reftex-<package>-<macro>' functions to new structure of
	`reftex-ref-style-alist'.
	(reftex-reference): Use `reftex-ref-style-list' function.
	Adapt to new structure of `reftex-ref-style-alist'.  Prompt for a
	reference macro if `reftex-ref-macro-prompt' is non-nil.
	(reftex-reference): Pass refstyle to `reftex-format-special'.
	Determine reference macro by looking at
	`reftex-ref-style-default-list' and `reftex-ref-style-alist'.
	Use only one special format function.
	(reftex-varioref-vref, reftex-fancyref-fref)
	(reftex-fancyref-Fref): Remove definitions.  The functions are now
	generated from `reftex-ref-style-alist'.
	(reftex-format-vref, reftex-format-Fref, reftex-format-fref):
	Remove.
	(reftex-format-special): New function.

	* textmodes/reftex-sel.el
	(reftex-select-cycle-ref-style-internal): Adapt to new structure
	of `reftex-ref-style-alist'.  Remove code for testing macro type.
	(reftex-select-toggle-varioref)
	(reftex-select-toggle-fancyref): Remove.
	(reftex-select-cycle-ref-style-internal)
	(reftex-select-cycle-ref-style-forward)
	(reftex-select-cycle-ref-style-backward): New functions.
	(reftex-select-label-map): Use `v' and `V' for general cycling
	through reference styles.  Add `p' for switching between number
	and page reference types.

	* textmodes/reftex-toc.el (reftex-re-enlarge):
	Call `enlarge-window' only if there is something to do because in Emacs
	the horizontal version throws an error even if the parameter is 0.

	* textmodes/reftex-vars.el (reftex-label-alist): Doc fix.
	(reftex-plug-into-AUCTeX): Doc fix.
	(reftex-vref-is-default, reftex-fref-is-default): Adapt doc
	string.  Adapt to new name.
	(reftex-ref-style-alist): Change structure so that it is not
	possible to use multiple different package names within a style.
	Remove the symbols for symbols for macro type distinction.
	Add characters for macro selection.
	(reftex-ref-macro-prompt, reftex-create-bibtex-header)
	(reftex-create-bibtex-footer): New variables.
	(reftex-format-ref-function): Mention third argument of special
	format function.
	(reftex-ref-style-alist, reftex-ref-style-default-list):
	New variables.
	(reftex-vref-is-default, reftex-fref-is-default): Adapt doc string
	to new implementation.  Mark as obsolete.  Add compatibility code
	for honoring the variable values in case they are set.
	(reftex-cite-format-builtin, reftex-bibliography-commands):
	Add support for ConTeXt.
	(reftex-format-ref-function, reftex-format-cite-function):
	Fix custom type.
	(reftex-cite-key-separator): New variable.

	* textmodes/reftex.el (reftex-syntax-table-for-bib)
	(reftex-mode): Do not derive `reftex-syntax-table-for-bib' from
	`reftex-syntax-table' because parens have to retain their paren
	syntax in order for parsing of BibTeX entries like @book(...) to
	work.
	(reftex-in-comment): Do not error out if `comment-start-skip' is
	not set.  Deal correctly with escaped comment characters.
	(reftex-tie-multifile-symbols): Add doc string.
	Initialize `reftex-ref-style-list'.
	(reftex-untie-multifile-symbols): Add doc string.
	(reftex-add-index-macros): Doc fix.
	(reftex-ref-style-activate, reftex-ref-style-toggle)
	(reftex-ref-style-list): New functions.
	(reftex-mode-menu): Use them.  Adapt to new structure of
	`reftex-ref-style-alist'.
	(reftex-select-with-char): Kill the RefTeX Select buffer when
	done.
	(reftex-remove-if): New function.
	(reftex-erase-all-selection-and-index-buffers)
	(reftex-mode-menu): Reference styles are now computed from
	`reftex-ref-style-alist'.  Fix typo.
	(reftex-report-bug): New function.
	(reftex-uniquify, reftex-uniquify-by-car): Replace O(n^2)
	algorithms with O(n log n).  Introduce optional argument SORT (not
	yet used).

2012-09-30  Fabián Ezequiel Gallina  <fgallina@cuca>

	Enhancements for triple-quote string syntax.
	* progmodes/python.el (python-syntax-propertize-function):
	Match both quote cases in one regexp.
	(python-syntax-stringify): Handle matches properly.

2012-09-30  Juri Linkov  <juri@jurta.org>

	* arc-mode.el (archive-summarize): Let-bind `buffer-file-truename'
	to nil around the call to `insert' to prevent
	directory time modification by lock_file.  (Bug#2295)
	* tar-mode.el (tar-summarize-buffer): Idem.

2012-09-30  Juri Linkov  <juri@jurta.org>

	* facemenu.el (list-colors-sort): Add option "Luminance".
	(list-colors-sort-key): Implement it.

	* vc/diff-mode.el (diff-refine-removed):
	* vc/ediff-init.el (ediff-fine-diff-A):
	* vc/smerge-mode.el (smerge-refined-removed):
	Change background color "#ffaaaa" to "#ffbbbb".  (Bug#10181)

2012-09-30  Jan Djärv  <jan.h.d@swipnet.se>

	* term/ns-win.el (x-file-dialog): New function.

2012-09-30  Juanma Barranquero  <lekktu@gmail.com>

	* ido.el (ido-max-directory-size): Default to nil; the current
	default is small for POSIX systems, and impractical on Windows 7
	now that lstat returns directory sizes for NTFS.

2012-09-30  Martin Rudalics  <rudalics@gmx.at>

	In buffer display functions handle window-height/window-width
	alist entries.  Suggested by Juri Linkov as fix for Bug#1806.
	* window.el (window--display-buffer): New argument ALIST.
	Obey window-height and window-width alist entries.
	(window--try-to-split-window): New argument ALIST.
	Bind window-combination-limit to t when the window's size shall be
	changed and window-combination-limit equals `window-size'.
	(display-buffer-in-atom-window)
	(display-buffer-in-major-side-window)
	(display-buffer-in-side-window, display-buffer-same-window)
	(display-buffer-reuse-window, display-buffer-pop-up-frame)
	(display-buffer-pop-up-window, display-buffer-below-selected)
	(display-buffer-at-bottom, display-buffer-in-previous-window)
	(display-buffer-use-some-window): Adjust all callers of
	window--display-buffer and window--try-to-split-window.
	(fit-frame-to-buffer): New option.
	(fit-window-to-buffer): Can resize frames if fit-frame-to-buffer
	is non-nil.
	(display-buffer-in-major-side-window): Evaluate window-height /
	window-width alist entries.

	* help.el (temp-buffer-resize-frames)
	(temp-buffer-resize-regexps): Remove options.
	(temp-buffer-resize-mode): Adjust doc-string.
	(resize-temp-buffer-window): Don't consult
	temp-buffer-resize-regexps.  Use fit-frame-to-buffer instead of
	temp-buffer-resize-frames.

	* dired.el (dired-mark-pop-up):
	Call display-buffer-below-selected with a fit-window-to-buffer alist
	entry.

2012-09-30  Chong Yidong  <cyd@gnu.org>

	* server.el (server-host): Document the security implications.
	(server-auth-key): Doc fix.

	* startup.el (initial-buffer-choice): Doc fix.

	* minibuffer.el (minibuffer-local-filename-syntax): Doc fix.

	* simple.el (delete-trailing-whitespace): Avoid an unnecessary
	restriction change.

	* bindings.el (goto-map): Bind M-g TAB to move-to-column.

	* help-fns.el (help-fns--obsolete): Fix last change.

2012-09-30  Stefan Monnier  <monnier@iro.umontreal.ca>

	* winner.el (winner-mode-map): Obey winner-dont-bind-my-keys here.
	(minor-mode-map-alist): Remove redundant code.

	* vc/pcvs.el (cvs-cleanup-collection): Keep entries that are currently
	visited in a buffer.
	(cvs-insert-visited-file): New function.
	(find-file-hook): Use it.

	* vc/pcvs-info.el (cvs-fileinfo-pp): Don't use non-existent faces.

	* vc/log-edit.el (log-edit-font-lock-keywords): Ignore case to
	chose face.
	(log-edit-empty-buffer-p): Don't require a space after a header.

	* vc/ediff-util.el (ediff-diff-at-point): Don't assume point-min==1.

	* tutorial.el (help-with-tutorial): Use minibuffer-with-setup-hook.

	* textmodes/text-mode.el (paragraph-indent-minor-mode): Make it
	a proper minor-mode.

	* textmodes/tex-mode.el (tex-mode-map): Don't bind paren keys.

2012-09-29  Glenn Morris  <rgm@gnu.org>

	* winner.el (winner-mode): Remove variable (let define-minor-mode
	handle it).
	(winner-dont-bind-my-keys, winner-boring-buffers, winner-mode-hook):
	Doc fixes.
	(winner-mode-leave-hook): Rename to winner-mode-off-hook.
	(winner-mode): Use define-minor-mode.

	* vc/vc-sccs.el (vc-sccs-registered): Use the progn trick to get
	the full definition in loaddefs, rather than duplicating it.

	* help-macro.el (three-step-help): No need to autoload defcustom.

	* progmodes/inf-lisp.el (inferior-lisp-filter-regexp)
	(inferior-lisp-program, inferior-lisp-load-command)
	(inferior-lisp-prompt, inferior-lisp-mode-hook):
	No need to autoload defcustoms.

	* hippie-exp.el (hippie-expand-try-functions-list)
	(hippie-expand-verbose, hippie-expand-dabbrev-skip-space)
	(hippie-expand-dabbrev-as-symbol, hippie-expand-no-restriction)
	(hippie-expand-max-buffers, hippie-expand-ignore-buffers)
	(hippie-expand-only-buffers): No need to autoload defcustoms.
	* progmodes/vhdl-mode.el (vhdl-line-expand):
	Explicitly load hippie-exp, so it does not get autoloaded
	while hippie-expand-try-functions-list is let-bound.

2012-09-28  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/cl.el (flet): Fix case of obsolescence message.

	* emacs-lisp/bytecomp.el (byte-compile-cl-file-p):
	Only "cl.el" counts as cl these days.

2012-09-28  Juri Linkov  <juri@jurta.org>

	Display archive errors in the echo area instead of inserting
	to the file buffer.

	* arc-mode.el (archive-extract-by-stdout): Change arg STDERR-FILE
	to STDERR-TEST that can be a regexp matching a successful output.
	Create a temporary file and redirect stderr to it.  Search for
	STDERR-TEST in the stderr output and display it in the echo area
	if no match is found.
	(archive-extract-by-file): New function like
	`archive-extract-by-stdout' but extracting archives to files
	and looking for successful matches in stdout.  Function body is
	mostly copied from `archive-rar-extract'.
	(archive-rar-extract): Use `archive-extract-by-file'.
	(archive-7z-extract): Use `archive-extract-by-stdout'.  (Bug#10347)

2012-09-28  Leo Liu  <sdl.web@gmail.com>

	* pcomplete.el (pcomplete-show-completions):
	Use minibuffer-message to make pcomplete usable in minibuffer.

	* ido.el (ido-set-matches-1): Fix 2012-09-11 change.

2012-09-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* type-break.el: Use lexical-binding.
	(type-break-mode): Use define-minor-mode.

	* emacs-lisp/pcase.el (pcase--mark-used): New.
	(pcase--u1): Use it (bug#12512).

	* custom.el (load-theme): Set buffer-file-name so the load is recorded
	in load-history with the right file name.

2012-09-28  Tassilo Horn  <tsdh@gnu.org>

	* doc-view.el (doc-view-current-cache-doc-pdf): New function.
	(doc-view-doc->txt, doc-view-convert-current-doc): Use it.
	(doc-view-get-bounding-box): Make bounding box slicing work for
	ODF and DVI documents.

2012-09-28  Glenn Morris  <rgm@gnu.org>

	* type-break.el (type-break-mode, type-break-interval)
	(type-break-good-rest-interval, type-break-keystroke-threshold):
	No need to autoload.
	(type-break-good-rest-interval, type-break-keystroke-threshold):
	Add :set-after.

2012-09-28  Chong Yidong  <cyd@gnu.org>

	* progmodes/verilog-mode.el (verilog-auto-inst-interfaced-ports):
	Add :version tag.

2012-09-27  Stefan Monnier  <monnier@iro.umontreal.ca>

	* json.el (json-encode-char): Codes 127-160 aren't "ASCII printable".

2012-09-27  Glenn Morris  <rgm@gnu.org>

	* faces.el (x-display-name): Declare (for without-x builds).

	* linum.el (linum-format): Don't autoload it.  Improve :type.

	* progmodes/tcl.el: Don't require outline when compiling.
	(outline-regexp, outline-level): Declare.
	* textmodes/sgml-mode.el: Don't require outline when compiling.
	(outline-regexp, outline-heading-end-regexp, outline-level): Declare.

	* term.el (term-ansi-reset):
	Try setting term-ansi-face-already-done to nil.  (Bug#11785)

	* vc/vc.el (vc-next-action): Only gripe about committing read-only
	files for RCS and SCCS.  (Bug#9781)

2012-09-27  Chong Yidong  <cyd@gnu.org>

	* progmodes/verilog-mode.el (verilog-mode-release-emacs): Fix last
	change; value should be t.

2012-09-27  Stefan Monnier  <monnier@iro.umontreal.ca>

	* image-mode.el: Use lexical-binding.
	(image-mode-winprops): Use t to stand for the window of
	a buffer that's not displayed.
	* doc-view.el (doc-view-new-window-function): Handle the new
	t in winprops.
	(doc-view-enlarge): Make it a real nop if the size is not changed.
	(doc-view-display): Handle the case where the buffer is not (yet?)
	displayed in any window.
	(doc-view-saved-settings): New var.
	(doc-view-mode): Use it.
	(doc-view-fallback-mode): Set it.

	* minibuf-eldef.el: Make it possible to replace (default ...) with [...].
	Set lexical-binding.
	(minibuffer-eldef-shorten-default): New var.
	(minibuffer-default-in-prompt-regexps): Use it for new default.
	(minibuf-eldef-setup-minibuffer): Add replacement functionality.

2012-09-26  Juanma Barranquero  <lekktu@gmail.com>

	* international/uni-bidi.el:
	* international/uni-category.el:
	* international/uni-name.el:
	* international/uni-numeric.el: Regenerate.

2012-09-26  Tomohiro Matsuyama  <tomo@cx4a.org>
	    Stefan Monnier  <monnier@iro.umontreal.ca>

	* profiler.el: New file.

2012-09-26  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/testcover.el (testcover-after): Add gv-expander.
	(testcover-reinstrument): Simplify with CSE.

2012-09-26  Juanma Barranquero  <lekktu@gmail.com>

	* window.el (temp-buffer-window-setup): Fix typo in docstring.

2012-09-25  Wilson Snyder  <wsnyder@wsnyder.org>

	* progmodes/verilog-mode.el (verilog-auto-ascii-enum)
	(verilog-auto-inout, verilog-auto-input, verilog-auto-insert-lisp)
	(verilog-auto-output, verilog-auto-output-every, verilog-auto-reg)
	(verilog-auto-reg-input, verilog-auto-tieoff, verilog-auto-undef)
	(verilog-auto-unused, verilog-auto-wire)
	(verilog-forward-or-insert-line): Fix AUTOs with no trailing
	newline.  Reported by Andrew Jones.
	(verilog-auto-inst) Support expanding $clog2 in AUTOINST.
	Reported by Brad Dobbie.
	(verilog-batch-delete-trailing-whitespace):
	Create verilog-batch-delete-trailing-whitespace.
	Reported by Brad Dobbie.
	(verilog-auto-inout-param): Support AUTOINOUTPARAM for copying
	parameters from another module.  Reported by Dan Katz.
	(verilog-auto, verilog-auto-assign-modport)
	(verilog-auto-inout-modport): Add AUTOASSIGNMODPORT and
	AUTOINOUTMODPORT for UVM interface module shell generation.
	Reported by Brad Dobbie.
	(verilog-auto-inst-interfaced-ports): Make default nil, as more
	standard behavior.
	(verilog-auto): Fix AUTO parameters with parenthesis arguments.
	Reported by Matt Martin.

2012-09-25  Martin Rudalics  <rudalics@gmx.at>

	* window.el (window--resize-child-windows): When resizing child
	windows proportionally, process them in reverse order to
	preserve the "when splitting a window the new one gets the odd
	line" behavior.
	(window--resize-root-window-vertically): When resizing the
	minibuffer window try to affect only windows at the bottom of the
	frame.  (Bug#12419)

2012-09-25  Chong Yidong  <cyd@gnu.org>

	* subr.el (declare): Doc fix.

	* help-fns.el (help-fns--obsolete): Handle macros properly.

2012-09-25  Chong Yidong  <cyd@gnu.org>

	* bookmark.el (bookmark-jump-noselect): Use a declare form to mark
	this function obsolete.

	* calendar/cal-x.el (calendar-two-frame-setup)
	(calendar-only-one-frame-setup, calendar-one-frame-setup):
	* calendar/calendar.el (american-calendar, european-calendar)
	(calendar-for-loop):
	* comint.el (comint-dynamic-simple-complete)
	(comint-dynamic-complete-as-filename, comint-unquote-filename):
	* desktop.el (desktop-load-default):
	* dired-x.el (dired-omit-here-always)
	(dired-hack-local-variables, dired-default-directory):
	* emacs-lisp/derived.el (derived-mode-class):
	* emacs-lisp/timer.el (timer-set-time-with-usecs):
	* emacs-lock.el (toggle-emacs-lock):
	* epa.el (epa-display-verify-result):
	* epg.el (epg-sign-keys, epg-start-sign-keys)
	(epg-passphrase-callback-function):
	* eshell/esh-util.el (eshell-for):
	* eshell/eshell.el (eshell-remove-from-window-buffer-names)
	(eshell-add-to-window-buffer-names):
	* files.el (locate-file-completion):
	* imenu.el (imenu-example--create-c-index)
	(imenu-example--create-lisp-index)
	(imenu-example--lisp-extract-index-name)
	(imenu-example--name-and-position):
	* international/mule-cmds.el (princ-list):
	* international/mule-diag.el (decode-codepage-char):
	* international/mule-util.el (detect-coding-with-priority):
	* iswitchb.el (iswitchb-read-buffer):
	* mail/mailalias.el (mail-complete):
	* mail/sendmail.el (mail-sent-via):
	* mouse.el (mouse-popup-menubar-stuff, mouse-popup-menubar)
	(mouse-major-mode-menu):
	* password-cache.el (password-read-and-add):
	* pcomplete.el (pcomplete-parse-comint-arguments):
	* progmodes/sh-script.el (sh-maybe-here-document):
	* replace.el (query-replace-regexp-eval):
	* savehist.el (savehist-load):
	* simple.el (choose-completion-delete-max-match):
	* term.el (term-dynamic-simple-complete):
	* vc/ediff-init.el (ediff-check-version):
	* vc/ediff-wind.el (ediff-choose-window-setup-function-automatically):
	* vc/vc.el (vc-diff-switches-list):
	* view.el (view-return-to-alist-update): Likewise.

	* subr.el (eval-next-after-load, makehash, insert-string)
	(assoc-ignore-representation, assoc-ignore-case): Use declare to
	mark obsolete.
	(mode-line-inverse-video): Variable deleted.

	* international/mule-util.el (string-to-sequence): Remove.

	* calendar/calendar.el (calendar-version):
	* calendar/icalendar.el (icalendar-extract-ical-from-buffer)
	(icalendar-convert-diary-to-ical):
	* cus-edit.el (custom-mode):
	* ansi-color.el (ansi-color-unfontify-region):
	* international/latin1-disp.el (latin1-char-displayable-p):
	* progmodes/cwarn.el (turn-on-cwarn-mode):
	* progmodes/which-func.el (which-func-update-1):
	Use define-obsolete-function-alias.

	* net/newst-backend.el (newsticker-cache-filename):
	* net/newst-treeview.el (newsticker-groups-filename):
	Fix incorrect obsolescence declaration.

	* allout.el (allout-passphrase-hint-string): Likewise.
	(allout-init): Use a declare form to mark obsolete.

	* emacs-lisp/byte-run.el (make-obsolete): Doc fix; emphasize that
	this applies to functions.

	* iswitchb.el (iswitchb-read-buffer): Move code of
	iswitchb-define-mode-map here, and delete that obsolete function.

	* net/snmp-mode.el (snmp-font-lock-keywords-3): Don't use obsolete
	font-lock-reference-face.

2012-09-25  Glenn Morris  <rgm@gnu.org>

	* buff-menu.el (Buffer-menu-name-width, Buffer-menu-size-width):
	Doc fixes.

	* eshell/em-term.el (eshell-term-name):
	Default to term-term-name.  (Bug#12485)

2012-09-24  Fabián Ezequiel Gallina  <fgallina@cuca>

	* progmodes/python.el (python-shell-send-buffer): Better handling
	of "if __name__ == '__main__':" conditionals when sending the buffer.

2012-09-24  Glenn Morris  <rgm@gnu.org>

	* eshell/esh-cmd.el (eshell-find-alias-function):
	Tighten up file-name regexp.  (Bug#12499)

2012-09-24  Fabián Ezequiel Gallina  <fgallina@cuca>

	Enhancements for triple-quote string syntax.
	* progmodes/python.el (python-quote-syntax): Remove.
	(python-syntax-propertize-function): New value.
	(python-syntax-count-quotes, python-syntax-stringify):
	New functions.

2012-09-24  Chong Yidong  <cyd@gnu.org>

	* mail/supercite.el (sc-version): Remove obsolete function.
	(sc-describe): Don't mark as obsolete, since it is bound.
	(sc-submit-bug-report): Remove.

	* vc/log-edit.el (cvs-changelog-full-paragraphs)
	(cvs-commit-buffer-require-final-newline): Remove.
	(log-edit-require-final-newline)
	(log-edit-changelog-full-paragraphs): Default to t.

	* vc/pcvs-defs.el (cvs-diff-buffer-name, cvs-diff-ignore-marks)
	* vc/vc-hooks.el (vc-ignore-vc-files, vc-master-templates)
	* vc/vc.el (vc-checkout-carefully): Likewise.

	* vc/emerge.el (emerge-mode): Make it an obsolete alias.
	(emerge-version): Remove.

	* progmodes/compile.el (compile-internal): Remove.
	(compilation-parse-errors-function): Fix typo.

	* international/mule.el (set-char-table-default): Remove.
	(set-coding-priority, make-coding-system, generic-char-p)
	(charset-list, charset-bytes, charset-id): Use declare to mark
	functions as obsolete.

	* vc/pcvs-defs.el (cvs-buffer-name-alist)
	(cvs-invert-ignore-marks): Remove references to obsolete vars.
	* vc/vc-hooks.el (vc-default-registered): Don't use
	vc-master-templates.

	* font-lock.el (font-lock-reference-face):
	Use define-obsolete-variable-alias.

	* generic-x.el (rul-generic-mode): Use font-lock-constant-face.
	* calendar/calendar.el (calendar-font-lock-keywords):
	* calendar/diary-lib.el (diary-font-lock-keywords)
	(diary-fancy-font-lock-keywords):
	* textmodes/reftex-sel.el (reftex-insert-docstruct):
	* textmodes/reftex-index.el (reftex-insert-index):
	* textmodes/reftex-cite.el (reftex-format-bib-entry):
	* progmodes/ruby-mode.el (ruby-font-lock-keywords):
	* progmodes/ps-mode.el (ps-mode-font-lock-keywords-1):
	* progmodes/prolog.el (prolog-font-lock-keywords):
	* progmodes/idlwave.el (idlwave-idl-keywords):
	* progmodes/ada-mode.el (ada-font-lock-keywords):
	* net/snmp-mode.el (snmp-font-lock-keywords-3): Likewise.

2012-09-24  Glenn Morris  <rgm@gnu.org>

	* mail/emacsbug.el (report-emacs-bug): Include `lsb_release -d'.

2012-09-23  Fabián Ezequiel Gallina  <fgallina@cuca>

	* progmodes/python.el (python-indent-line): More consistent cursor
	movement behavior.

2012-09-23  Stefan Merten  <smerten@oekonux.de>

	* textmodes/rst.el: Fix compiler warning.

2012-09-23  Roland Winkler  <winkler@gnu.org>

	* textmodes/bibtex.el (bibtex-autokey-transcriptions):
	Transcribe also LaTeX hyphenation.
	(bibtex-reformat): Bug fix.  Do not quote twice the elements of
	bibtex-reformat-previous-options.

2012-09-23  Roland Winkler  <winkler@gnu.org>

	* proced.el (proced-renice-command): New variable.
	(proced-marked-processes): New function.
	(proced-with-processes-buffer): New macro.
	(proced-send-signal): Use them.
	(proced-renice): New command bound to r.

2012-09-23  Roland Winkler  <winkler@gnu.org>

	* ibuf-ext.el (ibuffer-switch-to-saved-filter-groups): If list
	ibuffer-saved-filter-groups has one element, shortcut the call of
	completing-read.  (Bug#12331)

2012-09-23  Chong Yidong  <cyd@gnu.org>

	* bindings.el (mode-line-toggle-read-only):
	* bs.el (bs-toggle-readonly):
	* buff-menu.el (Buffer-menu-toggle-read-only):
	* dired.el (dired-toggle-read-only):
	* ibuffer.el (ibuffer-do-toggle-read-only): Use read-only-mode.

2012-09-23  Chong Yidong  <cyd@gnu.org>

	* image.el (image-type-available-p): Adapt to init-image-library
	argument changes.

2012-09-22  Juri Linkov  <juri@jurta.org>

	* dired.el (dired-mode-map): Add [remap read-only-mode] for
	`dired-toggle-read-only'.  (Bug#12462)

2012-09-22  Martin Rudalics  <rudalics@gmx.at>

	* subr.el (temp-output-buffer-show): New function.
	(with-output-to-temp-buffer): Call temp-output-buffer-show
	instead of internal-temp-output-buffer-show.

2012-09-22  Chong Yidong  <cyd@gnu.org>

	* files.el (ctl-x-map): Bind C-x C-q to read-only-mode
	(Bug#12462).

	* repeat.el (repeat): Doc fix (Bug#12348).

	* emacs-lisp/easy-mmode.el (define-minor-mode): Doc fix
	(Bug#10909).

	* simple.el (shell-command-on-region): Doc fix.
	(read-only-mode): Doc fix.

2012-09-22  Eli Zaretskii  <eliz@gnu.org>

	* emacs-lisp/timer.el (run-with-idle-timer)
	(timer-activate-when-idle): Warn against reinvoking an idle timer
	from within its own timer action.  (Bug#12447)

2012-09-22  Martin Rudalics  <rudalics@gmx.at>

	* cus-start.el (window-combination-limit): Add new optional
	values.
	* window.el (temp-buffer-window-show)
	(window--try-to-split-window): Handle new values of
	window-combination-limit (Bug#1806).
	(split-window): Test window-combination-limit for t instead of
	non-nil.
	(display-buffer-at-bottom): New buffer display action function.
	* help.el (temp-buffer-resize-regexps): New option.
	(temp-buffer-resize-mode): Rewrite doc-string.
	(resize-temp-buffer-window): Obey temp-buffer-resize-regexps.
	Don't resize reused window.  Suggested by Glenn Morris.

2012-09-22  Stefan Merten  <smerten@oekonux.de>

	* textmodes/rst.el: Revamp section title faces.
	(rst-official-version)
	(rst-package-emacs-version-alist): Sync with official version
	V1.4.0.
	(rst-faces-defaults, rst-set-level-default)
	(rst-level-face-max, rst-level-face-base-color)
	(rst-level-face-base-light, rst-level-face-format-light)
	(rst-level-face-step-light, rst-define-level-faces): Obsolete.
	(rst-adornment-faces-alist): Match new setup.
	(rst-level-1, rst-level-2, rst-level-3, rst-level-4)
	(rst-level-5, rst-level-6): New faces.

2012-09-22  Chong Yidong  <cyd@gnu.org>

	* simple.el (undo): Handle indirect buffers (Bug#8207).

2012-09-21  Leo Liu  <sdl.web@gmail.com>

	IDO: Disable match re-ordering for buffer switching.
	* ido.el (ido-buffer-disable-smart-matches): New variable.
	(ido-set-matches-1): Use it.  (Bug#2042)

2012-09-21  Jose Marino  <marinoj@nso.edu>  (tiny change)

	* progmodes/idlw-shell.el (idlwave-shell-complete-filename):
	Fix 2011-05-17 change.  (Bug#12418)

2012-09-21  Leo Liu  <sdl.web@gmail.com>

	* subr.el (ignore-errors): Mention with-demoted-errors in doc-string.

2012-09-21  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/shadow.el (load-path-shadows-font-lock-keywords):
	Be more robust about locating simple.el.

2012-09-21  Glenn Morris  <rgm@gnu.org>

	* mail/emacsbug.el (report-emacs-bug): Trap load-path-shadows errors.

2012-09-21  Joel Bion  <jpbion@westvi.com>  (tiny change)

	* pcmpl-gnu.el (pcmpl-gnu-tarfile-regexp): Add tar.xz.  (Bug#12382)

2012-09-20  Juri Linkov  <juri@jurta.org>

	* replace.el (query-replace-read-from): Use `read-regexp' instead
	of `read-from-minibuffer' when `regexp-flag' is non-nil.
	(occur-read-primary-args): Use `read-regexp' instead of
	`read-string'.
	(multi-occur-in-matching-buffers): Use `read-regexp' instead of
	`read-from-minibuffer'.
	* isearch.el (isearch-occur): Use `read-regexp' instead of
	`read-string'.
	* dired.el (dired-read-regexp): Use `read-regexp' instead of
	`read-from-minibuffer'.
	* progmodes/grep.el (grep-read-regexp): Use `read-regexp' instead
	of `read-string'.  (Bug#7567)

	* replace.el (read-regexp): Rename DEFAULT-VALUE arg to DEFAULTS
	and allow accepting a list of strings prepended to a list of
	standard default values.  Doc fix.  (Bug#12321)

	* replace.el (read-regexp): Add HISTORY arg.  (Bug#7567)

	* replace.el (read-regexp): Don't add ": " when PROMPT already
	ends with a colon and space.  (Bug#12321)

2012-09-20  Tassilo Horn  <tsdh@gnu.org>

	* doc-view.el (doc-view-display): Better fix for the cl-assertion
	error.

2012-09-20  Stefan Merten  <smerten@oekonux.de>

	* textmodes/rst.el: Integrate support for `imenu' and `which-function'.
	Fixes feature request bug#11711.
	(rst-mode): Create `imenu-create-index-function'.
	(rst-get-stripped-line): Delete after refactoring.
	(rst-section-tree, rst-section-tree-rec)
	(rst-section-tree-point): Refactor and document properly.
	(rst-imenu-find-adornments-for-position)
	(rst-imenu-convert-cell, rst-imenu-create-index):
	New function.

2012-09-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/macroexp.el (macroexp--obsolete-warning): New function.
	(macroexp--expand-all): Use it.
	(macroexp--funcall-and-return): Remove by folding it into its sole
	caller (macroexp--warn-and-return).
	* emacs-lisp/bytecomp.el (byte-compile-warn-obsolete):
	Use macroexp--obsolete-warning.

	* calc/calc.el: Fix last change by removing the whole chunk, since it
	was only needed back when Calc was not bundled.

2012-09-20  Martin Rudalics  <rudalics@gmx.at>

	* emacs-lisp/debug.el (debug): Restore assignment to
	debugger-old-buffer removed on 2012-09-08.

2012-09-20  Juri Linkov  <juri@jurta.org>

	* dired-aux.el (dired-diff): Remove (require 'diff) since
	`diff-latest-backup-file' is now autoloaded.

2012-09-20  Chong Yidong  <cyd@gnu.org>

	* vc/diff.el (diff-latest-backup-file): Autoload.

2012-09-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* calc/calc.el: Remove redundant autoload shape check.
	(sel-mode): Don't defvar.
	(calc-get-stack-element): Add `sel-mode' arg instead.
	(calc-top, calc-top-list): Pass it this additional argument.
	* calc/calc-store.el (calc-store-map):
	* calc/calc-map.el (calc-apply, calc-reduce, calc-map)
	(calc-map-equation, calc-outer-product, calc-inner-product):
	* calc/calc-aent.el (calc-alg-entry): Don't bind sel-mode.

	* emacs-lisp/macroexp.el (macroexp--expand-all): Fix last change.

2012-09-19  Juri Linkov  <juri@jurta.org>

	* dired-aux.el (dired-diff): Add (require 'diff) because
	`diff-latest-backup-file' is not autoloaded.
	(dired-do-chxxx, dired-do-chmod): Set `no-error-if-not-filep' arg
	of `dired-get-filename' to t to not report error when there is
	no default file on the current line.

2012-09-19  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/macroexp.el (macroexp--funcall-if-compiled): Rename from
	macroexp--eval-if-compile.
	(macroexp--funcall-and-return, macroexp--warn-and-return): New funs.
	(macroexp--expand-all): Use them (bug#12371).

	* doc-view.el (doc-view-guess-paper-size)
	(doc-view-scale-bounding-box): Fix unbound `caddr'.

2012-09-19  Tassilo Horn  <tsdh@gnu.org>

	New feature: set optimal slice from BoundingBox information.
	* doc-view.el (doc-view-mode-map): Add keybinding.
	(doc-view-menu): Add menu entry.
	(doc-view-set-slice): Adapt docstring.
	(doc-view-get-bounding-box, doc-view-guess-paper-size)
	(doc-view-scale-bounding-box)
	(doc-view-set-slice-from-bounding-box): New functions.
	(doc-view-paper-sizes): New defvar.

2012-09-19  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/macroexp.el (byte-compile-warn-obsolete)
	(byte-compile-log-warning): Autoload.  (Bug#12371)

	* calendar/calendar.el (calendar-american-month-header)
	(calendar-european-month-header, calendar-iso-month-header)
	(calendar-month-header): New options.
	(calendar-set-date-style): Set calendar-month-header.  Redraw calendar.
	(calendar-generate-month): Use calendar-month-header.  (Bug#9510)

2012-09-19  Jan Djärv  <jan.h.d@swipnet.se>

	* startup.el (command-line-ns-option-alist): Add -g and --geometry.

2012-09-18  Juri Linkov  <juri@jurta.org>

	* dired-aux.el (dired-diff): Restore original functionality of
	getting the default value, but keep new feature of using the
	latest existing backup file (`diff-latest-backup-file').

2012-09-18  Juri Linkov  <juri@jurta.org>

	* dired.el (dired-mark): If the region is active in Transient Mark
	mode, mark all files in the active region.  Doc fix.
	(dired-unmark, dired-flag-file-deletion, dired-unmark-backward):
	Doc fix.  (Bug#10624)

2012-09-18  Juri Linkov  <juri@jurta.org>

	* dired-aux.el (dired-do-chxxx, dired-do-chmod): Default file
	attributes for M-n are pulled from the file at point.
	(dired-do-chgrp, dired-do-chown, dired-do-touch): Doc fix.
	Suggested by Drew Adams.  (Bug#10624)

2012-09-18  Dmitry Gutov  <dgutov@yandex.ru>

	* progmodes/ruby-mode.el (ruby-brace-to-do-end): Don't add extra
	whitespace after "end".
	(ruby-do-end-to-brace): Collapse block to one line if it fits
	within fill-column.

2012-09-18  Martin Rudalics  <rudalics@gmx.at>

	* emacs-lisp/debug.el (debugger-bury-or-kill): Fix customization
	value.
	(debug): Don't remove debugger window when debugger is expected
	to be back.

2012-09-18  Chong Yidong  <cyd@gnu.org>

	* custom.el (defface): Doc fix.

	* cus-edit.el (custom-unlispify-remove-prefixes): Add warning.

2012-09-18  Martin Blais  <blais@furius.ca>  (tiny change)

	* progmodes/compile.el (compilation-start): Use compilation-always-kill
	to initialize query-on-exit; then test that instead (bug#12288).

2012-09-17  Stefan Merten  <smerten@oekonux.de>

	* textmodes/rst.el: Add support for `testcover'.
	(rst-defcustom-testcover, rst-testcover-add-compose)
	(rst-testcover-add-1value): New functions.
	(rst-portable-mark-active-p): Replace by `use-region-p'.
	(rst-update-section, rst-classify-adornment)
	(rst-find-title-line): Mark `1value' forms.
	(rst-classify-adornment): Remove superfluous form.
	(rst-update-section, rst-get-adornments-around)
	(rst-adornment-complete-p, rst-get-next-adornment)
	(rst-adjust, rst-promote-region)
	(rst-display-adornments-hierarchy, rst-straighten-adornments)
	(rst-find-pfx-in-region, rst-section-tree-rec)
	(rst-section-tree-point, rst-toc-insert, rst-toc-insert-node)
	(rst-toc-node, rst-toc, rst-forward-section)
	(rst-iterate-leftmost-paragraphs)
	(rst-iterate-leftmost-paragraphs-2, rst-enumerate-region)
	(rst-bullet-list-region)
	(rst-convert-bullets-to-enumeration, rst-font-lock-keywords)
	(rst-compile-find-conf, rst-compile)
	(rst-repeat-last-character): Fix style.

2012-09-17  Chong Yidong  <cyd@gnu.org>

	* comint.el (comint--complete-file-name-data): Don't add a space
	if the status is `sole'; that adds a gratuitous space in the
	completion-cycling case (Bug#12092).

	* pcomplete.el (pcomplete-completions-at-point): Likewise.

2012-09-17  Richard Stallman  <rms@gnu.org>

	* mail/rmailmm.el (rmail-mime-toggle-raw): Do rmail-mime-insert
	only in the mime-shown mode, not in raw mode.
	(rmail-mime): Toggle off mime by displaying the message without
	mime processing.  (Bug#12305)

	* mail/rmail.el (rmail-retry-failure):
	Turn off mime processing first.  (Bug#12037)

	* epa-mail.el (epa-mail-encrypt): Fix bug when a name has no key.

2012-09-17  Chong Yidong  <cyd@gnu.org>

	* shell.el (shell-file-name-chars, shell-file-name-quote-list)
	(shell-dynamic-complete-functions): Convert to defcustom.
	(shell-prompt-pattern, shell-completion-fignore): Doc fix.

	* bookmark.el (bookmark-bmenu-toggle-filenames): Doc fixes.
	* comint.el (comint-prompt-read-only):
	* custom.el (defcustom):
	* hi-lock.el (hi-lock-mode):
	* ibuffer.el (ibuffer-formats):
	* ielm.el (ielm-prompt-read-only):
	* novice.el (disable-command):
	* saveplace.el (toggle-save-place):
	* speedbar.el (speedbar-supported-extension-expressions):
	* startup.el (auto-save-list-file-prefix, init-file-user)
	(after-init-hook, inhibit-startup-echo-area-message):
	* strokes.el (strokes-help):
	* time-stamp.el (time-stamp):
	* calendar/calendar.el (calendar, diary-file):
	* calendar/diary-lib.el (diary-mail-entries, diary)
	(diary-list-entries-hook):
	* calendar/holidays.el (holidays, calendar-holidays):
	* calendar/lunar.el (lunar-phases):
	* calendar/solar.el (sunrise-sunset):
	* emulation/edt.el (edt-load-keys):
	* emulation/viper.el (viper-mode):
	* eshell/em-alias.el (eshell-command-aliases-list):
	* eshell/esh-util.el (eshell-convert-numeric-arguments):
	* international/ogonek.el (ogonek-information):
	* net/tramp-cmds.el (tramp-bug):
	* net/quickurl.el (quickurl-reread-hook-postfix):
	* play/decipher.el (decipher-font-lock-keywords):
	* progmodes/cc-styles.el (c-set-style):
	* progmodes/idlw-shell.el (idlwave-shell-prompt-pattern):
	* progmodes/inf-lisp.el (inferior-lisp-prompt):
	* progmodes/octave-mod.el (octave-mode):
	* progmodes/sql.el (sql-mode, sql-interactive-mode, sql-password):
	* progmodes/verilog-mode.el (verilog-read-defines):
	* textmodes/two-column.el (2C-mode): Likewise.

2012-09-16  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mail/mailabbrev.el (mail-abbrev-expand-hook): Work for a mail aliasee
	that holds many addresses.

2012-09-16  Chong Yidong  <cyd@gnu.org>

	* align.el (align-areas): Call the indication function with
	positions instead of markers for arguments (Bug#12343).

	* files.el (parse-colon-path): Use split-string (Bug#12351).

	* window.el (special-display-popup-frame): Doc fix (Bug#8853).
	(display-buffer-function): Mark as obsolete.

	* progmodes/compile.el (compilation-parse-errors): Accept list
	values similar to font-lock-keywords (Bug#12136).
	Suggested by Oleksandr Manzyuk.
	(compilation-error-regexp-alist): Doc fix.

2012-09-15  Glenn Morris  <rgm@gnu.org>

	* version.el (emacs-bzr-version-bzr): New function.
	(emacs-bzr-get-version): Add optional EXTERNAL argument.

	* vc/vc-bzr.el (vc-bzr-working-revision): For lightweight local
	checkouts, check the parent dirstate matches the branch.
	Add "--tree" to "bzr revno" arguments.  Don't try to shorten the
	empty string.

	* version.el (emacs-bzr-version): Doc fix.
	(emacs-bzr-version-dirstate): New function.
	(emacs-bzr-get-version): For lightweight checkouts, if the parent
	is local try and check that it matches the branch.  If not, just
	use dirstate information.  (Bug#12441)

2012-09-14  Juri Linkov  <juri@jurta.org>

	* dired-aux.el (dired-do-chmod): Use `eq' to detect empty input.
	(Bug#12399)

2012-09-14  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/advice.el (ad-prognify): Remove, use macroexp-progn.

	* emacs-lisp/edebug.el: Miscellaneous cleanup.
	Remove obsolete byte-compiler hack that tried to silence some warnings.
	(edebug-submit-bug-report): Remove.
	(edebug-get-buffer-window, edebug-sit-for, edebug-input-pending-p):
	Remove aliases, use the un-prefixed name instead.
	(edebug-pop-to-buffer): Consider other frames.
	(edebug-original-read):: Make it more obvious that it's always defined.
	(edebug--make-form-data-entry, edebug--form-data-name)
	(edebug--form-data-begin, edebug--form-data-end): Rename from the
	single-dashed name, and implement with cl-defstruct.
	(edebug-set-form-data-entry): Use the standard accessors.
	(edebug-make-top-form-data-entry): Use push.
	(edebug-no-match): Drop useless `funcall'.
	(mapcar, mapconcat, mapatoms, apply, funcall): Don't add debug specs
	to functions.
	(defsubst, dont-compile, eval-when-compile, eval-and-compile)
	(delay-mode-hooks, with-temp-file, with-temp-message, ad-dolist)
	(with-syntax-table, push, pop, 1value, noreturn, defadvice)
	(easy-menu-define, with-custom-print): Remove redundant specs.
	(edebug-outside-overriding-local-map)
	(edebug-outside-overriding-terminal-local-map): Remove, unused.
	(edebug--display): Bind unread-command-events directly to nil rather
	than binding it to unread-command-events and later setting it to nil.
	(edebug--display): Kill edebug-eval-buffer here...
	(edebug--recursive-edit): ...rather than here.
	Bind standard-output and standard-input.
	(edebug-eval): Check cl-macroexpand-all is fboundp.
	(edebug-temp-display-freq-count): Fix last change.

	* emacs-lisp/easymenu.el (easy-menu-define): Add `debug' spec.
	* subr.el (noreturn, 1value): Add `debug' spec.
	* emacs-lisp/advice.el: Require cl-lib.
	(ad-copy-tree): Remove, use copy-tree instead.
	(ad-dolist): Remove use dolist or cl-dolist instead.
	(ad-do-return): Remove, use cl-return instead.
	(defadvice): Add `debug' spec.

2012-09-13  Juri Linkov  <juri@jurta.org>

	* dired-aux.el (dired-do-chxxx): Use `eq' to detect empty input.
	(Bug#12399)

2012-09-13  Glenn Morris  <rgm@gnu.org>

	* calc/calc.el (math-compose-expr):
	* calc/calc-ext.el (math-compose-expr):
	* progmodes/cc-defs.el (cl-macroexpand-all):
	* progmodes/cc-langs.el (delete-duplicates, mapcan)
	(cl-macroexpand-all): Update declarations.

	* vc/vc.el: No need to require ediff.
	(ediff-load-version-control): Declare.
	(ediff-vc-internal): Fix declaration.
	(vc-version-ediff): Require ediff.

2012-09-13  Paul Eggert  <eggert@cs.ucla.edu>

	Use a more backwards-compatible timer format (Bug#12430).
	* emacs-lisp/timer.el (timer): PSECS is now at the end, rather than
	being right after USECS, as that better supports old code that
	inadvisedly looked directly at the timer vector.

2012-09-13  Kenichi Handa  <handa@gnu.org>

	* language/chinese.el ("Chinese-GB", "Chinese-BIG5")
	("Chinese-CNS", "Chinese-EUC-TW"): Add chinese-gbk to
	`coding-priority' property of these language environment.

2012-09-13  Paul Eggert  <eggert@cs.ucla.edu>

	Fix glitches caused by addition of psec to timers (Bug#12430).
	* image.el (image-animate-timer):
	* time.el (display-time-world-timer):
	Use timer--function and timer--args rather than raw access to
	timer vector.

2012-09-13  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/bytecomp.el (byte-compile-warning-prefix):
	If not compiling a file, try using load-file-name.

2012-09-13  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/edebug.el (edebug-outside-unread-command-events):
	Fix last change.
	(edebug-update-eval-list): Use `push'.

	* emacs-lisp/edebug.el: Use lexical-binding.
	Remove the "edebug-" prefix from non-dynamically-scoped variables.
	Mark unused args with underscore.
	(edebug-save-restriction, edebug-outside-excursion): Use `declare'.
	(edebug-form-data): Use defvar-local.
	(edebug-make-before-and-after-form, edebug-make-after-form):
	Use backquote.
	(edebug-args, edebug-value, edebug-after-index, edebug-arg-mode):
	Not dynamically scoped any more.
	(edebug--enter-trace): Add arguments `function' and `args'.
	Rename from edebug-enter-trace.
	(edebug-enter): Call it accordingly.  Bind edebug-function explicitly.
	(edebug--update-coverage): Add `after-index' and `value' args.
	Rename from edebug-update-coverage.
	(edebug-slow-after): Call it accordingly.
	(edebug--recursive-edit): Add arg `arg-mode'.  Rename from
	edebug-recursive-edit.
	(edebug--display): Call it accordingly.  Add args `value',
	`offset-index', and `arg-mode'.  Rename from edebug-display.
	(edebug-debugger, edebug): Call it accordingly.
	(edebug-eval-display-list): Use dolist.

2012-09-12  Juri Linkov  <juri@jurta.org>

	* info.el (Info-search): Don't check for isearch-mode and
	isearch-regexp before let-binding search-spaces-regexp to
	Info-search-whitespace-regexp.
	(Info-isearch-search): Let-bind Info-search-whitespace-regexp to
	search-whitespace-regexp if isearch-lax-whitespace or
	isearch-regexp-lax-whitespace is non-nil.
	(Info-mode): Don't set local variable search-whitespace-regexp.
	https://lists.gnu.org/r/emacs-devel/2012-08/msg00811.html

2012-09-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/debug.el (debugger-outer-unread-command-char, debug)
	(debugger-env-macro): Remove support for unread-command-char.

	* subr.el (set-temporary-overlay-map): Minimize slightly the impact of
	the temporary map re-appearing on emulation-mode-map-alists.

	* emacs-lisp/edebug.el (def-edebug-form-spec): Remove, it's been broken
	since 22.1.

	* ehelp.el (with-electric-help): Accept functions in
	electric-help-form-to-execute.
	(electric-help-execute-extended, electric-help-ctrl-x-prefix): Use it.
	And replace unread-command-char -> unread-command-events.

2012-09-12  Michael Albinus  <michael.albinus@gmx.de>

	Sync with Tramp 2.2.6.

	* net/tramp.el (tramp-accept-process-output): Don't use
	JUST-THIS-ONE in the XEmacs case.

	* net/trampver.el: Update release number.

2012-09-12  Martin Rudalics  <rudalics@gmx.at>

	* emacs-lisp/debug.el (debugger-previous-window-height):
	New variable.
	(debug): When debugger-jumping-flag is non-nil try to restore
	height of debugger window.  (Bug#8789)

2012-09-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/edebug.el (edebug-enter): Don't mess with
	overriding-local-map and pre/post-command-hook here.
	(edebug-recursive-edit): Do it here instead (bug#12345).
	(edebug-outside-unread-command-char): Remove all uses of
	unread-command-char.

	* emacs-lisp/debug.el (debug): Don't bind debug-on-error since
	inhibit-debugger is bound instead.

2012-09-11  Bastien Guerry  <bzg@gnu.org>

	* subr.el (set-temporary-overlay-map): Add a docstring.
	(Bug#12346)

2012-09-11  Bastien Guerry  <bzg@gnu.org>

	* minibuffer.el (completion-table-subvert): Fix docstring.
	(Bug#12347)

2012-09-11  Bastien Guerry  <bzg@gnu.org>

	* help-fns.el (describe-variable): Fix typo.  (Bug#12346)

2012-09-10  Michael R. Mauger  <mmaug@yahoo.com>

	* progmodes/sql.el: Version 3.1
	(sql-db2-escape-newlines): New variable.
	(sql-escape-newlines-filter): Use it.

2012-09-10  Juanma Barranquero  <lekktu@gmail.com>

	* custom.el (custom-theme-load-confirm): Remove unneeded assignment.

2012-09-10  Dan Nicolaescu  <dann@gnu.org>

	* vc/diff-mode.el (diff-mode-menu):
	Bind diff-remove-trailing-whitespace.

2012-09-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/lisp-mode.el (emacs-list-byte-code-comment-re): New var.
	(emacs-lisp-byte-code-comment, emacs-lisp-byte-code-syntax-propertize)
	(emacs-lisp-byte-code-mode): New functions.
	(eval-sexp-add-defvars): Don't skip defvars in column >0.
	(eval-defun-2): Remove bogus interactive spec.
	(lisp-indent-line): Remove redundant whole-exp code, now done in
	indent-according-to-mode.
	(save-match-data): Remove redundant indent data.

	* emacs-lisp/benchmark.el (benchmark-run, benchmark-run-compiled):
	Use `declare'.

2012-09-09  Juri Linkov  <juri@jurta.org>

	* replace.el (replace-regexp-lax-whitespace): New defcustom.
	(replace-lax-whitespace, query-replace-regexp)
	(query-replace-regexp-eval, replace-regexp): Doc fix.
	(perform-replace, replace-highlight): Let-bind
	isearch-lax-whitespace to replace-lax-whitespace and
	isearch-regexp-lax-whitespace to replace-regexp-lax-whitespace.

	* isearch.el (isearch-query-replace): Let-bind
	replace-lax-whitespace to isearch-lax-whitespace and
	replace-regexp-lax-whitespace to
	isearch-regexp-lax-whitespace.  (Bug#10885)

2012-09-09  Stefan Monnier  <monnier@iro.umontreal.ca>

	* eshell/em-unix.el (eshell/sudo): Explicitly drop return value.

2012-09-09  Alan Mackenzie  <acm@muc.de>

	* progmodes/cc-engine.el (c-state-cache-init):
	Initialize c-state-semi-nonlit-pos-cache\(-limit\)? properly.
	(c-record-parse-state-state):
	Record c-state-semi-nonlit-pos-cache\(-limit\)?.

2012-09-09  Andreas Schwab  <schwab@linux-m68k.org>

	* register.el (register-separator): Rename from
	separator-register.  All uses changed.  Doc fix.
	(register): Fix version.

2012-09-09  Chong Yidong  <cyd@gnu.org>

	* replace.el (query-replace-map): Bind four new symbols for
	requesting window scrolling.

	* subr.el (y-or-n-p): Handle the window-scrolling bindings in
	query-replace-map (Bug#8948).

	* custom.el (custom-theme-load-confirm): Use y-or-n-p.

	* emacs-lisp/map-ynp.el (map-y-or-n-p): Don't bind scrolling keys
	since they are now in query-replace-map.

	* window.el (scroll-other-window-down): Make the arg optional.

2012-09-09  Chong Yidong  <cyd@gnu.org>

	* files.el (hack-local-variables-confirm): Use quit-window to kill
	the *Local Variables* buffer.

2012-09-08  Dmitry Gutov  <dgutov@yandex.ru>

	* progmodes/ruby-mode.el (ruby-toggle-block): Guess the current block,
	not just expect to be at its beginning.  Adjust callees.
	Succeed when do-end block has no space before the pipe character.
	(ruby-brace-to-do-end): When the original block is one-liner,
	convert to multiline.  Reindent the result.

2012-09-08  Jambunathan K  <kjambunathan@gmail.com>

	* register.el (register): New group.
	(separator-register): New user option.
	(increment-register): Route it to `append-to-register', if
	register contains text.  Implication is that `C-x r +' can now be
	used for appending to a text register (bug#12217).
	(append-to-register, prepend-to-register): Add separator based on
	`separator-register'.

2012-09-08  Alan Mackenzie  <acm@muc.de>

	AWK Mode: make auto-newline work when there's "==" in the pattern.
	* progmodes/cc-cmds.el (c-point-syntax): Handle virtual semicolons
	correctly.
	* progmodes/cc-engine.el (c-guess-basic-syntax CASE 5A.3):
	Test more rigorously for "=" token.

2012-09-08  Dmitry Gutov  <dgutov@yandex.ru>

	* progmodes/ruby-mode.el (ruby-match-expression-expansion):
	Only fail when reached LIMIT.

2012-09-08  Chong Yidong  <cyd@gnu.org>

	* dired.el (dired-mode-map): Don't bind M-=.

	* dired-aux.el (dired-diff): Use backup file as default.

2012-09-08  Drew Adams  <drew.adams@oracle.com>

	* subr.el (add-to-history): Fix delete usage (Bug#12314).

2012-09-08  Chong Yidong  <cyd@gnu.org>

	* subr.el (syntax-after, syntax-class): Doc fix.

2012-09-08  Martin Rudalics  <rudalics@gmx.at>

	* window.el (display-buffer-in-previous-window): New buffer
	display action function.

	* emacs-lisp/debug.el (debugger-bury-or-kill): New option.
	(debugger-previous-window): New variable.
	(debug): Rewrite using display-buffer-in-previous-window,
	quit-restore-window and debugger-bury-or-kill.  (Bug#8789)

2012-09-07  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/byte-run.el (defun): Tweak message.  Simplify code.

2012-09-07  Matt McClure  <mlm@aya.yale.edu>  (tiny change)

	* progmodes/python.el (python-shell-send-string):
	When default-directory is remote, create temp file on remote
	filesystem.
	(python-shell-send-file): When file is remote, pass local view of
	file paths to remote Python interpreter.  (Bug#12340)

2012-09-07  Chong Yidong  <cyd@gnu.org>

	* window.el (switch-to-buffer): Doc fix (Bug#12181).

	* files.el (after-find-file): Don't fail on a read-only buffer if
	require-final-newline is `visit' or `visit-save' (Bug#11156).

	* subr.el (read-char-choice): Allow quitting via ESC ESC.

	* userlock.el (ask-user-about-supersession-threat):
	Use read-char-choice (Bug#12093).

2012-09-07  Chong Yidong  <cyd@gnu.org>

	* subr.el (buffer-narrowed-p): New function.

	* ses.el (ses-widen):
	* simple.el (count-words--buffer-message):
	* net/browse-url.el (browse-url-of-buffer): Use it.

	* simple.el (count-words-region): Don't signal an error if there
	is a non-nil prefix arg and the mark is not set.

	* help.el (describe-key-briefly): Allow the message to be seen
	when invoked from the minibuffer (Bug#7014).

2012-09-07  Dmitry Gutov  <dgutov@yandex.ru>

	* progmodes/ruby-mode.el (ruby-end-of-defun)
	(ruby-beginning-of-defun): Simplify, allow indentation before
	block beginning and end keywords.
	(ruby-beginning-of-defun): Only consider 3 keywords defun beginners.
	(ruby-end-of-defun): Expect that the point is at the beginning of
	the defun.

2012-09-06  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/cl-macs.el (cl--do-arglist): Understand _ on &key args
	(bug#12367).
	(cl--make-usage-args): Strip _ from argument names.

2012-09-06  Rüdiger Sonderfeld  <ruediger@c-plusplus.de>

	* progmodes/vhdl-mode.el (vhdl-speedbar-initialize): Don't use
	obsolete alias speedbar-key-map.
	(vhdl-doc-variable, vhdl-doc-mode): Use called-interactively-p.
	(vhdl-index-menu-init): Don't use obsolete variable
	font-lock-maximum-size.

2012-09-06  Chong Yidong  <cyd@gnu.org>

	* frame.el (window-system-version): Mark as obsolete.

	* speedbar.el (speedbar-update-flag, speedbar-mode): Remove uses
	of obsolete variable speedbar-key-map.

2012-09-06  Juri Linkov  <juri@jurta.org>

	* replace.el (replace-lax-whitespace): New defcustom.
	(query-replace, query-replace-regexp, query-replace-regexp-eval)
	(replace-string, replace-regexp): Mention it in docstrings.
	(perform-replace, replace-highlight): Let-bind
	isearch-lax-whitespace and isearch-regexp-lax-whitespace according
	to the values of replace-lax-whitespace and regexp-flag.
	Don't let-bind search-whitespace-regexp.  (Bug#10885)

	* isearch.el (isearch-query-replace): Let-bind
	replace-lax-whitespace instead of let-binding
	replace-search-function and replace-re-search-function.
	(isearch-lazy-highlight-search): Let-bind isearch-lax-whitespace
	and isearch-regexp-lax-whitespace to lazy-highlight variables.
	(isearch-toggle-symbol): Set isearch-regexp to nil
	in isearch-word mode (like in isearch-toggle-word).

2012-09-06  Juri Linkov  <juri@jurta.org>

	* replace.el (replace-search-function)
	(replace-re-search-function): Set default values to nil.
	(perform-replace): Let-bind isearch-related variables based on
	replace-related values, call `isearch-search-fun' and let-bind
	the result to `search-function'.  Remove code that sets
	`search-function' and `search-string' separately for
	`delimited-flag'.
	(replace-highlight): Add new argument `delimited-flag' and
	rename other arguments to the names used in `perform-replace'.
	Let-bind `isearch-word' to the argument `delimited-flag'.
	(Bug#10885, bug#10887)

2012-09-07  Dmitry Gutov  <dgutov@yandex.ru>

	* progmodes/ruby-mode.el (ruby-indent-beg-re): Add pieces from
	ruby-beginning-of-indent, simplify, allow all keywords to have
	indentation before them.
	(ruby-beginning-of-indent): Adjust for above.  Search until the
	found point is not inside a string or comment.
	(ruby-font-lock-keywords): Allow symbols to start with "@"
	character, give them higher priority than variables.
	(ruby-syntax-propertize-function)
	(ruby-font-lock-syntactic-keywords): Remove the "not comments"
	matchers.  Expression expansions are not comments when inside a
	string, and there comment syntax status is irrelevant.
	(ruby-match-expression-expansion): New function.  Check that
	expression expansion is inside a string, and it's not escaped.
	(ruby-font-lock-keywords): Use it.

2012-09-05  Martin Rudalics  <rudalics@gmx.at>

	* help.el (temp-buffer-max-height): New default value.
	(temp-buffer-resize-frames): New option.
	(resize-temp-buffer-window): Optionally resize frame.

	* window.el (fit-frame-to-buffer-bottom-margin): New option.
	(fit-frame-to-buffer): New function.

2012-09-05  Glenn Morris  <rgm@gnu.org>

	* emulation/cua-rect.el (cua--init-rectangles):
	* textmodes/picture.el (picture-mode-map):
	* play/blackbox.el (blackbox-mode-map): Remap right-char and left-char
	like forward-char and backward-char.  (Bug#12317)

2012-09-05  Leo Liu  <sdl.web@gmail.com>

	* progmodes/flymake.el (flymake-warning-re): New variable.
	(flymake-parse-line): Use it.

2012-09-05  Glenn Morris  <rgm@gnu.org>

	* calendar/holidays.el (holiday-christian-holidays):
	Rename an entry.  (Bug#12289)

2012-09-05  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/sh-script.el (sh-font-lock-paren): Don't burp at BOB
	(bug#12222).

2012-09-04  Stefan Monnier  <monnier@iro.umontreal.ca>

	* loadup.el: Load macroexp.  Remove hack.
	* emacs-lisp/macroexp.el (macroexp--eval-if-compile): New function.
	(macroexp--expand-all): Use it to get better warnings.
	(macroexp--backtrace, macroexp--trim-backtrace-frame)
	(internal-macroexpand-for-load): New functions.
	(macroexp--pending-eager-loads): New var.
	(emacs-startup-hook): New hack to replace one in loadup.el.
	* emacs-lisp/cl-macs.el (cl--compiler-macro-list*)
	(cl--compiler-macro-cXXr): Move to top, before they can be used.
	(cl-psetf): Simplify.
	(cl-defstruct): Add indent rule.

2012-09-04  Lars Ingebrigtsen  <larsi@gnus.org>

	* mail/smtpmail.el (smtpmail-send-it): Prefer the From: header
	over `user-mail-address' for the SMTP MAIL FROM envelope.
	(smtpmail-via-smtp): Ditto.

2012-09-04  Dmitry Gutov  <dgutov@yandex.ru>

	* progmodes/ruby-mode.el: Clean up keybindings.
	(ruby-mode-map): Don't bind ruby-electric-brace,
	ruby-beginning-of-defun, ruby-end-of-defun, ruby-mark-defun,
	backward-kill-word, reindent-then-newline-and-indent.
	(ruby-mark-defun): Remove.
	(ruby-electric-brace): Remove.  Obsoleted by electric-indent-chars.
	(ruby-mode): Set local beginning-of-defun-function and
	end-of-defun-function values.

2012-09-03  Martin Rudalics  <rudalics@gmx.at>

	* window.el (temp-buffer-window-setup-hook)
	(temp-buffer-window-show-hook): New hooks.
	(temp-buffer-window-setup, temp-buffer-window-show)
	(with-temp-buffer-window): New functions.
	(fit-window-to-buffer): Remove unused optional argument OVERRIDE.
	(special-display-popup-frame): Make sure the window used shows BUFFER.

	* help.el (temp-buffer-resize-mode): Fix doc-string.
	(resize-temp-buffer-window): New optional argument WINDOW.

	* files.el (recover-file, save-buffers-kill-emacs):
	* dired.el (dired-mark-pop-up): Use with-temp-buffer-window.

2012-09-02  Michael Albinus  <michael.albinus@gmx.de>

	* eshell/em-unix.el (eshell/sudo): When we have an ad-hoc
	remote definition of `default-directory', ensure we can connect.

2012-09-02  Juri Linkov  <juri@jurta.org>

	Toggle whitespace matching mode with M-s SPC.
	https://lists.gnu.org/r/emacs-devel/2012-09/msg00008.html

	* isearch.el (search-whitespace-regexp): Doc fix.
	Remove cons cell customization.
	(isearch-mode-map): Bind "\M-s " to isearch-toggle-lax-whitespace.
	(isearch-lax-whitespace, isearch-regexp-lax-whitespace):
	New variables.
	(isearch-forward, isearch-forward-regexp): Doc fix.
	(isearch-toggle-lax-whitespace): New command.
	(search-forward-lax-whitespace, search-backward-lax-whitespace)
	(re-search-forward-lax-whitespace)
	(re-search-backward-lax-whitespace): New functions.
	(isearch-whitespace-regexp): Remove function.
	(isearch-query-replace): Let-bind replace-search-function and
	replace-re-search-function.
	(isearch-occur): Let-bind search-spaces-regexp according to the
	value of isearch-lax-whitespace and isearch-regexp-lax-whitespace.
	(isearch-quote-char): Check isearch-regexp-lax-whitespace in the
	condition for C-q SPC.
	(isearch-search-fun-default): Use new functions mentioned above.
	(isearch-search-forward, isearch-search-backward): Remove functions.
	(isearch-search): Don't let-bind search-spaces-regexp.
	(isearch-lazy-highlight-space-regexp): Remove variable.
	(isearch-lazy-highlight-lax-whitespace)
	(isearch-lazy-highlight-regexp-lax-whitespace): New variables.
	(isearch-lazy-highlight-new-loop): Use them.
	(isearch-lazy-highlight-search): Don't let-bind search-spaces-regexp.

2012-09-02  Chong Yidong  <cyd@gnu.org>

	* dired.el (dired-mode-map): Menu string fixes (Bug#11616).

2012-09-02  Glenn Morris  <rgm@gnu.org>

	* simple.el (undo): Tweak message in undo-only case.  (Bug#12283)

2012-09-01  Glenn Morris  <rgm@gnu.org>

	* term.el: Tidy up menu definitions.
	(term-mode-map): Use easymenu for In/Out, Complete menus.
	(term-pager-break-map): Initialize in the defvar.
	(term-terminal-menu, term-signals-menu): Define with easymenu.
	(term-terminal-menu): Also show it in line-mode.  (Bug#11957)
	(term-pager-menu): New, extracted from term-process-pager.
	(term-mode, term-char-mode, term-process-pager): Use easymenu-add.
	(term-update-mode-line): Propertize line/char and page items.
	(term-process-pager): Move keymap initialization elsewhere.

2012-09-01  Martin Rudalics  <rudalics@gmx.at>

	* window.el (switch-to-prev-buffer): Handle additional values of
	BURY-OR-KILL argument.  Don't switch in minibuffer window.
	(switch-to-next-buffer): Don't switch in minibuffer window.
	(quit-restore-window): New function based on quit-window.
	Handle additional values of former KILL argument.
	(quit-window): Call quit-restore-window with appropriate
	interpretation of KILL argument.
	(display-buffer-below-selected): New buffer display action
	function.

2012-09-01  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuffer.el (completion-at-point-functions): Complete docstring
	(bug#12254).

2012-09-01  Paul Eggert  <eggert@cs.ucla.edu>

	Better seed support for (random).
	* play/5x5.el, play/animate.el, play/cookie1.el, play/dissociate.el:
	* play/doctor.el, play/dunnet.el, play/gomoku.el, play/landmark.el:
	* play/mpuz.el, play/tetris.el, play/zone.el:
	* calc/calc-comb.el (math-init-random-base):
	* play/blackbox.el (bb-init-board):
	* play/life.el (life):
	* server.el (server-use-tcp):
	* type-break.el (type-break):
	Remove unnecessary call to (random t).
	* net/sasl.el (sasl-unique-id-function):
	Change (random t) to (random), now that the latter is more random.
	* play/life.el (life-initialized): Remove no-longer-needed var.

2012-08-31  Alp Aker  <alp.tekin.aker@gmail.com>

	* window.el (switch-to-prev-buffer, switch-to-next-buffer):
	Consider frame's buffer predicate when choosing the buffer.
	(Bug#12081)

2012-08-30  Richard Stallman  <rms@gnu.org>

	* simple.el (special-mode-map): Delete binding for `z'.

2012-08-30  Andreas Schwab  <schwab@linux-m68k.org>

	* progmodes/compile.el (compilation-always-kill): Doc fix.

2012-08-30  Chong Yidong  <cyd@gnu.org>

	* window.el (display-buffer-reuse-frames): Make the obsolescence
	message more informative.

2012-08-30  Glenn Morris  <rgm@gnu.org>

	* paren.el (show-paren-delay):
	Add a :set function.  Doc fix.  (Bug#12297)

2012-08-29  Martin Blais  <blais@furius.ca>  (tiny change)

	* progmodes/compile.el (compilation-always-kill): New var.
	(compilation-start): Use it.

2012-08-29  Stefan Monnier  <monnier@iro.umontreal.ca>

	* simple.el (read-only-mode): Move from files.el for bootstrapping.
	* files.el (read-only-mode): Move to simple.el.

	* files.el (read-only-mode): New minor mode.
	(toggle-read-only): Use it and mark obsolete.
	(find-file--read-only):
	* vc/vc.el (vc-next-action, vc-checkout):
	* vc/vc-cvs.el (vc-cvs-checkout):
	* obsolete/vc-mcvs.el (vc-mcvs-update):
	* ffap.el (ffap--toggle-read-only): Update callers.

2012-08-29  Michael Albinus  <michael.albinus@gmx.de>

	* eshell/esh-ext.el (eshell-external-command): Do not examine
	remote shell scripts.
	See <https://bugs.launchpad.net/ubuntu/+source/emacs23/+bug/1035790>.

	* net/tramp-sh.el (tramp-remote-path): Add "/sbin" and
	"/usr/local/sbin".

2012-08-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/cl-lib.el (buffer-string): Fix setter macro (bug#12293).

2012-08-28  Leo Liu  <sdl.web@gmail.com>

	* progmodes/sh-script.el (sh-dynamic-complete-functions): Adapt to
	completion-at-point.  (Bug#12220)

	* skeleton.el (skeleton-untabify): Change to nil (bug#12223).

	* progmodes/sh-script.el (sh-indent-comment): Change to t (bug#12267).

2012-08-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* files.el (safe-local-eval-forms): Fix before-save-hook entry to
	be buffer-local; add delete-trailing-whitespace (bug#12259).

2012-08-28  Jeremy Moore  <jmoore@ieee.org>  (tiny change)

	* progmodes/hideif.el (hif-compress-define-list):
	Fix typo.  (Bug#11951)

2012-08-28  Dan Nicolaescu  <dann@gnu.org>

	* progmodes/hideshow.el (hs-block-end-regexp): Restore lost
	buffer local setting.

	* net/rcirc.el (rcirc-split-message): Fix for buffer-local
	rcirc-encode-coding-system.

2012-08-28  Leo Liu  <sdl.web@gmail.com>

	* net/rcirc.el (rcirc-split-message): New function.
	(rcirc-send-message): Use it.  (Bug#12051)

2012-08-28  Juri Linkov  <juri@jurta.org>

	* info.el (Info-fontify-node): Hide empty lines at the end of
	the node.  (Bug#12272)

2012-08-27  Drew Adams  <drew.adams@oracle.com>

	* dired.el (dired-pop-to-buffer): Make window start at beginning
	of buffer (Bug#12281).

2012-08-26  Chong Yidong  <cyd@gnu.org>

	* window.el (special-display-regexps, special-display-frame-alist)
	(special-display-buffer-names, special-display-function)
	(display-buffer-reuse-frames): Mark as obsolete.

	* progmodes/compile.el: Don't use display-buffer-reuse-frames.

	* help.el (help-print-return-message): Don't treat
	display-buffer-reuse-frames specially.

2012-08-26  Chong Yidong  <cyd@gnu.org>

	* progmodes/gdb-mi.el (gdb-display-buffer-other-frame-action):
	New variable, replacing gdb-frame-parameters.
	(gdb-frame-io-buffer, gdb-frame-breakpoints-buffer)
	(gdb-frame-threads-buffer, gdb-frame-memory-buffer)
	(gdb-frame-disassembly-buffer, gdb-frame-stack-buffer)
	(gdb-frame-locals-buffer, gdb-frame-registers-buffer): Use it.
	(def-gdb-frame-for-buffer): Macro deleted.  It is easier to define
	the functions directly with gdb-display-buffer-other-frame-action.
	(gdb-display-breakpoints-buffer, gdb-display-threads-buffer)
	(gdb-display-memory-buffer, gdb-display-disassembly-buffer)
	(gdb-display-stack-buffer, gdb-display-locals-buffer)
	(gdb-display-registers-buffer): Define directly.
	(def-gdb-display-buffer): Macro deleted.
	(gdb-display-buffer): Remove second and third args, callers don't
	use them.  Defer to the default display-buffer behavior, apart
	from making windows dedicated.
	(gdb-setup-windows): Don't call display-buffer unnecessarily.

	* progmodes/gud.el (gud-display-line): Just use display-buffer.

	* window.el (display-buffer-pop-up-frame): Handle a
	pop-up-frame-parameters alist entry.
	(display-buffer): Document it.

2012-08-26  Chong Yidong  <cyd@gnu.org>

	* isearch.el (search-whitespace-regexp): Make string and nil
	values apply to both ordinary and regexp search.  Allow a cons
	cell value to distinguish between the two.
	(isearch-whitespace-regexp, isearch-search-forward)
	(isearch-search-backward): New functions.
	(isearch-occur, isearch-search-fun-default, isearch-search)
	(isearch-lazy-highlight-new-loop): Use them.
	(isearch-forward, isearch-forward-regexp): Doc fix.

2012-08-26  Chong Yidong  <cyd@gnu.org>

	* faces.el (help-argument-name): Always inherit from italic
	(Bug#12213).

2012-08-25  Martin Rudalics  <rudalics@gmx.at>

	* window.el (window--even-window-heights): Even heights when
	WINDOW and the selected window form a vertical combination.
	(display-buffer-use-some-window): Provide that window used gets
	sized back by quit-window.  (Bug#11880) and (Bug#12091)

2012-08-24  Paul Eggert  <eggert@cs.ucla.edu>

	Fix file time stamp problem with bzr and CVS (Bug#12001).
	* vc/vc-cvs.el (vc-cvs-parse-entry): Ignore subsecond information
	in the file's time stamp, since the version control system loses
	that information.

2012-08-22  Juri Linkov  <juri@jurta.org>

	* info.el (Info-fontify-node): Hide the suffix of the
	Info file name in the header line.  (Bug#12187)

2012-08-22  Glenn Morris  <rgm@gnu.org>

	* calendar/cal-tex.el (cal-tex-weekly-common):
	Restore leading blank page.

2012-08-22  Le Wang  <l26wang@gmail.com>

	* misc.el (forward-to-word, backward-to-word): Activate or extend
	the region under `shift-select-mode'.  (Bug#12231)

2012-08-22  Bastien Guerry  <bzg@gnu.org>

	* progmodes/executable.el (executable-prefix): Set to "#!" instead
	of "#! ".  http://www.in-ulm.de/~mascheck/various/shebang/#details
	gives details on why the space is never needed.

2012-08-22  Martin Rudalics  <rudalics@gmx.at>

	* window.el (walk-window-tree, window-with-parameter):
	New optional argument MINIBUF to control whether these functions
	should run on the minibuffer window.
	(window-at-side-list): Don't operate on minibuffer window.
	(window-in-direction): Simplify and rewrite doc-string.
	(window--size-ignore): Rename to window--size-ignore-p.
	Update callers.
	(display-buffer-in-atom-window, window--major-non-side-window)
	(window--major-side-window, display-buffer-in-major-side-window)
	(delete-side-window, display-buffer-in-side-window):
	New functions.
	(window--side-check, window-deletable-p, delete-window)
	(delete-other-windows, split-window): Handle side windows and
	atomic windows appropriately.
	(window--display-buffer): Call display-buffer-record-window also
	when the window buffer did not change.

2012-08-22  Christopher Schmidt  <christopher@ch.ristopher.com>

	* help-fns.el (help-fns--key-bindings):
	Abbreviate non-symbol remap targets.  (Bug#12174)

2012-08-22  Martin Rudalics  <rudalics@gmx.at>

	* dired.el (dired-mark-remembered): Don't clobber point.
	(Bug#11795)

2012-08-22  Glenn Morris  <rgm@gnu.org>

	* progmodes/bug-reference.el (bug-reference): New custom group.
	(bug-reference-bug-regexp): Make it a defcustom.

2012-08-22  Daiki Ueno  <ueno@unixuser.org>

	* progmodes/js.el (js-indent-level, js-expr-indent-offset)
	(js-paren-indent-offset, js-square-indent-offset)
	(js-curly-indent-offset): Add :safe (Bug#12257).

2012-08-22  Theresa O'Connor  <hober0@gmail.com>

	* json.el (json-key-format): Add error properties.
	(json-encode-key): New function.
	(json-encode-hash-table, json-encode-alist, json-encode-plist):
	Use json-encode-key.

2012-08-22  Glenn Morris  <rgm@gnu.org>

	* calendar/cal-tex.el (cal-tex-longday): New function, replacing...
	(cal-tex-leftday, cal-tex-rightday): Remove functions.
	(cal-tex-weekly-common, cal-tex-cursor-filofax-2week):
	Update for above change.

2012-08-21  Andreas Schwab  <schwab@linux-m68k.org>

	* cus-face.el (custom-face-attributes): Fix customize type for the
	:underline attribute.  (Bug#11805)

2012-08-21  Martin Rudalics  <rudalics@gmx.at>

	* window.el (window-point-1, set-window-point-1): Remove.
	(window-in-direction, record-window-buffer)
	(set-window-buffer-start-and-point, split-window-below)
	(window--state-get-1, display-buffer-record-window):
	Replace calls to window-point-1 and set-window-point-1 by calls to
	window-point and set-window-point respectively.

2012-08-21  Glenn Morris  <rgm@gnu.org>

	* calendar/cal-tex.el (cal-tex-weekly-common): New function.
	(cal-tex-cursor-week-at-a-glance, cal-tex-cursor-filofax-week):
	Use it.

	* calendar/cal-tex.el (cal-tex-rightday): Add optional funcname arg.
	(cal-tex-shortday): New function.
	(cal-tex-cursor-week-at-a-glance, cal-tex-cursor-filofax-week)
	(cal-tex-cursor-filofax-daily): Use the above.

	* calendar/cal-tex.el (cal-tex-leftday, cal-tex-rightday):
	New functions.
	(cal-tex-cursor-week-at-a-glance, cal-tex-cursor-filofax-2week)
	(cal-tex-cursor-filofax-week): Use them.

	* calendar/cal-tex.el (cal-tex-lefthead, cal-tex-righthead):
	New constants.
	(cal-tex-cursor-week-at-a-glance, cal-tex-cursor-filofax-2week)
	(cal-tex-cursor-filofax-week, cal-tex-cursor-filofax-daily): Use them.

	* calendar/cal-tex.el (cal-tex-preamble): Generate new buffers.
	(cal-tex-end-document): Don't rely on buffer name.

	* calendar/cal-tex.el (cal-tex-cursor-filofax-year):
	Use cal-tex-vspace.
	(cal-tex-vspace, cal-tex-hspace, cal-tex-em, cal-tex-bf)
	(cal-tex-Huge-bf, cal-tex-large-bf): Use cal-tex-cmd.
	(cal-tex-scriptsize, cal-tex-huge, cal-tex-Huge, cal-tex-large):
	Use cal-tex-arg.

	* calendar/cal-tex.el (cal-tex-cursor-filofax-year)
	(cal-tex-cursor-week, cal-tex-cursor-week2)
	(cal-tex-cursor-week-iso, cal-tex-cursor-week-at-a-glance)
	(cal-tex-cursor-filofax-2week, cal-tex-cursor-filofax-week)
	(cal-tex-cursor-filofax-daily, cal-tex-cursor-day)
	(cal-tex-insert-preamble, cal-tex-b-document)
	(cal-tex-e-document, cal-tex-b-center, cal-tex-e-center):
	Improve cal-tex-cmd usage.

	* calendar/cal-tex.el (cal-tex-filofax-paper): New function.
	(cal-tex-cursor-filofax-year, cal-tex-cursor-filofax-2week)
	(cal-tex-cursor-filofax-week, cal-tex-cursor-filofax-daily): Use it.
	(cal-tex-weekly-paper): New function.
	(cal-tex-cursor-week, cal-tex-cursor-week2)
	(cal-tex-cursor-week-iso, cal-tex-cursor-week-monday)
	(cal-tex-cursor-day): Use it.

	* calendar/cal-tex.el (cal-tex-cursor-week-at-a-glance)
	(cal-tex-cursor-filofax-week): Remove leading blank page.

	* calendar/cal-tex.el (cal-tex-cursor-week-at-a-glance):
	Add autoload cookie.  For now at least, don't use color, since
	no other cal-tex function does.

	* calendar/cal-tex.el (cal-tex-cursor-week-iso)
	(cal-tex-cursor-filofax-2week, cal-tex-cursor-filofax-week)
	(cal-tex-cursor-filofax-daily): Correct start date for diary entries.

2012-08-21  Juri Linkov  <juri@jurta.org>

	* info.el (Info-file-attributes): New variable.
	(info-insert-file-contents): Add file attributes to
	`Info-file-attributes'.  Clear the caches `Info-index-nodes' and
	`Info-toc-nodes' when previous modtime of the Info file is less
	than new modtime.
	(Info-toc-nodes, Info-index-nodes): Move definitions up to the top
	of info.el.  (Bug#12230)

2012-08-20  Glenn Morris  <rgm@gnu.org>

	* calendar/diary-lib.el (diary-include-files, diary-sexp-entry):
	* calendar/holidays.el (calendar-holiday-list):
	Report errors with display-warning rather than beep'n'sleep.

2012-08-20  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-accept-process-output): Accept only output
	from PROC.  Otherwise, process filters and sentinels might be
	confused.  (Bug#12145)

2012-08-20  Chong Yidong  <cyd@gnu.org>

	* descr-text.el (describe-text-properties-1): Use overlays-in to
	report on empty overlays (Bug#3322).

2012-08-20  Glenn Morris  <rgm@gnu.org>

	* mail/rmailout.el (rmail-output-read-file-name):
	Trap and report errors in rmail-output-file-alist elements.

	* font-lock.el (font-lock-add-keywords): Doc fix (quote face names
	since most non-font-lock faces are not also variables).

2012-08-20  Edward Reingold  <reingold@iit.edu>

	* calendar/cal-tex.el (cal-tex-cursor-week-at-a-glance):
	New function.  (Bug12160)

2012-08-19  Glenn Morris  <rgm@gnu.org>

	* mail/rmailout.el (rmail-output-read-file-name):
	Fix previous change (when the alist is nil or does not match).

2012-08-19  Chong Yidong  <cyd@gnu.org>

	* xml.el (xml-escape-string): Don't refer to xml-entity-alist
	(Bug#12228).

2012-08-18  Chong Yidong  <cyd@gnu.org>

	* simple.el (yank-handled-properties): New defcustom.
	(yank-excluded-properties): Add font-lock-face and category.
	(yank): Doc fix.

	* subr.el (remove-yank-excluded-properties):
	Obey yank-handled-properties.  The special handling of font-lock-face
	and category is now done this way, instead of being hard-coded.
	(insert-for-yank-1): Remove font-lock-face handling.
	(yank-handle-font-lock-face-property)
	(yank-handle-category-property): New function.

2012-08-17  Glenn Morris  <rgm@gnu.org>

	* mail/rmailout.el (rmail-output-read-file-name):
	Check rmail-output-file-alist against the full message body
	in the correct rmail buffer.  (Bug#12214)

2012-08-17  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-sh.el (tramp-sh-handle-start-file-process):
	Eliminate superfluous prompt.  (Bug#12203)

2012-08-17  Chong Yidong  <cyd@gnu.org>

	* mouse.el (mouse-appearance-menu): If x-select-font returns a
	font spec, set the font directly (Bug#3228).

2012-08-17  Martin Rudalics  <rudalics@gmx.at>

	* window.el (delete-window): Fix last fix.

2012-08-16  Martin Rudalics  <rudalics@gmx.at>

	* window.el (window-valid-p): Move to window.c.
	(window-child, window-child-count, window-last-child)
	(window-normalize-window, window-combined-p)
	(window-combinations, window-atom-root, window-min-size)
	(window-sizable, window-sizable-p, window-size-fixed-p)
	(window-min-delta, window-max-delta, window--resizable)
	(window--resizable-p, window-resizable, window-total-size)
	(window-full-height-p, window-full-width-p, window-body-size)
	(window-at-side-p, adjust-window-trailing-edge, maximize-window)
	(minimize-window, window-deletable-p, delete-window)
	(delete-other-windows, set-window-buffer-start-and-point)
	(next-buffer, previous-buffer, split-window, balance-windows-2)
	(set-window-text-height, window-buffer-height)
	(fit-window-to-buffer, shrink-window-if-larger-than-buffer)
	(truncated-partial-width-window-p): Minor code adjustments.
	In doc-strings state whether the argument window has to denote a
	live, valid or any window.

2012-08-16  Phil Sainty  <psainty@orcon.net.nz>

	* progmodes/subword.el (subword-forward-function)
	(subword-backward-function, subword-forward-regexp)
	(subword-backward-regexp): New variables.
	(subword-forward, subword-forward-internal, subword-backward-internal):
	Use new variables, eg so that different "word" definitions
	can be easily used.  (Bug#11411)

2012-08-15  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc/vc-mtn.el (vc-mtn-revision-completion-table): Handle completion
	for composite selectors.
	* vc/vc.el (vc-diff-build-argument-list-internal): Don't prevent
	operation just because we can't find a previous revision.

2012-08-15  Chong Yidong  <cyd@gnu.org>

	* frame.el (set-frame-font): Accept font objects.

2012-08-15  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/tex-mode.el (tex-insert-quote): ~ is a space (bug#12137).

2012-08-15  Wolfgang Jenkner  <wjenkner@inode.at>

	* man.el (Man-overstrike-face, Man-underline-face)
	(Man-reverse-face): Remove variables.
	(Man-overstrike, Man-underline, Man-reverse): New faces.
	(Man-fontify-manpage): Use them instead of the variables.
	(Man-cleanup-manpage): Comment change.
	(Man-ansi-color-map): New variable.
	(Man-fontify-manpage): Use it.
	Call ansi-color-apply-on-region to replace ad hoc code (bug#12147).

	Implement ANSI SGR parameters 22-27 (bug#12146).
	* ansi-color.el (ansi-colors): Doc fix.
	(ansi-color-context, ansi-color-context-region): Doc fix.
	(ansi-color--find-face): New function.
	(ansi-color-apply, ansi-color-apply-on-region): Use it.
	Rename the local variable `face' to `codes' since it is now a list of
	ansi codes.  Doc fix.
	(ansi-color-get-face): Remove.
	(ansi-color-parse-sequence): New function, derived from
	ansi-color-get-face.
	(ansi-color-apply-sequence): Use it.  Rewrite, and support ansi
	codes 22-27.

2012-08-14  Stefan Monnier  <monnier@iro.umontreal.ca>

	* subr.el (read-passwd): Allow use from a minibuffer.

2012-08-14  Eli Zaretskii  <eliz@gnu.org>

	* tooltip.el (tooltip-identifier-from-point): Don't treat tokens
	inside comments and strings as identifiers.

	* progmodes/gud.el (gud-tooltip-print-command): Quote the
	expression to evaluate.  This allows to evaluate expressions with
	embedded whitespace.
	(gud-tooltip-tips): Add a blank before the newline in the
	message-box text, for the benefit of message-box emulation on
	MS-Windows.

	* progmodes/gdb-mi.el (gdb-tooltip-print): Don't ignore error
	messages from GDB, pop them up in a tooltip to give feedback to
	user.
	(gdb-tooltip-print-1): Quote the expression to evaluate.
	This allows to evaluate expressions with embedded whitespace.
	(gdb-inferior-io--init-proc): Don't send "-inferior-tty" command
	if the TTY name is nil or empty (which happens when communicating
	with the inferior via pipes, e.g. on MS-Windows).
	(gdb-internals): If GDB sends a "&\n" empty debugging message,
	don't send that to the GUD buffer.

2012-08-14  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/bytecomp.el (byte-compile-setq-default):
	Optimize away setq-default with no args, as for setq.  (Bug#12195)

2012-08-14  Chong Yidong  <cyd@gnu.org>

	* minibuffer.el (read-file-name): Doc fix (Bug#10881).

	* emacs-lisp/regexp-opt.el (regexp-opt-charset): Doc fix
	(Bug#12085).

2012-08-14  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/bytecomp.el (byte-recompile-file): Doc fix.

2012-08-14  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-sh.el (tramp-open-shell): Cache the shell name.
	(tramp-find-shell, tramp-open-connection-setup-interactive-shell):
	Use cached shell name.

2012-08-14  Fabián Ezequiel Gallina  <fgallina@cuca>

	* progmodes/python.el (python-shell-send-string):
	(python-shell-send-setup-code): Do not use `format' with `message'.

2012-08-14  Dmitry Gutov  <dgutov@yandex.ru>

	* progmodes/ruby-mode.el: Improve percent literals (bug#6286).
	(ruby-percent-literal-beg-re): New constant.
	(ruby-syntax-general-delimiters-goto-beg): Rename to
	`ruby-syntax-enclosing-percent-literal', improve literal type check.
	(ruby-syntax-propertize-general-delimiters): Rename to
	`ruby-syntax-propertize-percent-literal', it's a shorter and more
	popular term.  Adjust comments everywhere.
	(ruby-syntax-propertize-percent-literal): Only propertize when not
	inside a simple string or comment.  When the literal is unclosed,
	leave the text after it unpropertized.
	(ruby-syntax-methods-before-regexp): New constant.
	(ruby-syntax-propertize-function): Use it to recognize regexps.
	Don't look at the text after regexp, just use the whitelist.

2012-08-14  Andreas Schwab  <schwab@linux-m68k.org>

	* emacs-lisp/bytecomp.el (byte-recompile-file): When LOAD is
	non-nil always load the compiled file if it exists.  (Bug#12197)

2012-08-14  Chong Yidong  <cyd@gnu.org>

	* hi-lock.el (hi-lock-mode): Do not unilaterally enable font lock.
	(hi-lock-set-pattern): When deciding whether to use font lock or
	overlays, look at font-lock-mode instead of font-lock-fontified
	(Bug#12168).
	(hi-lock-mode, hi-lock-line-face-buffer, hi-lock-unface-buffer)
	(hi-lock-face-buffer, hi-lock-face-phrase-buffer): Doc fix.

2012-08-14  Daiki Ueno  <ueno@unixuser.org>

	* subr.el (internal--after-with-selected-window): Fix typo
	(Bug#12193).

2012-08-14  Fabián Ezequiel Gallina  <fgallina@cuca>

	Use `completion-table-dynamic' for completion functions.
	* progmodes/python.el
	(python-shell-completion--do-completion-at-point)
	(python-shell-completion--get-completions):
	Remove functions.
	(python-shell-completion-complete-at-point): New function.
	(python-completion-complete-at-point): Use it.

2012-08-13  Jambunathan K  <kjambunathan@gmail.com>

	* vc/vc-dir.el (vc-dir-hide-state): New command (bug#12159).
	(vc-dir-hide-up-to-date): Route it to `vc-dir-hide-state'.

2012-08-13  Stefan Monnier  <monnier@iro.umontreal.ca>

	* subr.el (function-get): Refine `autoload' arg so it can also
	autoload functions for gv.el (bug#12191).
	* emacs-lisp/edebug.el (get-edebug-spec): Adjust so it only
	autoloads macros.

	* color.el (color-xyz-to-lab, color-lab-to-xyz, color-cie-de2000):
	Prefer pcase-let over destructuring-bind.
	* vc/diff-mode.el (diff-remove-trailing-whitespace): Same.
	Also, remove whitespace as we go, rather than after accumulating the
	various places.

	* subr.el (internal--before-with-selected-window)
	(internal--after-with-selected-window): Fix typo seleted->selected.
	(with-selected-window): Adjust callers.
	Reported by Dmitry Gutov <dgutov@yandex.ru>.

2012-08-13  Bastien Guerry  <bzg@gnu.org>

	* window.el (special-display-popup-frame): Minor docstring
	enhancement.  (Bug#12172)

2012-08-13  Andreas Schwab  <schwab@linux-m68k.org>

	* tar-mode.el (tar-header-data-end): Only ignore size for files of
	type 1-6.
	(tar-header-block-summarize, tar-get-descriptor): Handle pax
	extended headers.

	* files.el (hack-local-variables-filter): Remove useless eval.

2012-08-13  Martin Rudalics  <rudalics@gmx.at>

	* subr.el (with-selected-window): Fix last change.

2012-08-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* subr.el (internal--before-with-seleted-window)
	(internal--after-with-seleted-window): New functions.
	(with-selected-window): Use them, to replace dependency on
	tty-top-frame.

2012-08-12  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* progmodes/ruby-mode.el (ruby-mode-map): Remove unnecessary
	binding for `newline'.
	(ruby-move-to-block): When moving backward, stop at block opening,
	not indentation.
	* progmodes/ruby-mode.el (ruby-brace-to-do-end)
	(ruby-do-end-to-brace, ruby-toggle-block): New functions.
	* progmodes/ruby-mode.el (ruby-mode-map): Add binding for
	`ruby-toggle-block'.

2012-08-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* ibuffer.el (ibuffer-do-toggle-read-only):
	* dired.el (dired-toggle-read-only):
	* buff-menu.el (Buffer-menu-toggle-read-only):
	* bindings.el (mode-line-toggle-read-only):
	* bs.el (bs-toggle-readonly): Call toggle-read-only interactively.

2012-08-12  Andreas Schwab  <schwab@linux-m68k.org>

	* descr-text.el (describe-char): Put the overlays over the
	"displayed as" character.

2012-08-12  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-units.el (math-default-units-table): Give an
	initial value.
	(math-put-default-units): Add options to put composite units and
	unit systems in the default units table.
	(calc-convert-units): Send composite units to
	`math-put-default-units' when appropriate.

2012-08-11  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/copyright.el (copyright-update-directory): Logic fix.

	* tutorial.el (help-with-tutorial):
	* emacs-lisp/copyright.el (copyright-update-directory):
	* emacs-lisp/autoload.el (autoload-find-generated-file)
	(autoload-find-file): Disable local eval: (for insurance).

	* files.el (hack-local-variables-filter): If an eval: form is not
	known to be safe, and enable-local-variables is :safe, then ignore
	the form totally, as is done for non-eval forms.  (Bug#12155)
	This is CVE-2012-3479.

2012-08-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/rx.el (rx-constituents): Don't define as constant.
	(rx-form): Simplify.

2012-08-09  Dmitry Gutov  <dgutov@yandex.ru>

	* progmodes/ruby-mode.el (ruby-expr-beg, ruby-parse-partial):
	?, _, and : are symbol constituents, ! is not (but kinda should be).
	(ruby-syntax-propertize-heredoc): Use ruby-singleton-class-p.
	(ruby-syntax-propertize-function): Adjust for changes in
	`ruby-syntax-propertize-heredoc'.

2012-08-09  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* progmodes/ruby-mode.el (ruby-mode-map): Remove deprecated
	binding (use `M-;' instead).
	(ruby-singleton-class-p): New function.
	(ruby-expr-beg, ruby-in-here-doc-p) Use it.

2012-08-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/cl-macs.el (cl-loop): Improve debug spec.

2012-08-10  Chong Yidong  <cyd@gnu.org>

	* progmodes/python.el (python-shell-get-process-name): Don't mess
	with same-window-buffer-names.

	* eshell/eshell.el (eshell-add-to-window-buffer-names)
	(eshell-remove-from-window-buffer-names): Make obsolete.
	(eshell-buffer-name, eshell-unload-hook): Don't use them.
	(eshell): Just use pop-to-buffer-same-window instead.

2012-08-10  Chong Yidong  <cyd@gnu.org>

	* bindings.el: Bind M-= back to count-words-region.

	* simple.el (count-words-region): Accept a prefix arg for acting
	on the entire buffer.
	(count-words--buffer-message): New helper function.

2012-08-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* term/x-win.el (x-menu-bar-open): Always pass last-nonmenu-event.
	* subr.el (eventp): `nil' is not an event, and eventp is not hot.
	(event-start, event-end): Use posn-at-point to return a more
	informative posn.
	(posnp): New function.
	* mouse.el (popup-menu-normalize-position): Use it.

2012-08-10  Masatake YAMATO  <yamato@redhat.com>

	* mouse.el (popup-menu-normalize-position): New function.
	(popup-menu): Use `popup-menu-normalize-position' to normalize
	the form for POSITION argument.

	* term/x-win.el (x-menu-bar-open):
	Use the value returend from (posn-at-point) as position
	passed to `popup-menu'.

2012-08-09  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calccomp.el (math-compose-expr): Add extra argument
	indicating that parentheses should be put around products in
	denominators.  Give multiplication precedence over division during
	composition.

2012-08-09  Chong Yidong  <cyd@gnu.org>

	* man.el (Man-switches, Man-sed-command, Man-awk-command)
	(Man-mode-hook, Man-cooked-hook, Man-untabify-command-args)
	(Man-untabify-command, manual-program): Convert to defcustom
	(Bug#10429).

	* vc/add-log.el (change-log-mode): Bind comment-start to nil.

	* descr-text.el (describe-char): Don't insert extra newlines
	(Bug#10127).

	* vc/log-view.el (log-view-diff): Use use-region-p (Bug#10133).
	(log-view-diff-changeset, log-view-minor-wrap): Likewise.

	* align.el (align-region): Delete temporary markers (Bug#10047).
	Plus some code cleanups.

2012-08-09  Fabián Ezequiel Gallina  <fgallina@cuca>

	* progmodes/python.el (python-pdbtrack-tracked-buffer)
	(python-pdbtrack-buffers-to-kill, python-shell-internal-buffer)
	(python-shell-internal-last-output): Use make-local-variable
	instead of make-variable-buffer-local.

2012-08-09  Fabián Ezequiel Gallina  <fgallina@cuca>

	* progmodes/python.el: Enhancements to forward-sexp.
	(python-nav-forward-sexp): Rename from
	python-nav-forward-sexp-function.
	(python-nav--forward-sexp, python-nav--backward-sexp):
	New functions.

2012-08-09  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-menu.el (calc-modes-menu): Add entries for matrix
	modes and simplification modes.

2012-08-09  Stefan Monnier  <monnier@iro.umontreal.ca>

	* delsel.el (delete-selection-pre-hook): Don't propagate the
	file-supersession signals (bug#12161).

2012-08-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/cl.el (cl-map-keymap-recursively, cl-map-intervals)
	(cl-map-extents): Add compatibility aliases (bug#12135).

2012-08-08  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-sh.el (tramp-find-file-exists-command): Protect the
	tests by `ignore-error'.
	(tramp-find-shell): Open also a new shell, when cache is already
	set.  Reported by Carsten Bormann <cabo@tzi.org>.  (Bug#12148)

2012-08-08  Juri Linkov  <juri@jurta.org>

	* bookmark.el: Add `defaults' property to the bookmark record.
	(bookmark-current-buffer): Doc fix.
	(bookmark-make-record): Add `defaults' property with default values
	to the bookmark record.
	(bookmark-minibuffer-read-name-map): Remove key binding "\C-u"
	with `bookmark-insert-current-bookmark'.
	(bookmark-set): Get `defaults' property from the bookmark record
	and use it in `read-from-minibuffer'.
	(bookmark-insert-current-bookmark): Remove function.

	* info.el (Info-bookmark-make-record): Add `defaults' property
	with values of canonical Info node name, the current Info file
	name and the current Info node name.  (Bug#12107)

2012-08-08  Juri Linkov  <juri@jurta.org>

	* files.el (basic-save-buffer): Use `buffer-name' as the default
	of `read-file-name' when buffer is not visiting a file (bug#12128).

2012-08-08  Juri Linkov  <juri@jurta.org>

	* info.el (Info-isearch-search): Doc fix.
	(Info-search): Change search-failed message from "initial node" to
	"end of node" (bug#12078).
	(Info-isearch-search): Change `isearch-string-state' to
	`isearch--state-string'.

2012-08-08  Glenn Morris  <rgm@gnu.org>

	* language/persian.el: Remove file.
	* language/misc-lang.el: Move unique part of persian.el here.
	* loadup.el: Remove language/persian.

2012-08-08  Óscar Fuentes  <ofv@wanadoo.es>

	* vc/diff-mode.el (diff-remove-trailing-whitespace): New function.

2012-08-08  Fabián Ezequiel Gallina  <fgallina@cuca>

	* progmodes/python.el: Fix defsubst warning.
	(python-syntax-context) Rename from python-info-ppss-context.
	(python-syntax-context-type): Rename from
	python-info-ppss-context-type.
	(python-syntax-comment-or-string-p): Rename from
	python-info-ppss-comment-or-string-p.

2012-08-08  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-misc.el (calc-record-why): Don't record a message twice.

2012-08-07  Andreas Schwab  <schwab@linux-m68k.org>

	* emacs-lisp/lisp-mode.el (eval-defun-1): Handle standard value of
	a defcustom that is quoted with backquote.

	* calc/calc-prog.el (math-do-defmath): Use backquote forms.
	Fix handling of interactive spec when the body uses return.
	(math-do-arg-check, math-define-function-body): Use backquote forms.
	* calc/calc-ext.el (math-defcache): Likewise.
	* calc/calc-rewr.el (math-rwfail, math-rweval): Likewise.
	* allout.el (allout-new-exposure): Likewise.
	* calc/calcalg2.el (math-tracing-integral): Likewise.
	* info.el (Info-last-menu-item): Likewise.
	* emulation/vip.el (vip-loop): Likewise.
	* textmodes/artist.el (artist-funcall): Likewise.
	* menu-bar.el (menu-bar-make-mm-toggle, menu-bar-make-toggle):
	Construct menu-item directly.

	* progmodes/autoconf.el (font-lock-syntactic-keywords):
	Don't declare.

2012-08-07  Chong Yidong  <cyd@gnu.org>

	* simple.el (deactivate-mark): Preserve text properties when
	saving the primary selection (Bug#8384).

2012-08-07  Kevin Ryde  <user42@zip.com.au>

	* woman.el (woman0-if): Quietly treat ".if v" as false (Bug#12109).
	(woman-parse-numeric-value): On a bad .IP line, issue a warning
	and continue processing (Bug#12110).

2012-08-06  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/cperl-mode.el (cperl-mode): Yet another fix for
	syntax-propertize-function (bug#10095).

2012-08-06  Stefan Monnier  <monnier@iro.umontreal.ca>

	* help-fns.el (help-fns--key-bindings, help-fns--signature)
	(help-fns--parent-mode, help-fns--obsolete): New funs, extracted from
	describe-function-1.
	(describe-function-1): Use them.  Move compiler macro after sig.
	(help-fns--compiler-macro): Use function-get.  Assume we're already in
	standard-output.  Adjust layout to new call order.

	* emacs-lisp/cl-macs.el (cl--sm-macroexpand): Fix handling of
	re-binding a symbol that has a symbol-macro (bug#12119).

2012-08-06  Mohsen BANAN  <libre@mohsen.1.banan.byname.net>

	* language/persian.el: New file.  (Bug#11812)
	* loadup.el: Add language/persian.el.

2012-08-06  Chong Yidong  <cyd@gnu.org>

	* window.el (window--maybe-raise-frame): New function.
	(window--display-buffer): Split off from here.
	(display-buffer-reuse-window, display-buffer-pop-up-frame)
	(display-buffer-pop-up-window, display-buffer-use-some-window):
	Obey an inhibit-switch-frame action alist entry.
	(display-buffer): Update doc.

	* replace.el (occur-after-change-function): Avoid losing focus by
	using the inhibit-switch-frame display parameter (Bug#12139).

2012-08-06  Fabián Ezequiel Gallina  <fgallina@cuca>

	Make internal shell process buffer names start with space.
	* progmodes/python.el (python-shell-make-comint): Add optional
	argument INTERNAL.
	(run-python-internal): Use it.
	(python-shell-internal-get-or-create-process): Check for new
	internal buffer names.

2012-08-06  Glenn Morris  <rgm@gnu.org>

	* eshell/esh-ext.el (eshell/addpath): Use dolist and mapconcat.
	Do less getting and setting of environment variables.

2012-08-05  Chong Yidong  <cyd@gnu.org>

	* proced.el (proced): Add substitution string to docstring to
	trigger autoloading of the proced library on C-h f (Bug#1768).

	* emacs-lisp/lisp-mode.el (lisp-imenu-generic-expression):
	Don't show defvars which have no second argument (Bug#8638).

	* imenu.el (imenu-generic-expression): Move documentation here
	from imenu--generic-function.
	(imenu--generic-function): Refer to imenu-generic-expression.

2012-08-05  Vegard Øye  <vegard_oye@hotmail.com>  (tiny change)

	* emulation/viper-init.el (viper-deflocalvar): Add docstring and
	indentation declaration.
	(viper-loop): Add indentation declaration (Bug#7025).

2012-08-05  Chong Yidong  <cyd@gnu.org>

	* help-fns.el (describe-variable): Add hyperlink for
	directory-local variables files.  Improve buffer-local and
	permanent-local reporting; suggested by MON KEY (Bug#6644).

	* help-mode.el (help-dir-local-var-def): New button type.

	* files.el (kill-buffer-hook): Provide a defvar.

2012-08-05  Glenn Morris  <rgm@gnu.org>

	* eshell/esh-ext.el (eshell/addpath):
	Also update eshell-path-env.  (Bug#12013)

2012-08-05  Chong Yidong  <cyd@gnu.org>

	* wdired.el (wdired-mode, wdired-change-to-wdired-mode): Doc fixes.

	* fringe.el (fringe-styles): Add docstring.
	(fringe--check-mode): New function.
	(set-fringe-mode, set-fringe-style): Use it.
	(fringe-mode, set-fringe-style): Doc fixes (Bug#6480).

	* files.el (set-auto-mode): Fix invalid setq call.

2012-08-04  Stefan Monnier  <monnier@iro.umontreal.ca>

	* isearch.el: Misc simplification; use defstruct.
	(isearch-mode-map): Dense maps now work like sparse ones.
	(isearch--state): New defstruct.
	(isearch-string-state, isearch-message-state, isearch-point-state)
	(isearch-success-state, isearch-forward-state)
	(isearch-other-end-state, isearch-word-state, isearch-error-state)
	(isearch-wrapped-state, isearch-barrier-state)
	(isearch-case-fold-search-state, isearch-pop-fun-state):
	Remove, replaced by defstruct's accessors.
	(isearch--set-state): Rename from isearch-top-state and change
	calling convention.
	(isearch-push-state): Use new isearch--get-state.
	(isearch-toggle-word): Disable regexp when enabling word.
	(isearch-message-prefix): Remove unused arg _c-q-hack.
	(isearch-message-suffix): Remove unused arg _ellipsis.

2012-08-04  Andreas Schwab  <schwab@linux-m68k.org>

	* simple.el (list-processes--refresh): For a server use :host or
	:local as the address.
	(list-processes): Doc fix.

2012-08-04  Michal Nazarewicz  <mina86@mina86.com>

	* mpc.el: Support password in host argument.
	(mpc--proc-connect): Parse and use new password element.
	Set mpc-proc variable instead of returning process.
	(mpc-proc): Adjust accordingly.

2012-08-03  Eli Zaretskii  <eliz@gnu.org>

	* whitespace.el (whitespace-display-mappings): Use Unicode
	codepoints, instead of emacs-mule codepoints.  See
	https://lists.gnu.org/r/help-gnu-emacs/2012-07/msg00366.html
	for the details.

	* files.el (file-truename): Don't skip symlink-chasing part on
	windows-nt.  Incorporate the resolution of 8+3 short aliases on
	Windows into the loop that recursively chases symlinks.
	Compare directory and its parent case-insensitively on MS-Windows and
	MS-DOS.

2012-08-03  Chong Yidong  <cyd@gnu.org>

	* menu-bar.el (menu-bar-tools-menu): Remove PCL-CVS.

	* sort.el (sort-regexp-fields): Doc fix.

2012-08-03  Tassilo Horn  <tsdh@gnu.org>

	* textmodes/reftex.el (reftex-compile-variables): Make keyvals
	labels regex position point at the expected place.

2012-08-03  MON KEY  <monkey@sandpframing.com>

	* net/imap.el (imap-interactive-login, imap-authenticate)
	(imap-mailbox-lsub, imap-mailbox-list)
	(imap-mailbox-status-asynch, imap-mailbox-acl-delete)
	(imap-fetch, imap-message-flag-permanent-p, imap-envelope-from)
	(imap-parse-response): Doc fix.

2012-08-03  João Távora  <joaotavora@gmail.com>

	* textmodes/tex-mode.el (latex-forward-sexp): Terminate the loop
	if sexp scanning does not move point (Bug#5734).

2012-08-02  Tassilo Horn  <tsdh@gnu.org>

	* textmodes/reftex-vars.el (reftex-default-label-alist-entries):
	Add listings, minted, and ctable packages.
	(reftex-label-alist-builtin): Move listings, minted, and ctable
	entries before LaTeX.
	(reftex-label-alist): Docfix.

2012-08-02  Bastien Guerry  <bzg@gnu.org>

	* replace.el (occur): Fix docstring (bug#12122).

2012-08-02  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/authors.el (authors-renamed-files-alist): Add ms-w32.h.

2012-08-02  Paul Eggert  <eggert@cs.ucla.edu>

	Obsolete alias inactivate-current-input-method-function (Bug#10150).
	* international/mule-cmds.el: Create
	inactivate-current-input-method-function as an obsolete alias for
	deactivate-current-input-method-function.  See Katsumi Yamaoka in
	<https://bugs.gnu.org/10150#46>.

2012-08-01  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-mode.el (calc-set-simplify-mode): Use `cond' instead
	of nested `if's.

2012-08-01  Glenn Morris  <rgm@gnu.org>

	* progmodes/autoconf.el (autoconf-definition-regexp):
	Add AH_TEMPLATE, adjust submatch numbering.
	(autoconf-font-lock-keywords, autoconf-imenu-generic-expression)
	(autoconf-current-defun-function): Update for above change.
	(autoconf-current-defun-function): First skip to end of current word.

2012-08-01  Rupert Swarbrick  <rswarbrick@gmail.com>  (tiny change)

	* calendar/cal-html.el (cal-html-insert-agenda-days):
	Fix typo.  (Bug#12018)

2012-07-31  Fabián Ezequiel Gallina  <fgallina@cuca>

	Shell processes: enhancements to startup and CEDET compatibility.
	* progmodes/python.el (python-shell-send-setup-max-wait): Delete var.
	(python-shell-make-comint): accept-process-output at startup.
	(run-python-internal): Set inferior-python-mode-hook to nil.
	(python-shell-internal-get-or-create-process): Call sit-for.
	(python-preoutput-result): Add obsolete alias.
	(python-shell-internal-send-string): Use it.
	(python-shell-send-setup-code): Remove call to
	accept-process-output.

2012-07-31  Andreas Schwab  <schwab@linux-m68k.org>

	* buff-menu.el (list-buffers-noselect): Use prefix-numeric-value.
	(Bug#12108)

2012-07-31  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-mode.el (calc-basic-simplification-mode): Rename from
	`calc-limited-simplification-mode'.
	(calc-alg-simplification-mode): New function.
	(calc-set-simplify-mode): Adjust message.

	* calc/calc.el (calc-set-mode-line): Adjust mode line display for
	basic simplification mode.

	* calc/calc-help.el (calc-m-prefix-help): Update help message.

	* calc/calc-ext.el (calc-init-extensions): Add bindings and autoloads
	for `calc-basic-simplify-mode' and `calc-alg-simplify-mode'.

2012-07-31  Bastien Guerry  <bzg@gnu.org>

	* man.el (man): Fix comment.  (bug#12101)

2012-07-31  Martin Rudalics  <rudalics@gmx.at>

	* window.el (switch-to-prev-buffer, switch-to-next-buffer):
	Don't return a non-nil value when no suitable buffer was found.

2012-07-31  Fabián Ezequiel Gallina  <fgallina@cuca>

	* progmodes/python.el (run-python-internal): Disable font lock for
	internal shells.

2012-07-30  Stefan Merten  <smerten@oekonux.de>

	* textmodes/rst.el: Silence `checkdoc-ispell'.
	(rst-cvs-header, rst-svn-rev, rst-svn-timestamp)
	(rst-official-version, rst-official-cvs-rev)
	(rst-package-emacs-version-alist): Update to upstream V1.3.1.
	(rst-mode-map): New key binding.

2012-07-30  Paul Eggert  <eggert@cs.ucla.edu>

	Update .PHONY listings in makefiles.
	* Makefile.in (.PHONY): Add all, doit, custom-deps, finder-data,
	autoloads, update-subdirs, updates, bzr-update, update-authors,
	compile-onefile, compile-calc, backup-compiled-files,
	compile-after-backup, compile-one-process, mh-autoloads,
	bootstrap-clean, distclean, maintainer-clean.

2012-07-29  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc.el (calc-simplify-mode): Make 'alg the default value.
	(calc-set-mode-line): Don't display "AlgSimp ".

	* calc/calc-mode.el (calc-alg-simplify-mode): Remove function.
	(calc-lim-simplify-mode): New function.
	(calc-set-simplify-mode): Default to 'alg.
	(calc-default-simplify-mode): Make algebraic simplifications
	the default.

	* calc/calc-ext.el (calc-init-extensions): Remove binding for
	`calc-alg-simplify-mode'.  Add binding for `calc-lim-simplify-mode'.

	* calc/calc-help.el (calc-m-prefix-help): Change messages to
	indicate new simplification modes.

	* calc/README: Mention new default simplification mode.

	* calc/calc.el (math-normalize-error): New variable.
	(math-normalize): Set `math-normalize-error' to t
	when there's an error.

	* calc/calc-alg.el (math-simplify): Don't simplify when
	`math-normalize' returns an error.

2012-07-29  Eli Zaretskii  <eliz@gnu.org>

	* international/mule-cmds.el (set-locale-environment): Revert last
	change, since display-graphic-p returns nil when this function is
	called during startup.  Instead...

	* term/w32console.el (terminal-init-w32console): ...setup the
	keyboard and terminal encoding for TTY sessions here.  (Bug#12082)

2012-07-29  Juri Linkov  <juri@jurta.org>

	* simple.el (goto-line): Don't display default line number in the
	prompt because it should be displayed by `read-number' (bug#9952).
	Add the current line number to the defaults of `goto-line' to
	allow its easier modification by users with `M-n' (bug#9201).

	* subr.el (read-number): Support multiple default values like in
	other minibuffer reading functions.  Replace `read' with
	`string-to-number' for consistency with `number-to-string'.

2012-07-29  Paul Eggert  <eggert@cs.ucla.edu>

	deactive->inactive, inactivate->deactivate spelling fixes (Bug#10150)
	* emulation/viper-init.el (viper-deactivate-input-method-action):
	Rename from viper-inactivate-input-method-action.
	(viper-deactivate-input-method):
	Rename from viper-inactivate-input-method.
	* follow.el (follow-inactive-menu): Rename from follow-deactive-menu.
	* international/mule-cmds.el (deactivate-input-method):
	Rename from inactivate-input-method.
	Also run input-method-deactivate-hook.
	(deactivate-current-input-method-function):
	Rename from inactivate-current-input-method-function.
	(input-method-deactivate-hook): New hook.
	(input-method-inactivate-hook): Mark obsolete.
	(inactivate-input-method): Mark obsolete.

	* international/quail.el (quail-activate):
	Also run quail-deactivate-hook.
	(quail-deactivate): Rename from quail-inactivate.
	* international/robin.el (robin-activate):
	Also run robin-deactivate-hook.
	(robin-deactivate): Rename from robin-inactivate.

2012-07-29  Chong Yidong  <cyd@gnu.org>

	* simple.el (indicate-copied-region): New function.
	(kill-ring-save): Split off from here.

	* rect.el (copy-rectangle-as-kill): Call indicate-copied-region.
	(kill-rectangle): Set deactivate-mark to t on read-only error.

	* register.el (copy-to-register, copy-rectangle-to-register):
	Deactivate the mark, and use indicate-copied-region (Bug#10056).
	(append-to-register, prepend-to-register): Call indicate-copied-region.

2012-07-29  Juri Linkov  <juri@jurta.org>

	* simple.el (async-shell-command-buffer): New defcustom.
	(shell-command): Use it.  (Bug#4719)

2012-07-28  Eli Zaretskii  <eliz@gnu.org>

	* international/mule-cmds.el (set-locale-environment): In a
	console session on MS-Windows, set up keyboard and terminal
	encoding from the OEM codepage, not the ANSI codepage.
	(Bug#12055)

2012-07-28  Chong Yidong  <cyd@gnu.org>

	* progmodes/gdb-mi.el (gdb-place-breakpoints): Fix the call to
	gdb-get-location.

2012-07-28  Leo Liu  <sdl.web@gmail.com>

	* progmodes/cc-menus.el (cc-imenu-objc-function): Avoid leaving nil in
	the alist (bug#12029).

2012-07-28  Eli Zaretskii  <eliz@gnu.org>

	* makefile.w32-in (custom-deps, finder-data, updates, compile)
	(compile-always, compile-first)
	($(lisp)/calendar/cal-loaddefs.el)
	($(lisp)/calendar/diary-loaddefs.el)
	($(lisp)/calendar/hol-loaddefs.el, $(lisp)/mh-e/mh-loaddefs.el)
	($(lisp)/net/tramp-loaddefs.el, bootstrap)
	($(lisp)/progmodes/cc-mode.elc): Depend on $(lisp)subdirs.el,
	instead of on update-subdirs.
	(bootstrap-clean): Delete $(lisp)/subdirs.el.

2012-07-28  Chong Yidong  <cyd@gnu.org>

	* vc/vc.el (vc-root-diff, vc-print-root-log): Prompt for a
	directory if vc-deduce-backend returns nil (Bug#7350).

	* simple.el (delete-trailing-lines): New option.
	(delete-trailing-whitespace): Obey it (Bug#11879).

2012-07-28  David Engster  <deng@randomsample.de>

	* xml.el (xml-node-name, xml-parse-file, xml-parse-region):
	Explanation of new 'symbol-qnames feature in doc-strings.
	(xml-maybe-do-ns): Return expanded names as plain symbols if
	'symbol-qnames was provided in XML-NS argument (Bug#11916).
	(xml-parse-tag-1): Deal with new definition of PARSE-NS argument.

2012-07-27  Fabián Ezequiel Gallina  <fgallina@cuca>

	Consistent completion in inferior python with emacs -nw.
	* progmodes/python.el (inferior-python-mode): Replace "<tab>"
	binding in inferior-python-mode-map with "\t".
	(python-shell-completion-complete-at-point)
	(python-completion-complete-at-point): Remove interactive spec.

2012-07-27  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calccomp.el (math-compose-expr): Undo previous change.

2012-07-27  Fabián Ezequiel Gallina  <fgallina@cuca>

	* progmodes/python.el (python-mode-map): Add keybinding for
	run-python.
	(python-shell-make-comint): Fix pop-to-buffer call.
	(run-python): Autoload.  New arg SHOW.
	(python-shell-get-or-create-process): Do not pop python process
	buffer.

2012-07-27  Michael Albinus  <michael.albinus@gmx.de>

	* notifications.el (notifications-on-action-signal)
	(notifications-on-closed-signal): Use also the bus address for the map.
	(notifications-notify, notifications-close-notification)
	(notifications-get-capabilities): Add optional argument BUS.

2012-07-27  Tassilo Horn  <tsdh@gnu.org>

	* textmodes/reftex-vars.el (reftex-label-alist-builtin):
	Add support for the lstlisting and minted environments, and for the
	ctable macro.
	* textmodes/reftex.el (reftex-compile-variables): Also recognize
	labels written in keyvals syntax.

2012-07-27  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calccomp.el (math-compose-expr): Use parentheses when
	there is a product in the denominator of a fraction.

2012-07-26  Eli Zaretskii  <eliz@gnu.org>

	* makefile.w32-in ($(lisp)/calendar/cal-loaddefs.el)
	($(lisp)/calendar/diary-loaddefs.el)
	($(lisp)/calendar/hol-loaddefs.el, $(lisp)/mh-e/mh-loaddefs.el)
	($(lisp)/net/tramp-loaddefs.el): Depend on update-subdirs.
	Fixes failures in parallel bootstrap because subdirs.el is being
	rewritten while the autoload files are built at the same time,
	which needs to load subdirs.el.

2012-07-26  Martin Rudalics  <rudalics@gmx.at>

	* mouse.el (popup-menu): Fix doc-string and re-indent code.
	(mouse-drag-line): Don't exit tracking when a switch-frame or
	switch-window event occurs (Bug#12006).

2012-07-26  Stefan Monnier  <monnier@iro.umontreal.ca>

	* mouse.el (popup-menu): Fix last change.

2012-07-26  Stefan Monnier  <monnier@iro.umontreal.ca>

	Autoload from Lisp with more care.  Follow aliases when looking for
	function properties.
	* subr.el (autoloadp): New function.
	(symbol-file): Use it.
	(function-get): New function.
	* emacs-lisp/macroexp.el (macroexp--expand-all): Use function-get and
	autoload-do-load.
	* emacs-lisp/lisp-mode.el (lisp-font-lock-syntactic-face-function)
	(lisp-indent-function):
	* emacs-lisp/gv.el (gv-get):
	* emacs-lisp/edebug.el (get-edebug-spec, edebug-basic-spec):
	* emacs-lisp/byte-opt.el (byte-optimize-form):
	* emacs-lisp/bytecomp.el (byte-compile-arglist-warn):
	* emacs-lisp/autoload.el (make-autoload, autoload-print-form):
	Use function-get.
	* emacs-lisp/cl.el: Don't propagate function properties any more.

	* speedbar.el (speedbar-add-localized-speedbar-support):
	* emacs-lisp/disass.el (disassemble-internal):
	* desktop.el (desktop-load-file):
	* help-fns.el (help-function-arglist, find-lisp-object-file-name)
	(describe-function-1):
	* emacs-lisp/find-func.el (find-function-noselect):
	* emacs-lisp/elp.el (elp-instrument-function):
	* emacs-lisp/advice.el (ad-has-proper-definition):
	* apropos.el (apropos-safe-documentation, apropos-macrop):
	* emacs-lisp/debug.el (debug-on-entry):
	* emacs-lisp/cl-macs.el (cl-compiler-macroexpand):
	* emacs-lisp/byte-opt.el (byte-compile-inline-expand):
	* calc/calc.el (name): Use autoloadp & autoload-do-load.

2012-07-25  Alp Aker  <alp.tekin.aker@gmail.com>

	* international/mule-cmds.el (ucs-insert): Mark it as an obsolete
	function, not an obsolete variable (Bug#12046).

2012-07-25  Andreas Schwab  <schwab@linux-m68k.org>

	* faces.el (face-spec-reset-face): Fix last change.  (Bug#12042)

2012-07-25  Christopher Schmidt  <christopher@ch.ristopher.com>

	* emacs-lisp/pp.el (pp-display-expression): Select old selected
	window only if it is still live (Bug#12034).

2012-07-25  Martin Rudalics  <rudalics@gmx.at>

	* subr.el (redirect-frame-focus): Add advertised calling
	convention (Bug#12030).

2012-07-25  Paul Eggert  <eggert@cs.ucla.edu>

	Prefer typical American spelling for "acknowledgment".
	* vc/add-log.el (change-log-acknowledgment): Rename from
	change-log-acknowledgement, with an alias for the old name.

2012-07-25  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-alg.el (math-simplify-divide): Don't cross multiply
	in an equation when the lhs is a variable.

2012-07-24  Julien Danjou  <julien@danjou.info>

	* net/netrc.el (netrc-find-service-number, netrc-store-data):
	Remove, unused.

2012-07-23  Eli Zaretskii  <eliz@gnu.org>

	* startup.el (command-line): Don't display an empty user name in
	the error message about non-existent home directory, when
	init-file-user was set to an empty string.  See
	https://lists.gnu.org/r/bug-gnu-emacs/2012-07/msg00835.html
	for the details and context.

2012-07-22  Vincent Belaïche  <vincentb1@users.sourceforge.net>

	* ses.el (ses-cell-formula-aset): New macro.
	(ses-cell-references-aset): New macro.
	(ses-cell-p): New function.
	(ses-rename-cell): Do no longer rely on complex operations like
	ses-cell-set-formula or ses-set-cell to change the cell and handle
	the undo at the same time, but rather use lower level new macros
	`ses-cell-formula-aset' and `ses-cell-references-aset' and handle
	the undo directly.  Refresh the mode line.

2012-07-21  Leo Liu  <sdl.web@gmail.com>

	* progmodes/cc-cmds.el (c-defun-name):
	Use match-string-no-properties instead for consistency.

2012-07-20  Leo Liu  <sdl.web@gmail.com>

	* progmodes/cc-cmds.el (c-defun-name): Handle objc selectors properly.
	(Bug#7879)

	* progmodes/cc-langs.el (c-symbol-start): Include char _ (bug#11986).

2012-07-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* userlock.el, emacs-lisp/map-ynp.el: Declare part of `emacs' package.
	* progmodes/bug-reference.el, misearch.el: Provide themselves
	(bug#11915).

	* progmodes/cperl-mode.el (cperl-unwind-to-safe): Don't inf-loop at end
	of narrowed buffer (bug#11966).

2012-07-20  Vincent Belaïche  <vincentb1@users.sourceforge.net>

	* ses.el (ses-rename-cell): Set new name also in reference list of
	cells of which the renamed cell depends.

2012-07-20  Masatake YAMATO  <yamato@redhat.com>

	* term/x-win.el (x-menu-bar-open): Use `frame-parameter'
	to check whether menu-bar is shown or not.  If not shown,
	show the menu-bar as a popup menu instead of using tmm.
	* mouse.el (popup-menu): Accept `point' as `position' argument.

2012-07-20  Dmitry Gutov  <dgutov@yandex.ru>

	* progmodes/ruby-mode.el (ruby-parse-partial): No error when end
	up inside string symbol literal (bug#11923).

2012-07-20  Eli Zaretskii  <eliz@gnu.org>

	* startup.el (fancy-startup-text): Read the whole tutorial, not
	just its first 256 bytes.  Prevents gibberish in display of the
	tutorial title.

2012-07-20  Dmitry Antipov  <dmantipov@yandex.ru>

	Drop idle buffer compaction due to an absence of the
	proved efficiency.
	* compact.el: Remove.

2012-07-19  Sam Steingold  <sds@gnu.org>

	* vc/vc-dispatcher.el (vc-compilation-mode): Add, based on
	vc-bzr-pull & vc-bzr-merge-branch.
	* vc/vc-bzr.el (vc-bzr-pull, vc-bzr-merge-branch): Use it.
	(vc-bzr-error-regexp-alist): Rename from vc-bzr-error-regex-alist
	for consistency with compilation-error-regexp-alist.
	* vc/vc-git.el (vc-git-error-regexp-alist): Add.
	(vc-git-pull, vc-git-merge-branch): Call vc-compilation-mode.
	* vc/vc-hg.el (vc-hg-error-regexp-alist): Add.
	(vc-hg-pull, vc-hg-merge-branch): Call vc-compilation-mode.

2012-07-19  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/chart.el: Use lexical-binding.
	(chart-emacs-storage): Don't hardcode the list of entries.

2012-07-19  Dmitry Antipov  <dmantipov@yandex.ru>

	Next round of tweaks caused by Fgarbage_collect changes.
	* emacs-lisp/chart.el (chart-emacs-storage): Adjust again.

2012-07-19  Dmitry Antipov  <dmantipov@yandex.ru>

	Compact buffers when idle.
	* compact.el: New file.

2012-07-19  Stefan Monnier  <monnier@iro.umontreal.ca>

	* subr.el (eventp): Presume that if it looks vaguely like an event,
	it's an event (bug#10190).

2012-07-19  Fabián Ezequiel Gallina  <fgallina@cuca>

	Enhancements to ppss related code (thanks Stefan).
	* progmodes/python.el (python-indent-context)
	(python-indent-calculate-indentation, python-indent-dedent-line)
	(python-indent-electric-colon, python-nav-forward-block)
	(python-mode-abbrev-table)
	(python-info-assignment-continuation-line-p): Simplify checks
	for ppss context.
	(python-info-continuation-line-p): Cleanup.
	(python-info-ppss-context): Do not catch 'quote.
	(python-info-ppss-context-type)
	(python-info-ppss-comment-or-string-p): Simplify.

2012-07-18  Fabián Ezequiel Gallina  <fgallina@cuca>

	* progmodes/python.el: Enhancements to eldoc support.
	(python-info-current-symbol): New function.
	(python-eldoc-at-point): Use python-info-current-symbol.
	(python-info-current-defun): Fix cornercase on first defun scan.
	(python-eldoc--get-doc-at-point): Use python-info-current-symbol
	and signal error when no inferior python process is available.

2012-07-18  Dmitry Gutov  <dgutov@yandex.ru>

	* vc/vc-git.el (vc-git-state): Don't call `vc-git-registered',
	assume it's always t.
	(vc-git-registered): Remove caching, the function is only called
	once.
	(vc-git-branches): Use `vc-git--call' instead of `call-process'.

2012-07-18  Chong Yidong  <cyd@gnu.org>

	* subr.el (last-input-char, last-command-char): Remove (Bug#9195).

	* simple.el (count-words): Report on narrowing (Bug#9959).

	* bindings.el: Bind M-= to count-words.

	* faces.el (face-spec-reset-face): Handle reverse video (Bug#4238).

2012-07-18  Masatake YAMATO  <yamato@redhat.com>

	* progmodes/sh-script.el (sh-imenu-generic-expression):
	Capture a function with `function' keyword and without parentheses
	like "function FOO" (bug#11856).

2012-07-18  Tassilo Horn  <tassilo@member.fsf.org>

	* window.el (split-window-sensibly): Make WINDOW argument
	optional.

2012-07-18  Chong Yidong  <cyd@gnu.org>

	* subr.el (keyboard-translate): Doc fix (Bug#7261).

	* isearch.el (isearch-mode-map): Handle C-x 8 key translations,
	and make C-x 8 RET exit isearch (Bug#11439).

	* international/iso-transl.el: Move isearch-mode-map key
	definitions to isearch.el.

2012-07-18  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/eieio.el: Adapt further to gv.el (bug#11970).
	(eieio-defclass): Use gv-define-setter when possible.

2012-07-18  Dmitry Antipov  <dmantipov@yandex.ru>

	Reflect recent changes in Fgarbage_collect.
	* emacs-lisp/chart.el (chart-emacs-storage): Change to
	reflect new format of data returned by Fgarbage_collect.

2012-07-17  Fabián Ezequiel Gallina  <fgallina@cuca>

	New utility functions + python-info-ppss-context fix (Bug#11910).
	* progmodes/python.el (python-info-beginning-of-block-statement-p)
	(python-info-ppss-comment-or-string-p): New functions.
	(python-info-ppss-context): Small fix for string check.

2012-07-17  Juri Linkov  <juri@jurta.org>

	* dired-aux.el (dired-do-async-shell-command): Doc fix.
	(dired-do-async-shell-command): Don't add `*' at the end of the
	command (Bug#11815).
	(dired-do-shell-command): Doc fix.
	(dired-shell-stuff-it): Strip the trailing "&" and ";" if any.
	Join the individual commands using either "&" or ";" as the
	separator depending on the values of these trailing characters.
	At the end re-add the trailing "&".  (Bug#10598)

	* simple.el (async-shell-command): Sync the interactive spec with
	`shell-command'.  Doc fix.
	(shell-command): Doc fix.

2012-07-17  Juri Linkov  <juri@jurta.org>

	* descr-text.el (describe-char): Fix format args.  (Bug#10129)

2012-07-17  Fabián Ezequiel Gallina  <fgallina@cuca>

	Final renames and doc fixes for movement commands (bug#11899).
	* progmodes/python.el (python-nav-beginning-of-statement):
	Rename from python-nav-statement-start.
	(python-nav-end-of-statement): Rename from
	python-nav-statement-end.
	(python-nav-beginning-of-block): Rename from
	python-nav-block-start.
	(python-nav-end-of-block): Rename from python-nav-block-end.

2012-07-17  Fabián Ezequiel Gallina  <fgallina@cuca>

	* progmodes/python.el (python-shell-send-string-no-output):
	Allow accept-process-output to quit, keeping shell process ready for
	future interactions (Bug#11868).

2012-07-17  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/cl-macs.el (cl-progv): Use a properly prefixed var name.

	* emacs-lisp/elint.el (elint-find-args-in-code):
	Use help-function-arglist, so as to handle lexical byte-code.

	* progmodes/sh-script.el (sh-syntax-propertize-function): Fix last
	change (bug#11826).

2012-07-17  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/cc-engine.el (c-forward-sws, c-backward-sws):
	Avoid spuriously marking the buffer as modified because of c-is-sws.

	* progmodes/sh-script.el (sh-syntax-propertize-function): Mark "${#VAR"
	as not-a-comment (bug#11946).

	* emacs-lisp/macroexp.el (macroexp-let2): Use more informative names
	for uninterned vars.

	* xt-mouse.el (xterm-mouse-translate-1, xterm-mouse-event-read):
	Use read-event since we don't really want to read chars but bytes.

	* textmodes/tex-mode.el (tex-font-lock-keywords-1): Highlight not only
	$$..$$ but also $..$ using regexps (bug#11953).
	Use tex-verbatim for \url and \path.
	(tex-font-lock-keywords): Define as defconst like the others.
	(tex-common-initialization): Don't use font-lock-syntax-table any more.

2012-07-16  René Kyllingstad  <Rene@Kyllingstad.com>  (tiny change)

	* international/mule-cmds.el (ucs-insert): Make it an obsolete
	alias for insert-char.

2012-07-16  Fabián Ezequiel Gallina  <fgallina@cuca>

	* progmodes/python.el: Simplified imenu implementation.
	(python-nav-jump-to-defun): Remove command.
	(python-mode-map): Use `imenu' instead.
	(python-nav-list-defun-positions-cache)
	(python-imenu-include-defun-type, python-imenu-make-tree)
	(python-imenu-subtree-root-label, python-imenu-index-alist):
	Remove vars.
	(python-nav-list-defun-positions, python-nav-read-defun)
	(python-imenu-tree-assoc, python-imenu-make-element-tree)
	(python-imenu-make-tree, python-imenu-create-index):
	Remove functions.
	(python-mode): Update to interact with imenu by setting
	`imenu-extract-index-name-function' only.

2012-07-16  Fabián Ezequiel Gallina  <fgallina@cuca>

	* progmodes/python.el: Enhancements to navigation commands.
	(python-nav-backward-sentence)
	(python-nav-forward-sentence): Remove.
	(python-nav-backward-statement, python-nav-forward-statement)
	(python-nav-statement-start, python-nav-statement-end)
	(python-nav-backward-block, python-nav-forward-block)
	(python-nav-block-start, python-nav-block-end)
	(python-nav-forward-sexp-function)
	(python-info-current-line-comment-p)
	(python-info-current-line-empty-p): New functions.
	(python-indent-context): Use `python-nav-statement-start'.

2012-07-16  Michael Albinus  <michael.albinus@gmx.de>

	* eshell/em-ls.el (eshell/ls): Use `apply'.

	* eshell/em-unix.el (eshell/su, eshell/sudo): Apply Tramp's ad-hoc
	multi-hops, instead of Tramp internals.

	* vc/ediff.el (ediff-directories): Add trailing space to prompts.

	* vc/ediff-diff.el (ediff-same-file-contents): Handle the case,
	when F1 and F2 are located on different hosts.

2012-07-14  Chong Yidong  <cyd@gnu.org>

	* xt-mouse.el: Implement extended mouse coordinates (Bug#10642).
	(xterm-mouse-translate): Move code into xterm-mouse-translate-1.
	(xterm-mouse-translate-extended, xterm-mouse-translate-1)
	(xterm-mouse--read-event-sequence-1000)
	(xterm-mouse--read-event-sequence-1006): New functions.  For old
	mouse protocol, handle M-mouse-X events correctly.
	(xterm-mouse-event): New arg specifying mouse protocol.
	(turn-on-xterm-mouse-tracking-on-terminal)
	(turn-off-xterm-mouse-tracking-on-terminal): Send DEC 1006
	sequence to toggle extended coordinates on newer XTerms.
	This appears to be harmless on terminals which do not support this.

2012-07-14  Leo Liu  <sdl.web@gmail.com>

	Add fringe bitmap indicators for flymake.  (Bug#11253)
	* progmodes/flymake.el (flymake-highlight-line): Use fringe bitmaps.
	(flymake-make-overlay): New arg BITMAP.
	(flymake-error-bitmap, flymake-warning-bitmap)
	(flymake-fringe-indicator-position): New user variables.

	* fringe.el: New bitmap exclamation-mark.

2012-07-14  Jan Djärv  <jan.h.d@swipnet.se>

	* progmodes/cc-cmds.el (c-defun-name): Recognize Objective-C methods
	also (Bug#7879).

2012-07-14  Chong Yidong  <cyd@gnu.org>

	* electric.el (electric-pair-post-self-insert-function): Fix pair
	insertion in empty-region case (Bug#11520).

2012-07-14  Chong Yidong  <cyd@gnu.org>

	* bindings.el: Consolidate ctl-x-r-map bindings.
	Bind copy-rectangle-as-kill to C-x r w.

	* rect.el, register.el: Move bindings to bindings.el.

2012-07-14  Reuben Thomas  <rrt@sc3d.org>

	* rect.el (copy-rectangle-as-kill): New command (Bug#739).

2012-07-13  Andreas Schwab  <schwab@linux-m68k.org>

	* emacs-lisp/cl.el (labels): Remove spurious quote.  (Bug#11938)

2012-07-13  Juanma Barranquero  <lekktu@gmail.com>

	* bindings.el (top): Use `mapc' instead of `mapcar'.

	* loadup.el (top): Remove bogus `if' choice (brought by 2008-06-21T01:38:39Z!monnier@iro.umontreal.ca).

2012-07-13  Michael Albinus  <michael.albinus@gmx.de>

	* progmodes/sql.el (sql-comint): Suppress the check for program on
	remote hosts.  Reported by Francis Devereux <francis@devrx.org>.
	(Bug#11908)

2012-07-13  Chong Yidong  <cyd@gnu.org>

	* bindings.el: Assign a non-nil permanent-local property to
	per-buffer variables which lack a default value (Bug#11930).

	* help-fns.el (describe-variable): In the "automatically becomes
	local" notice, take note of permanent-local variables.

2012-07-13  Chong Yidong  <cyd@gnu.org>

	* files.el (toggle-read-only): Doc fix and code cleanup.  New arg
	to allow printing the message when called from Lisp.

	* emacs-lisp/bytecomp.el (byte-compile-interactive-only-functions):
	Remove toggle-read-only.

	* bs.el (bs-toggle-readonly):
	* buff-menu.el (Buffer-menu-toggle-read-only):
	Remove with-no-warnings around toggle-read-only.

	* ffap.el (ffap--toggle-read-only): Accept a list of buffers.
	Remove with-no-warnings around toggle-read-only.
	(ffap-read-only, ffap-read-only-other-window)
	(ffap-read-only-other-frame): Callers changed.

	* help-mode.el: Don't require view package.
	(help-mode-finish): Set buffer-read-only instead of calling
	toggle-read-only.

	* bindings.el (mode-line-toggle-read-only):
	* dired.el (dired-toggle-read-only):
	* ibuffer.el (ibuffer-do-toggle-read-only): Call toggle-read-only
	with non-nil second arg.

	* emacs-lisp/eieio-custom.el (eieio-customize-object):
	* vc/ediff.el (ediff-set-read-only-in-buf-A): Set buffer-read-only
	directly.

2012-07-12  Eli Zaretskii  <eliz@gnu.org>

	* emacs-lisp/bytecomp.el (byte-recompile-directory): Use cl-incf,
	not incf.

2012-07-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	More CL cleanups and reduction of use of cl.el.
	* woman.el, winner.el, vc/vc-rcs.el, vc/vc-hooks.el, vc/vc-hg.el:
	* vc/vc-git.el, vc/vc-dir.el, vc/vc-bzr.el, vc/vc-annotate.el:
	* textmodes/tex-mode.el, textmodes/sgml-mode.el, tar-mode.el:
	* strokes.el, ses.el, server.el, progmodes/js.el, progmodes/gdb-mi.el:
	* progmodes/flymake.el, progmodes/ebrowse.el, progmodes/compile.el:
	* play/tetris.el, play/snake.el, play/pong.el, play/landmark.el:
	* play/hanoi.el, play/decipher.el, play/5x5.el, nxml/nxml-mode.el:
	* net/secrets.el, net/quickurl.el, midnight.el, mail/footnote.el:
	* image-dired.el, ibuffer.el, ibuf-macs.el, ibuf-ext.el, hexl.el:
	* eshell/eshell.el, eshell/esh-io.el, eshell/esh-ext.el:
	* eshell/esh-cmd.el, eshell/em-ls.el, eshell/em-hist.el:
	* eshell/em-cmpl.el, eshell/em-banner.el:
	* calendar/parse-time.el: Use cl-lib.
	* wid-browse.el, wdired.el, vc/vc.el, vc/vc-mtn.el, vc/vc-cvs.el:
	* vc/vc-arch.el, tree-widget.el, textmodes/texinfo.el:
	* textmodes/refill.el, textmodes/css-mode.el, term/tvi970.el:
	* term/ns-win.el, term.el, shell.el, ps-samp.el:
	* progmodes/perl-mode.el, progmodes/pascal.el, progmodes/gud.el:
	* progmodes/glasses.el, progmodes/etags.el, progmodes/cwarn.el:
	* play/gamegrid.el, play/bubbles.el, novice.el, notifications.el:
	* net/zeroconf.el, net/xesam.el, net/snmp-mode.el, net/mairix.el:
	* net/ldap.el, net/eudc.el, net/browse-url.el, man.el:
	* mail/mailheader.el, mail/feedmail.el: Don't use CL.
	* ibuf-ext.el (ibuffer-mark-old-buffers): Use float-time.
	* eshell/esh-opt.el (eshell-eval-using-options): Quote code with
	`lambda' rather than with `quote'.
	(eshell-do-opt): Adjust accordingly.
	(eshell-process-option): Simplify.
	* eshell/esh-var.el:
	* eshell/em-script.el: Require `esh-opt' for eshell-eval-using-options.
	* emacs-lisp/pcase.el (pcase--dontcare-upats, pcase--let*)
	(pcase--expand, pcase--u1): Rename pcase's internal `dontcare' pattern
	to `pcase--dontcare'.
	* emacs-lisp/cl.el (labels): Mark obsolete.
	(cl--letf, letf): Move to cl-lib.
	(cl--letf*, letf*): Remove.
	* emacs-lisp/cl-lib.el (cl-nth-value): Use defalias.
	* emacs-lisp/cl-macs.el (cl-dolist, cl-dotimes): Add indent rule.
	(cl-progv): Rewrite.
	(cl--letf, cl-letf): Move from cl.el.
	(cl-letf*): New macro.
	* emacs-lisp/cl-extra.el (cl--progv-before, cl--progv-after): Remove.

2012-07-11  Michael Albinus  <michael.albinus@gmx.de>

	* net/ange-ftp.el (ange-ftp-cf1): Update the files cache.

2012-07-11  Chong Yidong  <cyd@gnu.org>

	* vc/log-edit.el (log-edit-vc-backend): New variable.
	(log-edit): Doc fix.

	* vc/vc-dispatcher.el (vc-log-edit): New args.  Use PARAMS
	argument of log-edit to set up all local variables.
	(vc-start-logentry): New optional arg specifying VC backend.

	* vc/vc.el (vc-checkin): Use it.
	(vc-deduce-fileset): Handle Log Edit buffers.
	(vc-diff): Make first argument optional too.

	* vc/log-view.el (log-view-vc-fileset, log-view-vc-backend): Doc fix.

2012-07-10  Michael Albinus  <michael.albinus@gmx.de>

	* eshell/esh-ext.el (eshell-remote-command): Remove remote part of
	command, just in case.  The function is not needed anymore.
	(eshell-external-command): Do not call `eshell-remote-command'.

2012-07-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	Reduce use of (require 'cl).
	* vc/smerge-mode.el, vc/pcvs.el, vc/pcvs-util.el, vc/pcvs-info.el:
	* vc/diff-mode.el, vc/cvs-status.el, uniquify.el, scroll-bar.el:
	* register.el, progmodes/sh-script.el, net/gnutls.el, net/dbus.el:
	* msb.el, mpc.el, minibuffer.el, international/ucs-normalize.el:
	* international/quail.el, info-xref.el, imenu.el, image-mode.el:
	* font-lock.el, filesets.el, edmacro.el, doc-view.el, bookmark.el:
	* battery.el, avoid.el, abbrev.el: Use cl-lib.
	* vc/pcvs-parse.el, vc/pcvs-defs.el, vc/log-view.el, vc/log-edit.el:
	* vc/diff.el, simple.el, pcomplete.el, lpr.el, comint.el, loadhist.el:
	* jit-lock.el, international/iso-ascii.el, info.el, frame.el, bs.el:
	* emulation/crisp.el, electric.el, dired.el, cus-dep.el, composite.el:
	* calculator.el, autorevert.el, apropos.el: Don't require CL.
	* emacs-lisp/bytecomp.el (byte-recompile-directory, display-call-tree)
	(byte-compile-unfold-bcf, byte-compile-check-variable):
	* emacs-lisp/byte-opt.el (byte-compile-trueconstp)
	(byte-compile-nilconstp):
	* emacs-lisp/autoload.el (make-autoload): Use pcase.
	* face-remap.el (text-scale-adjust): Simplify pcase patterns.

	* emacs-lisp/gv.el (cond): Make it a valid place.
	(if): Simplify slightly.

	* emacs-lisp/pcase.el (pcase): Accept self-quoting exps as "upatterns".
	(pcase--self-quoting-p): New function.
	(pcase--u1): Use it.

2012-07-10  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/authors.el (authors-fixed-entries):
	(authors-renamed-files-alist): Update for configure.in -> configure.ac.

2012-07-09  Paul Eggert  <eggert@cs.ucla.edu>

	Rename configure.in to configure.ac (Bug#11603).
	* emacs-lisp/authors.el (authors-canonical-file-name):
	* progmodes/autoconf.el (autoconf-mode):
	Prefer configure.ac to configure.in.

2012-07-08  Chong Yidong  <cyd@gnu.org>

	* mouse.el (mouse-drag-line): Rewrite the track-mouse loop.
	Implement the mouse-1-click-follows-link handling properly.

	* info.el (Info-link-keymap): Use follow-link mechanism for
	header-line links (Bug#374).

	* simple.el (deactivate-mark): Do not set the primary selection
	if another program has acquired it (Bug#11772).

2012-07-07  Kevin Ryde  <user42@zip.com.au>

	* woman.el (woman-strings): Fix double-quote handling (Bug#1151).
	(woman-decode-region): Replace escaped-escapes without destroying
	bold or underline (Bug#11552).
	(woman2-process-escapes): Handle nofill regions (Bug#11591).

2012-07-07  Chong Yidong  <cyd@gnu.org>

	* simple.el (yank-pop-change-selection): Doc fix (Bug#11361).
	(interprogram-cut-function, interprogram-paste-function):
	Mention that we typically mean the clipboard.

2012-07-06  Glenn Morris  <rgm@gnu.org>

	* kmacro.el (kmacro-call-macro): Restore repeat message.  (Bug#11817)

	* files.el (toggle-read-only): Restrict message to interactive use.

2012-07-06  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-restricted-shell-hosts-alist): New defcustom.

	* net/tramp-sh.el (tramp-maybe-open-connection): Handle it.

2012-07-06  Glenn Morris  <rgm@gnu.org>

	* Makefile.in (compile-one-process): Rename from "recompile".

	* Makefile.in (bzr-update): "compile" is the same as "recompile
	autoloads", but parallelizable, so use that instead.

2012-07-06  Dmitry Gutov  <dgutov@yandex.ru>

	* window.el (quit-window): Always restore window height when
	it's saved in quit-restore parameter (Bug#11810).

2012-07-06  Glenn Morris  <rgm@gnu.org>

	* simple.el (kill-whole-line): Doc tweak.

2012-07-06  Eli Zaretskii  <eliz@gnu.org>

	* files.el (file-relative-name): Compare file names
	case-insensitively if on MS-Windows or MS-DOS, or if
	read-file-name-completion-ignore-case is non-nil.  Don't use
	case-fold-search for this purpose.  (Bug#11827)

2012-07-17  Andreas Schwab  <schwab@linux-m68k.org>

	* calendar/cal-dst.el (calendar-current-time-zone):
	Return calendar-current-time-zone-cache if non-nil.

2012-07-17  Masatake YAMATO  <yamato@redhat.com>
2012-07-06  Andreas Schwab  <schwab@linux-m68k.org>

	* calendar/cal-dst.el (calendar-current-time-zone):
	Return calendar-current-time-zone-cache if non-nil.

2012-07-06  Glenn Morris  <rgm@gnu.org>

	* Makefile.in (cvs-update): Remove old alias.

2012-07-05  Michael Albinus  <michael.albinus@gmx.de>

	Sync with Tramp 2.2.6-pre.

	* net/tramp.el (tramp-drop-volume-letter): Provide an XEmacs
	compatible declaration.

	* net/tramp-cmds.el (tramp-append-tramp-buffers):
	Protect `list-load-path-shadows' call.

	* net/tramp-compat.el (top): Require packages, which aren't
	autoloaded anymore for XEmacs.  Protect call of
	`tramp-file-name-handler' by `tramp-compat-funcall', pacifying the
	compiler.  Do not require tramp-util.el and tramp-vc.el anymore,
	it hurts at least for SXEmacs.
	(tramp-compat-temporary-file-directory): In XEmacs, there is no
	standard-value for `temporary-file-directory'.

	* net/tramp-sh.el (tramp-do-directory-files-and-attributes-with-stat):
	Redirect stderr to /dev/null.
	(tramp-sh-handle-write-region): uid and gid can be floats.
	Reported by Russell Sim <russell.sim@gmail.com>.
	(tramp-sh-handle-vc-registered): Hide errors.
	(tramp-vc-file-name-handler): Use dummy results for `process-file'
	and `start-file-process'.
	(tramp-maybe-open-connection): Check also whether `non-essential'
	is bound.

2012-07-04  Chong Yidong  <cyd@gnu.org>

	* xml.el (xml--parse-buffer): Use xml-syntax-table.
	(xml-parse-tag): Likewise, and avoid changing entity tables.
	(xml-syntax-table): Define from scratch, making sure not to give
	x2000 and other Unicode spaces whitespace syntax, since those are
	not spaces in XML.
	(xml-parse-fragment): Delete unused function.
	(xml-name-start-char-re, xml-name-char-re, xml-name-re)
	(xml-names-re, xml-nmtoken-re, xml-nmtokens-re, xml-char-ref-re)
	(xml-entity-ref, xml-pe-reference-re)
	(xml-reference-re, xml-att-value-re, xml-tokenized-type-re)
	(xml-notation-type-re, xml-enumeration-re, xml-enumerated-type-re)
	(xml-att-type-re, xml-default-decl-re, xml-att-def-re)
	(xml-entity-value-re): Use syntax references in regexps where
	possible; no need to define inside a let-binding.
	(xml-parse-dtd): Use xml-pe-reference-re.
	(xml-entity-or-char-ref-re): New defconst.
	(xml-parse-string, xml-substitute-special): Use it.

2012-07-04  Stefan Monnier  <monnier@iro.umontreal.ca>

	* files.el (locate-dominating-file): Allow `name' to be a predicate.
	(find-file--read-only): New function.
	(find-file-read-only, find-file-read-only-other-window)
	(find-file-read-only-other-frame): Use it.
	(insert-file-contents-literally): Don't `fset'.
	(get-free-disk-space): Use locate-dominating-file.

	* emacs-lisp/bytecomp.el (byte-compile): Don't signal an error if the
	function is already compiled.

	* xml.el (xml-name-regexp): Remove, redundant.  Use xml-name-re.

2012-07-03  Michael Albinus  <michael.albinus@gmx.de>

	* vc/ediff-diff.el (ediff-same-file-contents): Fix it for remote
	files on the same host.

2012-07-03  Andreas Schwab  <schwab@linux-m68k.org>

	* help-fns.el (describe-function-1): Only call
	help-fns--autoloaded-p when we have a file name.  (Bug#11848)

2012-07-03  Chong Yidong  <cyd@gnu.org>

	* xml.el: Protect parser against XML bombs.
	(xml-entity-expansion-limit): New variable.
	(xml-parse-string, xml-substitute-special): Use it.
	(xml-parse-dtd): Avoid infloop if the DTD is not terminated.

2012-07-03  Glenn Morris  <rgm@gnu.org>

	* progmodes/bug-reference.el (bug-reference-bug-regexp):
	Allow linking to specific messages in debbugs reports (eg 123#5).

2012-07-02  Chong Yidong  <cyd@gnu.org>

	* xml.el: Fix entity and character reference expansion, allowing
	them to expand into markup as per XML spec.
	(xml-default-ns): New variable.
	(xml-entity-alist): Use XML spec definitions for lt and amp.
	(xml-parse-region): Make first two arguments optional.
	Discard text properties.
	(xml-parse-tag-1): New function, spun off from xml-parse-tag.
	All callers changed.
	(xml-parse-tag): Call xml-parse-tag-1.  For backward
	compatibility, this function should not modify buffer contents.
	(xml-parse-tag-1): Fix opening-tag regexp.
	(xml-parse-string): Rewrite, handling entity and character
	references properly.
	(xml--entity-replacement-text): Signal an error if a parameter
	entity is undefined.

2012-07-02  Stefan Monnier  <monnier@iro.umontreal.ca>

	* comint.el (comint-output-filter): Filter out repeated prompts.

	* net/ange-ftp.el (ange-ftp-expand-file-name): Use ange-ftp-ftp-name
	and file-name-absolute-p.
	(ange-ftp-file-exists-p): Use ange-ftp-file-exists-p for
	internal calls.

2012-07-02  Paul Eggert  <eggert@cs.ucla.edu>

	Spelling fixes.
	* emacs-lisp/bytecomp.el (byte-compile--reify-function):
	Rename from byte-compile--refiy-function.  All uses changed.

2012-07-01  Chong Yidong  <cyd@gnu.org>

	* xml.el (xml--parse-buffer): New function.  Move most of
	xml-parse-region here.
	(xml-parse-region): Copy region into a temporary buffer, since
	parameter entity substitution requires changing buffer contents.
	Use xml--parse-buffer.
	(xml-parse-file): Use xml--parse-buffer.
	(xml-parse-dtd): Make parameter entity substitution work right.
	Use proper regexps for ELEMENT declarations (Bug#7172).

2012-06-30  Glenn Morris  <rgm@gnu.org>

	* comint.el (follow-comint-scroll-to-bottom): Fix declaration.

	* net/secrets.el, net/tramp-gvfs.el, net/xesam.el, net/zeroconf.el:
	Remove outdated and unnecessary dbus declarations.

2012-06-30  Eli Zaretskii  <eliz@gnu.org>

	* emacs-lisp/timer.el (timer-until): Subtract results of
	float-time, instead of taking float-time of the result of
	time-subtract, since float-time signals an error for negative time
	arguments.

2012-06-30  Chong Yidong  <cyd@gnu.org>

	* xml.el (xml-*-re): Convert defvars into defconsts, and
	eval-and-compile them so eval-and-compile works on derivatives.
	(xml--entity-replacement-text): Use eval-and-comple.

2012-06-30  Michael Albinus  <michael.albinus@gmx.de>

	* vc/vc-git.el (vc-git-registered): Use cache property
	`git-registered'.
	(vc-git-mode-line-string): Call `vc-working-revision' instead of
	`vc-git-working-revision' in order to benefit from the cache.
	(vc-git-root): Use cache property `git-root'.  (Bug#11757)

2012-06-30  Dmitry Gutov  <dgutov@yandex.ru>

	* vc/vc-hooks.el (vc-before-save): Clear cache if file has been
	removed (likely outside Emacs).  (Bug#11757)

2012-06-30  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/cl-lib.el: Require macroexp.

2012-06-30  Chong Yidong  <cyd@gnu.org>

	* xml.el: Implement XML parameter entities.
	(xml-parameter-entity-alist): New variable.
	(xml-parse-region, xml-parse-fragment): Preserve previous values
	of xml-entity-alist and xml-parameter-entity-alist, so that
	repeated calls on different documents do not change them.
	(xml-parse-tag): Fix doctype regexp.
	(xml--entity-replacement-text): New function.
	(xml-parse-dtd): Use it.  Don't handle system entities; doing that
	properly requires url retrieval which is unimplemented.
	(xml-escape-string): Doc fix.

2012-06-30  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/cl-lib.el (cl-pushnew): Use macroexp-let2.

2012-06-29  Dmitry Antipov  <dmantipov@yandex.ru>

	* fringe.el (fringe-mode): Doc fix.

2012-06-29  Michael Albinus  <michael.albinus@gmx.de>

	* net/ange-ftp.el (ange-ftp-get-passwd): Throw if `non-essential'
	is non-nil.
	(ange-ftp-ignore-errors-if-non-essential): New defmacro.
	(ange-ftp-file-name-all-completions): Use it.  (Bug#11808)

2012-06-29  Andreas Schwab  <schwab@linux-m68k.org>

	* calendar/cal-dst.el (calendar-current-time-zone):
	Return calendar-current-time-zone-cache if non-nil.

2012-06-29  Masatake YAMATO  <yamato@redhat.com>

	* progmodes/which-func.el (which-func-format):
	Add mouse-face.  (Bug#11698)

2012-06-29  Leo Liu  <sdl.web@gmail.com>

	* textmodes/enriched.el (enriched-next-annotation): Use eq (Bug#11528).

2012-06-29  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuffer.el (minibuffer-confirm-exit-commands):
	Add completion-at-point (bug#11725).

2012-06-29  Glenn Morris  <rgm@gnu.org>

	* progmodes/f90.el (f90-font-lock-keywords-2):
	Add some preprocessor elements.  (Bug#10499)

2012-06-29  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/cperl-mode.el (cperl-update-syntaxification):
	Use syntax-propertize (bug#11739).

2012-06-28  Juanma Barranquero  <lekktu@gmail.com>

	* emacs-lisp/cl-lib.el (cl-pushnew): Don't capture X (bug#11811).

2012-06-28  Julien Danjou  <julien@danjou.info>

	* term.el (term-handle-colors-array): Use a set of new faces to
	color the terminal.  Also uses :inverse-video property.
	(term-default-fg-color): Set to nil by default, deprecate in favor
	of `term-face'.
	(term-default-bg-color): Set to nil by default, deprecate in favor
	of `term-face'.
	(term-current-face): Use `term-face' by default.
	(term-bold-attribute): Variable deleted.

2012-06-28  Glenn Morris  <rgm@gnu.org>

	* simple.el (completion-list-mode-finish):
	Don't use toggle-read-only.  (Since completion-list-mode has
	a special mode-class, it wasn't doing anything extra anyway.)

2012-06-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	Make inlining of other-mode interpreted functions work (bug#11799).
	* emacs-lisp/bytecomp.el (byte-compile--refiy-function): New fun.
	(byte-compile): Use it to fix compilation of lexical-binding closures.
	* emacs-lisp/byte-opt.el (byte-compile-inline-expand): Compile the
	function, if needed.

2012-06-27  Stefan Monnier  <monnier@iro.umontreal.ca>

	* help-mode.el (help-make-xrefs): Don't just withstand
	cyclic-variable-indirection but any error in documentation-property.

	* loadup.el (purify-flag): Pre-grow the hash-table to reduce the
	memory use.
	* bindings.el (bindings--define-key): New function.
	* vc/vc-hooks.el, replace.el, menu-bar.el, international/mule-cmds.el:
	* emacs-lisp/lisp-mode.el, buff-menu.el, bookmark.el:
	* bindings.el: Use it to purecopy define-key bindings.

	* textmodes/rst.el (rst-adornment-faces-alist): Avoid copy-list.

	* emacs-lisp/cl.el (flet): Mark obsolete.
	* emacs-lisp/cl-macs.el (cl-flet*): New macro.
	* vc/vc-rcs.el (vc-rcs-annotate-command, vc-rcs-parse):
	* progmodes/js.el (js-c-fill-paragraph):
	* progmodes/ebrowse.el (ebrowse-switch-member-buffer-to-sibling-class)
	(ebrowse-switch-member-buffer-to-derived-class):
	* play/5x5.el (5x5-solver): Use cl-flet.

	* emacs-lisp/cl.el: Use lexical-binding.  Fix flet (bug#11780).
	(cl--symbol-function): New macro.
	(cl--letf, cl--letf*): Use it.

	* emacs-lisp/easy-mmode.el (easy-mmode-pretty-mode-name):
	Strip "toggle-" if any.

2012-06-27  Glenn Morris  <rgm@gnu.org>

	* info.el (Info-default-directory-list): Move here from paths.el.
	* paths.el: Remove file, which is now empty.
	* loadup.el: No longer load "paths".

	* custom.el (custom-initialize-delay): Doc fix.

	* eshell/em-alias.el, eshell/em-banner.el, eshell/em-basic.el:
	* eshell/em-cmpl.el, eshell/em-dirs.el, eshell/em-glob.el:
	* eshell/em-hist.el, eshell/em-ls.el, eshell/em-pred.el:
	* eshell/em-prompt.el, eshell/em-rebind.el, eshell/em-script.el:
	* eshell/em-smart.el, eshell/em-term.el, eshell/em-unix.el:
	* eshell/em-xtra.el: Replace eshell-defgroup with "(progn (defgroup".
	* eshell/eshell.el (eshell-defgroup): Remove alias.

2012-06-27  Chong Yidong  <cyd@gnu.org>

	* help.el (help-enable-auto-load): New variable.

	* help-fns.el (help-fns--autoloaded-p): New function.
	(describe-function-1): Refer to a function as "autoloaded" if it
	was autoloaded at any time in the past.  Perform autoloading if
	help-enable-auto-load is non-nil.

2012-06-26  Eli Zaretskii  <eliz@gnu.org>

	* makefile.w32-in (compile, compile-always): Depend on
	update-subdirs, not on subdirs.el.  Otherwise, several different
	sub-targets of 'bootstrap' running in parallel could
	simultaneously write to subdirs.el, producing a garbled file.

2012-06-26  Sam Steingold  <sds@gnu.org>

	* files.el (file-name-base): New convenience function.
	* autoinsert.el, cus-dep.el, doc-view.el, image-dired.el:
	* woman.el, eshell/esh-cmd.el, progmodes/ada-xref.el:
	* progmodes/cc-defs.el, progmodes/cperl-mode.el:
	* progmodes/flymake.el, progmodes/gud.el, progmodes/idlwave.el:
	* textmodes/ispell.el, textmodes/reftex-ref.el:
	* textmodes/tex-mode.el: Use it.
	Did not touch cedet and org because they are maintained elsewhere.

2012-06-26  Martin Rudalics  <rudalics@gmx.at>

	* calendar/calendar.el (calendar-exit): Don't try to delete or
	iconify last frame.  See:
	https://lists.gnu.org/r/emacs-devel/2012-06/msg00372.html

2012-06-25  Jim Diamond  <Jim.Diamond@AcadiaU.ca>  (tiny change)

	* server.el (server-process-filter): Remember dir in the
	process's `server-client-directory' properties.

2012-06-24  Chong Yidong  <cyd@gnu.org>

	* xml.el (xml-parse-tag): Correctly handle comment embedded in
	non-tag text.

2012-06-23  Juanma Barranquero  <lekktu@gmail.com>

	* makefile.w32-in (COMPILE_FIRST): Synch with changes in 2012-06-22T21:24:54Z!monnier@iro.umontreal.ca.

2012-06-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* help-fns.el (describe-variable): Don't croak when doc is not found.
	* vc/pcvs.el (cvs-retrieve-revision): Avoid toggle-read-only.
	* menu-bar.el (menu-bar-line-wrapping-menu): Purecopy a tiny bit more.
	* emacs-lisp/syntax.el (syntax-ppss): Simplify with new `if' place.
	* emacs-lisp/smie.el (smie-next-sexp): CSE.
	* emacs-lisp/macroexp.el (macroexp-let2): Fix edebug spec and avoid
	((lambda ..) ..).
	* emacs-lisp/eieio.el (eieio-oref, slot-value): Use simpler defsetf.

2012-06-23  Chong Yidong  <cyd@gnu.org>

	* info.el (Info-mouse-follow-link): Accept symbol values of
	link-args.  Select window; suggested by Gerhard Kahl (Bug#11672).
	(Info-fontify-node): Use Info-link-keymap for all navigation
	buttons, with link-args property to perform the desired action.
	(Info-link-keymap): Doc fix.
	(Info-next-link-keymap, Info-prev-link-keymap)
	(Info-up-link-keymap): Delete now-unused keymaps.

2012-06-23  Chong Yidong  <cyd@gnu.org>

	* mouse.el (mouse-drag-track): Deactivate the mark before popping.

	* progmodes/python.el (python-skeleton-define): Mark abbrevs as
	system abbrevs.

	* ansi-color.el (ansi-color-apply-on-region): Doc fix.

2012-06-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/cl-macs.el (cl--make-usage-args): Handle improper lists
	(bug#11719).

	* minibuffer.el (completion--twq-try): Try to fail more gracefully when
	the requote function doesn't work properly (bug#11714).

2012-06-23  Glenn Morris  <rgm@gnu.org>

	* pcmpl-rpm.el (pcmpl-rpm-packages): Give status messages.

2012-06-22  Stefan Monnier  <monnier@iro.umontreal.ca>

	Further GV/CL cleanups.
	* emacs-lisp/gv.el (gv-get): Autoload functions to find their
	gv-expander.
	(gv--defun-declaration): New function.
	(defun-declarations-alist): Use it.
	(gv-define-modify-macro, gv-pushnew!, gv-inc!, gv-dec!): Remove.
	(gv-place): Autoload.
	* emacs-lisp/cl.el (cl--dotimes, cl--dolist): Remember subr.el's
	original definition of dotimes and dolist.
	* emacs-lisp/cl-macs.el (cl-expr-access-order): Remove unused.
	(cl-dolist, cl-dotimes): Use `dolist' and `dotimes'.
	* emacs-lisp/cl-lib.el: Move gv handlers from cl-macs to here.
	(cl-fifth, cl-sixth, cl-seventh, cl-eighth)
	(cl-ninth, cl-tenth): Move gv handler to the function's definition.
	* emacs-lisp/cl-extra.el (cl-subseq, cl-get, cl-getf): Move gv handler
	to the function's definition.
	* Makefile.in (COMPILE_FIRST): Re-order to speed it up by about 50%.
	* window.el:
	* files.el:
	* faces.el:
	* env.el: Don't use CL.

2012-06-22  Paul Eggert  <eggert@cs.ucla.edu>

	Support higher-resolution time stamps (Bug#9000).

	* calendar/time-date.el (with-decoded-time-value): New arg
	PICO-SYMBOL in VARLIST.  It's optional, for backward compatibility.
	(encode-time-value): New optional arg PICO.  New type 3.
	(time-to-seconds) [!float-time]: Support the new picoseconds
	component if it's used.
	(seconds-to-time, time-subtract, time-add):
	Support ps-resolution time stamps as well.

	* emacs-lisp/timer.el (timer): New component psecs.  All uses changed.
	(timerp): Timer vectors now have length 9, not 8.
	(timer--time): Support new-style (4-part) time stamps.
	(timer-next-integral-multiple-of-time): Time stamps now have
	picosecond resolution, so take a bit more care about rounding.
	(timer-relative-time, timer-inc-time): New optional arg psecs.
	(timer-set-time-with-usecs): Set psecs to 0.
	(timer--activate): Check psecs component, too.

	* proced.el (proced-time-lessp): Support ps-resolution stamps.

2012-06-22  Stefan Monnier  <monnier@iro.umontreal.ca>

	* icomplete.el (icomplete-minibuffer-setup, icomplete-completions):
	Move the non-essential binding to the post/pre-command-hook where it is
	more obviously correct.

	* subr.el (read-passwd): Don't use a history at all.
	* savehist.el (savehist-save): Remove password saved accidentally
	because of the above bug.

2012-06-22  Bastien Guerry  <bzg@gnu.org>

	* files.el (toggle-read-only): Display a message telling whether
	the buffer is read-only or not (bug#11726).

2012-06-22  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/gv.el: New file.
	* subr.el (push, pop): Extend to generalized variables.
	* loadup.el (macroexp): Unload if preloaded and uncompiled (bug#11657).
	* emacs-lisp/cl-lib.el (cl-pop, cl-push, cl--set-nthcdr): Remove.
	* emacs-lisp/cl-macs.el: Require gv.  Use gv-define-setter,
	gv-define-simple-setter, and gv-define-expander.
	Remove setf-methods defined in gv.  Rename cl-setf -> setf.
	(cl-setf, cl-do-pop, cl-get-setf-method): Remove.
	(cl-letf, cl-letf*, cl-define-modify-macro, cl-defsetf)
	(cl-define-setf-expander, cl-struct-setf-expander): Move to cl.el.
	(cl-remf, cl-shiftf, cl-rotatef, cl-callf, cl-callf2): Rewrite with
	gv-letplace.
	(cl-defstruct): Don't define setf-method any more.
	* emacs-lisp/cl.el (flet): Don't autoload.
	(cl--letf, letf, cl--letf*, letf*, cl--gv-adapt)
	(define-setf-expander, defsetf, define-modify-macro)
	(cl-struct-setf-expander): Move from cl-lib.el.
	* emacs-lisp/syntax.el:
	* emacs-lisp/ewoc.el:
	* emacs-lisp/smie.el:
	* emacs-lisp/cconv.el:
	* emacs-lisp/timer.el: Rename cl-setf -> setf, cl-push -> push.
	(timer--time): Use gv-define-simple-setter.
	* emacs-lisp/macroexp.el (macroexp-let2): Rename from macroexp-let²
	to avoid coding-system problems in subr.el.  Adjust all users.
	(macroexp--maxsize, macroexp-small-p): New functions.
	* emacs-lisp/bytecomp.el (byte-compile-file): Don't use cl-letf.
	* scroll-bar.el (scroll-bar-mode):
	* simple.el (auto-fill-mode, overwrite-mode, binary-overwrite-mode)
	(normal-erase-is-backspace-mode): Don't use the `eq' place.
	* winner.el (winner-configuration, winner-make-point-alist)
	(winner-set-conf, winner-get-point, winner-set): Don't abuse letf.
	* files.el (locate-file-completion-table): Avoid list*.

2012-06-22  Chong Yidong  <cyd@gnu.org>

	* dired-aux.el (dired-do-create-files): Doc fix (Bug#11327).
	(dired-create-files): Doc fix (Bug#11329).
	(dired-do-copy): Doc fix (Bug#11334).
	(dired-mark-read-string): Doc fix (Bug#11553).

	* dired.el (dired-recursive-copies, dired-recursive-deletes):
	Doc fix (Bug#11326).
	(dired-make-relative): Doc fix (Bug#11332).  Remove unused arg.
	(dired-dwim-target): Doc fix.

	* wdired.el (wdired-mode): Doc fix.

2012-06-22  Glenn Morris  <rgm@gnu.org>

	* pcmpl-rpm.el (pcmpl-rpm-cache): New option.
	(pcmpl-rpm-cache-stamp-file): New constant.
	(pcmpl-rpm-cache-time, pcmpl-rpm-packages): New variables.
	(pcmpl-rpm-packages): Optionally cache list of packages.

	* pcmpl-rpm.el (pcmpl-rpm): New group.
	(pcmpl-rpm-query-options): New option.
	(pcmpl-rpm-packages): No need to inline it.
	Use pcmpl-rpm-query-options.

	* calendar/calendar.el (calendar-in-read-only-buffer):
	Avoid some needless mode changes.

2012-06-21  Chong Yidong  <cyd@gnu.org>

	* desktop.el (desktop-read): Don't prompt if daemon (Bug#11674).
	(desktop-path): Remove . from the default value (Bug#10977).
	(desktop-read): Use user-emacs-directory if desktop-path is nil.

2012-06-20  Chong Yidong  <cyd@gnu.org>

	* term.el (term-send-raw-meta): Make C-M-<char> keys work (Bug#8172).

2012-06-20  David Röthlisberger  <david@rothlis.net>  (tiny change)

	* ido.el (ido-switch-buffer, ido-find-file): Fix up doc of C-j
	(bug#11201).

2012-06-20  Chong Yidong  <cyd@gnu.org>

	* term.el (term-window-width): Handle the case of a missing right
	fringe (Bug#8837).
	(term-check-size): Use window-text-height (Bug#5445).
	(term-mode): Use define-derived-mode.  Minor cleanups.
	Set font-lock-defaults (Bug#7692).
	(term-move-columns, term-insert-char, term-emulate-terminal)
	(term-erase-in-line, term-insert-spaces): Use font-lock-face.

2012-06-20  Michael Albinus  <michael.albinus@gmx.de>

	* net/ange-ftp.el (ange-ftp-get-passwd):
	Bind `enable-recursive-minibuffers'.
	(ange-ftp-get-process): Throw if `non-essential' is non-nil.

2012-06-19  David Röthlisberger  <david@rothlis.net>  (tiny change)

	* ido.el (ido-find-file): Mention C-d binding in docstring (bug#11244).

2012-06-19  Glenn Morris  <rgm@gnu.org>

	* progmodes/python.el (python-mode): Derive from prog-mode.

2012-06-19  Kevin Gallagher  <Kevin.Gallagher@boeing.com>

	* emulation/edt.el (edt-default-menu-bar-update-buffers)
	(edt-user-menu-bar-update-buffers): New functions.
	(edt-default-emulation-setup, edt-user-emulation-setup): Use them.

2012-06-19  Chong Yidong  <cyd@gnu.org>

	* subr.el (with-selected-window): Preserve the selected window's
	terminal's top-frame (Bug#4702).

	* window.el (save-selected-window): Likewise.

2012-06-18  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/python.el (python-rx-constituents): Move backquote.
	(python-skeleton-define, python-define-auxiliary-skeleton):
	Use `declare'.

2012-06-18  Michael Albinus  <michael.albinus@gmx.de>

	* minibuffer.el (read-file-name-default): Revert the patch from
	2012-06-17.

2012-06-18  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/pcase.el (pcase--expand): Warn for unused pattern.
	(pcase--u1, pcase--q1): Don't use apply-partially.

2012-06-18  Glenn Morris  <rgm@gnu.org>

	* progmodes/python.el (python-proc, python-buffer)
	(python-send-receive, python-send-string): Fix obsolete versions.

2012-06-18  Martin Rudalics  <rudalics@gmx.at>

	* window.el (special-display-p): Completely remove stringp
	check.  Suggested by Andreas Schwab <schwab@linux-m68k.org>.

2012-06-17  Michael Albinus  <michael.albinus@gmx.de>

	* minibuffer.el (read-file-name-default): Bind `non-essential' to `t'.

	* net/tramp.el (tramp-file-name-handler): Catch 'non-essential.

	* net/ange-ftp.el (ange-ftp-gwp-start, ange-ftp-start-process):
	* net/tramp-sh.el (tramp-maybe-open-connection):
	Throw if `non-essential' is non-nil.

2012-06-17  Martin Rudalics  <rudalics@gmx.at>

	* window.el (special-display-p): Signal an error if BUFFER-NAME
	is not a string (Bug#11713).

2012-06-17  Paul Eggert  <eggert@cs.ucla.edu>

	* progmodes/python.el (python-info-beginning-of-backslash):
	Rename from python-info-beginning-of-backlash, as a spelling fix.

2012-06-17  Chong Yidong  <cyd@gnu.org>

	* term.el (term-emulate-terminal): If term-check-size is called,
	move point to the process mark without resetting point (Bug#4635).

2012-06-17  Glenn Morris  <rgm@gnu.org>

	* international/mule-cmds.el (mule-menu-keymap)
	(set-language-environment, set-locale-environment): Doc tweaks.

2012-06-16  Aurélien Aptel  <aurelien.aptel@gmail.com>

	* cus-face.el (custom-face-attributes): Add wave-style underline
	attribute.
	* faces.el (set-face-attribute): Update docstring to describe
	wave-style underline attribute.

2012-06-16  Chong Yidong  <cyd@gnu.org>

	* term/xterm.el (terminal-init-xterm): Discard input before
	querying background mode (Bug#10959).

2012-06-16  Stefan Merten  <smerten@oekonux.de>

	* textmodes/rst.el: Added and corrected some comments.
	(rst-re-alist-def): Improve symbol syntax.
	(rst-mode-syntax-table): Correct syntax entries.
	(rst-cvs-header, rst-svn-rev, rst-svn-timestamp)
	(rst-official-version, rst-official-cvs-rev): Update version
	information.

2012-06-15  Juanma Barranquero  <lekktu@gmail.com>

	* makefile.w32-in (COMPILE_FIRST): Synch with makefile.in changes
	in 2008-06-22T13:57:28Z!monnier@iro.umontreal.ca.

2012-06-15  Fabián Ezequiel Gallina  <fgallina@cuca>

	* progmodes/python.el: New python.el merge.
	(python-guess-indent): Obsolete var.
	(python-indent-guess-indent-offset): New defcustom.
	(python-indent): Obsolete var.
	(python-indent-offset): New defcustom.
	(python-python-command, python-jython-command): Delete var.
	(python-shell-interpreter): New defcustom.
	(python-pdbtrack-do-tracking-p): Delete var.
	(python-pdbtrack-activate): New defcustom.
	(python-use-skeletons): Obsolete var.
	(python-skeleton-autoinsert): New defcustom.
	(inferior-python-filter-regexp, python-continuation-offset)
	(python-honour-comment-indentation, python-indent-string-contents)
	(python-jython-packages, python-mode-hook)
	(python-pdbtrack-minor-mode-string, python-remove-cwd-from-path)
	(python-shell-prompt-alist)
	(python-source-modes): Delete defcustoms.
	(python-check-buffer-name, python-eldoc-setup-code)
	(python-eldoc-string-code, python-ffap-setup-code)
	(python-ffap-string-code, python-fill-comment-function)
	(python-fill-decorator-function, python-fill-paren-function)
	(python-fill-string-function, python-imenu-include-defun-type)
	(python-imenu-make-tree, python-imenu-subtree-root-label)
	(python-pdbtrack-stacktrace-info-regexp, python-shell-buffer-name)
	(python-shell-compilation-regexp-alist)
	(python-shell-completion-module-string-code)
	(python-shell-completion-pdb-string-code)
	(python-shell-completion-setup-code)
	(python-shell-completion-string-code)
	(python-shell-enable-font-lock, python-shell-exec-path)
	(python-shell-extra-pythonpaths)
	(python-shell-internal-buffer-name, python-shell-interpreter-args)
	(python-shell-process-environment)
	(python-shell-prompt-block-regexp)
	(python-shell-prompt-output-regexp)
	(python-shell-prompt-pdb-regexp, python-shell-prompt-regexp)
	(python-shell-send-setup-max-wait, python-shell-setup-codes)
	(python-shell-virtualenv-path): New defcustoms.
	(brm-menu, eldoc-documentation-function, inferior-python-mode-map)
	(inferior-python-mode-syntax-table, python--prompt-regexp)
	(python-buffer, python-command python-python-command)
	(python-default-template, python-imports, python-indent-index)
	(python-indent-list, python-indent-list-length)
	(python-mode-running, python-pdbtrack-is-tracking-p)
	(python-preoutput-continuation, python-preoutput-leftover)
	(python-preoutput-result, python-preoutput-skip-next-prompt)
	(python-prev-dir/file, python-recursing)
	(python-saved-check-command, python-version-checked)
	(python-which-func-length-limit)
	(view-return-to-alist): Delete vars.
	(python-check-custom-command, python-dotty-syntax-table)
	(python-imenu-index-alist, python-indent-current-level)
	(python-indent-dedenters, python-indent-levels)
	(python-nav-beginning-of-defun-regexp)
	(python-nav-list-defun-positions-cache)
	(python-pdbtrack-buffers-to-kill, python-pdbtrack-tracked-buffer)
	(python-shell-internal-buffer)
	(python-skeleton-available): New vars.
	(def-python-skeleton): Delete macro.
	(python-skeleton-define): New macro.
	(python-define-auxiliary-skeleton, python-rx): New macros.
	(python-insert-class): Delete command.
	(python-skeleton-class): New command.
	(python-insert-def): Delete command.
	(python-skeleton-def): New command.
	(python-insert-for): Delete command.
	(python-skeleton-for): New command.
	(python-insert-if): Delete command.
	(python-skeleton-if): New command.
	(python-insert-try/except, python-insert-try/finally): Delete commands.
	(python-skeleton-try): New command.
	(python-insert-while): Delete command.
	(python-skeleton-while): New command.
	(python-backspace): Delete command.
	(python-indent-dedent-line-backspace): New command.
	(python-electric-colon): Delete command.
	(python-indent-electric-colon): New command.
	(python-guess-indent): Delete command.
	(python-indent-guess-indent-offset): New command.
	(python-shift-left): Delete command.
	(python-indent-shift-left): New command.
	(python-shift-right): Delete command.
	(python-indent-shift-right): New command.
	(python-find-function): Delete command.
	(python-nav-jump-to-defun): New command.
	(python-next-statement): Delete command.
	(python-nav-forward-sentence): New command.
	(python-previous-statement): Delete command.
	(python-nav-backward-sentence): New command.
	(python-fill-paragraph): Delete command.
	(python-fill-paragraph-function): New command.
	(python-send-buffer): Delete command.
	(python-shell-send-buffer): New command.
	(python-send-defun): Delete command.
	(python-shell-send-defun): New command.
	(python-send-region, python-send-region-and-go): Delete commands.
	(python-shell-send-region)
	(python-shell-switch-to-shell): New commands.
	(python-send-string): Delete command.
	(python-shell-send-string): New command.
	(python-switch-to-python): Delete command.
	(python-shell-switch-to-shell): New command.
	(python-describe-symbol): Delete command.
	(python-eldoc-at-point): New command.
	(python--set-prompt-regexp, python-args-to-list)
	(python-after-info-look, python-check-version)
	(python-check-comint-prompt, python-find-imports)
	(python-execute-file, turn-off-pdbtrack, turn-on-pdbtrack)
	(python-unload-function, python-expand-template)
	(python-maybe-jython, python-preoutput-filter)
	(python-pdbtrack-get-source-buffer)
	(python-pdbtrack-grub-for-buffer, python-pdbtrack-overlay-arrow)
	(python-pdbtrack-toggle-stack-tracking)
	(python-pdbtrack-track-stack-file, python-initial-text)
	(python-first-word, python-comment-line-p, python-send-command)
	(python-setup-brm, python-sentinel, python-set-proc)
	(python-skip-out, python-input-filter, python-outdent-p)
	(python-outline-level, python-backslash-continuation-line-p)
	(python-end-of-block, python-end-of-statement, python-mark-block)
	(python-beginning-of-block, python-beginning-of-statement)
	(python-blank-line-p, python-beginning-of-string)
	(python-open-block-statement-p): Delete functions.
	(python-indent-line, python-indent-line-1): Delete functions.
	(python-indent-line): New function.
	(python-indentation-levels): Delete function.
	(python-indent-calculate-levels): New function.
	(python-proc): Delete function.
	(python-shell-get-process): New function.
	(python-send-receive): Delete function.
	(python-shell-send-string-no-output): New function.
	(python-module-path): Delete function.
	(python-ffap-module-path): New function.
	(python-completion-at-point)
	(python-symbol-completions): Delete functions.
	(python-completion-complete-at-point): New function.
	(python-load-file): Delete function.
	(python-shell-send-file): New function.
	(python-calculate-indentation): Delete function.
	(python-indent-calculate-indentation): New function.
	(python-skip-comments/blanks): Delete function.
	(python-util-forward-comment): New function.
	(python-continuation-line-p): Delete function.
	(python-info-continuation-line-p): New function.
	(python-which-func, python-current-defun): Delete function.
	(python-info-current-defun): New function.
	(python-beginning-of-defun): Delete function.
	(python-nav-beginning-of-defun): New function.
	(python-close-block-statement-p)
	(python-block-end-p): Delete function.
	(python-info-closing-block): New function.
	(python-comint-output-filter-function)
	(python-eldoc--get-doc-at-point, python-end-of-defun-function)
	(python-fill-comment, python-fill-decorator, python-fill-paren)
	(python-fill-string, python-imenu-make-element-tree)
	(python-imenu-make-tree, python-imenu-tree-assoc)
	(python-indent-context, python-indent-dedent-line)
	(python-indent-line-function)
	(python-indent-post-self-insert-function)
	(python-indent-toggle-levels)
	(python-info-assignment-continuation-line-p)
	(python-info-beginning-of-backlash)
	(python-info-block-continuation-line-p)
	(python-info-closing-block-message)
	(python-info-line-ends-backslash-p)
	(python-info-looking-at-beginning-of-defun)
	(python-info-ppss-context, python-info-ppss-context-type)
	(python-nav-list-defun-positions, python-nav-read-defun)
	(python-nav-sentence-end, python-nav-sentence-start)
	(python-pdbtrack-comint-output-filter-function)
	(python-pdbtrack-set-tracked-buffer)
	(python-shell-calculate-exec-path)
	(python-shell-calculate-process-environment)
	(python-shell-completion--do-completion-at-point)
	(python-shell-completion--get-completions)
	(python-shell-completion-complete-at-point)
	(python-shell-completion-complete-or-indent)
	(python-shell-get-or-create-process)
	(python-shell-get-process-name)
	(python-shell-internal-get-or-create-process)
	(python-shell-internal-get-process-name)
	(python-shell-internal-send-string, python-shell-make-comint)
	(python-shell-parse-command, python-shell-send-setup-code)
	(python-skeleton-add-menu-items)
	(python-util-clone-local-variables, python-util-position)
	(run-python-internal, python-indentation-levels)
	(python-nav-beginning-of-defun)
	(python-completion-complete-at-point): New functions.
	(run-python): Change arguments.  New API requirements.

2012-06-15  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/cl-lib.el (cl--defsubst-expand): Autoload inliner
	(bug#11649).

	* emacs-lisp/macroexp.el (macroexp--compiler-macro): New function.
	(macroexp--expand-all): Use it.

	* emacs-lisp/cl-macs.el (cl--transform-function-property): Remove.
	(cl-define-setf-expander, cl-deftype, cl-define-compiler-macro):
	Use `cl-function' instead.

2012-06-14  Juanma Barranquero  <lekktu@gmail.com>

	* makefile.w32-in (COMPILE_FIRST): Remove subr.el.
	Suggested by Stefan Monnier while discussing bug#11657.

2012-06-14  Sam Steingold  <sds@gnu.org>

	* files.el (abort-if-file-too-large): Use `file-size-human-readable'.

2012-06-14  Andreas Schwab  <schwab@linux-m68k.org>

	* play/doctor.el (doctor-doc): Remove parameter and use
	doctor-sent instead of sent.
	(doctor-read-print): Use doctor-sent instead of sent.  (Bug#11708)

2012-06-13  Stefan Monnier  <monnier@iro.umontreal.ca>

	* files.el: Require cl-lib.
	(file-name-non-special): Replace case -> cl-case.

	* emacs-lisp/cl-macs.el (cl-defstruct): Don't add print-func.

	* emacs-lisp/edebug.el (edebug-read-function): Remove old incorrect
	mapping from #' to function*.

2012-06-13  Chong Yidong  <cyd@gnu.org>

	* mouse.el (mouse-drag-track): Do not set the mark if the user
	releases the mouse without selecting anything (Bug#11588).

2012-06-13  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/tex-mode.el (latex-indent): Recognize tex-verbatim at EOB
	as well (bug#11646).

	* loadup.el: Count byte-code functions as well.

	* emacs-lisp/byte-opt.el (featurep): Move compiler-macro...
	* emacs-lisp/bytecomp.el (featurep): ...here (bug#11692).

	* emacs-lisp/autoload.el (make-autoload): Accept nil doc-string-elt
	(bug#11649).  Add cl-defun and cl-defmacro.

2012-06-13  Drew Adams  <drew.adams@oracle.com>

	* help-mode.el (help-bookmark-make-record, help-bookmark-jump):
	Fix last change.

2012-06-13  Michael Albinus  <michael.albinus@gmx.de>

	* net/dbus.el (dbus-call-method): Use timeout for `read-event'.
	Otherwise, it blocks in batch mode.

2012-06-13  Juanma Barranquero  <lekktu@gmail.com>

	* help-mode.el (bookmark-make-record-default): Declare.

2012-06-13  Chong Yidong  <cyd@gnu.org>

	* emacs-lisp/package.el (list-packages): Compute a list of
	packages that are newly-available since the last list-packages
	invocation.
	(package-menu--new-package-list): New var.
	(package-menu--generate, package-menu--print-info)
	(package-menu--status-predicate, package-menu-mark-install):
	Handle new status label "new".

2012-06-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/cl-macs.el (cl-remf): Fix error in recent
	conversion to backquotes.

2012-06-12  Chong Yidong  <cyd@gnu.org>

	* emacs-lisp/edebug.el (edebug-inhibit-emacs-lisp-mode-bindings):
	Rename from gud-inhibit-global-bindings.

	* emacs-lisp/eieio.el (eieio-pre-method-execution-hooks): Doc fix.

	* nxml/nxml-glyph.el (nxml-glyph-set-functions): Rename abnormal
	hook from nxml-glyph-set-hook.

	* progmodes/cwarn.el (cwarn-mode): Remove redundant variable
	declaration.

	* progmodes/pascal.el (pascal-toggle-completions): Doc fix.

	* textmodes/bibtex.el (bibtex-string-file-path, bibtex-file-path):
	Convert to defcustom.

2012-06-12  Drew Adams  <drew.adams@oracle.com>

	* help-mode.el (help-bookmark-make-record, help-bookmark-jump):
	New functions.
	(help-mode): Use them.

2012-06-11  Glenn Morris  <rgm@gnu.org>

	* progmodes/fortran.el (fortran-font-lock-keywords-3):
	Use preprocessor face for directives.
	(fortran-directive-re): Doc fix.

2012-06-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/cl-macs.el (cl-parse-loop-clause): Fix error in recent
	conversion to backquotes (bug#11652).

	Fix compiler-expansion of CL's cXXr functions (bug#11673).
	* emacs-lisp/cl-lib.el (cl--defalias): New function.
	(cl-values, cl-values-list, cl-copy-seq, cl-svref, cl-first)
	(cl-second, cl-rest, cl-endp, cl-third, cl-fourth): Use it.
	(cl-plusp, cl-minusp, cl-fifth, cl-sixth, cl-seventh, cl-eighth)
	(cl-ninth, cl-tenth): Mark them as inlinable.
	(cl-caaar, cl-caadr, cl-cadar, cl-caddr, cl-cdaar, cl-cdadr)
	(cl-cddar, cl-cdddr, cl-caaaar, cl-caaadr, cl-caadar, cl-caaddr)
	(cl-cadaar, cl-cadadr, cl-caddar, cl-cadddr, cl-cdaaar, cl-cdaadr)
	(cl-cdadar, cl-cdaddr, cl-cddaar, cl-cddadr, cl-cdddar, cl-cddddr):
	Add a compiler-macro declaration to use cl--compiler-macro-cXXr.
	(cl-list*, cl-adjoin): Don't put an autoload manually.
	* emacs-lisp/cl-macs.el (cl--compiler-macro-adjoin)
	(cl--compiler-macro-list*): Add autoload cookie.
	(cl--compiler-macro-cXXr): New function.

	* help-fns.el (help-fns--compiler-macro): New function extracted from
	describe-function-1; follow aliases and use `compiler-macro' property.
	(describe-function-1): Use it.

2012-06-11  Chong Yidong  <cyd@gnu.org>

	* startup.el (fancy-splash-head): Use splash.svg even if librsvg
	is uninstalled, if imagemagick is installed.

2012-06-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/cl-lib.el: Use lexical-binding.
	(cl-map-extents, cl-maclisp-member): Remove.
	(cl--set-elt, cl--set-nthcdr, cl--set-buffer-substring)
	(cl--set-substring, cl--block-wrapper, cl--block-throw)
	(cl--compiling-file, cl--mapcar-many, cl--do-subst): Use "cl--" prefix.
	* emacs-lisp/cl-extra.el: Use lexical-binding.
	(cl--mapcar-many, cl--map-keymap-recursively, cl--map-intervals)
	(cl--map-overlays, cl--set-frame-visible-p, cl--progv-save)
	(cl--progv-before, cl--progv-after, cl--finite-do, cl--set-getf)
	(cl--do-remf, cl--do-prettyprint): Use "cl--" prefix.
	* emacs-lisp/cl-seq.el: Use lexical-binding.
	(cl--parsing-keywords, cl--check-key, cl--check-test-nokey)
	(cl--check-test, cl--check-match): Use "cl--" prefix and backquotes.
	(cl--alist, cl--sublis-rec, cl--nsublis-rec, cl--tree-equal-rec):
	* emacs-lisp/cl-macs.el (cl--lambda-list-keywords): Use "cl--" prefix.
	* edmacro.el (edmacro-mismatch): Simplify to remove dependence on
	CL's internals.

2012-06-11  Michael Albinus  <michael.albinus@gmx.de>

	Sync with Tramp 2.2.6-pre.

	* net/tramp-cache.el (tramp-dump-connection-properties): Let-bind
	`print-length' and `print-level' to nil, in order to avoid
	truncation.  Reported by Christopher Schmidt
	<christopher@ristopher.com>.

	* net/tramp-cmds.el (tramp-cleanup-connection): Delete also process.

	* net/tramp-compat.el (tramp-compat-condition-case-unless-debug):
	New defmacro.
	(tramp-compat-copy-directory): Add optional argument
	COPY-CONTENTS.  It is not handled yet.

	* net/tramp-ftp.el (tramp-disable-ange-ftp): Fix docstring.
	(tramp-ftp-file-name-p): Simplify.

	* net/tramp-gvfs.el (tramp-gvfs-handle-expand-file-name):
	* net/tramp-gw.el (tramp-gw-open-connection): Add hop to
	connection vector.

	* net/tramp-sh.el (tramp-copy-size-limit): Fix docstring.
	(tramp-methods): Do not use `tramp-password-end-of-line'.
	(tramp-completion-function-alist-putty): Handle UNIX case.
	(tramp-remote-path): Add "/opt/bin", "/opt/sbin" and "/opt/local/bin".
	(tramp-do-file-attributes-with-stat)
	(tramp-do-directory-files-and-attributes-with-stat) Return uid and
	gid as real numbers.  They could run out of integer range on cygwin.
	(tramp-do-copy-or-rename-file-out-of-band): Better trace format.
	(tramp-sh-handle-expand-file-name): Handle hops.
	(tramp-open-connection-setup-interactive-shell):
	Use `tramp-cleanup'.  Move check for busyboxes ...
	(tramp-find-shell): ... here.  Simplify implementation.
	Set "remote-shell" property also for alternative shells.
	(tramp-remote-coding-commands): Check "test -c /dev/stdout".
	If failing, a regular file would be written otherwise.
	Reported by Dmitry Kurochkin <dmitry.kurochkin@gmail.com>.
	(tramp-find-inline-encoding): Cache the coding commands in the
	process cache.  Apply test command on the remote side, if defined.
	(tramp-find-inline-compress): Cache the compress commands in the
	process cache.
	(tramp-compute-multi-hops): Save `tramp-default-proxies-alist'
	when requested.  Handle hops.
	(tramp-current-connection): New defvar.
	(tramp-maybe-open-connection): Use `tramp-cleanup'.
	Throw `suppress', if there was a failed connection shortly before.
	Handle user interrupt.  (Bug#10187)
	(tramp-get-inline-compress, tramp-get-inline-coding):
	Read connection properties from the process cache.

	* net/tramp-smb.el (tramp-smb-server-version)
	(tramp-smb-wrong-passwd-regexp, tramp-smb-actions-with-tar):
	New defconsts.
	(tramp-smb-prompt): Extend for powershell prompt.
	(tramp-smb-file-name-handler-alist): Add handlers for
	`process-file', `shell-command' and `start-file-process'.
	(tramp-smb-winexe-program, tramp-smb-winexe-shell-command)
	(tramp-smb-winexe-shell-command-switch): New defcustoms.
	(tramp-smb-file-name-p): Simplify.
	(tramp-smb-action-with-tar, tramp-smb-handle-process-file)
	(tramp-smb-kill-winexe-function, tramp-smb-call-winexe)
	(tramp-smb-shell-quote-argument): New defuns.
	(tramp-smb-handle-copy-directory): Add COPY-CONTENTS argument.
	Implement using "tar".  By this, time-stamps are preserved.
	(tramp-smb-handle-copy-file): Handle also the case of directories.
	(tramp-smb-do-file-attributes-with-stat)
	(tramp-smb-get-file-entries, tramp-smb-get-cifs-capabilities):
	Use `tramp-get-connection-buffer').
	(tramp-smb-handle-rename-file): Use "rename", when source and
	target are on the same share.
	(tramp-smb-maybe-open-connection): Handle wrong passwords.
	Use `tramp-smb-server-version'.
	(tramp-smb-wait-for-output): Remove prompt.

	* net/tramp.el (top): Require 'cl.
	(tramp-methods, tramp-rsh-end-of-line):
	Remove `tramp-password-end-of-line' from docstring.
	(tramp-save-ad-hoc-proxies): New defcustom.
	(tramp-completion-function-alist): Adapt docstring.
	(tramp-default-password-end-of-line): Remove defcustom.
	(tramp-shell-prompt-pattern): Allow "[]" style prompts.  (Bug#11065)
	(tramp-user-regexp, tramp-file-name-regexp-unified)
	(tramp-file-name-regexp-url): Extend regexp by hop separator.
	(tramp-postfix-hop-format, tramp-postfix-hop-regexp)
	(tramp-remote-file-name-spec-regexp): New defconst.
	(tramp-file-name-structure): Extend structure for hops.
	(tramp-get-method-parameter): Move up.
	(tramp-file-name-p, tramp-dissect-file-name)
	(with-parsed-tramp-file-name): Handle hops.
	(tramp-file-name-hop): New defun.
	(tramp-make-tramp-file-name): New optional arg HOP.
	(tramp-message-show-progress-reporter-message): New defvar.
	(tramp-with-progress-reporter): Use it.  We cannot use
	`tramp-message-show-message' here, because this suppresses also
	error buffers.
	(tramp-error-with-buffer): Suppress buffer view, if
	`tramp-message-show-message' is nil.
	Use `tramp-get-connection-buffer'.
	(tramp-cleanup): New defun.
	(tramp-rfn-eshadow-update-overlay): Let-bind `non-essential' to `t'.
	(tramp-file-name-handler): If `debug-on-error' is set, propagate
	an error unchanged.
	(tramp-completion-handle-file-name-all-completions): Handle hops.
	Fix an error when called from ido.
	(tramp-completion-dissect-file-name): Use better local variable
	name.  Add hop to the vector.
	(tramp-handle-insert-file-contents): Use progress-reporter for the
	whole scenario.
	(tramp-action-password): Let-bind `enable-recursive-minibuffers'
	to `t'.
	(tramp-check-for-regexp): Simplify search.
	(tramp-enter-password): Remove it.  Move implementation ...
	(tramp-action-password): ... here.
	(tramp-mode-string-to-int, tramp-local-host-p)
	(tramp-make-tramp-temp-file, tramp-read-passwd)
	(tramp-clear-passwd, tramp-time-less-p, tramp-time-diff):
	Set tramp-autoload cookie.

	* net/trampver.el: Update release number.

2012-06-11  Thierry Volpiatto  <thierry.volpiatto@gmail.com>
	    Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-set-completion-function): Fix docstring.
	(tramp-parse-group, tramp-parse-file)
	(tramp-parse-shostkeys-sknownhosts): New defuns.
	(tramp-parse-rhosts, tramp-parse-rhosts-group, tramp-parse-shosts)
	(tramp-parse-shosts-group, tramp-parse-sconfig)
	(tramp-parse-sconfig-group, tramp-parse-shostkeys)
	(tramp-parse-sknownhosts, tramp-parse-hosts)
	(tramp-parse-hosts-group, tramp-parse-passwd, tramp-parse-netrc):
	Use them.
	(tramp-parse-passwd-group, tramp-parse-netrc-group)
	(tramp-parse-putty-group): Don't narrow.
	(tramp-parse-putty): Make a loop.
	(tramp-file-name-handler): Catch the `suppress' signal.

2012-06-11  Chong Yidong  <cyd@gnu.org>

	* image.el (imagemagick-register-types): Put the ImageMagick entry
	at the end of image-type-file-name-regexps.

2012-06-11  Johan Bockgård  <bojohan@gnu.org>

	* emacs-lisp/pcase.el (pcase-UPAT, pcase-QPAT): New edebug specs.
	(pcase, pcase-let*, pcase-dolist): Use them.

2012-06-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/pcase.el (pcase--let*): New function.
	(pcase-let*): Use it.  Use pcase--memoize to avoid repeated expansions.
	(pcase--expand): Use macroexp-let².

2012-06-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/timer.el, emacs-lisp/syntax.el, emacs-lisp/smie.el:
	* emacs-lisp/ewoc.el, emacs-lisp/cconv.el, emacs-lisp/bytecomp.el:
	* emacs-lisp/byte-opt.el, emacs-lisp/autoload.el: Convert to cl-lib.
	* emacs-lisp/easymenu.el, emacs-lisp/easy-mmode.el:
	* emacs-lisp/derived.el: Use pcase instead of `cl'.
	* emacs-lisp/cl-lib.el: Get rid of special cl-macs auto load.

2012-06-10  Glenn Morris  <rgm@gnu.org>

	* mail/rmail.el (rmail-yank-current-message): Leave point at
	correct position.  (Bug#11660)

2012-06-10  Chong Yidong  <cyd@gnu.org>

	* allout-widgets.el: Fix code header.

2012-06-10  Chong Yidong  <cyd@gnu.org>

	* cus-edit.el (customize-changed-options-previous-release):
	Bump to 24.1.

2012-06-09  Andreas Schwab  <schwab@linux-m68k.org>

	* Makefile.in (BIG_STACK_DEPTH): Enlarge to 2200.

2012-06-09  Chong Yidong  <cyd@gnu.org>

	* ebuff-menu.el (electric-buffer-list): Preserve header line.

2012-06-09  Martin Rudalics  <rudalics@gmx.at>

	* window.el (special-display-popup-frame): Don't use
	window--display-buffer (Bug#11651).

2012-06-09  Eli Zaretskii  <eliz@gnu.org>

	Fix parallel builds: make sure loaddefs.el is not being written
	while Lisp files are compiled.
	(compile): Don't depend on 'mh-autoloads'.
	(compile-CMD, compile-SH): Depend on 'autoloads'.
	(bootstrap): Don't depend on 'autoloads' and 'mh-autoloads'.

	* makefile.w32-in (BIG_STACK_DEPTH): Enlarge to 2200.  (Bug#11649)

2012-06-09  Chong Yidong  <cyd@gnu.org>

	* face-remap.el (face-remap-add-relative, face-remap-set-base)
	(buffer-face-set, buffer-face-toggle, buffer-face-mode-invoke):
	Doc fixes (Bug#11225).

2012-06-09  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/macroexp.el (macroexp--expand-all): Only autoload
	a function if there's a clear indication that it has a compiler-macro.
	* emacs-lisp/byte-run.el (defun-declarations-alist, defmacro, defun)
	(macro-declarations-alist): Add arglist to declaration functions.
	(defun-declarations-alist): Add `obsolete' and `compiler-macro'.
	* emacs-lisp/cl-seq.el (cl-member, cl-assoc):
	* emacs-lisp/cl-lib.el (cl-list*, cl-adjoin):
	* emacs-lisp/cl-extra.el (cl-get): Use the new `declare' statement.
	Also add autoload to find the compiler macro.
	* emacs-lisp/cl-macs.el (eql) [compiler-macro]: Remove.
	(cl--compiler-macro-member, cl--compiler-macro-assoc)
	(cl--compiler-macro-adjoin, cl--compiler-macro-list*)
	(cl--compiler-macro-get): New functions, replacing calls to
	cl-define-compiler-macro.
	(cl-typep) [compiler-macro]: Use macroexp-let².

2012-06-08  Nick Dokos  <nicholas.dokos@hp.com>  (tiny change)

	* calendar/icalendar.el (icalendar--parse-vtimezone): Import TZID
	string properly, fixes Bug#11473.

2012-06-08  Chong Yidong  <cyd@gnu.org>

	* faces.el (set-face-attribute): Doc fix.
	(modify-face): Don't use :bold and :italic.
	(error, warning, success): Tweak definitions.

	* cus-edit.el (custom-modified, custom-invalid, custom-rogue)
	(custom-modified, custom-set, custom-changed, custom-themed)
	(custom-saved, custom-button, custom-button-mouse)
	(custom-button-pressed, custom-state, custom-comment-tag)
	(custom-variable-tag, custom-group-tag-1, custom-group-tag)
	(custom-group-subtitle): Use new-style face specs.
	(custom-invalid-face, custom-rogue-face, custom-modified-face)
	(custom-set-face, custom-changed-face, custom-saved-face)
	(custom-button-face, custom-button-pressed-face)
	(custom-documentation-face, custom-state-face)
	(custom-comment-face, custom-comment-tag-face)
	(custom-variable-tag-face, custom-variable-button-face)
	(custom-face-tag-face, custom-group-tag-face-1)
	(custom-group-tag-face): Remove obsolete face alias.

	* epa.el (epa-validity-high, epa-validity-medium)
	(epa-validity-low, epa-mark, epa-field-name, epa-string)
	(epa-field-name, epa-field-body):
	* font-lock.el (font-lock-comment-face, font-lock-string-face)
	(font-lock-keyword-face, font-lock-builtin-face)
	(font-lock-function-name-face, font-lock-variable-name-face)
	(font-lock-type-face, font-lock-constant-face):
	* ido.el (ido-first-match, ido-only-match, ido-subdir)
	(ido-virtual, ido-indicator, ido-incomplete-regexp):
	* speedbar.el (speedbar-button-face, speedbar-file-face)
	(speedbar-directory-face, speedbar-tag-face)
	(speedbar-selected-face, speedbar-highlight-face)
	(speedbar-separator-face):
	* whitespace.el (whitespace-newline, whitespace-space)
	(whitespace-hspace, whitespace-tab, whitespace-trailing)
	(whitespace-line, whitespace-space-before-tab)
	(whitespace-space-after-tab, whitespace-indentation)
	(whitespace-empty):
	* emulation/cua-base.el (cua-global-mark):
	* eshell/em-prompt.el (eshell-prompt):
	* net/newst-plainview.el (newsticker-new-item-face)
	(newsticker-old-item-face, newsticker-immortal-item-face)
	(newsticker-obsolete-item-face, newsticker-date-face)
	(newsticker-statistics-face, newsticker-default-face):
	* net/newst-reader.el (newsticker-feed-face)
	(newsticker-extra-face, newsticker-enclosure-face):
	* net/newst-treeview.el (newsticker-treeview-face)
	(newsticker-treeview-new-face, newsticker-treeview-old-face)
	(newsticker-treeview-immortal-face)
	(newsticker-treeview-obsolete-face)
	(newsticker-treeview-selection-face):
	* net/rcirc.el (rcirc-my-nick, rcirc-other-nick)
	(rcirc-bright-nick, rcirc-server, rcirc-timestamp)
	(rcirc-nick-in-message, rcirc-nick-in-message-full-line)
	(rcirc-prompt, rcirc-track-keyword, rcirc-url, rcirc-keyword):
	* nxml/nxml-outln.el (nxml-heading, nxml-outline-indicator)
	(nxml-outline-active-indicator, nxml-outline-ellipsis):
	* play/mpuz.el (mpuz-unsolved, mpuz-solved, mpuz-trivial)
	(mpuz-text):
	* progmodes/vera-mode.el (vera-font-lock-number)
	(vera-font-lock-function, vera-font-lock-interface):
	* textmodes/table.el (table-cell): Use new-style face specs, and
	don't use the old :bold and :italic attributes.

	* progmodes/ebrowse.el (ebrowse-tree-mark, ebrowse-root-class)
	(ebrowse-member-attribute, ebrowse-default, ebrowse-file-name)
	(ebrowse-member-class, ebrowse-progress): Likewise.
	(ebrowse-tree-mark-face, ebrowse-root-class-face)
	(ebrowse-file-name-face, ebrowse-default-face)
	(ebrowse-member-attribute-face, ebrowse-member-class-face)
	(ebrowse-progress-face): Remove obsolete faces.

	* progmodes/flymake.el (flymake-errline, flymake-warnline):
	Inherit from error and warning faces respectively.

	* textmodes/flyspell.el (flyspell-incorrect, flyspell-duplicate):
	Likewise.
	(flyspell-incorrect-face, flyspell-duplicate-face):
	Remove obsolete aliases.

2012-06-08  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-compat.el (tramp-compat-temporary-file-directory):
	Avoid infloop.

2012-06-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* startup.el (argv, argi): Make lexically scoped.
	* emacs-lisp/float-sup.el (pi): Use internal-make-var-non-special.
	* emacs-lisp/cl-macs.el: Use lexical-binding.
	Rename cl-bind-* to cl--bind-*.
	* files.el: Don't require `cl' since it doesn't use it.
	* emacs-lisp/pcase.el, emacs-lisp/macroexp.el: Add coding cookie.

2012-06-08  Juanma Barranquero  <lekktu@gmail.com>

	* textmodes/texinfmt.el: Fix bug#11640 (reverts part of 2008-07-31T05:33:56Z!dann@ics.uci.edu).
	(texinfo-format-printindex): Use `texinfo-sort-region' in all platforms,
	instead of calling external sort utility.
	(texinfo-sort-region, texinfo-sort-startkeyfun): Restore functions.

2012-06-08  Eli Zaretskii  <eliz@gnu.org>

	* descr-text.el (describe-char): Mention how to insert the
	character, if the current input method doesn't support it.
	See the discussion in this thread for the details:
	https://lists.gnu.org/r/emacs-devel/2012-05/msg00533.html.

2012-06-08  Sam Steingold  <sds@gnu.org>

	* bindings.el (global-map): Bind XF86Forward to next-buffer and
	XF86Back to previous-buffer.
	(minibuffer-local-map): Bind them to next-history-element and
	previous-history-element respectively.
	* help-mode.el (help-mode-map): Bind them to help-go-forward and
	help-go-back respectively.
	* info.el (Info-mode-map): Bind them to Info-history-forward and
	Info-history-back respectively.
	These are the keys next to Up on the ThinkPad keyboard.

2012-06-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	Get rid of cl-lexical-let, keeping only lexical-let for compatibility.
	* emacs-lisp/cl-macs.el: Provide itself.
	(cl--labels-convert-cache): New var.
	(cl--labels-convert): New function.
	(cl-flet, cl-labels): New implementation with new semantics, relying on
	lexical-binding.
	* emacs-lisp/cl.el: Mark compatibility aliases as obsolete.
	(cl-closure-vars, cl--function-convert-cache)
	(cl--function-convert): Move from cl-macs.el.
	(lexical-let, lexical-let*, flet, labels): Move from cl-macs.el and
	rename by removing the "cl-" prefix.
	* emacs-lisp/macroexp.el (macroexp-unprogn): New function.

2012-06-07  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/cl.el (cl-macroexpand, cl-macro-environment)
	(cl-macroexpand-all, cl-not-hash-table, cl-builtin-gethash)
	(cl-builtin-remhash, cl-builtin-clrhash, cl-builtin-maphash)
	(cl-map-keymap, cl-copy-tree, cl-gethash, cl-puthash, cl-remhash)
	(cl-clrhash, cl-maphash, cl-make-hash-table, cl-hash-table-p)
	(cl-hash-table-count): Add old compatibility aliases.

	* emacs-lisp/cl-macs.el (cl-macro-environment): Remove var.
	Use macroexpand-all-environment instead.
	(cl--old-macroexpand): New var.
	(cl--sm-macroexpand): New function.
	(cl-symbol-macrolet): Use it during macro expansion.
	(cl--function-convert-cache): New var.
	(cl--function-convert): New function, extracted from
	cl-macroexpand-all.
	(cl-lexical-let): Use it.

	* emacs-lisp/cl-lib.el (cl-macro-environment): Remove decl.
	(cl-macroexpand): Move to cl-macs.el and rename to cl--sm-macroexpand.
	(cl-member): Remove old alias.

	* emacs-lisp/cl-extra.el (cl-map-keymap, cl-copy-tree)
	(cl-not-hash-table, cl-builtin-gethash, cl-builtin-remhash)
	(cl-builtin-clrhash, cl-builtin-maphash, cl-gethash, cl-puthash)
	(cl-remhash, cl-clrhash, cl-maphash, cl-make-hash-table)
	(cl-hash-table-p, cl-hash-table-count): Move to cl.el.
	(cl-macroexpand-cmacs): Remove var.
	(cl-macroexpand-all, cl-macroexpand-body): Remove funs.
	Use macroexpand-all instead.

2012-06-07  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/macroexp.el (macroexp-progn, macroexp-let*, macroexp-if)
	(macroexp-let², macroexp--const-symbol-p, macroexp-const-p)
	(macroexp-copyable-p): New functions and macros.
	* emacs-lisp/edebug.el (edebug-unwrap):
	* emacs-lisp/disass.el (disassemble-internal): Use macroexp-progn.
	* emacs-lisp/pcase.el: Use macroexp-let*, macroexp-if, ...
	(pcase--let*): Remove.
	* emacs-lisp/bytecomp.el (byte-compile-const-symbol-p)
	(byte-compile-constp): Remove.  Use macroexp--const-symbol-p and
	macroexp-const-p instead.
	* emacs-lisp/byte-opt.el: Use macroexp-const-p and macroexp-progn.

	* emacs-lisp/cl-macs.el: Clean up the name space by using "cl--"
	instead of "cl-" for internal definitions.  Use macroexp-const-p.
	(cl-old-bc-file-form): Remove var.
	(cl-const-exprs-p): Remove fun.
	(cl-labels, cl-macrolet): Use backquote.
	(cl-lexical-let): Use cl-symbol-macrolet.  Don't use cl-defun-expander.
	(cl-defun-expander, cl-byte-compile-compiler-macro): Remove fun.
	(cl-define-setf-expander): Rename from cl-define-setf-method.
	* emacs-lisp/cl.el: Adjust alias for define-setf-method.

	* international/mule-cmds.el: Don't require CL.
	(view-hello-file): Don't use `letf'.

2012-06-07  Stefan Monnier  <monnier@iro.umontreal.ca>

	* tmm.el (tmm-prompt): Use string-prefix-p.
	(tmm-completion-delete-prompt): Don't affect current-buffer outside.
	(tmm-add-prompt): Use minibuffer-completion-help.
	(tmm-delete-map): Remove.

	* subr.el (kbd): Make it its own function.

2012-06-07  Stefan Merten  <smerten@oekonux.de>

	* textmodes/rst.el: Use `eval-when-compile' for requiring `cl.el'.
	Silence compiler warnings.  Fix versions.
	(rst-position-if, rst-position, rst-some, rst-signum): New functions.
	(rst-shift-region, rst-adornment-level, rst-compute-tabs)
	(rst-indent-line, rst-shift-region, rst-forward-line): Use them.
	(rst-package-emacs-version-alist): Correct Emacs version to
	represent major merge with upstream.
	(rst-transition, rst-adornment, rst-compile-toolsets): Fix versions.

2012-06-06  Glenn Morris  <rgm@gnu.org>

	* mail/emacsbug.el (report-emacs-bug): Add relevant EMACS env-vars.
	Only print environment variables if set.

2012-06-06  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/macroexp.el: Don't require CL since we don't use it.
	(macroexp--cons): Rename from maybe-cons.
	(macroexp--accumulate): Rename from macroexp-accumulate.
	(macroexp--all-forms): Rename from macroexpand-all-forms.
	(macroexp--all-clauses): Rename from macroexpand-all-clauses.
	(macroexp--expand-all): Rename from macroexpand-all-1.

2012-06-06  Sam Steingold  <sds@gnu.org>

	* calendar/calendar.el (calendar-in-read-only-buffer):
	Call `special-mode' to enable the standard read-only keybindings.

2012-06-06  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/macroexp.el (macroexpand-all-1): Don't spam the output
	with "loading" messages (bug#11635).

2012-06-06  Michael Albinus  <michael.albinus@gmx.de>

	* files.el (enable-remote-dir-locals): New option.
	(hack-dir-local-variables): Use it.  (Bug#1933, Bug#6731)

	* net/tramp-compat.el (tramp-compat-temporary-file-directory):
	Ensure, that the temp directory is local.

	* net/tramp-sh.el (tramp-sh-handle-write-region): Let-bind
	`temporary-file-directory'.

	* progmodes/python.el (python-send-region): Ensure, that the
	temporary file is created also in the remote case.

2012-06-06  Glenn Morris  <rgm@gnu.org>

	* vc/vc-rcs.el (vc-rcs-rcs2log-program): New.
	(vc-rcs-update-changelog): Use it.

	* emacs-lisp/authors.el (authors-fixed-entries): Remove vcdiff.

	* vc/vc-sccs.el (vc-sccs-write-revision): New function.
	(vc-sccs-workfile-unchanged-p): Use vc-sccs-write-revision.
	(vc-sccs-diff): Replace use of the external vcdiff script.

2012-06-05  Glenn Morris  <rgm@gnu.org>

	* ledit.el: Move to obsolete/.

2012-06-05  Sam Steingold  <sds@gnu.org>

	* calendar/calendar.el (calendar-exit): Reinstate the 2012-03-28
	patch (Bug#11140).

2012-06-05  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/cust-print.el: Move to obsolete.

	* emacs-lisp/macroexp.el (macroexpand-all-1): Tolerate errors during
	compiler-macro expansion.

	Add native compiler-macro support.
	* emacs-lisp/macroexp.el (macroexpand-all-1):
	Support compiler-macros directly.  Properly follow aliases and apply
	the compiler macros more thoroughly.
	* emacs-lisp/cl.el: Don't copy compiler-macro properties any more since
	macroexpand now properly follows aliases.
	* emacs-lisp/cl-macs.el (toplevel, cl-define-compiler-macro)
	(cl-compiler-macroexpand): Use new prop.
	* emacs-lisp/byte-opt.el (featurep): Optimize earlier.

	* emacs-lisp/cl-lib.el (custom-print-functions): Add alias.

2012-06-05  Martin Rudalics  <rudalics@gmx.at>

	* window.el (get-lru-window, get-mru-window, get-largest-window):
	New argument NOT-SELECTED to avoid picking the selected window.
	(window--display-buffer-1, window--display-buffer-2): Replace by
	new function window--display-buffer
	(display-buffer-same-window, display-buffer-reuse-window)
	(display-buffer-pop-up-frame, display-buffer-pop-up-window):
	Use window--display-buffer.
	(display-buffer-use-some-window): Remove temporary dedication
	hack by calling get-lru-window and get-largest-window with
	NOT-SELECTED argument non-nil.  Call window--display-buffer.

2012-06-05  Glenn Morris  <rgm@gnu.org>

	* vc/vc-sccs.el (vc-sccs-workfile-unchanged-p):
	Replace external vcdiff script.

2012-06-04  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/cl-lib.el (cl-values, cl-values-list): Fix up last change.

2012-06-04  Chong Yidong  <cyd@gnu.org>

	* image.el (imagemagick-types-inhibit): Revert last change.
	Add INFO and M.
	(imagemagick-enabled-types): Remove CIN and EPS*.

2012-06-04  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/cl-lib.el: Rename from cl.el.
	* emacs-lisp/cl.el: New compatibility file.
	* emacs-lisp/cl-lib.el, emacs-lisp/cl-seq.el, emacs-lisp/cl-macs.el:
	* emacs-lisp/cl-extra.el: Rename all top-level functions and variables
	to obey the "cl-" prefix.
	* emacs-lisp/macroexp.el (macroexpand-all-1): Adjust to new name.

2012-06-03  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/authors.el (authors-aliases): Addition.

	* cus-start.el (tool-bar-style, tool-bar-max-label-size):
	Fix :version.

2012-06-03  Stefan Merten  <smerten@oekonux.de>

	* textmodes/rst.el: Add comments.
	(rst-transition, rst-adornment): New faces.
	(rst-adornment-faces-alist): Make default safe to reevaluate.
	Fixes
	http://sourceforge.net/tracker/?func=detail&atid=422030&aid=3479603&group_id=38414.
	Improve customization tags.
	(rst-define-level-faces): Clarify meaning.

2012-06-03  Chong Yidong  <cyd@gnu.org>

	* progmodes/compile.el (compilation-mode-line-fail)
	(compilation-mode-line-run, compilation-mode-line-exit):
	New faces.
	(compilation-start, compilation-handle-exit): Use them (Bug#11032).

2012-06-03  Jack Duthen  <duthen.mac.01@gmail.com>  (tiny change)

	* progmodes/which-func.el (which-func-update-ediff-windows):
	New function.  Use it in ediff-select-hook (Bug#11478).

2012-06-03  Chong Yidong  <cyd@gnu.org>

	* bindings.el: Remove explicit help text from format-mode-line.
	It is now supplied by mode-line-default-help-echo.
	(mode-line-front-space, mode-line-end-spaces)
	(mode-line-misc-info): New variables.
	(mode-line-modes, mode-line-position): Move the default value to
	the variable definition.
	(mode-line-default-help-echo): New defcustom.
	(mode-line-mule-info-help-echo, mode-line-read-only-help-echo)
	(mode-line-modified-help-echo): New functions.
	(mode-line-mule-info, mode-line-modified): Use them.
	(mode-line-eol-desc, propertized-buffer-identification):
	Consistency fixes for help text.
	(mode-line-coding-system-map): Allow using mouse-3 to invoke
	set-buffer-file-coding-system (Bug#289).
	(mode-line-mule-info-help-echo): Update help text.

2012-06-02  Stefan Monnier  <monnier@iro.umontreal.ca>

	* simple.el (execute-extended-command): Set real-this-command
	(bug#11506).

2012-06-02  Chong Yidong  <cyd@gnu.org>

	Remove incorrect uses of "modeline" in comments, docstrings, and
	function/variable names (Bug#10329).

	* cus-edit.el (mode-line):
	* dframe.el (dframe-mouse-hscroll):
	* emacs-lisp/re-builder.el:
	* emacs-lisp/easy-mmode.el (define-minor-mode):
	* frame.el (set-frame-name):
	* help.el (lookup-minor-mode-from-indicator):
	* net/rcirc.el (rcirc-activity-string, rcirc-short-buffer-name):
	* progmodes/cc-cmds.el (c-toggle-auto-newline)
	(c-toggle-hungry-state):
	* progmodes/antlr-mode.el (antlr-language-alist):
	* progmodes/idlw-shell.el (idlwave-shell-electric-stop-line-face):
	* progmodes/vhdl-mode.el (vhdl-mode):
	* progmodes/which-func.el (which-func, which-func-cleanup-function):
	* term/ns-win.el (ns-face-at-pos):
	* term/sup-mouse.el (sup-mouse-report):
	* textmodes/flyspell.el (flyspell-mode-line-string):
	* textmodes/ispell.el (ispell-highlight-face):
	* textmodes/reftex-global.el:
	* vc/vc-arch.el (vc-arch-mode-line-string):
	* vc/vc-cvs.el (vc-cvs-mode-line-string):
	* vc/vc-git.el (vc-git-mode-line-string):
	* vc/vc-hooks.el (vc-display-status)
	(vc-default-mode-line-string):
	* vc/vc-mtn.el (vc-mtn-mode-line-string): Doc fixes.

	* ansi-color.el (ansi-color-faces-vector): Change default faces.

	* dired.el (dired-sort-set-mode-line): Rename from
	dired-sort-set-modeline.  All callers changed.

	* eshell/esh-mode.el (eshell-status-in-mode-line): Rename from
	eshell-status-in-modeline.

	* foldout.el (foldout-mode-line-string): Rename from
	foldout-modeline-string.  All callers changed.
	(foldout-update-mode-line): Rename from foldout-update-modeline.

	* subr.el (redraw-modeline): Make into obsolete alias.

	* calendar/timeclock.el (timeclock-mode-line-display): Rename from
	timeclock-modeline-display.  Make old name an alias.
	(timeclock-update-mode-line): Likewise.  All callers changed.
	(timeclock-mode-line-display): No need to check before using
	add-hook.
	(timeclock-relative, timeclock-day-over-hook)
	(timeclock-use-elapsed, timeclock-mode-string)
	(timeclock-mode-line-display): Doc fix, "modeline" -> "mode line".

	* emulation/crisp.el (crisp-mode-mode-line-string): Rename from
	crisp-mode-modeline-string.

	* play/solitaire.el (solitaire-build-mode-line): Rename from
	solitaire-build-modeline.  All callers changed.

	* play/zone.el (zone-hiding-mode-line): Rename from
	zone-hiding-modeline.  All callers changed.
	(zone): Remove unusued `modeline-hidden-level' property.

	* progmodes/xscheme.el (xscheme-mode-line-initialize): Rename from
	xscheme-modeline-initialize.  All callers changed.

	* strokes.el (strokes-lighter): Rename from
	strokes-modeline-string.

	* textmodes/sgml-mode.el (html-face-tag-alist)
	(html-tag-face-alist): Use mode-line face instead of obsolete
	alias modeline.

2012-06-02  Stefan Merten  <smerten@oekonux.de>

	* textmodes/rst.el: Always require `cl'.
	(rst-mode-map): Fix meaning of C-M-a / C-M-e.

2012-06-02  Chong Yidong  <cyd@gnu.org>

	* image.el (imagemagick-enabled-types): Rename from
	imagemagick-types-enable.  Add many more types.
	(imagemagick-types-inhibit): Change default to nil.
	(imagemagick-filter-types): Caller changed.

2012-06-01  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/cl-macs.el: Use backquotes.
	(cl-transform-function-property): Use eval-and-compile rather than
	abusing `require'.
	(defstruct): Use declare-function instead of with-no-warnings.

	* emacs-lisp/bytecomp.el: Fix last change (bug#11594).
	(byte-compile-output-docform): Re-add the print-circle bindings.
	(byte-compile-fix-header): Use #$ just because it's shorter.
	(byte-compile-output-file-form): Remove defun/defmacro.

2012-06-01  Martin Rudalics  <rudalics@gmx.at>

	* simple.el (choose-completion): Remove now obsolete binding for
	owindow.

2012-06-01  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-check-for-regexp): Search from buffer end,
	in order to avoid "Stack overflow in regexp matcher".

2012-05-31  Glenn Morris  <rgm@gnu.org>

	* image.el: For clarity, call imagemagick-register-types at
	top-level, rather than relying on a custom :initialize.
	(imagemagick-types-enable): New option.  (Bug#11557)
	(imagemagick-filter-types): New function.  (Bug#7406)
	(imagemagick-register-types): Use imagemagick-filter-types.
	If disabling support, remove elements altogether rather
	than using an impossible regexp.
	(imagemagick-types-inhibit): Give it the default init function.

2012-05-31  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/bytecomp.el (byte-compile-fix-header):
	Handle arbitrary file name lengths (Bug#11585).

2012-05-31  Martin Rudalics  <rudalics@gmx.at>

	* desktop.el (desktop-read): Clear previous and next buffers for
	all windows and bury *Messages* buffer (bug#11556).

2012-05-31  Stefan Monnier  <monnier@iro.umontreal.ca>

	Add `declare' for `defun'.  Align `defmacro's with it.
	* emacs-lisp/easy-mmode.el (define-minor-mode)
	(define-globalized-minor-mode): Don't autoload the var definitions.
	* emacs-lisp/byte-run.el: Use lexical-binding.
	(defun-declarations-alist, macro-declarations-alist): New vars.
	(defmacro, defun): Use them.
	(make-obsolete, define-obsolete-function-alias)
	(make-obsolete-variable, define-obsolete-variable-alias):
	Use `declare'.
	(macro-declaration-function): Mark obsolete.
	* emacs-lisp/autoload.el: Use lexical-binding.
	(make-autoload): Add `expansion' arg.  Rely more on macro expansion.

2012-05-30  Agustín Martín Domingo  <agustin.martin@hispalinux.es>

	* textmodes/ispell.el (ispell-with-no-warnings):
	Define as a macro.
	(ispell-kill-ispell, ispell-change-dictionary):
	Use `called-interactively-p' for Emacs instead of obsolete
	`interactive-p'.

2012-05-30  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/byte-run.el (defmacro, defun): Move from C.
	(macro-declaration-function): Move var from C code.
	(macro-declaration-function): Define function with defalias.
	* emacs-lisp/macroexp.el (macroexpand-all-1):
	* emacs-lisp/cconv.el (cconv-convert, cconv-analyse-form):
	* emacs-lisp/byte-opt.el (byte-optimize-form-code-walker): Don't handle
	defun/defmacro any more.
	* emacs-lisp/bytecomp.el (byte-compile-arglist-signature):
	Provide fallback for unknown arglist.
	(byte-compile-arglist-warn): Change calling convention.
	(byte-compile-output-file-form): Move print-vars binding.
	(byte-compile-output-docform): Simplify accordingly.
	(byte-compile-file-form-defun, byte-compile-file-form-defmacro)
	(byte-compile-defmacro-declaration): Remove.
	(byte-compile-file-form-defmumble): Generalize to defalias.
	(byte-compile-output-as-comment): Return byte-positions.
	Simplify callers accordingly.
	(byte-compile-lambda): Use `assert'.
	(byte-compile-defun, byte-compile-defmacro): Remove.
	(byte-compile-file-form-defalias):
	Use byte-compile-file-form-defmumble.
	(byte-compile-defalias-warn): Remove.

2012-05-29  Stefan Merten  <smerten@oekonux.de>

	* textmodes/rst.el: Silence `checkdoc-ispell' errors where
	possible.  Fix authors.  Improve comments.  Improve loading of `cl'.

	(rst-mode-abbrev-table): Merge definition.
	(rst-mode): Make sure `font-lock-defaults' is buffer local.
	(rst-define-key, rst-deprecated-keys, rst-call-deprecated): Refactor.

2012-05-29  Ulf Jasper  <ulf.jasper@web.de>

	* calendar/icalendar.el
	(icalendar-export-region): Export UID properly.

2012-05-29  Leo Liu  <sdl.web@gmail.com>
	* calendar/icalendar.el (icalendar-import-format):
	Add `icalendar-import-format-uid' (Bug#11525).
	(icalendar-import-format-uid): New.
	(icalendar--parse-summary-and-rest, icalendar--format-ical-event):
	Export UID.

2012-05-29  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/pcase.el (pcase--expand): Accept different sets of vars in
	different alternative patterns.
	(pcase-codegen): Be more careful to preserve identity.
	(pcase--u1): Don't forget to mark vars as used.

	* emacs-lisp/bytecomp.el (byte-compile-constp): Treat #'v as a constant.
	(byte-compile-close-variables): Bind byte-compile--outbuffer here...
	(byte-compile-from-buffer): ...rather than here.

	* emacs-lisp/byte-opt.el (byte-compile-inline-expand): Don't re-preprocess
	functions from byte-compile-function-environment.

2012-05-29  Troels Nielsen  <bn.troels@gmail.com>

	* window.el (window-deletable-p): Avoid deleting the root window
	of a frame with an active minibuffer.

2012-05-29  Martin Rudalics  <rudalics@gmx.at>

	* simple.el (choose-completion): Use quit-window (Bug#11567).

2012-05-29  Chong Yidong  <cyd@gnu.org>

	* whitespace.el (whitespace-cleanup): Fix usage of
	whitespace-empty-at-bob-regexp (Bug#11492).

2012-05-29  Aaron S. Hawley  <aaron.s.hawley@gmail.com>

	* vc/vc.el (vc-revert, vc-rollback): Dont kill vc-diff buffer on
	revert (Bug#11488).

2012-05-29  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-mode-map): Bind `M-s _' to
	`isearch-toggle-symbol'.  Bind `M-s c' to
	`isearch-toggle-case-fold'.
	(search-map): Bind `M-s _' to `isearch-forward-symbol'.
	(isearch-forward): Add `M-s _' to the docstring.
	(isearch-forward-symbol, isearch-toggle-case-fold)
	(isearch-symbol-regexp): New functions.  (Bug#11381)

2012-05-29  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-word): Add docstring.  (Bug#11381)
	(isearch-occur, isearch-search-and-update): If `isearch-word' is
	a function, call it to get the regexp.
	(isearch-message-prefix): If `isearch-word' holds a symbol, use its
	property `isearch-message-prefix' instead of the string "word ".
	(isearch-search-fun-default): For the case of `isearch-word',
	return a lambda that calls re-search-forward/re-search-backward
	with a regexp returned by `word-search-regexp' or by the function
	in `isearch-word'.

2012-05-29  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-search-fun-default): New function.
	(isearch-search-fun): Move default part to the new function
	`isearch-search-fun-default'.
	(isearch-search-fun-function): Set the default value to
	`isearch-search-fun-default'.  (Bug#11381)

	* comint.el (comint-history-isearch-end):
	Use `isearch-search-fun-default'.
	(comint-history-isearch-search): Use `isearch-search-fun-default'
	and remove spacial case for `isearch-word'.
	(comint-history-isearch-wrap): Remove spacial case for
	`isearch-word'.

	* hexl.el (hexl-isearch-search-function):
	Use `isearch-search-fun-default'.

	* info.el (Info-isearch-search): Use `isearch-search-fun-default'.
	Use `word-search-regexp' for `isearch-word'.

	* misearch.el (multi-isearch-search-fun):
	Use `isearch-search-fun-default'.

	* simple.el (minibuffer-history-isearch-search):
	Use `isearch-search-fun-default' and remove spacial case for
	`isearch-word'.
	(minibuffer-history-isearch-wrap): Remove spacial case for
	`isearch-word'.

	* textmodes/reftex-global.el (reftex-isearch-wrap-function):
	Remove spacial case for `isearch-word'.
	(reftex-isearch-isearch-search): Use `isearch-search-fun-default'.

2012-05-28  Agustín Martín Domingo  <agustin.martin@hispalinux.es>

	Decrease XEmacs incompatibilities.
	* textmodes/flyspell.el (flyspell-check-pre-word-p):
	Use `string-match'.
	(flyspell-delete-region-overlays): Use alternative definition for
	XEmacs.
	(flyspell-delete-all-overlays): Use `flyspell-delete-region-overlays'.
	(flyspell-word): Use `process-kill-without-query' if XEmacs.
	(flyspell-mode-on): Use `interactive-p' if XEmacs.
	(flyspell-incorrect-face, flyspell-duplicate-face): Do not use
	`define-obsolete-face-alias' under XEmacs, but old method.

	* textmodes/ispell.el (ispell-with-no-warnings): XEmacs alternative
	`with-no-warnings' definition or Emacs alias.
	(ispell-command-loop, ispell-message): Use `ispell-with-no-warnings'.
	(ispell-word): Do not use `region-p' if XEmacs.

2012-05-28  Agustín Martín Domingo  <agustin.martin@hispalinux.es>

	* textmodes/ispell.el (ispell-find-aspell-dictionaries):
	Check for `ispell-dictionary-base-alist' instead of full
	`ispell-dictionary-alist'.
	(ispell-init-process): Show spellchecker when starting new Ispell
	process.

2012-05-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/vhdl-mode.el: Sync with upstream 3.33.28.
	http://www.iis.ee.ethz.ch/~zimmi/emacs/vhdl-mode.html#release-notes-3.33

2012-05-27  Juanma Barranquero  <lekktu@gmail.com>

	* version.el (motif-version-string, gtk-version-string)
	(ns-version-string): Declare.

2012-05-27  Juri Linkov  <juri@jurta.org>

	* emacs-lisp/lisp-mode.el (eval-defun-2): Use `eval-sexp-add-defvars'
	after the `eval-defun-1' specialcaseing
	like in `edebug-eval-defun' (bug#10181).

	* emacs-lisp/edebug.el (edebug-eval-defun): Set `face-documentation'
	like in `eval-defun-1'.

2012-05-27  Eli Zaretskii  <eliz@gnu.org>

	* mail/sendmail.el (mail-yank-region):
	Recognize rmail-yank-current-message in addition to insert-buffer.
	Fixes mail-mode's "C-c C-r" that otherwise does nothing when invoked in
	a *mail* buffer created through rmail-start-mail with sendmail as
	mail-user-agent.

2012-05-27  Chong Yidong  <cyd@gnu.org>

	* net/gnutls.el (gnutls-min-prime-bits): Improve docstring.
	Default to 256 (Bug#11267).

	* help.el (describe-mode): Doc fix.

2012-05-26  Glenn Morris  <rgm@gnu.org>

	* w32-fns.el (w32-init-info): Remove.
	* paths.el (Info-default-directory-list): Add w32-init-info equivalent.

	* info.el (info-initialize): For self-contained NS builds, put the
	included info/ directory at the front.  (Bug#2791)

	* paths.el (Info-default-directory-list): Make it a defcustom,
	mainly so that we can use custom-initialize-delay.

2012-05-26  Stefan Monnier  <monnier@iro.umontreal.ca>

	* subr.el (buffer-has-markers-at): Mark obsolete.

	* subr.el (lambda): Use declare.

	* emacs-lisp/lisp-mode.el (lambda):
	* emacs-lisp/edebug.el (lambda): Move properties to its definition.

2012-05-26  Aaron S. Hawley  <aaron.s.hawley@gmail.com>

	* thingatpt.el (forward-same-syntax): Handle no ARG case.  (Bug#11560)

2012-05-26  Glenn Morris  <rgm@gnu.org>

	* progmodes/cc-mode.el (auto-mode-alist): Fix typo.

2012-05-25  Glenn Morris  <rgm@gnu.org>

	* paths.el: Remove no-byte-compile.
	* loadup.el: No need to load paths.el uncompiled.

	* image.el (imagemagick-types-inhibit): Doc fix.

	* version.el: Remove no-byte-compile and associated formatting.
	* loadup.el: No need to load version.el uncompiled.  AFAICS, this
	is ancient code from when there was an "inc-vers.el".

2012-05-25  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/gdb-mi.el: Minor style changes.
	(gdb-enable-debug, gdb-speedbar-auto-raise, gdb-many-windows):
	Turn into minor modes.
	(gdb--if-arrow): Rename from gdb-if-arrow, make it hygienic.
	(gdb-mouse-until, gdb-mouse-jump): Adjust uses accordingly.
	(gdb-shell): Remove unneeded let-binding.
	(gdb-get-many-fields): Eliminate O(n²) behavior.

2012-05-25  Eli Zaretskii  <eliz@gnu.org>

	* cus-start.el <vertical-centering-font-regexp>: Avoid warning on
	platforms that don't link in fontset.c.

2012-05-25  Juri Linkov  <juri@jurta.org>

	Use the same diff color scheme as in modern VCSes (bug#10181).

	* vc/diff-mode.el (diff-header, diff-file-header): Remove "green"
	to avoid confusion with `diff-added' that now uses green colors.
	(diff-removed): Use shades of red.
	(diff-added): Use shades of green.
	(diff-changed): Leave just the yellow color.
	(diff-use-changed-face): New variable.
	(diff-font-lock-keywords): Use `diff-use-changed-face' to decide
	how to highlight context diff changes.
	(diff-refine-change): Use shades of yellow.
	(diff-refine-removed): New face that uses shades of red.
	(diff-refine-added): New face that uses shades of green.
	(diff-refine-hunk): Use `diff-refine-change', `diff-refine-added',
	`diff-refine-removed' in the call to `smerge-refine-subst'
	depending on the value of `diff-use-changed-face'.

	* vc/smerge-mode.el (smerge-mine): Use shades of red.
	(smerge-other): Use shades of green.
	(smerge-base): Use shades of yellow.
	(smerge-refined-change): Empty face.
	(smerge-refined-removed): New face that uses shades of red.
	(smerge-refined-added): New face that uses shades of green.
	(smerge-refine-subst): Rename arg `props' to `props-c'.  Add new
	args `props-r' and `props-a', and use them.  Doc fix.
	(smerge-refine): Evaluate `smerge-use-changed-face' and depending
	on its value use different faces `smerge-refined-change',
	`smerge-refined-removed', `smerge-refined-added' in the call to
	`smerge-refine-subst'.

	* vc/ediff-init.el (ediff-current-diff-A, ediff-fine-diff-A):
	Add face condition `min-colors 88' with shades of red.
	(ediff-current-diff-B, ediff-fine-diff-B): Add face condition
	`min-colors 88' with shades of green.
	(ediff-current-diff-C, ediff-fine-diff-C): Add face condition
	`min-colors 88' with shades of yellow.

2012-05-24  Glenn Morris  <rgm@gnu.org>

	* paths.el (prune-directory-list, remote-shell-program): Move to...
	* files.el (prune-directory-list, remote-shell-program): ...here.
	For the latter, delay initialization, prefer ssh, just search PATH.

	* paths.el (term-file-prefix): Move to faces.el (the only user).
	* faces.el (term-file-prefix): Move here, make it a defcustom.

	* paths.el (news-directory, news-path, news-inews-program):
	Move to gnus/nnspool.el.

	* paths.el (gnus-default-nntp-server): Remove (gnus.el defines it).

	* paths.el (rmail-file-name, rmail-spool-directory): Move from here...
	* mail/rmail.el (rmail-file-name, rmail-spool-directory): ... to here.
	Make the latter a defcustom, with a delayed initialization.

	* paths.el (gnus-nntp-service, gnus-local-organization): Remove.
	These were deleted from Gnus itself late 2010.

2012-05-22  Juanma Barranquero  <lekktu@gmail.com>

	* progmodes/which-func.el (which-func-ff-hook):
	Check against user-error, not error.

	* emacs-lisp/edebug.el (top): Do not load or set up loading of
	cl-specs.el, which no longer exists.

2012-05-22  Glenn Morris  <rgm@gnu.org>

	* info.el (info-emacs-bug): New command.
	* menu-bar.el (menu-bar-help-menu): Add "How to Report a Bug" to Help.
	* mail/emacsbug.el (report-emacs-bug): Replace with info-emacs-bug.

2012-05-21  Glenn Morris  <rgm@gnu.org>

	* makefile.w32-in (update-subdirs-SH):
	* Makefile.in (update-subdirs): Update for moved update-subdirs.

2012-05-21  Stefan Monnier  <monnier@iro.umontreal.ca>

	* hi-lock.el (hi-lock-face-defaults): Move obsolete before definition.

	* progmodes/compile.el (compilation-error-regexp-alist-alist):
	Simplify Maven regexp, and make sure the file can't start with a space
	(bug#11517).

2012-05-21  Glenn Morris  <rgm@gnu.org>

	* Makefile.in (setwins, setwins_almost, setwins_for_subdirs):
	Scrap superfluous subshells.

2012-05-19  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/bytecomp.el (byte-compile-root-dir): New var.
	(byte-compile-warning-prefix, batch-byte-compile-file): Use it.

2012-05-19  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc.el (calc-ensure-consistent-units): New variable.

	* calc/calc-units.el (math-consistent-units-p)
	(math-check-unit-consistency): New functions.
	(calc-quick-units, calc-convert-units):
	Use `math-check-unit-consistency' when `calc-ensure-consistent-units'
	is non-nil.
	(calc-extract-units): Fix typo.

2012-05-18  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc/vc-bzr.el (vc-bzr-state-heuristic): Save match-data around sha1.

	* textmodes/flyspell.el: Commenting style, plus code simplifications.
	(flyspell-default-deplacement-commands): Don't spell check after
	repeated window/frame switches (e.g. triggered by mouse-movement).
	(flyspell-delay-commands, flyspell-deplacement-commands): Use mapc.
	(flyspell-debug-signal-word-checked): Simplify and fit in 80 cols.
	(flyspell-casechars-cache, flyspell-ispell-casechars-cache)
	(flyspell-not-casechars-cache, flyspell-ispell-not-casechars-cache):
	Remove unused vars.
	(flyspell-get-casechars, flyspell-get-not-casechars):
	Simplify; Don't bother removing a ] just to add it back.
	* textmodes/ispell.el (ispell-program-name): Use executable-find.

2012-05-18  Rüdiger Sonderfeld  <ruediger@c-plusplus.de>

	* calc/calc-lang.el (math-C-parse-bess, math-C-parse-fma):
	New functions.
	(math-function-table): Add support for more C functions.

2012-05-18  Agustín Martín Domingo  <agustin.martin@hispalinux.es>

	* textmodes/flyspell.el (flyspell-check-pre-word-p)
	(flyspell-check-word-p, flyspell-debug-signal-word-checked):
	Protect delay handling for otherchars against empty otherchars.

2012-05-18  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/lisp-mode.el (doc-string-elt): Move those properties to
	their respective macro declarations.
	* skeleton.el (define-skeleton):
	* progmodes/compile.el (define-compilation-mode):
	* ibuf-macs.el (define-ibuffer-sorter, define-ibuffer-op)
	(define-ibuffer-filter):
	* emacs-lisp/generic.el (define-generic-mode):
	* emacs-lisp/easy-mmode.el (define-minor-mode)
	(define-globalized-minor-mode):
	* emacs-lisp/cl-macs.el (defun*, defmacro*, defstruct, deftype):
	* emacs-lisp/byte-run.el (defsubst):
	* custom.el (deftheme): Add doc-string metadata.

2012-05-17  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/cl-macs.el, emacs-lisp/cl.el: Move indent info.

2012-05-17  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/pcase.el (pcase--u1): Avoid ((lambda ...) ...).

	* emacs-lisp/cl.el: Add edebug specs from cl-specs.el.
	* emacs-lisp/cl-macs.el: Idem.
	* emacs-lisp/cl-specs.el: Remove.

2012-05-17  Stefan Monnier  <monnier@iro.umontreal.ca>

	Minor renaming of internal CL functions and variables.
	* emacs-lisp/cl-seq.el (cl--adjoin): Rename from cl-adjoin.
	(cl--position): Rename from cl-position.
	(cl--delete-duplicates): Rename from cl-delete-duplicates.
	* emacs-lisp/cl.el (cl--gensym-counter): Rename from *gensym-counter*.
	(cl--random-state): Rename from *random-state*.

2012-05-17  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/cl-macs.el (cl-transform-lambda): Don't add spurious
	parens around the arg list (bug#11499).

2012-05-17  Juri Linkov  <juri@jurta.org>

	* isearch.el (word-search-regexp, word-search-backward)
	(word-search-forward, word-search-backward-lax)
	(word-search-forward-lax): Move functions from search.c
	(bug#10145, bug#11381).

2012-05-16  Agustín Martín Domingo  <agustin.martin@hispalinux.es>

	* textmodes/flyspell.el (flyspell-check-pre-word-p)
	(flyspell-check-word-p, flyspell-debug-signal-word-checked):
	Delay for otherchars as for normal word components.

2012-05-16  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuffer.el (completion--sifn-requote): Fix last change.
	(minibuffer-local-must-match-filename-map):
	Move define-obsolete-variable-alias before its var.

2012-05-15  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/pcase.el (pcase-let*, pcase-let): Fix edebug spec.

	* minibuffer.el (completion--sifn-requote): Handle sifn's truncation
	behavior.
	(completion--string-equal-p): New function.
	(completion--twq-all): Use it to get better assertion failure data.

	Only handle ".." and '..' quoting in shell-mode (bug#11466).
	* shell.el (shell--unquote&requote-argument, shell--unquote-argument)
	(shell--requote-argument): New functions.
	(shell-completion-vars): Use them.
	(shell--parse-pcomplete-arguments): Rename from
	shell-parse-pcomplete-arguments.
	* comint.el (comint-word): Obey comint-file-name-quote-list.  Simplify.
	(comint--unquote&requote-argument): Don't handle ".." and '..' quoting.
	Obey comint-file-name-quote-list.

	* emacs-lisp/smie.el (smie-indent--bolp-1): New function.
	(smie-indent-keyword): Use it.

2012-05-14  Stefan Merten  <smerten@oekonux.de>

	* textmodes/rst.el (rst-re-alist): Fix loading (bug#11462).

2012-05-14  Stefan Monnier  <monnier@iro.umontreal.ca>

	* net/rlogin.el (rlogin-mode-map): Fix last change.

2012-05-14  Jason L. Wright  <jason.wright@inl.gov>  (tiny change)

	* mail/smtpmail.el (smtpmail-send-command): Send the command and
	the following \r\n using a single `process-send-string', since the
	Lotus SMTP server refuses to accept any commands if they are sent
	with two `process-send-string's (Bug#11444).

2012-05-14  Stefan Monnier  <monnier@iro.umontreal.ca>

	* shell.el (shell-parse-pcomplete-arguments):
	Obey pcomplete-arg-quote-list inside double-quoted args (Bug#11348).

2012-05-14  Wolfgang Jenkner  <wjenkner@inode.at>

	* image-mode.el: Fit to width/height for rotated images (Bug#11431).
	(image-transform-scale, image-transform-right-angle-fudge): New vars.
	(image-transform-width, image-transform-fit-width): New functions.
	(image-transform-properties): Use them.
	(image-transform-check-size): New function.
	(image-toggle-display-image): Use it (for testing).
	(image-transform-set-rotation): Reduce angle mod 360.
	Delete obsolete comment.

2012-05-14  Wolfgang Jenkner  <wjenkner@inode.at>

	* image-mode.el: Fix scaling (bug#11399).
	(image-transform-resize): Doc fix.
	(image-transform-properties): Default scale is 1 and height should
	be an integer.

2012-05-13  Johan Bockgård  <bojohan@gnu.org>

	* emacs-lisp/smie.el (smie-next-sexp): Use accessor `op-forw' rather
	than hard-coding `car', to fix misbehavior when moving forward.

2012-05-13  Chong Yidong  <cyd@gnu.org>

	* emacs-lisp/tabulated-list.el (tabulated-list-format)
	(tabulated-list-entries, tabulated-list-padding)
	(tabulated-list-sort-key): Make permanent-local.

	* ebuff-menu.el: Adapt to Buffer Menu changes (Bug#11455).
	(electric-buffer-list): Put electric buffer menu
	command descriptions in this docstring, instead of the docstring
	of electric-buffer-menu-mode.  Code cleanups.
	(electric-buffer-menu-mode): Use define-derived-mode.  Rename from
	Electric-buffer-menu-mode.
	(electric-buffer-update-highlight): Minor code cleanup.

2012-05-13  Michael Albinus  <michael.albinus@gmx.de>

	* net/dbus.el (dbus-call-method): Restore events not from D-Bus.
	(Bug#11447)

2012-05-13  Stefan Monnier  <monnier@iro.umontreal.ca>

	Move define-obsolete-variable-alias before the var's definition.
	* vc/log-edit.el (vc-comment-ring, vc-comment-ring-index):
	* tooltip.el (tooltip-hook):
	* textmodes/reftex-toc.el (reftex-toc-map):
	* textmodes/reftex-sel.el (reftex-select-label-map)
	(reftex-select-bib-map):
	* textmodes/reftex-index.el (reftex-index-map)
	(reftex-index-phrases-map):
	* speedbar.el (speedbar-syntax-table, speedbar-key-map):
	* progmodes/meta-mode.el (meta-mode-map):
	* novice.el (disabled-command-hook):
	* loadhist.el (unload-hook-features-list):
	* frame.el (blink-cursor):
	* files.el (find-file-not-found-hooks, write-file-hooks)
	(write-contents-hooks):
	* emulation/tpu-edt.el (GOLD-map):
	* emacs-lock.el (emacs-lock-from-exiting):
	* emacs-lisp/generic.el (generic-font-lock-defaults):
	* emacs-lisp/chart.el (chart-map):
	* dos-fns.el (register-name-alist):
	* dired-x.el (dired-omit-files-p):
	* desktop.el (desktop-enable):
	* cus-edit.el (custom-mode-hook):
	* buff-menu.el (buffer-menu-mode-hook):
	* bookmark.el (bookmark-read-annotation-text-func)
	(bookmark-exit-hooks):
	* allout.el (allout-mode-deactivate-hook)
	(allout-exposure-change-hook, allout-structure-added-hook)
	(allout-structure-deleted-hook, allout-structure-shifted-hook):
	* dirtrack.el (dirtrack-toggle, dirtrackp, dirtrack-debug-toggle)
	(dirtrack-debug): Move call to define-obsolete-variable-alias so it
	comes before the corresponding variable's definition.

2012-05-12  Chong Yidong  <cyd@gnu.org>

	* buff-menu.el (Buffer-menu-buffer+size-width): Doc fix (Bug#11454).
	(Buffer-menu-mouse-select): Restore function (Bug#11459).
	(Buffer-menu-mode-map): Bind it.
	(Buffer-menu--pretty-name): Add a mouse-face property.

2012-05-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/prolog.el: Use SMIE.  Cleanup regexp setup.
	(prolog-upper-case-string, prolog-lower-case-string)
	(prolog-atom-char-regexp, prolog-atom-regexp): Initialize in defconst.
	(prolog-use-smie, prolog-smie-grammar): New vars.
	(prolog-smie-forward-token, prolog-smie-backward-token)
	(prolog-smie-rules): New funs.
	(prolog-comment-indent): Remove.
	(prolog-mode-variables): Use default comment indentation instead.
	Setup SMIE.
	(prolog-build-case-strings, prolog-set-atom-regexps): Remove.
	(prolog-mode): Don't call them any more.
	(prolog-electric-colon, prolog-electric-dash)
	(prolog-edit-menu-insert-move): Use indent-according-to-mode.

	* dabbrev.el (dabbrev-expand): Make "no expansion found" a user-error.

	* minibuffer.el (completion--twq-all): Again, allow case differences.

	* term.el: Move keymap initialization code to be more idiomatic.
	(term-signals-menu, term-mode-map, term-raw-map, term-raw-escape-map)
	(term-terminal-menu): Move initialization into declaration.
	(term-escape-char): Let the user set it in her .emacs.

	* progmodes/sh-script.el: Use post-self-insert-hook&electric-pair-mode.
	Provide SMIE-based indentation (not enabled by default yet).
	(sh-mode-map): Don't bind electric keys.
	Use electric-pair-mode instead of skeleton-pair.
	(sh-assignment-regexp): Fit within 80 columns.
	(sh-indent-supported): Specify actual shell name instead of boolean.
	(sh--maybe-here-document): New fun, from sh-maybe-here-document.
	(sh-maybe-here-document): Use it.  Make obsolete.
	(sh-electric-here-document-mode) New minor mode.
	(sh-mode): Use it.  Don't set sh-indent-supported-here here.
	(sh-smie-sh-grammar, sh-smie--sh-operators, sh-smie--sh-operators-re)
	(sh-smie--sh-operators-back-re, sh-indent-after-continuation)
	(sh-smie-rc-grammar, sh-use-smie): New vars.
	(sh-smie--keyword-p, sh-smie--newline-semi-p, sh-smie--sh-keyword-p)
	(sh-smie-sh-forward-token, sh-smie--looking-back-at-continuation-p)
	(sh-smie-sh-backward-token, sh-smie--continuation-start-indent)
	(sh-smie-sh-rules, sh-smie-rc-rules, sh-smie--sh-keyword-in-p)
	(sh-smie--rc-after-special-arg-p, sh-smie-rc-backward-token)
	(sh-smie-sh-rules, sh-smie--rc-newline-semi-p): New functions.
	(sh-set-shell): Use smie-setup if requested.

	* term.el (term-set-escape-char): Properly set term-escape-char.
	See http://stackoverflow.com/questions/10524656.

2012-05-10  Chong Yidong  <cyd@gnu.org>

	* ffap.el (ffap-url-unwrap-local): Make it work right (Bug#9131).
	Use url-generic-parse-url, and handle host names and Windows
	filenames properly.
	(ffap-url-unwrap-remote): Use url-generic-parse-url.
	(ffap-url-unwrap-remote): Accept list values, specifying a list of
	URL schemes to work on.
	(ffap--toggle-read-only): New function.
	(ffap-read-only, ffap-read-only-other-window)
	(ffap-read-only-other-frame): Use it.
	(ffap-fixup-url): Don't check ffap-ftp-regexp, since it is not
	necessary for ffap-url-unwrap-remote.

2012-05-10  Dave Abrahams  <dave@boostpro.com>

	* cus-start.el (create-lockfiles): Add it.

2012-05-09  Chong Yidong  <cyd@gnu.org>

	* net/browse-url.el (browse-url-url-encode-chars): Use upper-case.
	(browse-url-encode-url): Encode spaces and quotes (Bug#6300).

2012-05-09  Stefan Monnier  <monnier@iro.umontreal.ca>

	* shell.el (shell-completion-vars): Fix last change (bug#11348).

2012-05-09  Chong Yidong  <cyd@gnu.org>

	* ansi-color.el (ansi-color-process-output): Check for validity of
	comint-last-output-start before using it.  This avoids a bad
	interaction with gdb-mi's input/output buffer.

2012-05-09  Glenn Morris  <rgm@gnu.org>

	* files.el (dir-locals-read-from-file):
	Mention dir-locals in any error message.

2012-05-09  Chong Yidong  <cyd@gnu.org>

	* emacs-lisp/package.el (package-built-in-p): Handle the `emacs'
	package (Bug#11410).

	* emacs-lisp/package.el (package-buffer-info): Avoid putting local
	variables into description.

2012-05-09  Stefan Monnier  <monnier@iro.umontreal.ca>

	* shell.el (shell-completion-vars): Set pcomplete-arg-quote-list like
	shell-delimiter-argument-list (bug#11348).
	(shell-parse-pcomplete-arguments): Obey pcomplete-arg-quote-list.

2012-05-09  Juanma Barranquero  <lekktu@gmail.com>

	* textmodes/rst.el: Silence byte-compiler warnings.
	(rst-re-alist, rst-reset-section-caches): Move around.
	(rst-re): Use `characterp', not `char-valid-p'.
	(font-lock-beg, font-lock-end): Declare.

	* progmodes/idlw-shell.el (specs): Remove reference to deleted
	variable `idlwave-shell-activate-alt-keybindings' and simplify.

	* eshell/esh-cmd.el (eshell-debug-command): Fix typo in previous change.

2012-05-08  Glenn Morris  <rgm@gnu.org>

	* files.el (auto-mode-alist): Treat ".make" like ".mk".

2012-05-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc/log-edit.el: Add GNU coding standards highlighting.
	(log-edit-font-lock-gnu-style)
	(log-edit-font-lock-gnu-keywords): New vars.
	(log-edit-font-lock-keywords): New fun.
	(log-edit-mode): Don't fold case in font-lock.
	(log-edit-font-lock-keywords): Do not assume case-folding.

	* imenu.el: Misc cleanup.  Make docstrings out of comments.
	Use lexical-binding.
	(imenu--index-alist, imenu--last-menubar-index-alist)
	(imenu-menubar-modified-tick): Use defvar-local.
	(imenu--split-menu): Remove unused var.
	(imenu--cleanup-seen): Declare as global.
	(imenu--cleanup): Use dolist.

	* subr.el (defvar-local): Add debug spec and doc-string position.

2012-05-08  Glenn Morris  <rgm@gnu.org>

	* language/burmese.el, language/cham.el, language/czech.el:
	* language/english.el, language/georgian.el, language/greek.el:
	* language/japanese.el, language/khmer.el, language/korean.el:
	* language/lao.el, language/misc-lang.el, language/romanian.el:
	* language/sinhala.el, language/slovak.el, language/tai-viet.el:
	* language/thai.el, language/utf-8-lang.el:
	Remove no-byte-compile setting.

	* play/zone.el (zone-pgm-stress): Don't pollute kill-ring.  (Bug#11388)

2012-05-08  Aaron S. Hawley  <aaron.s.hawley@gmail.com>

	* progmodes/make-mode.el (makefile-browse):
	Remove unnecessary interactive.  (Bug#11324)

2012-05-07  Glenn Morris  <rgm@gnu.org>

	* forms-d2.el, forms-pass.el: Move to ../etc/forms directory.

	* international/mule.el (find-auto-coding): Make "unibyte: t" obsolete.

2012-05-07  Stefan Monnier  <monnier@iro.umontreal.ca>

	* loadup.el: Preload newcomment.el.
	* newcomment.el: Move autoload-only code to toplevel.

	* buff-menu.el (list-buffers--refresh): Mark `size' as right-align.
	* emacs-lisp/tabulated-list.el (tabulated-list-init-header):
	Handle new :right-align column property.
	(tabulated-list-print-col): Idem, plus use `display' text-property to
	try and preserve alignment for variable pitch fonts.

2012-05-07  Chong Yidong  <cyd@gnu.org>

	* emacs-lisp/tabulated-list.el: Add no-header-line alternative.
	(tabulated-list-use-header-line): New var.
	(tabulated-list-init-header): Use it.
	(tabulated-list-print-fake-header): New function.
	(tabulated-list-print): Use it.
	(tabulated-list-sort-button-map): Add non-header-line commands.
	(tabulated-list-init-header): Add column name property to basic
	labels as well.
	(tabulated-list-col-sort): Handle non-header-line button case.
	(tabulated-list--sort-by-column-name): Fix a corner case.

	* buff-menu.el (list-buffers--refresh):
	Handle Buffer-menu-use-header-line.

2012-05-06  Chong Yidong  <cyd@gnu.org>

	* buff-menu.el: Convert to Tabulated List mode.
	(Buffer-menu-buffer+size-width): Make obsolete.
	(Buffer-menu-name-width, Buffer-menu-size-width): New variables.
	(Buffer-menu-mode-map): Inherit from tabulated-list-mode-map.
	(Buffer-menu-mode): Derive from tabulated-list-mode.  Move command
	documentation into docstring of buffer-menu.
	(Buffer-menu-toggle-files-only): Add an informative message.
	(Buffer-menu-sort): Convert to alias for tabulated-list-sort.
	(Buffer-menu-buffer, Buffer-menu-beginning, Buffer-menu-mark)
	(Buffer-menu-unmark, Buffer-menu-backup-unmark)
	(Buffer-menu-delete, Buffer-menu-save, Buffer-menu-not-modified)
	(Buffer-menu-execute, Buffer-menu-select)
	(Buffer-menu-marked-buffers, Buffer-menu-toggle-read-only)
	(Buffer-menu-bury): Use Tabulated List machinery.
	(Buffer-menu-mouse-select, Buffer-menu-sort-by-column)
	(Buffer-menu-sort-button-map, Buffer-menu-make-sort-button):
	Delete.
	(list-buffers--refresh): New function.
	(list-buffers-noselect): Use it.
	(tabulated-list-entry-size->, Buffer-menu--pretty-name)
	(Buffer-menu--pretty-file-name): New helper functions.

	* loadup.el: Preload tabulated-list.

	* emacs-lisp/tabulated-list.el (tabulated-list-sort): Rename from
	tabulated-list-sort-column.
	(tabulated-list-init-header): Add the initial aligning space even
	if tabulated-list-padding is zero.

2012-05-06  Christopher Schmidt  <christopher@ch.ristopher.com>

	* emacs-lisp/cl-macs.el (cl-expr-contains): Handle cons cells
	whose cdr is not a cons cell correctly (bug#11038).

2012-05-06  Chong Yidong  <cyd@gnu.org>

	* emacs-lisp/tabulated-list.el (tabulated-list-format):
	Accept additional plist in column descriptors.
	(tabulated-list-init-header): Obey it.
	(tabulated-list-get-entry): New function.
	(tabulated-list-put-tag): Use it.  Use string-width instead of
	length.
	(tabulated-list--column-number): New function.
	(tabulated-list-print): Use it.
	(tabulated-list-print-col): New function.
	Set `tabulated-list-column-name' property on each column's text.
	(tabulated-list-print-entry): Use it.
	(tabulated-list-delete-entry, tabulated-list-set-col):
	New functions.
	(tabulated-list-sort-column): New command (Bug#11337).

	* buff-menu.el (list-buffers): Move C-x C-b binding from
	buff-menu.el to bindings.el.

	* ebuff-menu.el (Electric-buffer-menu-undefined): Use the
	:advertised-binding feature.

2012-05-06  Troels Nielsen  <bn.troels@gmail.com>  (tiny change)

	* progmodes/compile.el (compilation-internal-error-properties):
	Calculate start position correctly when end-col is set but
	end-line is not (Bug#11382).

2012-05-06  Wolfgang Jenkner  <wjenkner@inode.at>

	* man.el (Man-unindent): Use text-property-default-nonsticky to
	prevent untabify from inheriting face properties (Bug#11408).

2012-05-05  Stefan Merten  <smerten@oekonux.de>

	* textmodes/rst.el: Major merge with upstream development up to
	Docutils SVN r7399 / rst.el V1.2.1.

	Clarify maintainership and authors.

	(rst-extract-version, rst-cvs-header, rst-cvs-rev)
	(rst-cvs-timestamp, rst-svn-rev, rst-svn-timestamp)
	(rst-official-version, rst-official-cvs-rev, rst-version)
	(rst-package-emacs-version-alist): New functions and variables
	for version information.

	(rst-bullets, rst-uri-schemes, rst-adornment-chars)
	(rst-max-inline-length, rst-re-alist-def, rst-re-alist)
	(rst-mode-syntax-table, rst-mode): New and corrected functions
	and variables representing reStructuredText features.

	(rst-re): New function for reStructuredText regexes.  Use in
	many places.

	(rst-deprecated-keys, rst-call-deprecated, rst-define-key)
	(rst-mode-map): Rebind keys.

	(rst-mode-lazy, rst-font-lock-keywords)
	(rst-font-lock-extend-region)
	(rst-font-lock-extend-region-internal)
	(rst-font-lock-extend-region-extend)
	(rst-font-lock-find-unindented-line-limit)
	(rst-font-lock-find-unindented-line-match)
	(rst-adornment-level, rst-font-lock-adornment-level)
	(rst-font-lock-adornment-match)
	(rst-font-lock-handle-adornment-pre-match-form)
	(rst-font-lock-handle-adornment-matcher): Major revision of
	font-locking.  Integrate with other code.  Use `jit-lock-mode'.

	(rst-preferred-adornments, rst-adjust-hook)
	(rst-new-adornment-down, rst-preferred-bullets)
	(rst-preferred-bullets, rst-indent, rst-indent-width)
	(rst-indent-field, rst-indent-literal-normal)
	(rst-indent-literal-minimized, rst-indent-comment):
	Change, extend and improve customization.

	(rst-line-homogeneous-p, rst-line-homogeneous-nodent-p)
	(rst-normalize-cursor-position, rst-get-decoration)
	(rst-straighten-deco-spacing, rst-re-bullets, rst-re-items)
	(rst-rstrip, rst-toc-insert-find-delete-contents)
	(rst-shift-fill-region, rst-compute-bullet-tabs)
	(rst-debug-print-tabs, rst-debug-mark-found)
	(rst-shift-region-guts, rst-shift-region-right)
	(rst-shift-region-left, rst-use-char-classes)
	(rst-font-lock-keywords-function)
	(rst-font-lock-indentation-point)
	(rst-font-lock-find-unindented-line-begin)
	(rst-font-lock-find-unindented-line-end)
	(rst-font-lock-find-unindented-line)
	(rst-font-lock-adornment-point, rst-font-lock-level)
	(rst-adornment-level-alist): Remove functions and variables.

	(rst-compare-adornments, rst-get-adornment-match)
	(rst-suggest-new-adornment, rst-get-adornments-around)
	(rst-adornment-complete-p, rst-get-next-adornment)
	(rst-adjust-adornment, rst-display-adornments-hierarchy)
	(rst-straighten-adornments): Standardize function names to
	use "adornment" instead of "decoration".  Correct callers.
	Similar standardizing in many places.

	(rst-update-section, rst-adjust, rst-promote-region)
	(rst-enumerate-region, rst-bullet-list-region)
	(rst-repeat-last-character): Correct use of `interactive'.

	(rst-classify-adornment, rst-find-all-adornments)
	(rst-get-hierarchy, rst-adjust-adornment, rst-toc-update)
	(rst-find-leftmost-column, rst-repeat-last-character):
	Refactor functions.

	(rst-find-title-line, rst-reset-section-caches)
	(rst-get-adornments-around, rst-adjust-adornment-work)
	(rst-arabic-to-roman, rst-roman-to-arabic)
	(rst-insert-list-pos, rst-insert-list-new-item)
	(rst-insert-list-continue, rst-insert-list, rst-forward-line):
	New functions.

	(rst-all-sections, rst-section-hierarchy)
	(rst-arabic-to-roman, rst-initial-enums, rst-initial-items):
	New variables.

	(rst-toc-return-wincfg, rst-toc-quit-window): Use window
	configuration instead of only buffer.  Change where necessary.

	(rst-line-tabs, rst-compute-tabs, rst-indent-line)
	(rst-shift-region, rst-adaptive-fill): New functions for
	indentation and filling.

	(rst-comment-line-break, rst-comment-indent)
	(rst-comment-insert-comment, rst-comment-region)
	(rst-uncomment-region): New functions for handling comments.

	(rst-compile): Quote shell arguments.

	(rst-compile-pdf-preview, rst-compile-slides-preview):
	Delete temporary files after use.

2012-05-05  Glenn Morris  <rgm@gnu.org>

	* calendar/cal-html.el: Optionally include holidays in the output.
	Suggested by Ed Reingold <reingold@emr.cs.iit.edu>.
	(cal-html-holidays): New option.
	(cal-html-css-default): Add holiday entry.
	(holiday-in-range): Autoload it.
	(cal-html-htmlify-entry): Add optional class argument.
	(cal-html-htmlify-list): Add optional holidays argument.
	(cal-html-insert-agenda-days): Include holidays in the output.
	(cal-html-one-month): Maybe include holidays.

	* calendar/holidays.el (holiday-in-range):
	Move here from cal-tex-list-holidays.
	* calendar/cal-tex.el (cal-tex-list-holidays):
	Make it an obsolete alias for holiday-in-range.  Update all callers.

2012-05-05  Chong Yidong  <cyd@gnu.org>

	* select.el (xselect--encode-string): Always use utf-8 for TEXT on
	Nextstep.

2012-05-05  Ransom Williams  <auvergnerw@gmail.com>  (tiny change)

	* files.el (file-auto-mode-skip): New var.
	(set-auto-mode-1): Use it.

2012-05-05  Stefan Monnier  <monnier@iro.umontreal.ca>

	* repeat.el: Use lexical-binding.
	(repeat-last-self-insert, repeat-num-input-keys-at-self-insert)
	(repeat-undo-count): Remove.
	(repeat):
	* progmodes/octave-mod.el (octave-abbrev-start):
	* progmodes/f90.el (f90-abbrev-start):
	* face-remap.el (text-scale-adjust):
	* kmacro.el (kmacro-call-macro): Use set-temporary-overlay-map.

	* emacs-lisp/pcase.el (pcase--let*): New function.
	(pcase--expand, pcase-codegen, pcase--q1): Use it to reduce nesting
	a bit more.
	(pcase--split-pred): Be more clever about ruling out overlap between
	a predicate and some constant pattern.
	(pcase--q1): Use `null' instead of (eq foo nil).

	* subr.el (setq-local, defvar-local): New macros.
	(kbd): Redefine as an alias.
	(with-selected-window): Leave unrelated frames alone.
	(set-temporary-overlay-map): New function.

2012-05-04  Stefan Monnier  <monnier@iro.umontreal.ca>

	* subr.el (user-error): New function.
	* window.el (switch-to-buffer):
	* vc/smerge-mode.el (smerge-resolve-function, smerge-resolve)
	(smerge-match-conflict):
	* simple.el (previous-matching-history-element)
	(next-matching-history-element, goto-history-element, undo-more)
	(undo-start):
	* progmodes/etags.el (visit-tags-table-buffer, find-tag-tag)
	(find-tag-noselect, find-tag-in-order, etags-goto-tag-location)
	(next-file, tags-loop-scan, list-tags, complete-tag):
	* progmodes/compile.el (compilation-loop):
	* mouse.el (mouse-minibuffer-check):
	* man.el (Man-bgproc-sentinel, Man-goto-page):
	* info.el (Info-find-node-2, Info-extract-pointer, Info-history-back)
	(Info-history-forward, Info-follow-reference, Info-menu)
	(Info-extract-menu-item, Info-extract-menu-counting)
	(Info-forward-node, Info-backward-node, Info-next-menu-item)
	(Info-last-menu-item, Info-next-preorder, Info-last-preorder)
	(Info-next-reference, Info-prev-reference, Info-index)
	(Info-index-next, Info-follow-nearest-node)
	(Info-copy-current-node-name):
	* imenu.el (imenu--make-index-alist)
	(imenu-default-create-index-function, imenu-add-to-menubar):
	* files.el (basic-save-buffer, recover-file):
	* emacs-lisp/easy-mmode.el (easy-mmode-define-navigation):
	* emacs-lisp/checkdoc.el (checkdoc-continue, checkdoc-comments)
	(checkdoc-message-text, checkdoc-defun):
	* dabbrev.el (dabbrev-completion, dabbrev--abbrev-at-point):
	* cus-edit.el (customize-changed-options, customize-rogue)
	(customize-saved, custom-variable-set, custom-variable-mark-to-save)
	(custom-variable-mark-to-reset-standard)
	(custom-variable-reset-backup, custom-face-mark-to-reset-standard)
	(custom-file):
	* completion.el (check-completion-length):
	* comint.el (comint-search-arg)
	(comint-previous-matching-input-string-position)
	(comint-previous-matching-input)
	(comint-replace-by-expanded-history-before-point, comint-send-input)
	(comint-copy-old-input, comint-backward-matching-input)
	(comint-goto-process-mark, comint-set-process-mark):
	* calendar/calendar.el (calendar-cursor-to-date): Use it.
	* bindings.el (debug-ignored-errors): Remove regexps, add `user-error'.

2012-05-04  Stefan Monnier  <monnier@iro.umontreal.ca>

	* dabbrev.el (dabbrev--ignore-case-p): New function.
	(dabbrev-completion, dabbrev-expand, dabbrev--substitute-expansion):
	Use it.

	* files.el (automount-dir-prefix): Mark as obsolete.

2012-05-04  Glenn Morris  <rgm@gnu.org>

	* patcomp.el, play/bruce.el: Move to obsolete/.

2012-05-04  Paul Eggert  <eggert@cs.ucla.edu>

	Fix minor Y10k bugs.
	* arc-mode.el (archive-unixdate):
	* autoinsert.el (auto-insert-alist):
	* calc/calc-forms.el (math-this-year):
	* emacs-lisp/copyright.el (copyright-current-year)
	(copyright-update-year, copyright):
	* tar-mode.el (tar-clip-time-string):
	* time.el (display-time-update):
	Don't assume years have 4 digits.

2012-05-04  Chong Yidong  <cyd@gnu.org>

	* dos-w32.el (file-name-buffer-file-type-alist)
	(direct-print-region-use-command-dot-com):
	* ffap.el (ffap-menu-regexp):
	* find-file.el (ff-special-constructs):
	* follow.el (follow-debug):
	* forms.el (forms--debug):
	* iswitchb.el (iswitchb-all-frames):
	* ido.el (ido-all-frames):
	* emacs-lisp/timer.el (timer-max-repeats):
	* mail/feedmail.el (feedmail-mail-send-hook)
	(feedmail-mail-send-hook-queued):
	* mail/footnote.el (footnote-signature-separator):
	* mail/mailabbrev.el (mail-alias-separator-string)
	(mail-abbrev-mode-regexp):
	* mail/rmail.el (rmail-speedbar-match-folder-regexp):
	* progmodes/idlwave.el (idlwave-libinfo-file)
	(idlwave-default-completion-case-is-down)
	(idlwave-library-routines): Convert defvars to defcustoms.

	* mail/rmail.el (rmail-decode-mime-charset):
	* progmodes/idlw-shell.el (idlwave-shell-print-expression-function)
	(idlwave-shell-fix-inserted-breaks)
	(idlwave-shell-activate-alt-keybindings)
	(idlwave-shell-use-breakpoint-glyph):
	* facemenu.el (facemenu-unlisted-faces): Delete obsolete vars.

2012-05-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuffer.el (completion--twq-all): Beware completion-ignore-case.

2012-05-03  Wilson Snyder  <wsnyder@wsnyder.org>

	* progmodes/verilog-mode.el (font-lock-keywords):
	Fix mis-highligting auto.  Reported by Craig Barner.
	(verilog-auto, verilog-auto-undef): Add AUTOUNDEF to remove
	defines from global name space.  Reported by Dan Dever.
	(verilog-auto-reset, verilog-auto-reset-widths)
	(verilog-auto-tieoff): Support using unbased numbers for
	AUTORESET and AUTOTIEOFF.
	(verilog-submit-bug-report): Update variable list.
	(verilog-read-auto-params): Fix AUTOINPUT regexps containing
	parenthesis from not matching.  Reported by Michael Rytting.
	(verilog-auto-template-lint): Fix hash error when linting modules
	with no used templates.
	(verilog-warn, verilog-warn-error)
	(verilog-warn-fatal): When non-interactive report multiple
	warnings before exiting.  Suggested by Brad Dobbie.
	(verilog-auto-template-lint, verilog-auto-template-warn-unused)
	(verilog-read-auto-template): Add `verilog-auto-template-warn-unused'
	to report unused template errors.  Reported by Brad Dobbie.
	(verilog-read-decls): Fix AUTOWIRE etc on supply0, supply1 type
	nets, bug438.  Reported by Vns Blore.
	(verilog-auto-inout-module, verilog-auto-reg)
	(verilog-read-decls, verilog-read-sub-decls-sig)
	(verilog-signals-edit-wire-reg, verilog-signals-with):
	Fix passing of Verilog data types in ANSI input/output ports
	such as "output logic" into the AUTOs.  Special case "wire" and
	"reg" for backwards compatibility presuming Verilog 2001.
	(verilog-auto-ascii-enum): Add "auto enum" as alias.
	(verilog-preprocess): Fix replication of preprocess output.
	Reported by Brad Dobbie.
	(verilog-auto-inst-interfaced-ports):
	Create verilog-auto-inst-interfaced-ports, bug429.
	Reported by Julian Gorfajn.
	(verilog-after-save-font-hook)
	(verilog-before-save-font-hook): New variable.
	(verilog-modi-cache-results, verilog-save-font-mod-hooked)
	(verilog-save-font-mods): Wrap disabling fontification, reported
	by David Rogoff.
	(verilog-do-indent, verilog-pretty-declarations-auto)
	(verilog-sk-def-reg): Fix obeying `verilog-auto-lineup', bug305.
	Reported by Pierre-David Pfister.
	(verilog-set-auto-endcomments): Fix endtask auto comments outside
	of class declarations, bug292.  Reported by Kevin Heilman.
	(verilog-read-decls): Fix 'parameter type' not appearing in
	AUTOINSTPARAM, bug340.  Reported by Jonathan Greenlaw.
	(verilog-auto-logic): Fix when AUTOLOGIC present to properly do
	AUTOINPUTs, bug411.  Reported by Jonathan Greenlaw.
	(verilog-read-auto-lisp): Avoid syntax-ppss warning on AUTOLISP.
	Reported by David Kravitz.

2012-05-03  Michael McNamara  <mac@mail.brushroad.com>

	* progmodes/verilog-mode.el (verilog-pretty-expr): Don't line up
	assignment with tests in ifs and for loops.
	(verilog-extended-complete-re, verilog-complete-reg): Change so
	that DPI inport functions don't look like function declarations.
	(verilog-pretty-expr): Don't line up assignment
	operations to the test and increment in if and for loops
	(verilog-extended-complete-re, verilog-complete-reg): Change so
	that DPI inport functions don't look like function declarations.

2012-05-03  Kenichi Handa  <handa@m17n.org>

	* mail/rmailmm.el (rmail-show-mime): Catch an error caused by text
	decoding, and show a warning message without signaling an error
	(Bug#11282).

2012-05-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/bytecomp.el
	(byte-compile-file-form-custom-declare-variable): Compile all elements,
	since cconv.el might have introduced :fun-body, internal-make-closure,
	and friends for bytecomp to handle (bug#11391).
	* custom.el (defcustom): Avoid ((λ ..) ..).

2012-05-02  Stefan Monnier  <monnier@iro.umontreal.ca>

	* subr.el (read-passwd): Better clean after ourselves (bug#11392).

2012-05-02  Juanma Barranquero  <lekktu@gmail.com>

	* notifications.el (dbus-debug):
	* term/linux.el (gpm-mouse-enable):
	* term/screen.el (xterm-register-default-colors): Declare.

2012-05-02  Chong Yidong  <cyd@gnu.org>

	* cus-start.el (gc-cons-percentage, exec-suffixes)
	(dos-display-scancodes, dos-hyper-key, dos-super-key)
	(dos-keypad-mode, debug-on-signal, vertical-centering-font-regexp)
	(make-cursor-line-fully-visible, void-text-area-pointer)
	(font-list-limit): Add customization data.

	* allout.el (allout-exposure-change-functions)
	(allout-structure-added-functions)
	(allout-structure-deleted-functions)
	(allout-structure-shifted-functions): Rename abnormal hooks from
	*-hook, and convert to defcustoms.
	(allout-after-copy-or-kill-hook, allout-post-undo-hook):
	Convert to defcustoms.
	(allout-mode-hook, allout-mode-deactivate-hook): Doc fix.

	* allout-widgets.el: Hook callers changed.

2012-05-02  Eli Zaretskii  <eliz@gnu.org>

	* mail/rmail.el (rmail-yank-current-message): Use the encoding of
	the yanked message in preference to the default value of
	buffer-file-coding-system.

2012-05-02  Martin Rudalics  <rudalics@gmx.at>

	* window.el (display-buffer--action-function-custom-type):
	Fix entry.

2012-05-02  Alan Mackenzie  <acm@muc.de>

	* progmodes/cc-defs.el (c-version): Update to 5.32.3.

2012-05-01  Glenn Morris  <rgm@gnu.org>

	* cus-start.el (suggest-key-bindings): Remove, now it is in Lisp.

	* eshell/esh-cmd.el (eshell-debug-command): Doc fix.  Add :set.

	* cus-edit.el (custom-variable-documentation): Simplify with format.

2012-05-01  Aaron S. Hawley  <aaron.s.hawley@gmail.com>
	    Stefan Monnier  <monnier@iro.umontreal.ca>

	* simple.el (suggest-key-bindings, execute-extended-command):
	Move from keyboard.c.

2012-05-01  Chong Yidong  <cyd@gnu.org>

	* follow.el: Eliminate advice.
	(set-process-filter, process-filter, sit-for): Advice deleted.
	(follow-mode-off-hook): Obsolete hook removed.
	(follow-avoid-tail-recenter-p, follow-process-filter-alist):
	Vars deleted.
	(follow-auto): Use a :set function.
	(follow-mode): Rewritten.  Don't advise process filters.
	(follow-switch-to-current-buffer-all, follow-scroll-up)
	(follow-scroll-down): Assume follow-mode is bound.
	(follow-comint-scroll-to-bottom)
	(follow-align-compilation-windows): New functions.
	(follow--window-sorter): New function.
	(follow-all-followers): Use it to explicitly sort windows by their
	positions; don't make assumptions about next-window order.
	(follow-windows-start-end, follow-delete-other-windows-and-split)
	(follow-calc-win-start): Doc fix.
	(follow-windows-aligned-p, follow-select-if-visible): Don't call
	vertical-motion unnecessarily.
	(follow-adjust-window): New function.
	(follow-post-command-hook): Use it.
	(follow-call-set-process-filter, follow-call-process-filter)
	(follow-intercept-process-output, follow-tidy-process-filter-alist)
	(follow-stop-intercept-process-output, follow-generic-filter):
	Functions deleted.
	(follow-scroll-bar-toolkit-scroll, follow-scroll-bar-drag)
	(follow-scroll-bar-scroll-up, follow-scroll-bar-scroll-down):
	New functions, replacing advice on scroll-bar-* commands.
	(follow-mwheel-scroll): New function (Bug#4112).

	* comint.el (comint-adjust-point): New function.
	(comint-postoutput-scroll-to-bottom): Use it.
	Call follow-comint-scroll-to-bottom for Follow mode buffers.

2012-05-01  Glenn Morris  <rgm@gnu.org>

	* term/AT386.el, term/apollo.el, term/bobcat.el, term/cygwin.el:
	* term/iris-ansi.el, term/linux.el, term/lk201.el, term/news.el:
	* term/screen.el, term/vt102.el, term/vt125.el, term/vt200.el:
	* term/vt201.el, term/vt220.el, term/vt240.el, term/vt300.el:
	* term/vt320.el, term/vt400.el, term/vt420.el, term/wyse50.el:
	Remove no-byte-compile setting.

2012-05-01  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuffer.el (completion-table-with-quoting): Fix compatibility
	all-completions code to not return a number in the last cdr.

2012-04-30  Leo Liu  <sdl.web@gmail.com>

	* ibuf-ext.el (ibuffer-diff-buffer-with-file-1): Avoid buffer
	read-only error.

2012-04-29  Chong Yidong  <cyd@gnu.org>

	* follow.el (follow-calc-win-end): Rewrite to handle partial
	screen lines correctly (Bug#8390).
	(follow-avoid-tail-recenter): Minor cleanup.

2012-04-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	Avoid the obsolete `assoc' package.
	* speedbar.el (speedbar-refresh): Avoid adelete.
	(speedbar-file-lists): Simplify and avoid aput.
	* man.el (Man--sections, Man--refpages): New vars, replacing
	Man-sections-alist and Man-refpages-alist.
	(Man-build-section-alist, Man-build-references-alist):
	Use them; avoid aput.
	(Man--last-section, Man--last-refpage): New vars.
	(Man-follow-manual-reference): Use them.
	Use the `default' arg of completing-read.
	(Man-goto-section): Idem.  Move prompt to the `interactive' spec.

2012-04-27  Chong Yidong  <cyd@gnu.org>

	* vc/diff.el (diff-sentinel): Go to bob (Bug#10259).

	* startup.el (x-apply-session-resources): New function.

	* term/ns-win.el (ns-initialize-window-system):
	* term/w32-win.el (w32-initialize-window-system):
	* term/x-win.el (x-initialize-window-system): Use it to properly
	set menu-bar-mode and other vars from X resources, even if the
	initial frame is not a window-system frame (Bug#2299).

	* subr.el (read-key): Avoid running filter function when setting
	up temporary tool bar entries (Bug#9922).

2012-04-27  Andreas Schwab  <schwab@linux-m68k.org>

	* vc/vc-git.el (vc-git-state): Fix regexp matching diff output.
	(Bug#11344)

2012-04-27  Chong Yidong  <cyd@gnu.org>

	* select.el (xselect--encode-string): New function, split from
	xselect-convert-to-string.
	(xselect-convert-to-string): Use it.
	(xselect-convert-to-filename, xselect-convert-to-os)
	(xselect-convert-to-host, xselect-convert-to-user): Ensure that
	returned strings are properly encoded (Bug#11315).

2012-04-27  Chong Yidong  <cyd@gnu.org>

	* simple.el (delete-active-region): Move to killing custom group.

2012-04-27  Andreas Schwab  <schwab@linux-m68k.org>

	* progmodes/which-func.el (which-func-current): Quote %
	characters for mode-line processing.

2012-04-27  Chong Yidong  <cyd@gnu.org>

	* xml.el (xml-parse-region, xml-parse-tag): Avoid errors due to
	reaching eob (Bug#11286).

2012-04-27  Eli Zaretskii  <eliz@gnu.org>

	* progmodes/gdb-mi.el (gdb-control-level): New variable.
	(gdb): Make it buffer-local and init to zero.
	(gdb-control-commands-regexp): New variable.
	(gdb-send): Don't wrap in "-interpreter-exec console" if
	gdb-control-level is positive.  Increment gdb-control-level
	whenever the command matches gdb-control-commands-regexp, and
	decrement it each time the command is "end".  (Bug#11279)

2012-04-27  Martin Rudalics  <rudalics@gmx.at>

	* window.el (adjust-window-trailing-edge, enlarge-window)
	(shrink-window, window-resize):
	* mouse.el (mouse-drag-line): Fix resizing of minibuffer
	windows (Bug#11276).

2012-04-27  Chong Yidong  <cyd@gnu.org>

	* progmodes/pascal.el (pascal--extra-indent): Rename from ind, to
	fix "missing prefix" warning.  All callers changed.

2012-04-27  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/assoc.el: Move to obsolete/.

2012-04-26  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/assoc.el (aget): Fix dynamic-scoping issue (bug#11352).

	* term/ns-win.el (ns-define-service):
	* progmodes/pascal.el (pascal-goto-defun):
	* progmodes/js.el (js--read-tab):
	* progmodes/etags.el (tags-lazy-completion-table):
	* emacs-lisp/syntax.el (syntax-propertize-via-font-lock):
	* emacs-lisp/ewoc.el (ewoc--wrap):
	* emacs-lisp/assoc.el (aput, adelete, amake):
	* doc-view.el (doc-view-convert-current-doc):
	* vc/diff.el (diff-no-select): Replace lexical-let by lexical-binding.

2012-04-26  Chong Yidong  <cyd@gnu.org>

	* image.el (image-type-from-buffer): Only return supported image
	type (Bug#9045).

	* vc/diff-mode.el (diff-beginning-of-hunk): Return a meaningful
	value, for symmetry with diff-end-of-hunk.
	(diff-split-hunk, diff-find-source-location)
	(diff-ignore-whitespace-hunk, diff-refine-hunk): Use it.
	(diff-bounds-of-hunk, diff-bounds-of-file): New functions.
	(diff-restrict-view, diff-hunk-kill, diff-file-kill): Use them to
	compute the relevant hunk or file properly (Bug#6005).
	(diff-file-junk-re): Add bzr's "modified file" tag (Bug#6041).

2012-04-26  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc/vc-mtn.el:
	* vc/vc-hg.el:
	* vc/vc-git.el:
	* vc/vc-dir.el:
	* vc/vc-cvs.el:
	* vc/vc-bzr.el:
	* vc/vc-arch.el:
	* vc/vc.el: Replace lexical-let by lexical-binding.
	* minibuffer.el (lazy-completion-table): Avoid ((λ ...) ...).
	* emacs-lisp/cl-macs.el (lexical-let): Fix use in lexical-binding.
	* emacs-lisp/cconv.el (cconv-analyse-form): Warn use of ((λ ...) ...).

2012-04-26  Chong Yidong  <cyd@gnu.org>

	* vc/diff-mode.el (diff-undo): New command (Bug#5302).
	(diff-mode-shared-map): Bind it to / and [remap undo].

	* vc/ediff-wind.el (ediff-setup-windows-default): New function.
	(ediff-window-setup-function): Use it as the default, to set up
	windows based on whether the current frame is graphical (Bug#2138).
	(ediff-choose-window-setup-function-automatically): Make obsolete.

	* vc/ediff-init.el: Always define ediff-pixel-width/height.

2012-04-25  Stefan Monnier  <monnier@iro.umontreal.ca>

	* ffap.el: Remove old code for obsolete package.
	(ffap-complete-as-file-p): Remove.

	Use completion-table-with-quoting for comint and pcomplete.
	* comint.el (comint--unquote&requote-argument)
	(comint--unquote-argument, comint--requote-argument): New functions.
	(comint--unquote&expand-filename, comint-unquote-filename): Obsolete.
	(comint-quote-filename): Use regexp-opt-charset.
	(comint--common-suffix, comint--common-quoted-suffix)
	(comint--table-subvert): Remove.
	(comint-unquote-function, comint-requote-function): New vars.
	(comint--complete-file-name-data): Use them with
	completion-table-with-quoting.
	* pcmpl-unix.el (pcomplete/scp): Use completion-table-subvert.
	* pcomplete.el (pcomplete-arg-quote-list)
	(pcomplete-quote-arg-hook, pcomplete-quote-argument): Obsolete.
	(pcomplete-unquote-argument-function): Default to non-nil.
	(pcomplete-unquote-argument): Simplify.
	(pcomplete--common-quoted-suffix): Remove.
	(pcomplete-requote-argument-function): New var.
	(pcomplete--common-suffix): New function.
	(pcomplete-completions-at-point): Use completion-table-with-quoting
	and completion-table-subvert.

	* minibuffer.el: Use completion-table-with-quoting for read-file-name.
	(minibuffer--double-dollars): Preserve properties.
	(completion--sifn-requote): New function.
	(completion--file-name-table): Rewrite using it and c-t-with-quoting.

	* minibuffer.el: Add support for completion of quoted/escaped data.
	(completion-table-with-quoting, completion-table-subvert): New funs.
	(completion--twq-try, completion--twq-all): New functions.
	(completion--nth-completion): New function.
	(completion-try-completion, completion-all-completions): Use it.

2012-04-25  Leo Liu  <sdl.web@gmail.com>

	* progmodes/python.el (python-pdbtrack-get-source-buffer):
	Use compilation-message if available to find real filename.

2012-04-25  Chong Yidong  <cyd@gnu.org>

	* vc/diff-mode.el (diff-setup-whitespace): New function.
	(diff-mode): Use it.

	* vc/diff.el (diff-sentinel):
	* vc/vc.el (vc-diff-finish): Call diff-setup-whitespace to assign
	Whitespace mode variables based on diff style (Bug#8612).

2012-04-25  Leo Liu  <sdl.web@gmail.com>

	* progmodes/python.el (python-send-region): Add suffix .py to the
	temp file.

	* files.el (auto-mode-alist): Use javascript-mode instead.

2012-04-25  Alex Harsanyi  <AlexHarsanyi@gmail.com>

	Sync with soap-client repository.  Support SOAP simpleType (Bug#10331).

	* net/soap-client.el (soap-resolve-references-for-sequence-type)
	(soap-resolve-references-for-array-type): Hack to prevent self
	references, see Bug#9.
	(soap-parse-envelope): Report the contents of the 'detail' node
	when receiving a fault reply.
	(soap-parse-envelope): Report the contents of the entire 'detail' node.

	* net/soap-inspect.el (soap-sample-value-for-simple-type)
	(soap-inspect-simple-type): New function.

	* net/soap-client.el (soap-simple-type): New struct.
	(soap-default-xsd-types, soap-default-soapenc-types)
	(soap-decode-basic-type, soap-encode-basic-type):
	support unsignedInt and double basic types.
	(soap-resolve-references-for-simple-type)
	(soap-parse-simple-type, soap-encode-simple-type): New function.
	(soap-parse-schema): Parse xsd:simpleType declarations.

	* net/soap-client.el (soap-default-xsd-types)
	(soap-default-soapenc-types): Add integer, byte and anyURI types.
	(soap-parse-complex-type-complex-content): Use `soap-wk2l' to find
	the local name of "soapenc:Array".
	(soap-decode-basic-type, soap-encode-basic-type): Support encoding
	decoding integer, byte and anyURI xsd types.

2012-04-25  Chong Yidong  <cyd@gnu.org>

	* cus-edit.el (custom-buffer-create-internal): Update header text.

2012-04-25  Eli Zaretskii  <eliz@gnu.org>

	* progmodes/gdb-mi.el (gdb-init-1): Condition Windows-specific
	settings on 'system-type', not on 'window-system'.  On MS-Windows,
	set interactive-mode on in GDB.

2012-04-24  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/ruby-mode.el: Simplify last change, and cleanup code.
	(ruby-syntax-propertize-regexp): Remove.
	(ruby-syntax-propertize-function): Split regexp into chunks.
	Match following code directly.

2012-04-24  Dmitry Gutov  <dgutov@yandex.ru>

	* progmodes/ruby-mode.el: Handle Cucumber defs (bug#6286).
	(ruby-syntax-propertize-regexp): New function.
	(ruby-syntax-propertize-function): Use it to handle regexp not preceded
	by a special keyword.

	* progmodes/ruby-mode.el: Handle general delimited literals (bug#6286).
	(ruby-syntax-general-delimiters-goto-beg)
	(ruby-syntax-propertize-general-delimiters): New functions.
	(ruby-syntax-propertize-function): Use them to handle GDL.
	(ruby-font-lock-keywords): Move old handling of GDL...
	(ruby-font-lock-syntactic-keywords): .. to here.
	(ruby-calculate-indent): Adjust indentation for GDL.

2012-04-24  Michael Albinus  <michael.albinus@gmx.de>

	* notifications.el (top): Remove unneeded declarations.
	(notifications-specification-version): Change to "1.2".
	(notifications-interface, notifications-notify-method)
	(notifications-close-notification-method): Fix docstring.
	(notifications-get-capabilities-method): New defconst.
	(notifications-notify): Add :action-items, :resident and
	:transient hints.  Change "image_data" to "image-data" and
	"image_path" to "image-path".
	(notifications-get-capabilities): New defun.

2012-04-24  Leo Liu  <sdl.web@gmail.com>

	* progmodes/python.el: Move hideshow setup to the end.

2012-04-24  Martin Rudalics  <rudalics@gmx.at>

	* window.el (handle-select-window): Clear echo area since this is
	no more done by read_char (Bug#11304).

2012-04-24  Stefan Monnier  <monnier@iro.umontreal.ca>

	* ibuffer.el (ibuffer-mode-map): Bind `/ m' to filter-used-mode
	and `/ M' to filter-derived-mode.
	* ibuf-ext.el (ibuffer-list-buffer-modes): Simplify; avoid add-to-list.
	(ibuffer-filter-by-mode, ibuffer-filter-by-used-mode)
	(ibuffer-mark-by-mode): Use default rather than initial-input.
	(ibuffer-filter-by-derived-mode): Autoload and require-match.

2012-04-24  Ivan Andrus  <darthandrus@gmail.com>  (tiny change)

	* ibuf-ext.el (ibuffer-list-buffer-modes): Add `include-parents' arg.
	(ibuffer-filter-by-derived-mode): New filter.
	* ibuffer.el (ibuffer-mode-map): Bind to `/ w'.

2012-04-23  Andreas Politz  <politza@fh-trier.de>

	* subr.el (accept-change-group): Fix arg usage (Bug#6095).

2012-04-23  Chong Yidong  <cyd@gnu.org>

	* cus-edit.el (customize-apropos, customize-apropos-options):
	Disable matching of non-option variables (Bug#11176).
	(customize-option, customize-option-other-window)
	(customize-changed-options): Doc fix.
	(customize-apropos-options, customize-apropos-faces)
	(customize-apropos-groups): Use apropos-read-pattern (Bug#11124).

	* apropos.el (apropos-read-pattern): Make prompt less cryptic.
	Fix word list splitting (Bug#11132).
	(apropos-symbol, apropos-keybinding, apropos-label)
	(apropos-property, apropos-function-button)
	(apropos-variable-button, apropos-misc-button): New faces.
	(apropos-symbol-face, apropos-keybinding-face)
	(apropos-label-face, apropos-property-face, apropos-match-face):
	Variables removed (Bug#8396).
	(apropos-library-button, apropos-format-plist, apropos-print)
	(apropos-print-doc, apropos-describe-plist): Callers changed.

2012-04-23  Michael Albinus  <michael.albinus@gmx.de>

	* net/xesam.el (xesam-mode-map): Use let-bound map in
	initialization.  (Bug#11292)

2012-04-23  Agustín Martín Domingo  <agustin.martin@hispalinux.es>

	Preserve ispell session localwords when switching back to
	original buffer.

	* textmodes/ispell.el (ispell-buffer-session-localwords):
	New buffer-local variable to hold buffer session localwords.
	(ispell-kill-ispell): Add option 'clear to delete session
	localwords.
	(ispell-command-loop, ispell-change-dictionary)
	(ispell-buffer-local-words): Preserve session localwords when
	needed.

	* textmodes/flyspell.el (flyspell-process-localwords)
	(flyspell-do-correct): Preserve session localwords when needed.

2012-04-23  Agustín Martín Domingo  <agustin.martin@hispalinux.es>

	* textmodes/ispell.el (ispell-insert-word) Remove unneeded function
	using obsolete `translation-table-for-input'.
	(ispell-word, ispell-process-line, ispell-complete-word):
	Use plain `insert' instead of removed `ispell-insert-word'.

2012-04-22  Chong Yidong  <cyd@gnu.org>

	* cus-edit.el (custom-variable-menu)
	(custom-variable-reset-saved, custom-face-menu)
	(custom-face-reset-saved): If there is no saved value, make the
	"reset-saved" operation bring back the default (Bug#9509).
	(custom-face-state): Properly detect themed faces.

	* faces.el (face-spec-set): Stop supporting deprecated form of
	third arg.

2012-04-22  Michael Albinus  <michael.albinus@gmx.de>

	Move functions from C to Lisp.  Make non-blocking method calls
	the default.  Implement further D-Bus standard interfaces.

	* net/dbus.el (dbus-message-internal): Declare function.
	Remove unneeded function declarations.
	(defvar dbus-message-type-invalid, dbus-message-type-method-call)
	(dbus-message-type-method-return, dbus-message-type-error)
	(dbus-message-type-signal): Declare variables.  Remove local
	definitions.
	(dbus-interface-dbus, dbus-interface-peer)
	(dbus-interface-introspectable, dbus-interface-properties)
	(dbus-path-emacs, dbus-interface-emacs, dbus-return-values-table):
	Adapt docstring.
	(dbus-interface-objectmanager): New defconst.
	(dbus-call-method, dbus-call-method-asynchronously)
	(dbus-send-signal, dbus-method-return-internal)
	(dbus-method-error-internal, dbus-register-service)
	(dbus-register-signal, dbus-register-method): New defuns, moved
	from dbusbind.c
	(dbus-call-method-handler, dbus-setenv)
	(dbus-get-all-managed-objects, dbus-managed-objects-handler):
	New defuns.
	(dbus-call-method-non-blocking): Make it an obsolete function.
	(dbus-unregister-object, dbus-unregister-service)
	(dbus-handle-event, dbus-register-property)
	(dbus-property-handler): Obey the new structure of
	`bus-registered-objects'.
	(dbus-introspect): Use `dbus-call-method'.  Use a timeout.
	(dbus-get-property, dbus-set-property, dbus-get-all-properties):
	Use `dbus-call-method'.

2012-04-22  Chong Yidong  <cyd@gnu.org>

	* cus-edit.el (custom-commands, custom-reset-menu)
	(Custom-reset-standard): Tweak labels.
	(custom-reset-button-menu): Change default to t.
	(custom-buffer-create-internal): For the custom-reset-button-menu
	case, put the revert button first.
	(custom-group-subtitle): New face.
	(custom-group-value-create): Align docstring to a specific column.

	* wid-edit.el (widget-documentation-link-add): Don't handle
	indentation in this function.
	(widget-documentation-string-indent-to): New function.
	(widget-documentation-string-value-create): Use it.

	* autorevert.el (auto-revert):
	* epg-config.el (epg):
	* ibuffer.el (ibuffer):
	* mpc.el (mpc):
	* ses.el (ses):
	* eshell/eshell.el (eshell):
	* net/ange-ftp.el (ange-ftp):
	* progmodes/ebnf2ps.el (postscript):
	* progmodes/flymake.el (flymake):
	* progmodes/prolog.el (prolog):
	* progmodes/verilog-mode.el (verilog-mode):
	* progmodes/which-func.el (which-func):
	* term/xterm.el (xterm):
	* textmodes/picture.el (picture):
	* textmodes/tildify.el (tildify):
	* vc/ediff.el (ediff): Tweak defgroups to improve presentation in
	customization buffers.

2012-04-22  Alan Mackenzie  <acm@muc.de>

	* progmodes/cc-engine.el (c-append-lower-brace-pair-to-state-cache):
	Adding a ) can hide the resulting (..) from searches.  Fix it.
	Bound the backward search to the position of the existing (.

2012-04-21  Juanma Barranquero  <lekktu@gmail.com>

	* progmodes/verilog-mode.el (verilog-mode): Check whether
	which-func-modes is t before adding verilog-mode.
	Reported by Andy Moreton <andrewjmoreton@gmail.com>.

2012-04-21  Leo Liu  <sdl.web@gmail.com>

	* net/rcirc.el (rcirc): Avoid error when process-contact returns t.

2012-04-21  Michael Vehrs  <Michael.Burschik@gmx.de>

	* woman.el: Add support for "T{ T}" tbl syntax, and fix the
	filling of the last column of a table (Bug#5635).
	(woman-find-next-control-line): New arg, specifying an additional
	regexp component for the control line.
	(woman2-roff-buffer): Use it.
	(woman-break-table): New function.
	(woman2-TS): Use it.

2012-04-21  Chong Yidong  <cyd@gnu.org>

	* woman.el (woman-set-buffer-display-table, woman-decode-region)
	(woman-horizontal-escapes, woman-negative-vertical-space)
	(woman-tab-to-tab-stop, woman2-fc, woman2-TS)
	(WoMan-warn-ignored): Use ?\s instead of ?\ .

2012-04-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuffer.el (completion-file-name-table): Complete user names.

2012-04-20  Leo Liu  <sdl.web@gmail.com>

	* font-lock.el (lisp-font-lock-keywords-2): Add pcase, pcase-let
	and pcase-let*.

2012-04-20  Chong Yidong  <cyd@gnu.org>

	* server.el (server-execute): Respect initial-buffer-choice if it
	is a string and there are no files to open (Bug#2825).
	(server-create-window-system-frame, server-create-tty-frame):
	Don't switch buffers here.
	(server-process-filter): Only try to open a window system frame if
	compiled with graphical support (Bug#8314).

2012-04-20  Dan Nicolaescu  <dann@gnu.org>

	* battery.el (battery-echo-area-format): Display remaining time
	for sysfs backend too (Bug#11269).
	(battery-linux-sysfs): Fix conditional for the charge.

2012-04-20  Chong Yidong  <cyd@gnu.org>

	* progmodes/gdb-mi.el (gdb): Revert previous change.
	(gdb-inferior-io--init-proc): New function.
	(gdb-init-1): Use it.
	(gdb-inferior-io-sentinel): New sentinel for the gdb-inferior pty,
	responsible for allocating a new pty and hooking it to gdb when
	the old pty gets an EIO due to process exit.
	(gdb-delchar-or-quit): New command.  Bind it in gdb-mi buffers.
	(gdb-tooltip-print): Don't use obsolete tooltip-use-echo-area.
	(gdb-inferior-io--maybe-delete-pty): Move into gdb-reset.

2012-04-20  Eli Zaretskii  <eliz@gnu.org>

	* window.el (window-min-size, window-sizable, window-min-delta)
	(window-max-delta, window--resizable, window-resizable)
	(window-total-size, window-full-height-p, window-full-width-p)
	(window-in-direction, window--resize-mini-window, window-resize)
	(window--resize-child-windows-normal)
	(window--resize-child-windows, window--resize-siblings)
	(window--resize-this-window, adjust-window-trailing-edge)
	(enlarge-window, shrink-window): Doc fixes.

2012-04-20  Chong Yidong  <cyd@gnu.org>

	* progmodes/gdb-mi.el (gdb-inferior-io--maybe-delete-pty):
	New function to call delete-process on the gdb-inferior buffer's pty.
	(gdb-reset): Use it, instead of relying on kill-buffer to kill the
	pty process (Bug#11273).
	(gdb-update): New arg to suppress talking to the gdb process.
	(gdb-done-or-error): Use it.
	(gdb-stopped-functions): Rename from gdb-stopped-hooks.
	(gdb): Call gdb-inferior-io--maybe-delete-pty as a workaround for
	sentinel not being called.

	* comint.el (make-comint-in-buffer, comint-exec): Doc fix.

	* progmodes/grep.el (grep, rgrep): Doc fix (Bug#11268).

2012-04-20  Glenn Morris  <rgm@gnu.org>

	* net/network-stream.el (open-network-stream): Doc fix.

2012-04-20  Chong Yidong  <cyd@gnu.org>

	* emacs-lisp/tabulated-list.el (tabulated-list-print): Fix typos.

2012-04-20  Alan Mackenzie  <acm@muc.de>

	Ensure searching for keywords is case sensitive.

	* progmodes/cc-cmds.el (c-electric-brace, c-electric-lt-gt)
	(c-electric-paren, c-beginning-of-defun, c-end-of-defun)
	(c-defun-name, c-mark-function, c-cpp-define-name)
	(c-comment-indent, c-scan-conditionals, c-indent-defun)
	(c-context-line-break): Bind case-fold-search to nil.

	* progmodes/cc-mode.el (c-font-lock-fontify-region):
	Bind case-fold-search to nil.

2012-04-20  Chong Yidong  <cyd@gnu.org>

	* mail/sendmail.el (mail-bury): Call return action with the right
	Rmail buffer (Bug#11242).

	* server.el (server-process-filter): Handle corner case where both
	tty and nowait options are present (Bug#11102).

2012-04-20  Eli Zaretskii  <eliz@gnu.org>

	* version.el (emacs-bzr-version, emacs-bzr-get-version): Doc fixes.
	(top level): Put into the executable the ident-style '$Id:' tag on
	windows-nt as well.

2012-04-19  Stefan Monnier  <monnier@iro.umontreal.ca>

	* electric.el (electric-indent-post-self-insert-function): Check that
	electric-indent-mode is enabled in current buffer.

2012-04-19  Juanma Barranquero  <lekktu@gmail.com>

	* imenu.el (imenu-progress-message): Restore; it is "used" in
	erc/erc-imenu.el and net/snmp-mode.el.

2012-04-19  Juanma Barranquero  <lekktu@gmail.com>

	* avoid.el (mouse-avoidance-mode): Mark unused arg.
	(mouse-avoidance-nudge-mouse): Remove unused binding.

	* bs.el (bs-toggle-readonly): Call `toggle-read-only' interactively.

	* descr-text.el (describe-char):
	* progmodes/python.el (python-describe-symbol):
	Don't call `toggle-read-only', set `buffer-read-only'.

	* imenu.el (imenu-default-goto-function): Mark unused args.
	(imenu-progress-message): Remove obsolete macro; all callers changed.

	* subr.el (keymap-canonicalize): Remove unused binding.
	(read-passwd): Mark unused arg.

	* tutorial.el (tutorial--display-changes): Remove unused binding.
	(tutorial--save-tutorial-to): Remove unused variable.

	* emacs-lisp/package.el (define-package, package-menu-mark-delete)
	(package-menu-mark-install, package-menu-mark-unmark): Mark unused args.
	(package-generate-autoloads, package-menu--generate)
	(package-menu--find-upgrades): Remove unused bindings.

	* emulation/cua-rect.el (cua-restrict-regexp-rectangle)
	(cua-restrict-prefix-rectangle): Doc fixes.  Remove unused bindings.
	(cua--mouse-ignore, cua--delete-rectangle, cua--extract-rectangle)
	(cua--indent-rectangle, cua-open-rectangle, cua-close-rectangle)
	(cua-blank-rectangle, cua-string-rectangle, cua-replace-in-rectangle)
	(cua-incr-rectangle, cua-sequence-rectangle, cua--convert-rectangle-as)
	(cua--rectangle-aux-replace, cua--left-fill-rectangle)
	(cua-scroll-rectangle-up, cua-scroll-rectangle-down)
	(cua-delete-char-rectangle): Mark unused args.
	(cua-align-rectangle): Remove unused binding.

	* mail/rmail.el (compilation--message->loc)
	(epa--find-coding-system-for-mime-charset): Declare.

	* net/dbus.el (dbus-register-service): Declare.
	(dbus-name-owner-changed-handler): Remove unused binding.

	* nxml/nxml-mode.el (nxml-electric-slash, nxml-in-mixed-content-p)
	(nxml-compute-indent-from-matching-start-tag): Remove unused variables.
	(nxml-scan-backward-within): Mark unused arg.
	(nxml-dynamic-markup-word): Remove unused binding.

	* mouse.el (mouse-menu-major-mode-map):
	* emacs-lisp/authors.el (authors-scan-change-log)
	(authors-add-to-author-list):
	* emacs-lisp/avl-tree.el (avl-tree--enter-balance):
	* emacs-lisp/smie.el (smie-auto-fill):
	* mail/sendmail.el (mail-bury):
	* mail/unrmail.el (unrmail):
	* net/tls.el (open-tls-stream):
	* textmodes/picture.el (picture-mouse-set-point):
	Remove unused bindings.

2012-04-19  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-action-password): Let-bind
	`enable-recursive-minibuffers' to t.

2012-04-18  Sam Steingold  <sds@gnu.org>

	* progmodes/gud.el (gud-key-prefix): Use :type 'key-sequence
	instead of 'string to accommodate values like [f11].
	Always use `vconcat' instead of `concat' on it, like in `gud-def'.
	* progmodes/gdb-mi.el: Likewise.

2012-04-18  Leo Liu  <sdl.web@gmail.com>

	* abbrev.el (edit-abbrevs): Move point to the abbrev table of
	current buffer.
	(prepare-abbrev-list-buffer): Enter edit-abbrevs-mode only if
	LOCAL is nil.

2012-04-18  Chong Yidong  <cyd@gnu.org>

	* simple.el (line-move): Use forward-line if in batch mode
	(Bug#11053).

2012-04-18  Christopher Schmidt  <christopher@ch.ristopher.com>

	* files.el (after-find-file): Do not try to add a final newline if
	the buffer is read-only (Bug#11156).

2012-04-17  Richard Stallman  <rms@gnu.org>

	* mail/rmail.el (rmail-start-mail):
	Pass (rmail-mail-return...) for the return-action.
	Pass (rmail-yank-current-message...) for the yank-action.
	(rmail-yank-current-message): New function.
	(rmail-mail): Pass the Rmail buffer, not view buffer, for replybuffer.
	(rmail-reply): Likewise.
	(rmail-forward): Pass the Rmail buffer, not nil, for replybuffer.

	* mail/sendmail.el (mail-bury): Choose the first rmail-mode
	buffer, not the last.  Reject temp buffers.  Use the rmail-mode
	buffer, not newbuf.

2012-04-17  Juanma Barranquero  <lekktu@gmail.com>

	* server.el (server-ensure-safe-dir): Simplify.

2012-04-17  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/smie.el: Provide smarter auto-filling.
	(smie-auto-fill): New function.
	(smie-setup): Use it.

	* newcomment.el (comment-choose-indent): Obey comment-inline-offset.

2012-04-17  Philipp Haselwarter  <philipp.haselwarter@gmx.de>  (tiny change)

	* newcomment.el (comment-inline-offset): New custom var (bug#11090).
	(comment-indent): Use it.

2012-04-17  Vincent Belaïche  <vincentb1@users.sourceforge.net>

	* ses.el: The overall change is to add cell renaming, that is
	setting fancy names for cell symbols other than name matching
	"\\`[A-Z]+[0-9]+\\'" regexp .
	(ses-localvars): Add ses--renamed-cell-symb-list.
	(ses-create-cell-variable): New defun.
	(ses-destroy-cell-variable-range): Respect ses--numrows, ses--numcols.
	(ses-relocate-formula): Relocate formulas only for cells the
	symbols of which are not renamed, i.e. symbols whose names do not
	match regexp "\\`[A-Z]+[0-9]+\\'".
	(ses-relocate-all): Relocate values only for cells the symbols of
	which are not renamed.
	(ses-load): Create cells variables as the (ses-cell ...) are read,
	in order to check row col consistency with cell symbol name only
	for cells that are not renamed.
	(ses-replace-name-in-formula): New defun.
	(ses-rename-cell): New defun.

2012-04-17  Peter Oliver  <bzr@mavit.org.uk>  (tiny change)

	* progmodes/perl-mode.el (perl-indent-parens-as-block):
	New option (bug#11118).
	(perl-calculate-indent): Respect it.

2012-04-17  Glenn Morris  <rgm@gnu.org>

	* dired-aux.el (dired-mark-read-string): Doc fix.

2012-04-17  Dmitry Antipov  <dmantipov@yandex.ru>

	* dired-aux.el (dired-mark-read-string): Offer optional completion.
	(dired-do-chxxx): Complete chown, chgrp over users, groups.  (Bug#7900)

2012-04-17  Glenn Morris  <rgm@gnu.org>

	* mouse.el (mouse-drag-track):
	* speedbar.el (speedbar-frame-mode):
	Use auto-hscroll-mode rather than the alias automatic-hscrolling.

2012-04-16  Leo Liu  <sdl.web@gmail.com>

	* progmodes/python.el: Trivial cleanup.

2012-04-16  Glenn Morris  <rgm@gnu.org>

	* vc/vc.el (vc-string-prefix-p):
	* vc/pcvs-util.el (cvs-string-prefix-p):
	* textmodes/tex-mode.el (latex-string-prefix-p, tex-string-prefix-p):
	* mpc.el (mpc-string-prefix-p):
	Make all of these into obsolete aliases for string-prefix-p.
	Update callers.
	* vc/pcvs.el, vc/vc-dispatcher.el, vc/vc-dir.el: Update callers.

	* textmodes/two-column.el: Move custom options to the start.
	(frame-width): Remove compat definition.
	(2C-associate-buffer, 2C-dissociate):
	Use with-current-buffer rather than save-excursion.
	(2C-dissociate): Force a mode-line update.
	(2C-autoscroll): Use ignore-errors.

	* emacs-lisp/eieio-opt.el (describe-class, describe-generic):
	Autoload trivia.

	* emacs-lisp/cl-extra.el (*random-state*):
	Remove unnecessary declaration.

	* calendar/cal-tex.el (cal-tex-end-document): Trivial clarification.

	* play/cookie1.el (cookie-snarf):
	Give an explicit error if input file cannot be read.

	* play/yow.el (yow-file): Use expand-file-name rather than concat.

	* progmodes/perl-mode.el (c-macro-expand):
	Remove unnecessary autoload (it is in loaddefs.el).

	* textmodes/picture.el (picture-desired-column)
	(picture-update-desired-column): Convert comments to doc-strings.
	(picture-substitute): Remove function.
	(picture-mode-map): Initialize in the defvar.

	* woman.el: Remove eval-after-load for tar-mode.
	* tar-mode.el (tar-mode-map): Add woman binding and menu entry.
	(woman-tar-extract-file): Autoload it.

	* frame.el (automatic-hscrolling): Make this alias obsolete.

2012-04-12  Agustín Martín Domingo  <agustin.martin@hispalinux.es>

	* textmodes/ispell.el (ispell-set-spellchecker-params): Post-process
	`ispell-dictionary-alist' to use [:alpha:] and utf-8 if possible.
	(ispell-dictionary-base-alist): Revert to original XEmacs
	friendly version for default.  [:alpha:] will be added in
	`ispell-set-spellchecker-params' if needed.

2012-04-16  Chong Yidong  <cyd@gnu.org>

	* image.el (imagemagick--file-regexp): New variable.
	(imagemagick-register-types): Use it.
	(imagemagick-types-inhibit): Add :set function.  Allow new value
	of t to inhibit all types.

	* emacs-lisp/regexp-opt.el (regexp-opt-charset): Avoid cl macros,
	so we can preload it.

	* loadup.el (fboundp): Preload regexp-opt, needed by
	imagemagick-register-types.

2012-04-15  Chong Yidong  <cyd@gnu.org>

	* frame.el (scrolling): Remove nearly unused customization group.

	* scroll-all.el (scroll-all-mode): Move to windows group.

2012-04-15  Chong Yidong  <cyd@gnu.org>

	* bindings.el (goto-map): Bind goto-char to M-g c (Bug#11240).

2012-04-15  Stefan Monnier  <monnier@iro.umontreal.ca>

	Avoid the use of ((lambda ...) ...) in lexical-binding code.
	* emacs-lisp/easy-mmode.el (define-minor-mode): Use funcall (bug#11241).

2012-04-15  Glenn Morris  <rgm@gnu.org>

	* simple.el (process-file-side-effects): Doc fix.

2012-04-15  Glenn Morris  <rgm@gnu.org>

	* international/mule-cmds.el (set-language-environment): Doc fix.

2012-04-14  Juanma Barranquero  <lekktu@gmail.com>

	* server.el (server-auth-key, server-generate-key): Doc fixes.
	(server-get-auth-key): Doc fix.  Use `string-match-p'.
	(server-start): Reflow docstring.

2012-04-14  Lars Ingebrigtsen  <larsi@gnus.org>

	* server.el (server-generate-key): `called-interactively-p'
	requires a parameter.

2012-04-14  Michal Nazarewicz  <mina86@mina86.com>

	* server.el (server-auth-key): New variable.
	(server-generate-key, server-get-auth-key): New function.
	(server-start): Use the new variable and functions to allow
	setting a permanent server key (bug#9423).

2012-04-14  Leo Liu  <sdl.web@gmail.com>

	* vc/diff-mode.el (diff-file-prev/next): Fix typo.

2012-04-14  Paul Eggert  <eggert@cs.ucla.edu>

	Spelling fixes.
	* hexl.el (hexl-rulerize): Rename from hexl-rulerise, since
	Emacs uses American spelling.

2012-04-14  Juanma Barranquero  <lekktu@gmail.com>

	* emacs-lock.el (emacs-lock-locked-buffer-functions): New hook.
	(emacs-lock--exit-locked-buffer): Return the locked buffer.  Doc fix.
	(emacs-lock--kill-emacs-hook, emacs-lock--kill-emacs-query-functions)
	(emacs-lock--kill-buffer-query-functions): Run new hook.  (Bug#11017)

2012-04-14  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/which-func.el (which-func-modes): Change default.

2012-04-14  Kim F. Storm  <storm@cua.dk>

	* emulation/cua-base.el (cua-exchange-point-and-mark): Just call
	exchange-point-and-mark if cua-enable-cua-keys is nil (Bug#11191).

2012-04-14  Chong Yidong  <cyd@gnu.org>

	* custom.el (custom-theme-set-variables): Doc fix.

2012-04-14  Glenn Morris  <rgm@gnu.org>

	* international/mule.el (set-auto-coding-for-load): Doc fix.

2012-04-14  Alan Mackenzie  <acm@muc.de>

	* progmodes/cc-menus.el (cc-imenu-objc-generic-expression): Make
	imenu work again for Objective C Mode.  Correct the *-index values,
	these having been disturbed by a previous change in 2011-08.

	* progmodes/cc-engine.el (c-before-change-check-<>-operators):
	Correct two search limits.

2012-04-14  Stefan Monnier  <monnier@iro.umontreal.ca>

	* startup.el (command-line-1): Inhibit splash from daemon (bug#10996).

2012-04-14  Andreas Schwab  <schwab@linux-m68k.org>

	* international/characters.el: Fix sorting.

2012-04-14  Eli Zaretskii  <eliz@gnu.org>

	* international/characters.el: Add more missing Latin case pairs.

2012-04-14  Glenn Morris  <rgm@gnu.org>

	* files.el (dir-locals-set-class-variables): Doc fix.

2012-04-14  Eli Zaretskii  <eliz@gnu.org>

	* international/characters.el: Add set-case-syntax-pair call for
	LATIN CAPITAL LETTER Y WITH DIAERESIS RET and its lower-case
	counterpart.  (Bug#11209)

	* simple.el (shell-command-on-region): Doc fix.  (Bug#11208)

2012-04-14  Glenn Morris  <rgm@gnu.org>

	* calendar/holidays.el (calendar-check-holidays): Doc fix.

2012-04-14  Eli Zaretskii  <eliz@gnu.org>

	* textmodes/ispell.el (ispell-dictionary-base-alist):
	Add data for Hebrew.

2012-04-14  Chong Yidong  <cyd@gnu.org>

	* net/rcirc.el (rcirc-cmd-quit):
	Revert 2012-03-18 change (Bug#11192).

2012-04-14  Glenn Morris  <rgm@gnu.org>

	* pcmpl-rpm.el (pcomplete/rpm): Handle -qf.

2012-04-14  Eli Zaretskii  <eliz@gnu.org>

	* minibuffer.el (completion-in-region-mode-map):
	Bind completion-help-at-point to M-? rather than ?.  (Bug#11182)

2012-04-13  Vivek Dasmohapatra  <vivek@etla.org>

	* hexl.el (hexl-insert-char): Make display sizes other than 16 work.

2012-04-13  Masatake YAMATO  <yamato@redhat.com>

	* minibuffer.el (minibuffer-local-filename-syntax): New variable
	to allow `C-M-f' and `C-M-b' to move to the nearest path
	separator (bug#9511).

2012-04-13  Lars Ingebrigtsen  <larsi@gnus.org>

	* avoid.el: Require cl when compiling.  And also move the
	`provide' to the end.

2012-04-13  Thierry Volpiatto  <thierry.volpiatto@gmail.com>

	* avoid.el (mouse-avoidance-banish-position): New variable.
	(mouse-avoidance-banish-destination): Use it (bug#10165).

2012-04-13  Leo Liu  <sdl.web@gmail.com>

	* progmodes/which-func.el (which-func-modes): Add objc-mode.

2012-04-13  Ken Brown  <kbrown@cornell.edu>

	* net/browse-url.el (browse-url-file-url): Remove Cygwin hack;
	this is no longer needed now that cygstart understands file:// URLs.
	(browse-url-filename-alist): For the same reason, don't modify
	file:// URLs on Cygwin.

2012-04-13  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emulation/cua-base.el (cua--pre-command-handler-1): Don't activate
	the region on shift if the binding is already shifted (bug#11221).

2012-04-12  Glenn Morris  <rgm@gnu.org>

	* mail/mailpost.el: Move to obsolete/.

2012-04-12  Drew Adams  <drew.adams@oracle.com>

	* imenu.el (imenu--generic-function): Ignore invisible definitions
	(bug#10123).

2012-04-12  Vivek Dasmohapatra  <vivek@etla.org>

	* hexl.el (hexl-bits): New variable.
	(hexl-options): Mention the variable in the doc string.
	(hexl-rulerise, hexl-line-displen): New functions.
	(hexl-mode): Mention the new variable.
	(hexl-mode, hexl-current-address, hexl-current-address):
	Use the displen.
	(hexl-ascii-start-column): New function.
	(hexl-address-to-marker, hexl-beginning-of-line, hexl-options)
	(hexl-insert-char, hexl-mode-ruler): Use the displen (bug#4941).

2012-04-12  Agustín Martín Domingo  <agustin.martin@hispalinux.es>

	* textmodes/flyspell.el (flyspell-large-region): For hunspell, use
	'("-i" ENCODING), in 2 separate command-line arguments, to specify
	the encoding, as expected by hunspell.

2012-04-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* battery.el (battery--linux-sysfs-regexp): New const.
	(battery-status-function): Use it.  Remove yeeloong special case.
	(battery-yeeloong-sysfs): Remove.
	(battery-echo-area-format): Remove yeeloong special case.

2012-04-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* imenu.el (imenu-add-to-menubar): `current-local-map' can be nil.
	Reported by Noah Friedman.

	* subr.el (read-passwd): Use read-string.

2012-04-11  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* vcursor.el (vcursor-move): Increase the priority of the overlay
	(bug#9663).

2012-04-11  Deniz Dogan  <deniz.a.m.dogan@gmail.com>

	* net/rcirc.el (rcirc-kill-channel-buffers): New variable.
	(rcirc-kill-buffer-hook): Use it to kill channel buffers (bug#5128).

2012-04-11  William Stevenson  <yhvh2000@gmail.com>

	* textmodes/artist.el (artist-mode): Convert artist-mode to use
	define-minor-mode (bug#10760).

2012-04-11  Wolfgang Jenkner  <wjenkner@inode.at>  (tiny change)

	* progmodes/grep.el (rgrep): Tweak the find command line so
	that directories matching `grep-find-ignored-files' won't be
	pruned (bug#10351).

2012-04-11  Chong Yidong  <cyd@gnu.org>

	* startup.el (command-line): Remove support for long-obsolete
	variable font-lock-face-attributes.

2012-04-11  Glenn Morris  <rgm@gnu.org>

	* vc/vc-bzr.el (vc-bzr-status): Avoid condition-case-unless-debug.

2012-04-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* window.el (window--state-get-1): Obey window-point-insertion-type.

2012-04-11  Lennart Borgman  <lennart.borgman@gmail.com>

	* emacs-lisp/lisp.el (narrow-to-defun): `beginning-of-defun' goes
	to previous function when point is on the first character of a
	function.  Take care of that in `narrow-to-defun' (bug#6157).

2012-04-11  Glenn Morris  <rgm@gnu.org>

	* vc/vc-bzr.el (vc-bzr-status): Handle all errors,
	not just file-errors.

	* vc/vc-bzr.el (vc-bzr-sha1-program, sha1-program): Remove.
	(vc-bzr-sha1): Use internal sha1.

2012-04-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/flymake.el (flymake-mode): Beware read-only dirs (bug#8954).

2012-04-10  Sébastien Gross  <seb@chezwam.org>  (tiny change)

	* progmodes/hideshow.el (hs-hide-all): Don't infloop on comments
	that start in the middle of the line (bug#10496).

2012-04-10  Dan Nicolaescu  <dann@gnu.org>

	* battery.el (battery-linux-proc-acpi): Only one battery is
	discharged at a time, but that seems to confuse battery.el when
	computing `rate-type' for the battery not being discharged
	(bug#10332).

2012-04-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/autoload.el (autoload-make-program): Remove, unused.

	* international/quail.el: Use dolist and simplify.
	(quail-define-package, quail-update-keyboard-layout)
	(quail-define-rules): Use dolist.
	(quail-insert-kbd-layout, quail-get-translation): CSE.

	* tmm.el: Use dolist, remove left over hook.
	(tmm-prompt, tmm-define-keys, tmm-shortcut, tmm-get-keybind):
	Use dolist.
	(calendar-load-hook): Don't mess with it.

	* vc/vc-annotate.el (vc-annotate-show-diff-revision-at-line-internal):
	Use derived-mode-p.  Run the diff asynchronously.

2012-04-10  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* obsolete/mouse-sel.el: Add an Obsolete-since header.

2012-04-10  Juanma Barranquero  <lekktu@gmail.com>

	* misc.el: Display absolute path of loaded DLLs (bug#10424).
	(list-dynamic-libraries--loaded): New function.
	(list-dynamic-libraries--refresh): Use it.

2012-04-10  Nathan Weizenbaum  <nweiz@google.com>

	* progmodes/python.el (python-fill-paragraph):
	Make python-fill-region in a multiline string work when font-lock is
	disabled (bug#7018).

2012-04-10  Laimonas Vėbra  <laimonas.vebra@gmail.com>  (tiny change)

	* language/european.el (cp775): Add oem/legacy (en)coding on
	DOS/MS Windows for the Baltic languages.  There are still plenty
	of texts written in this encoding/codepage (bug#6519).

2012-04-10  Glenn Morris  <rgm@gnu.org>

	* cus-start.el (eol-mnemonic-unix, eol-mnemonic-dos, eol-mnemonic-mac):
	Add :standard values, reducing "rogue" customs in emacs -Q a bit more.

2012-04-10  Florian Adamsky  <florian@adamsky.it>  (tiny change)

	* recentf.el (recentf-dialog-mode-map): Add two keybindings for
	next-line "n" and previous-line "p" in order to make recentf more
	consistent with ibuffer, dired or org-mode (bug#9387).

2012-04-10  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* image.el (put-image): Return the overlay created instead of the
	optional input string (bug#7834).  Note that this may break code
	that is (for some reason or other) depending on `put-image'
	returning the string.

	* mouse-sel.el (mouse-sel-mode): Mark as obsolete (bug#6174).

	* simple.el (zap-to-char): Allow zapping using input methods
	(bug#1580).

	* textmodes/fill.el (fill-region): Leave point and mark where they
	were before filling (bug#5399).

2012-04-09  Glenn Morris  <rgm@gnu.org>

	* version.el (emacs-bzr-get-version):
	Handle lightweight checkouts of local branches.

2012-04-09  Andreas Schwab  <schwab@linux-m68k.org>

	* international/characters.el: Recover lost case pairs.  (Bug#11209)

2012-04-09  Chong Yidong  <cyd@gnu.org>

	* custom.el (custom-variable-p): Return nil for non-symbol
	arguments instead of signaling an error.
	(user-variable-p): Obsolete alias for custom-variable-p.

	* apropos.el (apropos-variable):
	* files-x.el (read-file-local-variable):
	* simple.el (set-variable):
	* woman.el (woman-mini-help):
	* emacs-lisp/byte-opt.el (side-effect-free-fns): Callers changed.

2012-04-09  Glenn Morris  <rgm@gnu.org>

	* startup.el (normal-top-level): Don't look for leim-list.el
	in places where it will not be found.  (Bug#910)

	* international/mule-cmds.el (set-default-coding-systems):
	* files.el (normal-mode):
	Remove guarded calls to ucs-set-table-for-input.  (Bug#9821)
	This function was removed with ucs-tables.el in 2008.

2012-04-08  Eli Zaretskii  <eliz@gnu.org>

	* textmodes/ispell.el (ispell-check-version): For hunspell, set
	ispell-encoding8-command to "-i", without a trailing space.
	(ispell-start-process): For hunspell, use '("-i" ENCODING), in 2
	separate command-line arguments, to specify the encoding, since
	that's how hunspell expects it.

2012-04-08  Glenn Morris  <rgm@gnu.org>

	* loadup.el: Load bindings before cus-start.
	This reduces somewhat the number of "rogue" settings in emacs -Q.

2012-04-07  Glenn Morris  <rgm@gnu.org>

	* version.el (emacs-bzr-get-version): New function.
	(emacs-bzr-version): New variable.
	* loadup.el (emacs-bzr-version): Set it.  (Bug#8054)
	* mail/emacsbug.el (report-emacs-bug): Include bzr version.

2012-04-07  Eli Zaretskii  <eliz@gnu.org>

	* international/uni-bidi.el, international/uni-category.el:
	* international/uni-combining.el, international/uni-decimal.el:
	* international/uni-decomposition.el, international/uni-digit.el:
	* international/uni-lowercase.el, international/uni-mirrored.el:
	* international/uni-name.el, international/uni-numeric.el:
	* international/uni-titlecase.el, international/uni-uppercase.el:
	Update for Unicode 6.1.

2012-04-07  Eli Zaretskii  <eliz@gnu.org>

	* term/w32-win.el (dynamic-library-alist): Add libxml2 DLLs.

2012-04-05  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* window.el (shrink-window): Mention the `window-min-height'
	variable in the doc string.

2012-04-05  Bastien Guerry  <bzg@altern.org>

	* color.el (color-lighten-name): Fix typo.

2012-04-04  Stefan Monnier  <monnier@iro.umontreal.ca>

	* server.el (server--on-display-p): New function.
	(server--on-display-p): Use it.

2012-04-04  Gábor Vida  <vidagabor@gmail.com>  (tiny change)

	* ido.el (ido-wide-find-dirs-or-files): Use file-name-absolute-p
	(bug#11145).

2012-04-04  Stefan Monnier  <monnier@iro.umontreal.ca>

	* comint.el (comint--common-quoted-suffix): Check string boundary
	before comparing (bug#11158).
	* pcomplete.el (pcomplete--common-quoted-suffix): Idem.

2012-04-04  Chong Yidong  <cyd@gnu.org>

	* minibuffer.el (completion-extra-properties): Doc fix.

	* subr.el (delayed-warnings-hook): Doc fix.

2012-04-04  Daiki Ueno  <ueno@unixuser.org>

	* epa.el (epa--select-keys): Bind C-c C-c to finish the key
	selection (Bug#11159).
	(epa-insert-keys): Inform that the default public key will be
	exported if no key is selected.

2012-04-04  Richard Stallman  <rms@gnu.org>

	* mail/emacsbug.el (report-emacs-bug): Bind inhibit-read-only.

2012-04-03  Chong Yidong  <cyd@gnu.org>

	* mail/sendmail.el (mail-mode-map): Bind C-c C-i to
	mail-insert-file, not its obsolete alias mail-attach-file.

2012-04-03  Michael Albinus  <michael.albinus@gmx.de>

	* notifications.el (notifications-notify): Fix docstring.

2012-04-02  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/authors.el (authors-aliases): Another addition.

2012-04-02  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-gvfs.el (tramp-gvfs-send-command): Apply
	`tramp-compat-call-process' instead of `tramp-local-call-process'.
	Reported by Magnus Henoch <magnus.henoch@gmail.com>.

2012-04-01  Chong Yidong  <cyd@gnu.org>

	* files.el (file-in-directory-p): Rename from file-subdir-of-p.
	Handle root directory properly.
	(copy-directory): Caller changed.

	* dired-aux.el (dired-copy-file-recursive, dired-create-files):
	* net/tramp.el (tramp-file-name-for-operation): Callers changed.

2012-03-31  Glenn Morris  <rgm@gnu.org>

	* term/xterm.el (xterm-extra-capabilities): Doc fix.

	* language/indian.el ("Devanagari"): Fix typo.  (Bug#11103)

	* calendar/calendar.el (calendar-window-list)
	(calendar-hide-window): Restore.  (Bug#11140)
	(calendar-exit): Use calendar-window-list, calendar-hide-window again.

	* emacs-lisp/edebug.el (edebug-unwrap-results): Doc fix.

2012-03-30  Thierry Volpiatto  <thierry.volpiatto@gmail.com>

	* dired-aux.el (dired-copy-file-recursive, dired-create-files):
	Check if file is a symlink (Bug#10489).

	* files.el (copy-directory): Likewise.

2012-03-30  Chong Yidong  <cyd@gnu.org>

	* image.el (imagemagick-types-inhibit)
	(imagemagick-register-types): Doc fix.

2012-03-30  Agustín Martín Domingo  <agustin.martin@hispalinux.es>

	* textmodes/ispell.el (ispell-get-extended-character-mode):
	Disable extended-char-mode for hunspell.  hunspell does not support it
	and treats ~word as ordinary words in pipe mode.

2012-03-30  Glenn Morris  <rgm@gnu.org>

	* tutorial.el (help-with-tutorial): Ensure local variables don't
	happen to make the buffer read-only.  (Bug#11127)

2012-03-30  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/perl-mode.el (perl-indent-line): Use `noindent' in strings.
	(perl-calculate-indent): Return `noindent' in strings.

2012-03-28  Sam Steingold  <sds@gnu.org>

	* calendar/calendar.el (calendar-exit): Use `quit-windows-on'
	instead of the broken adhockery which does not prevent calendar
	buffers from being displayed at random after exit.
	(calendar-window-list, calendar-hide-window): Remove the broken
	adhockery.

2012-03-28  Glenn Morris  <rgm@gnu.org>

	* replace.el (query-replace-map): Doc fix.

2012-03-28  Andreas Schwab  <schwab@linux-m68k.org>

	* vc/vc-git.el (vc-git-state): Don't try to match all of the diff
	contents.  (Bug#11109)

2012-03-27  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/avl-tree.el (avl-tree--enter-balance): Fix paren typo
	(bug#11077).
	(avl-tree--check, avl-tree--check-node): New funs.

2012-03-27  Martin Rudalics  <rudalics@gmx.at>

	* window.el (switch-to-visible-buffer): New option.
	(switch-to-prev-buffer, switch-to-next-buffer):
	Observe switch-to-visible-buffer.  Make sure that checking for a window
	showing a buffer already is done on the same frame.

2012-03-27  Glenn Morris  <rgm@gnu.org>

	* startup.el (mail-host-address): Doc fix.

2012-03-26  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/bytecomp.el (byte-compile-constants-vector): Allow more
	than 197 variables.

2012-03-26  Ami Fischman  <ami@fischman.org>

	* vc/vc-git.el (vc-git-state): Avoid unnecessarily locking.

2012-03-26  Glenn Morris  <rgm@gnu.org>

	* files.el (save-buffers-kill-emacs): Doc fix.

	* startup.el (normal-top-level, command-line, command-line-1):
	Give them doc strings.

2012-03-25  Eli Zaretskii  <eliz@gnu.org>

	* makefile.w32-in (install): Use $(DIRNAME)_same-dir.tst instead
	of same-dir.tst, to avoid stepping on other (parallel) Make job's toes.

2012-03-25  Chong Yidong  <cyd@gnu.org>

	* custom.el (load-theme): Even if NO-ENABLE arg is t, reenable the
	theme if it was previously enabled before (Bug#11031).

	* cus-theme.el (custom-theme-write-faces): Retrieve current face
	spec with custom-face-get-current-spec if its :shown-value is not
	determined yet (Bug#9337).
	(customize-create-theme, custom-theme-revert): Doc fixes.

	* button.el (button-at): Minor addition to docstring.

2012-03-24  Simon Leinen  <simon.leinen@gmail.com>

	* vc/vc.el (vc-merge): Fix a prompt.

2012-03-24  Chong Yidong  <cyd@gnu.org>

	* mwheel.el (mwheel-scroll): Call deactivate-mark at the right
	point (Bug#9623).

	* button.el (button-at): Minor addition to docstring.

2012-03-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* newcomment.el (comment-choose-indent): No space after BOL.

2012-03-22  Sam Steingold  <sds@gnu.org>

	* window.el (switch-to-prev-buffer): Revert last patch because the
	bug turned out to be an advertised feature (Elisp manual 28.14).

2012-03-22  Glenn Morris  <rgm@gnu.org>

	* vc/vc-bzr.el (vc-bzr-status-switches): New option.  (Bug#6724)
	(vc-bzr-command): If running "status", pass vc-bzr-status-switches.

2012-03-22  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* net/network-stream.el (network-stream-open-starttls): Make error
	message under Windows be less misleading.

2012-03-22  Liang Wang  <netcasper@gmail.com>  (tiny change)

	* progmodes/etags.el (etags-list-tags): Only use tags which goto-func
	understands (bug#9942).

2012-03-22  Chong Yidong  <cyd@gnu.org>

	* simple.el (end-of-visible-line): Handle return value of
	next-single-property-change properly (Bug#9371).

2012-03-22  Kenichi Handa  <handa@m17n.org>

	* international/quail.el (quail-insert-kbd-layout): Fix previous
	change.  To avoid unwanted bidi reordering, use
	bidi-string-mark-left-to-right instead of inserting LRO and PDF.

2012-03-21  Dmitry Gutov  <dgutov@yandex.ru>

	* progmodes/ruby-mode.el: Don't confuse "end:" for "end" (bug#10786).
	(ruby-block-end-re, ruby-delimiter, ruby-parse-partial)
	(ruby-beginning-of-indent): Be more careful with the difference
	between word-boundary and symbol boundary.
	(ruby-mode-syntax-table): Make : a symbol constituent.

2012-03-21  Andreas Politz  <politza@fh-trier.de>

	* outline.el (outline-flag-region): Evaporate overlays (bug#10789).

2012-03-21  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/etags.el (tags-completion-at-point-function):
	Improve last fix.

	* files.el (move-file-to-trash): Files aren't regexps (bug#11055).

2012-03-21  Sam Steingold  <sds@gnu.org>

	* progmodes/etags.el (tags-completion-at-point-function):
	Avoid the error when point is inside the pattern.

2012-03-21  John Yates  <john@yates-sheets.org>  (tiny change)

	* progmodes/hideshow.el (hs-inside-comment-p): Fix hiding of first
	line (Bug#10855).

2012-03-21  Drew Adams  <drew.adams@oracle.com>

	* info.el (Info-menu): Handle string value of FORK arg (Bug#10858).

2012-03-21  Anmol Khirbat  <anmol@khirbat.net>  (tiny change)

	* ido.el (ido-set-current-directory, ido-read-internal)
	(ido-choose-completion-string, ido-completion-help): Handle nil
	value of ido-completion-buffer (Bug#11008).

2012-03-21  Sam Steingold  <sds@gnu.org>

	* window.el (switch-to-prev-buffer): Do not switch to a visible
	window previous buffer, just like with the frame previous buffers.

2012-03-21  Chong Yidong  <cyd@gnu.org>

	* faces.el (make-face, make-empty-face, copy-face):
	* face-remap.el (face-remap-add-relative, face-remap-set-base):
	Doc fixes.

2012-03-21  Stefan Monnier  <monnier@iro.umontreal.ca>

	* wid-edit.el (widget-complete-field): Remove (bug#11051).
	(widget-complete): Remove broken use of it.

2012-03-20  Chong Yidong  <cyd@gnu.org>

	* emacs-lisp/tabulated-list.el (tabulated-list-print-entry):
	Use string-width and truncate-string-width to handle arbitrary
	characters.

2012-03-20  Tassilo Horn  <tassilo@member.fsf.org>

	* textmodes/artist.el (artist-menu-map): Bind Rectangle menu item
	to draw rectangles, not squares.  (Regression introduced by revno
	2011-03-02T03:48:01Z!cyd@stupidchicken.com)

2012-03-18  Chong Yidong  <cyd@gnu.org>

	* faces.el (face-spec-reset-face): Don't call display-graphic-p if
	it is not yet defined (for temacs).

2012-03-18  Leo Liu  <sdl.web@gmail.com>

	* net/rcirc.el (rcirc-cmd-quit): Allow quitting all servers with
	prefix.

2012-03-17  Eli Zaretskii  <eliz@gnu.org>

	* textmodes/ispell.el (ispell-skip-tib, ispell-keep-choices-win)
	(ispell-choices-win-default-height, ispell-silently-savep)
	(ispell-dictionary-alist, ispell-encoding8-command)
	(ispell-check-version, ispell-aspell-find-dictionary)
	(ispell-valid-dictionary-list, ispell-words-keyword)
	(ispell-get-word, ispell-internal-change-dictionary)
	(ispell-region, ispell-skip-region-list)
	(ispell-begin-skip-region-regexp, ispell-ignore-fcc)
	(ispell-process-line, ispell-minor-mode, ispell-minor-check)
	(ispell-message-text-end, ispell-message)
	(ispell-buffer-local-parsing): Doc fix.

2012-03-13  Jambunathan K  <kjambunathan@gmail.com>

	* htmlfontify.el: Add support for code block fontification for ODT
	export (Bug #9914).
	(hfy-optimisations): Define new option
	`body-text-only'
	(hfy-fontify-buffer): Honor above setting.
	(hfy-begin-span, hfy-end-span): New routines factored out form
	`hfy-fontify-buffer'.
	(hfy-begin-span-handler, hfy-end-span-handler): New variables
	that permit insertion of custom tags.
	(hfy-fontify-buffer): Use above handlers.
	(hfy-face-to-css-default): Same as the earlier `hfy-face-to-css'.
	(hfy-face-to-css): Re-defined to be a variable.
	(hfy-compile-stylesheet): Modify.  Allow stylesheet to be built
	over multiple runs.  This is made possible by having the caller let
	bind a special variable `hfy-user-sheet-assoc'.
	(htmlfontify-string): New defun.
	(hfy-compile-face-map): Make sure that the last char in the
	buffer is correctly fontified.
	(hfy-face-resolve-face): Whitespace only change.

2012-03-17  Eli Zaretskii  <eliz@gnu.org>

	* textmodes/ispell.el (ispell-get-decoded-string): Make the error
	message more clear.

2012-03-16  Leo Liu  <sdl.web@gmail.com>

	* emacs-lisp/copyright.el (copyright-year-ranges): Fix typo.

2012-03-16  Alan Mackenzie  <acm@muc.de>

	Further optimize the handling of large macros.

	* progmodes/cc-engine.el (c-crosses-statement-barrier-p): Use a
	limit to a call of `c-literal-limits'.
	(c-determine-+ve-limit): New function.
	(c-at-macro-vsemi-p): Move `c-in-literal' to the bottom of an `and'.
	(c-guess-basic-syntax): In macros, restrict a search limit to 2000.
	In CASE 5B, restrict a search limit to 500.
	(c-just-after-func-arglist-p): Obviouly wrong `or' -> `and'.

	* progmodes/cc-mode.el (c-neutralize-syntax-in-and-mark-CPP):
	Restrict macro bounds to +-500 from after-change's BEG END.

2012-03-16  Leo Liu  <sdl.web@gmail.com>

	* font-lock.el (lisp-font-lock-keywords-2): Add letrec.

2012-03-16  Aaron S. Hawley  <Aaron.S.Hawley@gmail.com>

	* tar-mode.el (tar-mode): Fix saving by conditionally undoing
	`special-mode' setting of `buffer-read-only'.  (Bug#11010)

2012-03-16  Glenn Morris  <rgm@gnu.org>

	* view.el (view-buffer, view-buffer-other-window)
	(view-buffer-other-frame): Doc fixes re special mode-class.

	* subr.el (eval-after-load): If named feature is provided not from
	a file, run after-load forms.  (Bug#10946)

	* calendar/calendar.el (calendar-insert-at-column):
	Handle non-unit-width characters a bit better.  (Bug#10978)

2012-03-15  Chong Yidong  <cyd@gnu.org>

	* emacs-lisp/ring.el (ring-extend): New function.
	(ring-insert+extend): Extend the ring correctly (Bug#11019).

	* comint.el (comint-read-input-ring)
	(comint-add-to-input-history): Grow comint-input-ring lazily.

2012-03-15  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/perl-mode.el (perl-syntax-propertize-special-constructs):
	Fix up parsing of multiline twoarg non-paired elements (bug#11014).

	* imenu.el: Fix multiple inheritance breakage (bug#9199).
	(imenu-add-to-menubar): Don't add a redundant index.
	(imenu-update-menubar): Handle a dynamically composed keymap.

2012-03-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mail/sendmail.el (mail-encode-header):
	Bind rfc2047-encode-encoded-words to nil.

2012-03-13  Glenn Morris  <rgm@gnu.org>

	* calendar/calendar.el (calendar-string-spread):
	Handle non-unit-width characters a bit better.  (Bug#10978)

2012-03-13  Leo Liu  <sdl.web@gmail.com>

	* vc/vc-hg.el (vc-hg-working-revision): Rework to work with both
	directory and file as argument (Bug#10822).

2012-03-13  Kaushik Srenevasan  <ksrenevasan@gmail.com>  (tiny change)

	* progmodes/gdb-mi.el (gdb-invalidate-disassembly):
	For dynamically generated code, follow $PC.
	(gdb-disassembly-handler-custom): Handle no function name case.

2012-03-13  Tim Landscheidt  <tim@tim-landscheidt.de>  (tiny change)

	* calendar/icalendar.el (icalendar-export-file, icalendar-import-file):
	* emulation/ws-mode.el (ws-query-replace):
	* sort.el (sort-regexp-fields):
	Fix missing trailing whitespace in interactive prompts.  (Bug#11002)

2012-03-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* dabbrev.el: Fix cycle completion order (bug#10963).
	(dabbrev--last-obarray, dabbrev--last-completion-buffer): Remove.
	(dabbrev-completion): Don't use an obarray; provide
	a cycle-sort-function.

2012-03-12  Leo Liu  <sdl.web@gmail.com>

	* simple.el (kill-new): Use equal-including-properties for comparison.
	(kill-do-not-save-duplicates): Doc fix.

2012-03-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* dabbrev.el: Fix cycle completion (bug#10963).
	Use lexical binding and wrap to 80 columns.
	(dabbrev-completion): Delay computing the list of completions.

2012-03-12  Kenichi Handa  <handa@m17n.org>

	* international/quail.el (quail-insert-kbd-layout): Surround each
	row by LRO and PDF instead of inserting many LRMs.  Pad the left
	and right of each non-spacing marks.  Insert invisible space
	between lower and upper characters to prevent composition.

2012-03-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuffer.el (minibuffer-complete): Don't get confused when the
	function is run twice via different commands (bug#10958).
	(complete-with-action): Fix docstring.

2012-03-12  Chong Yidong  <cyd@gnu.org>

	* nxml/nxml-mode.el (nxml-mode-map): Do not bind C-RET (Bug#6776).
	(nxml-completion-at-point-function): New function.
	(nxml-mode): Use it.
	(nxml-bind-meta-tab-to-complete-flag): Default to t.

	* emacs-lisp/package.el (package-unpack, package-unpack-single):
	Load generated autoloads file before byte compiling (Bug#10970).
	(package--make-autoloads-and-compile): New helper fun.

2012-03-12  Christopher Schmidt  <christopher@ch.ristopher.com>

	* ibuffer.el (ibuffer-redisplay): Remove another gratuitous error.

2012-03-11  Michael Albinus  <michael.albinus@gmx.de>

	* autorevert.el (auto-revert-handler): Ensure, that
	file-readable-p is applied only for local files or in
	auto-revert-tail-mode.

2012-03-11  Andreas Schwab  <schwab@linux-m68k.org>

	* server.el (server-eval-at): Handle non-tcp connections.
	Decode result string.

	* server.el (server-msg-size): New constant.
	(server-reply-print): New function.
	(server-eval-and-print): Use it.
	(server-eval-at): Use server-quote-arg and server-unquote-arg.
	Handle -print-nonl.

2012-03-11  Christopher Schmidt  <christopher@ch.ristopher.com>

	* ibuffer.el (ibuffer-redisplay): Remove gratuitous error
	(Bug#10987).

2012-03-11  Chong Yidong  <cyd@gnu.org>

	* simple.el (goto-line): Doc fix (Bug#9938).

	* subr.el (save-window-excursion): Doc fix (Bug#9979).

	* dabbrev.el (dabbrev--find-expansion): Update progress reporter
	when finished (Bug#10963).

2012-03-11  Martin Rudalics  <rudalics@gmx.at>

	* window.el (split-window-below): Fix bug in case where
	split-window-keep-point is nil (Bug#10971).

2012-03-11  Juri Linkov  <juri@jurta.org>

	* replace.el (replace-highlight): Set isearch-word to nil
	unconditionally.  (Bug#10887)

2012-03-10  Eli Zaretskii  <eliz@gnu.org>

	* net/mairix.el (mairix-replace-invalid-chars): Rename from
	mairix-replace-illegal-chars; all callers changed.  Don't remove
	^, ~, and = characters: they are meaningful in mairix search specs.
	(mairix-widget-create-query): Add usage information about mairix
	search forms: negating words, searching for substrings, etc.

2012-03-10  Jae-hyeon Park  <jae-hyeon.park@desy.de>  (tiny change)

	* international/fontset.el (font-encoding-alist): Add an entry for
	ksx1001 (Bug#5667).

2012-03-10  Richard Stallman  <rms@gnu.org>

	* mail/sendmail.el (mail-encode-header):
	Set rfc2047-encode-encoded-words.

	* mail/mail-utils.el (mail-quote-printable): Quote multibyte chars.

	* mail/rmail.el (rmail-buffers-swapped-p): Don't assume dead
	view buffer means not swapped.
	(rmail-view-buffer-kill-buffer-hook): Give buf name in error msg.
	(rmail-write-region-annotate): Error if real text has disappeared.

	* epa-mail.el (epa-mail-encrypt): Bind inhibit-read-only.

2012-03-10  Chong Yidong  <cyd@gnu.org>

	* emulation/cua-rect.el (cua--init-rectangles):
	* emulation/cua-base.el (cua--init-keymaps):
	Add delete-forward-char to remappings (Bug#9666).

2012-03-10  Martin Rudalics  <rudalics@gmx.at>

	* speedbar.el (speedbar-unhighlight-one-tag-line):
	Avoid unhighlighting due to frame switching (Bug#10275).

2012-03-10  Chong Yidong  <cyd@gnu.org>

	* minibuffer.el (completion-in-region, completion-help-at-point):
	Give the completion field overlay a high priority (Bug#6830).

	* dired.el (dired-goto-file): Recognize absolute file name
	listings (Bug#7126).
	(dired-goto-file-1): New helper function.
	(dired-toggle-read-only): Inhibit warnings.

2012-03-09  Michael Albinus  <michael.albinus@gmx.de>

	* net/dbus.el (dbus-property-handler): Return empty array if
	there are no properties.

2012-03-09  Leo Liu  <sdl.web@gmail.com>

	* savehist.el (savehist-printable): Stricter check for string
	value (Bug#10937).

2012-03-09  Eli Zaretskii  <eliz@gnu.org>

	* mail/smtpmail.el (smtpmail-send-it):
	Bind coding-system-for-write to *-unix, so that FCC files are kept in
	valid mbox format.

2012-03-09  Glenn Morris  <rgm@gnu.org>

	* files.el (dir-locals-find-file):
	Don't check result is regular, readable.
	(dir-locals-read-from-file): Demote errors.

2012-03-08  Eli Zaretskii  <eliz@gnu.org>

	* international/quail.el (quail-insert-kbd-layout):
	Insert invisible LRM characters before each character in a keyboard
	layout cell, to prevent their reordering by bidi display engine.
	For details, see the discussion in
	https://lists.gnu.org/r/emacs-devel/2012-03/msg00085.html.

2012-03-08  Alan Mackenzie  <acm@muc.de>

	* progmodes/cc-cmds.el (c-mark-function): Make it leave a mark at
	the starting position; make it extend the marked region when
	invoked repeatedly - all under appropriate circumstances.
	Fixes bugs #5525, #10906.

2012-03-08  Glenn Morris  <rgm@gnu.org>

	* files.el (locate-dominating-file, dir-locals-find-file):
	Undo 2012-03-06 change.

2012-03-07  Eli Zaretskii  <eliz@gnu.org>

	* international/quail.el (quail-help):
	Force bidi-paragraph-direction be left-to-right.  See discussion in
	https://lists.gnu.org/r/emacs-devel/2012-03/msg00062.html
	for the reason.

2012-03-07  Michael Albinus  <michael.albinus@gmx.de>

	Avoid superfluous registering of signals.  (Bug#10807)

	* notifications.el (notifications-on-action-object)
	(notifications-on-close-object): New defvars.
	(notifications-on-action-signal, notifications-on-closed-signal):
	Unregister the signal if not needed any longer.
	(notifications-notify): Register `notifications-action-signal' or
	`notifications-closed-signal', if :on-action or :on-close has been
	passed as argument.

2012-03-07  Chong Yidong  <cyd@gnu.org>

	* cus-start.el: Avoid x-select-enable-clipboard-manager warning on
	non-X platforms.

2012-03-06  Glenn Morris  <rgm@gnu.org>

	* term/pc-win.el (x-selection-owner-p, x-own-selection-internal)
	(x-disown-selection-internal, x-get-selection-internal):
	Doc fix (add arglist signatures).  (Bug#10783)

2012-03-06  Kaushik Srenevasan  <ksrenevasan@gmail.com>  (tiny change)

	* progmodes/gdb-mi.el (gdb-breakpoints-list-handler-custom):
	Handle breakpoints with no "type".

2012-03-06  Glenn Morris  <rgm@gnu.org>

	* files.el (locate-dominating-file): Add optional predicate argument.
	(dir-locals-find-file): Make use of above change.

2012-03-06  Thien-Thi Nguyen  <ttn@gnuvola.org>

	* info.el (Info-insert-dir): Also try "dir.gz".

2012-03-06  Glenn Morris  <rgm@gnu.org>

	* files.el (dir-locals-find-file):
	Ignore non-readable or non-regular files.  (Bug#10928)

	* files.el (locate-dominating-file): Doc fix.

2012-03-06  Adam Spiers  <emacs@adamspiers.org>  (tiny change)

	* calendar/calendar.el (calendar-set-mode-line):
	`getenv' returns a string.  (Bug#10951)

2012-03-05  Leo Liu  <sdl.web@gmail.com>

	* simple.el (backward-delete-char-untabify): Constrain point to
	field (Bug#10939).

	* eshell/em-cmpl.el (eshell-cmpl-initialize): Fix shift-tab key.

2012-03-05  Chong Yidong  <cyd@gnu.org>

	* simple.el (count-words): If called from Lisp, return the word
	count, for symmetry with `count-lines'.  Arglist changed.
	(count-words--message): Args changed.  Consolidate counting code
	from count-words and count-words-region.
	(count-words-region): Caller changed.
	(count-lines-region): Make it an obsolete alias.

2012-03-04  Tassilo Horn  <tassilo@member.fsf.org>

	* saveplace.el (save-place-to-alist)
	(save-place-ignore-files-regexp): Allow value nil to disable this
	feature.

2012-03-04  Chong Yidong  <cyd@gnu.org>

	* faces.el (face-spec-reset-face): For the default face, reset the
	attributes to default values (Bug#10748).

2012-03-04  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* mail/emacsbug.el (report-emacs-bug-hook): Fix up thinko in
	previous patch: Check `message-send-mail-function', and not the
	default function (bug#10897).

2012-03-04  Michael Albinus  <michael.albinus@gmx.de>

	* notifications.el (notifications-on-action-signal)
	(notifications-on-closed-signal): Check for unique service name of
	incoming event.  Fix error in removing entry.
	(top): Register for signals with wildcard service name.
	(notifications-notify): Use daemon unique service name for map entries.

2012-03-04  Chong Yidong  <cyd@gnu.org>

	* cus-start.el: Make x-select-enable-clipboard-manager customizable.

2012-03-04  Glenn Morris  <rgm@gnu.org>

	* abbrev.el (copy-abbrev-table, abbrev-table-p)
	(abbrev-minor-mode-table-alist, define-abbrev, abbrev-insert)
	(expand-abbrev, define-abbrev-table): Doc fixes.

2012-03-03  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* mail/emacsbug.el (report-emacs-bug-hook): Look at the value of
	`message-default-send-mail-function' and not `send-mail-function'
	when doing the prompting for `sendmail-query-once' before sending
	in Message buffers (bug#10897).

	* net/tls.el (open-tls-stream): Don't set the dont-query-on-exit flag.
	This is inconsistent with all the other stream functions, which leave
	the setting up to the higher levels (if so wanted) (bug#10931).

2012-03-02  Alan Mackenzie  <acm@muc.de>

	Depessimize the handling of very large macros.

	* progmodes/cc-engine.el (c-macro-cache, c-macro-cache-start-pos):
	(c-macro-cache-syntactic): New variables to implement a one
	element macro cache.
	(c-invalidate-macro-cache): New function.
	(c-beginning-of-macro, c-end-of-macro, c-syntactic-end-of-macro):
	Adapt to use the new cache.
	(c-state-safe-place): Use better the cache of safe positions.
	(c-state-semi-nonlit-pos-cache)
	(c-state-semi-nonlit-pos-cache-limit):
	New variables for...
	(c-state-semi-safe-place): New function.  Here, in a macro is "safe".
	(c-invalidate-state-cache-1): New stuff for c-state-semi-safe-place.
	(c-in-literal, c-literal-limits, c-determine-limit-get-base):
	Use c-state-semi-safe-place.

	* progmodes/cc-langs.el (c-get-state-before-change-functions):
	Add c-invalidate-macro-cache to the C, C++, Obj entries.

2012-03-02  Michael Albinus  <michael.albinus@gmx.de>

	* jka-compr.el (jka-compr-call-process):
	Apply `file-accessible-directory-p' only when the default directory is
	not remote.

2012-03-01  Michael Albinus  <michael.albinus@gmx.de>

	* files.el (file-equal-p): Fix docstring.  Avoid unnecessary
	access of FILE2, if FILE1 does not exist.

	* net/tramp-sh.el (tramp-remote-process-environment): Add "PAGER=\"\"".
	Reported by Robert Lupton the Good <rhl@astro.princeton.edu>.

	* vc/vc-git.el (vc-git--call): Enable `inhibit-null-byte-detection'.
	Add "PAGER=" to `process-environment'.

2012-03-01  Michael R. Mauger  <mmaug@yahoo.com>

	* progmodes/sql.el: Bug fix
	(sql-get-login-ext): Save login values in globals.
	(sql-get-login): Use new version of `sql-get-login-ext'.
	(sql-interactive-mode): Set global `sql-connection' to nil.
	(sql-connect): Set global values for connection.
	(sql-product-interactive): Save global values as buffer local.

2012-02-29  Leo Liu  <sdl.web@gmail.com>

	* abbrev.el (define-abbrevs): Reset sys to nil.

2012-02-28  Thierry Volpiatto  <thierry.volpiatto@gmail.com>

	* files.el (file-equal-p): Rename from `files-equal-p'.
	Return nil when one or both files don't exist.
	(file-subdir-of-p): Now only top directory must exists,
	return nil if it doesn't.
	(copy-directory): No need to test with `file-subdir-of-p' after
	creating dir.
	* net/tramp.el (tramp-file-name-for-operation): Rename `files-equal-p'
	to `file-equal-p'.

2012-02-28  Glenn Morris  <rgm@gnu.org>

	* shell.el (shell-mode):
	* progmodes/vhdl-mode.el (wildcard-to-regexp, file-expand-wildcards):
	* play/landmark.el (landmark-font-lock-face-O):
	* play/handwrite.el (handwrite):
	* play/gomoku.el (gomoku-O):
	* net/browse-url.el (browse-url-browser-display):
	* international/mule.el (define-charset):
	* htmlfontify.el (hfy-etags-cmd, hfy-face-attr-for-class):
	* filesets.el (filesets-find-file-delay):
	* eshell/em-xtra.el (eshell-xtra):
	* eshell/em-unix.el (eshell-grep):
	* emulation/viper.el (viper-mode):
	* emacs-lisp/regexp-opt.el (regexp-opt-group):
	* emacs-lisp/easymenu.el (easy-menu-define):
	* calendar/timeclock.el (timeclock-use-display-time):
	* bs.el (bs-mode):
	* bookmark.el (bookmark-save-flag):
	Doc fix (standardize possessive apostrophe usage).

2012-02-27  Chong Yidong  <cyd@gnu.org>

	* emulation/viper-cmd.el (viper-intercept-ESC-key):
	Fix key-binding lookup for ESC key (Bug#9146).

	* font-lock.el (font-lock-specified-p): Rename from
	font-lock-spec-present.  Callers changed.

2012-02-27  Daniel Hackney  <dan@haxney.org>

	* emacs-lisp/package.el (package-compute-transaction):
	Handle holding a package version to t in package-load-list.

2012-02-26  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-inodes, tramp-devices): Initialize with 0.
	(tramp-get-inode, tramp-get-device): Use cached values.

2012-02-26  Alan Mackenzie  <acm@muc.de>

	Check there is a font-lock specification before doing initial
	fontification.

	* font-core.el (font-lock-mode): Move the conditional from
	:after-hook to font-lock-initial-fontify.
	(font-lock-default-function): Move the check for a specification
	to font-lock-spec-present.

	* font-lock.el (font-lock-initial-fontify): Call ...
	(font-lock-spec-present): New function.

2012-02-26  Jim Blandy  <jimb@red-bean.com>

	* progmodes/gdb-mi.el (gdb-mi-quote): New function.
	(gdb-send): Apply it to the operand of the '-interpreter-exec
	console' command, so that we can pass arguments with (say) quotes
	in them.  Store exact string sent in gdb-debug-log (Bug#10765).

2012-02-26  Chong Yidong  <cyd@gnu.org>

	* help-fns.el (describe-function-1): Clarify description of
	remapping (Bug#10844).

	* files.el (files-equal-p): Doc fix.
	(file-subdir-of-p): Doc fix.  Convert loop macro to plain Lisp,
	and quit the loop once a mismatch is found.

2012-02-25  Juanma Barranquero  <lekktu@gmail.com>

	* bs.el (bs--show-with-configuration): Don't throw an error
	if the window cannot be split; otherwise, subsequent calls to
	bs-show fail, restoring a stale window config.  (Bug#10882)

2012-02-25  Jan Djärv  <jan.h.d@swipnet.se>

	* term/ns-win.el (global-map): Bind ns-drag-file to
	ns-find-file (Bug#5855, Bug#10050).

2012-02-25  Andreas Schwab  <schwab@linux-m68k.org>

	* calendar/parse-time.el (parse-time-string): Allow extractor to
	return nil.

2012-02-25  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-file-name-for-operation):
	Add `files-equal-p' and `file-subdir-of-p'.

	* net/tramp-sh.el (tramp-sh-handle-copy-directory):
	* net/tramp-smb.el (tramp-smb-handle-copy-directory):
	Add COPY-CONTENTS argument.

2012-02-25  Chong Yidong  <cyd@gnu.org>

	Add custom groups for VC backends, for consistency with vc-bzr.

	* vc/vc-arch.el (vc-arch):
	* vc/vc-cvs.el (vc-cvs):
	* vc/vc-git.el (vc-git):
	* vc/vc-hg.el (vc-hg):
	* vc/vc-mtn.el (vc-mtn):
	* vc/vc-rcs.el (vc-rcs):
	* vc/vc-sccs.el (vc-sccs):
	* vc/vc-svn.el (vc-svn): New customization group (Bug#10871).
	All relevant defcustoms reassigned.

2012-02-25  Chong Yidong  <cyd@gnu.org>

	* newcomment.el (comment-styles): Add autoload (Bug#10868).

	* term/x-win.el (x-initialize-window-system): Reduce default for
	x-selection-timeout to 5 seconds (Bug#8869).

2012-02-24  Thierry Volpiatto  <thierry.volpiatto@gmail.com>

	* files.el (files-equal-p, file-subdir-of-p): New functions.
	(copy-directory): Error when trying to copy a directory on itself.
	Add missing copy-contents arg to tramp handler.
	* dired-aux.el (dired-copy-file-recursive): Same.
	(dired-create-files): Modify destination when source is equal to
	dest when copying files.
	Return also when dest is a subdir of source.  (Bug#10489)

2012-02-24  Michael Albinus  <michael.albinus@gmx.de>

	* net/ange-ftp.el (ange-ftp-parse-netrc): Suppress comment lines.
	(Bug#10874)

2012-02-23  Alan Mackenzie  <acm@muc.de>

	* emacs-lisp/easy-mmode.el (define-minor-mode): Add extra
	parameter "after-hook:" to allow the expansion to run code after
	the execution of the mode hooks.

	* font-lock.el (font-lock-initial-fontify): New function extracted
	from font-lock-mode-internal.

	* font-core.el (font-lock-mode): Call font-lock-initial-fontify in
	:after-hook.

2012-02-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuffer.el: Make sure cycling is reset upon edit with icomplete.el.
	(completion--cache-all-sorted-completions): New function.
	(completion-all-sorted-completions): Use it.
	(completion--do-completion, minibuffer-force-complete):
	Use it to re-instate the flush hook.

	* icomplete.el (icomplete-completions): Replace last fix with a better
	one (bug#10850).

2012-02-23  Dmitry Gutov  <dgutov@yandex.ru>

	* emacs-lisp/lisp.el (beginning-of-defun-raw): Don't call end-of-defun
	when it might call us back infinitely (bug#10797).

2012-02-23  Glenn Morris  <rgm@gnu.org>

	* minibuffer.el (completion-category-overrides): Doc fix.

2012-02-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuffer.el (completion-table-with-context): Fix inf-loop.
	Reported by Aaron S. Hawley <aaron.s.hawley@gmail.com>.

2012-02-23  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/authors.el (authors-aliases, authors-fixed-case)
	(authors-obsolete-files-regexps, authors-ignored-files)
	(authors-ambiguous-files, authors-renamed-files-alist):
	Add more entries.

2012-02-23  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-occur): Sync interactive spec with occur's
	new feature in `occur-read-primary-args'.  Doc fix.  (Bug#10705)

	* replace.el (occur-menu-map): Add menu item for `occur-edit-mode'.

2012-02-22  Juri Linkov  <juri@jurta.org>

	* international/mule-cmds.el (read-char-by-name): Use \` and \'.
	(ucs-insert): Doc fix.  Check for hex digits in the string.
	Don't display `nil' in the error message.  (Bug#10857)

2012-02-22  Alan Mackenzie  <acm@muc.de>

	* progmodes/cc-mode.el: Revert change #2012-02-06T22:08:41Z!larsi@gnus.org from 2012-02-06.

2012-02-22  Glenn Morris  <rgm@gnu.org>

	* ffap.el (ffap-c-path):
	* man.el (Man-header-file-path): Handle multiarch.  (Bug#10702)

2012-02-22  Chong Yidong  <cyd@gnu.org>

	* custom.el (load-theme): Doc fix.

2012-02-22  Glenn Morris  <rgm@gnu.org>

	* dired-x.el (dired-guess-shell-alist-default):
	Remove escape sequences from nroff output.  (Bug#172)

2012-02-21  Glenn Morris  <rgm@gnu.org>

	* vc/emerge.el (emerge-defvar-local):
	Set `permanent-local' property rather than unused `preserved'.

	* textmodes/picture.el (picture-delete-char): New alias.
	(picture-mode-map): Use it.  (Bug#10860)
	(picture-mode): Doc fix.

2012-02-21  Juanma Barranquero  <lekktu@gmail.com>

	* newcomment.el (uncomment-region-default): Remove unused binding.

2012-02-21  Glenn Morris  <rgm@gnu.org>

	* textmodes/picture.el (picture-motion, picture-motion-reverse)
	(picture-self-insert, picture-tab-chars): Doc fix.
	(picture-mode-map): Fix C-a, C-e.

2012-02-20  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/authors.el (authors-aliases): Add another entry.

2012-02-20  Leo Liu  <sdl.web@gmail.com>

	* icomplete.el (icomplete-completions): Check FROM arg before
	passing to substring (Bug#10850).

2012-02-19  Chong Yidong  <cyd@gnu.org>

	* comint.el: Require ansi-color.
	(comint-output-filter-functions): Add ansi-color-process-output.

	* ansi-color.el: Don't set comint-output-filter-functions; it is
	now in the initial value defined in comint.el.
	(ansi-color-apply-face-function): New variable.
	(ansi-color-apply-on-region): Use it.
	(ansi-color-apply-overlay-face): New function.

	* shell.el (shell): No need to require ansi-color.
	(shell-mode): Use ansi-color-apply-face-function to highlight
	color escapes using font-lock-face property (Bug#10835).

2012-02-19  Chong Yidong  <cyd@gnu.org>

	* vc/ediff-init.el (ediff-strip-mode-line-format): Handle non-list
	mode-line formats (Bug#10839).

2012-02-18  Glenn Morris  <rgm@gnu.org>

	* mail/rmail.el (rmail-dont-reply-to-names): Mark as obsolete.

	* mail/undigest.el (unforward-rmail-message): Doc fix.

	* saveplace.el (save-place-ignore-files-regexp): Add :version.

2012-02-18  Eli Zaretskii  <eliz@gnu.org>

	* international/characters.el (script-list): Sync with the latest
	Unicode Character Database.

2012-02-18  Andreas Schwab  <schwab@linux-m68k.org>

	* international/titdic-cnv.el: Remove duplicate coding tag.
	* language/cham.el: Likewise.
	* language/tai-viet.el: Likewise.

2012-02-18  Glenn Morris  <rgm@gnu.org>

	* calendar/cal-menu.el (cal-menu-diary-menu, cal-menu-goto-menu):
	* calendar/calendar.el (diary-file, diary-bahai-entry-symbol)
	(calendar-bahai-all-holidays-flag, calendar-other-dates):
	* calendar/diary-lib.el (diary-abbreviated-year-flag):
	* calendar/holidays.el (holiday-bahai-holidays)
	(calendar-holidays, list-holidays):
	Use utf-8 Bahá'í in doc-strings, menus, etc.

2012-02-17  Tassilo Horn  <tassilo@member.fsf.org>

	* saveplace.el (save-place-ignore-files-regexp): New variable
	allowing for excluding files from saving their location of point.
	The default value matches the temporary commit message editing
	files from Git, SVN, Bazaar, and Mercurial.
	(save-place-to-alist): Use it.

2012-02-17  Lawrence Mitchell  <wence@gmx.li>
	    Stefan Monnier  <monnier@iro.umontreal.ca>

	* newcomment.el (uncomment-region-default): Don't leave extra space
	when an arg is provided (bug#8150).

2012-02-17  Teodor Zlatanov  <tzz@lifelogs.com>

	* net/gnutls.el (gnutls-trustfiles): Fix Cygwin bundle location.

2012-02-17  Glenn Morris  <rgm@gnu.org>

	* net/socks.el: Require network-stream.  (Bug#10599)

2012-02-17  Kenichi Handa  <handa@m17n.org>

	* international/charprop.el:
	* international/uni-name.el:
	* international/uni-old-name.el:
	* international/uni-comment.el: Regenerate.

2012-02-16  Glenn Morris  <rgm@gnu.org>

	* calendar/cal-hebrew.el (calendar-hebrew-list-yahrzeits):
	Interactively in calendar buffer, give an error if not on a date.

2012-02-15  Glenn Morris  <rgm@gnu.org>

	* shell.el (shell-delimiter-argument-list):
	Revert 2011-02-17 change.  (Bug#8027)

2012-02-15  Chong Yidong  <cyd@gnu.org>

	* minibuffer.el (completion-at-point-functions): Doc fix.

	* custom.el (defcustom): Doc fix; note use of defvar.

2012-02-15  Glenn Morris  <rgm@gnu.org>

	* mail/smtpmail.el (smtpmail-smtp-user, smtpmail-stream-type):
	Doc fixes.

2012-02-14  Glenn Morris  <rgm@gnu.org>

	* mail/smtpmail.el (smtpmail-query-smtp-server): Give it a doc.

2012-02-14  Lars Ingebrigtsen  <larsi@gnus.org>

	* mail/smtpmail.el (smtpmail-query-smtp-server): Fix typo in the
	way the ports list is computed.
	(smtpmail-query-smtp-server): Prompt the user for a port number if
	we can't connect to any of the standard ports (bug#10810).

2012-02-14  Teodor Zlatanov  <tzz@lifelogs.com>

	* net/gnutls.el (gnutls-trustfiles): Add Cygwin location.

2012-02-13  Glenn Morris  <rgm@gnu.org>

	* minibuffer.el (read-file-name): Doc fix.  (Bug#10798)

2012-02-13  Teodor Zlatanov  <tzz@lifelogs.com>

	* net/gnutls.el (gnutls-trustfiles): New variable.
	(gnutls-negotiate): Use it.

2012-02-13  Lars Ingebrigtsen  <larsi@gnus.org>

	* simple.el (mail-user-agent): Mention that `gnus-user-agent' only
	does its stuff if Gnus is running.

2012-02-13  Alan Mackenzie  <acm@muc.de>

	Fix a loop in c-set-fl-decl-start.

	* progmodes/cc-engine.el (c-set-fl-decl-start): Add a check that
	c-backward-syntactic-ws actually moves backwards.

2012-02-13  Leo Liu  <sdl.web@gmail.com>

	* net/rcirc.el (rcirc-markup-attributes): Move point to the
	beginning so that all \C-o chars are removed.

2012-02-12  Teodor Zlatanov  <tzz@lifelogs.com>

	* net/gnutls.el (gnutls-algorithm-priority): Add missing :group tag.

2012-02-12  Alan Mackenzie  <acm@muc.de>

	Fix infinite loop with long macros.
	* progmodes/cc-engine.el (c-state-safe-place): Handle macros properly.

2012-02-12  Chong Yidong  <cyd@gnu.org>

	* window.el (display-buffer): Doc fix (Bug#10785).

2012-02-12  Glenn Morris  <rgm@gnu.org>

	* term/pc-win.el (x-selection-owner-p, x-own-selection-internal)
	(x-disown-selection-internal, x-get-selection-internal):
	Sync docs with the xselect.c versions.

	* allout-widgets.el: Add missing license notice.

2012-02-11  Glenn Morris  <rgm@gnu.org>

	* select.el (x-get-selection-internal, x-own-selection-internal)
	(x-disown-selection-internal):
	* x-dnd.el (x-get-selection-internal): Update declarations.

	* vc/log-view.el (vc-diff-internal): Remove unneeded declaration.

	* window.el (window-sides-slots):
	* tool-bar.el (tool-bar-position):
	* term/xterm.el (xterm-extra-capabilities):
	* ses.el (ses-self-reference-early-detection):
	* progmodes/verilog-mode.el (verilog-auto-declare-nettype)
	(verilog-auto-wire-type)
	(verilog-auto-delete-trailing-whitespace)
	(verilog-auto-reset-blocking-in-non, verilog-auto-inst-sort)
	(verilog-auto-tieoff-declaration):
	* progmodes/sql.el (sql-login-hook, sql-ansi-statement-starters)
	(sql-oracle-statement-starters, sql-oracle-scan-on):
	* progmodes/prolog.el (prolog-align-comments-flag)
	(prolog-indent-mline-comments-flag, prolog-object-end-to-0-flag)
	(prolog-left-indent-regexp, prolog-paren-indent-p)
	(prolog-paren-indent, prolog-parse-mode, prolog-keywords)
	(prolog-types, prolog-mode-specificators)
	(prolog-determinism-specificators, prolog-directives)
	(prolog-electric-newline-flag, prolog-hungry-delete-key-flag)
	(prolog-electric-dot-flag)
	(prolog-electric-dot-full-predicate-template)
	(prolog-electric-underscore-flag, prolog-electric-tab-flag)
	(prolog-electric-if-then-else-flag, prolog-electric-colon-flag)
	(prolog-electric-dash-flag, prolog-old-sicstus-keys-flag)
	(prolog-program-switches, prolog-prompt-regexp)
	(prolog-debug-on-string, prolog-debug-off-string)
	(prolog-trace-on-string, prolog-trace-off-string)
	(prolog-zip-on-string, prolog-zip-off-string)
	(prolog-use-standard-consult-compile-method-flag)
	(prolog-use-prolog-tokenizer-flag, prolog-imenu-flag)
	(prolog-imenu-max-lines, prolog-info-predicate-index)
	(prolog-underscore-wordchar-flag, prolog-use-sicstus-sd)
	(prolog-char-quote-workaround):
	* progmodes/cc-vars.el (c-defun-tactic):
	* net/tramp.el (tramp-encoding-command-interactive)
	(tramp-local-end-of-line):
	* net/soap-client.el (soap-client):
	* net/netrc.el (netrc-file):
	* net/gnutls.el (gnutls):
	* minibuffer.el (completion-category-overrides)
	(completion-cycle-threshold)
	(completion-pcm-complete-word-inserts-delimiters):
	* man.el (Man-name-local-regexp):
	* mail/feedmail.el (feedmail-display-full-frame):
	* international/characters.el (glyphless-char-display-control):
	* eshell/em-ls.el (eshell-ls-date-format):
	* emacs-lisp/cl-indent.el (lisp-lambda-list-keyword-alignment)
	(lisp-lambda-list-keyword-parameter-indentation)
	(lisp-lambda-list-keyword-parameter-alignment):
	* doc-view.el (doc-view-image-width, doc-view-unoconv-program):
	* dired-x.el (dired-omit-verbose):
	* cus-theme.el (custom-theme-allow-multiple-selections):
	* calc/calc.el (calc-highlight-selections-with-faces)
	(calc-lu-field-reference, calc-lu-power-reference)
	(calc-note-threshold):
	* battery.el (battery-mode-line-limit):
	* arc-mode.el (archive-7z-extract, archive-7z-expunge)
	(archive-7z-update):
	* allout.el (allout-prefixed-keybindings)
	(allout-unprefixed-keybindings)
	(allout-inhibit-auto-fill-on-headline)
	(allout-flattened-numbering-abbreviation):
	* allout-widgets.el (allout-widgets-auto-activation)
	(allout-widgets-icons-dark-subdir)
	(allout-widgets-icons-light-subdir, allout-widgets-icon-types)
	(allout-widgets-theme-dark-background)
	(allout-widgets-theme-light-background)
	(allout-widgets-item-image-properties-emacs)
	(allout-widgets-item-image-properties-xemacs)
	(allout-widgets-run-unit-tests-on-load)
	(allout-widgets-time-decoration-activity)
	(allout-widgets-hook-error-post-time)
	(allout-widgets-track-decoration):
	Add missing :version tags to new defcustoms and defgroups.

	* progmodes/sql.el (sql-ansi-statement-starters)
	(sql-oracle-statement-starters): Add custom type.

	* progmodes/prolog.el: Remove leading '*' from defcustom docs.
	(prolog-system-version): Give it a type.

2012-02-11  Eli Zaretskii  <eliz@gnu.org>

	* term/pc-win.el (x-select-text, x-selection-owner-p)
	(x-own-selection-internal, x-disown-selection-internal)
	(x-get-selection-internal): Sync doc strings and argument lists
	with xselect.c, common-win.el and x-win.el.  (Bug#10783)

2012-02-11  Leo Liu  <sdl.web@gmail.com>

	* progmodes/python.el (python-end-of-statement): Fix infinite
	loop.  (Bug#10788)

2012-02-10  Glenn Morris  <rgm@gnu.org>

	* international/mule-cmds.el (unify-8859-on-encoding-mode)
	(unify-8859-on-decoding-mode): Properly mark as obsolete.

2012-02-10  Lars Ingebrigtsen  <larsi@gnus.org>

	* mail/emacsbug.el (report-emacs-bug-hook): Query the user first
	about SMTP before checking the From header.

	* mail/sendmail.el (sendmail-query-user-about-smtp): Refactor out
	into own function for reuse by emacsbug.el.

2012-02-10  Leo Liu  <sdl.web@gmail.com>

	* subr.el (condition-case-unless-debug): Rename from
	condition-case-no-debug.  All callers changed.
	(with-demoted-errors): Fix caller.

	* vc/diff-mode.el (diff-auto-refine-mode, diff-hunk):
	* nxml/rng-valid.el (rng-do-some-validation):
	* emacs-lisp/package.el (package-refresh-contents)
	(package-menu-execute):
	* desktop.el (desktop-create-buffer):
	* font-lock.el (lisp-font-lock-keywords-2): Caller changed.

2012-02-10  Glenn Morris  <rgm@gnu.org>

	* textmodes/bibtex.el:
	Add missing :version tags for new/changed defcustoms.

	* files.el (remote-file-name-inhibit-cache): Doc fixes.

2012-02-09  Lars Ingebrigtsen  <larsi@rusty>

	* mail/smtpmail.el (smtpmail-user-mail-address): New function.
	(smtpmail-via-smtp): Use it, or fall back on the From address.
	(smtpmail-send-it): Ditto.

2012-02-09  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/bytecomp.el (byte-compile-file-form-defvar):
	Don't fallback on byte-compile-defvar.  Optimize (defvar foo) away.
	(byte-compile-tmp-var): New const.
	(byte-compile-defvar): Use it to minimize .elc size.
	Just use `defvar' rather than simulate it (bug#10761).

2012-02-09  Glenn Morris  <rgm@gnu.org>

	* files.el (rename-uniquely): Doc fix.  (Bug#3806)

	* progmodes/cc-guess.el (c-guess-offset-threshold, c-guess-region-max):
	Add :version tags.

	* progmodes/compile.el (compilation-error-screen-columns)
	(compilation-first-column, compilation-filter-start): Doc fixes.

	* vc/log-view.el (log-view-toggle-entry-display):
	* vc/vc.el (vc-merge, vc-pull): Doc fixes.

	* mail/emacsbug.el (report-emacs-bug-can-use-osx-open)
	(report-emacs-bug-can-use-xdg-email):
	(report-emacs-bug-insert-to-mailer): Doc fixes.
	(report-emacs-bug): Message fix.

	* net/browse-url.el (browse-url-can-use-xdg-open)
	(browse-url-xdg-open): Doc fixes.

	* electric.el (electric-indent-mode, electric-pair-mode)
	(electric-layout-rules, electric-layout-mode): Doc fixes.
	(electric-pair-pairs, electric-pair-skip-self): Add :version tags.

2012-02-08  Martin Rudalics  <rudalics@gmx.at>

	* server.el (server-unselect-display): Don't inadvertently kill
	the current buffer.  (Bug#10729)

2012-02-08  Glenn Morris  <rgm@gnu.org>

	* progmodes/sql.el (sql-port, sql-connection-alist, sql-list-all)
	(sql-list-table): Doc fixes.

	* image-mode.el (image-transform-minor-mode-map, image-transform-mode):
	Comment out (does nothing).

	* completion.el (dynamic-completion-mode):
	* dirtrack.el (dirtrack-debug-mode):
	* electric.el (electric-layout-mode):
	* epa-mail.el (epa-mail-mode, epa-global-mail-mode):
	* face-remap.el (text-scale-mode, buffer-face-mode):
	* iimage.el (iimage-mode):
	* image-mode.el (image-transform-mode):
	* minibuffer.el (completion-in-region-mode):
	* scroll-lock.el (scroll-lock-mode):
	* simple.el (next-error-follow-minor-mode):
	* tar-mode.el (tar-subfile-mode):
	* tooltip.el (tooltip-mode):
	* vcursor.el (vcursor-use-vcursor-map):
	* wid-browse.el (widget-minor-mode):
	* emulation/tpu-edt.el (tpu-edt-mode):
	* emulation/tpu-extras.el (tpu-cursor-free-mode):
	* international/iso-ascii.el (iso-ascii-mode):
	* language/thai-util.el (thai-word-mode):
	* mail/supercite.el (sc-minor-mode):
	* net/goto-addr.el (goto-address-mode):
	* net/rcirc.el (rcirc-multiline-minor-mode, rcirc-track-minor-mode):
	* progmodes/cwarn.el (cwarn-mode):
	* progmodes/flymake.el (flymake-mode):
	* progmodes/glasses.el (glasses-mode):
	* progmodes/hideshow.el (hs-minor-mode):
	* progmodes/pascal.el (pascal-outline-mode):
	* textmodes/enriched.el (enriched-mode):
	* vc/smerge-mode.el (smerge-mode):
	Doc fixes (minor mode argument).

2012-02-07  Eli Zaretskii  <eliz@gnu.org>

	* ls-lisp.el (ls-lisp-sanitize): New function.
	(ls-lisp-insert-directory): Use it to fix or remove any elements
	in file-alist with missing attributes.  (Bug#4673)

2012-02-07  Alan Mackenzie  <acm@muc.de>

	Fix spurious recognition of c-in-knr-argdecl.

	* progmodes/cc-engine.el (c-in-knr-argdecl): Check for '=' in a
	putative K&R region.

2012-02-07  Alan Mackenzie  <acm@muc.de>

	* progmodes/cc-engine.el (c-forward-objc-directive):
	Prevent looping in "#pragma mark @implementation".

2012-02-07  Michael Albinus  <michael.albinus@gmx.de>

	* notifications.el (notifications-on-closed-signal): Make `reason'
	optional.  (Bug#10744)

2012-02-07  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/easy-mmode.el (define-minor-mode):
	Doc fixes for the macro and the mode it defines.

	* image.el (imagemagick-types-inhibit): Doc fix.

	* cus-start.el (imagemagick-render-type): Add it.

2012-02-06  Lars Ingebrigtsen  <larsi@gnus.org>

	* progmodes/cc-mode.el (c-standard-font-lock-fontify-region-function):
	Set the default at load time, too, so that `font-lock-fontify-buffer'
	can be called without setting up the entire mode first.  This fixes
	a bug in `mm-inline-text' with C MIME parts.

2012-02-06  Chong Yidong  <cyd@gnu.org>

	* simple.el (list-processes--refresh): Delete exited processes
	(Bug#8094).

	* comint.el (comint-next-prompt): next-single-char-property-change
	and prev-single-char-property-change never return nil (Bug#8657).

	* custom.el (defcustom): Doc fix (Bug#9711).

2012-02-05  Chong Yidong  <cyd@gnu.org>

	* cus-edit.el (custom-variable-reset-backup): Quote the value
	before storing it in the customized-value property (Bug#6712).
	(custom-display): Add a customization type tag.
	(custom-buffer-create-internal): Improve tooltip message.

	* wid-edit.el (widget-field-value-get): New optional arg to
	suppress trailing whitespace truncation.
	(character): Use it (Bug#2689).

2012-02-05  Andreas Schwab  <schwab@linux-m68k.org>

	* progmodes/gud.el (gud-pv): Use pv instead of pv1.
	* progmodes/gdb-mi.el (gud-pp): Use pp instead of pp1.

2012-02-05  Chong Yidong  <cyd@gnu.org>

	* cus-edit.el (custom-variable-value-create): For mismatched
	types, show the current value (Bug#7600).

	* custom.el (defcustom): Doc fix.

2012-02-05  Glenn Morris  <rgm@gnu.org>

	* font-lock.el (lisp-font-lock-keywords-2): Add with-wrapper-hook.

2012-02-05  Juanma Barranquero  <lekktu@gmail.com>

	* emacs-lisp/pp.el (pp-to-string): Use `with-temp-buffer'.
	(pp-buffer): Use `ignore-errors', `looking-at-p'.
	(pp-last-sexp): Use `looking-at-p'.

2012-02-04  Glenn Morris  <rgm@gnu.org>

	* files.el (revert-buffer):
	Doc fix (mention revert-buffer-in-progress-p).

	* emacs-lisp/ert-x.el (ert-simulate-command):
	Check deferred-action-list (which is obsolete) is bound.

	* subr.el (with-wrapper-hook): Doc fixes.

	* simple.el (filter-buffer-substring-functions)
	(buffer-substring-filters, filter-buffer-substring): Doc fixes.

2012-02-04  Lars Ljung  <lars@matholka.se>  (tiny change)

	* eshell/esh-ext.el (eshell-windows-shell-file): Match "cmdproxy"
	anywhere in shell-file-name, not just at the beginning.  (Bug#10523)

2012-02-04  Leo Liu  <sdl.web@gmail.com>

	* emacs-lisp/smie.el: Fix dead link (Bug#10711).

2012-02-04  Glenn Morris  <rgm@gnu.org>

	* image.el (image-extension-data): Add obsolete alias.

	* isearch.el (isearch-update): Doc fix.

	* facemenu.el (list-colors-display): Doc fix (minor rephrasing).

	* ido.el (ido-find-file): Doc fix (ido-toggle-vc not on any key).

2012-02-03  Glenn Morris  <rgm@gnu.org>

	* image.el (image-animated-p): Doc fix.  Use image-animated-types.
	(image-animate-timeout): Doc fix.

	* image-mode.el (image-animate-loop, image-toggle-animation): Doc fixes.

2012-02-02  Glenn Morris  <rgm@gnu.org>

	* server.el (server-auth-dir): Doc fix.
	(server-eval-at): Doc fix.  Give an explicit error if !server-use-tcp.

	* subr.el (run-mode-hooks): Doc fix.

2012-02-02  Juri Linkov  <juri@jurta.org>

	* image-mode.el (image-toggle-display-image): Remove tautological
	`major-mode' from the `derived-mode-p' test.

2012-02-02  Kenichi Handa  <handa@m17n.org>

	* composite.el (compose-region): Cancel previous change.

2012-02-02  Kenichi Handa  <handa@m17n.org>

	* composite.el (compose-region, compose-string): Signal error for
	a null string component (Bug#6988).

2012-02-01  Chong Yidong  <cyd@gnu.org>

	* view.el (view-buffer-other-window, view-buffer-other-frame):
	Handle special modes like view-buffer (Bug#10650).
	(view-buffer): Simplify.

	* frame.el (set-frame-font): Tweak meaning of third argument.

	* dynamic-setting.el (font-setting-change-default-font):
	Use set-frame-font (Bug#9982).

2012-02-01  Glenn Morris  <rgm@gnu.org>

	* progmodes/compile.el (compilation-internal-error-properties):
	Respect compilation-first-column in the "*compilation*" buffer.

	* emacs-lisp/easy-mmode.el (define-minor-mode):
	Relax :variable's test for a named function.

2012-01-31  Alan Mackenzie  <acm@muc.de>

	* progmodes/cc-engine.el (c-guess-basic-syntax): CASE 5B.1: Fix an
	off by one error.

2012-01-31  Chong Yidong  <cyd@gnu.org>

	* frame.el (set-frame-font): New arg ALL-FRAMES.

	* menu-bar.el (menu-set-font): Use set-frame-font.

	* faces.el (face-spec-reset-face): Don't apply unspecified
	attribute values to the default face.

2012-01-31  Juanma Barranquero  <lekktu@gmail.com>

	* progmodes/cwarn.el (cwarn): Remove dead link.
	(cwarn-configuration, cwarn-verbose, cwarn-mode-text, cwarn-load-hook):
	Remove * from defcustom docstrings.
	(turn-on-cwarn-mode): Make obsolete.
	(c-at-toplevel-p): Remove compatibility code for Emacs 20.3 and older.
	(turn-on-cwarn-mode-if-enabled): Call `cwarn-mode'.

2012-01-31  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/easy-mmode.el (define-minor-mode): Doc fix.
	Fix :variable handling of mode a symbol not equal to modefun.
	Allow named functions to be used as the cdr of :variable.

2012-01-30  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/authors.el (authors-fixed-entries):
	Remove reference to deleted file rnewspost.el.

2012-01-29  Juanma Barranquero  <lekktu@gmail.com>

	* window.el (window-with-parameter): Remove unused variable `windows'.
	(window--side-check): Remove unused variable `code'.
	(window--resize-siblings): Remove unused variable `first'.
	(adjust-window-trailing-edge): Remove unused variable `failed'.
	(window-deletable-p, window--delete): Remove unused variable `buffer'.
	Use `let', not `let*'.
	(balance-windows-2): Remove unused variable `found'.
	(window--state-put-2): Remove unused variable `splits'.
	(window-state-put): Remove unused variable `selected'.
	(same-window-p): Use `string-match-p'.
	(display-buffer-assq-regexp): Remove unused variable `value'.
	(display-buffer-pop-up-frame, display-buffer-pop-up-window):
	Mark argument ALIST as ignored.
	(pop-to-buffer): Remove unused variable `old-window'.

2012-01-29  Eli Zaretskii  <eliz@gnu.org>

	* jka-cmpr-hook.el (jka-compr-compression-info-list): Support .lz
	and .lzma compressed files.

2012-01-29  Chong Yidong  <cyd@gnu.org>

	* frame.el (window-system-default-frame-alist): Doc fix.

	* dynamic-setting.el (font-setting-change-default-font): Don't
	change the default face if SET-FONT argument is non-nil (Bug#9982).

2012-01-29  Samuel Bronson  <naesten@gmail.com>

	* custom.el (defcustom): Add doc link to Lisp manual (Bug#10635).

2012-01-29  Syver Enstad  <syver.enstad@cisco.com>  (tiny change)

	* progmodes/gud.el (pdb): Give pdb full paths, to allow setting
	breakpoints in files outside current directory (Bug#6098).

2012-01-29  Chong Yidong  <cyd@gnu.org>

	* progmodes/python.el: Require ansi-color at top-level.

	* emacs-lisp/lisp-mode.el (emacs-lisp-mode-abbrev-table):
	Define and use in Emacs Lisp mode (Bug#9360).
	(lisp-mode-abbrev-table): Add doc.
	(lisp-mode-variables): Don't set local-abbrev-table.
	(lisp-interaction-mode): Use emacs-lisp-mode-abbrev-table.

2012-01-28  Roland Winkler  <winkler@gnu.org>

	* textmodes/bibtex.el (bibtex-vec-incr): Fix docstring.

2012-01-28  Roland Winkler  <winkler@gnu.org>

	* textmodes/bibtex.el (bibtex-entry-alist): New function.
	(bibtex-set-dialect): Use it.  Either set global values of
	dialect-dependent variables or bind these variables buffer-locally
	(Bug#10254).
	(bibtex-mode): Call bibtex-set-dialect via
	hack-local-variables-hook.
	(bibtex-dialect): Update docstring.
	Add safe-local-variable predicate.
	(bibtex-entry-alist, bibtex-field-alist): Initialize via
	bibtex-set-dialect.
	(bibtex-mode-map): Define menu for each dialect.
	(bibtex-entry): Fix docstring.

2012-01-28  Chong Yidong  <cyd@gnu.org>

	* eshell/esh-arg.el (eshell-quote-argument): New function.

	* eshell/esh-ext.el (eshell-invoke-batch-file):
	* eshell/em-unix.el (eshell/cat, eshell/du): Use it to quote the
	first arg to eshell-parse-command (Bug#10523).

2012-01-28  Drew Adams  <drew.adams@oracle.com>

	* net/ange-ftp.el (ange-ftp-canonize-filename): Check, that
	`default-directory' is non-nil.

2012-01-28  Eli Zaretskii  <eliz@gnu.org>

	* mail/emacsbug.el (report-emacs-bug): Fill the potentially long
	line that displays system-configuration-options.  (Bug#9924)

2012-01-28  Drew Adams  <drew.adams@oracle.com>

	* descr-text.el (describe-char): Show information about POS, in
	addition to information about the character at POS.  Improve and
	update the doc string.  Change "code point" to "code point in
	charset", to avoid confusion with the character's Unicode code
	point shown above that.  (Bug#10129)

2012-01-28  Eli Zaretskii  <eliz@gnu.org>

	* descr-text.el (describe-char): Show the raw character, not only
	its display form at POS.  Suggested by Kenichi Handa <handa@m17n.org>.
	See https://lists.gnu.org/r/emacs-devel/2012-01/msg00760.html
	for the reasons.

2012-01-28  Phil Hagelberg  <phil@hagelb.org>

	* emacs-lisp/package.el (package-install):
	Run package-refresh-contents if there is no archive yet (Bug#9798).

2012-01-28  Chong Yidong  <cyd@gnu.org>

	* emacs-lisp/package.el (package-maybe-load-descriptor):
	New function, split from package-maybe-load-descriptor.
	(package-maybe-load-descriptor): Use it.
	(package-download-transaction): Fully load required packages
	inside the loop, so that `require' calls work (Bug#10593).
	(package-install): No need to call package-initialize now.

2012-01-28  Chong Yidong  <cyd@gnu.org>

	* simple.el (deactivate-mark): Doc fix (Bug#8614).

	* tooltip.el (tooltip-mode): Doc fix.
	(tooltip-use-echo-area): Mark as obsolete (Bug#6595).

	* frame.el (set-cursor-color): Doc fix (Bug#352).

	* mail/rmail.el (rmail-start-mail): Add send-action again (Bug#10625).
	(rmail-mail-return): Switch to NEWBUF only if it is non-nil.

	* cus-edit.el (custom-buffer-create-internal): Fix search button
	action (Bug#10542).
	(customize-unsaved, customize-saved): Doc fix (Bug#10541).

2012-01-27  Eduard Wiebe  <usenet@pusto.de>

	* dired.el (dired-mark-files-regexp):
	Include any subdirectory components.  (Bug#10445)

2012-01-27  Mike Lamb  <mrlamb@gmail.com>  (tiny change)

	* pcmpl-unix.el (pcmpl-ssh-known-hosts):
	Handle [host]:port syntax.  (Bug#10533)

2012-01-27  Alex Harsanyi  <harsanyi@mac.com>

	* xml.el (xml-parse-tag): Fix parsing of comments (Bug#10405).

2012-01-26  Glenn Morris  <rgm@gnu.org>

	* dired-x.el (dired-bind-jump): Use ctl-x-map and ctl-x-4-map.
	* term.el (term-raw-escape-map): Use Control-X-prefix.
	* vc/vc-hooks.el (vc-prefix-map): Use ctl-x-map.  (Bug#10566)

2012-01-25  Martin Rudalics  <rudalics@gmx.at>

	* window.el (window-state-get, window--state-get-1): Don't deal
	with fixed-sizeness of windows.  Simplify code.

2012-01-25  Jérémy Compostella  <jeremy.compostella@gmail.com>

	* window.el (window--state-get-1, window--state-put-2):
	Don't save and restore the mark.

2012-01-25  Chong Yidong  <cyd@gnu.org>

	* custom.el (custom-variable-p): Doc fix.

2012-01-25  Glenn Morris  <rgm@gnu.org>

	* dired.el (dired-goto-file): Handle some of the more common
	characters that `ls -b' escapes.  (Bug#10596)

	* progmodes/compile.el (compilation-next-error-function):
	Respect compilation-first-column in the "*compilation*" buffer.
	* progmodes/grep.el (grep-first-column): New variable.  (Bug#10594)

	* vc/vc.el (vc-modify-change-comment): Scoping fix.  (Bug#10513)

2012-01-24  Glenn Morris  <rgm@gnu.org>

	* pcmpl-gnu.el (pcomplete/tar): Handle " - ".  (Bug#10457)

2012-01-24  Julien Danjou  <julien@danjou.info>

	* color.el (color-rgb-to-hsl): Fix value computing.
	(color-hue-to-rgb): New function.
	(color-hsl-to-rgb): New function.
	(color-clamp, color-saturate-hsl, color-saturate-name)
	(color-desaturate-hsl, color-desaturate-name, color-lighten-hsl)
	(color-lighten-name, color-darken-hsl, color-darken-name): New function.

2012-01-24  Glenn Morris  <rgm@gnu.org>

	* vc/vc-rcs.el (vc-rcs-create-tag):
	* vc/vc-sccs.el (vc-sccs-create-tag):
	Fix argument spec to be what vc-create-tag expects.  (Bug#10515)

2012-01-23  Mike Lamb  <mrlamb@gmail.com>  (tiny change)

	* eshell/esh-util.el (eshell-read-hosts-file):
	Skip comment lines.  (Bug#10549)

	* eshell/em-unix.el (pcomplete/ssh): Remove.  (Bug#10548)

2012-01-23  Juanma Barranquero  <lekktu@gmail.com>

	* subr.el (display-delayed-warnings): Doc fix.
	(collapse-delayed-warnings): New function to collapse identical
	adjacent warnings.
	(delayed-warnings-hook): Add it.

2012-01-22  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-action-login): Set connection property "login-as".

	* net/tramp-sh.el (tramp-methods): Add user spec to "pscp" and "psftp".
	(tramp-default-user-alist): Don't add "pscp".
	(tramp-do-copy-or-rename-file-out-of-band): Use connection
	property "login-as", if set.  (Bug#10530)

2012-01-21  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-sh.el (tramp-default-user-alist): Don't add "plink",
	"plink1" and "psftp".  (Bug#10530)

2012-01-21  Kenichi Handa  <handa@m17n.org>

	* international/mule-cmds.el (prefer-coding-system): Show a
	warning message if the default value of file-name-coding-system
	was not changed.

2012-01-21  Jérémy Compostella  <jeremy.compostella@gmail.com>

	* windmove.el (windmove-reference-loc):
	Fix windmove-reference-loc miscalculation.

2012-01-21  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-units.el (math-put-default-units): Don't use "1" as a
	default unit.

2012-01-21  Glenn Morris  <rgm@gnu.org>

	* international/mule.el (auto-coding-alist): Add .tbz.

	* files.el (local-enable-local-variables): Doc fix.
	(inhibit-local-variables-regexps): Rename from
	inhibit-first-line-modes-regexps.  Keep old name as obsolete alias.
	Doc fix.  Add some extensions from auto-coding-alist.
	(inhibit-local-variables-suffixes):
	Rename from inhibit-first-line-modes-suffixes.  Doc fix.
	(inhibit-local-variables-p):
	New function, extracted from set-auto-mode-1.
	(set-auto-mode): Doc fix.  Respect inhibit-local-variables-regexps.
	(set-auto-mode-1): Doc fix.  Use inhibit-local-variables-p.
	(hack-local-variables): Doc fix.  Make the mode-only case
	respect enable-local-variables and friends.
	Respect inhibit-local-variables-regexps for file-locals, but
	not for directory-locals.
	(set-visited-file-name):
	Take account of inhibit-local-variables-regexps.
	Whether it applies may change as the file name is changed.
	* jka-cmpr-hook.el (jka-compr-install):
	* jka-compr.el (jka-compr-uninstall):
	Update for inhibit-first-line-modes-suffixes name change.

2012-01-20  Martin Rudalics  <rudalics@gmx.at>

	* help-macro.el (make-help-screen): Temporarily restore original
	binding for minor-mode-map-alist (Bug#10454).

2012-01-19  Julien Danjou  <julien@danjou.info>

	* color.el (color-name-to-rgb): Use the white color to find the max
	color component value and return correctly computed values.
	(color-name-to-rgb): Add missing float conversion for max value.

2012-01-19  Martin Rudalics  <rudalics@gmx.at>

	* window.el (window--state-get-1, window-state-get): Do not use
	special state value for window-persistent-parameters.
	Rename argument IGNORE to WRITABLE.  Rewrite doc-string.
	(window--state-put-2): Reset all window parameters to nil before
	assigning values of persistent parameters.

2012-01-18  Alan Mackenzie  <acm@muc.de>

	Eliminate sluggishness and hangs in fontification of "semicolon
	deserts".

	* progmodes/cc-engine.el (c-state-nonlit-pos-interval):
	Change value 10000 -> 3000.
	(c-state-safe-place): Reformulate so it doesn't stack up an
	infinite number of wrong entries in c-state-nonlit-pos-cache.
	(c-determine-limit-get-base, c-determine-limit): New functions to
	determine backward search limits disregarding literals.
	(c-find-decl-spots): Amend commenting.
	(c-cheap-inside-bracelist-p): New function which detects "={".

	* progmodes/cc-fonts.el
	(c-make-font-lock-BO-decl-search-function): Give a limit to a
	backward search.
	(c-font-lock-declarations): Fix an occurrence of point being
	undefined.  Check additionally for point being in a bracelist or
	near a macro invocation without a semicolon so as to avoid a
	fruitless time consuming search for a declarator.  Give a more
	precise search limit for declarators using the new
	c-determine-limit.

2012-01-18  Glenn Morris  <rgm@gnu.org>

	* files.el (auto-mode-alist, inhibit-first-line-modes-regexps)
	(set-auto-mode): Doc fixes.

2012-01-17  Glenn Morris  <rgm@gnu.org>

	* isearch.el (search-nonincremental-instead): Fix doc typo.

	* dired.el (dired-insert-directory): Handle newlines in directory name.
	(dired-build-subdir-alist): Unescape newlines in directory name.

2012-01-17  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-local-end-of-line): New defcustom.
	(tramp-action-login, tramp-action-yesno, tramp-action-yn)
	(tramp-action-terminal): Use it.  (Bug#10530)

2012-01-16  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuffer.el (completion--replace): Strip properties (bug#10062).

2012-01-16  Martin Rudalics  <rudalics@gmx.at>

	* window.el (window-state-ignored-parameters): Remove variable.
	(window--state-get-1): Rename argument MARKERS to IGNORE.
	Handle persistent window parameters.  Make copy of clone-of
	parameter only if requested.  (Bug#10348)
	(window--state-put-2): Install a window parameter only if it has
	a non-nil value or an existing parameter shall be overwritten.

2012-01-15  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-sh.el (tramp-remote-path): Set tramp-autoload cookie.

2012-01-14  Eli Zaretskii  <eliz@gnu.org>

	* info.el (Info-toc-build): If the Info file has no "Up" pointer,
	don't pass the (nil) value of `upnode' to string-match.

2012-01-14  Chong Yidong  <cyd@gnu.org>

	* startup.el (command-line): Fix X resource class for cursorColor.
	Fix values recognized by the cursorBlink resource.

2012-01-14  Paul Eggert  <eggert@cs.ucla.edu>

	* epg.el (epg--make-temp-file): Avoid permission race condition
	when running on old Emacs versions (bug#10403).

2012-01-14  Glenn Morris  <rgm@gnu.org>

	* dired.el (dired-get-filename): Fix 'verbatim case of previous change.

2012-01-13  Alan Mackenzie  <acm@muc.de>

	Fix filling for when filladapt mode is enabled.

	* progmodes/cc-cmds.el (c-fill-paragraph): In the invocation of
	c-mask-paragraph, pass in `fill-paragraph' rather than
	`fill-region-as-paragraph'.  (This is a reversion of a previous
	change.)
	* progmodes/cc-mode.el (c-basic-common-init):
	Make fill-paragraph-handle-comment buffer local and set it to nil.

2012-01-13  Glenn Morris  <rgm@gnu.org>

	* dired.el (dired-switches-escape-p): New function.
	(dired-insert-directory): Use dired-switches-escape-p.
	(dired-get-filename): Undo "\ " quoting if needed.  (Bug#10469)

	* find-dired.el (find-ls-option): Doc fix.  (Bug#10262)

2012-01-12  Glenn Morris  <rgm@gnu.org>

	* mail/sendmail.el (mail-mode): Update paragraph-separate for
	changes in adaptive-fill-regexp.  (Bug#10276)

2012-01-11  Alan Mackenzie  <acm@muc.de>

	Fix Emacs bug #10463 - put `widen's around the critical spots.

	* progmodes/cc-engine.el (c-in-literal, c-literal-limits): Put a
	widen around each invocation of c-state-pp-to-literal.  Remove an
	unused let variable.

2012-01-11  Glenn Morris  <rgm@gnu.org>

	* dired-aux.el (dired-do-shell-command): Fix */? logic.  (Bug#6561)
	Doc fix.

2012-01-10  Chong Yidong  <cyd@gnu.org>

	* net/network-stream.el (network-stream-open-starttls):
	Avoid emitting a confusing error message when the server gives a bad
	response to the capability command.

2012-01-10  Glenn Morris  <rgm@gnu.org>

	* mail/unrmail.el (unrmail): Tweak previous change.

2012-01-09  Chong Yidong  <cyd@gnu.org>

	* custom.el (custom-safe-themes): Use SHA-256 for hashing.

2012-01-08  Alan Mackenzie  <acm@muc.de>

	Optimize font locking in long enum definitions.

	* progmodes/cc-fonts.el (c-font-lock-declarations): Add an extra
	arm to a cond form to handle enums.
	* progmodes/cc-langs.el (c-enums-contain-decls): New lang variable.
	* progmodes/cc-mode.el (c-font-lock-fontify-region): Correct a typo.

2012-01-07  Paul Eggert  <eggert@cs.ucla.edu>

	* files.el (move-file-to-trash): Preserve default file modes on error.
	(Bug#10401)

2012-01-07  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* faces.el (set-face-attribute): Clarify the meaning of the nil
	frame (bug#10294).

	* subr.el (with-selected-frame): Mention that the selected frame
	is restored (bug#9980).

	* ibuffer.el (ibuffer-mode): List the bindings in the corrent map
	(bug#9759).

	* mail/smtpmail.el (password-cache-add): Remove unused declaration.
	(password-read): Don't autoload unused function.

2012-01-07  Juanma Barranquero  <lekktu@gmail.com>

	* progmodes/which-func.el (which-func-mode): Turn into a
	non-interactive function and mark as obsolete (bug#10428).

2012-01-06  Chong Yidong  <cyd@gnu.org>

	* files.el (hack-dir-local-variables-non-file-buffer): Add doc.
	(hack-one-local-variable-eval-safep): Allow 0 arg for minor mode
	functions, along with 1 and -1.

2012-01-06  Eli Zaretskii  <eliz@gnu.org>

	* time.el (display-time-load-average)
	(display-time-default-load-average): Doc fixes.  See the thread
	starting at
	https://lists.gnu.org/r/help-gnu-emacs/2012-01/msg00059.html
	for the details.

2012-01-06  Glenn Morris  <rgm@gnu.org>

	* mail/unrmail.el (unrmail): Give an explicit error if the input file
	has no messages.  (Bug#10377)

	* info.el (Info-mode-map): Bind e to end-of-buffer, rather
	than Info-edit.  (Bug#10385)

	* time.el (display-time-load-average, display-time-next-load-average):
	Doc fixes.

	* emacs-lisp/bytecomp.el (byte-compile-file): Do not propagate a file
	local setting of buffer-read-only to the input buffer.  (Bug#10419)

	* calendar/calendar.el (calendar-mode):
	Locally set scroll-margin to 0.  (Bug#10379)

2012-01-06  Ulrich Mueller  <ulm@gentoo.org>

	* play/doctor.el (doctor-death): Escape "," characters.  (Bug#10370)

2012-01-05  Glenn Morris  <rgm@gnu.org>

	* eshell/em-unix.el (diff-no-select): Autoload it.
	(eshell/diff): Use diff-no-select.  (Bug#10420)

2012-01-05  Chong Yidong  <cyd@gnu.org>

	* shell.el (shell-dynamic-complete-functions): Revert last change.
	(shell-command-completion-function): New function.
	(shell-completion-vars): Use it to implement
	shell-completion-execonly (Bug#10417).

	* custom.el (enable-theme): Don't set custom-safe-themes.

	* cus-theme.el (custom-theme-merge-theme):
	Ignore custom-enabled-themes and custom-safe-themes.

2012-01-05  Michael R. Mauger  <mmaug@yahoo.com>

	* progmodes/sql.el (sql-login-hook): Add hook to respond to the
	first prompt in `sql-interacive-mode'.
	(sql-mode-oracle-font-lock-keywords): Add CONNECT_BY_* builtin
	keywords.
	(sql-mode-mysql-font-lock-keywords): Add ELSEIF keyword.
	(sql-product-interactive): Bug fix: Set `sql-buffer' in
	context of original buffer.  Invoke `sql-login-hook'.

2012-01-04  Eli Zaretskii  <eliz@gnu.org>

	* mail/rmail.el (rmail-font-lock-keywords): Accept non-ASCII
	letters in cite-prefix.

2012-01-03  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* mail/smtpmail.el (smtpmail-stream-type): Mention the `ssl' value.

2012-01-03  Chong Yidong  <cyd@gnu.org>

	* shell.el (shell-dynamic-complete-functions):
	Put pcomplete-completions-at-point, so as to try
	comint-filename-completion first (Bug#10417).

2012-01-02  Richard Stallman  <rms@gnu.org>

	* battery.el (battery-status-function):
	Detect when to use battery-yeeloong-sysfs.
	(battery-echo-area-format): Add string for Yeeloong.
	(battery-linux-proc-apm, battery-linux-proc-acpi): Doc fixes.
	(battery-yeeloong-sysfs): New function.

2012-01-02  Chong Yidong  <cyd@gnu.org>

	* dirtrack.el (dirtrack-list): Eliminate unused third element.
	(dirtrack): Merge code for handling relative filenames in prompt
	from shell-dir-cookie-watcher.
	(dirtrack-debug-message): New arg to avoid excess format calls.

	* shell.el (shell-dir-cookie-re): Variable deleted.
	(shell-dir-cookie-watcher): Function deleted.
	(shell-mode): Don't use shell-dir-cookie-re, since it is redundant
	with dirtrack-mode.

2012-01-01  Eli Zaretskii  <eliz@gnu.org>

	* term/w32-win.el (dynamic-library-alist) <gnutls>:
	Load libgnutls-28.dll, from GnuTLS version 3.x, in preference to
	libgnutls-26.dll.

2011-12-31  Andreas Schwab  <schwab@linux-m68k.org>

	* emacs-lisp/bytecomp.el (byte-compile-file): Fix indentation.

2011-12-31  Eli Zaretskii  <eliz@gnu.org>

	* mail/rmail.el (rmail-show-message-1): Decode any RFC2047 encoded
	headers of non-MIME messages, when rmail-enable-mime is non-nil.

2011-12-29  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-sh.el (tramp-find-shell): Set "remote-shell" property
	also for alternative shells.
	(tramp-open-connection-setup-interactive-shell): Check, whether
	the shell is a busybox.
	(tramp-send-command): Don't suppress multiple prompts for
	busyboxes, it hurts.

2011-12-28  Chong Yidong  <cyd@gnu.org>

	* progmodes/gdb-mi.el (gdb-get-source-file-list)
	(gdb-get-source-file): Move mode line update to
	gdb-get-source-file (Bug#10087).

2011-12-25  Chong Yidong  <cyd@gnu.org>

	* progmodes/gud.el (gud-gdb-fetch-lines-filter): Just use
	gud-gdb-marker-filter without taking it as an argument.
	(gud-gdb-run-command-fetch-lines): Caller changed.
	(gud-gdb-completion-function): New variable.
	(gud-gdb-completion-at-point): Use it.
	(gud-gdb-completions-1): Split from gud-gdb-completions.

	* progmodes/gdb-mi.el (gdb-input): Accept command and handler
	function as separate arguments.
	(gdb-init-1, gdb-non-stop-handler, gdb-check-target-async)
	(gdb-tooltip-print-1, gud-watch, gdb-speedbar-update)
	(gdb-var-list-children, gdb-var-set-format, gdb-var-delete-1)
	(gdb-var-delete-children, gdb-edit-value, gdb-var-update)
	(gdb-stopped, def-gdb-auto-update-trigger)
	(gdb-place-breakpoints, gdb-select-thread, gdb-select-frame)
	(gdb-get-changed-registers, gdb-get-main-selected-frame):
	Callers changed.
	(gud-gdbmi-completions): New function.
	(gdb): Use it for generating the completion table.

2011-12-24  Alan Mackenzie  <acm@muc.de>

	Introduce a mechanism to widen the region used in context font
	locking.  Use this to protect declarations from losing their contexts.

	* progmodes/cc-langs.el (c-before-font-lock-functions):
	Replace c-set-fl-decl-start with c-change-set-fl-decl-start (Renaming).
	(c-before-context-fontification-functions): New defvar, a list of
	functions to be run just before context (etc.) font locking.

	* progmodes/cc-mode.el (c-extend-font-lock-region-for-macros):
	New, functionality extracted from
	c-neutralize-syntax-in-and-mark-CPP.
	(c-in-after-change-fontification): New variable.
	(c-after-change): Set c-in-after-change-fontification.
	(c-set-fl-decl-start): Rejig its interface, so it can be called
	from both after-change and context fontifying.
	(c-change-set-fl-decl-start, c-context-set-fl-decl-start):
	New functions.
	(c-standard-font-lock-fontify-region-function): New variable.
	(c-font-lock-fontify-region): New function.

2011-12-24  Juri Linkov  <juri@jurta.org>

	* window.el (window--state-get-1): Set `FORCE' arg of `mark' to t.
	(Bug#10348)

2011-12-23  Michael Albinus  <michael.albinus@gmx.de>

	* net/ange-ftp.el (ange-ftp-copy-file-internal): Check for
	existence of source file.  (Bug#10325)

2011-12-23  Alan Mackenzie  <acm@muc.de>

	Fix unstable fontification inside templates.

	* progmodes/cc-langs.el (c-before-font-lock-functions):
	Newly created from the singular version.  The (c c++ objc) entry now
	additionally has c-set-fl-decl-start.  The other languages (apart
	from AWK) have that as a single entry.

	* progmodes/cc-fonts.el (c-font-lock-enclosing-decls):
	The functionality for "local" declarations has been extracted to
	c-set-fl-decl-start.

	* progmodes/cc-mode.el (c-common-init, c-after-change):
	Changes due to pluralization of c-before-font-lock-functions.
	(c-set-fl-decl-start): New function, extracted from
	c-font-lock-enclosing-decls and enhanced.

2011-12-23  Juanma Barranquero  <lekktu@gmail.com>

	* desktop.el (desktop-internal-v2s): Fix typos in docstring (bug#10353).

2011-12-22  Juri Linkov  <juri@jurta.org>

	* progmodes/grep.el (rgrep): Fix docstring.  (Bug#10185)

2011-12-22  Chong Yidong  <cyd@gnu.org>

	* vc/vc-hooks.el (vc-keep-workfiles): Doc fix.

2011-12-21  Drew Adams  <drew.adams@oracle.com>

	* files.el (file-remote-p): Fix docstring.  (Bug#10319)

2011-12-21  Jérémy Compostella  <jeremy.compostella@gmail.com>

	* battery.el (battery-linux-sysfs): Add missing parameters from acpi.

2011-12-21  Teodor Zlatanov  <tzz@lifelogs.com>

	* progmodes/cfengine.el: Add Version.  Improve CFEngine 3.x syntax
	highlighting and support.  Fix up comments for capitalization.
	(cfengine-mode-debug): New var.
	(cfengine3-mode): Change the modeline indicator to "CFE3".
	(cfengine3-font-lock-keywords): Improve defun highlighting.
	(cfengine2-actions): Rename from `cfengine-actions'.
	(cfengine2-font-lock-keywords): Rename from
	`cfengine-font-lock-keywords'.
	(cfengine2-imenu-expression): Rename from
	`cfengine-imenu-expression'.
	(cfengine2-outline-level): Rename from `cfengine-outline-level'.
	(cfengine2-beginning-of-defun): Rename from
	`cfengine-beginning-of-defun'.
	(cfengine2-end-of-defun): Rename from `cfengine-end-of-defun'.
	(cfengine2-indent-line): Rename from `cfengine-indent-line'.
	(cfengine2-mode): Rename from `cfengine-mode'.  Change the
	modeline indicator to "CFE2".
	(cfengine-mode): Defalias to `cfengine-auto-mode'.
	(cfengine-mode-abbrevs): Mark obsolete.

2011-12-21  Chong Yidong  <cyd@gnu.org>

	* vc/vc-bzr.el (vc-bzr-rename-file): Don't pass ~ to Bzr in
	filename argument.

2011-12-20  Martin Rudalics  <rudalics@gmx.at>

	* window.el (window-normalize-buffer-to-display): Remove.
	(display-buffer): Handle buffer-or-name argument as in Emacs 23.

2011-12-19  Chong Yidong  <cyd@gnu.org>

	* vc/vc-dir.el (vc-dir-parent-marked-p, vc-dir-children-marked-p):
	Don't signal an error in a predicate function; return non-nil.
	(vc-dir-mark-file): Move the error here.
	(vc-dir-mark-unmark): If acting on the region, keep going if one
	of the entries cannot be marked/unmarked.
	(vc-dir-mark-all-files): If current entry is a directory, mark
	only child files, as documented.

2011-12-19  Vincent Belaïche  <vincentb1@users.sourceforge.net>

	* ses.el: Ooops... undo changes of 2011-12-11T14:49:48Z!vincentb1@users.sourceforge.net, as trunk
	branch is feature frozen, and 2011-12-11T14:49:48Z!vincentb1@users.sourceforge.net was a feature
	addition.

2011-12-18  Jan Djärv  <jan.h.d@swipnet.se>

	* term/ns-win.el (ns-get-selection-internal)
	(ns-store-selection-internal): Declare.
	(ns-store-cut-buffer-internal, ns-get-cut-buffer-internal):
	Declare as obsolete.
	(ns-get-pasteboard, ns-paste-secondary):
	Use ns-get-selection-internal.
	(ns-set-pasteboard, ns-copy-including-secondary):
	Use ns-store-selection-internal.

2011-12-17  Chong Yidong  <cyd@gnu.org>

	* vc/vc.el (vc-next-action): Doc fix; remove CVS-isms.
	(vc-deduce-fileset): Doc fix.

2011-12-16  Andreas Schwab  <schwab@linux-m68k.org>

	* calc/calc-misc.el (calc-help): Avoid wrapping help message.

2011-12-13  Sam Steingold  <sds@gnu.org>

	* man.el (Man-getpage-in-background): When running under a
	window-system, ignore $MANWIDTH and $COLUMNS.

2011-12-15  Kenichi Handa  <handa@m17n.org>

	* language/ethio-util.el: Change coding tag to utf-8-emacs.
	(setup-ethiopic-environment-internal): Comment out key-binding for
	ethio-toggle-punctuation.

2011-12-13  Alan Mackenzie  <acm@muc.de>

	Add the switch statement to AWK Mode.

	* progmodes/cc-awk.el (awk-font-lock-keywords): Add "switch", "case",
	"default" to the keywords regexp.

	* progmodes/cc-langs.el (c-label-kwds): Let AWK take the same
	expression as the rest.
	(c-nonlabel-token-key): Allow string literals for AWK.
	Refactor for the other modes.

	Large brace-block initialization makes CC Mode slow: Fix.
	Tidy up and accelerate c-in-literal, etc. by using the c-parse-state
	routines.  Limit backward searching in c-font-lock-enclosing.decl.

	* progmodes/cc-engine.el (c-state-pp-to-literal): Return the
	pp-state and literal type in addition to the limits.
	(c-state-safe-place): New defun, extracted from c-state-literal-at.
	(c-state-literal-at): Use the above new defun.
	(c-slow-in-literal, c-fast-in-literal): Remove.
	(c-in-literal, c-literal-limits): Amend to use c-state-pp-to-literal.

	* progmodes/cc-fonts.el (c-font-lock-enclosing-decls): Check for
	being in a literal.  Add a limit for backward searching.

	* progmodes/cc-mode.el (awk-mode): Don't alias c-in-literal to
	c-slow-in-literal.

2011-12-13  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/pascal.el: Declare `ind' as dyn-bound (bug#10264).

2011-12-13  Martin Rudalics  <rudalics@gmx.at>

	* window.el (delete-other-windows): Use correct frame in call to
	window-with-parameter.

2011-12-12  Daniel Pfeiffer  <occitan@t-online.de>

	* progmodes/make-mode.el: Bring it up to date with makepp V2.0.
	(makefile-make-font-lock-keywords): Extend meaning of `keywords'.
	(makefile-gmake-statements, makefile-makepp-statements):
	Use it and add new makepp keywords.
	(makefile-makepp-font-lock-keywords): Add new patterns.
	(makefile-match-function-end): Match new [...] and [[...]].

2011-12-11  Juanma Barranquero  <lekktu@gmail.com>

	* ses.el (ses-call-printer-return, ses-cell-property-get)
	(ses-sym-rowcol, ses-printer-validate, ses-formula-record)
	(ses-create-cell-variable, ses-reset-header-string)
	(ses-cell-set-formula, ses-repair-cell-reference-all)
	(ses-self-reference-early-detection, ses-in-print-area, ses-set-curcell)
	(ses-check-curcell, ses-call-printer, ses-adjust-print-width)
	(ses-print-cell-new-width, ses-formula-references, ses-relocate-formula)
	(ses-aset-with-undo, ses-load, ses-truncate-cell)
	(ses-read-column-printer, ses-read-default-printer, ses-insert-row)
	(ses-delete-row, ses-delete-column, ses-append-row-jump-first-column)
	(ses-kill-override, ses-yank-pop, ses-yank-cells, ses-yank-tsf)
	(ses-yank-resize, ses-export-tab, ses-mark-row, ses-mark-column)
	(ses-renarrow-buffer, ses-insert-range, ses-insert-ses-range)
	(ses-safe-printer, ses-safe-formula, ses-warn-unsafe, ses--clean-!)
	(ses--clean-_, ses-range, ses-select, ses-center, ses-center-span)
	(ses-dashfill, ses-unsafe): Fix typos and reflow docstrings.

2011-12-11  Vincent Belaïche  <vincentb1@users.sourceforge.net>

	* ses.el: The overall change is to add cell renaming, that is
	setting fancy names for cell symbols other than name matching
	"\\`[A-Z]+[0-9]+\\'" regexp .
	(ses-create-cell-variable): New defun.
	(ses-relocate-formula): Relocate formulas only for cells the
	symbols of which are not renamed, i.e. symbols whose names do not
	match regexp "\\`[A-Z]+[0-9]+\\'".
	(ses-relocate-all): Relocate values only for cells the symbols of
	which are not renamed.
	(ses-load): Create cells variables as the (ses-cell ...) are read,
	in order to check row col consistency with cell symbol name only
	for cells that are not renamed.
	(ses-replace-name-in-formula): New defun.
	(ses-rename-cell): New defun.

2011-12-11  Chong Yidong  <cyd@gnu.org>

	* progmodes/gdb-mi.el (gdb): Set comint-prompt-regexp, required
	for completion via gud-gdb-fetch-lines-filter (Bug#10274).

2011-12-11  Eric Hanchrow  <eric.hanchrow@gmail.com>

	* window.el (other-window): Fix docstring.

2011-12-10  Eli Zaretskii  <eliz@gnu.org>

	* mail/rmailsum.el (rmail-header-summary): RFC2047 decode the
	`from' or `to' address before taking its substring.
	Fixes incorrect display in Rmail summary buffer whereby an RFC2047
	encoded name is chopped in the middle of the encoded string, and
	thus displayed encoded.

2011-12-10  Juanma Barranquero  <lekktu@gmail.com>

	* makefile.w32-in (update-subdirs-CMD): Use a Local Variables section.

2011-12-10  Eli Zaretskii  <eliz@gnu.org>

	* textmodes/texnfo-upd.el: Update commentary.  Add a warning not
	to use texinfo-update-node and commands that call it if the
	Texinfo file uses @node lines without next/prev/up pointers.
	Correct outdated description about texinfo-master-menu.
	(texinfo-all-menus-update, texinfo-master-menu)
	(texinfo-update-node, texinfo-every-node-update)
	(texinfo-multiple-files-update): Doc fix.  Warn against updating
	all the @node lines.
	(texinfo-master-menu): Only call texinfo-update-node if the prefix
	argument is numeric.  Explain better in the doc string what the
	function really does.
	(texinfo-insert-master-menu-list): Improve the error message
	displayed if there's no menu in the Top node.
	(Bug#2975)  See also this thread:
	https://lists.gnu.org/r/emacs-devel/2011-12/msg00156.html.

2011-12-09  Manuel Gómez  <mgrojo@gmail.com>  (tiny change)

	* speedbar.el (speedbar-supported-extension-expressions):
	Add .adb and .ads, commonly used for Ada source code (bug#10256).

2011-12-09  Juanma Barranquero  <lekktu@gmail.com>

	* printing.el (pr-mode-alist):
	* simple.el (filter-buffer-substring-functions)
	(completion-list-insert-choice-function):
	* window.el (window-with-parameter, window-atom-root)
	(window-sides-slots, window-size-fixed, window-min-delta)
	(window-max-delta, window--resize-mini-window)
	(window--resize-child-windows-normal, window-tree)
	(delete-other-windows, quit-window, split-window)
	(display-buffer-record-window, special-display-buffer-names)
	(special-display-regexps, special-display-popup-frame)
	(same-window-p, split-window-sensibly)
	(display-buffer-overriding-action, display-buffer-alist)
	(display-buffer-base-action, display-buffer, switch-to-buffer)
	(switch-to-buffer-other-window, switch-to-buffer-other-frame)
	(fit-window-to-buffer, recenter-positions)
	(mouse-autoselect-window-state, mouse-autoselect-window-select):
	* emacs-lisp/syntax.el (syntax-propertize-function): Fix typos
	and remove unneeded backslashes in docstrings.

2011-12-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/lisp-mode.el (defmethod): Add doc-string-elt (bug#10244).

	* pcmpl-gnu.el: Don't fail when there is no Makefile nor -f arg.
	(pcmpl-gnu-makefile-regexps): Accept "makefile" as well as files that
	end in ".mk".
	(pcmpl-gnu-make-rule-names): Check "makefile" and ignore errors
	when reading the makefile (bug#10116).

2011-12-06  Stefan Monnier  <monnier@iro.umontreal.ca>

	* pcmpl-gnu.el (pcomplete/make): Also allow filename arguments
	(bug#10116).

2011-12-06  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/package.el (package-archives): Doc fix re riskiness.

2011-12-06  Chong Yidong  <cyd@gnu.org>

	* progmodes/cc-fonts.el (c-annotation-face): Use defface.

2011-12-06  Juanma Barranquero  <lekktu@gmail.com>

	* textmodes/table.el (table-shorten-cell): Fix typo.

2011-12-05  Christopher Genovese  <genovese.cr@gmail.com>  (tiny change)

	* emacs-lisp/assoc.el (aput): Fix return value (bug#10146)

2011-12-05  Eli Zaretskii  <eliz@gnu.org>

	* descr-text.el (describe-char): Fix display of strong
	right-to-left characters and directional embeddings and overrides.

	* simple.el (what-cursor-position): Fix display of codepoints of
	strong right-to-left characters.

2011-12-05  Chong Yidong  <cyd@gnu.org>

	* faces.el (read-color): Doc fix.

2011-12-05  Glenn Morris  <rgm@gnu.org>

	* align.el (align--set-marker): Add doc-string.
	Don't try to move something that is not a marker.  (Bug#10216)

2011-12-04  Glenn Morris  <rgm@gnu.org>

	* calendar/appt.el (appt-add): Rewrite the interactive-spec to avoid
	overly zealous deletion of trailing whitespace.

2011-12-04  Juanma Barranquero  <lekktu@gmail.com>

	* server.el (server-delete-client): On Windows, do not try to delete
	the only terminal.
	(server-process-filter): On Windows, treat requests for a tty frame as
	if they were for a GUI frame if the running server is in GUI mode.

2011-12-03  Glenn Morris  <rgm@gnu.org>

	* textmodes/texinfmt.el (batch-texinfo-format): Doc fix.  (Bug#10207)

2011-12-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	* electric.el: Streamline electric-indent's hook.
	(electric-indent-chars): Revert to simple list.
	(electric-indent-functions): New var.
	(electric-indent-post-self-insert-function): Use it.

	* progmodes/prolog.el (prolog-find-value-by-system): Avoid error when
	there's no inferior buffer (bug#10196).
	(prolog-consult-compile): Don't use toggle-read-only.

2011-12-02  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-sh.el (tramp-maybe-open-connection): Handle user
	interrupt.  (Bug#10187)

2011-12-02  Stefan Monnier  <monnier@iro.umontreal.ca>

	* pcmpl-gnu.el (pcomplete/tar): large-file-warn-threshold can be nil
	(bug#9160).

	* dired-aux.el (dired-query): Don't assume help-char is modifier-free
	(bug#10191).

2011-12-02  Juri Linkov  <juri@jurta.org>

	* info.el (Info-search): Display "end of manual" when Isearch
	reaches the end of single-file Info manual.  (Bug#9918)

2011-12-02  Eli Zaretskii  <eliz@gnu.org>

	* isearch.el (isearch-message-prefix): Run the input method part
	of the prompt through bidi-string-mark-left-to-right.  (Bug#10183)

2011-12-02  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-occur): Use `word-search-regexp' for
	`isearch-word'.
	(isearch-search-and-update): Add condition for `isearch-word' and
	call `word-search-regexp'.  (Bug#10145)

2011-12-01  Glenn Morris  <rgm@gnu.org>

	* eshell/em-hist.el (eshell-hist-initialize):
	Handle eshell-history-size nil and HISTSIZE set or unset.
	(eshell-history-file-name, eshell-history-size): Fix custom type.

2011-12-01  Stefan Monnier  <monnier@iro.umontreal.ca>

	* man.el (Man-completion-table): Fix the lambda case (bug#10168).

2011-12-01  Michael McNamara  <mac@mail.brushroad.com>

	* progmodes/verilog-mode.el (verilog-pretty-expr):
	Rework verilog-pretty-expr to handle new assignment operators in system
	verilog, such as += *= and the like.
	(verilog-assignment-operator-re): Regular expression to find the
	assigment operator in a verilog assignment.
	(verilog-assignment-operation-re): Regular expression to find an
	assignment statement for pretty-expr.
	(verilog-in-attribute-p): Query returns true if point is in an
	attribute context; used to skip these for expression line up from
	pretty-expr.
	(verilog-in-parameter-p): Query returns true if point is in an
	parameter definition context; used to skip these for expression
	line up from pretty-expr.
	(verilog-in-parenthesis-p): Query returns true if point is in a
	parenthetical expression, specifically ( ) but not [ ] or { };
	used by pretty-expr.
	(verilog-just-one-space): If there is no space, don't add one.
	(verilog-get-lineup-indent-2): Specifically skip just attribute
	contexts for expression lineup, rather than skipping all
	parenthetical expressions.
	(verilog-calculate-indent): Fix comment, and fix indent.
	(verilog-do-indent): Indent declarations in lists (suggested by
	Joachim Lechner).
	(verilog-mode-abbrev-table): Populate abbrev mode with the various
	skeleton items.
	(verilog-sk-ovm-class): Add skeleton for OVM classes (reported
	by Alain Mellan).

2011-12-01  Wilson Snyder  <wsnyder@wsnyder.org>

	* progmodes/verilog-mode.el (verilog-read-defines): Fix reading
	parameters with embedded comments.  Reported by Ray Stevens.
	(verilog-calc-1, verilog-fork-wait-re, verilog-forward-sexp)
	(verilog-wait-fork-re): Fix indentation of "wait fork", bug407.
	Reported by Tim Holt.
	(verilog-auto): Fix AUTOing a upper module then AUTOing module
	instantiated by upper module causing wrong expansion until AUTOed a
	second time.  Reported by K C Buckenmaier.
	(verilog-diff-auto): Fix showing .* as a difference when
	`verilog-auto-star-save' off.  Reported by Dan Dever.
	(verilog-auto-reset, verilog-read-always-signals)
	(verilog-auto-reset-blocking-in-non): Fix AUTORESET including
	temporary signals in reset list if
	verilog-auto-reset-blocking-in-non is nil, and match assignment
	style to each signal's assignment type, bug381.
	Reported by Thomas Esposito.
	(verilog-sk-uvm-class, verilog-uvm-begin-re, verilog-uvm-end-re)
	(verilog-uvm-statement-re): Support UVM indentation and
	highlighting, with old OVM keywords only.
	(verilog-auto-tieoff, verilog-auto-tieoff-declaration):
	Support AUTOTIEOFF creating non-wire data types.
	Suggested by Jonathan Greenlaw.
	(verilog-auto-insert-lisp, verilog-delete-to-paren)
	(verilog-forward-sexp-cmt, verilog-forward-sexp-ign-cmt)
	(verilog-inject-sense, verilog-read-inst-pins)
	(verilog-read-sub-decls, verilog-read-sub-decls-line):
	Fix mismatching parenthesis inside commented out code when deleting
	AUTOINST, bug383.  Reported by Jonathan Greenlaw.
	(verilog-auto-ascii-enum): Fix AUTOASCIIENUM one-hot with
	non-numeric vector width.  Reported by Alex Reed.
	(verilog-auto-ascii-enum): Add "onehot" option to work around not
	detecting signals with parameter widths.  Reported by Alex Reed.
	(verilog-auto-delete-trailing-whitespace):
	With `verilog-auto-delete-trailing-whitespace' remove trailing
	whitespace in auto expansion, bug371.  Reported by Brad Dobbie.
	(verilog-run-hooks, verilog-scan-cache-flush, verilog-syntax-ppss):
	Fix verilog-scan-cache corruption when running user AUTO expansion
	hooks that call indentation routines.
	(verilog-simplify-range-expression): Fix typo ignoring lower case
	identifiers.
	(verilog-delete-auto): Fix delete-autos to also remove user created
	automatics, as long as they start with AUTO.
	(verilog-batch-diff-auto, verilog-diff-auto)
	(verilog-diff-function): Add `verilog-diff-auto' and bind to
	"C-c?"  to report differences in AUTO expansion, ignoring spaces.
	(verilog-backward-syntactic-ws-quick, verilog-beg-of-defun-quick)
	(verilog-in-paren-quick, verilog-re-search-backward-quick)
	(verilog-re-search-forward-quick, verilog-syntax-ppss):
	Fix calling `syntax-ppss' when inside auto expansions as the ppss hook
	is disabled and its cache will get corrupt, causing AUTOS not to
	expand.  Instead use only -quick functions.
	(verilog-scan-region): Fix scanning over escaped quotes.
	(verilog-inside-comment-or-string-p, verilog-inside-comment-p)
	(verilog-re-search-backward-quick)
	(verilog-re-search-forward-quick, verilog-scan): verilog-scan and
	related functions now ignore strings, to fix misparsing of strings
	with magic comments embedded in them.
	(verilog-read-auto-template):
	Fix 'verilog-auto-inst-template-numbers' with extra newline before (.
	Reported by Brad Dobbie.
	(verilog-read-auto-template):
	Fix 'verilog-auto-inst-template-numbers' with comments.
	Reported by Brad Dobbie.
	(verilog-auto-inst, verilog-auto-inst-param)
	(verilog-auto-inst-sort): Add 'verilog-auto-inst-sort' to reduce
	merge conflicts with AUTOINST, bug358.  Reported by Brad Dobbie.
	(verilog-auto-inst-template-numbers): Add 'lhs' policy for
	debugging templates without merge conflicts, bug357.
	Reported by Brad Dobbie.
	(verilog-read-auto-template):
	Fix verilog-auto-inst-template-numbers with multiple templates.
	Reported by Brad Dobbie.
	(verilog-define-abbrev): Fix verilog-mode abbrevs to be system
	abbrevs so user won't be asked to save.
	(verilog-read-auto-lisp-present): Fix to start at beginning of
	buffer in case called outside of verilog-auto.
	(verilog-simplify-range-expression): Fix AUTOWIRE expanding "X-1+1"
	to "X-2".  Reported by Matthew Myers.
	(verilog-auto, verilog-auto-inout-in): Add AUTOINOUTIN for creating
	all inputs from module templates.  Reported by Leith Johnson.
	(verilog-module-inside-filename-p): Fix locating programs as with
	modules.
	(verilog-auto-inst-port): Fix vl-width expressions when using
	verilog-auto-inst-param-value, bug331.  Reported by Julian Gorfajn.
	(verilog-decls-get-regs, verilog-decls-get-signals,
	verilog-decls-get-vars, verilog-decls-get-wires, verilog-decls-new,
	verilog-modi-cache-add-vars, verilog-modi-cache-add-wires,
	verilog-read-decls): Combine reg and wire structures into one var
	structure to represent SystemVerilog concepts.
	(verilog-auto-ascii-enum, verilog-auto-logic, verilog-auto-reg)
	(verilog-auto-reg-input, verilog-auto-tieoff, verilog-auto-wire)
	(verilog-auto-wire-type, verilog-insert-definition):
	Add verilog-auto-wire-type and AUTOLOGIC to support using
	SystemVerilog "logic" keyword instead of "wire"/"reg".
	(verilog-auto-reg-input, verilog-decls-get-signals): Fix AUTOWIRE
	to declares outputs that also have assignments (presumably in an
	ifdef or generate if so there's not a driver conflict).
	Reported by Matthew Myers.
	(verilog-auto-declare-nettype, verilog-insert-definition):
	Add verilog-auto-declare-nettype to fix declarations using
	`default_nettype none.  Reported by Julian Gorfajn.
	(verilog-read-always-signals-recurse, verilog-read-decls)
	(verilog-read-sub-decls-gate): Fix infinite loop with (*) and
	malformed end statement, bug325.  Reported by Joshua Wise and
	Andrew Drake.
	(verilog-auto-star-safe, verilog-delete-auto-star-implicit)
	(verilog-inst-comment-re): Fix not deleting Interfaced comment
	when expanding .* in interfaces, bug320.
	Reported by Pierre-David Pfister.
	(verilog-read-module-name): Fix import statements between module
	name and open parenthesis, bug317.
	Reported by Pierre-David Pfister.
	(verilog-simplify-range-expression): Fix simplification of
	multiplications inside AUTOWIRE connections, bug303.
	(verilog-auto-inst-port): Support parameter expansion in
	multidimensional arrays.
	(verilog-read-decls): Fix AUTOREG etc looking for "endproperty"
	after "assert property".  Reported by Julian Gorfajn.
	(verilog-simplify-range-expression): Fix "couldn't merge" errors
	with multiplication, bug303.
	(verilog-read-decls): Fix parsing of unsigned data types, bug302.
	Reported by Jan Frode Lonnum.

2011-11-30  Juanma Barranquero  <lekktu@gmail.com>

	* htmlfontify.el (hfy-page-header, hfy-post-html-hooks)
	(hfy-shell-file-name, hfy-shell):
	* international/fontset.el (x-decompose-font-name): Fix typos.

2011-11-29  Ken Brown  <kbrown@cornell.edu>

	* progmodes/gdb-mi.el: Fix bug#9853, bug#9858, and bug#9878.
	(gdb-version): Remove defvar.
	(gdb-supports-non-stop): New defvar, replacing `gdb-version'.
	(gdb-gud-context-command, gdb-non-stop-handler)
	(gdb-current-context-command, gdb-stopped): Use it.
	(gdb-init-1): Enable pretty printing here.
	(gdb-non-stop-handler): Don't enable pretty-printing here.
	Check to see if the target supports non-stop mode; if not, turn off
	non-stop mode.  Use the following.
	(gdb-check-target-async): New defun.
	(gud-watch, gdb-stopped): Fix whitespace.
	(gdb-get-source-file): Don't try to display the source file if
	`gdb-main-file' is nil.

2011-11-29  Stefan Monnier  <monnier@iro.umontreal.ca>

	* align.el: Try to generate fewer markers (bug#10047).
	(align--set-marker): New macro.
	(align-region): Use it.

2011-11-29  Stefan Monnier  <monnier@iro.umontreal.ca>

	* isearch.el (isearch-yank-x-selection): Deactivate mark (bug#10022).

2011-11-29  Chong Yidong  <cyd@gnu.org>

	* indent.el (indent-for-tab-command, indent-according-to-mode):
	Doc fix.
	(indent-region): Doc fix.  Switch nested ifs to equivalent cond.

2011-11-29  Michael Albinus  <michael.albinus@gmx.de>

	* vc/diff-mode.el (diff-find-file-name): Make `read-file-name'
	aware of remote file names.  (Bug#10124)

2011-11-29  Chong Yidong  <cyd@gnu.org>

	* frame.el (auto-raise-mode, auto-lower-mode): Doc fix.

2011-11-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* files.el (find-file): Don't use force-same-window (bug#10144).
	* window.el (switch-to-buffer): Better match Emacs-23 behavior and only
	use pop-to-buffer if the selected window can't be used.
	(pop-to-buffer-same-window): Use display-buffer--same-window-action.

2011-11-28  Eli Zaretskii  <eliz@gnu.org>

	* vc/diff-mode.el (diff-mode-map): Don't inherit 'z' => 'M-z' from
	special-mode-map.

2011-11-28  Chong Yidong  <cyd@gnu.org>

	* emacs-lisp/easy-mmode.el (define-minor-mode): Fix default doc.

2011-11-27  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-mi.el (gdb-init-1): Condition execution of
	  gdb-get-source-file-list on gdb-create-source-file-list.

2011-11-26  Eli Zaretskii  <eliz@gnu.org>

	* whitespace.el (whitespace-newline): Use a different foreground
	color for 16-color light-background displays.

2011-11-24  Chong Yidong  <cyd@gnu.org>

	* window.el (display-buffer--special-action): Doc fix.

2011-11-25  Juanma Barranquero  <lekktu@gmail.com>

	* emacs-lisp/avl-tree.el (avl-tree--do-copy, avl-tree-create)
	(avl-tree-compare-function, avl-tree-empty, avl-tree-enter)
	(avl-tree-delete, avl-tree-member, avl-tree-member-p, avl-tree-map)
	(avl-tree-mapc, avl-tree-mapf, avl-tree-mapcar, avl-tree-copy)
	(avl-tree-clear, avl-tree-stack, avl-tree-stack-pop)
	(avl-tree-stack-first):
	* emacs-lisp/cconv.el (cconv--analyse-use):
	* net/gnutls.el (gnutls-negotiate): Fix typos.

2011-11-24  Glenn Morris  <rgm@gnu.org>

	* lpr.el (lpr-windows-system, lpr-lp-system):
	* mail/binhex.el (binhex-begin-line):
	* progmodes/grep.el (grep-history, grep-find-history):
	* textmodes/flyspell.el:
	* vc/pcvs-defs.el (cvs-global-menu):
	* vc/vc-bzr.el (vc-bzr-admin-checkout-format-file):
	* vc/vc-mtn.el (vc-mtn-admin-dir, vc-mtn-admin-format):
	* vc/vc-cvs.el (vc-cvs-registered): Give them basic doc-strings.

	* net/tls.el: Fix case of "GnuTLS".

	* paths.el (rmail-file-name): Format doc-string for make-docfile.

	* version.el (emacs-build-system): Give it a doc-string.

2011-11-24  Juri Linkov  <juri@jurta.org>

	* view.el (view-buffer): Revert 2011-07-19T15:01:49Z!larsi@gnus.org from 2011-07-19 (bug#8615).

2011-11-24  Glenn Morris  <rgm@gnu.org>

	* mail/rmailmm.el (rmail-mime): When rmail-enable-mime is non-nil,
	if called on a non-mime message just toggle the headers.  (Bug#8006)

2011-11-24  Juanma Barranquero  <lekktu@gmail.com>

	* allout.el (allout-setup, allout-auto-save-temporarily-disabled)
	(allout-lead-with-comment-string, allout-structure-deleted-hook)
	(allout-mode, allout-chart-subtree, allout-hotspot-key-handler)
	(allout-rebullet-heading, allout-open-sibtopic)
	(allout-toggle-current-subtree-encryption)
	(allout-toggle-subtree-encryption, allout-encrypt-string)
	(allout-next-topic-pending-encryption, allout-adjust-file-variable)
	(allout-distinctive-bullets-string, allout-auto-activation):
	* window.el (window-normalize-buffer-to-display):
	* progmodes/verilog-mode.el (verilog-batch-indent):
	* textmodes/bibtex.el (bibtex-field-braces-opt)
	(bibtex-field-strings-opt):
	* vc/cvs-status.el (cvs-tree-merge):
	Fix typos.

2011-11-23  Michael Albinus  <michael.albinus@gmx.de>

	* rfn-eshadow.el (rfn-eshadow-update-overlay): Let-bind
	`non-essential' to t, in order to avoid remote connections.

2011-11-23  Eli Zaretskii  <eliz@gnu.org>

	* emacs-lisp/autoload.el (autoload-generate-file-autoloads):
	On MS-DOS and MS-Windows, compare with loaddefs.el
	case-insensitively.

2011-11-23  Mark Lillibridge  <mark.lillibridge@hp.com>  (tiny change)

	* mail/unrmail.el (unrmail): Always add blank line.  (Bug#7743)

2011-11-23  Glenn Morris  <rgm@gnu.org>

	* paths.el (rmail-file-name): Reformat the doc-string so that it
	is picked up.

	* mail/rmail.el (rmail-message-filter, rmail-auto-file): Doc fixes.
	(rmail-auto-file): Ignore case in the "special" field names,
	as mail-fetch-field does for all others.

	* mail/rmail.el (rmail-forward):
	* mail/rmailkwd.el (rmail-set-label):
	* mail/rmailout.el (rmail-output, rmail-output-as-seen)
	(rmail-output-body-to-file): Give error if no message.  (Bug#10082)

	* mail/rmail.el (rmail-current-message): Doc fix.

	* mail/rmail.el (rmail-message-filter): Mark as obsolete.  (Bug#2624)

2011-11-22  Stefan Monnier  <monnier@iro.umontreal.ca>

	* server.el (server-eval-and-print): Allow C-g (bug#6585).

2011-11-22  Glenn Morris  <rgm@gnu.org>

	* mail/rmailmm.el (test-rmail-mime-handler)
	(test-rmail-mime-bulk-handler)
	(test-rmail-mime-multipart-handler): Move tests to test/ directory.

2011-11-21  Juri Linkov  <juri@jurta.org>

	* calc/calc.el (calc-read-key-sequence):
	Let-bind `input-method-function' to nil.  (Bug#10018)

2011-11-21  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* emacs-lisp/cl-indent.el (common-lisp-loop-part-indentation):
	Tell the caller that the next line needs recomputation, even
	though it doesn't start a sexp (bug#10094).

2011-11-21  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/autoload.el (autoload-generate-file-autoloads): Simplify.

2011-11-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc/pcvs-util.el (cvs-pop-to-buffer-same-frame):
	Use force-same-window.

2011-11-20  Juanma Barranquero  <lekktu@gmail.com>

	* descr-text.el (describe-char-unicode-data):
	* json.el (json-string-escape):
	* mail/footnote.el (footnote-unicode-string, footnote-unicode-regexp)
	(Footnote-unicode, Footnote-style-p):
	* net/ntlm.el (ntlm-get-password-hashes): Fix typos.

2011-11-20  Chong Yidong  <cyd@gnu.org>

	* window.el (replace-buffer-in-windows): Restore interactive spec.

2011-11-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* electric.el (electric-indent-mode): Fix last change (too optimistic).

	* emacs-lisp/bytecomp.el: Silence obsolete warnings more reliably.
	(byte-compile-global-not-obsolete-vars): New var.
	(byte-compile-check-variable, byte-compile-make-obsolete-variable):
	Use it.
	(byte-compile-warn-obsolete): Align text with the one in *Help*.

2011-11-20  Juanma Barranquero  <lekktu@gmail.com>

	* progmodes/cwarn.el (cwarn-is-enabled, cwarn-font-lock-keywords):
	* progmodes/pascal.el (electric-pascal-equal):
	* textmodes/reftex-dcr.el (reftex-view-crossref-from-bibtex):
	* xml.el (xml-substitute-special): Fix typos.

2011-11-20  Glenn Morris  <rgm@gnu.org>

	* mail/rmail.el (rmail-enable-mime-composing): Make it a defcustom.
	(rmail-insert-mime-forwarded-message-function, rmail-mime-feature):
	Doc fixes.
	(rmail-decode-mime-charset): Mark as obsolete.

	* mail/rmailsum.el (rmail-message-regexp-p-1):
	* mail/rmail.el (rmail-search-message, rmail-forward, rmail-resend):
	Before using mime functions, check they are set.  (Bug#10077)

2011-11-19  Juri Linkov  <juri@jurta.org>

	* info.el (Info-finder-find-node): Use `package--builtins' instead
	of `package-alist'.  Use node names formed by the pattern "Keyword "
	and the keyword name.

2011-11-19  Andreas Schwab  <schwab@linux-m68k.org>

	* progmodes/sh-script.el (sh-assignment-regexp): Add entry for bash.

2011-11-19  Juri Linkov  <juri@jurta.org>

	* info.el (Info-hide-note-references): Add `:set' tag to `defcustom'
	that calls `revert-buffer' on all Info buffers.  (Bug#9915)
	(Info-revert-find-node): Remove let-bindings `old-buffer-name',
	`old-history', `old-history-forward'.  Add let-binding
	`window-selected'.  Remove calls to `kill-buffer',
	`switch-to-buffer' and `Info-mode'.  Set `Info-current-file' to nil
	before calling `Info-find-node', so `Info-find-node-2' will reread
	the Info file.  Restore window positions only when `window-selected'
	is non-nil.

2011-11-19  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-lazy-highlight-new-loop):
	Remove condition `(not isearch-error)'.  (Bug#9918)

	* misearch.el (multi-isearch-search-fun): Add condition
	`(not bound)' to ignore lazy-highlighting search.
	Add the search-failed message "end of multi" when the end of
	multi-sequence is reached.  Uncapitalize the search-failed
	message "Repeat for next buffer".

	* info.el (Info-search): Add the search-failed message
	"end of the manual" when the end of the manual is reached
	in Isearch mode.

2011-11-19  Juri Linkov  <juri@jurta.org>

	* info.el (Info-find-node-2, Info-select-node, Info-history-find-node):
	Use non-destructive `remove' instead of `delete' because
	`Info-history-list' stored to `Info-isearch-initial-history-list' in
	`Info-isearch-start' might need to be restored in `Info-isearch-end'.

2011-11-19  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-edit-string): Let-bind `history-add-new-input'
	to nil instead of binding `search-ring' and `regexp-search-ring'.
	(Bug#9185)

2011-11-19  Eli Zaretskii  <eliz@gnu.org>

	* simple.el (line-move): Force movement by logical lines for any
	hscrolled window, not only when auto-hscroll-mode is on.
	(line-move-visual): Update doc string to that effect.  (Bug#10076)

2011-11-19  Andreas Schwab  <schwab@linux-m68k.org>

	* language/european.el (macintosh): Define as alias for mac-roman.

2011-11-19  Eli Zaretskii  <eliz@gnu.org>

	* mail/rmailmm.el (rmail-mime-display-header)
	(rmail-mime-display-tagline, rmail-mime-display-body): New defsubsts.
	(rmail-mime-entity-segment, rmail-mime-toggle-raw)
	(rmail-mime-toggle-hidden, rmail-mime-insert-text)
	(rmail-mime-insert-bulk, rmail-mime-insert-multipart)
	(rmail-mime-insert, rmail-mime-insert-tagline): Use them instead
	of a raw aref.
	(rmail-mime-entity-segment): To get past the tagline, move forward
	2 more lines, to account for the 2 empty lines that precede and
	follow the line with the buttons.
	(rmail-mime-update-tagline): Move one more line, to get past the
	empty line that follows the buttons in the tagline.  (Bug#9520)

2011-11-19  Martin Rudalics  <rudalics@gmx.at>

	* window.el (window-max-delta-1, window-min-delta-1)
	(window-min-size-1, window-state-get-1, window-state-put-1)
	(window-state-put-2): Use "window--" prefix.

2011-11-18  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/smie.el: Improve warnings and conflict detection.
	(smie-warning-count): New var.
	(smie-set-prec2tab): Use it.
	(smie-bnf->prec2): Improve warnings.  Add docstring.
	(smie-bnf--closer-alist): Rename from smie-bnf-closer-alist.
	(smie-bnf--set-class): New function.
	(smie-bnf--classify): Rename from smie-bnf-classify.  Rewrite to fix
	corner case.

	* progmodes/compile.el: Obey compilation-first-column in dest buffer.
	(compilation-error-properties, compilation-move-to-column):
	Handle compilation-first-column while in the target buffer.

	* progmodes/cc-engine.el (c-remove-stale-state-cache-backwards):
	Don't hardcode point-min==1.

	* eshell/esh-cmd.el (eshell-do-eval): Handle `setq' (bug#9907).
	(eshell-rewrite-for-command): Remove workaround.
	(eshell-do-pipelines, eshell-do-pipelines-synchronously)
	(eshell-do-eval, eshell-exec-lisp): Avoid gratuitous setq.
	* eshell/esh-util.el (eshell-condition-case, eshell-for): Use declare.

	* files-x.el (modify-file-local-variable): Obey commenting conventions.

2011-11-17  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/autoload.el (autoload-generate-file-autoloads):
	Ignore buffer-local generated-autoload-file if it is the same
	as the global value.  (Bug#10049)

2011-11-17  Juanma Barranquero  <lekktu@gmail.com>

	* textmodes/reftex-toc.el (reftex-toc-return-marker, reftex-toc-help)
	(reftex-toc, reftex-toc, reftex-toc-dframe-p, reftex-toc-next-heading)
	(reftex-toc-previous-heading, reftex-toc-max-level)
	(reftex-toc-goto-line-and-hide, reftex-toc-show-calling-point)
	(reftex-toc-quit, reftex-toc-revert, reftex-toc-jump)
	(reftex-toc-do-promote, reftex-toc-promote-prepare)
	(reftex-toc-promote-action, reftex-toc-extract-section-number)
	(reftex-toc-load-all-files-for-promotion, reftex-toc-rename-label)
	(reftex-toc-rename-label, reftex-toc-visit-location)
	(reftex-toc-visit-location, reftex-toggle-auto-toc-recenter)
	(reftex-toggle-auto-toc-recenter, reftex-toggle-auto-toc-recenter)
	(reftex-make-separate-toc-frame): Fix typos, and use TOC consistently,
	leaving "*toc*" only for references to the buffer.

2011-11-17  Martin Rudalics  <rudalics@gmx.at>

	* window.el (window-resize, delete-window, split-window):
	Replace window-splits by window-combination-resize.
	* cus-start.el (window-splits): Replace by window-combination-resize.

2011-11-17  Glenn Morris  <rgm@gnu.org>

	* progmodes/sh-script.el (sh-font-lock-keywords-var):
	Make bash entry derive from sh entry, not shell entry.

2011-11-16  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-sh.el (tramp-sh-handle-file-truename): Cache only the
	local file name.

2011-11-16  Juanma Barranquero  <lekktu@gmail.com>

	* menu-bar.el (menu-bar-file-menu):
	* printing.el (pr-ps-utility):
	* calendar/icalendar.el (icalendar, icalendar--convert-tz-offset)
	(icalendar--convert-to-ical, icalendar--convert-ordinary-to-ical)
	(icalendar--convert-weekly-to-ical, icalendar--convert-yearly-to-ical)
	(icalendar--convert-sexp-to-ical, icalendar--convert-block-to-ical)
	(icalendar--convert-float-to-ical, icalendar--convert-date-to-ical)
	(icalendar--convert-cyclic-to-ical)
	(icalendar--convert-anniversary-to-ical, icalendar-import-buffer)
	(icalendar--convert-ical-to-diary)
	(icalendar--convert-recurring-to-diary)
	(icalendar--convert-non-recurring-all-day-to-diary)
	(icalendar-import-format-sample):
	* progmodes/idlw-shell.el (idlwave-shell-mode):
	* progmodes/vhdl-mode.el (vhdl-mode, vhdl-print-two-column)
	(vhdl-print-customize-faces, vhdl-mode, vhdl-ps-print-settings)
	(vhdl-ps-print-init): Fix typos.

2011-11-16  Ken Manheimer  <ken.manheimer@gmail.com>

	* allout.el, allout-widgets.el (file metadata): Attribute copyright to
	FSF and collapse date sequence, obscure author/maintainer email address
	better, remove extra version line, track relocation of author's webpage.

	* progmodes/python.el (python-pdbtrack-input-prompt)
	(python-pdbtrack-track-stack-file): Adjust to recognize ipdb as well as
	regular python pdb prompts.  Adjustments shamelessly taken exactly as
	suggested in EmacsWiki page (tiny change):
	http://www.emacswiki.org/PythonProgrammingInEmacs#toc14

2011-11-16  Juanma Barranquero  <lekktu@gmail.com>

	* expand.el (expand-pos, expand-index, expand-point):
	Remove redundant info from docstring.
	(expand-add-abbrevs): Doc fix.
	(expand-c-sample-expand-list, expand-sample-lisp-mode-expand-list)
	(expand-sample-perl-mode-expand-list): Fix typos.

	* net/dbus.el (dbus-event-member-name):
	* play/5x5.el (5x5-solve-rotate-left, 5x5-solver-output):
	* term/pc-win.el (msdos-create-frame-with-faces):
	* textmodes/texinfmt.el (texinfo-format-image): Fix typos.

2011-11-16  Martin Rudalics  <rudalics@gmx.at>

	* window.el (split-window, window-state-get-1)
	(window-state-put-1, window-state-put-2): Rename occurrences of
	window-nest to window-combination-limit.
	* cus-start.el (window-nest): Rename to window-combination-limit.

2011-11-16  Chong Yidong  <cyd@gnu.org>

	* progmodes/autoconf.el (autoconf-mode): Fix comment-start-skip
	regexp (Bug#10033).

2011-11-16  Stefan Monnier  <monnier@iro.umontreal.ca>

	* tmm.el (tmm-prompt): Use minibuffer-with-setup-hook (bug#10053).
	`completing-read' will remove *Completions* and will preserve
	current-buffer for us.
	(tmm-add-prompt): Users of *Completions* will always (re)set its
	major mode.
	(tmm-old-comp-map): Remove.

2011-11-16  Glenn Morris  <rgm@gnu.org>

	* mail/rmailedit.el: Require rmailmm when compiling.
	(rmail-old-mime-state): New declaration.
	(rmail-edit-current-message): If editing a mime message,
	edit the "raw" message from the mbox buffer.
	(rmail-cease-edit): Handle mime messages.  (Bug#9840)

2011-11-15  Glenn Morris  <rgm@gnu.org>

	* mail/rmailmm.el (rmail-mime-toggle-raw): Remove entity arg,
	which wasn't being used.  Add optional arg to force given state.
	(rmail-mime): Add optional arg to force given state.

2011-11-15  Juanma Barranquero  <lekktu@gmail.com>

	* allout.el (allout-encryption-plaintext-sanitization-regexps):
	* frame.el (display-mm-dimensions-alist):
	* outline.el (outline-mode-menu-bar-map, outline-move-subtree-up)
	(outline-move-subtree-down):
	* net/newst-treeview.el (newsticker--treeview-do-get-node-of-feed)
	(newsticker--treeview-do-get-node):
	* net/quickurl.el (quickurl-list-buffer-name):
	* progmodes/dcl-mode.el (dcl-mode):
	* progmodes/gdb-mi.el (gdb-mapcar*):
	* progmodes/sql.el (sql-mode-oracle-font-lock-keywords): Fix typos.

2011-11-15  Glenn Morris  <rgm@gnu.org>

	* mail/rmail.el (rmail-file-coding-system): It's only ever used
	in a boolean sense, so just make it a boolean, and fix the doc.
	(rmail-show-mime-function, rmail-mime-feature)
	(rmail-require-mime-maybe): Doc fixes.
	(rmail-show-message-1): Check rmail-show-mime-function is non-nil.

	* mail/rmailmm.el (rmail-show-mime): Doc fix.

2011-11-15  Juanma Barranquero  <lekktu@gmail.com>

	* epg.el (epg-start-decrypt, epg-start-verify, epg-start-sign)
	(epg-start-encrypt, epg-start-export-keys, epg-start-import-keys)
	(epg-start-receive-keys, epg-start-delete-keys, epg-start-sign-keys)
	(epg-start-generate-key, epg-context-set-progress-callback): Fix typos.

2011-11-15  Glenn Morris  <rgm@gnu.org>

	* mail/rmailmm.el (rmail-mime-entity, rmail-mime-entity-segment)
	(rmail-mime-shown-mode, rmail-mime-hidden-mode, rmail-mime-raw-mode)
	(rmail-mime-toggle-hidden, rmail-mime-insert-tagline)
	(rmail-mime-insert-header, rmail-mime-handle, rmail-mime-parse)
	(rmail-mime, rmail-show-mime): Doc fixes.

	* term/ns-win.el (mode-line-frame-identification):
	Leave it alone.  (Bug#10051)

	* simple.el (mark-whole-buffer): Doc fix.  (Bug#10023)

	* mail/rmailout.el (rmail-output-to-rmail-buffer):
	Handle empty buffers.  (Bug#9978)

2011-11-14  Juanma Barranquero  <lekktu@gmail.com>

	* international/mule.el (define-charset):
	* mail/rmailmm.el (rmail-mime-find-header-encoding):
	* progmodes/prolog.el (prolog-mode-hook, prolog-inferior-mode-hook):
	* progmodes/verilog-mode.el (verilog-backward-token):
	* textmodes/ispell.el (lookup-words):
	* textmodes/sgml-mode.el (sgml-guess-indent): Fix typos.

2011-11-14  Glenn Morris  <rgm@gnu.org>

	* progmodes/executable.el
	(executable-make-buffer-file-executable-if-script-p):
	Handle file-modes returning nil.

	* mail/rmailsum.el (rmail-summary): Remove movement to beginning of
	message - not necessary, and causes problems.  (Bug#9831)

	* mail/rmailsum.el (rmail-new-summary): Preserve message number.

	* mail/rmail.el (rmail-no-mail-p): Remove mode-line N/M indicator.

	* mail/rmailsum.el (rmail-summary, rmail-new-summary)
	(rmail-new-summary-1): Allow empty summaries.  (Bug#9964)
	(rmail-new-summary): Remember that rmail-summary-buffer is buffer-local.

2011-11-12  Martin Rudalics  <rudalics@gmx.at>

	* window.el (window-resize, delete-window): Use window-splits
	variable instead of function.
	(window-state-get-1, window-state-put-2, window-state-put):
	Don't deal with windows' splits status.

2011-11-12  Glenn Morris  <rgm@gnu.org>

	* apropos.el (apropos-do-all, apropos-library, apropos-value)
	(apropos-documentation): Doc fixes.

2011-11-11  Juanma Barranquero  <lekktu@gmail.com>

	* progmodes/idlw-shell.el (idlwave-shell-make-new-bp-overlay):
	* textmodes/sgml-mode.el (html-tag-help): Fix typos.

2011-11-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* electric.el (electric-indent-post-self-insert-function): Make it
	possible for a char to only indent in some circumstances.
	(electric-indent-mode): Simplify.

2011-11-11  Martin Rudalics  <rudalics@gmx.at>

	* window.el (windows-with-parameter): Remove unused function.
	(windows-at-side): Rename to window-at-side-list.
	(window-check, window-atom-check, window-atom-check-1)
	(window-side-check, window-size-ignore, window-size-fixed-1)
	(window-in-direction-2): Prefix with "window--".
	(window-tree-1): Rename to window--subtree, fix doc-string.

2011-11-11  Glenn Morris  <rgm@gnu.org>

	* subr.el (eval-after-load): If FILE is already loaded,
	evaluate FORM before it gets wrapped in more stuff.  (Bug#10009)

2011-11-10  Glenn Morris  <rgm@gnu.org>

	* vc/vc-svn.el (vc-svn-create-repo, vc-svn-modify-change-comment):
	Call svn via vc-svn-command rather than vc-do-command.
	(vc-svn-command): Add --non-interactive.  (Bug#9993)
	(vc-svn-update, vc-svn-merge-news): No need for --non-interactive.

	* emacs-lisp/bytecomp.el (byte-compile-interactive-only-functions):
	Add toggle-read-only.  (Bug#7292)
	* files.el (toggle-read-only): Mention that it should only
	be used interactively.  (Bug#10006)

2011-11-09  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/compile.el (compilation-error-regexp-alist-alist):
	Adjust regexp for OCaml warnings.

	* electric.el (electric-pair-post-self-insert-function): Let user
	turn it off buffer-locally (bug#9932).

	* progmodes/python.el (python-beginning-of-statement):
	Rewrite (bug#2703).

	* progmodes/compile.el: Better handle TABs (bug#9749).
	(compilation-internal-error-properties)
	(compilation-next-error-function): Obey the target buffer's
	compilation-error-screen-columns.

2011-11-09  Juanma Barranquero  <lekktu@gmail.com>

	* progmodes/meta-mode.el: Remove obsolete comments.
	(meta-right-comment-regexp, meta-ignore-comment-regexp):
	Fix typos in docstrings.

2011-11-09  Martin Rudalics  <rudalics@gmx.at>

	* window.el (window-size-fixed-p): Rewrite doc-string.
	(window-resizable-p): Rename to window--resizable-p.  Update callers.
	(window--resizable): New function.  Make all callers of
	window-resizable call window--resizable instead.
	(window-resizable): Rewrite in terms of window--resizable.

2011-11-08  Glenn Morris  <rgm@gnu.org>

	* progmodes/delphi.el (delphi-mode-syntax-table):
	Let define-derived-mode define a proper syntax table.  (Bug#9994)

2011-11-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* window.el: Stay away from defsubst.
	(window-list-no-nils): Remove.
	(window-state-get-1, window-state-get): Use backquote instead.

2011-11-08  Thierry Volpiatto  <thierry.volpiatto@gmail.com>

	* emacs-lisp/find-func.el (find-function-read):
	Fix incorrect use of default argument in `completing-read'.

2011-11-08  Martin Rudalics  <rudalics@gmx.at>

	* window.el (display-buffer-function, special-display-function):
	Mention display-buffer-record-window but do not mention
	help-setup parameter in doc-strings.
	(window-min-delta): Fix doc-string typo.

2011-11-08  Chong Yidong  <cyd@gnu.org>

	* window.el (window-total-height, window-total-width): Doc fix.
	(window-body-size): Move from C.
	(window-body-height, window-body-width): Move to C.

2011-11-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* window.el: Make special-display like display-buffer-alist (bug#9532).
	(display-buffer--special-action): New function, morphed
	from display-buffer--special.
	(display-buffer): Use it to handle special-display-buffers at higher
	priority (just after display-buffer-alist).
	(display-buffer-fallback-action, display-buffer--other-frame-action)
	(pop-to-buffer-same-window): Remove display-buffer--special.

2011-11-07  Glenn Morris  <rgm@gnu.org>

	* calendar/cal-menu.el (cal-menu-set-date-title):
	Do nothing if not in a calendar.  (Bug#9976)

2011-11-07  Stefan Monnier  <monnier@iro.umontreal.ca>

	* files.el (find-file): Always use selected-window.

2011-11-07  Martin Rudalics  <rudalics@gmx.at>

	* window.el (window-combinations): Make WINDOW argument
	mandatory.  Rewrite doc-string.
	(walk-window-subtree, window-atom-check, window-min-delta)
	(window-max-delta, window--resize-this-window)
	(window--resize-root-window-vertically, window-tree)
	(balance-windows, window-state-put): Rewrite doc-strings as to
	not mention the term "subwindow".
	(window--resize-subwindows-skip-p): Rename to
	window--resize-child-windows-skip-p.
	(window--resize-subwindows-normal): Rename to
	window--resize-child-windows-normal.
	(window--resize-subwindows): Rename to
	window--resize-child-windows.
	(window-or-subwindow-p): Rename to window--in-subtree-p.

2011-11-07  Mark Lillibridge  <mark.lillibridge@hp.com>  (tiny change)

	* mail/rmail.el (rmail-get-new-mail, rmail-insert-inbox-text):
	Ensure that mbox format messages end in two newlines (Bug#9974).

2011-11-06  Chong Yidong  <cyd@gnu.org>

	* window.el (window-combination-p): Function deleted; its
	side-effect is not used in any existing code.
	(window-combinations, window-combined-p): Call window-*-child
	directly.

2011-11-05  Chong Yidong  <cyd@gnu.org>

	* window.el (window-valid-p): Rename from window-any-p.
	(window-size-ignore, window-state-get): Callers changed.
	(window-normalize-window): Rename from window-normalize-any-window.
	New arg LIVE-ONLY, replacing window-normalize-live-window.
	(window-normalize-live-window): Delete.
	(window-combination-p, window-combined-p, window-combinations)
	(walk-window-subtree, window-atom-root, window-min-size)
	(window-sizable, window-sizable-p, window-size-fixed-p)
	(window-min-delta, window-max-delta, window-resizable)
	(window-resizable-p, window-full-height-p, window-full-width-p)
	(window-current-scroll-bars, window-point-1, set-window-point-1)
	(window-at-side-p, window-in-direction, window-resize)
	(adjust-window-trailing-edge, maximize-window, minimize-window)
	(window-deletable-p, delete-window, delete-other-windows)
	(record-window-buffer, unrecord-window-buffer)
	(switch-to-prev-buffer, switch-to-next-buffer, window--delete)
	(quit-window, split-window, window-state-put)
	(set-window-text-height, fit-window-to-buffer)
	(shrink-window-if-larger-than-buffer): Callers changed.

2011-11-04  Eli Zaretskii  <eliz@gnu.org>

	* mail/rmail.el (rmail-simplified-subject): Decode subject with
	rfc2047-decode-string.
	(rmail-mime-toggle-hidden): Declare to avoid byte-compilation
	warnings.

	* window.el (window-body-height, window-body-width): Mention in
	the doc string that the return values are in frame's canonical
	units.  (Bug#9949)

2011-11-03  Alan Mackenzie  <acm@muc.de>

	* progmodes/cc-langs.el (c-nonlabel-token-2-key): New variable for
	change in cc-engine.el.

2011-11-02  Stefan Monnier  <monnier@iro.umontreal.ca>

	* window.el (switch-to-buffer): Use `force-same-window' interactively.

2011-11-02  Martin Rudalics  <rudalics@gmx.at>

	* window.el (quit-window): Call unrecord-window-buffer after
	showing another buffer in the window.  (Bug#9937)
	(bury-buffer): Call switch-to-prev-buffer with second argument `bury'.

2011-11-02  Juanma Barranquero  <lekktu@gmail.com>

	* vc/vc-bzr.el (vc-bzr-state, vc-bzr-after-dir-status):
	Accept status with more than 9 shelves.  (Bug#9935)
	Reported by Colin D Bennett <colin@gibibit.com>.

2011-11-01  Martin Rudalics  <rudalics@gmx.at>

	* help.el (with-help-window): Don't reference
	temp-buffer-show-specifiers in doc-string.

2011-10-31  Andreas Schwab  <schwab@linux-m68k.org>

	* subr.el (keymap--menu-item-with-binding): Ignore item if not a
	menu-item.

2011-10-30  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* whitespace.el: New version 13.2.2.
	(whitespace-newline-mode): Disable properly.  Reported by Sarah
	<EmacsWiki>.

2011-10-30  Ulf Jasper  <ulf.jasper@web.de>

	* net/newst-treeview.el: Remove "Time-stamp".
	(newsticker--group-manage-orphan-feeds): Do not call
	newsticker--treeview-tree-update.
	(newsticker-treeview-update, newsticker-treeview):
	Call newsticker--treeview-tree-update if necessary.

2011-10-30  Martin Rudalics  <rudalics@gmx.at>

	* window.el (window-iso-combination-p, window-iso-combined-p)
	(window-iso-combinations): Remove "iso-" infix.
	Suggested by Chong Yidong.
	(window-min-size-1, window-size-fixed-1, window-min-delta-1)
	(window-max-delta-1, window-resize, window--resize-siblings)
	(window--resize-this-window, adjust-window-trailing-edge)
	(split-window, balance-windows-1)
	(shrink-window-if-larger-than-buffer):
	* calendar/calendar.el (calendar-generate-window):
	* help.el (resize-temp-buffer-window): Adjust callers accordingly.

2011-10-30  Stefan Monnier  <monnier@iro.umontreal.ca>

	* eshell/esh-cmd.el (eshell-rewrite-for-command): Don't modify the list
	in place (bug#9907).
	(eshell-subcommand-arg-values, eshell-rewrite-named-command)
	(eshell-rewrite-if-command, eshell-rewrite-for-command)
	(eshell-structure-basic-command, eshell-rewrite-while-command)
	(eshell-invokify-arg, eshell-parse-pipeline, eshell-parse-command)
	(eshell-parse-subcommand-argument, eshell-parse-lisp-argument)
	(eshell-trap-errors, eshell-do-pipelines, eshell-do-eval)
	(eshell-do-pipelines-synchronously, eshell-eval-command):
	Use backquotes and prefer setq to set.
	(eshell-lookup-function, function-p-func, eshell-functionp): Remove.
	(eshell-macrop): Use functionp.
	(eshell-do-eval): Handle multiple expressions in `while' body.

2011-10-30  Chong Yidong  <cyd@gnu.org>

	* emulation/viper-cmd.el (viper-exec-change): Use push-mark
	instead of set-mark (Bug#9810).

2011-10-30  Chong Yidong  <cyd@gnu.org>

	* window.el (split-window-below, split-window-right): Rename from
	split-window-above-each-other and split-window-side-by-side
	respectively.  All callers changed.
	(split-window-sensibly, split-window-sensibly): Use them.
	(split-window-keep-point): Doc fix.

	* isearch.el: Add isearch-scroll property to split-window-below
	and split-window-right.

	* follow.el (follow-mode):
	* vc/pcvs-util.el (cvs-pop-to-buffer-same-frame):
	* progmodes/ada-xref.el (ada-gdb-application):
	* emulation/vip.el (vip-buffer-in-two-windows):
	* image-dired.el (image-dired-dired-with-window-configuration):
	* dired-x.el (dired-do-find-marked-files):
	* dired.el (dired-pop-to-buffer):
	* bs.el (bs--show-with-configuration):
	* vc/emerge.el (emerge-setup-windows):
	* textmodes/two-column.el (2C-two-columns):
	* textmodes/reftex-toc.el (reftex-toc):
	* progmodes/gdb-mi.el (gdb-setup-windows):
	* progmodes/fortran.el (fortran-window-create):
	* net/newst-treeview.el (newsticker--treeview-window-init):
	* emulation/ws-mode.el (wordstar-C-o-map, wordstar-mode):
	* emulation/tpu-edt.el (tpu-gold-map):
	* emulation/crisp.el (crisp-mode-map):
	* calendar/calendar.el (calendar-basic-setup): Callers changed.

2011-10-29  Chong Yidong  <cyd@gnu.org>

	* subr.el (y-or-n-p): Add code for batch mode (Bug#9818).

	* mouse.el (mouse-yank-primary): Push the mark (Bug#9894).

	* textmodes/flyspell.el (flyspell-word): Fix char offset for
	forged Ispell output (Bug#7904).

	* emacs-lisp/package.el (package-refresh-contents): Add autoload.

2011-10-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* doc-view.el: Avoid ugly errors about not finding nil.
	(doc-view-ghostscript-program, doc-view-dvipdfm-program)
	(doc-view-dvipdf-program, doc-view-unoconv-program)
	(doc-view-ps2pdf-program, doc-view-pdftotext-program):
	Avoid nil or absolute file name as default value.
	(doc-view-pdf->txt, doc-view-ps->pdf): Use executable-find here.

2011-10-28  Alan Mackenzie  <acm@muc.de>

	* progmodes/cc-defs.el (c-version): -> 5.32.2.

2011-10-28  Alan Mackenzie  <acm@muc.de>

	Amend the handling of c-beginning/end-of-defun in nested declaration
	scopes.

	* progmodes/cc-vars.el (c-defun-tactic): Move here from
	cc-langs.el.  Change it to a defcustom.

	* progmodes/cc-langs.el (c-defun-tactic): Move this variable to
	cc-vars.el.

	* progmodes/cc-engine.el (c-beginning-of-statement-1):
	Prevent "class foo : bar" being spuriously recognized as a label.

	* progmodes/cc-cmds.el (c-narrow-to-most-enclosing-decl-block):
	Add parameter `inclusive' (to include enclosing braces in the region).
	(c-widen-to-enclosing-decl-scope): New function.
	(c-while-widening-to-decl-block): New macro.
	(c-beginning-of-defun, c-end-of-defun): Change algorithm to keep going
	outward for defun boundaries, and correspondingly change symbol
	`respect-enclosure' to `go-outward'.
	(c-declaration-limits): Change algorithm to report only the "innermost"
	defun's boundaries.

2011-10-28  Deniz Dogan  <deniz@dogan.se>

	* net/rcirc.el (rcirc-mode): Use hard newlines.

2011-10-28  Alan Mackenzie  <acm@muc.de>

	Amend to indent and fontify macros "which include their own semicolon"
	correctly, using the "virtual semicolon" mechanism.

	* progmodes/cc-defs.el: Update "virtual semicolon" comments.

	* progmodes/cc-engine.el (c-crosses-statement-barrier-p):
	Recode to scan one line at a time rather than having \n and \r
	explicitly in c-stmt-delim-chars (for some modes, e.g. AWK).
	(c-forward-label): Amend for virtual semicolons.
	(c-at-macro-vsemi-p, c-macro-vsemi-status-unknown-p): New functions.

	* progmodes/cc-fonts.el (c-font-lock-declarations): Take account
	of the new C macros.

	* progmodes/cc-langs.el (c-at-vsemi-p-fn):
	(c-vsemi-status-unknown-p-fn): Move to earlier in the file.
	(c-opt-cpp-symbol, c-line-comment-start-regexp): New language vars.
	(c-opt-cpp-macro-define): Make into a full language variable.
	(c-stmt-delim-chars, c-stmt-delim-chars-with-comma): Special value for
	AWK Mode (including \n, \r) removed, no longer needed.

	* progmodes/cc-mode.el (c-mode, c++-mode, objc-mode):
	Invoke c-make-macro-with-semi-re.

	* progmodes/cc-vars.el (c-macro-with-semi-re):
	(c-macro-names-with-semicolon): New variables.
	(c-make-macro-with-semi-re): New function.

2011-10-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc/log-edit.el: Fill empty field rather than adding new one.
	(log-edit-add-field): New function.
	(log-edit-insert-changelog): Use it.

2011-10-28  Mark Lillibridge  <mark.lillibridge@hp.com>  (tiny change)

	* mail/rmail.el (rmail-mode-map): Add M-C-f as in rmailsum (bug#9802).

2011-10-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/gdb-mi.el: Warn the user when -i=mi is missing.
	(gdb--check-interpreter): New function.
	(gdb): Use it.

2011-10-27  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/cl-extra.el (most-positive-float, most-negative-float)
	(least-positive-float, least-negative-float)
	(least-positive-normalized-float, least-negative-normalized-float)
	(float-epsilon, float-negative-epsilon):
	Remove unnecessary declarations.

	* emacs-lisp/cl-extra.el (cl-float-limits): Add doc string.
	* emacs-lisp/cl.el (most-positive-float, most-negative-float)
	(least-positive-float, least-negative-float)
	(least-positive-normalized-float, least-negative-normalized-float)
	(float-epsilon, float-negative-epsilon): Add doc-strings,
	based on those in cl.texi.

	* files.el (set-visited-file-name): If the major-mode changed,
	reload the local variables.  (Bug#9796)

2011-10-27  Chong Yidong  <cyd@gnu.org>

	* subr.el (change-major-mode-after-body-hook): New hook.
	(run-mode-hooks): Run it.

	* emacs-lisp/easy-mmode.el (define-globalized-minor-mode):
	Use change-major-mode-before-body-hook.

	* simple.el (fundamental-mode):
	* emacs-lisp/derived.el (define-derived-mode): Revert 2010-04-28
	change introducing fundamental-mode-hook.

2011-10-26  Juanma Barranquero  <lekktu@gmail.com>

	* term/w32-win.el (w32-default-color-map): Declare obsolete (Bug#9785).

2011-10-26  Michael Albinus  <michael.albinus@gmx.de>

	* ido.el (ido-file-name-all-completions-1): Do not require
	tramp.el explicitly.  (Bug#7583)

2011-10-26  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/octave-mod.el:
	* progmodes/octave-inf.el: Update maintainer.

2011-10-26  Chong Yidong  <cyd@gnu.org>

	* subr.el (with-wrapper-hook): Rewrite doc.

2011-10-25  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-sh.el (tramp-sh-handle-file-directory-p): Return t for
	filenames "/method:foo:".  (Bug#9793)

2011-10-25  Stefan Monnier  <monnier@iro.umontreal.ca>

	* comint.el (comint-get-old-input-default): Fix use-prompt-regexp case
	(bug#9865).

2011-10-24  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/easy-mmode.el (define-minor-mode): Doc fix.  (Bug#9819)

2011-10-24  Michael Albinus  <michael.albinus@gmx.de>

	* notifications.el: Add the requirement of a running D-Bus session
	bus to the Commentary.

2011-10-24  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-occur): Let-bind `search-spaces-regexp' to
	`search-whitespace-regexp' only when `isearch-regexp' is non-nil.
	(Bug#9364)

2011-10-24  Juri Linkov  <juri@jurta.org>

	* info.el (Info-following-node-name-re): Add newline to the list
	of allowed characters for leading space.  (Bug#9824)

2011-10-24  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/octave-inf.el (inferior-octave-mode-map):
	Fix C-c C-h binding.
	* progmodes/octave-mod.el (octave-help): Remove.

2011-10-23  Michael Albinus  <michael.albinus@gmx.de>

	Sync with Tramp 2.2.3.

	* net/tramp-cache.el (top): Pacify byte-compiler using
	`init-file-user' and `site-run-file'.

	* net/trampver.el: Update release number.

2011-10-23  Chong Yidong  <cyd@gnu.org>

	* files.el (toggle-read-only): Remove obsolete comment about
	version control.

	* vc/vc-hooks.el (vc-toggle-read-only): Make it an obsolete alias
	for toggle-read-only.  Note that this hasn't called vc-next-action
	since 2008-05-02, though it wasn't documented at the time.

	* vc/ediff-init.el (ediff-toggle-read-only-function):
	Use toggle-read-only.

2011-10-22  Alan Mackenzie  <acm@muc.de>

	Fix bug #9560, sporadic wrong indentation; improve instrumentation
	of c-parse-state.

	* progmodes/cc-engine.el (c-append-lower-brace-pair-to-state-cache):
	correct faulty logical expression.
	(c-parse-state-state, c-record-parse-state-state):
	(c-replay-parse-state-state): New defvar/defuns.
	(c-debug-parse-state): Use new functions.

2011-10-22  Martin Rudalics  <rudalics@gmx.at>

	* mouse.el (mouse-drag-line): Fix minibuffer resizing broken by
	last fix.  Use window-in-direction correctly.

2011-10-21  Chong Yidong  <cyd@gnu.org>

	* progmodes/idlwave.el (idlwave-mode):
	* progmodes/vera-mode.el (vera-mode): No need to set
	require-final-newline; that's done in prog-mode.
	Suggested by Stefan Monnier.

2011-10-21  Martin Rudalics  <rudalics@gmx.at>

	* mouse.el (mouse-drag-window-above)
	(mouse-drag-move-window-bottom, mouse-drag-move-window-top)
	(mouse-drag-mode-line-1, mouse-drag-header-line)
	(mouse-drag-vertical-line-rightward-window): Remove.
	(mouse-drag-line): New function.
	(mouse-drag-mode-line, mouse-drag-header-line)
	(mouse-drag-vertical-line): Call mouse-drag-line.
	* window.el (window-at-side-p, windows-at-side): New functions.

2011-10-21  Ulrich Mueller  <ulm@gentoo.org>

	* tar-mode.el (tar-grind-file-mode):
	Fix handling of setuid/setgid, handle sticky bit.  (Bug#9817)

2011-10-21  Chong Yidong  <cyd@gnu.org>

	* progmodes/idlwave.el (idlwave-mode):
	* progmodes/vera-mode.el (vera-mode):
	Use mode-require-final-newline.

2011-10-20  Glenn Morris  <rgm@gnu.org>

	* vc/vc.el (vc-next-action): Handle removed directories.  (Bug#9781)

2011-10-20  Christoph Scholtes  <cschol2112@googlemail.com>

	* emulation/cua-base.el (cua-set-mark): Fix case of string.

2011-10-20  Chong Yidong  <cyd@gnu.org>

	* emulation/cua-base.el (cua-mode):
	* mail/footnote.el (footnote-mode):
	* mail/mailabbrev.el (mail-abbrevs-mode):
	* net/xesam.el (xesam-minor-mode):
	* progmodes/bug-reference.el (bug-reference-mode):
	* progmodes/cap-words.el (capitalized-words-mode):
	* progmodes/compile.el (compilation-minor-mode)
	(compilation-shell-minor-mode):
	* progmodes/gud.el (gud-tooltip-mode):
	* progmodes/hideif.el (hide-ifdef-mode):
	* progmodes/idlw-shell.el (idlwave-shell-electric-debug-mode):
	* progmodes/subword.el (subword-mode):
	* progmodes/vhdl-mode.el (vhdl-electric-mode, vhdl-stutter-mode):
	* progmodes/which-func.el (which-function-mode):
	* term/tvi970.el (tvi970-set-keypad-mode):
	* term/vt100.el (vt100-wide-mode):
	* textmodes/flyspell.el (flyspell-mode):
	* textmodes/ispell.el (ispell-minor-mode):
	* textmodes/nroff-mode.el (nroff-electric-mode):
	* textmodes/paragraphs.el (use-hard-newlines):
	* textmodes/refill.el (refill-mode):
	* textmodes/reftex.el (reftex-mode):
	* textmodes/rst.el (rst-minor-mode):
	* textmodes/sgml-mode.el (html-autoview-mode)
	(sgml-electric-tag-pair-mode):
	* textmodes/tex-mode.el (latex-electric-env-pair-mode):
	* vc/diff-mode.el (diff-auto-refine-mode, diff-minor-mode):
	* emulation/crisp.el (crisp-mode):
	* emacs-lisp/eldoc.el (eldoc-mode):
	* emacs-lisp/checkdoc.el (checkdoc-minor-mode): Doc fixes for new
	minor mode behavior.

2011-10-19  Juri Linkov  <juri@jurta.org>

	* descr-text.el (describe-char): Add #x2010 and #x2011 to
	the list of hard-coded chars with escape-glyph face.

2011-10-19  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc/log-edit.el (log-edit-empty-buffer-p): Ignore empty headers.

2011-10-19  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-connectable-p): Make a stronger check on a
	running process.

2011-10-19  Glenn Morris  <rgm@gnu.org>

	* vc/vc-bzr.el (vc-bzr-after-dir-status):
	Ignore ignored files.  (Bug#9726)

2011-10-19  Chong Yidong  <cyd@gnu.org>

	Doc fix for minor modes, stating that an omitted argument enables
	the mode unconditionally when called from Lisp.

	* abbrev.el (abbrev-mode):
	* allout.el (allout-mode):
	* autoinsert.el (auto-insert-mode):
	* autoarg.el (autoarg-mode, autoarg-kp-mode):
	* autorevert.el (auto-revert-mode, auto-revert-tail-mode)
	(global-auto-revert-mode):
	* battery.el (display-battery-mode):
	* composite.el (global-auto-composition-mode)
	(auto-composition-mode):
	* delsel.el (delete-selection-mode):
	* desktop.el (desktop-save-mode):
	* dired-x.el (dired-omit-mode):
	* dirtrack.el (dirtrack-mode):
	* doc-view.el (doc-view-minor-mode):
	* double.el (double-mode):
	* electric.el (electric-indent-mode, electric-pair-mode):
	* emacs-lock.el (emacs-lock-mode):
	* epa-hook.el (auto-encryption-mode):
	* follow.el (follow-mode):
	* font-core.el (font-lock-mode):
	* frame.el (auto-raise-mode, auto-lower-mode, blink-cursor-mode):
	* help.el (temp-buffer-resize-mode):
	* hilit-chg.el (highlight-changes-mode)
	(highlight-changes-visible-mode):
	* hi-lock.el (hi-lock-mode):
	* hl-line.el (hl-line-mode, global-hl-line-mode):
	* icomplete.el (icomplete-mode):
	* ido.el (ido-everywhere):
	* image-file.el (auto-image-file-mode):
	* image-mode.el (image-minor-mode):
	* iswitchb.el (iswitchb-mode):
	* jka-cmpr-hook.el (auto-compression-mode):
	* linum.el (linum-mode):
	* longlines.el (longlines-mode):
	* master.el (master-mode):
	* mb-depth.el (minibuffer-depth-indicate-mode):
	* menu-bar.el (menu-bar-mode):
	* minibuf-eldef.el (minibuffer-electric-default-mode):
	* mouse-sel.el (mouse-sel-mode):
	* msb.el (msb-mode):
	* mwheel.el (mouse-wheel-mode):
	* outline.el (outline-minor-mode):
	* paren.el (show-paren-mode):
	* recentf.el (recentf-mode):
	* reveal.el (reveal-mode, global-reveal-mode):
	* rfn-eshadow.el (file-name-shadow-mode):
	* ruler-mode.el (ruler-mode):
	* savehist.el (savehist-mode):
	* scroll-all.el (scroll-all-mode):
	* scroll-bar.el (scroll-bar-mode):
	* server.el (server-mode):
	* shell.el (shell-dirtrack-mode):
	* simple.el (auto-fill-mode, transient-mark-mode)
	(visual-line-mode, overwrite-mode, binary-overwrite-mode)
	(line-number-mode, column-number-mode, size-indication-mode)
	(auto-save-mode, normal-erase-is-backspace-mode, visible-mode):
	* strokes.el (strokes-mode):
	* time.el (display-time-mode):
	* t-mouse.el (gpm-mouse-mode):
	* tool-bar.el (tool-bar-mode):
	* tooltip.el (tooltip-mode):
	* type-break.el (type-break-mode-line-message-mode)
	(type-break-query-mode):
	* view.el (view-mode):
	* whitespace.el (whitespace-mode, whitespace-newline-mode)
	(global-whitespace-mode, global-whitespace-newline-mode):
	* xt-mouse.el (xterm-mouse-mode): Doc fix.

	* emacs-lisp/easy-mmode.el (define-globalized-minor-mode):
	Fix autogenerated docstring.

2011-10-19  Juri Linkov  <juri@jurta.org>

	* net/browse-url.el (browse-url-can-use-xdg-open): Support LXDE
	by checking environment variables "DESKTOP_SESSION" and
	"XDG_CURRENT_DESKTOP".  (Bug#9779)

2011-10-19  Juri Linkov  <juri@jurta.org>

	* net/browse-url.el (browse-url-browser-function): Add "Chromium".
	(browse-url-chromium-program, browse-url-chromium-arguments):
	New defcustoms.
	(browse-url-default-browser): Check for `browse-url-chromium' and
	call `browse-url-chromium-program'.
	(browse-url-chromium): New command.  (Bug#9779)

2011-10-18  Juanma Barranquero  <lekktu@gmail.com>

	* facemenu.el (list-colors-duplicates): On Windows, detect more
	duplicates by assuming that only colors matching "^System" are
	special "system colors".  (Bug#9722)

2011-10-18  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc/log-edit.el (log-edit): Add "Author:" header to encourage people
	to distinguish the author from the committer.

2011-10-18  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-file-name-handler): Load Tramp packages silently.

2011-10-18  Jirka Kosek  <jirka@kosek.cz>  (tiny change)

	* international/mule.el (sgml-html-meta-auto-coding-function):
	Add support for detecting encoding in HTML5 specified only as
	<meta charset="UTF-8">.  Implementation just makes http-equiv and
	content-type parts from HTML4 encoding string optional.  (Bug#9716)

2011-10-18  Glenn Morris  <rgm@gnu.org>

	* vc/vc.el (vc-initial-comment): Mark as obsolete.  (Bug#9745)

2011-10-18  Chong Yidong  <cyd@gnu.org>

	* faces.el (cursor): Doc fix.

2011-10-17  Chong Yidong  <cyd@gnu.org>

	* font-lock.el (font-lock-maximum-size): Mark as obsolete.

2011-10-17  Ryan Barrett  <emacs@ryanb.org>  (tiny change)

	* dirtrack.el (dirtrack): Support shell buffers with path
	prefixes, e.g. tramp-based remote shells.  (Bug#9647)

2011-10-17  Teodor Zlatanov  <tzz@lifelogs.com>

	* json.el: Bump version to 1.3 and note change in History.
	(json-alist-p, json-plist-p): Rewrite to avoid recursion.

2011-10-17  Stefan Monnier  <monnier@iro.umontreal.ca>

	* comint.el (comint-insert-input, comint-send-input)
	(comint-get-old-input-default, comint-backward-matching-input)
	(comint-next-prompt): Use nil instead of `input' for field property of
	past user input (bug#114).

	* minibuffer.el (completion--replace): Inherit surrounding properties
	(bug#114).
	(minibuffer-complete-and-exit): Use it.

	* comint.el (comint--table-subvert): Quote the all-completions output
	(bug#9160).

2011-10-17  Martin Rudalics  <rudalics@gmx.at>

	* ido.el (ido-default-buffer-method): Remove redundant :type entry.

	* menu-bar.el (menu-bar-file-menu): Add entry for making new
	window on right of selected.  (Bug#9350) Reword other window
	entries and separate them from frame entries.

2011-10-15  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/ert.el (ert--explain-equal-rec, ert-select-tests):
	Doc fixes.

2011-10-15  Chong Yidong  <cyd@stupidchicken.com>

	* net/network-stream.el (network-stream-open-starttls):
	Improve detection of failure due to lack of TLS support.

	* mail/sendmail.el (sendmail-query-once): Tweak prompt message,
	putting the input text in front and in bold.

2011-10-14  Stefan Monnier  <monnier@iro.umontreal.ca>

	* pcmpl-unix.el (pcomplete/ssh): SSH does allow ganging.

	* mpc.el (mpc-songs-jump-to): Don't burp if the user clicks in an
	empty buffer.

	* mouse.el (mouse-drag-mode-line-1): Modify the end-event we pushed on
	unread-command-events rather than pushing yet-another event.

2011-10-14  Eli Zaretskii  <eliz@gnu.org>

	* mail/sendmail.el (sendmail-query-once): Improve the wording of
	the explanation of the possible choices.  Make the options passed
	to completing-read shorter.

2011-10-13  Agustín Martín Domingo  <agustin.martin@hispalinux.es>

	* textmodes/flyspell.el (flyspell-large-region): Make sure
	extended character mode is used if defined (Bug#1339).

2011-10-13  Eli Zaretskii  <eliz@gnu.org>

	* simple.el (what-cursor-position): Fix the display of the
	character info for LRE, LRO, RLE, and RLO characters by appending
	an invisible PDF.

2011-10-13  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/timer.el (with-timeout): Make sure we cancel the timer
	even in case of error; add debug spec; simplify data flow.
	(with-timeout-handler): Remove.

2011-10-12  Michael Albinus  <michael.albinus@gmx.de>

	Fix Bug#6019, Bug#9315.

	* files.el (set-auto-mode): Call `file-name-sans-versions' for the
	complete `buffer-file-name', the local file name part could look
	remotely (for example on VMS).

	* net/ange-ftp.el (ange-ftp-run-real-handler): Make it an alias of
	`tramp-run-real-handler'.
	(ange-ftp-fix-name-for-vms): Handle the case, where `name' is
	already quoted by '"'.

	* net/tramp.el (tramp-rfn-eshadow-update-overlay): Ignore errors.
	Let `file-name-handler-alist' be nil, the local file name part
	could look remotely (for example on VMS).

2011-10-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/flyspell.el (flyspell-word): Move with-local-quit
	from here...
	(flyspell-post-command-hook): ...to here.

2011-10-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* mail/sendmail.el (send-mail-function): Don't use sendmail-query-once
	if not needed.
	(sendmail-query-once): Remove OS dependencies.  Make it a 3-way choice
	using completion.  Protect against "slow" callers.
	Remove the "message hack".

2011-10-11  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-lazy-highlight-word): New variable.
	(isearch-lazy-highlight-new-loop, isearch-lazy-highlight-search):
	Use it.  (Bug#9727)

2011-10-11  Glenn Morris  <rgm@gnu.org>

	* progmodes/f90.el (f90-next-statement): Ignore preprocessor lines,
	like f90-previous-statement does.

2011-10-11  Thierry Volpiatto  <thierry.volpiatto@gmail.com>

	* eshell/eshell.el (eshell-command): History should be saved
	only in interactive use, to avoid error.

2011-10-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuffer.el (completion-file-name-table): Fix last change,
	i.e. ignore normal errors but not the other ones.

2011-10-10  Martin Rudalics  <rudalics@gmx.at>

	* window.el (special-display-buffer-names)
	(special-display-regexps): Remove some remnants of earlier
	changes from doc-strings.
	(quit-windows-on): New function.

	* vc/vc.el (vc-revert, vc-rollback):
	* vc/vc-dispatcher.el (vc-finish-logentry): Call quit-windows-on
	instead of deleting windows.  (Bug#4557) (Bug#5310) (Bug#5556)
	(Bug#6183) (Bug#7074) (Bug#7447)

2011-10-09  Martin Rudalics  <rudalics@gmx.at>

	* window.el (frame-auto-hide-function): Add version tag.
	(Bug#9699)

2011-10-09  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-file-name-handler): Add 'debug to the error
	condition.

2011-10-09  Leo Liu  <sdl.web@gmail.com>

	* mail/smtpmail.el (smtpmail-send-data): Add a missing space.
	(Bug#9701)

2011-10-08  Glenn Morris  <rgm@gnu.org>

	* progmodes/f90.el (f90-calculate-indent): Give preprocessor lines
	before the first code statement zero indent.  (Bug#9690)

2011-10-08  Chong Yidong  <cyd@stupidchicken.com>

	* simple.el (count-words-region): Always count in the region.
	Report the number of lines and characters too.
	(count-words): New command, which counts in the buffer if the
	region is inactive, as count-words-region used to.
	(count-words--message): New function.  Handle plurals.
	(count-lines-region): Make it an alias for count-words-region.

	* bindings.el (esc-map): Replace count-lines-region with
	count-words-region.

2011-10-08  Martin Rudalics  <rudalics@gmx.at>

	* window.el (window--delete): Delete dedicated frame
	unconditionally when argument KILL is non-nil.  (Bug#9699)
	(switch-to-buffer): Fix doc-string typo.

2011-10-08  Thierry Volpiatto  <thierry.volpiatto@gmail.com>

	* eshell/eshell.el (eshell-command): Avoid using hooks.

2011-10-07  Chong Yidong  <cyd@stupidchicken.com>

	* bindings.el ([M-left], [M-right]): Bind to left-word and
	right-word respectively.

2011-10-07  Glenn Morris  <rgm@gnu.org>

	* cus-start.el (debug-on-quit): Fix custom type.

2011-10-06  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* subr.el (define-key-after): Clarify that the function is not
	useful for non-menu keymaps.

	* progmodes/gdb-mi.el (gdb): Fix typo in doc string.

2011-10-06  Thierry Volpiatto  <thierry.volpiatto@gmail.com>

	* eshell/eshell.el (eshell-command): Enable `eshell-mode' only
	in current minibuffer (Fix bug with recursive minibuffers).

2011-10-06  Chong Yidong  <cyd@stupidchicken.com>

	* progmodes/gdb-mi.el (gdb): Doc fix.

2011-10-05  Martin Rudalics  <rudalics@gmx.at>

	* window.el (frame-auto-hide-function): New option replacing
	frame-auto-delete.  Suggested by Stefan Monnier.
	(window--delete): Call frame-auto-hide-function instead of
	investigating frame-auto-delete.
	(window-point-1, set-window-point-1): New functions.
	(window-in-direction, record-window-buffer, window-state-get-1)
	(display-buffer-record-window): Use window-point-1 instead of
	window-point.
	(set-window-buffer-start-and-point): Use set-window-point-1.

2011-10-05  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/edebug.el: Heed checkdoc recommendations.

2011-10-05  Glenn Morris  <rgm@gnu.org>

	* progmodes/perl-mode.el (perl-electric-terminator): Doc fix.
	(perl-calculate-indent): Suppress scan errors.  (Bug#2205)

2011-10-05  Leo Liu  <sdl.web@gmail.com>

	* subr.el (read-char-choice): Fix argument to buffer-live-p which
	works with buffer object.

2011-10-05  Stefan Monnier  <monnier@iro.umontreal.ca>

	* mpc.el (mpc-tool-bar-map): Add labels.

2011-10-04  Glenn Morris  <rgm@gnu.org>

	* calendar/holidays.el (calendar-check-holidays): Doc fix.

2011-10-04  Martin Rudalics  <rudalics@gmx.at>

	* window.el (window--delete): New function.
	(frame-auto-delete): Resuscitate option.
	(bury-buffer, replace-buffer-in-windows)
	(quit-window): Rewrite using window--delete.
	(display-buffer-pop-up-frame, display-buffer-pop-up-window):
	Pass display-buffer-mark-dedicated to window--display-buffer-2
	(Bug#9639).

2011-10-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	* pcmpl-unix.el (pcomplete/scp): Don't assume pcomplete-all-entries
	returns a list (bug#9554).  Add remote file name completion.
	* comint.el (comint--table-subvert): Curry and get quote&unquote
	functions as arguments.
	(comint--complete-file-name-data): Adjust call accordingly.
	* pcomplete.el (pcomplete--table-subvert): Remove.
	(pcomplete-completions-at-point): Use comint--table-subvert instead.

	* minibuffer.el (completion-table-case-fold): Use currying.
	(completion--styles-type, completion--cycling-threshold-type):
	New constants.
	(completion-styles, completion-category-overrides)
	(completion-cycle-threshold): Use them.
	* pcomplete.el (pcomplete-completions-at-point): Adjust call to
	completion-table-case-fold.

2011-10-03  Stephen Berman  <stephen.berman@gmx.net>

	* minibuffer.el (completion-category-overrides): Fix type of styles
	and add more user friendly tags (bug#9660).

2011-10-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	* international/mule-cmds.el: Fix abuses of apply-partially (bug#9661).
	(mule-input-method-string): New widget.
	(default-input-method, language-info-custom-alist): Use it.

2011-10-02  Stefan Monnier  <monnier@iro.umontreal.ca>

	* pcomplete.el: Require comint.
	(pcomplete--common-suffix): Remove.
	(pcomplete--common-quoted-suffix): Use comint--common-suffix instead.
	(pcomplete--table-subvert): Sync with comint--table-subvert.
	(pcomplete--entries): Use comint-completion-file-name-table.
	* comint.el (comint-unquote-filename): Simplify.
	(comint-completion-file-name-table): New function (bug#9616).
	(comint--complete-file-name-data): Use it.

	* pcmpl-gnu.el (pcmpl-gnu-with-file-buffer): New macro (bug#9643).
	(pcmpl-gnu-tar-buffer): Remove.
	(pcmpl-gnu-with-file-buffer): Use it to avoid leaving the tar's buffer
	around.  Make sure pcomplete-suffix-list is only changed temporarily.
	Don't look inside the tar's file if it's too large.

2011-10-01  Chong Yidong  <cyd@stupidchicken.com>

	* cus-edit.el (custom-mode-map):
	* epa.el (epa-key-list-mode-map):
	* man.el (Man-mode-map):
	* startup.el (splash-screen-keymap):
	* simple.el (special-mode-map): Use scroll-up-command and
	scroll-down-command.

	* progmodes/idlw-help.el (idlwave-help-mode-map):
	* progmodes/ebrowse.el (ebrowse-electric-position-mode-map):
	* net/newst-plainview.el (newsticker-mode-map):
	* emulation/ws-mode.el (wordstar-mode-map):
	* emulation/vi.el (vi-com-map):
	* calc/calc-graph.el (calc-graph-show-dumb):
	* term/sun.el (terminal-init-sun):
	* term/ns-win.el (global-map):
	* progmodes/grep.el (grep-mode-map):
	* progmodes/ebrowse.el (ebrowse-electric-list-mode-map):
	* mail/rmail.el (rmail-mode-map):
	* progmodes/cpp.el (cpp-edit-mode-map): Likewise.

	* custom.el (custom-safe-themes, load-theme): Treat value of t for
	custom-safe-themes as special.

2011-10-01  Julien Danjou  <julien@danjou.info>

	* notifications.el (notifications-notify): Fix docstring.

2011-10-01  Per Starbäck  <per@starback.se>

	* pcmpl-gnu.el (pcomplete/tar): Fix tar-header-name call.  (Bug#9643)

2011-09-30  Martin Rudalics  <rudalics@gmx.at>

	* startup.el (command-line-1): Fix last fix by inserting
	initial-scratch-message into *scratch* before displaying it.
	(Bug#9605) and (Bug#9636)

2011-09-29  Eli Zaretskii  <eliz@gnu.org>

	* simple.el (line-move): If auto-hscroll-mode is disabled and the
	window is hscrolled, move by logical lines.  (Bug#9607)
	(line-move-visual): Update the doc string to the above effect.

2011-09-29  Martin Rudalics  <rudalics@gmx.at>

	* window.el (display-buffer-record-window): When WINDOW is the
	selected window use `point' instead of `window-point'.  (Bug#9626)

	* startup.el (command-line-1): Use insert-before-markers when
	inserting initial-scratch-message.  (Bug#9605)

	* help.el (help-window): Remove variable.

2011-09-29  Glenn Morris  <rgm@gnu.org>

	* pcmpl-cvs.el (pcomplete/cvs): Add "status" handler.

2011-09-29  Juanma Barranquero  <lekktu@gmail.com>

	* descr-text.el (describe-char-categories): Accept category
	descriptions more than one line long.

2011-09-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* simple.el (delete-trailing-whitespace): Fix last change.

	* progmodes/perl-mode.el (perl-syntax-propertize-function):
	Don't confuse "y => 3" as the beginning of a `y' operation.

	* emacs-lisp/debug.el (debug-convert-byte-code): Don't assume the
	object has more than 4 slots (bug#9613).

2011-09-28  Juanma Barranquero  <lekktu@gmail.com>

	* subr.el (with-output-to-temp-buffer):
	* net/quickurl.el (quickurl, quickurl-browse-url):
	Fix typos in docstrings.

2011-09-27  Eli Zaretskii  <eliz@gnu.org>

	* minibuffer.el (completion-styles)
	(completion-category-overrides): Cross reference each other in doc
	strings.

2011-09-27  Glenn Morris  <rgm@gnu.org>

	* pcmpl-cvs.el (pcmpl-cvs-entries): Update for Emacs 22.1 changes
	to split-string.  (Bug#9606)

2011-09-27  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* mail/smtpmail.el (smtpmail-via-smtp): Fix STARTTLS detection
	(bug#9615).

2011-09-27  Chong Yidong  <cyd@stupidchicken.com>

	* emacs-lisp/package.el (list-packages): Fix echo area message.

2011-09-27  Leo Liu  <sdl.web@gmail.com>

	* ido.el (ido-read-internal): Accept cons cell HIST arg.

2011-09-25  Michael Albinus  <michael.albinus@gmx.de>

	* net/dbus.el (dbus-unregister-object): Don't release services for
	registered signals.  (Bug#9581)

2011-09-25  Teodor Zlatanov  <tzz@lifelogs.com>

	* progmodes/cfengine.el (cfengine-auto-mode): Add convenience
	function that picks between cfengine 2 and 3 support
	automatically.  Update docs accordingly.

2011-09-22  Kenichi Handa  <handa@m17n.org>

	* language/ind-util.el (indian-tml-base-table): Add TAMIL DIGIT
	ZERO.
	(indian-itrans-v5-table-for-tamil): New variable.
	(indian-tml-itrans-v5-hash): Use the above variable (Bug#9336).

2011-09-22  Ken Manheimer  <ken.manheimer@gmail.com>

	* allout.el (allout-this-command-hid-stuff): Buffer-local variable
	that's true if the current command involved collapsing of text.
	It's reset to false at the beginning of the next command.
	(allout-post-command-business): Move the cursor to the beginning
	of entry if the cursor is hidden and collapsing activity just
	happened.

2011-09-24  Chong Yidong  <cyd@stupidchicken.com>

	* mouse.el (mouse-drag-track): Set scroll-margin to 0 while
	tracking (Bug#9541).

2011-09-24  Ulf Jasper  <ulf.jasper@web.de>

	* net/newst-reader.el (newsticker-html-renderer)
	(newsticker-show-news): Automatically load html rendering package
	if newsticker-html-renderer is set.  Fixes "Warning: defvar ignored
	because w3m-fill-column is let-bound" and the error "Symbol's value
	as variable is void: w3m-fill-column".

2011-09-24  Michael Albinus  <michael.albinus@gmx.de>

	* net/dbus.el (dbus-unregister-object): Remove match rule of signals.
	Release services only if they are defined.  (Bug#9581)

2011-09-23  Richard Stallman  <rms@gnu.org>

	* textmodes/paragraphs.el (forward-sentence): For backwards case,
	distinguish start of paragraph from start of its text.

	* mail/emacsbug.el (report-emacs-bug-query-existing-bugs): Autoload.

	* mail/rmail.el (rmail-view-buffer-kill-buffer-hook): New function.
	(rmail-generate-viewer-buffer): Put that hook on view buffer.
	(rmail-mode-kill-buffer-hook): Override that hook, to kill view buffer.

2011-09-23  Andreas Schwab  <schwab@linux-m68k.org>

	* international/mule-diag.el (mule-diag): Insert a newline after
	each fontset description.

2011-09-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* simple.el (delete-trailing-whitespace):
	Document last change; simplify.

2011-09-23  Peter J. Weisberg  <pj@irregularexpressions.net>

	* simple.el (delete-trailing-whitespace): Also delete
	extra newlines at the end of the buffer.

	* textmodes/picture.el: Make motion commands obey shift-select-mode.
	(picture-newline): Use forward-line so as to ignore fields.

2011-09-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* subr.el (with-wrapper-hook): Fix edebug spec.

2011-09-23  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* simple.el (kill-line): Note effect of `show-trailing-whitespace'
	(bug#4538).

2011-09-23  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-sh.el (tramp-sh-handle-file-name-all-completions):
	Fix nasty bug using wrong cached values.

2011-09-23  Alan Mackenzie  <acm@muc.de>

	* progmodes/cc-defs.el (c-version): Increase to 5.31.9.

2011-09-23  Chong Yidong  <cyd@stupidchicken.com>

	* window.el (pop-to-buffer): Ensure right window is selected if we
	chose another frame.

2011-09-22  Eli Zaretskii  <eliz@gnu.org>

	* simple.el (what-cursor-position): Use get-char-property-change
	and next-single-char-property-change, to be able to show display
	properties that come from overlays as well as text properties.

2011-09-22  Chong Yidong  <cyd@stupidchicken.com>

	* window.el (pop-to-buffer-same-window): New (reinstated) fun.

	* cmuscheme.el (run-scheme, switch-to-scheme):
	* cus-edit.el (customize-group, custom-buffer-create)
	(customize-browse):
	* info.el (info):
	* shell.el (shell):
	* mail/sendmail.el (mail):
	* progmodes/inf-lisp.el (inferior-lisp): Use it (Bug#9532).

2011-09-22  Richard Stallman  <rms@gnu.org>

	* textmodes/paragraphs.el (forward-sentence): When setting PAR-BEG,
	move back only to line beg, don't move back over blank lines.

2011-09-22  Michael Albinus  <michael.albinus@gmx.de>

	* files.el (copy-directory): Set directory attributes only in case
	they could be retrieved from the source directory.  (Bug#9565)

2011-09-22  Dima Kogan  <dkogan@secretsauce.net>  (tiny change)

	* progmodes/hideshow.el (hs-looking-at-block-start-p)
	(hs-find-block-beginning, hs-hide-level-recursive):
	Ignore strings as well as comments.  (Bug#9502)

2011-09-22  Andrew Schein  <andrew@andrewschein.com>  (tiny change)

	* progmodes/sql.el (sql-comint-postgres):
	Convert port number to a string.  (Bug#9566)

2011-09-22  Martin Rudalics  <rudalics@gmx.at>

	* window.el (quit-window): Undedicate window when switching to
	previous buffer.  Reported by Thierry Volpiatto
	<thierry.volpiatto@gmail.com>.
	(special-display-popup-frame): When popping up a new frame reset
	its previous buffers to nil.  Simplify code.

2011-09-21  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-handle-shell-command): Set process sentinel
	and process filter, as done also in `shell-command'.

2011-09-21  Martin Rudalics  <rudalics@gmx.at>

	* window.el (set-window-buffer-start-and-point):
	Call set-window-start with NOFORCE argument t.
	Suggested by Thierry Volpiatto <thierry.volpiatto@gmail.com>.
	(quit-window): Reword doc-string.  Handle new format of
	quit-restore parameter.  Don't delete window if it has a
	previous buffer we can show instead of the present one.
	(display-buffer-record-window): Rewrite using a new format for
	the quit-restore window parameter
	(special-display-popup-frame, display-buffer-same-window)
	(display-buffer-reuse-window, display-buffer-pop-up-frame)
	(display-buffer-pop-up-window, display-buffer-use-some-window):
	Adapt symbol passed to display-buffer-record-window.
	* help.el (help-window-setup): Handle new format of quit-restore
	parameter.

2011-09-21  Stefan Monnier  <monnier@iro.umontreal.ca>

	* faces.el (face-list): Fix docstring (bug#9564).

	* window.el (display-buffer--action-function-custom-type):
	Don't include internal functions in the Custom interface.

2011-09-20  Juri Linkov  <juri@jurta.org>

	* info.el (Info-history-skip-intermediate-nodes): New defcustom.
	(Info-forward-node, Info-backward-node, Info-next-preorder)
	(Info-last-preorder): Use it.  (Bug#9528)

2011-09-20  Juri Linkov  <juri@jurta.org>

	* info.el (Info-last-preorder): Visit last menu item only when
	`Info-scroll-prefer-subnodes' is non-nil (third test-case of bug#9528).

2011-09-20  Julien Danjou  <julien@danjou.info>

	* password-cache.el (password-cache-remove): Remove entries even if the
	value is nil, so that password with a nil value (negative caching) is
	possible to invalidate.

2011-09-20  Lawrence Mitchell  <wence@gmx.li>

	* progmodes/f90.el (f90-break-line): If breaking inside comment delete
	all whitespace around breakpoint.  (Bug#9553)
	(f90-find-breakpoint): Only break at whitespace inside a comment.

2011-09-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuffer.el (completion-file-name-table): Keep track of errors.
	(completion-table-with-predicate): Handle the case where pred1 is nil.
	* pcomplete.el (pcomplete-completions-at-point): Simplify.

2011-09-19  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/debug.el (debugger-args): Give it a docstring.
	(debugger-return-value): Signal an error if the debugging context does
	not await any return value.

	* ps-mule.el (ps-mule-plot-string): Don't inf-loop (bug#5108).
	* image-mode.el (image-toggle-display-text)
	(image-toggle-display-image): Stay away from evil `intangible'.

2011-09-19  Leo Liu  <sdl.web@gmail.com>

	* replace.el (occur-revert-arguments): Make it permanent-local.
	(occur-mode): Don't call font-lock-defontify.

2011-09-19  Chong Yidong  <cyd@stupidchicken.com>

	* net/ldap.el (ldap-search-internal): Don't push empty search
	result (Bug#9508).

2011-09-19  Stefan Monnier  <monnier@iro.umontreal.ca>

	* whitespace.el (whitespace-newline-mode): Disable it right (bug#9550).

2011-09-19  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-sh.el (tramp-inline-compress-commands): Add "xz".
	Suggested by Liam Stitt <stittl@cuug.ab.ca>.

2011-09-18  Juri Linkov  <juri@jurta.org>

	* buff-menu.el (Buffer-menu-mode-map):
	* dired.el (dired-mode-map):
	* emacs-lisp/lisp-mode.el (emacs-lisp-mode-map)
	(lisp-interaction-mode-map):
	* emacs-lisp/package.el (package-menu-mode-map):
	* epa.el (epa-key-list-mode-map):
	* menu-bar.el (menu-bar-showhide-tool-bar-menu)
	(menu-bar-options-menu):
	* outline.el (outline-mode-menu-bar-map):
	* vc/vc-bzr.el (vc-bzr-shelve-menu-map, vc-bzr-extra-menu-map):
	* vc/vc-dir.el (vc-dir-menu-map):
	* vc/vc-git.el (vc-git-stash-menu-map, vc-git-extra-menu-map):
	Capitalize non-function content words in menu item strings.

	* dired.el (dired-mode-map): Add menu item for
	`image-dired-dired-toggle-marked-thumbs'.

2011-09-18  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-edit-string): Bind `isearch-new-case-fold'
	to `isearch-case-fold-search' and restore its original value
	after the `isearch-mode' call.

2011-09-18  Juri Linkov  <juri@jurta.org>

	* progmodes/grep.el (grep-process-setup): Don't check code for 1
	because `zgrep' returns 1 for successful matches (bug#9226).

2011-09-18  Juri Linkov  <juri@jurta.org>

	* info.el (Info-extract-menu-node-name): Check the second match
	for empty string (second test-case of bug#9528).
	(Info-last-preorder): Let-bind `Info-history' to nil to not add
	intermediate nodes to the history (first test-case of bug#9528).

2011-09-18  Juri Linkov  <juri@jurta.org>

	* info.el (Info-mode-syntax-table): New variable.
	(Info-mode): Set `:syntax-table' to `Info-mode-syntax-table' (bug#3312).

2011-09-18  Juri Linkov  <juri@jurta.org>

	* info.el (Info-file-supports-index-cookies):
	Increment line-beginning-position's arg from 3 to 4 because makeinfo
	outputs one more line for long file names (bug#4142).

2011-09-18  Chong Yidong  <cyd@stupidchicken.com>

	* newcomment.el (comment-normalize-vars): If prompting for
	comment-start, set comment-start-skip too (Bug#8424).

2011-09-18  Johan Bockgård  <bojohan@gnu.org>

	* icomplete.el: Fix previous fix of Bug#5849.
	(icomplete-mode): Don't set completion-show-inline-help.
	(icomplete-minibuffer-setup): Set completion-show-inline-help
	locally during icompletion.

2011-09-18  Chong Yidong  <cyd@stupidchicken.com>

	* woman.el (woman2-process-escapes): Don't delete unrecognized
	escapes (Bug#7843).

	* files.el (inhibit-first-line-modes-regexps): Add image files.
	(hack-local-variables-prop-line): Return nil for malformed
	prop-lines (Bug#9044).

2011-09-18  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (top): Don't require 'shell.
	(tramp-methods): Fix docstring.
	(tramp-get-remote-tmpdir): New defun, moved from tramp-sh.el.
	Return complete remote file name.  Handle "smb" case.
	Use `tramp-tmpdir', if defined for the respective method.
	(tramp-make-tramp-temp-file): Adapt call of `tramp-get-remote-tmpdir'.

	* net/tramp-compat.el (top): Require 'shell.

	* net/tramp-sh.el (tramp-do-copy-or-rename-file-out-of-band)
	(tramp-maybe-open-connection): Use `tramp-file-name-real-host' for
	`tramp-current-host'.
	(tramp-get-remote-tmpdir): Remove.

	* net/tramp-smb.el (tramp-methods): Add `tramp-remote-shell' and
	`tramp-tmpdir' entries.
	(tramp-smb-errors): Add "NT_STATUS_IMAGE_ALREADY_LOADED".
	(tramp-smb-handle-file-attributes): Ignore errors.
	(tramp-smb-wait-for-output): Check also for process end.

2011-09-18  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* mail/smtpmail.el (smtpmail-via-smtp): Ignore errors that arise
	when sending QUIT (bug#9312).

2011-09-17  Chong Yidong  <cyd@stupidchicken.com>

	* replace.el (occur-mode-map): Rebind occur-edit-mode to "e" (Bug#8463).
	(occur-edit-mode-map): Bind C-c C-c to occur-cease-edit and C-o to
	occur-mode-display-occurrence.
	(occur-edit-mode): Add usage message.
	(occur-cease-edit): New command.
	(occur-after-change-function): Use text properties to find the
	position of the prefix text.
	(occur-engine): Set stickiness of prefix text properties.

2011-09-17  Glenn Morris  <rgm@gnu.org>

	* progmodes/etags.el (complete-tag):
	Fix call to completion-in-region.  (Bug#9526)

2011-09-17  Juri Linkov  <juri@jurta.org>

	* textmodes/ispell.el (ispell-word): Add to the error message
	the word, ispell program name and current dictionary (bug#9121).
	(ispell-tex-arg-end): Capitalize "error" in the error message.

2011-09-17  Andreas Schwab  <schwab@linux-m68k.org>

	* emacs-lisp/bytecomp.el (byte-compile-lapcode): Fix overflow
	check.  (Bug#4251)

2011-09-17  Juri Linkov  <juri@jurta.org>

	* window.el (window-safe-min-height, window-safe-min-width):
	Fix typos (followup to bug#9522).

2011-09-17  Sven Joachim  <svenjoac@gmx.de>

	* window.el (window-min-width, window-state-put): Fix typos (bug#9522).

2011-09-16  Eli Zaretskii  <eliz@gnu.org>

	* simple.el (line-move): If goal-column is set, move by logical
	lines, not by display lines.  (Bug#971)
	(next-line, previous-line, goal-column, line-move-visual): Doc fix
	to reflect the above change.

2011-09-16  Stefan Monnier  <monnier@iro.umontreal.ca>

	* image.el (imagemagick-register-types): Use regexp-opt.

2011-09-15  Chong Yidong  <cyd@stupidchicken.com>

	* window.el (display-buffer-base-action): Rename from
	display-buffer-default-action.  Make default value empty.
	(display-buffer-overriding-action): Convert to defvar.
	(display-buffer-fallback-action): New var.

2011-09-15  Chong Yidong  <cyd@stupidchicken.com>

	* emacs-lisp/package.el (package-alist): Fix risky-local-variable
	declaration.
	(package--add-to-archive-contents): If there is a duplicate entry
	with an older version, remove it.
	(package-menu-mark-delete, package-menu-mark-install)
	(package-menu-mark-unmark): Make unused args optional.
	(package-menu-mark-obsolete-for-deletion):
	Use package-menu-get-status instead of a regexp search.
	(package-menu-get-status): Use tabulated-list-entry.
	(package-menu-mark-upgrades): New command.
	(package-menu-mode-map): Bind it to U.  Add it to menu bar.
	(package-menu-execute): Do installation before deletion.
	(package-menu-refresh, package-menu-execute): Use derived-mode-p
	instead of checking major-mode.
	(package-menu--find-upgrades): New function.

2011-09-14  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* mail/smtpmail.el (smtpmail-send-command): Don't include AUTH
	passwords in the log buffer.
	(smtpmail-process-filter): Update the process marker so that the
	"broken by peer" status message is inserted in the right place.

2011-09-14  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/bibtex.el (bibtex-complete-string-cleanup)
	(bibtex-complete-crossref-cleanup): Adjust to accommodate needs of
	bibtex-completion-at-point-function.
	(bibtex-completion-at-point-function): Use them.

	* newcomment.el (comment-add, comment-valid-prefix-p): Docfix.

	* mpc.el (mpc-constraints-tag-lookup): New function.
	(mpc-constraints-restore): Use it to make jumping to "album=Foo" apply
	also to browser "album|playlist".

2011-09-14  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-fail-pos): Add new arg `msg'.  Doc fix.
	(isearch-edit-string): Use length of `isearch-string' when
	`isearch-fail-pos' returns nil.
	(isearch-message): Remove duplicate code and call
	`isearch-fail-pos' with arg `t'.

2011-09-14  Chong Yidong  <cyd@stupidchicken.com>

	* replace.el (occur-mode-goto-occurrence): Don't force using other
	window (Bug#9499).

	* dired-aux.el (dired-do-chmod): Don't provide initial input.

2011-09-14  Martin Rudalics  <rudalics@gmx.at>

	* window.el (display-buffer-window): Remove.
	(display-buffer-record-window): Use help-setup window parameter
	instead of variable display-buffer-window.
	(display-buffer-function, special-display-buffer-names)
	(special-display-function): Mention help-setup parameter instead
	of display-buffer-window in doc-string.
	* help.el (help-window-setup): New argument help-window.
	Use help-window-setup parameter instead of display-buffer-window.
	Reword some messages.
	(with-help-window): Pass window used for displaying the buffer
	to help-window-setup.  Don't set display-buffer-window.

2011-09-13  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/debug.el (debugger-make-xrefs):
	Preserve point.  (Bug#9462)

2011-09-13  Chong Yidong  <cyd@stupidchicken.com>

	* window.el (window-deletable-p): Use next-frame.

2011-09-13  Martin Rudalics  <rudalics@gmx.at>

	* window.el (window-auto-delete): Remove.
	(window-deletable-p): Remove argument FORCE.  Don't deal with
	dedication and previous buffers.
	(switch-to-prev-buffer): Don't delete window.
	(delete-windows-on): Delete a window's frame if and only if the
	window is dedicated.
	(replace-buffer-in-windows): Delete buffer's window or frame if
	and only if window is dedicated.
	(quit-window): Handle quit-restore as before last change.
	(bury-buffer): Delete window only if window-deletable-p returns t.

2011-09-13  Chong Yidong  <cyd@stupidchicken.com>

	* window.el (window-deletable-p): Never delete the last frame on a
	given terminal.

2011-09-13  Glenn Morris  <rgm@gnu.org>

	* help.el (describe-key-briefly): Copy previous standard-output change.

2011-09-13  PJ Weisberg  <pj@irregularexpressions.net>

	* help.el (where-is): Respect non-standard standard-output.  (Bug#9030)

2011-09-13  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/lisp-mode.el (lisp-indent-function):
	* progmodes/scheme.el (scheme-indent-function): Doc fixes.

2011-09-12  Chong Yidong  <cyd@stupidchicken.com>

	* dired-aux.el (dired-mark-read-string): Don't return default
	value on empty input (Bug#9361).
	(dired-do-chxxx): Treat empty input for "touch" as no -t option.
	Omit initial minibuffer contents.
	(dired-do-chmod): Signal an error on empty input.
	(dired-mark-read-string): Don't return default on empty input.

	* files.el (file-modes-symbolic-to-number): Doc fix.

2011-09-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* international/mule-cmds.el (ucs-completions): Remove.
	(read-char-by-name): Use complete-with-action instead; add metadata.

2011-09-11  Chong Yidong  <cyd@stupidchicken.com>

	* window.el (display-buffer--action-function-custom-type)
	(display-buffer--action-custom-type): New vars.
	(display-buffer-alist, display-buffer-default-action)
	(display-buffer-overriding-action): Add defcustom types.

	* frame.el (delete-other-frames): Doc fix (Bug#276).

2011-09-11  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* play/doctor.el (make-doctor-variables): Define `doctor-sent'.

2011-09-11  Chong Yidong  <cyd@stupidchicken.com>

	Change modes that used same-window-* vars to use switch-to-buffer.

	* progmodes/gdb-mi.el (gdb-restore-windows, gdb-setup-windows):
	Use switch-to-buffer.

	* cus-edit.el (customize-group, custom-buffer-create)
	(customize-browse, custom-buffer-create-other-window):
	Use switch-to-buffer or switch-to-buffer-other-window.

	* info.el (info, Info-find-node, Info-revert-find-node, Info-next)
	(Info-prev, Info-up, Info-speedbar-goto-node)
	(info-display-manual): Use switch-to-buffer.
	(Info-speedbar-goto-node): Use switch-to-buffer-other-frame.

	* mail/sendmail.el (mail): Use switch-to-buffer.
	(mail-recover): Use switch-to-buffer-other-window.

	* cmuscheme.el (run-scheme, switch-to-scheme):
	* ielm.el (ielm):
	* shell.el (shell):
	* net/rlogin.el (rlogin):
	* net/telnet.el (telnet, rsh):
	* progmodes/inf-lisp.el (inferior-lisp): Use switch-to-buffer.

2011-09-11  Andreas Schwab  <schwab@linux-m68k.org>

	* dired.el (dired-sort-toggle-or-edit): Revert last changes.

2011-09-11  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* dired.el (dired-sort-toggle-or-edit): -o doesn't exist on *BSD,
	so don't mention it (bug#9301).
	(dired-sort-toggle-or-edit): Clarify string further.

	* faces.el (face-spec-set-match-display): Make `(type graphic)'
	match `x', `w32' and `ns', like the manual says (bug#9029).

	* subr.el (eval-after-load): Doc string clarification (bug#9125).
	(process-kill-buffer-query-function): Mention the buffer name in
	the query.

	* image-mode.el (image-next-line): The line parameter is mandatory
	(bug#9258).

	* dired.el (dired-sort-toggle-or-edit): Mention -o and -g, too,
	which can be useful (bug#9301).

	* textmodes/flyspell.el: Remove obsolete comment (bug#9368).

	* subr.el (match-string): Mention that the current buffer should
	be the same as the search was done in (bug#9282).

	* facemenu.el: Disable the remove-* commands if the mark isn't
	active (bug#9162).

2011-09-10  Chong Yidong  <cyd@stupidchicken.com>

	* buff-menu.el (Buffer-menu-switch-other-window): Use second arg
	of display-buffer.
	(Buffer-menu-2-window): Use switch-to-buffer-other-window.

	* replace.el (occur-mode-goto-occurrence)
	(occur-mode-display-occurrence) Use second arg of pop-to-buffer
	and display-buffer.

	* mail/reporter.el (reporter-submit-bug-report): Use second arg of
	display-buffer.

	* mail/sendmail.el (sendmail-user-agent-compose): Don't bind the
	special-display and same-window variables.
	(mail-other-window): Use switch-to-buffer-other-window.
	(mail-other-frame): USe switch-to-buffer-other-frame.

	* progmodes/gdb-mi.el (gdb-frame-gdb-buffer):
	Use display-buffer-other-frame.
	(gdb-display-gdb-buffer): Use pop-to-buffer.

	* progmodes/gud.el (gud-goto-info): Use info-other-window.

	* progmodes/python.el: Don't set same-window-buffer-names.

	* textmodes/bibtex.el (bibtex-search-entry): Use switch-to-buffer.

	* window.el (display-buffer-alist): Add *Python*.

2011-09-10  Chong Yidong  <cyd@stupidchicken.com>

	* window.el (display-buffer-alist): Add entry for buffers
	previously handled same-window-*.
	(display-buffer-alist, display-buffer-default-action)
	(display-buffer-overriding-action): Mark as risky.
	(display-buffer-alist): Document action function changes.
	(display-buffer--same-window-action)
	(display-buffer--other-frame-action): New variables.
	(switch-to-buffer, display-buffer-other-frame): Use them.
	(display-buffer): Rename reuse-frame entry to reusable-frames.
	(display-buffer-reuse-selected-window): Function deleted.
	(display-buffer-reuse-window): Handle reusable-frames alist entry.
	If it's omitted, check pop-up-frames/display-buffer-reuse-frames.
	(display-buffer-special): New function.
	(display-buffer--maybe-pop-up-frame-or-window): Rename from
	display-buffer-reuse-or-pop-window.  Split off special-display
	part into display-buffer-special.
	(display-buffer-use-some-window): Don't perform any special
	pop-up-frames handling.
	(pop-to-buffer): Use window-normalize-buffer-to-switch-to.
	(display-buffer--maybe-same-window): Rename from
	display-buffer-maybe-same-window.

	* info.el: Don't set same-window-regexps.
	(info-setup): New function.
	(info-other-window, info): Call it.

	* cus-edit.el: Don't set same-window-regexps.
	(customize-group): New argument.
	(customize-group-other-window): Use it.
	(customize-face, customize-face-other-window): Likewise.
	(custom-buffer-create-other-window): Use pop-to-buffer directly.

	* net/rlogin.el:
	* net/telnet.el:
	* progmodes/gud.el: Don't set same-window-regexps.

	* cmuscheme.el:
	* ielm.el:
	* shell.el:
	* mail/sendmail.el:
	* progmodes/inf-lisp.el: Don't set same-window-buffer-names.

2011-09-10  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-edit-string): Remove obsolete mention of
	`C-w' (`isearch-yank-word-or-char') from docstring.
	(isearch-query-replace): Fix typo in docstring (bug#9466).

2011-09-10  Juri Linkov  <juri@jurta.org>

	* paren.el (show-paren-function): Don't show escaped parens.
	Let-bind `unescaped' to `t' when paren is not escaped.  (Bug#9461)

2011-09-10  Eli Zaretskii  <eliz@gnu.org>

	* mail/sendmail.el (mml-to-mime, mml-attach-file)
	(mm-default-file-encoding): Remove autoload forms, they are
	replaced with autoload cookies in mml.el and mm-encode.el.
	(mail-add-attachment): New command.
	(mail-mode-map): Add a menu-bar item for mail-add-attachment.
	(mail-mode): Mention mail-insert-file and mail-add-attachment in
	the doc string.
	(mml-to-mime, mml-attach-file, mm-default-file-encoding): Declare.

2011-09-10  Reuben Thomas  <rrt@sc3d.org>

	* simple.el (count-words-region): Use buffer if there's no region
	(bug#9429).

2011-09-09  Juri Linkov  <juri@jurta.org>

	* wdired.el (wdired-change-to-wdired-mode): Set buffer-local
	`isearch-filter-predicate' to `wdired-isearch-filter-read-only'.
	(wdired-isearch-filter-read-only): New function.  (Bug#6362)

2011-09-09  Alan Mackenzie  <acm@muc.de>

	* progmodes/cc-mode.el (awk-mode): Prevent `define-derived-mode'
	spuriously generating `awk-mode-syntax-table'.  (Bug #9448).

2011-09-09  Eli Zaretskii  <eliz@gnu.org>

	Fix for Savannah bug#9392.
	* simple.el (mail-encode-mml): New defvar.

	* mail/rmail.el (mail-encode-mml): Add a defvar.
	(rmail-enable-mime-composing): Default to t.
	(rmail-forward): Use MIME method of forwarding only if both
	rmail-enable-mime-composing and rmail-enable-mime are non-nil.
	Set mail-encode-mml non-nil if the MIME method was used.

	* mail/sendmail.el (mml-to-mime): Add autoload form.
	(mail-encode-mml): Add a defvar.
	(mail-mode): Make mail-encode-mml buffer-local and initialize it
	to nil.
	(mail-send): If mail-encode-mml is non-nil, run the outgoing
	message through mml-to-mime, and reset mail-encode-mml to nil.

2011-09-09  Glenn Morris  <rgm@gnu.org>

	* woman.el (woman-if-body): When processing an .el block,
	do not delete the next .el block as well.  (Bug#9447)
	(woman-special-characters): Add oq, cq, and hy characters.

2011-09-08  Martin Rudalics  <rudalics@gmx.at>

	* window.el (window-deletable-p): Make sure window is live before
	invoking window-prev-buffers.

2011-09-08  Leo Liu  <sdl.web@gmail.com>

	* net/rcirc.el (rcirc-cmd-invite): New rcirc command.  (Bug#9453)

2011-09-08  Juri Linkov  <juri@jurta.org>

	* progmodes/compile.el (compilation-environment): Make it
	a defcustom (bug#8340).

2011-09-08  Martin Rudalics  <rudalics@gmx.at>

	* window.el (frame-auto-delete): Rename to window-auto-delete.
	Make it control auto-deletion of windows and/or frames.
	(window-deletable-p): New argument FORCE.  Rewrite conditions
	for deleting window/frame.  (Bug#9419)
	(switch-to-prev-buffer, replace-buffer-in-windows, quit-window):
	Rewrite handling of case when window/frame can be deleted.
	(delete-windows-on): Call window-deletable-p with new FORCE
	argument t.  (Bug#9456)

2011-09-07  Chong Yidong  <cyd@stupidchicken.com>

	* help-mode.el (help-mode): Restore autoload.

2011-09-07  Juri Linkov  <juri@jurta.org>

	* progmodes/compile.el (compilation-start): Let-bind `thisenv' to
	`compilation-environment'.  Set buffer-local
	`compilation-environment' to `thisenv' later after (funcall mode).
	(Bug#8340)

	* vc/vc-git.el (vc-git-grep): Remove --no-color.  (Bug#9408)
	(vc-git-grep): Prepend "PAGER=" to `compilation-environment'
	instead of replacing its value.  (Bug#8340)

2011-09-07  Juri Linkov  <juri@jurta.org>

	* progmodes/grep.el (grep-regexp-alist): Calculate column positions
	based on text properties put by `grep-filter' instead of matching
	escape sequences.
	(grep-mode): Set buffer-local `compilation-error-screen-columns'
	to the value of `grep-error-screen-columns' (bug#9438).

2011-09-07  Juri Linkov  <juri@jurta.org>

	* simple.el (next-error-highlight, next-error-highlight-no-select):
	Doc fix (bug#9432).

2011-09-07  OKAZAKI Tetsurou  <okazaki.tetsurou@gmail.com>  (tiny change)

	* progmodes/cc-fonts.el (c-font-lock-enclosing-decls):
	Check for null c-opt-block-decls-with-vars-key.  (Bug#9443)

2011-09-07  Leo Liu  <sdl.web@gmail.com>

	* net/rcirc.el (rcirc-mode): Conditionally initialize
	rcirc-input-ring.

2011-09-07  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/find-func.el (find-function-C-source): Only set
	find-function-C-source-directory after checking that we found a source
	file there (bug#9440).

2011-09-06  Alan Mackenzie  <acm@muc.de>

	* isearch.el (isearch-other-meta-char): Wherever a key list is
	unread, "unread" the prefix arg, too.  This fixes bug #8901.

2011-09-05  Oleksandr Gavenko  <gavenkoa@gmail.com>  (tiny change)

	* progmodes/grep.el (rgrep): Add "-type d" (bug#9414).

2011-09-05  Juri Linkov  <juri@jurta.org>

	* progmodes/grep.el (grep-process-setup): Fix comments (bug#8084).

2011-09-05  Juri Linkov  <juri@jurta.org>

	* progmodes/grep.el (grep-filter): Avoid incomplete processing by
	keeping point where processing of grep matches begins, and
	continue to delete remaining escape sequences from the same point.
	(grep-filter): Make leading zero optional in "0?1;31m" because
	git-grep emits "\033[1;31m" escape sequences unlike expected
	"\033[01;31m" as GNU Grep does (bug#9408).
	(grep-process-setup): Replace obsolete "ml=" with newer "sl=".

2011-09-05  Juri Linkov  <juri@jurta.org>

	* subr.el (y-or-n-p): Capitalize "yes".

2011-09-04  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (top): Require 'shell.  Use `tramp-unload-hook' but
	`tramp-cache-unload-hook' where appropriate.
	(tramp-methods): Rename `tramp-remote-sh' to
	`tramp-remote-shell'.  Add `tramp-remote-shell-args'.
	(tramp-handle-shell-command): New defun, moved from tramp-sh.el.

	* net/tramp-sh.el (top): Don't require 'shell.
	(tramp-methods): Add `tramp-remote-shell' and
	`tramp-remote-shell-args' entries.
	(tramp-sh-file-name-handler-alist): Use `tramp-handle-shell-command'.
	(tramp-sh-handle-shell-command): Remove.
	(tramp-find-shell, tramp-open-connection-setup-interactive-shell):
	Use `tramp-remote-shell'.

2011-09-03  Chong Yidong  <cyd@stupidchicken.com>

	* mail/sendmail.el (sendmail-query-once-function): Delete.
	(sendmail-query-once): Save directly to send-mail-function.
	Update message-send-mail-function too.

	* mail/smtpmail.el (smtpmail-try-auth-methods): Clarify prompt.

2011-09-03  Christoph Scholtes  <cschol2112@googlemail.com>

	* progmodes/python.el (python-mode-map): Use correct function to
	start python interpreter from menu-bar (as reported by Geert
	Kloosterman).
	(inferior-python-mode-map): Fix typo.
	(python-shell-map): Remove.

2011-09-03  Deniz Dogan  <deniz@dogan.se>

	* net/rcirc.el (rcirc-print): Simplify code for
	rcirc-scroll-show-maximum-output.  There is no need to walk
	through all windows to find the right one.

2011-09-03  Christoph Scholtes  <cschol2112@googlemail.com>

	* help.el (help-return-method): Doc fix.

2011-09-03  Martin Rudalics  <rudalics@gmx.at>

	* window.el (window-deletable-p): Don't return a non-nil value
	when there's a buffer that was shown in the window before.
	(Bug#9419)
	(display-buffer-pop-up-frame, display-buffer-pop-up-window):
	Set window's previous buffers to nil.

2011-09-03  Eli Zaretskii  <eliz@gnu.org>

	* mail/rmailmm.el (rmail-mime-insert-tagline): Insert an extra
	newline before and after the tag line, so it doesn't interfere
	with determining the paragraph direction of bidirectional text.

2011-09-03  Leo Liu  <sdl.web@gmail.com>

	* files.el (find-file-not-true-dirname-list): Remove.  (Bug#9422)

2011-09-02  Chong Yidong  <cyd@stupidchicken.com>

	* window.el (pop-to-buffer-1, pop-to-buffer-same-window): Delete.
	(pop-to-buffer): Change interactive spec.  Pass second argument
	directly to display-buffer.
	(display-buffer): Fix interactive spec.  Use functionp to
	distinguish between a function and a list of functions.

	* abbrev.el (edit-abbrevs):
	* arc-mode.el (archive-extract):
	* autoinsert.el (auto-insert):
	* bookmark.el (bookmark-bmenu-list):
	* files.el (find-file):
	* view.el (view-buffer):
	* progmodes/compile.el (compilation-goto-locus):
	* textmodes/bibtex.el (bibtex-initialize): Use switch-to-buffer.

2011-09-02  Chong Yidong  <cyd@stupidchicken.com>

	* window.el (display-buffer-alist): Doc fix.
	(display-buffer): Add docstring.  Don't treat
	display-buffer-default specially.
	(display-buffer-reuse-selected-window)
	(display-buffer-same-window, display-buffer-maybe-same-window)
	(display-buffer-reuse-window, display-buffer-pop-up-frame)
	(display-buffer-pop-up-window)
	(display-buffer-reuse-or-pop-window)
	(display-buffer-use-some-window): New functions.
	(display-buffer-default-action): Use them.
	(display-buffer-default): Delete.
	(pop-to-buffer-1): Fix choice of actions.

2011-09-02  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuffer.el (completion--insert-strings): Don't get confused by
	completion entries that end with an LF char.

2011-09-01  Eli Zaretskii  <eliz@gnu.org>

	* window.el (frame-auto-delete, window-deletable-p): Doc fix.

2011-09-01  Chong Yidong  <cyd@stupidchicken.com>

	* window.el (display-buffer): Restore interactive spec.
	(display-buffer-same-window, display-buffer-other-window):
	New functions.
	(pop-to-buffer-1): New function.  Use the above.
	(pop-to-buffer, pop-to-buffer-same-window): Use it.
	(pop-to-buffer-other-window, pop-to-buffer-other-frame): Delete.

	* view.el (view-buffer-other-window, view-buffer-other-frame):
	Just use pop-to-buffer.

2011-09-01  Thierry Volpiatto  <thierry.volpiatto@gmail.com>

	* vc/vc-rcs.el (vc-rcs-responsible-p): Handle directories.  (Bug#9391)

2011-09-01  Wilfred Hughes  <wilfred@potatolondon.com>  (tiny change)

	* vc/vc-git.el (vc-git-grep): Use --no-color.  (Bug#9408)

2011-08-31  Richard Stallman  <rms@gnu.org>

	* mail/rmail.el (rmail-epa-decrypt): Rewrite to take account
	of the separation of rmail-view-buffer from rmail-buffer.
	If you say no to "replace original", the decrypt is in the
	view buffer.  If you say yes, the decrypt goes into the
	rmail buffer also.

2011-08-31  Martin Rudalics  <rudalics@gmx.at>

	* window.el (display-buffer-window): Rewrite doc-string.
	(display-buffer-record-window): New function.
	(display-buffer-macro-specifiers)
	(display-buffer-even-window-sizes, display-buffer-set-height)
	(display-buffer-set-width, display-buffer-in-window)
	(display-buffer-reuse-window, display-buffer-split-specifiers)
	(display-buffer-side-specifiers, display-buffer-split-window-1)
	(display-buffer-split-window, display-buffer-split-atom-window)
	(display-buffer-pop-up-window, display-buffer-pop-up-frame)
	(display-buffer-pop-up-side-window, display-buffer-in-side-window)
	(display-buffer-other-window-means-other-frame)
	(display-buffer-normalize-special)
	(display-buffer-normalize-default)
	(display-buffer-normalize-argument)
	(display-buffer-normalize-alist-1, display-buffer-normalize-alist)
	(display-buffer-normalize-specifiers, display-buffer-frame)
	(display-buffer-same-window, display-buffer-same-frame)
	(display-buffer-other-window)
	(display-buffer-same-frame-other-window)
	(display-buffer-other-frame, pop-to-buffer-same-window)
	(pop-to-buffer-same-frame, pop-to-buffer-other-window)
	(pop-to-buffer-same-frame-other-window, pop-to-buffer-other-frame)
	(switch-to-buffer-same-frame)
	(switch-to-buffer-other-window-same-frame)
	(display-buffer-alist-of-strings-p, display-buffer-alist-add)
	(display-buffer-alist-set-1, display-buffer-alist-set-2)
	(display-buffer-alist-set): Remove.
	(display-buffer-function, special-display-buffer-names)
	(special-display-regexps, special-display-function):
	In doc-string refer to display-buffer-window and quit-restore
	parameter.
	(pop-up-frame-alist, pop-up-frame-function, special-display-p)
	(special-display-frame-alist, special-display-popup-frame)
	(same-window-buffer-names, same-window-regexps, same-window-p)
	(pop-up-frames, display-buffer-reuse-frames, pop-up-windows)
	(split-window-preferred-function, split-height-threshold)
	(split-width-threshold, window-splittable-p)
	(split-window-sensibly, window--try-to-split-window)
	(window--frame-usable-p, even-window-heights)
	(window--even-window-heights, window--display-buffer-1)
	(window--display-buffer-2, display-buffer-other-frame):
	Restore old Emacs 23 code, order and doc-strings where applicable.
	(display-buffer-default, display-buffer-assq-regexp): New functions.
	(display-buffer-alist): Rewrite doc-string.
	(display-buffer-default-action)
	(display-buffer-overriding-action): New variables.
	(display-buffer, switch-to-buffer): Rewrite.
	(pop-to-buffer): Restore Emacs 23 behavior but use
	window-normalize-buffer-to-display.
	(switch-to-buffer-other-window, switch-to-buffer-other-frame):
	Restore Emacs 23 behavior but use
	window-normalize-buffer-to-switch-to.
	(pop-to-buffer-same-window): Rewrite.
	(pop-to-buffer-other-window, pop-to-buffer-other-frame):
	Rewrite using Emacs 23 options.

2011-08-31  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-root-regexp): Remove.
	(tramp-completion-file-name-regexp-unified)
	(tramp-completion-file-name-regexp-separate)
	(tramp-completion-file-name-regexp-url): Don't use leading volume
	letter on w32 systems.  (Bug#5303, Bug#9311)
	(tramp-drop-volume-letter): Simplify definition.
	Suggested by Stefan Monnier <monnier@iro.umontreal.ca>.

2011-08-30  Stefan Monnier  <monnier@iro.umontreal.ca>

	* subr.el (event-modifiers): Fix "missing modifier" part of docstring
	(bug#9356).

2011-08-30  Reuben Thomas  <rrt@sc3d.org>  (tiny change)

	* vc/pcvs-defs.el (cvs-find-file-and-jump): Docstring typo (bug#9369).

2011-08-29  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-done): Don't display message "Mark saved"
	when arg `edit' is non-nil to prevent its flicker in the echo area.

2011-08-28  Chong Yidong  <cyd@stupidchicken.com>

	* emacs-lisp/package.el (package-menu-mark-delete): Allow marking
	obsolete packages for deletion.

2011-08-28  Christoph Scholtes  <cschol2112@googlemail.com>

	* help-mode.el (help-mode-map): Add special-mode-map to parent.
	(help-mode): Derive help-mode from special-mode.  Don't invoke
	view-mode from help-mode.
	(help-xref-override-view-map): Remove.
	(help-make-xrefs): Remove minor-mode-overriding-map-alist since
	view-mode is not used anymore.

2011-08-28  Chong Yidong  <cyd@stupidchicken.com>

	* server.el (server-port): Doc fix.

	* cus-theme.el (custom-theme-choose-mode): Inherit from
	special-mode (Bug#9124).
	(custom-theme-choose-mode-map): Add special-mode to parent.

2011-08-28  Alan Mackenzie  <acm@muc.de>

	* progmodes/cc-fonts.el
	(c-make-font-lock-BO-decl-search-function): New function.
	(c-basic-matchers-after - "Fontify the clauses after various
	keywords"): Extract the three keyword lists for the 3 erroneous
	constructs from the list of four, and use the new function above
	in place of an old one.

2011-08-28  Deniz Dogan  <deniz@dogan.se>

	* net/rcirc.el (rcirc-insert-prev-input)
	(rcirc-insert-next-input): Remove unused argument.

2011-08-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* shell.el (shell-parse-pcomplete-arguments): Unquote args (bug#9160).

2011-08-27  Alan Mackenzie  <acm@muc.de>

	* progmodes/cc-menus.el (cc-imenu-c++-generic-expression): Make it
	handle function pointer parameters properly.

2011-08-27  Martin Rudalics  <rudalics@gmx.at>

	* window.el (display-buffer-reuse-window): Fix case where
	selected window was reused with non-nil OTHER-WINDOW argument.
	(Bug#9381)

2011-08-27  Deniz Dogan  <deniz@dogan.se>

	* net/rcirc.el (rcirc-check-auth-status): Adding support for
	oftc's NickServ messages.

2011-08-27  Glenn Morris  <rgm@gnu.org>

	* saveplace.el (save-place-limit): Make it finite.  (Bug#9352)

2011-08-26  Chong Yidong  <cyd@stupidchicken.com>

	* emacs-lisp/package.el (package-install): Call package-initialize
	if called interactively.

2011-08-26  Leo Liu  <sdl.web@gmail.com>

	* emacs-lisp/cl-macs.el (defstruct): Fix format.  (Bug#9357)

2011-08-25  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-occur): Let-bind `search-spaces-regexp' to
	`search-whitespace-regexp' (bug#9364).

2011-08-25  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-edit-string): Let-bind `search-ring' and
	`regexp-search-ring' to their global values to protect from
	updating by `read-from-minibuffer' (bug#9185).

2011-08-25  Juri Linkov  <juri@jurta.org>

	* textmodes/ispell.el (ispell-command-loop): Add newline
	at the end of the "Use option `i'..." line.

2011-08-25  Juri Linkov  <juri@jurta.org>

	* battery.el (display-battery-mode): If `battery-status-function'
	or `battery-mode-line-format' is nil, display the message and set
	`display-battery-mode' to nil (bug#9363).

2011-08-25  Eli Zaretskii  <eliz@gnu.org>

	* buff-menu.el (Buffer-menu-buffer+size): Remove calls to
	bidi-string-mark-left-to-right; they are unnecessary now.

2011-08-25  Deniz Dogan  <deniz@dogan.se>

	* net/quickurl.el: Documentation typo fixes.

2011-08-25  Chong Yidong  <cyd@stupidchicken.com>

	* window.el (bury-buffer, quit-window): Use bury-buffer-internal.

2011-08-25  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/derived.el (define-derived-mode): Doc fix.

	* mail/smtpmail.el (smtpmail-smtp-user): Add version: tag.
	(smtpmail-via-smtp): Handle nil response from smtp.

2011-08-24  Juri Linkov  <juri@jurta.org>

	* proced.el (proced-marked): Inherit from `error' instead of
	`font-lock-warning-face'.

	* ibuffer.el (ibuffer-marked-face): Change default face from
	`font-lock-warning-face' to `warning'.
	(ibuffer-deletion-face): Change default face from
	`font-lock-type-face' to `error'.

	* battery.el (battery-update): Use the face `error' instead of
	`font-lock-warning-face' (bug#6117).

2011-08-24  Juri Linkov  <juri@jurta.org>

	* faces.el (success): Change face color from "Green3" to
	"ForestGreen" on light background (bug#9353).

2011-08-24  Chong Yidong  <cyd@stupidchicken.com>

	* window.el (quit-window): Rename from quit-restore-window.
	Use same arglist as old quit-window.
	(frame-auto-delete): Doc fix.

	* view.el (view-mode-exit): Use quit-window.

2011-08-24  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-ring-adjust1): Start visiting previous
	search strings from the index 0 (-1 + 1) instead of 1 (0 + 1).
	(isearch-repeat, isearch-edit-string): Call `isearch-ring-adjust1'
	for empty search string (when the last search string is reused
	automatically) to adjust the isearch ring to the last element and
	prepare the correct index for further M-p commands (bug#9185).

2011-08-24  Kenichi Handa  <handa@m17n.org>

	* international/ucs-normalize.el: If decomposition property of
	CHAR is the default one (i.e. a list of CHAR itself), treat it as
	nil.
	(nfd, nfkd): Likewise.

2011-08-24  Stefan Monnier  <monnier@iro.umontreal.ca>

	* mpc.el (mpc--proc-filter): Don't signal mpc-proc-error since signals
	from process filters aren't reliably transmitted to the surrounding
	accept-process-output.
	(mpc-proc-check): New function.
	(mpc-proc-sync): Use it (bug#8293)

2011-08-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/eieio.el (eieio-defmethod, eieio-defgeneric):
	Add compatibility functions (bug#9313).

2011-08-23  Eli Zaretskii  <eliz@gnu.org>

	* cus-start.el (all): Add entry for bidi-paragraph-direction.

	* international/uni-bidi.el: Regenerate.

2011-08-23  Kenichi Handa  <handa@m17n.org>

	* international/charprop.el:
	* international/uni-bidi.el:
	* international/uni-category.el:
	* international/uni-combining.el:
	* international/uni-comment.el:
	* international/uni-decimal.el:
	* international/uni-decomposition.el:
	* international/uni-digit.el:
	* international/uni-lowercase.el:
	* international/uni-mirrored.el:
	* international/uni-name.el:
	* international/uni-numeric.el:
	* international/uni-old-name.el:
	* international/uni-titlecase.el:
	* international/uni-uppercase.el: Regenerate.

2011-08-23  Martin Rudalics  <rudalics@gmx.at>

	* help.el (help-window-setup): Fix message displayed when other
	window is reused.  (Bug#9341)

2011-08-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* shell.el (shell-completion-vars): Set pcomplete-arg-quote-list.
	* pcomplete.el (pcomplete-quote-argument): Fix thinko (bug#9161).

	* pcomplete.el (pcomplete-parse-comint-arguments): Fix inf-loop.
	Mark obsolete.
	* shell.el (shell-parse-pcomplete-arguments): New function.
	(shell-completion-vars): Use it instead (bug#9160).

2011-08-22  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/sh-script.el (sh-maybe-here-document): Disable magic in
	strings and comments (bug#9333).

	* emacs-lisp/debug.el (debug-arglist): New function.
	(debug-convert-byte-code): Use it.  Handle lexical byte-codes.
	(debug-on-entry-1): Handle interpreted closures (bug#9120).

2011-08-22  Juri Linkov  <juri@jurta.org>

	* progmodes/compile.el (compilation-mode-font-lock-keywords):
	Revert regexp that highlights output switches to its old
	pre-2010-10-28 value and remove one `?' from it (bug#9319).

	* progmodes/grep.el (grep-process-setup): Use `buffer-modified-p'
	to check for empty output (bug#9226).

2011-08-22  Chong Yidong  <cyd@stupidchicken.com>

	* progmodes/scheme.el (scheme-mode-syntax-table): Don't use
	symbol-constituent as the default, as that stops font-lock from
	working properly (Bug#8843).

2011-08-21  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* mail/smtpmail.el (smtpmail-via-smtp): Only bind
	`coding-system-for-*' around the process open call to avoid
	auth-source side effects.
	(smtpmail-try-auth-methods): Expand the secret password.
	(smtpmail-query-smtp-server): Allow `quit'-ing out in case the
	probe hangs.

2011-08-21  Chong Yidong  <cyd@stupidchicken.com>

	* term.el (term-mouse-paste): Yank primary selection (Bug#6845).

	* emacs-lisp/find-func.el (find-function-noselect): New arg
	lisp-only.

	* emacs-lisp/edebug.el (edebug-instrument-function): Use it to
	signal an error for built-in functions (Bug#6664).

2011-08-21  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* mail/smtpmail.el (smtpmail-smtp-user): New variable.
	(smtpmail-try-auth-methods): Use it.

2011-08-21  Chong Yidong  <cyd@stupidchicken.com>

	* font-lock.el (font-lock-fontify-region)
	(font-lock-unfontify-region, font-lock-default-fontify-buffer)
	(font-lock-default-unfontify-buffer)
	(font-lock-default-fontify-region)
	(font-lock-default-unfontify-region): Add docstrings (Bug#8624).

	* progmodes/compile.el (compilation-error-properties):
	Fix confusion between file struct and message struct (Bug#9319).
	(compilation-error-regexp-alist-alist): Fix 2011-05-09 change to
	`ant' regexp.

	* net/browse-url.el (browse-url-firefox): Don't call
	browse-url-firefox-sentinel unless using -remote (Bug#9328).

2011-08-20  Glenn Morris  <rgm@gnu.org>

	* tutorial.el (help-with-tutorial): Avoid an error on short screens.

	* tutorial.el (tutorial--default-keys): Update some default bindings.

	* files.el (hack-local-variables): Fully ignore case for "mode:".

2011-08-20  Alan Mackenzie  <acm@muc.de>

	Resolve invalid use of a regexp in regexp-opt.

	* progmodes/cc-fonts.el (c-complex-decl-matchers): Add in special
	detection for a java annotation.

	* progmodes/cc-engine.el (c-forward-decl-or-cast-1): Add in special
	detection for a java annotation.

	* progmodes/cc-langs.el (c-prefix-spec-kwds-re): Remove the special
	handling for java.
	(c-modifier-kwds): Remove the regexp "@[A-za-z0-9]+".

2011-08-20  Chong Yidong  <cyd@stupidchicken.com>

	* startup.el (normal-top-level-add-subdirs-to-load-path): Doc fix
	(Bug#9274).

2011-08-20  Alan Mackenzie  <acm@muc.de>

	Fontify CPP expressions correctly when starting in the middle of
	such a construct.  Mainly for when jit-lock etc. starts a chunk
	here.

	* progmodes/cc-fonts.el (c-font-lock-context): New buffer local
	variable.
	(c-make-font-lock-search-form): New function, extracted from
	c-make-font-lock-search-function.
	(c-make-font-lock-search-function): Use the above function.
	(c-make-font-lock-context-search-function): New function.
	(c-cpp-matchers): Enhance the preprocessor expression case with
	the above function
	(c-font-lock-complex-decl-prepare): Test for being in a CPP form
	which takes an expression.

	* progmodes/cc-langs.el (c-cpp-expr-intro-re): New lang-variable.

2011-08-20  Martin Rudalics  <rudalics@gmx.at>

	* window.el (display-buffer-reuse-window)
	(display-buffer-pop-up-window): Don't reuse or split a side
	window.

2011-08-19  Glenn Morris  <rgm@gnu.org>

	* files.el (hack-local-variables-prop-line, hack-local-variables):
	Downcase "Mode:".  (Bug#9331)

2011-08-18  Chong Yidong  <cyd@stupidchicken.com>

	* international/characters.el: Add L and R categories.

	* subr.el (bidi-string-mark-left-to-right): Rename from
	string-mark-left-to-right.  Use category search.

	* buff-menu.el (Buffer-menu-buffer+size): Callers changed.

2011-08-18  Juri Linkov  <juri@jurta.org>

	* faces.el (error, warning, success): New faces with definitions
	copied from old default values of `font-lock-warning-face',
	`compilation-warning', `compilation-info' (bug#6117).

	* font-lock.el (font-lock-warning-face): Inherit from `error'.

	* progmodes/compile.el (compilation-error): Inherit from `error'.
	(compilation-warning): Inherit from `warning'.
	(compilation-info): Inherit from `success'.

	* dired.el (dired-marked): Inherit from `warning'.
	(dired-flagged): Inherit from `error'.

2011-08-17  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* mail/smtpmail.el (auth-source): Require to avoid problems with
	binding variables (bug#9298).  Also clean up some unused
	autoloads.

	* net/network-stream.el (network-stream-open-starttls):
	Support using starttls.el without using gnutls-cli.

2011-08-17  Juri Linkov  <juri@jurta.org>

	* progmodes/grep.el (rgrep): Handle the case when
	`grep-find-command' is a cons cell (bug#9278).

2011-08-17  Martin Rudalics  <rudalics@gmx.at>

	* window.el (display-buffer-pop-up-frame): Run frame creation
	function with BUFFER current (as special-display-popup-frame
	does).  Reported by Drew Adams.

2011-08-17  Daiki Ueno  <ueno@unixuser.org>

	* epa-mail.el: Simplify GnuPG group expansion using
	epg-expand-group.
	(epa-mail-group-alist, epa-mail-group-modtime)
	(epa-mail-gnupg-conf-file, epa-mail-parse-groups)
	(epa-mail-sync-groups, epa-mail-expand-recipient-1)
	(epa-mail-expand-recipients-2, epa-mail-expand-recipients):
	Remove.

2011-08-16  Feng Li  <fengli@gmail.com>  (tiny change)

	* calc/calc-ext.el (math-defintegral-2): Remove nested backquote.

2011-08-16  Alan Mackenzie  <acm@muc.de>

	* progmodes/cc-engine.el (c-state-cache-non-literal-place):
	Correct, to avoid the inside of macros.

2011-08-16  Richard Stallman  <rms@gnu.org>

	* epa-mail.el: Handle GnuPG group definitions.
	(epa-mail-group-alist, epa-mail-group-modtime)
	(epa-mail-gnupg-conf-file): New variables.
	(epa-mail-parse-groups, epa-mail-sync-groups)
	(epa-mail-expand-recipient-1, epa-mail-expand-recipients-2)
	(epa-mail-expand-recipients): New functions.
	(epa-mail-encrypt): Call epa-mail-expand-recipients.

	* mail/rmail.el (rmail-epa-decrypt): New command.

	* epa.el (epa-decrypt-region): New arg MAKE-BUFFER-FUNCTION.
	Don't bind buffer-read-only, just inhibit-read-only.
	(epa--find-coding-system-for-mime-charset): Fix the non-xemacs case.
	(epa-decrypt-armor-in-region): Make error message clearer.

2011-08-15  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuffer.el (completion-pcm--merge-completions): Don't merge "a1b"
	and "a2b" to "ab" for `prefix'.

2011-08-14  Chong Yidong  <cyd@stupidchicken.com>

	* ibuf-ext.el (ibuffer-filter-disable): New arg for deleting
	filter groups.
	(ibuffer-included-in-filter-p-1): Use it.  Suggested by Rafaël
	Fourquet (Bug#8804).

2011-08-12  Juanma Barranquero  <lekktu@gmail.com>

	* startup.el (argi): Declare as global variable (bug#9275).

2011-08-12  Chong Yidong  <cyd@stupidchicken.com>

	* subr.el (string-mark-left-to-right): Search the entire string
	for RTL script, not just the terminating character.  Doc fix.

2011-08-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/js.el (js-syntax-propertize, js-syntax-propertize-regexp):
	New function.
	(js--regexp-literal, js-syntax-propertize-function): Remove.
	(js-mode): Use js-syntax-propertize to handle multilines (bug#9183).
	(js-mode-map): Don't rebind electric keys.
	(js-insert-and-indent): Remove.
	(js-mode): Setup electric-layout and electric-indent instead.

	* epa-file.el (epa-file-select-keys): Revert to nil default (bug#9280).

2011-08-12  Daiki Ueno  <ueno@unixuser.org>

	* epa.el (epa-progress-callback-function): Fix the logic of
	displaying progress.
	* epa-file.el (epa-file-insert-file-contents): Make progress
	display more user-friendly.
	(epa-file-write-region): Ditto.

2011-08-10  Chong Yidong  <cyd@stupidchicken.com>

	* subr.el (string-mark-left-to-right): New function.

	* buff-menu.el (Buffer-menu-buffer+size): Remove LRM argument.
	Use string-mark-left-to-right.
	(list-buffers-noselect): Caller changed.

	* emacs-lisp/tabulated-list.el (tabulated-list-print-entry):
	Use string-mark-left-to-right.
	(tabulated-list-print): Recenter after moving point.

2011-08-10  Juri Linkov  <juri@jurta.org>

	* progmodes/grep.el (rgrep): Don't bind `process-connection-type'.
	This finishes incomplete reversion of 2011-06-30T01:09:13Z!larsi@gnus.org
	intended by 2011-07-06T15:49:19Z!larsi@gnus.org.

2011-08-09  Chong Yidong  <cyd@stupidchicken.com>

	* hi-lock.el (hi-lock-unface-buffer): Fix interactive spec
	(Bug#7554).

2011-08-09  Andreas Schwab  <schwab@linux-m68k.org>

	* xt-mouse.el (xterm-mouse-event-read): Try to recover the raw
	character.  (Bug#6594)

2011-08-08  Chong Yidong  <cyd@stupidchicken.com>

	* image-dired.el: Don't use find-file for temporary work (Bug#7895).
	(image-dired--with-db-file): New macro.
	(image-dired-write-tags, image-dired-remove-tag)
	(image-dired-create-gallery-lists, image-dired-write-comments)
	(image-dired-get-comment, image-dired-mark-tagged-files)
	(image-dired-list-tags, image-dired-gallery-generate): Use it.
	(image-dired-gallery-generate): Use insert-file-contents.

	* time.el (display-time-world-list, display-time-world-display):
	* time-stamp.el (time-stamp-string):
	* vc/add-log.el (add-change-log-entry): Use setenv instead of
	set-time-zone-rule (Bug#7337).

2011-08-08  Daiki Ueno  <ueno@unixuser.org>

	* epg.el (epg--status-KEYEXPIRED, epg--status-KEYREVOKED): Fix typo.
	(epg-error-to-string, epg-errors-to-string): New function.
	(epg-wait-for-completion): Reverse errors list.
	(epg--check-error-for-decrypt, epg-sign-file, epg-sign-string)
	(epg-encrypt-file, epg-encrypt-string, epg-export-keys-to-file)
	(epg--import-keys-1, epg-receive-keys, epg-delete-keys)
	(epg-sign-keys, epg-generate-key-from-file)
	(epg-generate-key-from-string): Format errors by using
	epg-errors-to-string (bug#9255).
	(epg--status-INV_SGNR, epg--status-NO_SGNR): New status handler.

2011-08-07  Juri Linkov  <juri@jurta.org>

	* faces.el (list-faces-display): Remove extra angle bracket
	from `help-mode-map'.

	* info.el (Info-history-toc-nodes): Doc fix.

	* longlines.el (longlines-mode): Doc fix.

2011-08-05  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/js.el (js--regexp-literal): Accept regexps at the beginning
	of statements and in a few more cases (bug#9183).

	* emacs-lisp/cl-macs.el (cl--make-usage-var, cl--make-usage-args):
	New functions.
	(cl-transform-lambda): Use them (bug#9239).

2011-08-05  Martin Rudalics  <rudalics@gmx.at>

	* window.el (display-buffer-same-window)
	(display-buffer-same-frame, display-buffer-other-window)
	(pop-to-buffer-same-window, pop-to-buffer-same-frame)
	(pop-to-buffer-other-window)
	(pop-to-buffer-same-frame-other-window)
	(pop-to-buffer-other-frame): Make them defuns.
	(switch-to-buffer): Don't set LABEL argument of pop-to-buffer.

2011-08-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	* subr.el (make-composed-keymap): Move from C.  Change calling
	convention, and improve docstring to bring attention to a subtle point.
	* minibuffer.el (completing-read-default): Adjust accordingly.

2011-08-03  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-sh.el (tramp-open-connection-setup-interactive-shell)
	(tramp-open-shell): Use `tramp-shell-quote-argument'.

	* net/trampver.el: Update release number.

2011-08-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/sh-script.el (sh-font-lock-paren): Don't mistake "main" for
	"in" (bug#9190).

2011-08-02  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* mail/sendmail.el (sendmail-query-once): Restore the current
	buffer after querying (bug#9074).

	* dired.el (dired-flagged): Use different faces for marked and
	flagged files (bug#6117).

	* emacs-lisp/cl-macs.el (dolist): Mention that there's a nil block
	(bug#4433).

	* ido.el (ido-mode): Switch off the message if called
	non-interactively.

	* mail/smtpmail.el (smtpmail-query-smtp-server): Try port 25
	before 587, since it appears that that's more likely to work for
	more people.

	* cus-edit.el (custom-file): When running under emacs -q, always
	refuse to save the customizations, even if the .emacs file doesn't
	exist.

	* info.el: Remove the `Info-beginning-of-buffer' function
	(bug#8325).

	* net/network-stream.el (network-stream-open-starttls):
	Use `starttls-available-p' to see whether starttls.el can be used.

2011-08-01  Martin Rudalics  <rudalics@gmx.at>

	* window.el (display-buffer-in-window): Don't set dedicated status
	of window here (Bug#9215).
	(display-buffer-pop-up-window, display-buffer-pop-up-frame)
	(display-buffer-pop-up-side-window)
	(display-buffer-in-side-window): Set dedicated status of window here.

2011-08-01  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/package.el (package-generate-autoloads): Load autoloads
	before binding generated-autoload-file.

2011-08-01  Deniz Dogan  <deniz@dogan.se>

	* net/rcirc.el (rcirc-handler-333): Clarify docstring.

2011-07-30  Michael Albinus  <michael.albinus@gmx.de>

	Sync with Tramp 2.2.2.

	* net/trampver.el: Update release number.

2011-07-30  Juri Linkov  <juri@jurta.org>

	* dired-aux.el (dired-touch-initial): Remove function.
	(dired-do-chxxx): For op-symbol `touch', set `initial' to the
	current time, and `default' to the last modification time of the
	current marked file (bug#6887).

2011-07-28  Jose E. Marchesi  <jemarch@gnu.org>

	* simple.el (goto-line): Use string-to-number to provide a
	numeric argument to read-number (bug#9163).

2011-07-27  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-sh.el (tramp-maybe-send-script): Don't let-bind the
	connection process, it could be nil.

2011-07-27  Leo Liu  <sdl.web@gmail.com>

	Simplify url handling in rcirc-mode.

	* net/rcirc.el (rcirc-browse-url-map, rcirc-browse-url-at-point)
	(rcirc-browse-url-at-mouse): Remove.
	* net/rcirc.el (rcirc-markup-urls): Use `make-button'.

2011-07-26  Alan Mackenzie  <acm@muc.de>

	Fontify bitfield declarations properly.

	* progmodes/cc-langs.el (c-has-bitfields): New lang variable.
	(c-symbol-chars): Now exported as a lang variable.
	(c-not-primitive-type-keywords): New lang variable.

	* progmodes/cc-fonts.el (c-font-lock-declarations): Jump over the
	QT keyword "more" to prevent "more slots: ...." being spuriously
	parsed as a bitfield declaration.

	* progmodes/cc-engine.el (c-beginning-of-statement-1):
	Refactor and enhance to handle bitfield declarations.
	(c-punctuation-in): New function.
	(c-forward-decl-or-cast-1): Enhance CASE 3 to handle bitfield
	declarations properly.

2011-07-26  Ulf Jasper  <ulf.jasper@web.de>

	* calendar/icalendar.el (icalendar--all-events): Take care of
	multiple vcalendars in a single file.
	(icalendar--convert-float-to-ical): Checkdoc fixes.

2011-07-25  Deniz Dogan  <deniz@dogan.se>

	* image.el (insert-image): Clarifying docstring.

2011-07-24  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-sh.el (tramp-barf-unless-okay): Return the value of
	`tramp-send-command-and-check' if there is no error.
	(tramp-send-command-and-read): Suppress *all* errors if NOERROR.

2011-07-22  Alan Mackenzie  <acm@muc.de>

	Prevent cc-langs.elc being loaded at run time.

	* progmodes/cc-mode.el: Remove two autoload forms which loaded
	cc-langs.

	* progmodes/cc-langs.el (c-make-init-lang-vars-fun): Don't emit
	"(require 'cc-langs)".  Quote a form so it will evaluate at
	(cc-mode's) compilation time.

2011-07-22  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-file-name-handler): Avoid recursive
	loading.  (Bug#9114)

2011-07-21  Martin Rudalics  <rudalics@gmx.at>

	* window.el (display-buffer-pop-up-window)
	(display-buffer-pop-up-side-window)
	(display-buffer-in-side-window): Call display-buffer-set-height
	and display-buffer-set-width after setting the new window's
	buffer so `fit-window-to-buffer' and friends work on the right buffer.

2011-07-20  Sam Steingold  <sds@gnu.org>

	* progmodes/etags.el (etags-file-of-tag, etags-tags-table-files)
	(etags-tags-included-tables): Call `convert-standard-filename' on
	the file names contained in TAGS so that windows Emacs can handle
	TAGS files created by cygwin ctags.

2011-07-20  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* proced.el (proced-update): Revert yesterday's bug#1779 patch,
	which apparently didn't work.

2011-07-19  Roland Winkler  <winkler@gnu.org>

	* proced.el (proced-send-signal): For *Marked Processes* buffer
	put point at beginning of buffer.

2011-07-19  Stephen Berman  <stephen.berman@gmx.net>

	* proced.el (proced-format): Make header lines align with the text
	(bug#1779).

2011-07-19  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* view.el (view-buffer): Allow running in `special' modes if we're
	visiting a file (bug#8615).

2011-07-19  Martin Rudalics  <rudalics@gmx.at>

	* window.el (display-buffer-alist-of-strings-p)
	(display-buffer-alist-set-1, display-buffer-alist-set-2):
	New functions.
	(display-buffer-alist-set): Rewrite to handle Emacs 23 options
	more accurately.

2011-07-18  Alan Mackenzie  <acm@muc.de>

	Fontify declarators properly when, e.g., a jit-lock chunk begins
	inside a declaration.

	* progmodes/cc-langs.el (c-symbol-chars): Correct a typo.

	* progmodes/cc-fonts.el (c-font-lock-enclosing-decls):
	New function.
	(c-complex-decl-matchers): Insert reference to
	c-font-lock-enclosing-decls.

	* progmodes/cc-engine.el (c-backward-single-comment):
	(c-backward-comments): Bind open-paren-in-column-0-is-defun-start
	to nil around calls to (forward-comment -1).

2011-07-17  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* image.el (put-image): Doc typo fix.

	* progmodes/etags.el (tags-search): Doc typo fix.

	* mail/smtpmail.el (smtpmail-via-smtp): Query the user for
	password if we get errors 550 to 554.

2011-07-16  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* net/gnutls.el (gnutls-log-level): Remove.

	* textmodes/fill.el (adaptive-fill-regexp): Include EN DASH as an
	indentation character (bug#6380).

	* files.el (buffer-offer-save): Made permanently local (bug#6241).

	* doc-view.el (doc-view-make-safe-dir): Rewrite the error message
	to clarify what the problem is (bug#4291).

	* simple.el (current-kill): Clarify what
	`interprogram-paste-function' does (bug#7500).
	(auto-fill-mode): Document `auto-fill-function' in relation to
	`auto-fill-mode' (bug#2470).

2011-07-16  Lawrence Mitchell  <wence@gmx.li>

	* emacs-lisp/cl-macs.el (defstruct): Ignore argument to setf
	method if slot is read-only (bug#9035).

2011-07-16  Martin Rudalics  <rudalics@gmx.at>

	* frame.el (select-frame-set-input-focus): New argument NORECORD.
	* window.el (pop-to-buffer): Select window used even if it was
	selected before, see discussion of (Bug#8615), (Bug#6954).
	Pass argument NORECORD on to select-frame-set-input-focus.

2011-07-15  Glenn Morris  <rgm@gnu.org>

	* subr.el (read-char-choice): Allow quitting.  (Bug#9001)
	Respect help-form.

2011-07-09  Lawrence Mitchell  <wence@gmx.li>

	* net/gnutls.el (gnutls-min-prime-bits): New variable.
	(gnutls-negotiate): Use it.

2011-07-15  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* net/gnutls.el (gnutls-negotiate):
	Upcase `gnutls-algorithm-priority'.

2011-07-15  Glenn Morris  <rgm@gnu.org>

	* jka-compr.el (jka-compr-verbose): Move from here...
	* jka-cmpr-hook.el (jka-compr-verbose): ... to here.  (Bug#9090)
	Add missing :version tag.
	* info.el: No need to require jka-compr when compiling.

2011-07-15  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* net/gnutls.el (gnutls-algorithm-priority): New variable.
	(gnutls-negotiate): Use it.

	* emacs-lisp/cl-macs.el (declare): Link to the "Declarations" node.

	* info.el (Info-beginning-of-buffer): New command.
	(Info-mode-map): Use it instead of `beginning-of-buffer' to allow
	announcing `b' as the key (bug#8325).
	(Info-mode-menu): Use `Info-beginning-of-buffer' for consistency.

	* emacs-lisp/cl-macs.el (declare): Doc string fix-up.

	* international/mule-cmds.el
	(describe-specified-language-support): Make the error message
	clearer (bug#8905).

	* emacs-lisp/cl-macs.el (declare): Add a doc string (bug#8690).

	* isearch.el (isearch-barrier): Add a doc string, since it's
	mentioned in a function doc string (bug#8678).

2011-07-15  Martin Rudalics  <rudalics@gmx.at>

	* window.el (switch-to-buffer): Call pop-to-buffer with normalized
	buffer argument (Bug#9083) and self-identifying label argument.

2011-07-15  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/debug.el (debug): Doc fix.  (Bug#8273)

2011-07-14  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* man.el (Man-fontify-manpage): Fix message when formatting the
	man page (bug#7929).

2011-07-14  Eli Zaretskii  <eliz@gnu.org>

	* buff-menu.el (Buffer-menu-buffer+size): Accept an additional
	argument LRM; if non-nil, append an invisible LRM character to the
	buffer name.
	(list-buffers-noselect): Call Buffer-menu-buffer+size with the
	last argument non-nil, when formatting buffer names.
	(Buffer-menu-mode, list-buffers-noselect): Force left-to-right
	paragraph direction.

2011-07-14  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* man.el (Man-bgproc-sentinel): Skip any arguments and only output
	the man page name (bug#7929).

	* image.el (put-image): Mention the `put-image' overlay property
	(bug#7834).

	* scroll-bar.el (set-scroll-bar-mode): Mention that
	`scroll-bar-mode' lists the values (bug#7772).

	* image-mode.el (image-mode-fit-frame): Mention that it's a toggle
	command (bug#7729).

	* rect.el (apply-on-rectangle): Return the point after the last
	operation.
	(string-rectangle): Go to the point after the last operation
	(bug#7522).

	* printing.el (pr-toggle-region): Clarify the documentation
	slightly (bug#7493).

	* time.el (display-time-update):
	Allow `display-time-mail-function' to return nil (bug#7158).
	Fix suggested by Detlev Zundel.

	* vc/diff.el (diff): Clarify the order the file names are read
	(bug#7111).

	* mouse.el (mouse-set-region): Link to `mouse-drag-copy-region' in
	the doc string (bug#7015).

	* font-lock.el (font-lock-maximum-decoration): Mention what
	numeric levels mean (bug#6935).

	* startup.el (initial-buffer-choice): Don't mention the `none'
	selection, which is against policy.

2011-07-14  Martin Rudalics  <rudalics@gmx.at>

	* window.el (display-buffer-normalize-special):
	Replace `dedicated' by `dedicate' to dedicate window (Bug#9072).

2011-07-14  Eli Zaretskii  <eliz@gnu.org>

	* subr.el (version<, version<=, version=): Mention "-CVS" and
	"-12345" alpha version numbers.

2011-07-14  Chong Yidong  <cyd@stupidchicken.com>

	* bindings.el: Add advertised binding for set-mark-command
	(Bug#5772).

2011-07-14  Chong Yidong  <cyd@stupidchicken.com>

	* bindings.el (mode-line-other-buffer):
	* bookmark.el (bookmark-bmenu-2-window):
	* bs.el (bs-cycle-next, bs-cycle-previous):
	* net/tramp-cmds.el (tramp-append-tramp-buffers): Revert to using
	switch-to-buffer.

	* net/tramp-compat.el (tramp-compat-pop-to-buffer-same-window):
	Delete.

2011-07-14  Juanma Barranquero  <lekktu@gmail.com>

	* follow.el (follow-debug-message, follow-redisplay):
	* jka-cmpr-hook.el (with-auto-compression-mode):
	Fix typos in docstrings.

2011-07-13  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* subr.el (with-silent-modifications): Clarify somewhat what the
	macro inhibits (bug#6525).

	* simple.el (eval-expression): Note what it does if called
	interactively (bug#6495).

2011-07-13  Chong Yidong  <cyd@stupidchicken.com>

	* window.el (switch-to-buffer): New arg FORCE-SAME-WINDOW.
	Use pop-to-buffer buffer-or-name if it is nil.

	* emacs-lisp/bytecomp.el (byte-compile-interactive-only-functions):
	Remove switch-to-buffer.

2011-07-13  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* files.el (make-directory): Clarify that an error will be raised
	if there's an error (bug#6397).

	* startup.el (initial-buffer-choice): Add `none' as a choice
	(bug#6234).

	* subr.el (add-hook): Clarify section about buffer-local hooks
	(bug#6218).

	* dired.el (dired-flagged): Clarify doc string (bug#6117).

2011-07-13  Juanma Barranquero  <lekktu@gmail.com>

	* tabify.el (untabify): Preserve the current column so that point
	doesn't move (bug#6032).

2011-07-13  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* progmodes/cperl-mode.el (cperl-syntaxify-by-font-lock):
	Rewrite to avoid awkward possessive "s" (bug#5986).

2011-07-13  Glenn Morris  <rgm@gnu.org>

	* dired.el (dired-use-ls-dired): Doc fix.  (Bug#9039).
	(dired-insert-directory): Give a message the first time
	if ls is found not to support --dired.

2011-07-13  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* simple.el (toggle-truncate-lines): Clarify what is toggled
	(bug#5580).  Text by Drew Adams.

2011-07-13  Chong Yidong  <cyd@stupidchicken.com>

	* simple.el (blink-matching-open): Make the error message from the
	last change less verbose.

2011-07-13  Dan Nicolaescu  <dann@ics.uci.edu>

	* font-lock.el (font-lock-comment-face): Use the high contrast
	"yellow" color for font-lock-comment-face on low color terminals
	using a dark background color (bug#4221).

2011-07-13  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* dired.el (dired-insert-set-properties): Make the doc string
	reflect what it does now (bug#5325).

	* simple.el (blink-matching-open): Say that we were unable to find
	the match within the limit, if we're limited (bug#5122).

	* international/mule-cmds.el (prefer-coding-system): Add an
	example (bug#4869).

	* progmodes/etags.el (tags-search): Document `file-list-form'
	(bug#4731).

2011-07-13  Lawrence Mitchell  <wence@gmx.li>

	* net/browse-url.el (browse-url-default-browser)
	(browse-url-browser-function): Make the default browser choice a
	bit more logical (bug#4300).  Also clean up the doc string.

2011-07-13  Juanma Barranquero  <lekktu@gmail.com>

	* bindings.el (completion-ignored-extensions): Add OpenMCL/Clozure
	binary endings (bug#4440).

2011-07-13  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* info.el (info-insert-file-contents): Inhibit jka-compr messages,
	which can be pretty annoying (bug#8971).

	* jka-compr.el (jka-compr-verbose): New variable, and use
	throughout (bug#8971).

	* info.el (Info-find-file): Fall back on the installation
	directory if we can't find the info node anywhere else.

2011-07-13  Sergei Organov  <osv@javad.com>  (tiny change)

	* vc/vc.el (vc-revert-file):
	Don't set file time-stamp in the past.  (Bug#5181)

2011-07-12  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* files.el (after-find-file): Give a better error message when
	trying to find a symlink that points to a file that doesn't exist
	(bug#4398).

	* progmodes/cc-vars.el: Remove (probably) misleading comment
	(bug#4396).

2011-07-12  Johan Bockgård  <bojohan@gnu.org>

	* mouse-sel.el (mouse-sel-primary-overlay): Use the `region' face.

2011-07-12  Chong Yidong  <cyd@stupidchicken.com>

	* mouse-sel.el: Hack restoring functionality, while keeping
	compatibility with 2010-07-03 changes to mouse selection.
	(mouse-sel-primary-overlay): New var.
	(mouse-sel-selection-alist): Use it.
	(mouse-sel-mode): Doc fix; remove points that are default features
	of mouse.el.

2011-07-12  Johan Bockgård  <bojohan@gnu.org>

	* progmodes/compile.el (compilation-error-regexp-alist-alist):
	Fix previous fix (bug#2490).

2011-07-12  Roland Winkler  <winkler@gnu.org>

	* textmodes/bibtex.el (bibtex-initialize):
	Use pop-to-buffer-same-window.
	(bibtex-search-entries): Fix interactive call.

2011-07-12  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* progmodes/compile.el (compilation-error-regexp-alist-alist):
	Fontise bytecomp Error lines more correctly (bug#2490).
	Fix suggested by Johan Bockgård.

	* subr.el (remove-duplicates): Remove; `delete-dups' is sufficient.

	* dired-x.el (dired-guess-default): Use `delete-dups'.

2011-07-12  Chong Yidong  <cyd@stupidchicken.com>

	* dired.el (dired-mark-prompt):
	* dired-aux.el (dired-read-shell-command): Doc fix.

2011-07-11  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* mail/sendmail.el (sendmail-query-once):
	Use `customize-save-variable' unconditionally, now that it works under
	emacs -Q.

	* mail/smtpmail.el (smtpmail-query-smtp-server): Ditto.

	* cus-edit.el (custom-file): Take an optional no-error variable.
	(customize-save-variable): Set the variable, and give a warning if
	running under "emacs -q".

2011-07-11  Juanma Barranquero  <lekktu@gmail.com>

	* loadhist.el (unload-feature-special-hooks):
	Add `auto-coding-functions', `fill-nobreak-predicate' and
	`find-directory-functions' (bug#5327).

2011-07-11  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* vc/ediff.el (ediff-patch-file): Clarify doc string (bug#3138).

	* cus-edit.el (custom-guess-name-alist): -alist variables should
	use the `alist' type (bug#3120).  Suggested by Drew Adams.

	* printing.el: Add documentation to all the `pr-toggle-' commands.

2011-07-11  Leo Liu  <sdl.web@gmail.com>

	* files.el (toggle-read-only): Only do the `C-x C-q' warning on VC
	backends where it makes sense (bug#2623).

2011-07-11  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* dired-x.el (dired-guess-default): Remove duplicate shell command
	entries (bug#2028).
	(dired-guess-default): Fix grammar in doc string (bug#2028).
	(dired-guess-shell-alist-user): Clarify the example a bit (bug#2030).

	* subr.el (remove-duplicates): New conveniency function.

2011-07-10  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* tool-bar.el (tool-bar-mode): Clarify positive/negative arguments
	(bug#1526).

2011-07-10  Martin Rudalics  <rudalics@gmx.at>

	* window.el (display-buffer-normalize-default): Don't invert
	meaning of even-window-heights.  Reported by Eli Zaretskii
	<eliz@gnu.org>.

2011-07-10  Bob Rogers  <rogers@rgrjr.dyndns.org>

	* vc/vc.el (vc-diff-internal): Fix race condition (Bug#1256).

2011-07-10  Chong Yidong  <cyd@stupidchicken.com>

	* window.el (display-buffer): Fix arguments to
	display-buffer-reuse-window in last change.

	* faces.el (link): Use a less saturated blue on light backgrounds.

	* startup.el (fancy-startup-text, fancy-about-text)
	(fancy-startup-tail): Use font-lock faces, for background safety.

2011-07-09  Bob Nnamtrop  <bobnnamtrop@gmail.com>  (tiny change)

	* emulation/viper-cmd.el (viper-change-state-to-vi):
	Limit triggering of abbrev expansion (Bug#9038).

2011-07-09  Martin Rudalics  <rudalics@gmx.at>

	* window.el (display-buffer-default-specifiers): Remove.
	(display-buffer-macro-specifiers): Remove default specifiers.
	(display-buffer-alist): Default to nil.
	(display-buffer-reuse-window): New optional argument other-window.
	(display-buffer-pop-up-window): Allow splitting internal
	windows.  Check whether a live window was created.
	(display-buffer-other-window-means-other-frame)
	(display-buffer-normalize-arguments): Rename to
	display-buffer-normalize-argument and rewrite.  Set the
	other-window specifier.
	(display-buffer-normalize-special): New function.
	(display-buffer-normalize-options): Rename to
	display-buffer-normalize-default and rewrite.
	(display-buffer-normalize-options-inhibit): Remove.
	(display-buffer-normalize-specifiers): Rewrite.
	(display-buffer): Process other-window specifier and call
	display-buffer-reuse-window with it.  Emulate Emacs 23 behavior
	more faithfully.
	(pop-up-windows, even-window-heights): Restore Emacs 23 default values.
	(display-buffer-alist-set): Don't handle 'unset default values.
	(display-buffer-in-window, display-buffer-alist-set):
	Replace symbol "dedicated" by "dedicate".  Reported by Tassilo Horn
	<tassilo@member.fsf.org>.

2011-07-09  Leo Liu  <sdl.web@gmail.com>

	* register.el (insert-register): Restore accidental change on
	2011-06-26.  (Bug#9028)

2011-07-09  Glenn Morris  <rgm@gnu.org>

	* subr.el (remq): Handle the empty list.  (Bug#9024)

2011-07-08  Andreas Schwab  <schwab@linux-m68k.org>

	* mail/sendmail.el (send-mail-function): No longer delay custom
	initialization.
	* custom.el (custom-initialize-delay): Doc fix.

2011-07-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* abbrev.el (expand-abbrev): Try to preserve point (bug#5805).

2011-07-08  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-sh.el (tramp-sh-handle-start-file-process): Use a
	human-friendly prompt.

2011-07-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc/vc-bzr.el (vc-bzr-revision-keywords): Remove svn, it's only
	provided by a particular plugin.

2011-07-08  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* mail/sendmail.el (sendmail-query-once): If we aren't allowed to
	save customizations (with "emacs -Q"), just set the variable
	instead of erroring out.

	* mail/smtpmail.el (smtpmail-query-smtp-server): Ditto.

2011-07-08  Juri Linkov  <juri@jurta.org>

	* arc-mode.el (archive-zip-expunge, archive-zip-update)
	(archive-zip-update-case): Use 7z if found by `executable-find'.
	The order of searching the available programs is the same as in
	`archive-zip-extract' (bug#8968).

2011-07-07  Chong Yidong  <cyd@stupidchicken.com>

	* menu-bar.el (menu-bar-line-wrapping-menu): Revert last change.
	(menu-bar-options-menu): Tweak descriptions.

2011-07-07  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* menu-bar.el (menu-bar-line-wrapping-menu): Make all the Options
	menu items into verb phrases (bug#1421).  Also refill to fit under
	80 columns.

2011-07-07  Chong Yidong  <cyd@stupidchicken.com>

	* info.el (info, Info-read-node-name-2, Info-read-node-name-1)
	(Info-read-node-name): Doc fix (Bug#1084).

	* thingatpt.el (forward-thing, bounds-of-thing-at-point)
	(thing-at-point, beginning-of-thing, end-of-thing, in-string-p)
	(end-of-sexp, beginning-of-sexp)
	(thing-at-point-bounds-of-list-at-point, forward-whitespace)
	(forward-symbol, forward-same-syntax, word-at-point)
	(sentence-at-point): Doc fix (Bug#1144).

2011-07-07  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* info.el (Info-mode-map): Remove S-TAB binding, since [backtab]
	should cover it (bug#1281).

	* cus-edit.el (custom-show): Mark as obsolete.

	* net/network-stream.el (network-stream-open-starttls): If GnuTLS
	negotiation fails, then possibly try again with a non-encrypted
	connection (bug#9017).

	* mail/smtpmail.el (smtpmail-stream-type): Note that `plain' can
	be used.

2011-07-07  Richard Stallman  <rms@gnu.org>

	* mail/rmail.el (rmail-next-error-move): Use `compilation-message'
	property, and handle its changed format.
	Look for the correct line number.
	Use file's line contents (but not past first =) to find
	correct line in message.

2011-07-07  Kenichi Handa  <handa@m17n.org>

	* international/characters.el (build-unicode-category-table):
	Delete it.
	(unicode-category-table): Set it by unicode-property-table-internal.

	* international/mule-cmds.el (char-code-property-alist): Move to
	to src/chartab.c.
	(get-char-code-property): Call unicode-property-table-internal to
	load a file.  Call get-unicode-property-internal where necessary.
	(put-char-code-property): Call unicode-property-table-internal to
	load a file.  Call put-unicode-property-internal where necessary.
	put-unicode-property-internal where necessary.
	(char-code-property-description):
	Call unicode-property-table-internal to load a file.

	* international/charprop.el:
	* international/uni-bidi.el:
	* international/uni-category.el:
	* international/uni-combining.el:
	* international/uni-comment.el:
	* international/uni-decimal.el:
	* international/uni-decomposition.el:
	* international/uni-digit.el:
	* international/uni-lowercase.el:
	* international/uni-mirrored.el:
	* international/uni-name.el:
	* international/uni-numeric.el:
	* international/uni-old-name.el:
	* international/uni-titlecase.el:
	* international/uni-uppercase.el: Regenerate.

	* loadup.el: Load international/charprop.el before
	international/characters.

2011-07-07  Chong Yidong  <cyd@stupidchicken.com>

	* window.el (next-buffer, previous-buffer): Signal an error if
	called from a minibuffer window.

	* bindings.el: Revert 2011-07-04 change.

2011-07-06  Richard Stallman  <rms@gnu.org>

	* mail/rmailmm.el (rmail-mime-process): Use markers for buf positions.
	(rmail-mime-insert-bulk, rmail-mime-insert-text):
	Treat markers like ints.
	(rmail-mime-entity): Doc fix.

2011-07-06  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* mail/smtpmail.el (smtpmail-default-smtp-server): Made into a
	defcustom again for backwards compatibility.

	* simple.el (shell-command-on-region): Fill.

	* dired-aux.el (dired-kill-line): Add a doc string.

	* dabbrev.el (dabbrev-abbrev-char-regexp): Note that nil defaults
	to "\\sw\\|\\s_" (bug#358).

	* dired.el (dired-mode): Clarify "unmark or unflag" (bug#8770).
	(dired-unmark-backward): Ditto.
	(dired-flag-backup-files): Ditto.

	* dired-x.el (dired-mark-sexp): Ditto.

2011-07-06  Richard Stallman  <rms@gnu.org>

	* mail/rmailmm.el: Give entity a new slot, TRUNCATED.
	(rmail-mime-entity): New arg TRUNCATED.
	(rmail-mime-entity-truncated, rmail-mime-entity-set-truncated):
	New functions.
	(rmail-mime-save): Warn if entity is truncated.
	(rmail-mime-toggle-hidden): Likewise, for showing.
	(rmail-mime-process-multipart): Record when an entity is truncated.

	* mail/rmailmm.el (rmail-search-mime-message): Don't get confused
	if ENTITY is a string.

2011-07-06  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* emacs-lisp/lisp-mode.el (eval-defun-1): Update the documentation
	of faces when `M-C-x'-ing their definitions (bug#8378).
	Also clean up the code slightly.

	* progmodes/grep.el (rgrep): Don't bind `process-connection-type',
	because that makes the colors go away.

	* mail/sendmail.el (send-mail-function): Change the default to
	`sendmail-query-once'.
	(sendmail-query-once): Add an autoload cookie.

	* net/network-stream.el (network-stream-open-starttls): Try using
	a plain connection even if the server offered STARTTLS, and we
	kinda wanted to use it, if Emacs doesn't have any STARTTLS
	capability.  This should make smtpmail.el work in slightly more
	configurations.

2011-07-06  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-compat.el (tramp-compat-pop-to-buffer-same-window):
	New defun.
	* net/tramp-cmds.el (tramp-append-tramp-buffers): Use it.

2011-07-06  Michael R. Mauger  <mmaug@yahoo.com>

	* progmodes/sql.el: Version 3.0
	(sql-product-alist): Add product :completion-object,
	:completion-column, and :statement attributes.
	(sql-mode-menu, sql-interactive-mode-map): Fix List entries.
	(sql-mode-syntax-table): Mark all punctuation.
	(sql-font-lock-keywords-builder): Temporarily remove fallback on
	ansi keywords.
	(sql-regexp-abbrev, sql-regexp-abbrev-list): New functions.
	(sql-mode-oracle-font-lock-keywords): Improve.
	(sql-oracle-show-reserved-words): New function for development.
	(sql-product-font-lock): Simplify for source code buffers.
	(sql-product-syntax-table, sql-product-font-lock-syntax-alist):
	New functions.
	(sql-highlight-product): Set product specific syntax table.
	(sql-mode-map): Add statement movement functions.
	(sql-ansi-statement-starters, sql-oracle-statement-starters):
	New variable.
	(sql-statement-regexp, sql-beginning-of-statement)
	(sql-end-of-statement, sql-signum): New functions.
	(sql-buffer-live-p, sql=find-sqli-buffer): Add CONNECTION parameter.
	(sql-show-sqli-buffer): Bug fix.
	(sql-interactive-mode): Store connection data as buffer local.
	(sql-connect): Add NEW-NAME parameter.  Redesign interaction
	with sql-interactive-mode.
	(sql-save-connection): Save buffer local settings.
	(sql-connection-menu-filter): Change menu entry name.
	(sql-product-interactive): Bug fix.
	(sql-preoutput-hold): New variable.
	(sql-interactive-remove-continuation-prompt): Bug fixes.
	(sql-debug-redirect): New variable.
	(sql-str-literal): New function.
	(sql-redirect, sql-redirect-one, sql-redirect-value, sql-execute):
	Redesign.
	(sql-oracle-save-settings, sql-oracle-restore-settings)
	(sql-oracle-list-all, sql-oracle-list-table): New functions.
	(sql-completion-object, sql-completion-column)
	(sql-completion-sqlbuf): New variables.
	(sql-build-completions-1, sql-build-completions)
	(sql-try-completion): New functions.
	(sql-read-table-name): Use them.
	(sql-contains-names): New buffer local variable.
	(sql-list-all, sql-list-table): Use it.
	(sql-oracle-completion-types): New variable.
	(sql-oracle-completion-object, sql-sqlite-completion-object)
	(sql-postgres-completion-object): New functions.

2011-07-06  Glenn Morris  <rgm@gnu.org>

	* window.el (pop-to-buffer): Doc fix.

2011-07-06  Markus Heiser  <markus.heiser@darmarit.de>  (tiny change)

	* progmodes/gud.el (gud-pdb-marker-regexp): Accept \r char (Bug#5653).

2011-07-06  Chong Yidong  <cyd@stupidchicken.com>

	* window.el (special-display-popup-frame): Doc fix (Bug#8853).

	* info.el (Info-directory-toc-nodes): Minor doc fix (Bug#8833).

2011-07-05  Chong Yidong  <cyd@stupidchicken.com>

	* button.el (button): Inherit from link face.  Suggested by Dan
	Nicolaescu.

2011-07-05  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/gdb-mi.el: Fit in 80 columns.
	(gdb-setup-windows, gdb-restore-windows): Avoid other-window and
	switch-to-buffer.

	* progmodes/which-func.el (which-func-ff-hook): Don't output a message
	if imenu is simply not configured (bug#8941).

2011-07-05  Ken Manheimer  <ken.manheimer@gmail.com>

	* allout.el (allout-post-undo-hook): New allout outline-change
	event hook to signal undo activity.
	(allout-post-command-business): Run allout-post-undo-hook if an
	undo just occurred.
	(allout-after-copy-or-kill-hook, allout-mode): Minor docstring changes.
	* allout-widgets.el (allout-widgets-after-undo-function):
	Ensure the integrity of the current item's decoration after it has been
	in the vicinity of an undo.
	(allout-widgets-mode): Include allout-widgets-after-undo-function
	on the new allout-post-undo-hook.

2011-07-05  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/lisp-mode.el (lisp-interaction-mode-abbrev-table):
	Let define-derived-mode define it.
	* emacs-lisp/derived.el (define-derived-mode): Try to avoid creating
	cycles of abbrev-table inheritance (bug#8998).

2011-07-05  Roland Winkler  <winkler@gnu.org>

	* textmodes/bibtex.el: Add support for biblatex.
	(bibtex-BibTeX-entry-alist, bibtex-biblatex-entry-alist)
	(bibtex-BibTeX-field-alist, bibtex-biblatex-field-alist)
	(bibtex-dialect-list, bibtex-dialect, bibtex-no-opt-remove-re)
	(bibtex-entry-alist, bibtex-field-alist): New variables.
	(bibtex-entry-field-alist): Obsolete alias for
	bibtex-BibTeX-entry-alist.
	(bibtex-entry-alist, bibtex-field-alist): New widgets.
	(bibtex-set-dialect): New command.
	(bibtex-entry-type, bibtex-entry-head)
	(bibtex-entry-maybe-empty-head, bibtex-any-valid-entry-type):
	Bind via bibtex-set-dialect.
	(bibtex-Article, bibtex-Book, bibtex-Booklet, bibtex-InBook)
	(bibtex-InCollection, bibtex-InProceedings, bibtex-Manual)
	(bibtex-MastersThesis, bibtex-Misc, bibtex-PhdThesis)
	(bibtex-Proceedings, bibtex-TechReport, bibtex-Unpublished):
	Define via bibtex-set-dialect.
	(bibtex-name-in-field, bibtex-remove-OPT-or-ALT):
	Obey bibtex-no-opt-remove-re.
	(bibtex-vec-push, bibtex-vec-incr): New functions.
	(bibtex-format-entry, bibtex-field-list)
	(bibtex-print-help-message, bibtex-validate)
	(bibtex-search-entries): Use new format of bibtex-entry-alist.

2011-07-05  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/compile.el (compilation-goto-locus):
	* net/tramp-cmds.el (tramp-append-tramp-buffers):
	* bs.el (bs-cycle-next, bs-cycle-previous):
	* bookmark.el (bookmark-bmenu-list, bookmark-bmenu-2-window):
	* bindings.el (mode-line-other-buffer):
	* autoinsert.el (auto-insert):
	* arc-mode.el (archive-extract):
	* abbrev.el (edit-abbrevs): Fix some uses of switch-to-buffer.

2011-07-05  Juanma Barranquero  <lekktu@gmail.com>

	* emacs-lock.el (emacs-lock-mode): Fix typo in variable name.
	Fix check of `emacs-lock-unlockable-modes'.
	Coerce true values of `emacs-lock--try-unlocking' to t.

2011-07-05  Juanma Barranquero  <lekktu@gmail.com>

	* obsolete/old-emacs-lock.el: Rename from emacs-lock.el.
	* emacs-lock.el: New file.

2011-07-05  Julien Danjou  <julien@danjou.info>

	* textmodes/rst.el (rst-define-level-faces): Use `facep' rather
	than `boundp' to check if face is set.

2011-07-05  Juanma Barranquero  <lekktu@gmail.com>

	* register.el (registerv-make):
	* window.el (window-min-height): Fix typos in docstrings.

2011-07-05  Jan Djärv  <jan.h.d@swipnet.se>

	* dynamic-setting.el (dynamic-setting-handle-config-changed-event):
	Update doc string.

2011-07-04  Juanma Barranquero  <lekktu@gmail.com>

	* server.el (server-execute): Catch quit and call
	`server-return-error' to pass the error back to emacsclient and
	close the connection (bug#8942).

2011-07-04  Ken Manheimer  <ken.manheimer@gmail.com>

	* allout.el (allout-encrypt-unencrypted-on-saves): Do not provide
	insecure exception for current topic.  Also note that auto-saves
	are handled differently.

	(allout-auto-save-temporarily-disabled, allout-just-did-undo):
	State variables for tracking auto-save inhibition situation.

	(allout-write-contents-hook-handler): Rename from
	'allout-write-file-hook-handler', and describe how it depends on
	write-contents-functions sensitivity to non-nil value to prevent
	file write.

	(allout-auto-save-hook-handler): Remove.  auto-save does not check
	this in individual buffers, only in the starting buffer, so this
	is not the right way for us to inhibit auto-save in a buffer
	according to its condition.

	(allout-mode): Use new allout-write-contents-hook-handler, and
	only with write-contents-functions.  Remove auto-save provisions -
	they're implemented elsewhere.

	(allout-before-change-handler): If undo is in progress, note that
	for attention of allout-post-command-business.

	(allout-post-command-business): If the command we're following was
	an undo, check for change in the status of encrypted items and
	adjust auto-save inhibitions accordingly.

	(allout-toggle-subtree-encryption): Adjust auto-save inhibition
	according to whether there are or aren't any plain-text topics
	pending encryption.

	(allout-inhibit-auto-save-info-for-decryption):
	Adjust buffer-saved-size and some allout state to inhibit auto-saves
	if there are plain-text topics pending encryption.

	(allout-maybe-resume-auto-save-info-after-encryption): Adjust
	buffer-saved-size and some allout state to not inhibit auto-saves
	if there are no longer any plain-text topics pending encryption.

	(allout-next-topic-pending-encryption, allout-encrypt-decrypted):
	No longer provide for exemption of the current topic.

2011-07-04  Juri Linkov  <juri@jurta.org>

	Add 7z operations to delete and save changed members (bug#8968).
	* arc-mode.el (archive-7z-expunge, archive-7z-update):
	New defcustoms.
	(archive-7z-write-file-member): New function.
	(archive-7z-summarize): Fix the number of dashes in the
	listing output.

2011-07-04  Stefan Monnier  <monnier@iro.umontreal.ca>

	* pcmpl-linux.el (pcomplete-pare-list): Re-add, from pcomplete.el
	(bug#8958).

2011-07-04  Chong Yidong  <cyd@stupidchicken.com>

	* bindings.el: Ignore next-buffer and previous-buffer in
	minibuffer-local-map.

	* font-lock.el (font-lock-builtin-face): Change light background
	color to dark slate blue (Bug#6693).

2011-07-04  Wang Diancheng  <dcwang@kingbase.com.cn>  (tiny change)

	* progmodes/gdb-mi.el (gdb): Use completion-at-point.

2011-07-04  Stefan Monnier  <monnier@iro.umontreal.ca>

	* files.el (find-file): Use pop-to-buffer-same-window (bug#8911).
	* emacs-lisp/bytecomp.el (byte-compile-interactive-only-functions):
	Add switch-to-buffer.

2011-07-04  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* isearch.el (isearch-search-fun-function): Clarify further the
	meaning of the function returned.

2011-07-04  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-cmds.el (tramp-cleanup-this-connection): New command.

	* net/tramp-sh.el (tramp-color-escape-sequence-regexp): New defconst.
	(tramp-sh-handle-insert-directory, tramp-convert-file-attributes):
	Use it.
	(tramp-remote-path): Add "/bin" and "/usr/bin".  On busyboxes,
	`tramp-default-remote-path' does not exist.
	(tramp-send-command-and-read): New optional argument NOERROR.
	(tramp-open-connection-setup-interactive-shell)
	(tramp-get-remote-path, tramp-get-remote-stat): Use it.
	(tramp-get-remote-readlink): Do not mask with `ignore-errors'.
	(tramp-process-sentinel): Flush also process' connection property.
	(tramp-sh-handle-start-file-process): Do not set process
	sentinel.  It is done now ...
	(tramp-maybe-open-connection): ... here.  (Bug#8929)

2011-07-04  MON KEY  <monkey@sandpframing.com>

	* play/animate.el (animate-string): Doc fixes and allow changing
	the buffer name (bug#5417).

2011-07-04  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* play/animate.el (animation-buffer-name): Rename from *animate*.

2011-07-04  Paul Eggert  <eggert@cs.ucla.edu>

	* emacs-lisp/timer.el: Use time-date fns rather than rolling our own.
	This is simpler and helps future-proof the code.
	(timer-until): Use time-subtract and float-time.
	(timer--time-less-p): Use time-less-p.

2011-07-04  Juanma Barranquero  <lekktu@gmail.com>

	* type-break.el (timep): Use the value of `float-time' to avoid a
	byte-compiler warning.

	* server.el (server-eval-and-print): Return any result, even nil.

2011-07-03  Paul Eggert  <eggert@cs.ucla.edu>

	* type-break.el: Accept time formats that the builtins accept.
	(timep, type-break-time-difference): Accept any format that
	float-time accepts, rather than insisting on (HIGH LOW USECS) format.
	This is simpler and helps future-proof the code.
	(type-break-time-difference): Round rather than ignoring
	subseconds components.

2011-07-03  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* info.el (Info-apropos-matches): Make non-interactive, since it
	doesn't seem to do anything useful as a command (bug#8829).

2011-07-03  Chong Yidong  <cyd@stupidchicken.com>

	* frame.el (frame-background-mode, frame-set-background-mode):
	Move from faces.el.
	(frame-default-terminal-background): New function.

	* custom.el (custom-push-theme): Don't record faces in `changed'
	theme; this doesn't work correctly for per-frame face settings.
	(disable-theme): Use face-set-after-frame-default to reset faces.
	(custom--frame-color-default): New function.

2011-07-03  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* dired.el (dired-flagging-regexp): Remove unused variable
	(bug#8769).

2011-03-29  Kevin Ryde  <user42@zip.com.au>

	* progmodes/compile.el (compilation-error-regexp-alist-alist):
	`perl-Test2' extend to match possible "fail #N" rep count
	(bug#8377).

2011-07-03  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* mail/feedmail.el (feedmail-buffer-to-smtpmail):
	`smtpmail-via-smtp' now returns the error instead of nil.

	* isearch.el (isearch-search-fun-function): Clarify the doc string
	(bug#8101).

2011-07-03  Richard Kim  <emacs18@gmail.com>  (tiny change)

	* textmodes/texnfo-upd.el (texinfo-insert-menu): Don't insert
	unnecessary spaces (bug#8987).

2011-07-03  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* net/network-stream.el (open-network-stream): Use the
	:end-of-capability command thoughout.

2011-07-03  Wolfgang Jenkner  <wjenkner@inode.at>  (tiny change)

	* net/network-stream.el (open-network-stream): Add the
	:end-of-capability command parameter, used by pop3.el.

2011-07-03  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* dired.el (dired-map-over-marks): Refill the doc string (bug#6814).

	* fringe.el (fringe-query-style): Remove redundant text " (type ?
	for list)" (bug#6475).

	* files.el (file-expand-wildcards): Ignore non-readable
	sub-directories while trying to find matches instead of signaling
	an error (bug#6297).

	* man.el (Man-reference-regexp): Allow matching possible
	word-wrapped references (bug#6289).

	* vc/vc.el (vc-modify-change-comment): Change *VC-log* to *vc-log*
	for consistency with the other vc buffers (bug#6197).
	(vc-checkin): Ditto.

	* vc/vc-arch.el: Fix comments to match the *VC-log* name change.

	* longlines.el (longlines-mode): Document what ARG does (bug#6150).

2011-07-02  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* custom.el (defcustom): Clarify that :set is only used in the
	Customize user interface (bug#6089).

	* progmodes/flymake.el (flymake-mode): If the buffer isn't
	associated with a file, refuse to run instead of erroring out
	(bug#6084).

	* textmodes/fill.el (fill-region): Remove the "Ordinarily" from
	the doc string, since it appears that using `fill-column' always
	controls the width (bug#7845).

	* simple.el (shell-command-on-region): Say where the error output
	went if `shell-command-default-error-buffer' is set (bug#6857).

2011-07-02  Ken Manheimer  <ken.manheimer@gmail.com>

	* allout.el (allout-yank-processing): Adjust cursor position for
	backwards-deleted space.

	(allout-rebullet-heading): Register changes with
	allout-exposure-changed-hook, so the modified topic is properly
	decorated.

2011-07-02  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* minibuffer.el (completion-in-region): Document PREDICATE
	(bug#7136).

	* info-look.el (info-lookup-add-help): Clarify that ARGS is a list
	of keyword/argument pairs (bug#6904).

	* replace.el (multi-occur):
	Mention `multi-occur-in-matching-buffers' in the doc string (bug#7566).

2011-07-02  Drew Adams  <drew.adams@oracle.com>

	* dired.el (dired-mark-if): Make the message about whether it's
	marking or unmarking clearer (bug#8523).

2011-07-02  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* disp-table.el (display-table-print-array): New function.
	(describe-display-table): Use it to print the vectors more pretty
	(Bug#8859).

2011-07-02  Martin Rudalics  <rudalics@gmx.at>

	* window.el (window-state-get-1): Don't assign clone numbers.
	Add clone-of item to list of window parameters.
	(window-state-put-2): Don't process clone numbers.
	(display-buffer-alist): Fix doc-string.

2011-07-02  Stefan Monnier  <monnier@iro.umontreal.ca>

	* subr.el (remq): Don't allocate if it's not needed.
	(keymap--menu-item-binding, keymap--menu-item-with-binding)
	(keymap--merge-bindings): New functions.
	(keymap-canonicalize): Use them to refine the canonicalization.
	* minibuffer.el (minibuffer-local-completion-map)
	(minibuffer-local-must-match-map): Move initialization from C.
	(minibuffer-local-filename-completion-map): Move initialization from C;
	don't inherit from anything here.
	(minibuffer-local-filename-must-match-map): Make obsolete.
	(completing-read-default): Use make-composed-keymap to combine
	minibuffer-local-filename-completion-map with either
	minibuffer-local-must-match-map or
	minibuffer-local-filename-completion-map.

2011-07-01  Glenn Morris  <rgm@gnu.org>

	* type-break.el (type-break-time-sum): Use dolist.

	* textmodes/flyspell.el (flyspell-word-search-backward):
	Replace CL function.

2011-07-01  Stefan Monnier  <monnier@iro.umontreal.ca>

	* mouse.el (mouse--strip-first-event): New function.
	(function-key-map): Use it to map fringe clicks to normal clicks
	by default.

	* vc/vc-bzr.el (vc-bzr-revision-keywords): Update.
	(vc-bzr-revision-completion-table): Add support for annotate and date.

	* emacs-lisp/derived.el (define-derived-mode): Make abbrev-table
	inherit from parent.

2011-07-01  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* dired-aux.el (dired-diff): Doc fixup (bug#8816).
	(dired-show-file-type): Doc fixup (bug#8818).

	* dired.el (dired-mode): Fix up the doc string as suggested by
	Drew Adams (bug#8817).

	* progmodes/flymake.el (flymake-find-file-hook): Add an `autoload'
	cookie, since the manual says that it should be possible to add
	this function to `find-file-hook' (bug#8709).

2011-07-01  Teodor Zlatanov  <tzz@lifelogs.com>

	* progmodes/cfengine.el: Moved all cfengine3.el functionality
	here.  Noted Ted Zlatanov as the maintainer.
	(cfengine-common-settings, cfengine-common-syntax): New functions
	to set up common things between `cfengine-mode' and
	`cfengine3-mode'.
	(cfengine3-mode): New mode.
	(cfengine3-defuns cfengine3-defuns-regex
	(cfengine3-class-selector-regex cfengine3-category-regex)
	(cfengine3-vartypes cfengine3-font-lock-keywords)
	(cfengine3-beginning-of-defun, cfengine3-end-of-defun)
	(cfengine3-indent-line): Add from cfengine3.el.

2011-07-01  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-encoding-command-interactive): New defcustom.

	* net/tramp-sh.el (tramp-maybe-open-connection): Use it.

2011-07-01  Martin Rudalics  <rudalics@gmx.at>

	* window.el (same-window-buffer-names, same-window-regexps)
	(same-window-p, special-display-frame-alist)
	(special-display-popup-frame, special-display-function)
	(special-display-buffer-names, special-display-regexps)
	(special-display-p, pop-up-frame-alist, pop-up-frame-function)
	(pop-up-frames, display-buffer-reuse-frames, pop-up-windows)
	(split-window-preferred-function, split-height-threshold)
	(split-width-threshold, even-window-heights)
	(display-buffer-mark-dedicated, window-splittable-p)
	(split-window-sensibly, window-safely-shrinkable-p):
	Un-obsolete.
	(display-buffer): Don't spread args with function specifier
	because special-display-popup-frame won't like it.

2011-07-01  Paul Eggert  <eggert@cs.ucla.edu>

	Time-stamp simplifications and fixes.
	These improve accuracy slightly, and future-proof the code
	against some potential changes to current-time format.

	* woman.el (woman-decode-buffer, WoMan-log-end): Log fractional secs
	by using time-since and float-time.

	* vc/ediff-util.el (ediff-calc-command-time): Use time-since
	and float-time.  Say "NNN.NNN seconds" rather than "NNN seconds
	+ NNN microseconds".

	* type-break.el (type-break-time-sum): Rewrite using time-add.

	* play/hanoi.el (hanoi-current-time-float): Remove.
	All uses replaced by float-time.

	* nxml/rng-maint.el (rng-time-function): Rewrite using time-subtract.
	This yields a more-accurate answer.
	(rng-time-to-float): Remove; no longer needed.

	* emacs-lisp/timer.el (timer-relative-time): Use time-add.

	* calendar/timeclock.el (timeclock-seconds-to-time):
	Defalias to seconds-to-time, since they're the same thing.

	* emacs-lisp/elp.el (elp-elapsed-time):
	* emacs-lisp/benchmark.el (benchmark-elapse):
	* allout-widgets.el (allout-elapsed-time-seconds): Use float-time.

2011-07-01  Stefan Monnier  <monnier@iro.umontreal.ca>

	* window.el (bury-buffer): Don't iconify the only frame.
	(switch-to-buffer): Revert to Emacs<23 behavior, i.e. do not fallback
	to pop-to-buffer.  Use pop-to-buffer-same-frame if you don't like that.

2011-07-01  Chong Yidong  <cyd@stupidchicken.com>

	* eshell/em-smart.el (eshell-smart-display-navigate-list):
	Add mouse-yank-primary.

2011-07-01  Teodor Zlatanov  <tzz@lifelogs.com>

	* progmodes/cfengine3.el: New file to support CFEngine 3.x.

2011-07-01  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/find-func.el (find-library--load-name): New fun.
	(find-library-name): Use it to find relative load names when provided
	absolute file name (bug#8803).

2011-06-30  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* textmodes/flyspell.el (flyspell-word): Consider words that
	differ only in case as potential doublons (bug#5687).

	* net/soap-client.el (soap-invoke, soap-wsdl-resolve-references):
	Remove two rather uninteresting debugging-like messages to make
	debbugs.el more silent.

	* comint.el (comint-password-prompt-regexp): Accept "Response" as
	a password-like phrase.

2011-06-30  Masatake YAMATO  <yamato@redhat.com>

	* progmodes/cc-guess.el: New file.

	* progmodes/cc-langs.el (c-mode-menu): Add "Style..." submenu.

	* progmodes/cc-styles.el (cc-choose-style-for-mode): New function
	derived from `c-basic-common-init'.

	* progmodes/cc-mode.el (top-level): Require cc-guess.
	(c-basic-common-init): Use `cc-choose-style-for-mode'.

2011-06-30  Lawrence Mitchell  <wence@gmx.li>

	* progmodes/js.el (js-mode): Don't stomp on global settings (bug#8933).

2011-06-30  Alan Mackenzie  <acm@muc.de>

	* progmodes/cc-engine.el (c-guess-continued-construct):
	Correct the handling of template-args-cont, particularly for when font
	lock is disabled.  Name this case as "CASE G".

2011-06-30  Ken Manheimer  <ken.manheimer@gmail.com>

	* allout.el (allout-yank-processing): Fix injection of extra space
	between bullet and non-whitespace character in first topic when
	pasting, ensuring that the actual spacing in the pasted topic
	following the bullet char is preserved.  This extra space was
	causing pasted encrypted topics to get a decrypted status even
	when the content was actually still encrypted.  Now the decryption
	status from before the paste is preserved.

	(allout-flag-region): Set all allout overlays so they evaporate
	when reduced to zero length (evanescent), to prevent overlay
	leakage.

2011-06-30  Glenn Morris  <rgm@gnu.org>

	* w32-fns.el (w32-charset-info-alist): Declare.

	* find-dired.el (find-grep-options): Simplify.

	* term/ns-win.el (ns-set-resource): Declare.

	* ses.el (row, col): Declare dynamic variables honestly.

	* textmodes/reftex-parse.el (index-tags): Declare.

2011-06-30  Chong Yidong  <cyd@stupidchicken.com>

	* cus-edit.el (customize-push-and-save): New function.

	* files.el (hack-local-variables-confirm): Use it.

	* custom.el (load-theme): New arg NO-CONFIRM.
	Use customize-push-and-save (Bug#8720).
	(custom-enabled-themes): Doc fix.

	* cus-theme.el (customize-create-theme)
	(custom-theme-merge-theme): Callers to load-theme changed.

2011-06-30  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* thingatpt.el (thing-at-point-short-url-regexp): Require that
	short URLs have at least one dot in them (bug #7614).

	* progmodes/grep.el (rgrep): Bind `process-connection-type' to
	nil, because using a pty is apparently too slow (bug #895).

2011-06-29  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* mail/sendmail.el (sendmail-query-once): New function.
	(sendmail-query-once-function): New variable.

2011-06-29  Glenn Morris  <rgm@gnu.org>

	* files.el (auto-mode-alist): Add .f03, .f08 for f90-mode.

	* ses.el (top-level): Require cl when compiling.
	(ses-set-localvars): Fix error statement.
	Call it at compile time to silence a storm of warnings.

2011-06-29  Martin Rudalics  <rudalics@gmx.at>

	* window.el (normalize-live-buffer): Rename to
	window-normalize-buffer.
	(normalize-live-frame): Rename to window-normalize-frame.
	(normalize-any-window): Rename to window-normalize-any-window.
	(normalize-live-window): Rename to window-normalize-live-window.
	(make-window-atom): Rename to window-make-atom.
	(window-resize-reset): Rename to window--resize-reset.
	(window-resize-reset-1): Rename to window--resize-reset-1.
	(resize-mini-window): Rename to window--resize-mini-window.
	(resize-subwindows-skip-p): Rename to
	window--resize-subwindows-skip-p.
	(resize-subwindows-normal): Rename to
	window--resize-subwindows-normal.
	(resize-subwindows): Rename to window--resize-subwindows.
	(resize-other-windows): Rename to window--resize-siblings.
	(resize-this-window): Rename to window--resize-this-window.
	(resize-root-window): Rename to window--resize-root-window.
	(resize-root-window-vertically): Rename to
	window--resize-root-window-vertically.
	(normalize-buffer-to-display): Rename to
	window-normalize-buffer-to-display.
	(normalize-buffer-to-switch-to): Rename to
	window-normalize-buffer-to-switch-to.
	Correspondingly update all callers of the functions listed
	above.
	(display-buffer-alist, display-buffer-normalize-arguments)
	(display-buffer-normalize-options, display-buffer)
	(display-buffer-alist-set): Use "function" instead of
	"fun-with-args".

2011-06-28  Chong Yidong  <cyd@stupidchicken.com>

	* mail/emacsbug.el (report-emacs-bug): Handle non-gnu bug
	addresses more clearly.  Add hyperlinks for bug-gnu-emacs and
	debbugs.gnu.org.  Mention acknowledgment email.

2011-06-28  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* mail/smtpmail.el (smtpmail-send-it): Leave off changing the
	buffer multibyteness, since it shouldn't matter.

2011-06-28  Martin Rudalics  <rudalics@gmx.at>

	* window.el (display-buffer-in-side-window): Handle dedicated
	windows as in display-buffer-reuse-window.
	(display-buffer-normalize-alist): Use value of override
	specifier.
	(display-buffer-normalize-specifiers): Use value of
	other-window-means-other-frame specifier.
	(display-buffer-alist): Rewrite some texts in widgets.
	(display-buffer): Spread arguments when calling function
	specified by fun-with-args.

2011-06-28  Deniz Dogan  <deniz@dogan.se>

	* emacs-lisp/lisp-mode.el (emacs-lisp-mode-syntax-table):
	Unnest `let'.

	* textmodes/css-mode.el (css-font-lock-keywords): Fix grouped
	selectors (Bug#5732).
	(css-proprietary-nmstart-re): Use `regexp-opt'.

2011-06-27  Jari Aalto  <jari.aalto@cante.net>

	* eshell/em-ls.el: Display `ls -l' dates in ISO format (Bug#8440).
	(eshell-ls-date-format): New defcustom.
	(eshell-ls-file): Use it.

2011-06-27  Stefan Monnier  <monnier@iro.umontreal.ca>

	* help-fns.el (describe-variable): Fix message for terminal-local vars.

2011-06-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* net/ange-ftp.el: Allow loading .gz files (Bug#6923).
	(ange-ftp-make-tmp-name): New arg.
	(ange-ftp-file-local-copy): Use it.

2011-06-27  Jambunathan K  <kjambunathan@gmail.com>

	* tar-mode.el (tar-untar-buffer): Set coding-system-for-write to
	no-conversion (Bug#8870).

2011-06-27  Martin Rudalics  <rudalics@gmx.at>

	* window.el (window-right, window-left, window-child)
	(window-child-count, window-last-child)
	(window-iso-combination-p, walk-window-tree-1)
	(window-atom-check-1, window-tree-1, delete-window)
	(window-state-get-1, display-buffer-even-window-sizes): Adapt to
	new naming conventions - window-vchild, window-hchild,
	window-next and window-prev are now called window-top-child,
	window-left-child, window-next-sibling and window-prev-sibling
	respectively.
	(resize-window-reset): Rename to window-resize-reset.
	(resize-window-reset-1): Rename to window-resize-reset-1.
	(resize-window): Rename to window-resize.
	(window-min-height, window-min-width)
	(resize-mini-window, resize-this-window, resize-root-window)
	(resize-root-window-vertically, adjust-window-trailing-edge)
	(enlarge-window, shrink-window, maximize-window)
	(minimize-window, delete-window, quit-restore-window)
	(split-window, balance-windows, balance-windows-area-adjust)
	(balance-windows-area, window-state-put-2)
	(display-buffer-even-window-sizes, display-buffer-set-height)
	(display-buffer-set-width, set-window-text-height)
	(fit-window-to-buffer): Rename all "resize-window" prefixed
	calls to use the "window-resize" prefix convention.
	(display-buffer-alist): Fix symbol for label specifier.
	(display-buffer-reuse-window): Set reuse-dedicated to cdr of
	corresponding specifier.
	Reported by Juanma Barranquero <lekktu@gmail.com>.

2011-06-27  Vincent Belaïche  <vincentb1@users.sourceforge.net>

	* ses.el (ses-destroy-cell-variable-range): Fix heading comment
	convention.
	(ses-call-printer): Does not pass an empty string to formatter when the
	cell is empty to keep from barking printer Calc math-format-value.

2011-06-27  Richard Stallman  <rms@gnu.org>

	* battery.el (battery-mode-line-limit): New variable.
	(battery-update): Handle it.

	* mail/rmailmm.el (rmail-mime-process-multipart):
	Handle truncated messages.

2011-06-27  Glenn Morris  <rgm@gnu.org>

	* progmodes/flymake.el (flymake-err-line-patterns):
	Allow for column numbers in the ant/javac pattern.  (Bug#8866)

2011-06-27  Vincent Belaïche  <vincentb1@users.sourceforge.net>

	* ses.el (ses-relocate-range): Keep rest of arguments for ses-range.
	(ses--clean-!, ses--clean-_): New functions.
	(ses-range): Add configurability of readout order, and conversion
	to Calc vector.

	* ses.el (ses-repair-cell-reference-all): New function.
	(ses-cell-symbol): Set macro as safe, so that it can be used in
	formulas.

	* ses.el: Update cycle detection algorithm.
	(ses-localvars): Add ses--Dijkstra-attempt-nb and
	ses--Dijkstra-weight-bound, and initial values thereof when applicable.
	(ses-set-localvars): New function.
	(ses-make-cell): Add property-list as a cell element.
	(ses-cell-property-get-fun, ses-cell-property-get)
	(ses-cell-property-delq-fun, ses-cell-property-set-fun)
	(ses-cell-property-pop-fun, ses-cell-property-get-handle-fun):
	New functions.
	(ses-cell-property-set, ses-cell-property-pop)
	(ses-cell-property-get-handle): New macro.
	(ses-cell-property-handle-car, ses-cell-property-handle-setcar):
	New aliases, used for code readability.
	(ses-calculate-cell, ses-update-cells): Use Dijkstra algorithm for
	cycle detection.
	(ses-self-reference-early-detection): New defcustom.
	(ses-formula-references): Robustify against self-referring cells.
	(ses-mode): Use ses-set-localvars.
	(ses-command-hook): Add call to ses-initialize-Dijkstra-attempt
	before launching the update processing.
	(ses-initialize-Dijkstra-attempt): New function.
	(ses-recalculate-cell): Update for cycle detection based on
	Dijkstra algorithm.

	* ses.el: Fix commenting and indenting convention.

2011-06-27  Stefan Monnier  <monnier@iro.umontreal.ca>

	* bs.el (bs-cycle-next): Complete last change.

2011-06-27  Drew Adams  <drew.adams@oracle.com>

	* faces.el (list-faces-display): Add help-mode-map to output (bug#8939).

2011-06-27  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* net/network-stream.el (network-stream-open-starttls):
	Don't re-get capabilities unless we've reestablished connection.
	(network-stream-open-starttls): Fix stupid typo with gnutls-clii.

	* mail/smtpmail.el (smtpmail-via-smtp): Bind coding-system-for-*
	to binary to possibly avoid line encoding issues on Windows (among
	other things).

2011-06-26  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* net/network-stream.el (open-network-stream): Return an :error
	saying what the problem was, if possible.

	* mail/smtpmail.el (smtpmail-via-smtp): Report the error from the
	server.

	* net/network-stream.el (network-stream-open-starttls): If we
	wanted to use STARTTLS, and the server offered it, but we weren't
	able to because we had no STARTTLS support, then close the connection.
	(open-network-stream): Return an :error element, if present.

2011-06-26  Chong Yidong  <cyd@stupidchicken.com>

	* hl-line.el (hl-line-sticky-flag): Doc fix.
	(global-hl-line-sticky-flag): New option (Bug#8323).
	(global-hl-line-highlight): Obey it.

	* vc/vc.el (vc-revert-show-diff): Default to t.

2011-06-26  Ken Manheimer  <ken.manheimer@gmail.com>

	* allout-widgets.el (allout-widgets-post-command-business):
	Stop decorating intermediate isearch matches.  They're not being
	undecorated when an isearch is continued past, and isearch
	automatically collapses them.  This leads to "widget leaks", where
	decorated items accumulate in collapsed areas.  Lines with lots of
	hidden widgets can slow down cursor travel, substantially.
	Too much complicated machinery would be needed to ensure undecoration,
	so we're doing without this nicety.

	(allout-widgets-tally-string): Don't try to do a hash-table-count
	of allout-widgets-tally when it's nil.  This eliminates spurious "Error
	during redisplay: (wrong-type-argument hash-table-p nil)" warnings in
	*Messages* when allout-widgets-maintain-tally is t.

2011-06-26  Martin Rudalics  <rudalics@gmx.at>

	* window.el (display-buffer-normalize-argument): Rename to
	display-buffer-normalize-arguments.  Handle special meaning of
	LABEL argument.  Respect special-display-function when popping up
	a new frame.  Fix code searching for a window showing the buffer
	on another frame.
	(display-buffer-normalize-specifiers):
	Call display-buffer-normalize-arguments.
	(display-buffer-in-window): Don't undedicate the window if its
	buffer remains the same.
	Reported by Drew Adams <drew.adams@oracle.com>.
	(display-buffer-alist): Add choice for same-window macro
	specfier.
	(display-buffer): Mention special meaning of LABEL argument in
	doc-string.  Fix quoting.  Don't pop up a new frame even as
	fallback.

2011-06-26  Juanma Barranquero  <lekktu@gmail.com>

	* bs.el (bs-cycle-next): Pass current buffer to `bury-buffer' to
	avoid deleting the current window in some cases (bug#8911).

2011-06-26  Andreas Schwab  <schwab@linux-m68k.org>

	* emacs-lisp/smie.el (smie-bnf->prec2): Fix last change.
	(Bug#8934)

2011-06-26  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* net/network-stream.el (network-stream-open-starttls):
	Use built-in TLS support if `gnutls-available-p' is true.
	(network-stream-open-tls): Ditto.

2011-06-26  Leo Liu  <sdl.web@gmail.com>

	* register.el (registerv): New struct.
	(registerv-make): New function.
	(jump-to-register, describe-register-1, insert-register):
	Support the jump-func, print-func and insert-func slot of a registerv
	struct.  (Bug#8415)

2011-06-26  Chong Yidong  <cyd@stupidchicken.com>

	* vc/vc.el (vc-revert-show-diff): New defcustom.
	(vc-diff-internal): New arg specifying diff buffer.
	(vc-revert): Obey vc-revert-show-diff.  If we show a diff, don't
	reuse an existing *vc-diff* buffer (Bug#8927).

	* progmodes/cperl-mode.el (cperl-mode): Derive from prog-mode.

2011-06-26  Glenn Morris  <rgm@gnu.org>

	* progmodes/f90.el (f90-critical-indent): New option.
	(f90-font-lock-keywords-2, f90-blocks-re, f90-end-block-re)
	(f90-start-block-re, f90-mode-abbrev-table): Add block, critical.
	(f90-mode): Doc fix.
	(f90-looking-at-critical, f90-looking-at-end-critical): New funcs.
	(f90-no-block-limit, f90-calculate-indent, f90-end-of-block)
	(f90-beginning-of-block, f90-next-block, f90-indent-region)
	(f90-match-end): Handle block, critical.

2011-06-25  Glenn Morris  <rgm@gnu.org>

	* calendar/diary-lib.el (diary-included-files): Doc fix.
	(diary-include-files): New function, extracted from
	diary-include-other-diary-files and diary-mark-included-diary-files.
	(diary-include-other-diary-files, diary-mark-included-diary-files):
	Just call diary-include-files.
	(diary-mark-entries): Reset diary-included-files on first call.

	* calendar/diary-lib.el (diary-mark-entries)
	(diary-mark-included-diary-files):
	Visit included diary-files in temp buffers.

	* progmodes/f90.el (f90-keywords-re, f90-font-lock-keywords-1)
	(f90-blocks-re, f90-program-block-re, f90-end-block-re)
	(f90-start-block-re, f90-imenu-generic-expression)
	(f90-looking-at-program-block-start, f90-no-block-limit):
	Add support for submodules.

	* progmodes/f90.el (f90-keywords-re, f90-keywords-level-3-re)
	(f90-procedures-re, f90-constants-re): Add some F2008 stuff.

2011-06-25  Eli Zaretskii  <eliz@gnu.org>

	* net/ange-ftp.el (ange-ftp-insert-file-contents): Let-bind
	buffer-file-type before setting its value, to avoid disastrous
	global effects on decoding files for DOS/Windows systems.  (Bug#8780)

2011-06-25  Juanma Barranquero  <lekktu@gmail.com>

	* allout.el (allout-unload-function): Pass -1 to `allout-mode'.

	* ses.el (ses-unload-function):
	* emacs-lisp/re-builder.el (re-builder-unload-function): Simplify.

	* proced.el (proced-unload-function):
	* progmodes/cperl-mode.el (cperl-mode-unload-function): Remove.

2011-06-25  Andreas Rottmann  <a.rottmann@gmx.at>

	* server.el (server-create-window-system-frame): Add parameters arg.
	(server-process-filter): Doc fix.  Handle frame-parameters.

2011-06-25  Juanma Barranquero  <lekktu@gmail.com>

	Fix bug#8730, bug#8781.

	* loadhist.el (unload--set-major-mode): New function.
	(unload-feature): Use it.

	* progmodes/python.el (python-after-info-look): Add autoload cookie.
	(python-unload-function): New function.

2011-06-25  Stefan Monnier  <monnier@iro.umontreal.ca>

	* mail/rmail.el (rmail-show-message-1): Use restore-buffer-modified-p.

2011-06-25  Giuseppe Scrivano  <gscrivano@gnu.org>

	* net/browse-url.el (browse-url-firefox-program): Add icecat to
	the candidates list.

2011-06-24  Juanma Barranquero  <lekktu@gmail.com>

	* progmodes/verilog-mode.el (verilog-mode): Fix test for bound variable.

2011-06-23  Richard Stallman  <rms@gnu.org>

	* mail/rmail.el: Going to grep hit in Rmail buffer finds the message.
	(rmail-variables): Set next-error-move-function.
	(rmail-what-message): Take argument POS.
	(rmail-next-error-move): New function.

2011-06-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/smie.el (smie-bnf->prec2): Give more understandable error
	messages for adjacent non-terminals.

2011-06-23  Richard Stallman  <rms@gnu.org>

	* mail/rmail.el (rmail-retry-ignored-headers): Add message-id.
	(rmail-show-message-1): Preserve buffer modified flag.
	(rmail-start-mail): Don't specify use of rmail-mail-return;
	that's done by mail-bury now.
	(rmail-mail-return): Handle arg NEWBUF.

2011-06-23  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-sh.el (tramp-method-out-of-band-p): Check, whether
	SIZE is a number.

2011-06-23  Martin Rudalics  <rudalics@gmx.at>

	* window.el (get-lru-window, get-mru-window)
	(get-largest-window): Never return a minibuffer window.
	(display-buffer-pop-up-window): Fix a bug that could lead to
	reusing the minibuffer window.
	(display-buffer): Pass original specifier argument to
	display-buffer-function instead of the normalized one.
	Reported by Thierry Volpiatto <thierry.volpiatto@gmail.com>.

2011-06-22  Leo Liu  <sdl.web@gmail.com>

	* minibuffer.el (completing-read-function)
	(completing-read-default): Move from minibuf.c.

2011-06-22  Richard Stallman  <rms@gnu.org>

	* mail/sendmail.el (mail-bury): If Rmail is in use, return nicely
	to Rmail even if not started by a special Rmail command.

	* mail/rmailmm.el (rmail-insert-mime-forwarded-message):
	Copy the buffer currently showing just one message.

2011-06-22  Roland Winkler  <winkler@gnu.org>

	* textmodes/bibtex.el (bibtex-entry-update): Use mapc.
	(bibtex-clean-entry): First delete the old key so that a
	customized algorithm for generating the new key does not get
	confused by the old key.
	(bibtex-url): Obey regexp of first step.
	(bibtex-search-entries): Do not use add-to-list with local
	list-var.

2011-06-22  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* mail/smtpmail.el (smtpmail-try-auth-methods): If the user has
	stored a user name, then query for the password first, instead of
	waiting for SMTP to give an error message and the trying again.

2011-06-22  Lawrence Mitchell  <wence@gmx.li>

	* net/browse-url.el (browse-url-xdg-open): Use 0, rather than nil
	BUFFER in call-process.

2011-06-22  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* mail/smtpmail.el (smtpmail-via-smtp): Make sure we don't send
	QUIT twice.
	(smtpmail-try-auth-methods): Require user name and password from
	auth-source.

2011-06-22  Martin Rudalics  <rudalics@gmx.at>

	* window.el (display-buffer-default-specifiers)
	(display-buffer-alist): Remove entries for pop-up-frame-alist.
	Suggested by Katsumi Yamaoka <yamaoka@jpl.org>.
	(split-window): Normalize SIDE argument (Bug#8916).

	* frame.el (pop-up-frame-alist, pop-up-frame-function)
	(special-display-frame-alist, special-display-popup-frame):
	Remove duplicate declarations.  These are now in window.el.

2011-06-21  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* mail/smtpmail.el (smtpmail-via-smtp):
	Set :use-starttls-if-possible so that we always use STARTTLS if the
	server supports it.  SMTP servers that support STARTTLS commonly
	require it.

	* net/network-stream.el (network-stream-open-starttls): Support
	upgrading to STARTTLS always, even if we don't have built-in support.
	(open-network-stream): Add the :always-query-capabilities keyword.

	* mail/smtpmail.el: Rewritten to do opportunistic STARTTLS
	upgrades with `open-network-stream', and rely solely on
	auth-source for all credentials.  Big changes throughout the file,
	but in particular:
	(smtpmail-auth-credentials): Remove.
	(smtpmail-starttls-credentials): Remove.
	(smtpmail-via-smtp): Check for servers saying they want AUTH after
	MAIL FROM, too.

	* net/network-stream.el (network-stream-open-starttls):
	Provide support for client certificates both for external and built-in
	STARTTLS.
	(auth-source): Require.
	(open-network-stream): Document the :client-certificate keyword.
	(network-stream-certificate): Change cert-cert to cert and
	cert-key to key.

2011-06-21  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-cache.el (top): Don't load the persistency file when
	"emacs -Q" has been called.

2011-06-21  Tim Harper  <timcharper@gmail.com>

	* term/ns-win.el (ns-initialize-window-system):
	Set application-specific `ApplePressAndHoldEnabled' system
	resource to NO as it is not yet supported by the NS port.

2011-06-21  Juanma Barranquero  <lekktu@gmail.com>

	* misc.el (list-dynamic-libraries--refresh): Compute header here...
	(list-dynamic-libraries): ...not here.

2011-06-21  Leo Liu  <sdl.web@gmail.com>

	* subr.el (sha1): Implement sha1 using secure-hash.

2011-06-21  Martin Rudalics  <rudalics@gmx.at>

	* window.el (display-buffer-alist): In default value do not
	enforce searching a window on any but the selected frame.
	Reported by Katsumi Yamaoka <yamaoka@jpl.org>.
	(display-buffer-select-window): Remove function.
	(display-buffer-in-window): When a window on another frame gets
	reused, do not select it any more but just raise its frame if
	necessary (Bug#8851) and (Bug#8856).
	(display-buffer-normalize-options): Handle pop-up-frames related
	options more faithfully.
	(pop-to-buffer): Don't rely on `display-buffer' selecting the
	window if it is on another frame.
	(display-buffer-alist, display-buffer-default-specifiers):
	Don't make new frame unsplittable by default.
	(display-buffer-normalize-argument): Fix doc-string typo and use
	'same-frame-other-window instead of 'other-window when associating
	with display-buffer-macro-specifiers.

2011-06-21  Vincent Belaïche  <vincent.b.1@hotmail.fr>

	* play/5x5.el (5x5-solve-rotate-left, 5x5-solve-rotate-right):
	New functions.
	(5x5-mode-map, 5x5-mode-menu): Bind them.
	(5x5-draw-grid): Tweak the solver's rendering.

2011-06-21  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/compile.el (compilation-error-regexp-alist-alist): Rename
	`caml' to `python-tracebacks-and-caml'; allow leading tabs (bug#8585).

2011-06-21  Drew Adams  <drew.adams@oracle.com>

	* menu-bar.el: Use function variable instead of switch-to-buffer.
	(menu-bar-select-buffer-function): New variable.
	(menu-bar-update-buffers): Use it (bug#8876).

2011-06-21  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/bytecomp.el (add-to-list): Add handler to check the
	variable's status.

2011-06-20  Jan Djärv  <jan.h.d@swipnet.se>

	* x-dnd.el (x-dnd-version-from-flags)
	(x-dnd-more-than-3-from-flags): New functions that handle long-as-cons
	and long as number (Bug#8899).
	(x-dnd-handle-xdnd): Call functions above (Bug#8899).

2011-06-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuffer.el (completion-metadata): Add `metadata' to the alist.
	(completion-try-completion, completion-all-completions): Compute the
	metadata argument if it's missing; make it optional (bug#8795).

	* wid-edit.el: Use lex-bind and move towards completion-at-point.
	(widget-complete): Use new :completion-function property.
	(widget-completions-at-point): New function.
	(default): Use :completion-function instead of :complete.
	(widget-default-completions): Rename from widget-default-complete;
	Rewrite.
	(widget-string-complete, widget-file-complete, widget-color-complete):
	Remove functions.
	(file, symbol, function, variable, coding-system, color):
	* international/mule-cmds.el (default-input-method, charset)
	(language-info-custom-alist):
	* cus-edit.el (face): Use new property :completions.

	* progmodes/pascal.el (pascal-completions-at-point): New function.
	(pascal-mode): Use it.
	(pascal-mode-map): Use completion-at-point.
	(pascal-toggle-completions): Make obsolete.
	(pascal-complete-word, pascal-show-completions):
	* progmodes/octave-mod.el (octave-complete-symbol):
	Redefine as obsolete alias.
	* progmodes/octave-inf.el (inferior-octave-completion-at-point):
	Signal absence of completion info for old Octave,
	(inferior-octave-complete): Redefine as obsolete alias.
	* progmodes/meta-mode.el: Use lexical-binding and completion-at-point.
	(meta-completions-at-point): Rename from meta-complete-symbol and
	adapt it for use on completion-at-point-functions.
	(meta-common-mode): Use it.
	(meta-looking-at-backward, meta-match-buffer): Remove.
	(meta-complete-symbol): Redefine as obsolete alias.
	(meta-common-mode-map): Use completion-at-point.
	* progmodes/make-mode.el: Use lexical-binding and completion-at-point.
	(makefile-mode-map): Use completion-at-point.
	(makefile-completions-at-point): Rename from makefile-complete and
	adapt it for use on completion-at-point-functions.
	(makefile-mode): Use it.
	(makefile-complete): Redefine as obsolete alias.

2011-06-20  Deniz Dogan  <deniz@dogan.se>

	* net/rcirc.el: Delete trailing whitespaces once and for all.

2011-06-20  Daniel Colascione  <dan.colascione@gmail.com>

	* emacs-lisp/syntax.el (syntax-ppss): Further improve docstring.

2011-06-19  Chong Yidong  <cyd@stupidchicken.com>

	* files.el (auto-mode-alist): Entry for m2-mode (Bug#8852).

	* info.el (Info-apropos-toc-nodes): Minor doc fix (Bug#8833).

2011-06-19  Martin Rudalics  <rudalics@gmx.at>

	* window.el (display-buffer-other-window-means-other-frame):
	Call display-buffer-normalize-alist.
	(display-buffer-normalize-specifiers-1): Rename to
	display-buffer-normalize-argument.  New argument other-frame.
	Rewrite.
	(display-buffer-normalize-specifiers-2): Rename to
	display-buffer-normalize-options.
	(display-buffer-normalize-alist-1): New function.
	(display-buffer-normalize-specifiers-3): Rename to
	display-buffer-normalize-alist.
	Call display-buffer-normalize-alist-1.
	(display-buffer-normalize-options-inhibit): New variable.
	(display-buffer-normalize-specifiers): Rewrite calling
	display-buffer-normalize-alist,
	display-buffer-normalize-argument, and
	display-buffer-normalize-options.  Don't call the latter if
	display-buffer-normalize-options-inhibit is non-nil.
	(frame-auto-delete): New option.
	(window-deletable-p): Use frame-auto-delete.
	(window-list-no-nils, window-state-ignored-parameters)
	(window-state-get-1, window-state-get, window-state-put-list)
	(window-state-put-1, window-state-put-2, window-state-put):
	New functions.
	(display-buffer-normalize-options): Move special-display-p group
	after pop-up-frame group (Bug#8851) and (Bug#8856).

2011-06-18  Chong Yidong  <cyd@stupidchicken.com>

	* emacs-lisp/rx.el (rx-constituents): Add support for numbered
	groups (Bug#8776).
	(rx-submatch-n): New function.
	(rx): Document it.

	* dired-x.el (dired-mark-unmarked-files): Fix interactive spec
	(Bug#8768).

	* replace.el (occur-mode-map): Set occur-edit-mode binding to "e".

	* textmodes/fill.el (default-justification): Add :safe (Bug#8879).

	* cus-face.el (custom-declare-face): Call custom-theme-recalc face
	anytime existing face settings are present (Bug#8889).

	* progmodes/delphi.el (delphi-mode-syntax-table): Use defvar.
	(delphi-mode): Use define-derived-mode to inherit from prog-mode.
	Remove unused argument.

2011-06-18  Martin Rudalics  <rudalics@gmx.at>

	* window.el (display-buffer-default-specifiers):
	Remove pop-up-frame.  Add pop-up-window-min-height,
	pop-up-window-min-width, and another reuse-window specifier
	(Bug#8882).  Reported by Dan Nicolaescu <dann@gnu.org>.
	(display-buffer-normalize-specifiers-2):
	Handle split-height-threshold and split-width-threshold also when
	pop-up-windows is unset.  Add a reuse-window specifier for the
	case popping up a new window fails.
	(special-display-popup-frame): Remove double quoting.
	(display-buffer-normalize-specifiers-1): Fix thinko.

2011-06-17  Stefan Monnier  <monnier@iro.umontreal.ca>

	* shell.el (shell-completion-vars): Set pcomplete-termination-string
	according to comint-completion-addsuffix.

	* pcomplete.el: Convert to lexical binding and fix bug#8819.
	(pcomplete-suffix-list): Mark as obsolete.
	(pcomplete-completions-at-point): Capture pcomplete-norm-func and
	pcomplete-seen in the closure.
	(pcomplete-comint-setup): Setup completion-at-point as well.
	(pcomplete--entries): New function.
	(pcomplete--env-regexp): New var.
	(pcomplete-entries): Rewrite to work with partial-completion and
	without relying on pcomplete-suffix-list.
	(pcomplete-pare-list): Remove, unused.

2011-06-17  Martin Rudalics  <rudalics@gmx.at>

	* window.el (display-buffer-alist): Set pop-up-window-min-height
	and pop-up-window-min-width in default value.  Reported by
	Thierry Volpiatto <thierry.volpiatto@gmail.com>.  New specifier
	other-window-means-other-frame.
	(display-buffer-macro-specifiers): Comment out entry for
	other-window specifier.
	(display-buffer-other-window-means-other-frame): New function.
	(display-buffer-normalize-specifiers-1): New arguments
	buffer-name and label.  Treat other-window case specially.
	(display-buffer-normalize-specifiers-2): Treat other-window case
	specially.
	(display-buffer-normalize-specifiers-3): New function.
	(display-buffer-normalize-specifiers):
	Call display-buffer-normalize-specifiers-3.

2011-06-17  Martin Rudalics  <rudalics@gmx.at>

	* window.el (same-window-p): Fix two typos introduced when
	adding with-no-warnings.
	(display-buffer-normalize-specifiers-1): Don't check
	pop-up-frames for 'unset initialization.
	(display-buffer-normalize-specifiers-2): Major rewrite using
	special-display-p and same-window-p (Bug#8851) and (Bug#8856).
	(pop-up-frames, display-buffer-reuse-frames)
	(display-buffer-mark-dedicated): Don't initialize to 'unset.
	Suggested by David Engster <deng@randomsample.de>.
	(even-window-heights): Initialize to 'unset.
	(display-buffer-alist-set): Handle new 'unset initializations.
	(display-buffer-macro-specifiers): Don't pop up a new frame in the
	other window case.

2011-06-16  Martin Rudalics  <rudalics@gmx.at>

	* window.el (display-buffer-normalize-specifiers-1):
	Respect current value of pop-up-frames for most reasonable values of
	second argument of display-buffer (Bug#8865).
	(switch-to-buffer-same-frame, switch-to-buffer-other-window)
	(switch-to-buffer-other-window-same-frame)
	(switch-to-buffer-other-frame): Fix doc-strings.  Reported by Drew
	Adams (Bug#8875).
	(display-buffer): Don't check noninteractive when calling
	display-buffer-pop-up-frame.
	(display-buffer-pop-up-frame): Never pop up a frame in
	noninteractive mode (Bug#8857).
	(enlarge-window, shrink-window): Don't report an error when the
	window can't be resized as requested (Bug#8862).

2011-06-15  Stefan Monnier  <monnier@iro.umontreal.ca>

	* pcmpl-rpm.el (pcomplete/rpm): Minor simplification.

	* emacs-lisp/debug.el (debug): Don't leave the buffer in Debugger.

	* abbrev.el (define-abbrev-table): Don't add a table multiple times.

2011-06-15  Alan Mackenzie  <acm@muc.de>

	* progmodes/cc-fonts.el (c-font-lock-declarations): 1: Whilst checking
	for declarators, disable knr checking to speed up for normal files.
	2: Refactor, replacing a sequence of nested if forms by a cond form.

2011-06-15  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* net/network-stream.el (open-network-stream): Add the keyword
	:always-query-capabilities for the case where you want to force a
	`plain' network connection, but the protocol still requires the
	capabilitiy command (i.e., SMTP and EHLO).

	* subr.el (process-live-p): Rename from `process-alive-p' for
	consistency with other `-live-p' functions.

2011-06-15  Stefan Monnier  <monnier@iro.umontreal.ca>

	* window.el (same-window-buffer-names, same-window-regexps)
	(special-display-frame-alist, special-display-popup-frame)
	(special-display-function, special-display-buffer-names)
	(special-display-regexps, pop-up-frame-alist)
	(pop-up-frame-function, pop-up-frames, display-buffer-reuse-frames)
	(pop-up-windows, split-window-preferred-function)
	(split-height-threshold, split-width-threshold, even-window-heights)
	(display-buffer-mark-dedicated): Don't encourage the use of
	display-buffer-alist from Elisp code.

2011-06-15  Dan Nicolaescu  <dann@ics.uci.edu>

	* progmodes/python.el (python-mode): Derive from prog-mode.
	* progmodes/ps-mode.el (ps-mode):
	* progmodes/mixal-mode.el (mixal-mode):
	* progmodes/cfengine.el (cfengine-mode):
	* progmodes/ld-script.el (ld-script-mode): Likewise.

2011-06-15  Martin Rudalics  <rudalics@gmx.at>

	* window.el (display-buffer-alist): Trim default value to avoid
	popping up a new frame (Bug#8857) or reusing an arbitrary window
	on another frame.
	(display-buffer): Do not fall back on popping up a new frame in
	batch mode (Bug#8857).

2011-06-14  Chong Yidong  <cyd@stupidchicken.com>

	* cus-theme.el (describe-theme-1): Use custom-theme-p.
	(custom-theme-summary): New function.
	(customize-themes): Use it.

2011-06-13  Glenn Morris  <rgm@gnu.org>

	* cus-dep.el (custom-make-dependencies): Use up command-line-args-left.

2011-06-13  Martin Rudalics  <rudalics@gmx.at>

	* help.el (help-window): Remove variable.
	(help-window-point-marker, temp-buffer-max-height)
	(temp-buffer-resize-mode, help-window-select): Rewrite doc-strings.
	(help-print-return-message): Don't set help-window.
	(resize-temp-buffer-window): Rewrite cod eand doc-string.
	(help-window-setup-finish): Remove.
	(help-window-display-message, help-window-setup)
	(with-help-window): Major rewrite based on new
	display-buffer-window variable.

	* help-mode.el (help-mode-finish): Remove help-window related
	code.

	* view.el (view-exits-all-viewing-windows): Remove reference to
	view-return-to-alist in doc-string.
	(view-return-to-alist): Make obsolete.
	(view-buffer): Call pop-to-buffer-same-window and remove
	undo-window code.
	(view-buffer-other-window): Call pop-to-buffer-other-window and
	simplify code.  Ignore second argument.
	(view-buffer-other-frame): Call pop-to-buffer-other-frame and
	simplify code.  Ignore second argument.
	(view-return-to-alist-update): Make obsolete.
	(view-mode-enter): Rename second argument to QUIT-RESTORE.
	Rewrite using quit-restore window parameters.
	(view-mode-exit): Rename second argument to EXIT-ONLY.
	Rewrite using quit-restore-window.
	(View-exit, View-exit-and-edit, View-leave, View-quit)
	(View-quit-all, View-kill-and-leave): Call view-mode-exit with
	appropriate arguments.
	(view-end-message): Use quit-restore window parameter.

	* window.el (display-buffer-function): Rewrite doc-string.
	(display-buffer-window, display-buffer-alist): New variables.
	(display-buffer-split-specifiers)
	(display-buffer-side-specifiers)
	(display-buffer-macro-specifiers): New constants.
	(display-buffer-even-window-sizes, display-buffer-set-height)
	(display-buffer-set-width, display-buffer-select-window)
	(display-buffer-in-window, display-buffer-reuse-window)
	(display-buffer-split-window-1, display-buffer-split-window)
	(display-buffer-split-atom-window, display-buffer-pop-up-window)
	(display-buffer-pop-up-frame, display-buffer-pop-up-side-window)
	(display-buffer-in-side-window, normalize-buffer-to-display)
	(display-buffer-normalize-specifiers-1)
	(display-buffer-normalize-specifiers-2)
	(display-buffer-normalize-specifiers, display-buffer-frame):
	New functions.
	(display-buffer): Major rewrite.
	(display-buffer-other-window, display-buffer-other-frame)
	(pop-to-buffer, switch-to-buffer-other-window)
	(switch-to-buffer-other-frame): Rewrite.
	(display-buffer-same-window, display-buffer-same-frame)
	(display-buffer-same-frame-other-window)
	(pop-to-buffer-same-window, pop-to-buffer-same-frame)
	(pop-to-buffer-other-window)
	(pop-to-buffer-same-frame-other-window)
	(pop-to-buffer-other-frame, switch-to-buffer-same-frame)
	(switch-to-buffer-other-window-same-frame): New functions.
	(same-window-p, special-display-p): Rewrite disabling warnings.
	Make obsolete.
	(pop-up-frames, display-buffer-reuse-frames, pop-up-windows)
	(display-buffer-mark-dedicated): Initialize to symbol 'unset.
	Make obsolete
	(same-window-buffer-names, same-window-regexps)
	(special-display-frame-alist, special-display-popup-frame)
	(special-display-function, special-display-buffer-names)
	(special-display-regexps, pop-up-frame-alist)
	(pop-up-frame-function, split-window-preferred-function)
	(split-height-threshold, split-width-threshold)
	(even-window-heights): Make obsolete.

2011-06-12  Glenn Morris  <rgm@gnu.org>

	* term/xterm.el (terminal-init-xterm): `version' may be nil.  (Bug#8838)
	Misc simplifications.

2011-06-12  Martin Rudalics  <rudalics@gmx.at>

	* window.el (window-safely-shrinkable-p): Restore function which
	was inadvertently removed in change from 2011-06-11.  Declare as
	obsolete.

	* calendar/calendar.el (calendar-generate-window):
	Use window-iso-combined-p instead of combination of one-window-p and
	window-safely-shrinkable-p.

2011-06-12  Glenn Morris  <rgm@gnu.org>

	* progmodes/fortran.el (fortran-mode-syntax-table):
	* progmodes/f90.el (f90-mode-syntax-table):
	Set % to punctuation.  (Bug#8820)
	(f90-find-tag-default): Remove, no longer needed.

2011-06-12  Daniel Colascione  <dan.colascione@gmail.com>

	* emacs-lisp/syntax.el (syntax-ppss): Clarify which items are invalid.

2011-06-11  Chong Yidong  <cyd@stupidchicken.com>

	* image.el (image-animated-p): Return animation delay in seconds.
	Avoid bit manipulation in Lisp; use `delay' entry in the metadata.
	(image-animate-timeout): Remove DELAY argument.  Don't assume
	every subimage has the same delay; get it from image-animated-p.
	(image-animate): Caller changed.

2011-06-11  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-debug-message): Add `tramp-with-progress-reporter'
	to ignored backtrace functions.

2011-06-11  Glenn Morris  <rgm@gnu.org>

	* calendar/appt.el (appt-disp-window-function): Doc fix.
	(appt-check): Handle overlapping appointments.  (Bug#8337)

2011-06-11  Martin Rudalics  <rudalics@gmx.at>

	* window.el (window-tree-1, window-tree): New functions, moving
	the latter to window.el.
	(bw-get-tree, bw-get-tree-1, bw-find-tree-sub)
	(bw-find-tree-sub-1, bw-l, bw-t, bw-r, bw-b, bw-dir, bw-eqdir)
	(bw-refresh-edges): Remove.
	(balance-windows-1, balance-windows-2): New functions.
	(balance-windows): Rewrite in terms of window tree functions,
	balance-windows-1 and balance-windows-2.
	(bw-adjust-window): Remove.
	(balance-windows-area-adjust): New function with functionality of
	bw-adjust-window but using resize-window.
	(set-window-text-height): Rewrite doc-string.
	Use normalize-live-window and resize-window.
	(enlarge-window-horizontally, shrink-window-horizontally):
	Rename argument to DELTA.
	(window-buffer-height): New function.
	(fit-window-to-buffer, shrink-window-if-larger-than-buffer):
	Rewrite using new window resize routines.
	(kill-buffer-and-window, mouse-autoselect-window-select):
	Use ignore-errors instead of condition-case.
	(quit-window): Call delete-frame instead of delete-windows-on
	for the only buffer on frame.

2011-06-10  Martin Rudalics  <rudalics@gmx.at>

	* loadup.el (top-level): Load window before files for the sake
	of replace-buffer-in-windows.

	* files.el (read-buffer-to-switch)
	(switch-to-buffer-other-window)
	(switch-to-buffer-other-frame, display-buffer-other-frame):
	Move to window.el.

	* simple.el (get-next-valid-buffer, last-buffer, next-buffer)
	(previous-buffer): Move to window.el.

	* bindings.el (unbury-buffer): Move to window.el.

	* window.el (delete-other-windows-vertically): Move after
	definition of delete-other-windows.
	(other-window, delete-windows-on, replace-buffer-in-windows):
	Move here from window.c.
	(record-window-buffer, unrecord-window-buffer)
	(set-window-buffer-start-and-point, switch-to-prev-buffer)
	(switch-to-next-buffer): New functions.
	(get-next-valid-buffer, last-buffer, next-buffer): Move here
	from simple.el.  Call switch-to-next-buffer.
	(previous-buffer): Move here from simple.el.
	Call switch-to-prev-buffer.
	(bury-buffer): Move here from buffer.c.  Switch to previous
	buffer when window cannot be deleted.
	(unbury-buffer): Move here from bindings.el.
	(ctl-x-map): Move binding for other-window from window.c to
	here.
	(read-buffer-to-switch, switch-to-buffer-other-window)
	(switch-to-buffer-other-frame): Move here from files.el.
	(normalize-buffer-to-switch-to): New functions.
	(switch-to-buffer): Move here from buffer.c.
	Use read-buffer-to-switch and normalize-buffer-to-switch-to.

2011-06-10  Martin Rudalics  <rudalics@gmx.at>

	* window.el (window-min-height, window-min-width): Move here
	from window.c.  Add defcustoms and rewrite doc-strings.
	(resize-mini-window, resize-window): New functions.
	(adjust-window-trailing-edge, enlarge-window, shrink-window):
	Move here from window.c.
	(maximize-window, minimize-window): New functions.
	(delete-window, delete-other-windows, split-window): Move here
	from window.c.
	(window-split-min-size): New function.
	(split-window-keep-point): Mention split-window-above-each-other
	instead of split-window-vertically.
	(split-window-above-each-other, split-window-vertically):
	Rename split-window-vertically to split-window-above-each-other
	and provide defalias for old definition.
	(split-window-side-by-side, split-window-horizontally):
	Rename split-window-horizontally to split-window-side-by-side
	and provide defalias for the old definition.
	(ctl-x-map): Move bindings for delete-window,
	delete-other-windows and enlarge-window here from window.c.
	Replace bindings for split-window-vertically and
	split-window-horizontally by bindings for
	split-window-above-each-other and split-window-side-by-side.

	* cus-start.el (all): Remove entries for window-min-height and
	window-min-width.  Add entries for window-splits and
	window-nest.

2011-06-09  Glenn Morris  <rgm@gnu.org>

	* calendar/appt.el (appt-mode-line): New function.
	(appt-check, appt-disp-window): Use it.

	* files.el (hack-one-local-variable-eval-safep):
	Allow minor-modes with explicit +/-1 arguments.

2011-06-09  Teodor Zlatanov  <tzz@lifelogs.com>

	* term/xterm.el (xterm): Add defgroup.
	(xterm-extra-capabilities): Add defcustom to supply known xterm
	capabilities, skip querying them, or query them (default).
	(terminal-init-xterm): Use it.
	(terminal-init-xterm-modify-other-keys): New function to set up
	modifyOtherKeys support to simplify `terminal-init-xterm'.

2011-06-09  Martin Rudalics  <rudalics@gmx.at>

	* window.el (resize-window-reset, resize-window-reset-1)
	(resize-subwindows-skip-p, resize-subwindows-normal)
	(resize-subwindows, resize-other-windows, resize-this-window)
	(resize-root-window, resize-root-window-vertically)
	(window-deletable-p, window-or-subwindow-p)
	(frame-root-window-p): New functions.

2011-06-09  Glenn Morris  <rgm@gnu.org>

	* net/ange-ftp.el (ange-ftp-switches-ok): New function.
	(ange-ftp-get-files): Use it.

2011-06-09  Alexander Klimov  <alserkli@inbox.ru>  (tiny change)

	* mail/sendmail.el (mail-recover-1, mail-recover):
	* files.el (recover-file, recover-session):
	Handle dired-listing-switches not being just a single short option.

2011-06-09  Glenn Morris  <rgm@gnu.org>

	* calendar/appt.el (appt-display-message, appt-disp-window):
	Handle lists of appointments.

2011-06-08  Martin Rudalics  <rudalics@gmx.at>

	* window.el (one-window-p): Move down in code.
	Rewrite doc-string.
	(window-current-scroll-bars): Rewrite doc-string.
	Normalize live window argument.
	(walk-windows, get-window-with-predicate, count-windows):
	Rewrite doc-string.  Use window-list-1.
	(window-in-direction-2, window-in-direction, get-mru-window):
	New functions.

2011-06-08  Reuben Thomas  <rrt@sc3d.org>

	* progmodes/flymake.el (flymake-compilation-prevents-syntax-check):
	Doc fix (Bug#8713).

2011-06-08  Chong Yidong  <cyd@stupidchicken.com>

	* repeat.el (repeat-on-final-keystroke): Fix type (Bug#8696).

2011-06-08  Juanma Barranquero  <lekktu@gmail.com>

	* loadhist.el (unload-feature-special-hooks):
	Add `comint-output-filter-functions'.

2011-06-08  Ivan Kanis  <gnu@kanis.fr>

	* calendar/appt.el (appt-check): Move some initializations into the let.

2011-06-08  Martin Rudalics  <rudalics@gmx.at>

	* window.el (window-height): Defalias to window-total-height.
	(window-width): Defalias to window-body-width.

2011-06-07  Chong Yidong  <cyd@stupidchicken.com>

	* image-mode.el (image-toggle-animation): New command.
	(image-mode-map): Bind it to RET.
	(image-mode): Update message.
	(image-toggle-display-image): Avoid a spurious cache flush.
	(image-transform-rotation): Doc fix.
	(image-transform-properties): Return quickly in the normal case.
	(image-animate-loop): Rename from image-animate-max-time.

	* image.el (image-animate-max-time): Move to image-mode.el.
	(create-animated-image): Remove unnecessary function.
	(image-animate): Rename from image-animate-start.  New arg.
	(image-animate-stop): Remove; just use image-animate-timer.
	(image-animate-timer): Use car-safe.
	(image-animate-timeout): Rename argument.

2011-06-07  Martin Rudalics  <rudalics@gmx.at>

	* window.el (get-lru-window, get-largest-window): Move here from
	window.c.  Rename first argument to ALL-FRAMES.
	Rephrase doc-strings.
	(get-buffer-window-list): Rewrite using window-list-1.
	Rephrase doc-string.
	(window-safe-min-height, window-safe-min-width): New constants.
	(window-size-ignore, window-min-size, window-min-size-1)
	(window-sizable, window-sizable-p, window-size-fixed-1)
	(window-size-fixed-p, window-min-delta-1, window-min-delta)
	(window-max-delta-1, window-max-delta, window-resizable)
	(window-resizable-p, window-total-height, window-total-width)
	(window-body-width): New functions.
	(window-full-height-p, window-full-width-p): Rewrite using
	window-total-size.
	(window-body-height): Rewrite using window-body-size.

2011-06-06  Martin Rudalics  <rudalics@gmx.at>

	* window.el (window-right, window-left, window-child)
	(window-child-count, window-last-child, window-any-p)
	(normalize-live-buffer, normalize-live-frame)
	(normalize-any-window, normalize-live-window)
	(window-iso-combination-p, window-iso-combined-p)
	(window-iso-combinations)
	(walk-window-tree-1, walk-window-tree, walk-window-subtree)
	(windows-with-parameter, window-with-parameter)
	(window-atom-root, make-window-atom, window-atom-check-1)
	(window-atom-check, window-side-check, window-check):
	New functions.
	(ignore-window-parameters, window-sides, window-sides-vertical)
	(window-sides-slots): New variables.
	(window-size-fixed): Move down in code.  Minor doc-string fix.

2011-06-05  Andreas Schwab  <schwab@linux-m68k.org>

	* comint.el (comint-dynamic-complete-as-filename)
	(comint-dynamic-complete-filename): Correctly call
	completion-in-region.

2011-06-05  Deniz Dogan  <deniz@dogan.se>

	* net/rcirc.el (rcirc-prompt-for-encryption): Fix bug introduced
	in last change.

2011-06-05  Deniz Dogan  <deniz@dogan.se>

	* net/rcirc.el (rcirc-prompt-for-encryption): New function.
	(rcirc): Use it to prompt for encryption.

2011-06-05  Roland Winkler  <winkler@gnu.org>

	* textmodes/bibtex.el (bibtex-search-buffer): New variable.
	(bibtex-search-entries): New command bound to C-c C-a.
	(bibtex-display-entries): New function.

2011-06-05  Roland Winkler  <winkler@gnu.org>

	* textmodes/bibtex.el (bibtex-generate-url-list): Fix docstring.
	(bibtex-insert-kill): After yanking insert newline if necessary.
	(bibtex-initialize): Call bibtex-string-files-init only once.
	(bibtex-mode): Do not call easy-menu-add.
	(bibtex-validate-globally): Use save-excursion in bibtex buffers.
	(bibtex-yank): Set arg properly if nil.

2011-06-05  Roland Winkler  <winkler@gnu.org>

	* textmodes/bibtex.el (bibtex-search-entry-globally):
	New variable.
	(bibtex-search-entry): Use it.

2011-06-05  Roland Winkler  <winkler@gnu.org>

	* textmodes/bibtex.el (bibtex-entry-format): New option
	sort-fields.
	(bibtex-format-entry, bibtex-reformat): Honor this option.
	(bibtex-parse-entry): Return fields in proper order.

2011-06-05  Juanma Barranquero  <lekktu@gmail.com>

	* doc-view.el (doc-view-remove-if): Move computation of result out
	of `dolist' to silence misleading lexical-binding warning.

2011-06-04  Chong Yidong  <cyd@stupidchicken.com>

	* emacs-lisp/timer.el (timer-activate): Remove unused arg.
	(timer-activate, timer-activate-when-idle): Doc fix (Bug#8793).

2011-06-04  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-sh.el (tramp-find-shell): Apply workaround also for
	"SunOS 5.10".

2011-06-04  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-set-completion-function, tramp-parse-rhosts)
	(tramp-parse-shosts, tramp-parse-sconfig, tramp-parse-shostkeys)
	(tramp-parse-hosts, tramp-parse-passwd, tramp-parse-netrc)
	(tramp-parse-putty):
	* net/tramp-sh.el (tramp-completion-function-alist-rsh)
	(tramp-completion-function-alist-ssh)
	(tramp-completion-function-alist-telnet)
	(tramp-completion-function-alist-su)
	(tramp-completion-function-alist-putty): Set `tramp-autoload'
	cookie.

	* net/tramp-ftp.el:
	* net/tramp-sh.el:
	* net/tramp-smb.el: Set `tramp-autoload' cookie, and eval after
	load "tramp.el" `tramp-set-completion-function'.

2011-06-04  Stefan Monnier  <monnier@iro.umontreal.ca>

	* shell.el: Require and use pcomplete.
	(shell-dynamic-complete-functions): Add pcomplete-completions-at-point.
	(shell-completion-vars): Set pcomplete-default-completion-function.

2011-06-04  Deniz Dogan  <deniz@dogan.se>

	* iswitchb.el (iswitchb-window-buffer-p): Use `member' instead of
	`memq' (Bug#8799).

2011-06-02  Stefan Monnier  <monnier@iro.umontreal.ca>

	* subr.el (make-progress-reporter): Add "..." by default (bug#8785).

2011-06-02  Juanma Barranquero  <lekktu@gmail.com>

	* bs.el (bs--mark-unmark, bs--nth-wrapper):
	* mpc.el (mpc-select-extend, mpc-songpointer-context):
	* vc/log-view.el (log-view-beginning-of-defun):
	* vc/smerge-mode.el (smerge-apply-resolution-patch)
	(smerge-refine-forward, smerge-refine-chopup-region):
	Silence warning for unused `dotimes' counter variables.

2011-06-02  Stefan Monnier  <monnier@iro.umontreal.ca>

	* net/tramp.el (tramp-with-progress-reporter): Rename from
	with-progress-reporter.  Use `declare'.
	* net/tramp-smb.el:
	* net/tramp-sh.el:
	* net/tramp-gvfs.el: Update all uses.

2011-06-02  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc.el (calc-kill-stack-buffer): Make sure that the trail
	buffer isn't killed before making it current.

2011-06-01  Stefan Monnier  <monnier@iro.umontreal.ca>

	Silence various byte-compiler warnings.
	* emacs-lisp/byte-run.el (make-obsolete-variable): New argument
	`access-type' and new obsolescence format.
	* emacs-lisp/bytecomp.el (byte-compile-warn-obsolete): Adjust to
	new format.
	(byte-compile-check-variable): New `access-type' argument.
	Only warn if the access-type is obsolete.
	(byte-compile-dynamic-variable-bind, byte-compile-variable-ref)
	(byte-compile-variable-set): Adjust callers.
	* help-fns.el (describe-variable): Adjust to new obsolescence format.
	* mail/sendmail.el (mail-mailer-swallows-blank-line): Only mark
	setting it as obsolete.
	* simple.el (minibuffer-completing-symbol):
	* font-lock.el (font-lock-beginning-of-syntax-function): Only mark read
	access as obsolete.
	* minibuffer.el (minibuffer-completing-file-name): Don't make it
	obsolete yet.
	* international/quail.el (quail-mouse-choose-completion): Remove unused
	code referring to obsolete var.
	(quail-choose-completion-string): Remove.
	* server.el (server-clients-with, server-kill-buffer-query-function)
	(server-kill-emacs-query-function): Silence "unused `proc'" warnings.
	* proced.el (proced-send-signal):
	* emacs-lisp/lisp.el (lisp-complete-symbol):
	Replace completion-annotate-function with completion-extra-properties.

2011-06-01  Stefan Monnier  <monnier@iro.umontreal.ca>

	* simple.el (goto-line): Use read-number.
	(overriding-map-is-bound): Remove.
	(saved-overriding-map): Change default.
	(save&set-overriding-map): Rename from ensure-overriding-map-is-bound;
	Take the map as argument.
	(universal-argument, negative-argument, digit-argument): Use it.
	(restore-overriding-map): Adjust.
	(do-auto-fill): Use fill-forward-paragraph.
	(keyboard-quit): Don't signal an error when debug-on-quit is non-nil.

	* minibuffer.el (minibuffer-inactive-mode-map): New var.
	(minibuffer-inactive-mode): New major mode.
	* mouse.el (mouse-drag-region): Remove the "mouse-1 pops up
	the *Messages* buffer" hack.
	(mouse-popup-menubar): Don't burp if the event is a normal key.

	Miscellaneous tweaks.
	* emacs-lisp/cl-macs.el (dolist, dotimes): Use the same strategy for
	lexical scoping as in subr.el's dolist and dotimes.
	* emacs-lisp/bytecomp.el (byte-compile-unfold-bcf):
	Silence compiler warning.
	* thingatpt.el (forward-whitespace): Trivial coding style fix.
	* subr.el (with-output-to-temp-buffer): Provide an edebug spec.
	* international/ccl.el (ccl-compile): Trivial simplification.
	* help-fns.el (help-do-arg-highlight): Silence compiler warning.
	* emacs-lisp/testcover.el (testcover-end): Remove spurious
	`printflag' argument.
	* emacs-lisp/byte-run.el (make-obsolete, make-obsolete-variable):
	Purecopy the whole obsolescence data.

2011-06-01  Leo Liu  <sdl.web@gmail.com>

	* net/rcirc.el (rcirc-decode-coding-system): Revert last change;
	improve doc-string as suggested by Marco Pessotto
	<melmothx@gmail.com>.
	(rcirc-print): Fix last change.

2011-05-31  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuffer.el (complete-with-action): Return nil for the metadata and
	boundaries of non-functional tables.
	(completion-table-dynamic): Return nil for the metadata.
	(completion-table-with-terminator): Add default case, using
	complete-with-action.
	(completion--metadata): New function.
	(completion-all-sorted-completions, minibuffer-completion-help): Use it
	to try and avoid pathological performance problems.
	(completion--embedded-envvar-table): Return `category' metadata.

2011-05-31  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* subr.el (process-alive-p): New tiny convenience function.

2011-05-31  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/debug.el (debug): Save&restore not just the buffer's
	content but also its previous major mode.

2011-05-31  Helmut Eller  <eller.helmut@gmail.com>

	* emacs-lisp/debug.el (debug): Restore the previous content of the
	*Backtrace* buffer when we exit with C-M-c.

2011-05-31  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuffer.el: Add metadata method to completion tables.
	(completion-category-overrides): New defcustom.
	(completion-metadata, completion--field-metadata)
	(completion-metadata-get, completion--styles)
	(completion--cycle-threshold): New functions.
	(completion-try-completion, completion-all-completions):
	Add `metadata' argument to choose completion-styles.
	(completion--do-completion): Use metadata to choose cycling.
	(completion-all-sorted-completions): Use metadata for sorting.
	Remove :completion-cycle-penalty which is not needed any more.
	(completion--try-word-completion): Add `metadata' argument.
	(minibuffer-completion-help): Check metadata for annotation function
	and sorting.
	(completion-file-name-table): Return `category' metadata.
	(minibuffer-completing-file-name): Make obsolete.
	* simple.el (minibuffer-completing-symbol): Make obsolete.
	* icomplete.el (icomplete-completions): Pass new `metadata' param to
	completion-try-completion.

2011-05-30  Stefan Monnier  <monnier@iro.umontreal.ca>

	* mail/smtpmail.el (smtpmail-send-data): Add progress reporter.

2011-05-30  Leo Liu  <sdl.web@gmail.com>

	* net/rcirc.el (rcirc-debug-buffer): Use visible buffer name.
	(rcirc-print): Decode all incoming messages (bug#8744).
	(rcirc-decode-coding-system): Allow value nil for automatic coding
	system detection.

2011-06-01  Glenn Morris  <rgm@gnu.org>

	* mail/emacsbug.el (report-emacs-bug-hook): Mailclient ignores From.

2011-05-29  Chong Yidong  <cyd@stupidchicken.com>

	* image.el (image-animate-max-time): Allow nil and t values.
	Default to nil.
	(create-animated-image): Doc fix.
	(image-animate-start): Remove second arg; just use
	image-animate-max-time.
	(image-animate-timeout): Doc fix.  Args changed.

	* image-mode.el (image-toggle-display-image): Ensure that the
	image spec passed to the animate timer is the same object as in
	the buffer's display property (Bug#6981).
	(image-transform-properties): Doc fix.

	* image.el (image-animate-max-time): Default to nil.

2011-05-29  Martin Rudalics  <rudalics@gmx.at>

	* menu-bar.el (kill-this-buffer-enabled-p): Avoid looping over
	entire buffer list (Bug#8184).

2011-05-29  Chong Yidong  <cyd@stupidchicken.com>

	* image.el (imagemagick-types-inhibit)
	(imagemagick-register-types): Doc fix.

2011-05-29  Deniz Dogan  <deniz@dogan.se>

	* net/rcirc.el (rcirc): Use the user's stored encryption method by
	default.

2011-05-29  Chong Yidong  <cyd@stupidchicken.com>

	* select.el: Don't perform clipboard-manager saving in hooks;
	leave the hooks empty.

2011-05-28  Leo Liu  <sdl.web@gmail.com>

	* replace.el (occur-menu-map, occur-edit-mode-map): New vars.
	(occur-mode-map): Bind occur-edit-mode.  Use occur-menu-map.
	(occur-edit-mode): New major mode (Bug#8463).
	(occur-after-change-function): New function.
	(occur-engine): Give Occur tags a read-only property.

2011-05-28  Kevin Ryde  <user42@zip.com.au>

	* subr.el (def-edebug-spec): Doc fix (Bug#8430).

2011-05-28  Chong Yidong  <cyd@stupidchicken.com>

	* bindings.el (help-echo): Make the initial non-indicator dash
	empty on graphical terminals (Bug#7295).

	* files.el (auto-mode-alist): Move config rule after the
	in-stripping one (Bug#8547).

	* newcomment.el (comment-end-skip): Doc fix (Bug#8659).

	* startup.el (normal-splash-screen): Remove gratuitous mode-line
	setting (Bug#8740).

2011-05-28  Alp Aker  <aker@pitt.edu>  (tiny change)

	* buff-menu.el (Buffer-menu-revert-function, Buffer-menu-sort)
	(Buffer-menu-buffer+size): Use Buffer-menu-buffer-column
	(Bug#8539).

2011-05-28  Chong Yidong  <cyd@stupidchicken.com>

	* emacs-lisp/re-builder.el (re-builder): Improve doc (Bug#8286).

2011-05-28  Dima Kogan  <dkogan@cds.caltech.edu>  (tiny change)

	* progmodes/hideshow.el (hs-looking-at-block-start-p): New fun.
	(hs-hide-block-at-point, hs-find-block-beginning)
	(hs-already-hidden-p, hs-hide-block, hs-show-block): Use it
	(Bug#8279).

2011-05-28  Glenn Morris  <rgm@gnu.org>

	* startup.el (fancy-about-screen): Use standard mode line.  (Bug#8740)

2011-05-28  Chong Yidong  <cyd@stupidchicken.com>

	* help-fns.el (describe-function-1): If the function is a derived
	major mode, print the parent mode.

	* progmodes/cc-mode.el (c-mode, c++-mode, objc-mode, java-mode)
	(idl-mode, pike-mode, awk-mode): Inherit from prog-mode.

2011-05-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuffer.el (completion--capf-wrapper): Check applicability before
	returning non-nil for non-exclusive completion data.
	* progmodes/etags.el (tags-completion-at-point-function):
	* info-look.el (info-lookup-completions-at-point): Mark as
	non-exclusive.
	(info-complete): Adjust accordingly.

	* info-look.el: Convert to lexical-binding and completion-at-point.
	(info-lookup-completions-at-point): New function.
	(info-complete): Use it and completion-in-region.

2011-05-28  Drew Adams  <drew.adams@oracle.com>

	* isearch.el: Let M-e start with point at the first mismatched char.
	(isearch-fail-pos): New function.
	(isearch-edit-string): Use it.

2011-05-28  Dmitry Kurochkin  <dmitry.kurochkin@gmail.com>  (tiny change)

	* isearch.el (isearch-range-invisible): Use invisible-p (bug#8721).

2011-05-27  Toby Cubitt  <toby-predictive@dr-qubit.org>

	* emacs-lisp/avl-tree.el: New avl-tree-stack datatype.  Add new
	traversal functions for avl-trees.
	(avl-tree--stack): New struct.
	(avl-tree-stack-p, avl-tree--stack-repopulate): New funs.
	(avl-tree-enter): Add optional `updatefun' arg.
	(avl-tree--do-enter): Add optional `updatefun' arg.
	Change return value.
	(avl-tree-delete): Add optional `test' and `nilflag' args.
	(avl-tree--do-delete): Add `test' and `nilflag' args.
	Change return value.
	(avl-tree-member): Add optional `nilflag'
	(avl-tree-member-p): New function.
	(avl-tree-mapc, avl-tree-mapf, avl-tree-mapcar): New functions.
	(avl-tree-stack, avl-tree-stack-pop, avl-tree-stack-first)
	(avl-tree-stack-empty-p): New functions.

	* emacs-lisp/avl-tree.el (avl-tree--del-balance): Rename from
	avl-tree--del-balance1 and make it work both ways.
	(avl-tree--del-balance2): Remove.
	(avl-tree--enter-balance): Rename from avl-tree--enter-balance1 and
	make it work both ways.
	(avl-tree--enter-balance2): Remove.
	(avl-tree--switch-dir, avl-tree--dir-to-sign, avl-tree--sign-to-dir):
	New macros.
	(avl-tree--mapc, avl-tree-map): Add direction argument.

2011-05-27  David Michael  <fedora.dm0@gmail.com>  (tiny change)

	* files.el (interpreter-mode-alist): Add rbash (bug#8745).

2011-05-27  Chong Yidong  <cyd@stupidchicken.com>

	* select.el: Support clipboard managers with built-in function
	x-clipboard-manager-save, via delete-frame-functions and
	kill-emacs-hook.
	(xselect-convert-to-targets): Add MULTIPLE target to list.
	(xselect-convert-to-save-targets): New function.

2011-05-27  Kenichi Handa  <handa@m17n.org>

	* mail/sendmail.el (mail-encode-header): Avoid double encoding by
	let-binding rfc2047-encode-encoded-words to nil.

2011-05-27  Glenn Morris  <rgm@gnu.org>

	* mail/emacsbug.el: Don't require url-util.

	* shell.el (shell-directory-tracker): Case matters.  (Bug#8735)

	* files.el (set-auto-mode):
	Also respect mode: entries at the end of the file.  (Bug#8586)

2011-05-26  Glenn Morris  <rgm@gnu.org>

	* files.el (hack-local-variables-prop-line, hack-local-variables):
	Downcase mode names, as seems to be traditional.
	(hack-local-variables, hack-local-variables-apply): Doc fixes.

	* mail/emacsbug.el (report-emacs-bug): Mention checking From address.
	(report-emacs-bug-hook): Try to validate the From address.  (Bug#8038)

2011-05-25  Julien Danjou  <julien@danjou.info>

	* textmodes/rst.el (rst-define-level-faces): Do not define face
	symbol if it is already defined.

2011-05-24  Vincent Belaïche  <vincentb1@users.sourceforge.net>

	* play/5x5.el (5x5-new-game, 5x5-randomize):
	Reset 5x5-solver-output to nil when a new grid is cast.
	(5x5-log-init, 5x5-log): Use defsubst instead of defmacro to shunt
	these debugging traces, as defmacro breaks the compiled code.

2011-05-24  Dmitry Kurochkin  <dmitry.kurochkin@gmail.com>  (tiny change)

	* isearch.el (isearch-range-invisible): Use invisible-p (bug#8721).

2011-05-24  Leo Liu  <sdl.web@gmail.com>

	* vc/vc-bzr.el (vc-bzr-sha1-program): Rename from sha1-program.
	(vc-bzr-sha1): Adapt.

	* sha1.el: Remove.  Function `sha1' is now builtin.

	* bindings.el: Provide sha1 feature.

2011-05-24  Kenichi Handa  <handa@m17n.org>

	* mail/sendmail.el: Require `rfc2047'.
	(mail-insert-from-field): Do not perform RFC2047 encoding.
	(mail-encode-header): New function.
	(sendmail-send-it): Set buffer-file-coding-system of the work
	buffer to the return value of select-message-coding-system.
	Call mail-encode-header.

	* mail/smtpmail.el (smtpmail-send-it): Call mail-encode-header.

2011-05-24  Sean Neakums  <sneakums@zork.net>  (tiny change)

	* mail/supercite.el (sc-default-cite-frame):
	Handle sc-nested-citation-p when sc-cite-blank-lines-p is non-nil.

2011-05-24  Glenn Morris  <rgm@gnu.org>

	* progmodes/python.el (brm-menu): Declare.

	* emulation/viper.el (viper-set-hooks): Declare.

	* play/5x5.el (5x5-log-init, 5x5-log): Evaluate when compiling.
	(5x5-log-init, 5x5-log, 5x5-solver): Doc fixes.
	(math-map-vec, math-sub, math-mul, math-make-intv, math-reduce-vec)
	(math-format-number, math-pow, calcFunc-arrange, calcFunc-cvec)
	(calcFunc-diag, calcFunc-trn, calcFunc-inv, calcFunc-mrow)
	(calcFunc-mcol, calcFunc-vconcat, calcFunc-index): Declare.

2011-05-24  Stefan Monnier  <monnier@iro.umontreal.ca>

	Add an :exit-function for completion-at-point.

	* minibuffer.el (completion--done): New fun.
	(completion--do-completion): Use it.  New arg `expect-exact'.
	(minibuffer-complete, minibuffer-complete-word): Don't output message,
	since completion--do-completion does it for us now.
	(minibuffer-force-complete): Use completion--done and
	completion--replace.  Handle sole-completion case with more care.
	(minibuffer-complete-and-exit): Use new `expect-exact' arg.
	(completion-extra-properties): New var.
	(completion-annotate-function): Make obsolete.
	(minibuffer-completion-help): Adjust accordingly.
	Use completion-list-insert-choice-function.
	(completion-at-point, completion-help-at-point):
	Bind completion-extra-properties.
	(completion-pcm-word-delimiters): Add | (for uniquify, for example).
	* simple.el (completion-list-insert-choice-function): New var.
	(completion-setup-function): Preserve it.
	(choose-completion): Pay attention to it, shuffle the code a bit.
	(choose-completion-string): New arg `insert-function'.

	* textmodes/bibtex.el: Convert to lexical binding.
	(bibtex-mode-map): Use completion-at-point.
	(bibtex-mode): Use define-derived-mode&completion-at-point-functions.
	(bibtex-completion-at-point-function): New fun, from bibtex-complete.
	(bibtex-complete): Define as obsolete alias.
	(bibtex-complete-internal): Remove.
	(bibtex-format-entry): Remove unused sub-group in regexp.
	* shell.el (shell--command-completion-data)
	(shell-environment-variable-completion):
	* pcomplete.el (pcomplete-completions-at-point):
	* comint.el (comint--complete-file-name-data): Use :exit-function
	instead of completion-table-with-terminator so it also works for
	choose-completion.

2011-05-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* <lots-of-files>.el: Don't quote lambda expressions with `quote'.

	* vc/smerge-mode.el (smerge-refine-subst): Don't deactivate the mark
	(bug#8710).

	* emacs-lisp/lisp.el (up-list): Fix forward movement (bug#8708).

2011-05-23  Ken Manheimer  <ken.manheimer@gmail.com>

	* allout.el (allout-inhibit-auto-fill-on-headline): Create new
	customization variable and implement: If non-nil, auto-fill will
	be inhibited while on topic's header line.

2011-05-23  Vincent Belaïche  <vincentb1@users.sourceforge.net>

	* play/5x5.el: I/ Add an arithmetic solver to suggest positions to
	click on.  II/ Make 5x5 multisession.  III/ Ensure that random grids
	always have a solution in grid size = 5 cases.
	(5x5-mode-map): Add keybinding to function `5x5-solve-suggest'.
	(5x5-solver-output, 5x5-log-buffer): New vars.
	(5x5-grid, 5x5-x-pos, 5x5-y-pos, 5x5-moves, 5x5-cracking):
	Make these variables buffer local to achieve 5x5 multi-session-ness.
	(5x5): Set 5x5-grid-size only if SIZE is non-negative.
	(5x5-grid-to-vec, 5x5-vec-to-grid, 5x5-log-init, 5x5-log, 5x5-solver)
	(5x5-solve-suggest): New funs.
	(5x5-randomize): Use 5x5-make-move instead of 5x5-flip-cell to
	randomize a grid so that we ensure that there is always a solution.
	(5x5-make-random-grid): Allow other movement than flipping.

2011-05-23  Kevin Ryde  <user42@zip.com.au>

	* emacs-lisp/advice.el (ad-read-advised-function):
	Use `function-called-at-point' as the default, if it has
	advice and passes PREDICATE.

2011-05-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/bytecomp.el (byte-compile-function-form): Only call
	byte-compile-lambda if it's actually a lambda.

	* emacs-lisp/eieio.el (eieio-defgeneric-form-primary-only-one):
	Fix function quoting.  Use backquote better.

2011-05-22  Yuanle Song  <sylecn@gmail.com>

	* nxml/rng-xsd.el (rng-xsd-check-pattern): Use case-sensitive
	matching (Bug#8516).

2011-05-22  Jari Aalto  <jari.aalto@cante.net>

	* vc/vc-dir.el (vc-default-dir-printer): Give edited tag a
	different face (Bug#8178).

2011-05-22  Chong Yidong  <cyd@stupidchicken.com>

	* vc/diff-mode.el (diff-changed): Don't use terminal specs for
	defface (Bug#8144).

2011-05-22  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/macroexp.el (macroexpand-all-1): Convert ' to #' for
	funcall as well (bug#8712).  Warn when performing those conversions.
	* emacs-lisp/bytecomp.el (byte-compile-form): Fix error report.

	* progmodes/grep.el (grep-mode): Fix it for good (bug#8684)!

2011-05-22  Glenn Morris  <rgm@gnu.org>

	* files.el (hack-local-variables-prop-line): Small simplifications.
	(hack-local-variables, hack-local-variables-prop-line):
	If MODE-ONLY, return the mode, rather than just `t'.

2011-05-21  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/grep.el (grep-mode): Fix last change (bug#8684).

2011-05-21  Glenn Morris  <rgm@gnu.org>

	* files.el (hack-local-variables-prop-line, hack-local-variables):
	If only interested in the mode, don't bother doing the other stuff.

	* image-mode.el (image-after-revert-hook):
	Redraw all frames on which the image is visible.  (Bug#8567)

	* dired-aux.el (dired-touch-initial): Just use current-time.  (Bug#6887)

	* wid-edit.el (widget-checklist-match-inline):
	Fix 2011-04-19 change.  (Bug#8649)

2011-05-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/checkdoc.el (checkdoc-sentencespace-region-engine):
	Also allow singlespace after single-letter capitals followed by a dot.

	* nxml/nxml-mode.el (nxml-electric-slash): Reindent when completion is
	enabled.  Suggested by James Ahlborn <jahlborn@gmail.com> (bug#8704).

2011-05-20  Nick Alcock  <nix@esperi.org.uk>

	* files.el (basic-save-buffer-2):
	Fix handling of break-hardlink-on-save with non-existent files.

2011-05-19  Deniz Dogan  <deniz@dogan.se>

	* net/rcirc.el (rcirc-mode): Initialize rcirc-urls to nil.
	(rcirc-markup-urls): Check if rcirc-url-regexp is nil.

2011-05-19  Glenn Morris  <rgm@gnu.org>

	* progmodes/f90.el (f90-type-def-re):
	Handle "type, bind(c)".  (Bug#8691)

	* emacs-lisp/autoload.el (batch-update-autoloads):
	Set autoload-excludes by parsing loadup.el rather than Makefiles.

2011-05-18  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-process-actions): Set "first-password-request"
	property for the correct connection in case of multihops.

2011-05-18  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/authors.el (authors-fixed-entries): Remove fakemail.c.
	* mail/sendmail.el (sendmail-program): Fall back to just "sendmail".

	Rationalize calendar handling of day and month abbrev-arrays.
	* calendar/calendar.el (calendar-customized-p): New function.
	(calendar-abbrev-construct, calendar-make-alist): Change what it does.
	(calendar-day-name-array, calendar-month-name-array): Doc fix.
	Add :set function.
	(calendar-abbrev-length, calendar-day-abbrev-array)
	(calendar-month-abbrev-array): Make defcustoms, with appropriate :set.
	(calendar-day-abbrev-array, calendar-month-abbrev-array):
	Elements may no longer be nil.
	(calendar-day-name, calendar-month-name):
	Update for changed nature of abbrev arrays.
	* calendar/diary-lib.el (diary-name-pattern):
	Update for changed nature of abbrev arrays.
	(diary-mark-entries-1): Update calendar-make-alist calls.
	(diary-font-lock-date-forms): Doc fix for changed abbrev arrays.
	* calendar/cal-html.el (cal-html-day-abbrev-array):
	Simply inherit from calendar-day-abbrev-array.

2011-05-17  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/grep.el (grep-mode): Disable default
	compilation-directory-matcher setting (bug#8684).

2011-05-17  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-handle-insert-file-contents): Use "dd"
	instead of "head" and "tail".  There were problems with SunOS 5.9,
	and it performs better.

2011-05-17  Glenn Morris  <rgm@gnu.org>

	* mail/mail-utils.el (mail-dont-reply-to): Silence compiler.

	* progmodes/idlw-shell.el (idlwave-shell-complete-filename):
	Replace obsolete function.

	* shell.el (pcomplete-parse-arguments-function): Declare.

	* calendar/appt.el (appt-message-warning-time, appt-display-mode-line)
	(appt-display-diary, appt-display-interval, appt-prev-comp-time)
	(appt-check): Doc fixes.
	(appt-disp-window-function, appt-delete-window-function):
	Remove needless special case in custom :type.
	(appt-display-count): Default to 0, not nil.
	(appt-check): Reset appt-display-count to 0, not nil.

2011-05-17  Juanma Barranquero  <lekktu@gmail.com>

	* progmodes/python.el (python-font-lock-keywords):
	Add the Python 3.X keyword "nonlocal" (bug#8639).

2011-05-16  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/eieio.el (defmethod): Fix quoting of code (bug#8677).

2011-05-16  Kevin Ryde  <user42@zip.com.au>

	* info-look.el (makefile-automake-mode): New setups, looking in
	automake manual, then makefile-mode.
	(makefile-mode): Remove automake manual, have it just in
	makefile-automake-mode since there's various things different or
	not relevant to plain make.
	(makefile-mode): Remove "other-modes" non-existent automake-mode,
	believe a hypothetical automake-mode would go to makefile-mode,
	not the other way around.

2011-05-15  Chong Yidong  <cyd@stupidchicken.com>

	* vc/diff-mode.el (diff-fixup-modifs): Locate correct position for
	hunk-end tags (Bug#8672).

	* vc/vc-annotate.el (vc-annotate-mode-map): Bind = to
	vc-annotate-show-diff-revision-at-line (Bug#8671).

2011-05-14  Glenn Morris  <rgm@gnu.org>

	* vc/add-log.el (add-change-log-entry): Don't start adding a new entry
	in the middle of an existing one with multiple authors.  (Bug#8645)
	(change-log-font-lock-keywords): Also handle multiple author lines
	with leading tabs.  (Bug#8644)

	* calendar/appt.el (appt-check): Rename some local variables.
	Some simplification/reordering.

	* mail/feedmail.el (feedmail-confirm-outgoing-timeout)
	(feedmail-sendmail-f-doesnt-sell-me-out)
	(feedmail-queue-slug-suspect-regexp, feedmail-debug)
	(feedmail-debug-sit-for, feedmail-queue-express-hook)
	(feedmail-queue-runner-message-sender): Set :version.
	(bbdb-search, bbdb-records, smtp-via-smtp, smtp-server)
	(bbdb-dwim-net-address, vm-mail): Declare.
	(feedmail-binmail-gnulinuxish-template):
	Rename from feedmail-binmail-linuxish-template.
	(feedmail-buffer-to-smtp, feedmail-vm-mail-mode):
	Use insert-buffer-substring.

2011-05-14  Bill Carpenter  <bill@carpenter.org>

	* mail/feedmail.el (feedmail-patch-level): Increase.
	(feedmail-debug): New custom group.
	(feedmail-confirm-outgoing-timeout)
	(feedmail-sendmail-f-doesnt-sell-me-out)
	(feedmail-queue-slug-suspect-regexp, feedmail-debug)
	(feedmail-debug-sit-for, feedmail-queue-express-hook): New options.
	(feedmail-sender-line, feedmail-from-line)
	(feedmail-fiddle-headers-upwardly, feedmail-enable-spray)
	(feedmail-spray-this-address)
	(feedmail-spray-address-fiddle-plex-list)
	(feedmail-queue-use-send-time-for-date)
	(feedmail-queue-use-send-time-for-message-id)
	(feedmail-last-chance-hook, feedmail-queue-runner-mode-setter)
	(feedmail-buffer-eating-function):
	Doc fixes.
	(feedmail-spray-via-bbdb, feedmail-buffer-to-smtp)
	(feedmail-vm-mail-mode, feedmail-message-action-scroll-up)
	(feedmail-message-action-scroll-down): New functions.
	(feedmail-queue-directory, feedmail-queue-draft-directory):
	Use expand-file-name.
	(feedmail-prompt-before-queue-standard-alist): Add scroll entries.
	Remove C-v help entry.
	(feedmail-queue-buffer-file-name): New variable.
	(feedmail-mail-send-hook-splitter, feedmail-buffer-to-binmail)
	(feedmail-buffer-to-smtpmail, feedmail-queue-express-to-draft)
	(feedmail-message-action-send-strong, feedmail-message-action-edit)
	(feedmail-message-action-draft, feedmail-message-action-draft-strong)
	(feedmail-message-action-queue, feedmail-message-action-queue-strong)
	(feedmail-message-action-toggle-spray)
	(feedmail-run-the-queue-no-prompts)
	(feedmail-run-the-queue-global-prompt, feedmail-queue-reminder)
	(feedmail-look-at-queue-directory, feedmail-queue-subject-slug-maker)
	(feedmail-create-queue-filename, feedmail-rfc822-time-zone):
	(feedmail-fiddle-header, feedmail-give-it-to-buffer-eater)
	(feedmail-envelope-deducer, feedmail-fiddle-from)
	(feedmail-fiddle-sender, feedmail-default-date-generator)
	(feedmail-fiddle-date, feedmail-fiddle-message-id)
	(feedmail-fiddle-spray-address)
	(feedmail-fiddle-list-of-spray-fiddle-plexes)
	(feedmail-fiddle-list-of-fiddle-plexes)
	(feedmail-fill-to-cc-function, feedmail-fill-this-one)
	(feedmail-one-last-look, feedmail-fqm-p): Add debug calls.
	(feedmail-queue-runner-message-sender, feedmail-binmail-template):
	Change default.  Doc fix.
	(feedmail-queue-runner-cleaner-upper): Use feedmail-say-chatter.
	(feedmail-binmail-linuxish-template): New constant.
	(feedmail-buffer-to-sendmail): Doc fix.  Add debug call.
	Respect feedmail-sendmail-f-doesnt-sell-me-out.
	(feedmail-send-it): Add debug call.
	Use feedmail-queue-buffer-file-name, and
	feedmail-send-it-immediately-wrapper.
	(feedmail-message-action-send): Add debug call.
	Use feedmail-send-it-immediately-wrapper.
	(feedmail-queue-express-to-queue): Add debug call.
	Run feedmail-queue-express-hook.
	(feedmail-message-action-help): Add debug call.  Use feedmail-p-h-b-n.
	(feedmail-message-action-help-blat):
	Rename from feedmail-queue-send-edit-prompt-help-first.
	(feedmail-run-the-queue): Add debug call.  Set buffer-file-type.
	Check line-endings.  Handle errors better.
	(feedmail-queue-reminder-brief, feedmail-queue-reminder-medium):
	Doc fix.  Add debug call.
	(feedmail-queue-send-edit-prompt): Doc fix.  Add debug call.
	Use feedmail-queue-send-edit-prompt-inner.
	(feedmail-queue-runner-prompt, feedmail-scroll-buffer): New functions.
	(feedmail-queue-send-edit-prompt-inner): New function, extracted
	from feedmail-queue-send-edit-prompt.
	(feedmail-queue-send-edit-prompt-help)
	(feedmail-queue-send-edit-prompt-help-later): Remove functions.
	(feedmail-tidy-up-slug): Add debug call.
	Respect feedmail-queue-slug-suspect-regexp.
	(feedmail-queue-subject-slug-maker): Use buffer-substring-no-properties.
	(feedmail-dump-message-to-queue): Add debug call.
	Expand queue-directory.
	(feedmail-dump-message-to-queue): Change message slightly.
	Use feedmail-say-chatter.
	(feedmail-rfc822-date): Add debug call.  Bind system-time-locale.
	(feedmail-send-it-immediately-wrapper): New function.
	(feedmail-send-it-immediately): Add debug calls.  Use let not let*.
	Insert empty string rather than newline.  Handle full-frame case.
	Use catch/throw.  Use feedmail-say-chatter.
	(feedmail-fiddle-from): Try mail-host-address.
	(feedmail-default-message-id-generator): Doc fix.
	Bind system-time-locale.  Handle missing end.
	(feedmail-fiddle-x-mailer): Add debug call.
	Handle feedmail-x-mailer-line being nil.
	(feedmail-accume-n-nuke-header, feedmail-deduce-address-list):
	Add debug call.  Use buffer-substring-no-properties.
	(feedmail-say-debug, feedmail-say-chatter): New functions.
	(feedmail-find-eoh): Give an explicit error.

2011-05-13  Ulf Jasper  <ulf.jasper@web.de>

	* net/newst-treeview.el (newsticker-treeview-face): Change default
	family from helvetica to sans.
	(newsticker-treeview-tool-bar-map): Move tool-bar icons to
	etc/images/newsticker.

	* net/newst-reader.el (newsticker-feed-face): Change default
	family from helvetica to sans.

	* net/newst-plainview.el (newsticker-new-item-face)
	(newsticker-old-item-face, newsticker-immortal-item-face)
	(newsticker-obsolete-item-face, newsticker-date-face)
	(newsticker-statistics-face): Change default family from
	helvetica to sans.
	(newsticker--plainview-tool-bar-map): Move tool-bar icons to
	etc/images/newsticker.

	* net/newst-backend.el (newsticker--do-run-auto-mark-filter)
	(newsticker--process-auto-mark-filter-match): Tell user about
	auto-marking.

2011-05-13  Didier Verna  <didier@xemacs.org>

	Common Lisp indentation improvements on defmethod and lambda-lists.
	* emacs-lisp/cl-indent.el: Advertise the changes and remove obsolete
	TODO entries.
	(lisp-lambda-list-keyword-parameter-indentation)
	(lisp-lambda-list-keyword-parameter-alignment)
	(lisp-lambda-list-keyword-alignment): New customizable user options.
	(lisp-indent-defun-method): Improve docstring.
	(extended-loop-p): Fix comment.
	(lisp-indent-lambda-list-keywords-regexp): New variable.
	(lisp-indent-lambda-list): New function.
	(lisp-indent-259): Use it.
	(lisp-indent-defmethod): Support for more than one
	method qualifier and properly indent methods lambda-lists.
	(defgeneric): Provide a missing common-lisp-indent-function property.

2011-05-13  Stefan Monnier  <monnier@iro.umontreal.ca>

	* thingatpt.el (bounds-of-thing-at-point): Return nil rather than
	bounds for the empty string (bug#8667).

2011-05-13  Glenn Morris  <rgm@gnu.org>

	* mail/feedmail.el (feedmail-buffer-to-sendmail): Require sendmail.

	* mail/sendmail.el (sendmail-program): Try executable-find first.
	(sendmail-send-it): `sendmail-program' cannot be unbound.

	* calendar/appt.el (appt-make-list): Simplify.
	(appt-time-msg-list): Doc fix.
	(appt-check): Change mode-line message at the time of the appointment.

2011-05-12  Andreas Schwab  <schwab@linux-m68k.org>

	* progmodes/ld-script.el (ld-script-keywords)
	(ld-script-builtins): Update keywords list.

2011-05-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/grep.el (grep-filter): Don't trip on partial lines.

	* shell.el (shell-completion-vars): New function.
	(shell-mode):
	* simple.el (read-shell-command): Use it.
	(blink-matching-open): No need for " [...]" in minibuffer-message.

2011-05-12  Glenn Morris  <rgm@gnu.org>

	* calendar/appt.el (appt-now-displayed): Remove pointless variable.
	(appt-check): Simplify.

2011-05-12  Eli Zaretskii  <eliz@gnu.org>

	* vc/smerge-mode.el (smerge-resolve): Use null-device rather than a
	literal "/dev/null".

2011-05-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/lisp.el (lisp-complete-symbol, lisp-completion-at-point):
	Fix typo.

2011-05-12  Ralph Schleicher  <rs@ralph-schleicher.de>

	* progmodes/which-func.el (which-function):
	Use add-log-current-defun instead of add-log-current-defun-function,
	which might not be defined (Bug#8260).

2011-05-12  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/bytecomp.el (byte-compile-file-form-defmumble):
	Let byte-compile-initial-macro-environment always take precedence.

2011-05-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* net/rcirc.el: Add support for SSL/TLS connections.
	(rcirc-server-alist): New field `encryption'.
	(rcirc): Check `encryption' settings.
	(rcirc-connect): New arg `encryption'.  Use open-network-stream.
	Merge make-local-variable into `set'.
	(rcirc--connection-open-p): New function.
	(rcirc-send-string, rcirc-clean-up-buffer): Use it to handle case where
	the process is not a network process (e.g. running gnutls-cli).
	(set-rcirc-decode-coding-system, set-rcirc-encode-coding-system):
	Make rcirc-(en|de)code-coding-system local here.
	(rcirc-mode): Merge make-local-variable into `set'.
	(rcirc-parent-buffer): Make permanent buffer-local.
	(rcirc-multiline-minor-mode): Don't do it here.
	(rcirc-switch-to-server-buffer): Don't switch to a random buffer if
	there's no server buffer.

2011-05-11  Glenn Morris  <rgm@gnu.org>

	* newcomment.el (comment-kill): Prefix "unused" local.

	* term/w32console.el (get-screen-color): Declare.

	* emacs-lisp/bytecomp.el (byte-compile-arglist-warn):
	Handle symbol elements of byte-compile-initial-macro-environment.

2011-05-10  Leo Liu  <sdl.web@gmail.com>

	* bookmark.el (bookmark-bmenu-mode-map):
	Bind bookmark-bmenu-search to `/'.

	* mail/footnote.el: Convert to utf-8 encoding.
	(footnote-unicode-string, footnote-unicode-regexp): New variable.
	(Footnote-unicode): New function.
	(footnote-style-alist): Add unicode style to the list.
	(footnote-style): Doc fix.

2011-05-10  Jim Meyering  <meyering@redhat.com>

	Fix doubled-word typos.
	* international/quail.el (quail-insert-kbd-layout): and and -> and.
	* kermit.el: and and -> and.
	* net/ldap.el (ldap-search-internal): to to -> to.
	* progmodes/vhdl-mode.el (vhdl-offsets-alist): Likewise.
	* progmodes/js.el (js-mode): and and -> and.
	* textmodes/artist.el (artist-move-to-xy): at at -> at.
	(artist-draw-region-trim-line-endings): if if -> if.
	And Safetyc -> Safety.
	* textmodes/reftex-dcr.el (reftex-view-crossref): at at -> at a.

2011-05-10  Glenn Morris  <rgm@gnu.org>
	    Stefan Monnier  <monnier@iro.umontreal.ca>

	* files.el (hack-one-local-variable-eval-safep):
	Consider "eval: (foo-mode)" to be safe.  (Bug#8613)

2011-05-10  Glenn Morris  <rgm@gnu.org>

	* calendar/diary-lib.el (diary-list-entries-hook)
	(diary-mark-entries-hook, diary-nongregorian-listing-hook)
	(diary-nongregorian-marking-hook, diary-list-entries)
	(diary-include-other-diary-files, diary-mark-entries)
	(diary-mark-included-diary-files): Doc fixes.

2011-05-09  Juanma Barranquero  <lekktu@gmail.com>

	* misc.el: Require tabulated-list.el during compilation.

2011-05-09  Chong Yidong  <cyd@stupidchicken.com>

	* progmodes/compile.el (compilation-start):
	Run compilation-filter-hook for the async case too.
	(compilation-filter-hook): Doc fix.

2011-05-09  Deniz Dogan  <deniz@dogan.se>

	* wdired.el: Remove outdated installation comment.  Fix usage
	comment.

2011-05-09  Juanma Barranquero  <lekktu@gmail.com>

	* misc.el: Implement new command `list-dynamic-libraries'.
	(list-dynamic-libraries--loaded-only-p): New variable.
	(list-dynamic-libraries--refresh): New function.
	(list-dynamic-libraries): New command.

2011-05-09  Chong Yidong  <cyd@stupidchicken.com>

	* progmodes/compile.el (compilation-error-regexp-alist-alist):
	Fix the ant regexp to handle end-line and end-column info from jikes.
	Re-introduce maven regexp.  Give the ruby-Test::Unit regexp a
	higher priority to avoid clobbering by gnu.

2011-05-08  Chong Yidong  <cyd@stupidchicken.com>

	* cus-face.el (custom-declare-face): Call custom-theme-recalc-face
	if the face has existing theme settings (Bug#8454).

2011-05-08  Ralph Schleicher  <rs@ralph-schleicher.de>

	* progmodes/perl-mode.el (perl-imenu-generic-expression):
	Only match variables declared via `my' or `our' (Bug#8261).

	* net/browse-url.el (browse-url-of-dired-file): Allow browsing of
	special file names `.' and `..' (Bug#8259).

2011-05-08  Chong Yidong  <cyd@stupidchicken.com>

	* progmodes/grep.el (grep-mode-font-lock-keywords):
	Remove buffer-changing entries.
	(grep-filter): New function.
	(grep-mode): Add it to compilation-filter-hook.

	* progmodes/compile.el (compilation-filter-hook)
	(compilation-filter-start): New defvars.
	(compilation-filter): Call compilation-filter-hook prior to
	updating the process mark.

2011-05-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/eieio.el (defmethod): Fix typo in last change.

2011-05-07  Eli Zaretskii  <eliz@gnu.org>

	* mail/sendmail.el (send-mail-function): On MS-Windows, default to
	mailclient-send-it even if window-system is nil.  (Bug#8595)

	* term/w32console.el (terminal-init-w32console):
	Call get-screen-color and use its output to set the frame
	background-mode.  (Bug#8597)

2011-05-07  Stefan Monnier  <monnier@iro.umontreal.ca>

	Make bytecomp.el understand that defmethod defines funs (bug#8631).
	* emacs-lisp/eieio.el (eieio--defalias, eieio--defgeneric-init-form):
	New functions.
	(defgeneric, eieio--defmethod): Use them.
	(eieio-defgeneric): Remove.
	(defmethod): Call defgeneric in a way visible to the byte-compiler.

2011-05-07  Glenn Morris  <rgm@gnu.org>

	* calendar/timeclock.el (timeclock-log-data): Remove unused local.
	Use let rather than let*.
	(timeclock-find-discrep): Remove unused local.

	* calendar/diary-lib.el (diary-comment-start): Doc fix.

	* calendar/appt.el (appt-time-msg-list): Doc fix.

2011-05-06  Noah Friedman  <friedman@splode.com>

	* apropos.el (apropos-print-doc): Only use
	emacs-lisp-docstring-fill-column when it is bound to an integer,
	per that variable's documentation.

2011-05-06  Stefan Monnier  <monnier@iro.umontreal.ca>

	* lpr.el (print-region-1): Echo lpr-program's output, so error messages
	and warnings are not silently discarded (e.g. use -d instead of -P).

2011-05-06  Glenn Morris  <rgm@gnu.org>

	* calendar/appt.el (appt-message-warning-time): Doc fix.
	(appt-warning-time-regexp): New option.
	(appt-make-list): Respect appt-message-warning-time.

	* calendar/diary-lib.el (diary-comment-start, diary-comment-end):
	New options.
	(diary-add-to-list): Strip comments from the displayed string.
	(diary-mode): Set comment-start and comment-end.

	* vc/diff-mode.el (smerge-refine-subst): Declare.
	(diff-refine-hunk): Don't require smerge-mode when compiling.

2011-05-06  Juanma Barranquero  <lekktu@gmail.com>

	* simple.el (list-processes): Return nil as the docstring says.

2011-05-05  Michael Albinus  <michael.albinus@gmx.de>

	* net/ange-ftp.el (ange-ftp-binary-file-name-regexp): Set default
	to "".
	(ange-ftp-write-region, ange-ftp-insert-file-contents)
	(ange-ftp-copy-file-internal): Use only `ange-ftp-binary-file' for
	determining of binary transfer.  (Bug#7383)

2011-05-05  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-sh.el (tramp-do-copy-or-rename-file-out-of-band):
	Fix port computation bug.  (Bug#8618)

2011-05-05  Glenn Morris  <rgm@gnu.org>

	* allout-widgets.el (allout-widgets-mode-inhibit): Declare before use.

	* simple.el (shell-dynamic-complete-functions)
	(comint-dynamic-complete-functions): Declare.

	* net/network-stream.el (gnutls-negotiate):
	* simple.el (tabulated-list-print): Fix declarations.

	* progmodes/gud.el (syntax-symbol, syntax-point):
	Remove unnecessary and incorrect declarations.

	* emacs-lisp/check-declare.el (check-declare-scan):
	Handle byte-compile-initial-macro-environment in bytecomp.el.

2011-05-05  Stefan Monnier  <monnier@iro.umontreal.ca>

	Fix earlier half-done eieio-defmethod change (bug#8338).
	* emacs-lisp/eieio.el (eieio--defmethod): Rename from eieio-defmethod.
	Streamline and change calling convention.
	(defmethod): Adjust accordingly and simplify.
	(eieio-defclass): Fix broken calls to eieio-defmethod and redirect to
	new eieio--defmethod.
	(slot-boundp): Minor CSE simplification.

2011-05-05  Milan Zamazal  <pdm@zamazal.org>

	* progmodes/glasses.el (glasses-separate-capital-groups): New option.
	(glasses-make-readable): Use glasses-separate-capital-groups.

2011-05-05  Juanma Barranquero  <lekktu@gmail.com>

	* emacs-lisp/warnings.el (warning-level-aliases): Reflow docstring.
	(warning-series): Doc fix.
	(display-warning): Don't try to create the buffer if we just found it.

2011-05-04  Chong Yidong  <cyd@stupidchicken.com>

	* emacs-lisp/autoload.el (generated-autoload-file): Set to nil.
	(autoload-find-generated-file): New function.
	(generate-file-autoloads): Bind generated-autoload-file to
	buffer-file-name.
	(update-file-autoloads, update-directory-autoloads):
	Use autoload-find-generated-file.  If called interactively, prompt for
	output file (Bug#7989).
	(batch-update-autoloads): Doc fix.

2011-05-04  Juanma Barranquero  <lekktu@gmail.com>

	* term/w32-win.el (dynamic-library-alist): Add `gnutls'.

2011-05-04  Glenn Morris  <rgm@gnu.org>

	* calendar/diary-lib.el (diary-fancy-date-pattern): Turn it into a
	function, so it follows changes in calendar-date-style.
	(diary-fancy-date-matcher): New function.
	(diary-fancy-font-lock-keywords): Use diary-fancy-date-matcher.
	(diary-fancy-font-lock-fontify-region-function):
	Use diary-fancy-date-pattern as a function.

	* calendar/diary-lib.el (diary-fancy-date-pattern): Do not use
	non-numbers for `year' etc pseudo-variables.  (Bug#8583)

2011-05-04  Teodor Zlatanov  <tzz@lifelogs.com>

	* net/gnutls.el (gnutls-negotiate): Use CL-style keyword arguments
	instead of positional arguments.  Allow :keylist and :crlfiles
	arguments.
	(open-gnutls-stream): Call it.

	* net/network-stream.el (network-stream-open-starttls): Adjust to
	call `gnutls-negotiate' with :process and :hostname arguments.

2011-05-04  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuffer.el (completion--message): New function.
	(completion--do-completion, minibuffer-complete)
	(minibuffer-force-complete, minibuffer-complete-word): Use it.
	(completion--do-completion): Don't ignore completion-auto-help when in
	icomplete-mode.

	* whitespace.el (whitespace-trailing-regexp): Don't rely on the
	internal encoding (e.g. tibetan zero is not whitespace).
	(global-whitespace-mode): Prefer save-current-buffer.
	(whitespace-trailing-regexp): Remove useless save-match-data.
	(whitespace-empty-at-bob-regexp): Minor simplification.

2011-05-03  Chong Yidong  <cyd@stupidchicken.com>

	* emacs-lisp/autoload.el (generated-autoload-file): Doc fix (Bug#7989).

2011-05-03  Agustín Martín Domingo  <agustin.martin@hispalinux.es>

	* textmodes/ispell.el (ispell-add-per-file-word-list):
	Use `concat' to create string for insertion.

2011-05-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/bibtex.el (bibtex-fill-field-bounds, bibtex-fill-entry):
	Avoid open-line which runs post-self-insert-hook.
	(bibtex-fill-entry): Remove unused `end' var.

2011-05-03  Dirk Ullrich  <dirk.ullrich@googlemail.com>  (tiny change)

	* textmodes/ispell.el (ispell-add-per-file-word-list):
	Protect against `nil' value of `comment-start' (Bug#8579).

2011-05-03  Leo Liu  <sdl.web@gmail.com>

	* isearch.el (isearch-yank-pop): New command.
	(isearch-mode-map): Bind it to `M-y'.
	(isearch-forward): Mention it.

2011-05-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	* simple.el (minibuffer-complete-shell-command): Remove.
	(minibuffer-local-shell-command-map): Use completion-at-point.
	(read-shell-command): Setup completion vars here instead.
	(read-expression-map): Bind TAB to symbol completion.

	* textmodes/ispell.el (lookup-words): Use with-temp-buffer; signal
	error directly rather via storing it into `results'.

2011-05-02  Leo Liu  <sdl.web@gmail.com>

	* vc/diff.el: Fix description.

2011-05-02  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* server.el (server-eval-at): New function.

2011-05-01  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* net/network-stream.el (open-network-stream): Take a :nowait
	parameter and pass it on to `make-network-process'.
	(network-stream-open-plain): Ditto.

2011-04-30  Andreas Schwab  <schwab@linux-m68k.org>

	* faces.el (face-spec-set-match-display): Don't match toolkit
	options on terminal frames.

2011-04-29  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/pascal.el: Use lexical binding.
	(pascal-mode-map): Remove author preferences.

	* pcomplete.el (pcomplete-std-complete): Don't abuse
	completion-at-point.

2011-04-28  Juanma Barranquero  <lekktu@gmail.com>

	* calc/calccomp.el (math-comp-to-string-flat-term): Simplify by
	removing code that has been dead since 1991 or so.

	* startup.el (command-line): When warning about "_emacs", use a
	delayed warning to allow the user to filter it out.

2011-04-28  Deniz Dogan  <deniz@dogan.se>

	* net/rcirc.el (rcirc-handler-353): Fix bug for channels which the
	user has not joined.

2011-04-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* pcomplete.el (pcomplete-completions-at-point): Return nil if there
	aren't any completions at point.

2011-04-28  Juanma Barranquero  <lekktu@gmail.com>

	* subr.el (display-delayed-warnings): New function.
	(delayed-warnings-hook): New variable.

2011-04-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuffer.el (completion-at-point, completion-help-at-point):
	Don't presume that a given completion-at-point-function will always
	use the same calling convention.

	* pcomplete.el (pcomplete-completions-at-point):
	Obey pcomplete-ignore-case.  Don't call pcomplete-norm-func unless
	pcomplete-seen is non-nil.
	(pcomplete-comint-setup): Also recognize the new comint/shell
	completion functions.
	(pcomplete-do-complete): Don't call pcomplete-norm-func unless
	pcomplete-seen is non-nil.

2011-04-27  Niels Giesen  <niels.giesen@gmail.com>

	* calendar/icalendar.el (diary-lib): Add require statement.
	(icalendar--create-uid): Read out a uid from a text-property on
	the first character in the entry.  This allows for code to add its
	own uid to the entry.
	(icalendar--convert-float-to-ical): Add export of
	`diary-float'-entries save for those with the optional DAY
	argument.

2011-04-27  Daniel Colascione  <dan.colascione@gmail.com>

	* subr.el (shell-quote-argument): Use alternate escaping strategy
	when we spot a variable reference in a string.

2011-04-26  Daniel Colascione  <dan.colascione@gmail.com>

	* cus-start.el (all): Define customization for debug-on-event.

2011-04-26  Daniel Colascione  <dan.colascione@gmail.com>

	* subr.el (shell-quote-argument): Escape correctly under Windows.

2011-04-25  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emulation/cua-base.el (cua-selection-mode): Make it toggle again.

2011-04-25  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-process-actions): Add POS argument.
	Delete region between POS and (pos).

	* net/tramp-sh.el (tramp-do-copy-or-rename-file-out-of-band):
	Use `nil' position in `tramp-process-actions' call.
	(tramp-maybe-open-connection): Call `tramp-process-actions' with pos.

	* net/tramp-smb.el (tramp-smb-maybe-open-connection): Use `nil'
	position in `tramp-process-actions' call.

	* net/trampver.el: Update release number.

2011-04-25  Stefan Monnier  <monnier@iro.umontreal.ca>

	* custom.el (defcustom): Obey lexical-binding.

	Fix octave-inf completion problems reported by Alexander Klimov.
	* progmodes/octave-inf.el (inferior-octave-mode-syntax-table):
	Inherit from octave-mode-syntax-table.
	(inferior-octave-mode): Set info-lookup-mode.
	(inferior-octave-completion-at-point): New function.
	(inferior-octave-complete): Use it and completion-in-region.
	(inferior-octave-dynamic-complete-functions): Use it as well, and use
	comint-filename-completion.
	* progmodes/octave-mod.el (octave-mode-syntax-table): Use _ syntax for
	symbol elements which shouldn't be word elements.
	(octave-font-lock-keywords, octave-beginning-of-defun)
	(octave-function-header-regexp): Adjust regexps accordingly.
	(octave-mode-map): Also use info-lookup-symbol for C-c C-h.

2011-04-25  Juanma Barranquero  <lekktu@gmail.com>

	* net/gnutls.el (gnutls-errorp): Declare before first use.

2011-04-24  Teodor Zlatanov  <tzz@lifelogs.com>

	* net/gnutls.el (gnutls-negotiate): Add hostname, verify-flags,
	verify-error, and verify-hostname-error parameters.  Check whether
	default trustfile exists before going to use it.  Add missing
	argument to gnutls-message-maybe call.  Return value.
	Reported by Claudio Bley <claudio.bley@gmail.com>.
	(open-gnutls-stream): Add usage example.

	* net/network-stream.el (network-stream-open-starttls): Give host
	parameter to `gnutls-negotiate'.
	(gnutls-negotiate): Adjust `gnutls-negotiate' declaration.
	* subr.el (shell-quote-argument): Escape correctly under Windows.

2011-04-24  Daniel Colascione  <dan.colascione@gmail.com>

	* progmodes/cc-engine.el (c-forward-decl-or-cast-1):
	Use correct match group (bug#8438).

2011-04-24  Chong Yidong  <cyd@stupidchicken.com>

	* emacs-lisp/package.el (package-built-in-p): Fix typo.
	(package-menu--generate): New arg specifying packages to show.
	(package-menu-refresh, package-menu-execute, list-packages):
	Callers changed.
	(package-show-package-list): New function, replacing deleted
	package--list-packages (renamed because it is non-internal).

	* finder.el (finder-list-matches): Use package-show-package-list
	instead of deleted package--list-packages.

	* vc/vc-annotate.el (vc-annotate-goto-line): New command.
	Based on a previous implementation by Juanma Barranquero (Bug#8366).
	(vc-annotate-mode-map): Bind it to RET.

2011-04-24  Uday S Reddy  <u.s.reddy@cs.bham.ac.uk>  (tiny change)

	* progmodes/etags.el (next-file): Don't use set-buffer to change
	buffers (Bug#8478).

2011-04-24  Chong Yidong  <cyd@stupidchicken.com>

	* files.el (auto-mode-alist): Use js-mode for .json (Bug#8529).

	* apropos.el (apropos-label-face): Avoid variable-pitch face.
	(apropos-accumulator): Doc fix.
	(apropos-function, apropos-macro, apropos-command)
	(apropos-variable, apropos-face, apropos-group, apropos-widget)
	(apropos-plist): Add face property.
	(apropos-symbols-internal): Fix indentation.
	(apropos-print): Simplify help, and recognize apropos-multi-type.
	(apropos-print-doc): Use button-type-get to extract the button's
	face property.  Fill docstring (Bug#8352).

2011-04-23  Juanma Barranquero  <lekktu@gmail.com>

	* buff-menu.el (Buffer-menu--buffers): Fix typo in docstring (bug#8535).

	* play/mpuz.el (mpuz-silent): Doc fix.
	(mpuz-mode-map): Use mapc.
	(mpuz-put-number-on-board): Rename parameter L to COLUMNS.
	(mpuz-letter-to-digit, mpuz-check-all-solved, mpuz-create-buffer):
	Fix typos in docstrings.

	* play/doctor.el (doc$, doctor-$, doctor-read-print, doctor-read-token)
	(doctor-nounp, doctor-pronounp): Fix typos in docstrings.

	* mouse-drag.el (mouse-drag-throw): Fix typo in docstring.

2011-04-23  Chong Yidong  <cyd@stupidchicken.com>

	* minibuffer.el (completion--do-completion): Avoid the "Next char
	not unique" prompt if icomplete-mode is enabled (Bug#5849).

	* mouse.el (mouse-drag-mode-line-1): Make sure that if we push
	mouse-2 into unread-command-events, it is interpreted correctly.

	* image-mode.el (image-type, image-mode-map, image-minor-mode-map)
	(image-toggle-display): Doc fix.

2011-04-23  Stephen Berman  <stephen.berman@gmx.net>

	* textmodes/page.el (what-page): Use line-number-at-pos to
	calculate line number (Bug#6825).

2011-04-22  Juanma Barranquero  <lekktu@gmail.com>

	* eshell/esh-mode.el (find-tag-interactive): Declare function.
	(eshell-find-tag): Remove `with-no-warnings', unneeded now.
	Pass argument NO-DEFAULT to `find-tag-interactive'.

2011-04-22  Juanma Barranquero  <lekktu@gmail.com>

	Lexical-binding cleanup.

	* progmodes/ada-mode.el (ada-after-change-function, ada-loose-case-word)
	(ada-no-auto-case, ada-capitalize-word, ada-untab, ada-narrow-to-defun):
	* progmodes/ada-prj.el (ada-prj-initialize-values)
	(ada-prj-display-page, ada-prj-field-modified, ada-prj-display-help)
	(ada-prj-show-value):
	* progmodes/ada-xref.el (ada-find-any-references, ada-gdb-application):
	* progmodes/antlr-mode.el (antlr-with-displaying-help-buffer)
	(antlr-invalidate-context-cache, antlr-options-menu-filter)
	(antlr-language-option-extra, antlr-c++-mode-extra, antlr-run-tool):
	* progmodes/bug-reference.el (bug-reference-push-button):
	* progmodes/fortran.el (fortran-line-length):
	* progmodes/glasses.el (glasses-change):
	* progmodes/octave-mod.el (octave-fill-paragraph):
	* progmodes/python.el (python-mode, python-pdbtrack-track-stack-file)
	(python-pdbtrack-grub-for-buffer, python-sentinel):
	* progmodes/sql.el (sql-save-connection):
	* progmodes/tcl.el (tcl-indent-command, tcl-popup-menu):
	* progmodes/xscheme.el (xscheme-enter-debugger-mode):
	Mark unused parameters.

	* progmodes/compile.el (compilation--flush-directory-cache)
	(compilation--flush-parse, compile-internal): Mark unused parameters.
	(compilation-buffer-name): Rename parameter MODE-NAME to NAME-OF-MODE.
	(compilation-next-error-function): Remove unused variable `timestamp'.

	* progmodes/cpp.el (cpp-parse-close): Remove unused variable `begin'.
	(cpp-signal-read-only, cpp-grow-overlay): Mark unused parameters.

	* progmodes/dcl-mode.el (dcl-end-of-command):
	Remove unused variable `start'.
	(dcl-calc-command-indent-multiple, dcl-calc-cont-indent-relative)
	(dcl-option-value-basic, dcl-option-value-offset)
	(dcl-option-value-margin-offset, dcl-option-value-comment-line):
	Mark unused parameters.
	(dcl-save-local-variable): Remove unused variable `val'.
	(mode): Declare.

	* progmodes/delphi.el (delphi-save-state, delphi-after-change):
	Mark unused parameters.
	(delphi-ignore-changes): Move before first use.
	(delphi-charset-token-at): Remove unused variable `start'.
	(delphi-else-start): Remove unused variable `if-count'.
	(delphi-comment-block-start, delphi-comment-block-end):
	Remove unused variable `kind'.
	(delphi-indent-line): Remove unused variable `new-point'.

	* progmodes/ebrowse.el (ebrowse-files-list)
	(ebrowse-list-of-matching-members, ebrowse-tags-list-members-in-file):
	Mark unused parameters.  Don't quote `lambda'.
	(ebrowse-sort-tree-list, ebrowse-same-tree-member-buffer-list):
	Don't quote `lambda'.
	(ebrowse-revert-tree-buffer-from-file, ebrowse-tags-choose-class)
	(ebrowse-goto-visible-member/all-member-lists): Mark unused parameters.
	(ebrowse-create-tree-buffer): Rename parameter OBARRAY to CLASSES.
	(ebrowse-toggle-mark-at-point): Remove unused variable `pnt'.
	Use `ignore-errors'.
	(ebrowse-frozen-tree-buffer-name, ebrowse-find-source-file)
	(ebrowse-view/find-file-and-search-pattern)
	(ebrowse-view/find-member-declaration/definition):
	Rename parameter TAGS-FILE-NAME to TAGS-FILE.
	(ebrowse-find-class-declaration, ebrowse-view-class-declaration):
	Rename parameter PREFIX-ARG to PREFIX.
	(ebrowse-tags-read-name): Remove unused variables `start' and
	`member-info'.
	(ebrowse-display-member-buffer): Rename variable `tags-file-name'
	to `tags-file'.

	* progmodes/etags.el (local-find-tag-hook): Declare.
	(tag-partial-file-name-match-p, tag-any-match-p, list-tags):
	Mark unused parameters.

	* progmodes/executable.el (compilation-error-regexp-alist): Declare.
	(executable-interpret): Mark unused parameter.

	* progmodes/flymake.el (flymake-process-sentinel)
	(flymake-after-change-function)
	(flymake-create-temp-with-folder-structure)
	(flymake-get-include-dirs-dot): Mark unused parameters.
	(flymake-safe-delete-directory): Remove unused variable `err'.

	* progmodes/gdb-mi.el (speedbar-change-initial-expansion-list)
	(speedbar-timer-fn, speedbar-line-text)
	(speedbar-change-expand-button-char, speedbar-delete-subblock)
	(speedbar-center-buffer-smartly): Declare functions.
	(gdb-find-watch-expression): Remove unused variable `array'.
	(gdb-edit-value, gdb-gdb, gdb-ignored-notification, gdb-thread-created)
	(gdb-starting): Mark unused parameters.
	(gud-gdbmi-marker-filter): Remove unused variable `output-record'.
	(gdb-table-string): Remove unused variable `res'.
	(gdb-place-breakpoints): Remove unused variables `flag' and `bptno'.
	(gdb-disassembly-handler-custom): Remove unused variable `pos'.
	(gdb-display-buffer): Remove unused variable `cur-size'.

	* progmodes/gud.el (gud-def): Use `defalias' instead of `defun' to
	allow lexical-binding compilation.
	(gud-expansion-speedbar-buttons, gud-gdb-goto-stackframe)
	(gud-dbx-massage-args, gud-xdb-massage-args, gud-perldb-massage-args)
	(gud-jdb-massage-args, gud-jdb-find-source, gud-find-class):
	Mark unused parameters.
	(gud-gdb-marker-filter): Remove unused variable `match'.
	(gud-find-class): Bind `syntax-symbol' and `syntax-point' to suitable
	lambda expressions and funcall them, instead of using `fset'.

	* progmodes/hideif.el (hif-parse-if-exp): Rename parameter
	HIF-TOKEN-LIST to TOKEN-LIST and let-bind `hif-token-list'.

	* progmodes/hideshow.el (hs-hide-block-at-point): Remove unused
	variable `header-beg'; use `let'.

	* progmodes/icon.el (indent-icon-exp): Remove unused variables
	`restart', `last-sexp' and `at-do'.

	* progmodes/js.el (js--debug): Mark unused parameter.
	(js--parse-state-at-point): Remove unused variable `bound'; use `let'.
	(js--splice-into-items): Remove unused variable `item'.
	(js--read-symbol, js--read-tab): Pass 1/-1 to `ido-mode', not t/nil.

	* progmodes/make-mode.el (makefile-make-font-lock-keywords):
	Rename parameter FONT-LOCK-KEYWORDS to FL-KEYWORDS.
	(makefile-complete): Remove unused variable `try'.
	(makefile-fill-paragraph, makefile-match-function-end):
	Mark unused parameters.

	* progmodes/octave-inf.el (inferior-octave-complete):
	Remove unused variable `proc'.
	(inferior-octave-output-digest): Mark unused parameter.

	* progmodes/perl-mode.el (perl-calculate-indent):
	Remove unused variable `err'.

	* progmodes/prolog.el (prolog-mode-keybindings-inferior)
	(prolog-indent-line): Mark unused parameters.
	(prolog-indent-line): Remove unused variable `beg'.

	* progmodes/ps-mode.el (reporter-prompt-for-summary-p)
	(reporter-dont-compact-list): Declare.

	* progmodes/sh-script.el (sh-font-lock-quoted-subshell):
	Remove unused variable `char'.
	(sh-debug): Mark unused parameter.
	(sh-get-indent-info): Remove unused variable `start'.
	(sh-calculate-indent): Remove unused variable `var'.

	* progmodes/simula.el (simula-popup-menu): Mark unused parameter.
	(simula-electric-keyword): Remove unused variable `null'.
	(simula-search-backward, simula-search-forward): Remove unused
	variables `begin' and `end'.

	* progmodes/vera-mode.el (vera-guess-basic-syntax):
	Remove unused variable `pos'.
	(vera-electric-tab, vera-comment-uncomment-region):
	Mark unused parameters.
	(vera-electric-tab): Rename parameter PREFIX-ARG to PREFIX.

2011-04-22  Chong Yidong  <cyd@stupidchicken.com>

	* emacs-lisp/package.el (package--builtins, package-alist)
	(package-load-descriptor, package-built-in-p, package-activate)
	(define-package, package-installed-p)
	(package-compute-transaction, package-buffer-info)
	(package--push): Doc fix.  Distinguish more clearly between
	version strings and version lists.

2011-04-21  Juanma Barranquero  <lekktu@gmail.com>

	Lexical-binding cleanup.

	* play/5x5.el (5x5-make-random-solution, 5x5-make-mutate-current)
	(5x5-make-mutate-best):
	* play/fortune.el (fortune-in-buffer):
	* play/gomoku.el (gomoku-init-display):
	* play/solitaire.el (solitaire, solitaire-do-check):
	* play/tetris.el (tetris-default-update-speed-function):
	Mark unused parameters.

	* play/bubbles.el (bubbles-mode): Set `show-trailing-whitespace'.
	(bubbles--shift): Remove unused variable `char-org'.
	(bubbles--set-faces): Remove unused variable `fg-col'.  Simplify.
	(bubbles--show-images): Remove unused variable `char'.

	* play/decipher.el (decipher-keypress, decipher-alphabet-keypress)
	(decipher-get-undo, decipher-set-map, decipher-complete-alphabet)
	(decipher-resync, decipher-loop-with-breaks, decipher--analyze)
	(decipher-analyze-buffer): Use ?\s.
	(decipher-make-checkpoint): Remove unused variable `mapping'.

	* play/doctor.el (doctor-doc): Rename parameter DOCTOR-SENT to SENT.

	* play/gamegrid.el (gamegrid-add-score-with-update-game-score):
	Remove unused variable `result'; use `let'.

	* play/gametree.el (gametree-current-layout, gametree-apply-layout):
	Rename parameter TOP-LEVEL to FROM-TOP-LEVEL; use `ignore-errors'.
	(gametree-children-shown-p, gametree-compute-reduced-score):
	Use `ignore-errors'.

	* play/handwrite.el (ps-lpr-switches): Declare.
	(handwrite): Remove unused variables `pmin' and `lastp'.

	* play/hanoi.el (hanoi-move-ring): Remove unused variable `total-steps'.

	* play/landmark.el (landmark-init-display)
	(landmark-update-naught-weights): Mark unused parameters.
	(landmark-y): Remove unused variable `noise'.  Simplify.
	(landmark-human-plays): Remove unused variable `score'.

	* play/mpuz.el (mpuz-try-letter): Remove unused variable `message'.
	(mpuz-try-proposal): Remove unused variable `game'.

	* play/zone.el (life-patterns): Declare.

2011-04-20  Juanma Barranquero  <lekktu@gmail.com>

	* vc/vc.el (ediff-vc-internal): Declare function.

2011-04-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* shell.el: Use lexical-binding and std completion UI.
	(shell-filter-ctrl-a-ctrl-b): Work as a preoutput filter.
	(shell-mode): Put shell-filter-ctrl-a-ctrl-b on
	comint-preoutput-filter-functions rather than on
	comint-output-filter-functions.
	(shell-command-completion, shell--command-completion-data)
	(shell-filename-completion, shell-environment-variable-completion)
	(shell-c-a-p-replace-by-expanded-directory): New functions.
	(shell-dynamic-complete-functions, shell-dynamic-complete-command)
	(shell-dynamic-complete-filename, shell-replace-by-expanded-directory)
	(shell-dynamic-complete-environment-variable): Use them.
	(shell-dynamic-complete-as-environment-variable)
	(shell-dynamic-complete-as-command): Remove.
	(shell-match-partial-variable): Match past point.
	* comint.el: Clean up use of completion-at-point-functions.
	(comint-completion-at-point): New function.
	(comint-mode): Use it completion-at-point-functions.
	(comint-dynamic-complete): Make it obsolete.
	(comint-replace-by-expanded-history-before-point): Add dry-run arg.
	(comint-c-a-p-replace-by-expanded-history): New function.
	(comint-dynamic-complete-functions)
	(comint-replace-by-expanded-history): Use it.
	* minibuffer.el (completion-table-with-terminator): Allow dynamic
	termination strings.  Try harder to avoid second try-completion.
	(completion-in-region-mode-map): Disable bindings that don't work yet.

	* comint.el: Use lexical-binding.  Require CL.
	(comint-dynamic-complete-functions): Use comint-filename-completion.
	(comint-completion-addsuffix): Tweak custom type.
	(comint-filename-completion, comint--common-suffix)
	(comint--common-quoted-suffix, comint--table-subvert)
	(comint--complete-file-name-data): New functions.
	(comint-dynamic-complete-as-filename, comint-dynamic-complete-filename)
	(comint-dynamic-list-filename-completions): Use them.
	(comint-dynamic-simple-complete): Make obsolete.

	* minibuffer.el (completion-in-region-mode):
	Keep completion-in-region-mode--predicate global.
	(completion-in-region--postch):
	Assume completion-in-region-mode--predicate is not null.

	* progmodes/flymake.el (flymake-start-syntax-check-process):
	Obey `dir'.  Simplify.

	* vc/vc.el (vc-version-ediff): Call ediff-vc-internal directly, since
	we're in VC after all.

2011-04-20  Christoph Scholtes  <cschol2112@googlemail.com>

	* vc/vc.el (vc-diff-build-argument-list-internal)
	(vc-version-ediff, vc-ediff): New commands.
	(vc-version-diff): Use vc-diff-build-argument-list-internal.

2011-04-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/byte-opt.el (byte-decompile-bytecode-1): Remove dead code,
	add sanity check.

	* obsolete/erc-hecomplete.el: Make obsolete.
	* obsolete/: Standardize obsolescence info in the header.

2011-04-20  Glenn Morris  <rgm@gnu.org>

	* calendar/solar.el (solar-horizontal-coordinates):
	Use the longitude argument rather than `calendar-longitude'.
	(solar-date-next-longitude): Remove unused locals.

2011-04-20  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* whitespace.el: New version 13.2.1.

2011-04-20  felix  <EmacsWiki>  (tiny change)

	* whitespace.el (global-whitespace-mode): Keep highlight when
	switching between major modes on a file.

2011-04-19  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/octave-mod.el (octave-in-comment-p, octave-in-string-p)
	(octave-not-in-string-or-comment-p): Use syntax-ppss so it works with
	multi-line comments as well.

2011-04-19  Juanma Barranquero  <lekktu@gmail.com>

	Lexical-binding cleanup.

	* arc-mode.el (archive-mode-revert):
	* cmuscheme.el (scheme-interactively-start-process):
	* custom.el (custom-initialize-delay):
	* dnd.el (dnd-open-local-file, dnd-open-remote-url):
	* dos-w32.el (direct-print-region-helper, direct-print-region-function):
	* emacs-lock.el (emacs-lock-clear-sentinel):
	* ezimage.el (defezimage):
	* follow.el (follow-avoid-tail-recenter):
	* fringe.el (set-fringe-mode-1):
	* generic-x.el (bat-generic-mode-compile):
	* help-mode.el (help-info-variable, help-do-xref)
	(help-mode-revert-buffer):
	* help.el (view-emacs-todo):
	* iswitchb.el (iswitchb-completion-help):
	* jka-compr.el (jka-compr-make-temp-name, jka-compr-load):
	* kmacro.el (kmacro-cycle-ring-next, kmacro-cycle-ring-previous)
	(kmacro-delete-ring-head, kmacro-bind-to-key, kmacro-view-macro):
	* locate.el (locate-update):
	* longlines.el (longlines-encode-region)
	(longlines-after-change-function):
	* outline.el (outline-isearch-open-invisible):
	* ps-def.el (declare-function, charset-dimension, char-width)
	(encode-char):
	* ps-mule.el (ps-mule-plot-string):
	* recentf.el (recentf-make-menu-items, recentf-cancel-dialog)
	(recentf-edit-list-select, recentf-edit-list-validate)
	(recentf-open-files-action):
	* rect.el (delete-whitespace-rectangle-line)
	(rectangle-number-line-callback):
	* register.el (window-configuration-to-register)
	(frame-configuration-to-register):
	* scroll-bar.el (scroll-bar-mode, toggle-horizontal-scroll-bar):
	* select.el (xselect-convert-to-string, xselect-convert-to-length)
	(xselect-convert-to-targets, xselect-convert-to-delete)
	(xselect-convert-to-filename, xselect-convert-to-charpos)
	(xselect-convert-to-lineno, xselect-convert-to-colno)
	(xselect-convert-to-os, xselect-convert-to-host)
	(xselect-convert-to-user, xselect-convert-to-class)
	(xselect-convert-to-name, xselect-convert-to-integer)
	(xselect-convert-to-atom, xselect-convert-to-identity):
	* subr.el (declare, ignore, process-kill-without-query)
	(text-clone-maintain):
	* terminal.el (te-get-char, te-tic-sentinel):
	* tool-bar.el (tool-bar-make-keymap):
	* tooltip.el (tooltip-timeout, tooltip-hide, tooltip-help-tips):
	* type-break.el (type-break-mode, type-break-noninteractive-query):
	* view.el (View-back-to-mark):
	* wid-browse.el (widget-browse-action, widget-browse-widget)
	(widget-browse-widgets, widget-browse-sexp):
	* widget.el (define-widget-keywords):
	* xt-mouse.el (xterm-mouse-translate, turn-off-xterm-mouse-tracking):
	Mark unused parameters.

	* align.el (align-adjust-col-for-rule): Mark unused parameter.
	(align-areas): Remove unused variable `look'.
	(align-region): Remove unused variables `real-end' and `pos-list'.

	* apropos.el (apropos-score-doc): Remove unused variable `i'.

	* bindings.el (mode-line-modified, mode-line-remote):
	Mark unused parameters.
	(mode-line-mule-info): Mark unused parameter; don't quote `lambda'.

	* buff-menu.el (Buffer-menu-revert-function): Mark unused parameters.
	(Buffer-menu-mode): Mark unused parameter; don't quote `lambda'.

	* comint.el (comint-history-isearch-pop-state)
	(comint-postoutput-scroll-to-bottom, comint-truncate-buffer)
	(comint-strip-ctrl-m, comint-read-noecho): Mark unused parameters.
	(comint-substitute-in-file-name): Doc fix.

	* completion.el (cmpl-statistics-block): Mark unused parameter.
	(add-completions-from-tags-table, add-completions-from-lisp-buffer)
	(save-completions-to-file, load-completions-from-file):
	Remove unused local variable `e'.

	* composite.el (compose-chars): Remove unused variable `len'.
	(lgstring-insert-glyph): Remove unused variable `g'.
	(compose-glyph-string): Remove unused variables `ascent',
	`descent', `lbearing' and `rbearing'.
	(compose-glyph-string-relative): Remove unused variables
	`lbearing', `rbearing' and `wadjust'.
	(compose-gstring-for-graphic): Remove unused variables `header',
	`wadjust', `xoff' and `yoff'.  Use `let', not `let*'.
	(compose-gstring-for-terminal): Remove unused variables `header'
	and `nchars'.  Use `let', not `let*'.

	* cus-edit.el (Custom-set, Custom-save, custom-reset)
	(Custom-reset-current, Custom-reset-saved, Custom-reset-standard)
	(Custom-buffer-done, custom-buffer-create-internal)
	(custom-browse-visibility-action, custom-browse-group-tag-action)
	(custom-browse-variable-tag-action, custom-browse-face-tag-action)
	(widget-magic-mouse-down-action, custom-toggle-parent)
	(custom-add-parent-links, custom-toggle-hide-variable)
	(custom-face-edit-value-visibility-action, custom-face-edit-fix-value)
	(custom-toggle-hide-face, face, hook, custom-group-link-action)
	(custom-face-menu-create, custom-variable-menu-create, get)
	(custom-group-menu-create, Custom-no-edit): Mark unused parameters.
	(custom-reset-standard-save-and-update): Remove unused variable `value'.
	(customize-apropos): Remove unused variable `tests'.
	(custom-group-value-create): Remove unused variable `hidden-p'.
	(sort-fold-case): Declare.

	* cus-theme.el (custom-reset-standard-faces-list)
	(custom-reset-standard-variables-list): Declare.
	(customize-create-theme, custom-theme-revert, custom-theme-write)
	(custom-theme-choose-mode, customize-themes, custom-theme-save):
	Mark unused parameters.

	* dabbrev.el (dabbrev-completion): Remove unused variable `init'.

	* delim-col.el (delimit-columns-max): Move defvar before first use.

	* descr-text.el (describe-char-categories): Don't quote `lambda'.
	(describe-char): Don't quote `lambda'.  Mark unused parameter.

	* desktop.el (desktop-save-buffer-p): Mark unused parameter.
	(auto-insert): Declare.
	(desktop-restore-file-buffer): Rename desktop-* parameters;
	mark unused ones.
	(desktop-create-buffer): Rename desktop-* parameters and bind them.
	(desktop-buffer): Rename desktop-* parameters.

	* dframe.el (x-sensitive-text-pointer-shape, x-pointer-shape): Declare.
	(dframe-reposition-frame-xemacs, dframe-help-echo)
	(dframe-hack-buffer-menu, dframe-set-timer, dframe-set-timer-internal):
	Mark unused parameters.

	* dired-aux.el (backup-extract-version-start, overwrite-query)
	(overwrite-backup-query, rename-regexp-query)
	(rename-non-directory-query): Declare.
	(dired-shell-stuff-it, dired-do-create-files): Mark unused parameters.
	(dired-add-entry): Remove unused variable `orig-file-name'.
	(dired-copy-file-recursive): Remove unused variable `dirfailed'.
	Use parameter PRESERVE-TIME instead of accessing dynamic variable
	`dired-copy-preserve-time' directly.
	(dired-do-create-files-regexp): Remove unused variable `fn-count'.
	(dired-insert-subdir-newpos): Rename unused variable `pos'.

	* dired-x.el (dired-omit-size-limit): Move defcustom before first use.
	(dired-virtual-revert, dired-make-relative-symlink):
	Mark unused parameters.
	(manual-program): Declare.
	(dired-x-hands-off-my-keys): Rename parameters of lambda expression.
	(inode, s, mode, nlink, uid, gid, size, time, name, sym): Declare them,
	wrapped in `with-no-warnings' to avoid replacing one warning by another.

	* dirtrack.el (dirtrack): Remove unused variable `multi-line'.

	* dos-fns.el (dos-8+3-filename): Remove unused variable `i'.

	* echistory.el (electric-history-in-progress, Helper-return-blurb):
	Declare.

	* edmacro.el (edmacro-finish-edit): Remove unused variable `kmacro'.

	* electric.el (Electric-command-loop): Rename parameter
	INHIBIT-QUIT to INHIBIT-QUITTING and bind `inhibit-quit'.

	* expand.el (expand-in-literal): Remove unused variable `here'.

	* facemenu.el (facemenu-add-new-color):
	Remove unused variable `docstring'.

	* faces.el (face-id, make-face-bold, make-face-unbold, make-face-italic)
	(make-face-unitalic, make-face-bold-italic): Mark unused parameters.
	(face-attr-construct): Mark unused parameter.  Doc fix.
	(read-color): Remove unused variable `hex-string'.

	* files.el (parse-colon-path): Rename argument CD-PATH to SEARCH-PATH.
	(locate-dominating-file): Remove unused vars `prev-file' and `user'.
	(remote-file-name-inhibit-cache, revert-buffer): Clean up docstrings.
	(display-buffer-other-frame): Remove unused variable `old-window'.
	(kill-buffer-hook): Declare.
	(insert-file-contents-literally, set-auto-mode, risky-local-variable-p):
	Mark unused parameters.
	(after-find-file): Pass 1 to `auto-save-mode', not t.

	* files-x.el (auto-insert): Declare.
	(modify-file-local-variable-prop-line): Remove unused variable `val'.

	* find-lisp.el (find-lisp-find-dired-internal): Remove unused
	variable `buf'.  Mark unused parameter.
	(find-lisp-insert-directory): Mark unused parameter.

	* format.el (format-decode-run-method): Mark unused parameter; doc fix.
	(format-encode-region): Remove unused variables `cur-buf' and `result'.
	(format-common-tail): Remove, unused.
	(format-deannotate-region): Remove unused variable `loc'.
	(format-annotate-region): Remove unused variable `p'.
	(format-annotate-single-property-change): Remove unused variables
	`default' and `tail'.

	* forms.el (read-file-filter): Declare.
	(forms--iif-hook, forms--revert-buffer): Mark unused parameters.

	* frame.el (frame-creation-function-alist): Mark unused parameter.
	(frame-geom-spec-cons): Pass FRAME to `frame-geom-value-cons'.

	* hilit-chg.el (hilit-chg-cust-fix-changes-face-list, hilit-chg-clear):
	Remove unused parameters.
	(hilit-chg-set-face-on-change): Remove unused variable `beg-decr'.
	(highlight-compare-with-file): Remove unused variable `buf-b-read-only'.

	* htmlfontify.el (hfy-default-footer, hfy-decor, hfy-invisible)
	(hfy-parse-tags-buffer, hfy-prepare-index-i, hfy-prepare-index)
	(hfy-prepare-tag-map): Mark unused parameters.
	(htmlfontify-buffer): Use `called-interactively-p'.

	* ibuf-ext.el (ibuffer-do-kill-lines, ibuffer-jump-to-buffer)
	(ibuffer-copy-filename-as-kill, ibuffer-mark-on-buffer)
	(ibuffer-do-occur): Mark unused parameters.
	(ibuffer-forward-next-marked): Remove unused variable `curmark'.
	(ibuffer-diff-buffer-with-file-1): Remove unused variable `proc'.

	* ibuffer.el: Don't quote `lambda'.
	(ibuffer-count-marked-lines, ibuffer-count-deletion-lines)
	(ibuffer-unmark-all, ibuffer-toggle-marks, ibuffer-redisplay-engine):
	Mark unused parameters.

	* ido.el (ido-mode, ido-wide-find-dir-or-delete-dir)
	(ido-completing-read): Mark unused parameters.
	(ido-copy-current-word): Mark unused parameters;
	remove unused variable `name'.
	(ido-sort-merged-list): Remove unused parameter `dirs'.

	* ielm.el (ielm-input-sender): Mark unused parameter.
	(ielm-string, ielm-form, ielm-pos, ielm-result, ielm-error-type)
	(ielm-output, ielm-wbuf, ielm-pmark): Declare.
	(ielm-eval-input): Rename argument IELM-STRING to INPUT-STRING to keep
	`ielm-string' as a dynamic variable accessible from the IELM prompt.
	Bind `ielm-string' to INPUT-STRING.  Remove unused variable `err'.

	* image-dired.el (image-dired-display-thumbs): Remove unused
	variables `curr-file' and `count'.
	(image-dired-remove-tag): Remove unused variable `start'.
	(image-dired-tag-files, image-dired-create-thumbs): Remove unused
	variable `curr-file'
	(image-dired-rotate-original): Remove unused variable `temp-file'.
	(image-dired-mouse-select-thumbnail, image-dired-mouse-toggle-mark):
	Remove unused variable `file'.
	(image-dired-gallery-generate): Remove unused variable `curr'.
	(image-dired-dired-edit-comment-and-tags): Mark unused parameters.

	* indent.el (tab-to-tab-stop): Remove unused variable `opoint'.

	* info-xref.el (info-xref-goto-node-p): Remove unused variable `err'.

	* informat.el (texinfo-command-start, texinfo-command-end): Declare.

	* isearch.el (minibuffer-history-symbol): Declare.
	(isearch-edit-string): Remove unused variable `err'.
	(isearch-message-prefix, isearch-message-suffix):
	Mark unused parameters.

	* ls-lisp.el (ls-lisp-insert-directory): Remove unused variable `fil'.

	* macros.el (insert-kbd-macro): Remove unused variable `mods'.

	* makesum.el (double-column): Remove unused variable `cnt'.

	* misearch.el (multi-isearch-pop-state): Mark unused parameter.
	(ido-ignore-item-temp-list): Declare.

	* mouse-drag.el (mouse-drag-throw): Remove unused variables
	`mouse-delta', `window-last-row', `mouse-col-delta', `window-last-col',
	`adjusted-mouse-col-delta' and `adjusted-mouse-delta'.
	(mouse-drag-drag): Remove unused variables `mouse-delta' and
	`mouse-col-delta'.

	* mouse-sel.el (mouse-extend-internal):
	Remove unused variable `orig-window-frame'.

	* pcomplete.el (pcomplete-args, pcomplete-begins, pcomplete-last)
	(pcomplete-index, pcomplete-stub, pcomplete-seen, pcomplete-norm-func):
	Move declarations before first use.
	(pcomplete-opt): Mark unused parameters; doc fix.

	* proced.el (proced-revert): Mark unused parameter.
	(proced-send-signal): Remove unused variable `err'.

	* ps-print.el (ps-print-preprint-region, ps-print-preprint):
	Rename parameter PREFIX-ARG to ARG.
	(ps-basic-plot-string, ps-basic-plot-whitespace):
	Mark unused parameters.

	* replace.el (replace-count): Define.
	(occur-revert-function): Mark unused parameters.
	(ido-ignore-item-temp-list, isearch-error, isearch-forward)
	(isearch-case-fold-search, isearch-string): Declare.
	(occur-engine): Rename parameter CASE-FOLD-SEARCH to CASE-FOLD and
	bind `case-fold-search'.  Remove unused variables `beg' and `end',
	and simplify.
	(replace-eval-replacement): Rename parameter REPLACE-COUNT to
	COUNT and bind `replace-count'.
	(replace-loop-through-replacements): Rename parameter REPLACE-COUNT
	to COUNT.

	* savehist.el (print-readably, print-string-length): Declare.

	* shadowfile.el (shadow-expand-cluster-in-file-name):
	Remove unused variable `cluster'.
	(shadow-copy-file): Remove unused variable `i'.
	(shadow-noquery, shadow-clusters, shadow-site-cluster)
	(shadow-parse-fullname, shadow-parse-name, shadow-define-cluster)
	(shadow-define-literal-group, shadow-define-regexp-group)
	(shadow-make-group, shadow-shadows-of): Clean up docstrings.

	* shell.el (shell-filter-ctrl-a-ctrl-b): Mark unused parameter.
	(shell): Use `called-interactively-p'.
	(shell-directory-tracker): Remove unused variable `chdir-failure'.

	* simple.el (compilation-context-lines, comint-file-name-quote-list)
	(comint-file-name-chars, comint-delimiter-argument-list): Declare.
	(delete-backward-char): Remove unused variable `ocol'.
	(minibuffer-avoid-prompt, minibuffer-history-isearch-pop-state)
	(line-move-1, event-apply-alt-modifier, event-apply-super-modifier)
	(event-apply-hyper-modifier, event-apply-shift-modifier)
	(event-apply-control-modifier, event-apply-meta-modifier):
	Mark unused parameters.
	(undo-make-selective-list): Remove duplicate variable `undo-elt'.
	(normal-erase-is-backspace-mode): Remove unused variable `old-state'.

	* speedbar.el (speedbar-ignored-directory-expressions)
	(speedbar-supported-extension-expressions, speedbar-directory-buttons)
	(speedbar-find-file, speedbar-dir-follow)
	(speedbar-directory-buttons-follow, speedbar-tag-find)
	(speedbar-buffer-buttons, speedbar-buffer-buttons-temp)
	(speedbar-buffers-line-directory, speedbar-buffer-click):
	Mark unused parameters.
	(speedbar-tag-file): Remove unused variable `mode'.
	(speedbar-buffers-tail-notes): Remove unused variable `mod'; simplify.

	* strokes.el (strokes-decode-buffer): Remove unused variable `ext'.

	* talk.el (talk): Remove unused variable `display'.

	* tar-mode.el (tar-subfile-save-buffer): Remove unused variable `name'.
	(tar-write-region-annotate): Mark unused parameter.

	* time.el (now, time, load, mail, 24-hours, hour, 12-hours, am-pm)
	(minutes, seconds, time-zone, day, year, monthname, month, dayname):
	Declare them, wrapped in `with-no-warnings' to avoid replacing one
	warning by another.

	* time-stamp.el (time-stamp-string-preprocess):
	Remove unused variable `require-padding'.

	* tree-widget.el (widget-glyph-enable): Declare.
	(tree-widget-action): Mark unused parameter.

	* w32-fns.el (x-get-selection): Mark unused parameter.
	(autoload-make-program, generated-autoload-file): Declare.

	* wdired.el (wdired-revert): Mark unused parameters.
	(wdired-xcase-word): Remove unused variable `err'.

	* whitespace.el (whitespace-buffer-changed): Mark unused parameters.
	(whitespace-help-scroll): Remove unused variable `data-help'.

	* wid-edit.el (widget-mouse-help, widget-overlay-inactive)
	(widget-image-insert, widget-after-change, default)
	(widget-default-format-handler, widget-default-notify)
	(widget-default-prompt-value, widget-info-link-action)
	(widget-url-link-action, widget-function-link-action)
	(widget-variable-link-action, widget-file-link-action)
	(widget-emacs-library-link-action, widget-emacs-commentary-link-action)
	(widget-field-prompt-internal, widget-field-action, widget-field-match)
	(widget-choice-mouse-down-action, toggle, widget-radio-button-notify)
	(widget-insert-button-action, widget-delete-button-action, visibility)
	(widget-documentation-link-action, widget-documentation-string-action)
	(widget-const-prompt-value, widget-regexp-match, symbol)
	(widget-coding-system-prompt-value)
	(widget-key-sequence-value-to-external, sexp)
	(widget-sexp-value-to-internal, character, vector, cons)
	(widget-choice-prompt-value, widget-boolean-prompt-value)
	(widget-color--choose-action): Mark unused parameters.
	(widget-item-match-inline, widget-choice-match-inline)
	(widget-checklist-match, widget-checklist-match-inline)
	(widget-group-match): Rename parameter VALUES to VALS.
	(widget-field-value-set): Remove unused variable `size'.
	(widget-color-action): Remove unused variables `value' and `start'.

	* windmove.el (windmove-wrap-loc-for-movement): Remove unused
	variable `dir'.  Doc fix.
	(windmove-find-other-window): Don't pass it.

	* window.el (count-windows): Mark unused parameter.
	(bw-adjust-window): Remove unused variable `err'.

	* woman.el (woman-file-name): Remove unused variable `default'.
	(woman-expand-directory-path): Rename parameters WOMAN-MANPATH and
	WOMAN-PATH to PATH-DIRS and PATH-REGEXPS, respectively.
	(global-font-lock-mode): Declare.
	(woman-decode-region): Mark unused parameter.
	(woman-get-tab-stop): Rename parameter TAB-STOP-LIST to TAB-STOPS.

	* x-dnd.el (x-dnd-default-test-function, x-dnd-handle-old-kde)
	(x-dnd-handle-xdnd, x-dnd-handle-motif): Mark unused parameters.
	(x-dnd-handle-moz-url): Remove unused variable `title'.
	(x-dnd-handle-xdnd): Remove unused variables `x', `y' and `ret-action'.

	* xml.el (xml-parse-tag, xml-parse-attlist):
	Remove unused variable `pos'.

2011-04-19  Glenn Morris  <rgm@gnu.org>

	* calendar/cal-tex.el (cal-tex-list-holidays, cal-tex-cursor-month)
	(cal-tex-cursor-week, cal-tex-cursor-week2, cal-tex-cursor-week-iso)
	(cal-tex-cursor-filofax-2week, cal-tex-cursor-filofax-week)
	(cal-tex-cursor-filofax-daily, cal-tex-mini-calendar)
	* calendar/cal-html.el (cal-html-insert-minical):
	* calendar/diary-lib.el (diary-list-entries-1, diary-list-entries)
	(calendar-mark-date-pattern):
	Prefix "unused" locals.

	* calendar/cal-dst.el (dst-adjust-time): Remove never-implemented
	optional argument `style'.

	* calendar/appt.el (appt-make-list):
	* calendar/cal-china.el (calendar-chinese-date-string):
	* calendar/cal-hebrew.el (calendar-hebrew-list-yahrzeits)
	(diary-hebrew-yahrzeit):
	* calendar/cal-tex.el (cal-tex-last-blank-p, cal-tex-cursor-week2):
	* calendar/calendar.el (calendar-generate-window):
	* calendar/time-date.el (time-to-days):
	Remove unused local variables.

2011-04-18  Chong Yidong  <cyd@stupidchicken.com>

	* emacs-lisp/tabulated-list.el (tabulated-list-mode): Use a custom
	glyphless-char-display table.
	(tabulated-list-glyphless-char-display): New var.

2011-04-18  Sam Steingold  <sds@gnu.org>

	* vc/add-log.el (change-log-font-lock-keywords): Add "Thanks to"
	to acknowledgments.

2011-04-17  Glenn Morris  <rgm@gnu.org>

	* calendar/diary-lib.el (diary-sexp-entry):
	* calendar/holidays.el (holiday-sexp):
	Set debug-on-error rather than the removed stack-trace-on-error.

2011-04-16  Glenn Morris  <rgm@gnu.org>

	* progmodes/f90.el: Use lexical-binding.
	(f90-get-correct-indent): Remove unnecessary local variable `cont'.

2011-04-15  Stefan Monnier  <monnier@iro.umontreal.ca>

	* mail/sendmail.el (mail-mode-map): Use completion-at-point.
	(mail-mode): Setup mailalias completion here instead.
	* mail/mailalias.el: Use lexical-binding.
	(pattern, mailalias-done): Declare dynamic.
	(mail-completion-at-point-function): New function, from mail-complete.
	(mail-complete): Use it.
	(mail-completion-expand): New function.
	(mail-get-names): Use it.
	(mail-directory, mail-directory-process, mail-directory-stream):
	Don't use `pattern' for lexically bound arg.

	* emacs-lisp/lisp-mode.el (eval-defun-2): Use eval-sexp-add-defvars.

	* htmlfontify.el (hfy-etags-cmd): Remove inoperant eval-and-compile.
	(hfy-e2x-etags-cmd, hfy-etags-cmd-alist-default)
	(hfy-etags-cmd-alist): Don't eval-and-compile any more.

	* emacs-lisp/bytecomp.el (byte-temp-output-buffer-show)
	(byte-save-window-excursion, byte-temp-output-buffer-setup)
	(byte-interactive-p): Define them again, for use when inlining
	old code.

2011-04-15  Juanma Barranquero  <lekktu@gmail.com>

	* loadup.el: Use `string-to-number', not `string-to-int'.

2011-04-15  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/gud.el (gud-gdb): Use completion-at-point instead of
	gud-gdb-complete-command.
	(gud-gdb-completions): New function, from gud-gdb-complete-command.
	(gud-gdb-completion-at-point): New function.
	(gud-gdb-completions): Remove.

2011-04-14  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-sh.el (tramp-sh-handle-file-attributes): Handle the case
	when the scripts fail.  Use `tramp-do-file-attributes-with-ls' then.
	(tramp-do-copy-or-rename-file-out-of-band): Do not check any longer
	whether `executable-find' is bound.

	* net/tramp-smb.el (tramp-smb-handle-copy-file): Fix docstring.

2011-04-14  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuffer.el (completion-in-region-mode-predicate)
	(completion-in-region-mode--predicate): New vars.
	(completion-in-region, completion-in-region--postch)
	(completion-in-region-mode): Use them.
	(completion--capf-wrapper): Also return the hook function.
	(completion-at-point, completion-help-at-point):
	Adjust and provide a predicate.

	Preserve arg names for advice of subr and lexical functions (bug#8457).
	* help-fns.el (help-function-arglist): Consolidate the subr and
	new-byte-code cases.  Add argument `preserve-names' to extract names
	from the docstring when needed.
	* emacs-lisp/advice.el (ad-define-subr-args, ad-undefine-subr-args)
	(ad-subr-args-defined-p, ad-get-subr-args, ad-subr-arglist): Remove.
	(ad-arglist): Use help-function-arglist's new arg.
	(ad-definition-type): Use cond.

2011-04-13  Juanma Barranquero  <lekktu@gmail.com>

	* autorevert.el (auto-revert-handler):
	Bind `remote-file-name-inhibit-cache', not `tramp-cache-inhibit-cache',
	which was removed in 2010-10-02T13:21:43Z!michael.albinus@gmx.de.
	Don't quote lambda.

	* image-mode.el (image-transform-set-scale):
	Fix change in 2011-04-09T20:28:01Z!cyd@stupidchicken.com.

2011-04-12  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* net/network-stream.el (network-stream-open-starttls): Only do
	opportunistic STARTTLS upgrades if we have built-in GnuTLS support.
	Upgrades via gnutls-cli are too slow to be done opportunistically.

2011-04-12  Juanma Barranquero  <lekktu@gmail.com>

	* dframe.el (dframe-current-frame): Remove spurious quote.

2011-04-12  Glenn Morris  <rgm@gnu.org>

	* calendar/cal-tex.el (cal-tex-end-document):
	Try to automatically use latin1 input if needed.

	* calendar/cal-hebrew.el (diary-hebrew-rosh-hodesh):
	Don't try to cons a mark onto an empty element.

2011-04-11  Leo Liu  <sdl.web@gmail.com>

	* ido.el (ido-buffer-internal): Allow method 'kill for virtual
	buffers.
	(ido-kill-buffer-at-head): Support killing virtual buffers.

2011-04-10  Chong Yidong  <cyd@stupidchicken.com>

	* minibuffer.el (completion-show-inline-help): New var.
	(completion--do-completion, minibuffer-complete)
	(minibuffer-force-complete, minibuffer-complete-word):
	Inhibit minibuffer messages if completion-show-inline-help is nil.

	* icomplete.el (icomplete-mode): Bind completion-show-inline-help
	to avoid interference from inline help (Bug#5849).

2011-04-10  Leo Liu  <sdl.web@gmail.com>

	* emacs-lisp/tabulated-list.el (tabulated-list-print-entry):
	Fix typo.

2011-04-09  Chong Yidong  <cyd@stupidchicken.com>

	* image-mode.el (image-toggle-display-image): Signal an error if
	not in Image mode.
	(image-transform-mode, image-transform-resize)
	(image-transform-set-rotation): Doc fix.
	(image-transform-set-resize): Delete.
	(image-transform-set-scale, image-transform-fit-to-height)
	(image-transform-fit-to-width): Handle image-toggle-display-image
	and image-transform-resize directly.

2011-04-08  Sho Nakatani  <lay.sakura@gmail.com>

	* doc-view.el (doc-view-fit-width-to-window)
	(doc-view-fit-height-to-window, doc-view-fit-page-to-window):
	New functions for fitting the shown image to the Emacs window size.
	(doc-view-mode-map): Add bindings for the new functions.

2011-04-08  Juanma Barranquero  <lekktu@gmail.com>

	* vc/vc-annotate.el (vc-annotate-show-log-revision-at-line):
	Fix typo in docstring.

2011-04-08  Eli Zaretskii  <eliz@gnu.org>

	* files.el (file-size-human-readable): Produce one digit after
	decimal, like "ls -lh" does.

	* ls-lisp.el (ls-lisp-format-file-size): Allow for 7 characters in
	the file size representation.

	* simple.el (list-processes): If async subprocesses are not
	available, error out with a clear error message.

2011-04-08  Chong Yidong  <cyd@stupidchicken.com>

	* help.el (help-form-show): New function, to be called from C.
	Put help-form output in a buffer named differently than *Help*.

2011-04-08  Eli Zaretskii  <eliz@gnu.org>

	* files.el (file-size-human-readable): New function.

	* ls-lisp.el (ls-lisp-format-file-size): Use it, instead of
	computing the representation inline.  Don't require `cl'.

2011-04-08  Glenn Morris  <rgm@gnu.org>

	* man.el (Man-page-header-regexp): Solaris < 2.6 no longer supported.

	* net/browse-url.el (browse-url-firefox):
	Test system-type, not system-configuration.

	* vc/log-edit.el (log-edit-empty-buffer-p): New function.
	(log-edit-insert-cvs-template, log-edit-insert-cvs-rcstemplate):
	Use log-edit-empty-buffer-p.  (Bug#7598)

	* net/rlogin.el (rlogin-process-connection-type): Simplify.
	(rlogin-mode-map): Initialize in the defvar.
	(rlogin): Use ignore-errors.

	* replace.el (occur-mode-map): Some fixes for menu items.

2011-04-07  Aaron S. Hawley  <aaron.s.hawley@gmail.com>

	* play/morse.el (denato-region): Handle varying case.  (Bug#8386)

2011-04-06  Chong Yidong  <cyd@stupidchicken.com>

	* emacs-lisp/cconv.el (cconv--analyse-use): Ignore "ignored" when
	issuing unused warnings.

	* emacs-lisp/tabulated-list.el (tabulated-list-print): Use lambda
	macro directly.

	* simple.el: Lisp reimplement of list-processes.  Based on an
	earlier reimplementation by Leo Liu, but using tabulated-list.el.
	(process-menu-mode): New major mode.
	(list-processes--refresh, list-processes):
	(process-menu-visit-buffer): New functions.

	* files.el (save-buffers-kill-emacs): Don't assume any return
	value of list-processes, which is undocumented anyway.

2011-04-06  Chong Yidong  <cyd@stupidchicken.com>

	* emacs-lisp/tabulated-list.el: New file.

	* emacs-lisp/package.el: Use Tabulated List mode.
	(package-menu-mode-map): Inherit from tabulated-list-mode-map.
	(package-menu-mode): Derive from tabulated-list-mode.  Set up the
	table format using Tabulated List mode variables.
	(package--push): New macro, replacing package-list-maybe-add.
	(package-menu--generate): Use package--push.  Renamed from
	package--generate-package-list.
	(package-menu-refresh, list-packages): Use it.
	(package-menu--print-info): Rename from package-print-package.
	Return insertion data instead of inserting it directly.
	(package-menu-describe-package, package-menu-execute):
	Use tabulated-list-get-id.
	(package-menu-mark-delete, package-menu-mark-install)
	(package-menu-mark-unmark, package-menu-backup-unmark)
	(package-menu-mark-obsolete-for-deletion):
	Use tabulated-list-put-tag.
	(package--list-packages, package-menu-revert)
	(package-menu-get-package, package-menu-get-version)
	(package-menu-sort-by-column): Functions deleted.
	(package-menu-package-list, package-menu-sort-key): Vars deleted.
	(package-menu--status-predicate, package-menu--version-predicate)
	(package-menu--name-predicate)
	(package-menu--description-predicate): Handle arguments in the
	Tabulated List format.
	(package-list-packages-no-fetch): Call list-packages.

2011-04-06  Juanma Barranquero  <lekktu@gmail.com>

	* files.el (after-find-file-from-revert-buffer): Remove variable.
	(after-find-file): Don't bind it.
	(revert-buffer-in-progress-p): New variable.
	(revert-buffer): Bind it.
	Pass nil for `after-find-file-from-revert-buffer'.

	* saveplace.el (save-place-find-file-hook): Use new variable
	`rever-buffer-in-progress-p', not `after-find-file-from-revert-buffer'.

2011-04-06  Glenn Morris  <rgm@gnu.org>

	* Makefile.in (AUTOGEN_VCS): New variable.
	(autoloads): Use $AUTOGEN_VCS.

	* calendar/cal-move.el (calendar-scroll-toolkit-scroll): New function.
	* calendar/calendar.el (calendar-mode-map):
	Check for toolkit scroll bars.  (Bug#8305)

2011-04-05  Chong Yidong  <cyd@stupidchicken.com>

	* minibuffer.el (completion-in-region--postch)
	(completion-in-region-mode): Remove unnecessary messages.

2011-04-05  Juanma Barranquero  <lekktu@gmail.com>

	* font-lock.el (font-lock-refresh-defaults):
	Don't bind `hi-lock--inhibit-font-lock-hook', removed in
	2010-10-09T04:09:19Z!cyd@stupidchicken.com and 2010-10-11T23:57:49Z!lekktu@gmail.com (2010-10-12).

	* info.el (Info-directory-list, Info-read-node-name-2)
	(Info-split-parameter-string): Doc fixes.
	(Info-virtual-nodes): Reflow docstring.
	(Info-find-file, Info-directory-toc-nodes, Info-history-toc-nodes)
	(Info-apropos-toc-nodes, info-finder, Info-get-token)
	(Info-find-emacs-command-nodes, Info-speedbar-key-map):
	Fix typos in docstrings.
	(Info-revert-buffer-function, Info-search, Info-isearch-pop-state)
	(Info-speedbar-hierarchy-buttons, Info-speedbar-goto-node)
	(Info-speedbar-buttons, Info-desktop-buffer-misc-data)
	(Info-restore-desktop-buffer): Mark unused parameters.
	(Info-directory-find-file, Info-directory-find-node)
	(Info-history-find-file, Info-history-find-node, Info-toc-find-node)
	(Info-virtual-index-find-node, Info-apropos-find-file)
	(Info-apropos-find-node, Info-finder-find-file, Info-finder-find-node):
	Mark unused parameters; fix typos in docstrings.
	(Info-virtual-index): Remove unused local variable `nodename'.

2011-04-05  Deniz Dogan  <deniz@dogan.se>

	* net/rcirc.el: Update my e-mail address.
	(rcirc-mode-map): Remove M-o binding.

2011-04-05  Chong Yidong  <cyd@stupidchicken.com>

	* startup.el (command-line): Save the cursor's theme-face
	directly, instead of using face-override-spec.

	* custom.el (load-theme): Minor optimization in assigning faces.

2011-04-04  Juanma Barranquero  <lekktu@gmail.com>

	* help-fns.el (describe-variable): Complete all variables having
	documentation, including keywords.
	https://lists.gnu.org/r/emacs-devel/2011-04/msg00112.html

2011-04-04  Juanma Barranquero  <lekktu@gmail.com>

	Convert to lexical-binding.

	* bs.el (bs-refresh, bs-sort-buffer-interns-are-last)
	(bs--get-marked-string, bs--get-modified-string)
	(bs--get-readonly-string, bs--get-size-string, bs--get-name)
	(bs--get-mode-name, bs--get-file-name): Mark unused arguments.
	(bs--configuration-name-for-prefix-arg): Rename argument PREFIX-ARG.

	* ehelp.el (electric-help-execute-extended)
	(electric-help-ctrl-x-prefix):
	* hexl.el (hexl-revert-buffer-function):
	* linum.el (linum-after-change, linum-after-scroll):
	* emacs-lisp/re-builder.el (reb-auto-update): Mark unused arguments.

	* help-fns.el (help-describe-category-set): Remove unused ERR variable.

2011-04-04  Daiki Ueno  <ueno@unixuser.org>

	* epa-dired.el:
	* epa-mail.el:
	* epa-hook.el:
	* epa-file.el:
	* epa.el:
	* epg.el: Use lexical binding.

2011-04-03  Chong Yidong  <cyd@stupidchicken.com>

	* dired-aux.el (dired-create-files): Add docstring (Bug#7970).

	* textmodes/flyspell.el (flyspell-word): Recognize default
	dictionary case for flyspell-mark-duplications-exceptions.
	Use regexp matching for languages.
	(flyspell-mark-duplications-exceptions): Add "that" and "had" for
	default dictionary (Bug#7926).

2011-04-02  Chong Yidong  <cyd@stupidchicken.com>

	* emacs-lisp/package.el (package--with-work-buffer):
	Recognize https URLs.

	* net/network-stream.el: Move from gnus/proto-stream.el.
	Change prefix to network-stream throughout.
	(open-protocol-stream): Merge into open-network-stream, leaving
	open-protocol-stream as an alias.  Handle nil BUFFER args.

	* subr.el (open-network-stream): Move to net/network-stream.el.

2011-04-02  Glenn Morris  <rgm@gnu.org>

	* find-dired.el (find-exec-terminator): New option.
	(find-ls-option): Test for -ls support.
	(find-ls-subdir-switches): Test for -b in find-ls-option.
	(find-dired, find-grep-dired): Doc fixes.
	(find-dired): Use find-exec-terminator.

	* find-dired.el (find-ls-option, find-ls-subdir-switches)
	(find-grep-options): Do not autoload these defcustoms, remove purecopy.
	(find-name-arg): Remove purecopy.

	* progmodes/grep.el (grep-find-use-xargs): Doc fix.
	(grep-compute-defaults): Check for `-exec COMMAND +' support.
	Set grep-find-use-xargs, grep-find-command, and grep-find-template
	accordingly.  Don't add the null-device if not needed.

	* files.el (save-some-buffers): Doc fix.

2011-04-02  Eli Zaretskii  <eliz@gnu.org>

	* makefile.w32-in (EMACS): Default to ../src/$(BLD)/emacs.exe.

2011-04-01  Juanma Barranquero  <lekktu@gmail.com>

	* progmodes/idlwave.el (idlwave-one-key-select, idlwave-list-abbrevs):
	Use `dolist' rather than `mapcar'.

2011-04-01  Stefan Monnier  <monnier@iro.umontreal.ca>

	Add lexical binding.

	* subr.el (apply-partially): Use new closures rather than CL.
	(--dolist-tail--, --dotimes-limit--): Don't declare dynamic.
	(dolist, dotimes): Use slightly different expansion for lexical code.
	(functionp): Move to C.
	(letrec): New macro.
	(with-wrapper-hook): Use it and apply-partially instead of CL.
	(eval-after-load): Preserve lexical-binding.
	(save-window-excursion, with-output-to-temp-buffer): Turn them
	into macros.

	* simple.el (with-wrapper-hook, apply-partially): Move to subr.el.

	* help-fns.el (help-split-fundoc): Return nil if there's nothing else
	than the arglist.
	(help-add-fundoc-usage): Don't add `Not documented'.
	(help-function-arglist): Handle closures, subroutines, and new
	byte-code-functions.
	(help-make-usage): Remove leading underscores.
	(describe-function-1): Handle closures.
	(describe-variable): Use special-variable-p for completion.

	* files.el (lexical-binding): Declare safe.

	* emacs-lisp/pcase.el: Don't use destructuring-bind.
	(pcase--memoize): Rename from pcase-memoize.  Change weakness.
	(pcase): Add `let' pattern.
	Change memoization so it actually works.
	(pcase-mutually-exclusive-predicates): Add byte-code-function-p.
	(pcase--u1) <guard, pred>: Fix possible shadowing problem.
	<let>: New case.

	* emacs-lisp/macroexp.el: Use lexical binding.
	(macroexpand-all-1): Check obsolete macros.  Expand compiler-macros.
	Don't convert ' to #' without checking that it's indeed quoting
	a lambda.

	* emacs-lisp/lisp-mode.el (eval-last-sexp-1):
	Use eval-sexp-add-defvars.
	(eval-sexp-add-defvars): New fun.

	* emacs-lisp/float-sup.el (pi): Don't declare as dynamically bound.

	* emacs-lisp/eieio.el (byte-compile-file-form-defmethod):
	Don't autoload.
	(eieio-defgeneric-form-primary-only-one): Use `byte-compile' rather
	than the internal `byte-compile-lambda'.
	(defmethod): Don't hide code under quotes.
	(eieio-defmethod): New `code' argument.

	* emacs-lisp/eieio-comp.el: Remove.

	* emacs-lisp/edebug.el (edebug-eval-defun)
	(edebug-eval-top-level-form): Use eval-sexp-add-defvars.
	(edebug-toggle): Avoid `eval'.

	* emacs-lisp/disass.el (disassemble-internal): Handle new
	`closure' objects.
	(disassemble-1): Handle new byte codes.

	* emacs-lisp/cl.el (pushnew): Silence warning.

	* emacs-lisp/cl-macs.el (cl-byte-compile-block)
	(cl-byte-compile-throw): Remove.
	(cl-block-wrapper, cl-block-throw): Use compiler-macros instead.

	* emacs-lisp/cl-extra.el (cl-macroexpand-all): Properly quote CL
	closures.

	* emacs-lisp/cconv.el: New file.

	* emacs-lisp/bytecomp.el: Use lexical binding instead of
	a "bytecomp-" prefix.  Macroexpand everything as a separate phase.
	(byte-compile-initial-macro-environment):
	Handle declare-function here.
	(byte-compile--lexical-environment): New var.
	(byte-stack-ref, byte-stack-set, byte-discardN)
	(byte-discardN-preserve-tos): New lap codes.
	(byte-interactive-p): Don't use any more.
	(byte-compile-push-bytecodes, byte-compile-push-bytecode-const2):
	New macros.
	(byte-compile-lapcode): Use them and handle new lap codes.
	(byte-compile-obsolete): Remove.
	(byte-compile-arglist-signature): Handle new byte-code arg"lists".
	(byte-compile-arglist-warn): Check late def of inlinable funs.
	(byte-compile-cl-warn): Don't silence warnings for compiler-macros
	since they should have been expanded by now.
	(byte-compile--outbuffer): Rename from bytecomp-outbuffer.
	(byte-compile-from-buffer): Remove unused second arg.
	(byte-compile-preprocess): New function.
	(byte-compile-toplevel-file-form): New function to distinguish
	file-form calls from outside from file-form calls from hunk-handlers.
	(byte-compile-file-form): Simplify.
	(byte-compile-file-form-defsubst): Remove.
	(byte-compile-file-form-defmumble): Simplify now that
	byte-compile-lambda always returns a byte-code-function.
	(byte-compile): Preprocess.
	(byte-compile-byte-code-maker, byte-compile-byte-code-unmake):
	Remove, not used any more.
	(byte-compile-arglist-vars, byte-compile-make-lambda-lexenv)
	(byte-compile-make-args-desc): New funs.
	(byte-compile-lambda): Handle lexical functions.  Always return
	a byte-code-function.
	(byte-compile-reserved-constants): New var, to make up room for
	closed-over variables.
	(byte-compile-constants-vector): Obey it.
	(byte-compile-top-level): New args `lexenv' and `reserved-csts'.
	(byte-compile-macroexpand-declare-function): New function.
	(byte-compile-form): Call byte-compile-unfold-bcf to inline immediate
	byte-code-functions.
	(byte-compile-form): Check obsolescence here.
	(byte-compile-inline-lapcode, byte-compile-unfold-bcf): New functions.
	(byte-compile-variable-ref): Remove.
	(byte-compile-dynamic-variable-op): New fun.
	(byte-compile-dynamic-variable-bind, byte-compile-variable-ref)
	(byte-compile-variable-set): New funs.
	(byte-compile-discard): Add 2 args.
	(byte-compile-stack-ref, byte-compile-stack-set)
	(byte-compile-make-closure, byte-compile-get-closed-var): New funs.
	(byte-compile-funarg, byte-compile-funarg-2): Remove, handled in
	macroexpand-all instead.
	(byte-compile-quote-form): Remove.
	(byte-compile-push-binding-init, byte-compile-not-lexical-var-p)
	(byte-compile-bind, byte-compile-unbind): New funs.
	(byte-compile-let): Handle let* and lexical binding.
	(byte-compile-let*): Remove.
	(byte-compile-catch, byte-compile-unwind-protect)
	(byte-compile-track-mouse, byte-compile-condition-case):
	Handle a new :fun-body form, used for lexical scoping.
	(byte-compile-save-window-excursion)
	(byte-compile-with-output-to-temp-buffer): Remove.
	(byte-compile-defun): Simplify.
	(byte-compile-stack-adjustment): New fun.
	(byte-compile-out): Use it.
	(byte-compile-refresh-preloaded): Don't reload byte-compiler files.

	* emacs-lisp/byte-run.el (make-obsolete): Don't set the `byte-compile'
	handler any more.

	* emacs-lisp/byte-opt.el: Use lexical binding.
	(byte-inline-lapcode): Remove (to bytecomp).
	(byte-compile-inline-expand): Pay attention to inlining to/from
	lexically bound code.
	(byte-compile-unfold-lambda): Don't handle byte-code-functions
	any more.
	(byte-optimize-form-code-walker): Don't handle save-window-excursion
	any more and don't call compiler-macros.
	(byte-compile-splice-in-already-compiled-code): Remove.
	(byte-code): Don't inline any more.
	(disassemble-offset): Receive `bytes' as argument rather than via
	dynamic scoping.
	(byte-compile-tag-number): Declare before first use.
	(byte-decompile-bytecode-1): Handle new byte-codes, don't change
	`return' even if make-spliceable.
	(byte-compile-side-effect-and-error-free-ops): Add stack-ref, remove
	obsolete interactive-p.
	(byte-optimize-lapcode): Optimize new lap-codes.
	Don't trip up on new form of `byte-constant' lap code.

	* emacs-lisp/autoload.el (make-autoload): Don't burp on trivial macros.

	* emacs-lisp/advice.el (ad-arglist): Use help-function-arglist.

	* custom.el (custom-initialize-default, custom-declare-variable):
	Use `defvar'.

	* Makefile.in (BIG_STACK_DEPTH, BIG_STACK_OPTS, BYTE_COMPILE_FLAGS):
	New variables.
	(compile-onefile, .el.elc, compile-calc, recompile): Use them.
	(COMPILE_FIRST): Add macroexp and cconv.
	* makefile.w32-in: Mirror changes in Makefile.in.

	* vc/cvs-status.el:
	* vc/diff-mode.el:
	* vc/log-edit.el:
	* vc/log-view.el:
	* vc/smerge-mode.el:
	* textmodes/bibtex-style.el:
	* textmodes/css-mode.el:
	* startup.el:
	* uniquify.el:
	* minibuffer.el:
	* newcomment.el:
	* reveal.el:
	* server.el:
	* mpc.el:
	* emacs-lisp/smie.el:
	* doc-view.el:
	* dired.el:
	* abbrev.el: Use lexical binding.

2011-04-01  Eli Zaretskii  <eliz@gnu.org>

	* info.el (info-display-manual): New function.

2011-03-31  Stefan Monnier  <monnier@iro.umontreal.ca>

	* loadup.el: Load minibuffer after loaddefs, to use define-minor-mode.

2011-03-31  Tassilo Horn  <tassilo@member.fsf.org>

	* net/rcirc.el (rcirc-handler-001): Only authenticate, if there's
	an entry for that server in rcirc-authinfo.  (Bug#8385)

2011-03-31  Glenn Morris  <rgm@gnu.org>

	* progmodes/f90.el (f90-find-tag-default): Handle multiple `%'.

	* generic-x.el (etc-fstab-generic-mode): Add ext4, sysfs keywords.

2011-03-30  Christoph Scholtes  <cschol2112@googlemail.com>

	* progmodes/python.el (python-default-interpreter)
	(python-python-command-args, python-jython-command-args)
	(python-which-shell, python-which-args, python-which-bufname)
	(python-file-queue, python-comint-output-filter-function)
	(python-toggle-shells, python-shell): Remove obsolete defcustoms,
	variables and functions.

2011-03-30  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuffer.el (completion-table-dynamic): Optimize `boundaries'.
	(completion-in-region-mode): New minor mode.
	(completion-in-region): Use it.
	(completion-in-region--data, completion-in-region-mode-map): New vars.
	(completion-in-region--postch): New function.
	(completion--capf-misbehave-funs, completion--capf-safe-funs):
	New vars.
	(completion--capf-wrapper): New function.
	(completion-at-point): Use it to track well-behavedness of
	hook functions.
	(completion-help-at-point): New command.

2011-03-30  Jason Merrill  <jason@redhat.com>  (tiny change)

	* vc/add-log.el (add-change-log-entry): Don't use whitespace
	syntax class to search for whitespace on a single line
	(Message-ID: <4D938140.4030905@redhat.com>).

2011-03-30  Leo Liu  <sdl.web@gmail.com>

	* abbrev.el (abbrev-edit-save-to-file, abbrev-edit-save-buffer):
	New commands.
	(edit-abbrevs-map): Bind them here.
	(write-abbrev-file): New optinal arg VERBOSE.  (Bug#5937)

2011-03-29  Ken Manheimer  <ken.manheimer@gmail.com>

	* allout.el (allout-hide-by-annotation, allout-flag-region):
	Reduce possibility of overlay leakage by making them volatile.

	* allout-widgets.el (allout-widgets-tally): Define as nil so the
	hash is not shared between buffers.  Mode initialization is
	responsible for giving it a useful starting value.
	(allout-item-span): Reduce possibility of overlay leakage by
	making them volatile.
	(allout-widgets-count-buttons-in-region): Add diagnostic function
	for tracking down button overlay leaks.

2011-03-29  Leo Liu  <sdl.web@gmail.com>

	* ido.el (ido-read-internal): Use the default history var
	minibuffer-history if no HISTORY is specified.

2011-03-28  Brian T. Sniffen  <bsniffen@akamai.com>  (tiny change)

	* net/imap.el (imap-shell-open, imap-process-connection-type):
	Use imap-process-connection-type for 'shell' streams as well as
	Kerberos, SSL, other subprocesses.

2011-03-28  Leo Liu  <sdl.web@gmail.com>

	* abbrev.el (abbrev-table-empty-p): New function.
	(prepare-abbrev-list-buffer): Place empty abbrev tables after
	nonempty ones.  (Bug#5937)

2011-03-27  Jan Djärv  <jan.h.d@swipnet.se>

	* cus-start.el (all): Add boolean ns-auto-hide-menu-bar.

2011-03-27  Leo Liu  <sdl.web@gmail.com>

	* ansi-color.el (ansi-color-names-vector): Allow cons cell value
	for foreground and background colors.
	(ansi-color-make-color-map): Adapt.

2011-03-25  Leo Liu  <sdl.web@gmail.com>

	* midnight.el (midnight-time-float): Remove.  Note it calculates
	the microsecond component incorrectly and seconds-to-time does the
	same job.
	Remove redundant (require 'timer).

	* ido.el (ido-read-internal): Simplify with read-from-minibuffer.
	(ido-completions): Remove unused arguments.  (Bug#8329)

2011-03-24  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuffer.el (completion--flush-all-sorted-completions):
	Remove itself from hook.
	(completion-at-point): Let the functions perform the completion
	immediately and return nil or t.
	* comint.el (comint-dynamic-complete-functions): Now identical to
	completion-at-point-functions.
	(comint-dynamic-list-input-ring): Remove unused var `index'.
	(comint--match-partial-filename, comint--unquote&expand-filename):
	New funs, split from comint-match-partial-filename.
	(comint-dynamic-complete): Use completion-at-point.
	(comint-dynamic-complete-filename): Use comint--match-partial-filename.

2011-03-24  Drew Adams  <drew.adams@oracle.com>

	* thingatpt.el: Support `defun'.

2011-03-23  Leo Liu  <sdl.web@gmail.com>

	* abbrevlist.el: Move to obsolete/abbrevlist.el.

	* help-mode.el (help-mode-finish): Tweak regexp.

2011-03-23  Glenn Morris  <rgm@gnu.org>

	* eshell/esh-opt.el (eshell-eval-using-options):
	Do not bind unused local variable `eshell-option-stub'.

	* progmodes/gdb-mi.el (gdb): Fix typo in previous change.

2011-03-22  Juanma Barranquero  <lekktu@gmail.com>

	* emacs-lisp/derived.el (define-derived-mode): Wrap declaration of
	keymap variable in `with-no-warnings' to avoid a warning when the
	keymap has been already `defconst'ed.

2011-03-22  Leo Liu  <sdl.web@gmail.com>

	* abbrev.el (write-abbrev-file): Use utf-8 for writing if it can
	encode all chars in abbrevs; otherwise use emacs-mule or
	utf-8-emacs.  (Bug#8308)

2011-03-22  Juanma Barranquero  <lekktu@gmail.com>

	* simple.el (backward-delete-char-untabify):
	Avoid warning about using `delete-backward-char'.

	* image.el (image-type-file-name-regexps): Make it variable.
	`imagemagick-register-types' modifies it, and the user may want
	to add new extensions for known image types.
	(imagemagick-register-types): Throw error if not using ImageMagick.

2011-03-22  Leo Liu  <sdl.web@gmail.com>

	* net/rcirc.el (rcirc-completion-at-point): Return nil if point is
	located before rcirc-prompt-end-marker.
	(rcirc-complete): Error if point is not after rcirc prompt.
	Handle the case when table is nil.
	(rcirc-user-authenticated): Define to fix compiler warning.

2011-03-22  Chong Yidong  <cyd@stupidchicken.com>

	* custom.el (custom--inhibit-theme-enable): Make it affect only
	custom-theme-set-variables and custom-theme-set-faces.
	(provide-theme): Ignore custom--inhibit-theme-enable.
	(load-theme): Enable the theme explicitly if NO-ENABLE is non-nil.
	(custom-enabling-themes): Delete variable.
	(enable-theme): Accept only loaded themes as arguments.
	Ignore the special custom-enabled-themes variable.
	(custom-enabled-themes): Forbid themes from setting this.
	Eliminate use of custom-enabling-themes.
	(custom-push-theme): Quote "changed" custom var entry.

2011-03-21  Leo Liu  <sdl.web@gmail.com>

	* ido.el (ido-read-internal): Add ido-selected to history instead
	of user input.

2011-03-21  Stefan Monnier  <monnier@iro.umontreal.ca>

	* subr.el (deferred-action-list, deferred-action-function):
	Mark obsolete.

2011-03-21  Leo Liu  <sdl.web@gmail.com>

	* vc/log-view.el: Remove (require 'wid-edit), not needed after the
	change on 2011-02-13 (bug#8309).

	* minibuffer.el (read-file-name-function): Change default value.
	(read-file-name--defaults): Rename from read-file-name-defaults.
	(read-file-name-default): Rename from read-file-name.
	(read-file-name): Call read-file-name-function.

2011-03-21  Glenn Morris  <rgm@gnu.org>

	* eshell/esh-opt.el (eshell-eval-using-options, eshell-process-args):
	Doc fixes.

2011-03-21  Chong Yidong  <cyd@stupidchicken.com>

	* cus-theme.el: Add missing provide statement.
	(customize-create-theme): Extract theme value correctly.
	(custom-theme-visit-theme): Autoload.
	(customize-create-theme): Prompt before inserting default faces.

2011-03-20  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-menu.el (calc-units-menu): Add entries for logarithmic
	units and musical notes.

2011-03-20  Leo Liu  <sdl.web@gmail.com>

	* ido.el (ido-read-internal): Use completing-read-default.
	(ido-completing-read): Fix compatibility with completing-read.

2011-03-20  Christian Ohler  <ohler@gnu.org>

	* emacs-lisp/ert.el (ert-run-tests-batch): Remove unused variable.
	(ert-delete-all-tests): Use `called-interactively-p' rather than
	`interactive-p'.
	(ert--make-xrefs-region): Respect END.

2011-03-19  Chong Yidong  <cyd@stupidchicken.com>

	* dired-aux.el (dired-create-directory): Signal an error if the
	directory already exists (Bug#8246).

	* facemenu.el (list-colors-display): Call list-faces-display
	inside with-help-window.
	(list-colors-print): Use display property to align the final
	column, instead of checking window-width.

2011-03-19  Eli Zaretskii  <eliz@gnu.org>

	* vc/emerge.el (emerge-metachars): Separate value for ms-dos and
	windows-nt systems.
	(emerge-protect-metachars): Quote correctly for ms-dos and
	windows-nt systems.

2011-03-19  Ralph Schleicher  <rs@ralph-schleicher.de>

	* info.el (info-initialize): Replace all uses of `:' with
	path-separator for compatibility with non-Unix systems.
	Cache quoting of path-separator.  (Bug#8258)

2011-03-19  Juanma Barranquero  <lekktu@gmail.com>

	* avoid.el (mouse-avoidance-mode, mouse-avoidance-nudge-dist)
	(mouse-avoidance-threshold, mouse-avoidance-banish-destination)
	(mouse-avoidance-mode): Fix typos in docstrings.

2011-03-19  Chong Yidong  <cyd@stupidchicken.com>

	* startup.el (package-subdirectory-regexp): Move from package.el.
	Omit \\` and \\', and let callers add them.

	* emacs-lisp/package.el (package-strip-version)
	(package-load-all-descriptors): Add \\` and \\' to
	package-subdirectory-regexp before using it.
	(package-untar-buffer): New arg DIR; ensure that file untars only
	into this expected directory.  Remove superfluous delete-region.
	(package-unpack): Caller changed.
	(package-tar-file-info): Use package-subdirectory-regexp.

2011-03-18  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc/diff-mode.el (diff-mode-map): Shadow problematic bindings from
	diff-mode-shared-map (bug#8284).
	(diff-mode-shared-map): Re-introduce some bindings that were problematic.

2011-03-17  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* calendar/time-date.el (format-seconds): Use assoc instead of
	assoc-string, since assoc-string doesn't exist in XEmacs.

2011-03-17  Juanma Barranquero  <lekktu@gmail.com>

	* custom.el (custom-known-themes): Reflow docstring.
	(custom-theme-load-path): Fix typo in docstring.
	(load-theme): Fix typo in error message.
	(custom-available-themes, custom-variable-theme-value):
	Use `let', not `let*'.

2011-03-17  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/README: Mention inclusion of musical notes.

	* calc/calc-units.el (calc-lu-quant): Rename from
	`calc-logunits-quantity'.
	(calcFunc-lupquant): Rename from `calcFunc-powerquant'.
	(calcFunc-lufquant): Rename from `calcFunc-fieldquant'.
	(calc-db): Rename from `calc-dblevel'.
	(calcFunc-dbpower): Rename from `calcFunc-dbpowerlevel'.
	(calcFunc-dbfield): Rename from `calcFunc-dbfieldlevel'.
	(calc-np): Rename from `calc-nplevel'.
	(calcFunc-nppower): Rename from `calcFunc-nppowerlevel'.
	(calcFunc-npfield): Rename from `calcFunc-npfieldlevel'.
	(calc-lu-plus): Rename from `calc-logunits-add'.
	(calcFunc-lupadd): Rename from `calcFunc-lupoweradd'.
	(calcFunc-lufadd): Rename from `calcFunc-lufieldadd'.
	(calc-lu-minus): Rename from `calc-logunits-sub'.
	(calcFunc-lupsub): Rename from `calcFunc-lupowersub'.
	(calcFunc-lufsub): Rename from `calcFunc-lufieldsub'.
	(calc-lu-times): Rename from `calc-logunits-mul'.
	(calcFunc-lupmul): Rename from `calcFunc-lupowermul'.
	(calcFunc-lufmul): Rename from `calcFunc-lufieldmul'.
	(calc-lu-divide): Rename from `calc-logunits-div'.
	(calcFunc-lupdiv): Rename from `calcFunc-lupowerdiv'.
	(calcFunc-lufdiv): Rename from `calcFunc-lufielddiv'.

	* calc/calc-ext.el (calc-init-extensions): Update the names of the
	functions being autoloaded.

	* calc/calc.el (calc-lu-power-reference): Rename from
	`calc-logunits-power-reference'.
	(calc-lu-field-reference): Rename from
	`calc-logunits-field-reference'.

	* calc/calc-help.el (calc-l-prefix-help):
	Mention musical note functions.

2011-03-17  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuffer.el (completion-all-sorted-completions):
	Use :completion-cycle-penalty text property if present.

2011-03-16  Ken Manheimer  <ken.manheimer@gmail.com>

	* allout.el (allout-yank-processing): Adjust for new rebulleting
	regime so bullet being yanked is used without prompting the user
	for a choice.

2011-03-16  Juanma Barranquero  <lekktu@gmail.com>

	* startup.el (command-line): Warn the user that _emacs is deprecated.

2011-03-16  Juanma Barranquero  <lekktu@gmail.com>

	* progmodes/delphi.el (delphi-search-path, delphi-indent-level)
	(delphi-verbose, delphi-comment-face, delphi-string-face)
	(delphi-keyword-face, delphi-ignore-changes, delphi-indent-line)
	(delphi-mode-abbrev-table, delphi-debug-buffer, delphi-tab)
	(delphi-find-unit, delphi-find-current-xdef, delphi-fill-comment)
	(delphi-new-comment-line, delphi-font-lock-defaults)
	(delphi-debug-mode-map, delphi-mode-syntax-table, delphi-mode):
	Fix typos in docstrings.

2011-03-15  Ken Manheimer  <ken.manheimer@gmail.com>

	* allout.el (allout-make-topic-prefix, allout-rebullet-heading):
	Invert the roles of character and string values for INSTEAD, so a
	string is used for the more common case of a defaulting prompt.

2011-03-15  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/ruby-mode.el (ruby-backward-sexp):
	* progmodes/ebrowse.el (ebrowse-draw-file-member-info):
	* play/gamegrid.el (gamegrid-make-face):
	* play/bubbles.el (bubbles--grid-width, bubbles--grid-height)
	(bubbles--colors, bubbles--shift-mode, bubbles--initialize-images):
	* notifications.el (notifications-notify):
	* net/xesam.el (xesam-search-engines):
	* net/quickurl.el (quickurl-list-insert):
	* vc/vc-hg.el (vc-hg-dir-printer): Fix use of case.

2011-03-15  Chong Yidong  <cyd@stupidchicken.com>

	* startup.el (command-line): Update package subdirectory regexp.

2011-03-15  Stefan Monnier  <monnier@iro.umontreal.ca>

	* allout.el (allout-abbreviate-flattened-numbering)
	(allout-mode-deactivate-hook): Fix up obsolescence "date".

	* subr.el (read-char-choice): Only show the cursor after the prompt,
	not after the answer.

2011-03-15  Kevin Ryde  <user42@zip.com.au>

	* help-fns.el (variable-at-point): Skip leading quotes, if any
	(bug#8253).

2011-03-15  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/bytecomp.el (byte-compile-save-excursion): Change the
	warning message.

2011-03-14  Michael Albinus  <michael.albinus@gmx.de>

	* shell.el (shell): When called interactively, offer to change the
	shell file name on remote hosts.

2011-03-13  Teodor Zlatanov  <tzz@lifelogs.com>

	* net/ldap.el (ldap-search-internal): Add `auth-source-search'
	integration for LDAP parameters.  The host, base, user or binddn,
	and secret tokens can be specified in a netrc file, for instance.
	This is optional because an `auth-source' parameter must be
	specified in the search attributes.

2011-03-13  Juanma Barranquero  <lekktu@gmail.com>

	* help.el (describe-mode): Link to the mode's definition (bug#8185).

2011-03-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* ebuff-menu.el (electric-buffer-menu-mode-map): Move initialization
	into declaration.  Remove redundant and harmful binding.

2011-03-12  Eli Zaretskii  <eliz@gnu.org>

	* files.el (file-ownership-preserved-p): Pass `integer' as an
	explicit 2nd argument to `file-attributes'.  If the file's owner
	is the Administrators group on Windows, and the current user is
	Administrator, consider that a match.

	* server.el (server-ensure-safe-dir): Consider server directory
	safe on MS-Windows if its owner is the Administrators group while
	the current Emacs user is Administrator.  Use `=' to compare
	numerical UIDs, since they could be integers or floats.

2011-03-12  Juanma Barranquero  <lekktu@gmail.com>

	* vc/vc-bzr.el (vc-bzr-state): Handle bzr 2.3.0 (follow-up to bug#8170).

2011-03-12  Michael Albinus  <michael.albinus@gmx.de>

	Sync with Tramp 2.2.1.

	* net/tramp-sh.el (tramp-methods): Exchange "%k" marker with options.

	* net/trampver.el: Update release number.

2011-03-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/compile.el (compilation--previous-directory): Fix up
	various nil/dead-marker mismatches (bug#8014).
	(compilation-directory-properties, compilation-error-properties):
	Don't call it at a position past the one we're about to change.

	* emacs-lisp/bytecomp.el (byte-compile-make-obsolete-variable):
	Disable obsolescence warnings in the file that declares it.

2011-03-11  Ken Manheimer  <ken.manheimer@gmail.com>

	* allout-widgets.el (allout-widgets-tally):
	Initialize allout-widgets-tally as a hash table rather than nil to
	prevent mode-line redisplay warnings.  Also, clarify the module
	description and fix a comment typo.

2011-03-11  Juanma Barranquero  <lekktu@gmail.com>

	* help-fns.el (describe-variable): Don't complete keywords.
	Suggested by Teodor Zlatanov <tzz@lifelogs.com>.

2011-03-10  Chong Yidong  <cyd@stupidchicken.com>

	* emacs-lisp/package.el (package-version-join): Impose a standard
	string representation for pre/alpha/beta version lists.
	(package-unpack-single): Standardize the directory name by passing
	it through package-version-join.
	(package-strip-rcs-id): Accept any version string that does not
	signal an error in version-to-list.

2011-03-10  Michael Albinus  <michael.albinus@gmx.de>

	* simple.el (delete-trailing-whitespace): Return nil for the
	benefit of `write-file-functions'.

2011-03-10  Glenn Morris  <rgm@gnu.org>

	* vc/vc-hg.el (vc-hg-pull, vc-hg-merge-branch): Use vc-hg-program.

	* vc/vc-git.el (vc-git-program): New option.
	(vc-git-branches, vc-git-pull, vc-git-merge-branch, vc-git-command)
	(vc-git--call): Use it.

	* eshell/esh-util.el (eshell-condition-case): Doc fix.

	* cus-edit.el (Custom-newline): If no button at point, look
	for a subgroup button at start-of-line.  (Bug#2298)

	* mail/rmail.el (rmail-msgend, rmail-msgbeg): Doc fixes.

2011-03-10  Julien Danjou  <julien@danjou.info>

	* avoid.el (mouse-avoidance-ignore-p): Do not move the cursor if
	`cursor-type' is nil.

2011-03-09  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc.el (calc-mode-map): Don't bind "C-_" to `calc-missing-key'.

2011-03-09  Ken Manheimer  <ken.manheimer@gmail.com>

	* allout.el: Change so yank of distinctive-bullet items
	preserves the existing header prefix, rebulleting it if necessary,
	rather than replacing it.  This is necessary for proper operation
	of cooperative addons like allout-widgets.
	(allout-make-topic-prefix, allout-rebullet-heading):
	Change SOLICIT arg to INSTEAD, and interpret additionally a string
	value as alternate bullet to be used, instead of prompting the user
	for a bullet character.

2011-03-09  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-sh.el (tramp-do-copy-or-rename-file-out-of-band):
	Do not use `tramp-file-name-port', because this returns also
	`tramp-default-port'.

2011-03-09  Deniz Dogan  <deniz.a.m.dogan@gmail.com>

	* net/rcirc.el (rcirc-handler-001): Remove useless
	with-rcirc-process-buffer.
	(rcirc-check-auth-status): Swap arguments to string-match.

2011-03-09  Glenn Morris  <rgm@gnu.org>

	* shell.el (shell-mode):
	Set comint-input-ring-size from HISTSIZE.  (Bug#7889)

	* progmodes/gdb-mi.el (gdb): Improve 2010-12-08 change.
	Check for GDBHISTFILE, HISTSIZE, etc.  (Bug#7889)

2011-03-08  Chong Yidong  <cyd@stupidchicken.com>

	* emacs-lisp/package.el (package-refresh-contents)
	(package-menu-execute): Use condition-case-no-debug.

2011-03-08  Michael Albinus  <michael.albinus@gmx.de>

	* simple.el (shell-command-to-string): Use `process-file'.

	* emacs-lisp/package.el (package-tar-file-info): Handle also
	remote files.

	* emacs-lisp/package-x.el (package-upload-buffer-internal):
	Use `equal' for upload base check.

2011-03-08  Arni Magnusson  <arnima@hafro.is>  (tiny change)

	* textmodes/texinfo.el (texinfo-environments):
	Add deftypecv, deftypeivar, deftypemethod, deftypeop, html.  (Bug#2783)

2011-03-08  Glenn Morris  <rgm@gnu.org>

	* cus-start.el (cursor-in-non-selected-windows):
	Fix :set quoting oddness.  (Bug#8192)

	* font-lock.el (lisp-font-lock-keywords-1): Don't highlight `)'
	in some setf expressions.  (Bug#2159)

2011-03-08  Chong Yidong  <cyd@stupidchicken.com>

	* custom.el (custom-available-themes): Return themes in
	alphabetical order.

See ChangeLog.15 for earlier changes.

;; Local Variables:
;; coding: utf-8
;; End:

  Copyright (C) 2011-2018 Free Software Foundation, Inc.

  This file is part of GNU Emacs.

  GNU Emacs is free software: you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.

  GNU Emacs is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.

  You should have received a copy of the GNU General Public License
  along with GNU Emacs.  If not, see <https://www.gnu.org/licenses/>.
