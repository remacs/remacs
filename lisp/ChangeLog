2010-10-18  Chong Yidong  <cyd@stupidchicken.com>

	* custom.el (custom-theme-set-variables): Mark as a safe function.
	(load-theme): Check forms using unsafep.

	* cus-face.el (custom-theme-set-faces): Mark as a safe function.

2010-10-17  Agustín Martín  <agustin.martin@hispalinux.es>

	* textmodes/ispell.el (ispell-aspell-find-dictionary): Fix
	aspell data file searching (bug#7230).

2010-10-16  Chong Yidong  <cyd@stupidchicken.com>

	* cus-theme.el (custom-theme--migrate-settings): New var.
	(customize-create-theme): Allow editing the `user' theme.
	(custom-theme-add-variable, custom-theme-add-var-1)
	(custom-theme-add-face, custom-theme-add-face-1): Add a checkbox
	to the front of each variable or face widget.
	(custom-theme-write): Save theme settings in the correct order.
	Optionally, remove saved settings from user customizations.
	(custom-theme-write-variables, custom-theme-write-faces): Saved
	only the checked widgets.
	(customize-themes): Add a link for migrating custom settings.

	* custom.el (custom-declare-theme, provide-theme): Use
	custom-theme-name-valid-p.
	(custom-theme-name-valid-p): Remove checks that are now
	unnecessary since themes no longer obey load-path.

	* cus-edit.el (custom-variable-value-create): For the simple
	style, hide documentation string when hidden.

2010-10-16  Chong Yidong  <cyd@stupidchicken.com>

	* cus-edit.el (custom-variable, custom-face): Combine the
	:inhibit-magic and :display-style properties into a single
	:custom-style property.
	(custom-toggle-hide-variable, custom-toggle-hide-face): New
	functions.  If hiding an edited value, save it to :shown-value.
	(custom-variable-value-create, custom-face-value-create): Use
	them.
	(custom-magic-reset): Allow magic property to be unset.

	* custom.el: Custom themes no longer use load-path.
	(custom-theme-load-path): New option.  Change built-in theme
	directory to etc/.
	(custom-enabled-themes): Add custom-theme-load-path dependency.
	(custom-theme--load-path): New function.
	(load-theme, custom-available-themes): Use it.

	* cus-theme.el (describe-theme-1): Use custom-theme--load-path.
	(customize-themes): Link to custom-theme-load-path variable.
	(custom-theme-add-var-1, custom-theme-add-face-1): Use the
	:custom-style property.

	* themes/*.el: Moved to etc/.

2010-10-16  Ralf Angeli  <angeli@caeruleus.net>

	* textmodes/reftex-cite.el
	(reftex-extract-bib-entries-from-thebibliography): Do not move
	point when searching for \bibitem entries.  Match entries with
	spaces or tabs in front of arguments.

2010-10-16  Chong Yidong  <cyd@stupidchicken.com>

	* cus-theme.el (customize-create-theme): Delete overlays after
	erasing.  If given a THEME arg, display only the faces of that arg
	instead of custom-theme--listed-faces.
	(custom-theme-variable-menu, custom-theme-variable-action)
	(custom-variable-reset-theme, custom-theme-delete-variable): Deleted.
	(custom-theme-add-variable, custom-theme-add-face): Apply value
	from the theme settings, instead of the current value.
	(custom-theme-add-var-1, custom-theme-add-face-1): New functions.
	(custom-theme-visit-theme): Allow calling outside theme buffers.
	(custom-theme-merge-theme): Don't enable the theme when merging.
	(custom-theme-write-variables, custom-theme-write-faces): Use the
	:shown-value properties to save buffer values, not global ones.
	(customize-themes): Display a warning about user customizations.

	* cus-edit.el (custom-variable-value-create)
	(custom-face-value-create): Obey new special properties
	:shown-value and :inhibit-magic.

2010-10-15  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-sh.el (tramp-open-connection-setup-interactive-shell):
	Suppress expansion of tabs to spaces.

2010-10-14  Kenichi Handa  <handa@m17n.org>

	* mail/rmail.el (rmail-show-message-1): Catch an error of
	base64-decode-region and just show an error message (bug#7165).

	* ps-mule.el (ps-mule-font-spec-list): Delete it.  Not used
	anymore.
	(ps-mule-begin-job): Fix for the case that only ENCODING is set in
	a font-spec (bug#7197).

2010-10-14  Glenn Morris  <rgm@gnu.org>

	* mail/emacsbug.el (report-emacs-bug): Mention debbugs.gnu.org.

2010-10-14  Juanma Barranquero  <lekktu@gmail.com>

	* international/mule.el (define-coding-system):
	* international/titdic-cnv.el (quail-cxterm-package-ext-info):
	* composite.el (compose-region): Fix typo in docstring.

2010-10-14  Chong Yidong  <cyd@stupidchicken.com>

	* cus-face.el (custom-theme-set-faces): Call custom-push-theme
	only after checking the theme-face property.

	* faces.el (face-spec-reset-face): Reset all attributes in one
	single call to set-face-attribute.
	(face-spec-match-p): Make it a defsubst.
	(frame-set-background-mode): New arg KEEP-FACE-SPECS.
	(x-create-frame-with-faces, tty-create-frame-with-faces)
	(tty-set-up-initial-frame-faces): Don't recompute face specs in
	frame-set-background-mode, since they are recomputed immediately
	afterwards in face-set-after-frame-default.
	(face-set-after-frame-default): Minor optimization.
	(cursor): Provide non-trivial defface spec.

	* custom.el (custom-theme-recalc-face): Simplify.

2010-10-14  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-alg.el (math-var): Renamed from `var'.
	(math-is-polynomial, math-is-poly-rec): Replace `var'
	with `math-var'.

	* calc/calcalg2.el (math-var): Renamed from `var'.
	(calcFunc-table, math-scan-for-limits): Replace `var'
	with `math-var'.

2010-10-13  Glenn Morris  <rgm@gnu.org>

	* subr.el (last): Deal with dotted lists (reported in bug#7174).

2010-10-13  Stephen Berman  <stephen.berman@gmx.net>

	* subr.el (last): Use `safe-length' instead of `length' (bug#7206).

2010-10-13  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* net/tls.el (tls-program): Remove spurious %s from openssl.
	(tls-starttls-switches): Remove starttls hack.
	(open-tls-stream): Ditto.
	(tls-find-starttls-argument): Ditto.

2010-10-13  Juanma Barranquero  <lekktu@gmail.com>

	* image.el (image-library-alist): Declare as obsolete alias.
	(image-type-available-p): Use `dynamic-library-alist'.

	* term/w32-win.el (dynamic-library-alist):
	Use instead of `image-library-alist'.

2010-10-13  IRIE Shinsuke  <irieshinsuke@yahoo.co.jp>  (tiny change)

	* subr.el (last): Make it faster.  (Bug#7174)

2010-10-13  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>  (tiny change)

	* Makefile.in (compile-clean): Use `` instead of $().  (Bug#7178)

2010-10-12  Chong Yidong  <cyd@stupidchicken.com>

	* cus-theme.el (custom-theme--listed-faces): Add cursor face.
	(describe-theme-1): Extract doc from unloaded themes.

	* custom.el (custom-theme-name-valid-p): Don't list color-themes.

	* themes/tango-theme.el:
	* themes/tango-dark-theme.el:
	* themes/wheatgrass-theme.el: New files.

2010-10-12  Chong Yidong  <cyd@stupidchicken.com>

	* cus-theme.el (describe-theme, customize-themes)
	(custom-theme-save): New commands.
	(custom-new-theme-mode-map): Bind C-x C-s.
	(custom-new-theme-mode): Use custom--initialize-widget-variables.
	(customize-create-theme): New optional arg THEME.
	(custom-theme-revert): Use it.
	(custom-theme-visit-theme): Remove dead code.
	(custom-theme-merge-theme): Use custom-available-themes.
	(custom-theme-write): Make interactive.
	(custom-theme-write): Use custom-theme-name-valid-p.
	(describe-theme-1, custom-theme-choose-revert)
	(custom-theme-checkbox-toggle, custom-theme-selections-toggle):
	New funs.
	(custom-theme-allow-multiple-selections): New option.
	(custom-theme-choose-mode): New major mode.

	* custom.el (custom-theme-set-variables): Remove dead code.  Obey
	custom--inhibit-theme-enable.
	(custom--inhibit-theme-enable): New var.
	(provide-theme): Obey it.
	(load-theme): Replace load with manual read/eval, in order to
	check for correctness.  Use custom-theme-name-valid-p.
	(custom-theme-name-valid-p): New function.
	(custom-available-themes): Use it.

	* cus-edit.el (custom--initialize-widget-variables): New function.
	(Custom-mode): Use it.

	* cus-face.el (custom-theme-set-faces): Remove dead code.  Obey
	custom--inhibit-theme-enable.

	* help-mode.el (help-theme-def, help-theme-edit): New buttons.

2010-10-12  Juanma Barranquero  <lekktu@gmail.com>

	* net/telnet.el (telnet-mode-map): Fix previous change (bug#7193).

2010-10-12  Jan Djärv  <jan.h.d@swipnet.se>

	* term/ns-win.el (ns-right-alternate-modifier): New defvar.
	(ns-right-option-modifier): New alias for ns-right-alternate-modifier.
	(mac-right-option-modifier): New alias for ns-right-option-modifier.

	* cus-start.el (all): ns-right-alternate-modifier is new.

2010-10-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/lisp.el (lisp-completion-at-point):
	Use emacs-lisp-mode-syntax-table for the whole function.

2010-10-12  David Koppelman  <koppel@ece.lsu.edu>

	* hi-lock.el (hi-lock-font-lock-hook): Check font-lock-fontified
	instead of font-lock-mode before adding keywords.
	Remove hi-lock-mode off code.  Remove inhibit hack.
	(hi-lock-set-pattern): Only add keywords if font-lock-fontified
	non-nil; removed hook inhibit hack.

2010-10-12  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/shadow.el (find-emacs-lisp-shadows): Rename it...
	(load-path-shadows-find): ... to this.
	(list-load-path-shadows): Update for above change.

	* mail/mail-utils.el (mail-mbox-from): Also try return-path.

2010-10-11  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mail/hashcash.el, net/imap.el, pgg-parse.el, pgg.el:
	Fix comment for declare-function.

2010-10-11  Chong Yidong  <cyd@stupidchicken.com>

	* custom.el (custom-fix-face-spec): New function; code moved from
	custom-face-edit-fix-value.
	(custom-push-theme): Use it when checking if a face has been
	changed outside customize.
	(custom-available-themes): New function.
	(load-theme): Use it.

	* cus-edit.el (custom-face-edit-fix-value): Use
	custom-fix-face-spec.

	* custom.el (custom-push-theme): Cleanup (use cond).
	(disable-theme): Recompute the saved-face property.
	(custom-theme-recalc-face): Follow face alias before setting prop.

	* image.el (image-checkbox-checked, image-checkbox-unchecked): New
	variables, containing checkbox images.

	* startup.el (fancy-startup-tail):
	* wid-edit.el (checkbox): Use them.

2010-10-10  Dan Nicolaescu  <dann@ics.uci.edu>

	* shell.el (shell-mode-map):
	* progmodes/modula2.el (m2-mode-map):
	* progmodes/inf-lisp.el (inferior-lisp-mode-map):
	* play/mpuz.el (mpuz-mode-map):
	* play/landmark.el (lm-mode-map):
	* play/decipher.el (decipher-mode-map):
	* play/5x5.el (5x5-mode-map):
	* net/telnet.el (telnet-mode-map):
	* net/quickurl.el (quickurl-list-mode-map):
	* net/mairix.el (mairix-searches-mode-map):
	* net/eudc-hotlist.el (eudc-hotlist-mode-map):
	* net/dig.el (dig-mode-map):
	* mail/mspools.el (mspools-mode-map):
	* hexl.el (hexl-mode-map):
	* emulation/ws-mode.el (wordstar-C-k-map, wordstar-mode-map)
	(wordstar-C-o-map, wordstar-C-q-map):
	* emacs-lisp/edebug.el (edebug-eval-mode-map):
	* emacs-lisp/chart.el (chart-map):
	* edmacro.el (edmacro-mode-map):
	* erc/erc-list.el (erc-list-menu-mode-map):
	* array.el (array-mode-map): Declare and define in one step.

	* vc/log-view.el (log-view-mode-map): Bind revert-buffer.

2010-10-10  Daiki Ueno  <ueno@unixuser.org>

	* epa.el (epa-passphrase-callback-function): Display filename
	passed as the 3rd arg.
	* epa-file.el (epa-file-passphrase-callback-function): Pass
	filename to epa-passphrase-callback-function.

2010-10-09  Chong Yidong  <cyd@stupidchicken.com>

	* cus-edit.el (custom-face-widget-to-spec)
	(custom-face-get-current-spec, custom-face-state): New functions.
	(custom-face-set, custom-face-mark-to-save)
	(custom-face-value-create, custom-face-state-set): Use them.

	* cus-theme.el (custom-theme--listed-faces): New var.
	(customize-create-theme): Use *Custom Theme* as the buffer name.
	Set revert-buffer-function.  Optional arg BUFFER.  Insert all
	faces listed in custom-theme--listed-faces.
	(custom-theme-revert): New function.
	(custom-theme-add-variable, custom-theme-add-face): Insert at the
	bottom of the list.
	(custom-theme-write): Prompt for theme name if empty.
	(custom-theme-write-variables): Use dolist.
	(custom-theme-write-faces): Handle hidden (collapsed) widgets.

2010-10-09  Alan Mackenzie  <acm@muc.de>

	Enhance fontification of declarators to take account of the
	presence/absence of "typedef".

	* cc-engine.el (c-forward-type): New &optional param
	"brace-block-too".
	(c-forward-decl-or-cast-1): cdr of return value now indicates the
	presence of either or both of a "struct"-like keyword and
	"typedef".

	* cc-fonts.el (c-complex-decl-matchers): Remove the heuristic
	fontification of declarators which follow a "}".
	(c-font-lock-declarations): Fontify declarators according to the
	presence/absence of "typedef".

	* cc-langs.el (c-typedef-kwds c-typedef-key): New lang variable
	for "typedef".
	(c-typedef-decl-key): New lang variable built from
	c-typedef-decl-kwds.

2010-10-09  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* ibuffer.el (ibuffer-mode-map): Don't redefine the cursor keys,
	since that's too annoying.  Move the filter groups commands to
	TAB/backtab.

	* epa.el (epa-passphrase-callback-function): Say what we're
	querying the password for.

	* ibuffer.el (ibuffer-visit-buffer): To mimick list-buffers
	behaviour, don't bury the ibuffer buffer when visiting other
	buffers.

2010-10-08  Chong Yidong  <cyd@stupidchicken.com>

	* cus-edit.el (custom-commands, custom-buffer-create-internal)
	(custom-magic-value-create): Pad button tags with spaces.
	(custom-face-edit): New variable.
	(custom-face-value-create): Determine whether to use the usual
	face editor here, instead of using custom-face-selected.  Pass
	face defaults to custom-face-edit widget.
	(custom-face-selected, custom-display-unselected): Delete widgets.
	(custom-display-unselected-match): Function removed.
	(custom-face-set, custom-face-mark-to-save): Accept
	custom-face-edit widgets as the direct widget child.

	* wid-edit.el (widget--completing-widget): New var.
	(widget-default-complete): Bind it when doing completion.
	(widget-string-complete, widget-file-complete): Use it.

2010-10-09  Glenn Morris  <rgm@gnu.org>

	* calendar/cal-hebrew.el (holiday-hebrew-rosh-hashanah)
	(holiday-hebrew-passover, holiday-hebrew-tisha-b-av)
	(holiday-hebrew-misc): Small simplifications.

	* emacs-lisp/authors.el (authors-valid-file-names): Add b2m.c.

	* net/browse-url.el: Don't require thingatpt, term, dired,
	executable, or w3-auto when compiling.
	(dired-get-filename, term-char-mode, term-send-down, term-send-string):
	Declare.
	(browse-url-text-emacs): Require term.

2010-10-08  Andreas Schwab  <schwab@linux-m68k.org>

	* net/browse-url.el (browse-url-xdg-open): Remove use of /bin/sh.

2010-10-08  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/cl-compat.el, emacs-lisp/lmenu.el: Move to obsolete/.

	* emacs-lisp/shadow.el (lisp-shadow): Change prefix.
	(shadows-compare-text-p): Make it an obsolete alias for...
	(load-path-shadows-compare-text): ... new name.
	(find-emacs-lisp-shadows): Update for above name change.
	(load-path-shadows-same-file-or-nonexistent): New name for the old
	shadow-same-file-or-nonexistent.

2010-10-08  Chong Yidong  <cyd@stupidchicken.com>

	* minibuffer.el (completion--some, completion--do-completion)
	(minibuffer-complete-and-exit, minibuffer-completion-help)
	(completion-basic-try-completion)
	(completion-basic-all-completions)
	(completion-pcm--find-all-completions): Use lexical-let to
	avoid some false matches in variable completion (Bug#7056)

2010-10-08  Olof Ohlsson Sax  <olof.ohlsson.sax@gmail.com>  (tiny change)

	* vc-svn.el (vc-svn-merge-news): Use --non-interactive.  (Bug#7152)

2010-10-08  Leo  <sdl.web@gmail.com>

	* dnd.el (dnd-get-local-file-name): If MUST-EXIST is non-nil, only
	return non-nil if the file exists (Bug#7090).

2010-10-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuffer.el (completion--replace):
	Better preserve markers (bug#7138).

2010-10-08  Juanma Barranquero  <lekktu@gmail.com>

	* server.el (server-process-filter): Doc fix.

2010-10-08  Drew Adams  <drew.adams@oracle.com>

	* dired.el (dired-save-positions): Doc fix.  (Bug#7119)

2010-10-08  Andreas Schwab  <schwab@linux-m68k.org>

	* Makefile.in (ELCFILES): Update.

2010-10-08  Glenn Morris  <rgm@gnu.org>

	* vc/ediff-wind.el (ediff-setup-control-frame):
	* vc/ediff-ptch.el (ediff-default-backup-extension):
	* vc/ediff-diff.el (ediff-shell, ediff-diff-options)
	(ediff-exec-process): Remove system-types emx, windows-95.

	* net/browse-url.el (browse-url-xdg-open): Shell-quote url.  (Bug#7166)

2010-10-07  Chong Yidong  <cyd@stupidchicken.com>

	* cus-edit.el (custom-variable, custom-face): Doc fix.
	(custom-face-edit): Add value-create attribute.
	(custom-face-edit-value-create)
	(custom-face-edit-value-visibility-action): New functions.  Hide
	unused face attributes by default, and add a visibility toggle.
	(custom-face-edit-deactivate): Show empty values with shadow face.
	(custom-face-selected): Only use this for face specs with default
	attributes.
	(custom-face-value-create): Cleanup.

	* wid-edit.el (widget-checklist-value-create): Use dolist.
	(widget-checklist-match-find): Make second arg optional.

2010-10-07  Glenn Morris  <rgm@gnu.org>

	* hilit-chg.el (hilit-chg-get-diff-info, hilit-chg-get-diff-list-hk):
	Prefix things.

	* emacs-lisp/shadow.el (shadow-font-lock-keywords)
	(load-path-shadows-mode, list-load-path-shadows): Rename shadow-mode to
	load-path-shadows-mode, update references.
	(load-path-shadows-font-lock-keywords, load-path-shadows-find-file):
	Rename variable and button.
	(list-load-path-shadows): Update button caller.

2010-10-07  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/smie.el (smie-bnf-classify): New function.
	(smie-bnf-precedence-table): Use it to remember the closers/openers.
	(smie-merge-prec2s): Handle those new entries.
	(smie-prec2-levels): Only set precedence to nil for actual
	openers/closers.
	* progmodes/octave-mod.el (octave-smie-op-levels): Remove dummy entry
	that is now unnecessary.

2010-10-07  Miles Bader  <miles@gnu.org>

	* emacs-lisp/regexp-opt.el (regexp-opt): Add `symbols' mode.

2010-10-07  Glenn Morris  <rgm@gnu.org>

	* mail/rmail.el (mail-sendmail-delimit-header, mail-header-end)
	(mail-position-on-field): Remove declarations.
	(mail-position-on-field): Autoload it.
	(rmail-retry-failure): Replace use of mail-sendmail-delimit-header
	and mail-header-end.  Don't require sendmail.

	* emacs-lisp/shadow.el (shadow-font-lock-keywords): New variable.
	(shadow-mode): New mode.
	(shadow-find-file): New button.
	(list-load-path-shadows): Use shadow-mode and buttons.

	* iimage.el (iimage-version): Remove.
	(iimage-mode-image-search-path, iimage-mode-image-regex-alist):
	Turn into defcustoms.
	(iimage-mode-map): Give it a doc string.

	* calendar/appt.el (appt-activate): Give a warning rather than an error
	if there is no diary-file.

2010-10-06  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-sh.el (tramp-sh-file-name-handler-alist):
	Use `tramp-handle-find-backup-file-name'.

2010-10-06  Glenn Morris  <rgm@gnu.org>

	* font-core.el (font-lock-defaults-alist): Remove variable.
	(font-lock-mode): Doc fix.
	(font-lock-default-function): Do not consult font-lock-defaults-alist.
	* font-lock.el (font-lock-refresh-defaults): Doc fix.
	(font-lock-set-defaults): Doc fix.
	Do not consult font-lock-defaults-alist.

	* hilit-chg.el (hilit-chg-get-diff-list-hk): Declare `e' for compiler.

	* emacs-lisp/cl.el: No longer provide cl-19.

2010-10-05  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-handle-directory-files-and-attributes)
	(tramp-handle-file-exists-p, tramp-handle-file-newer-than-file-p):
	New defuns, taken from tramp-smb.el.
	(tramp-coding-system-change-eol-conversion)
	(tramp-set-process-query-on-exit-flag): Removed.

	* net/tramp-compat.el (top): Do not check for byte-compiler
	objects.
	(tramp-compat-coding-system-change-eol-conversion)
	(tramp-compat-set-process-query-on-exit-flag): New defuns, taken
	from tramp.el.

	* net/tramp-gvfs.el:
	* net/tramp-gw.el: Replace `tramp-set-process-query-on-exit-flag'
	by `tramp-compat-set-process-query-on-exit-flag'.

	* net/tramp-imap.el (tramp-imap-file-name-handler-alist): Use
	`tramp-handle-directory-files-and-attributes',
	`tramp-handle-file-exists-p' and
	`tramp-handle-file-newer-than-file-p'.
	(tramp-imap-handle-file-exists-p)
	(tramp-imap-handle-file-executable-p)
	(tramp-imap-handle-file-readable-p)
	(tramp-imap-handle-directory-files-and-attributes)
	(tramp-imap-handle-file-newer-than-file-p): Removed.

	* net/tramp-sh.el: Replace `tramp-set-process-query-on-exit-flag'
	by `tramp-compat-set-process-query-on-exit-flag' and
	`tramp-coding-system-change-eol-conversion' by
	`tramp-compat-coding-system-change-eol-conversion'.

	* net/tramp-smb.el (tramp-smb-file-name-handler-alist): Use
	`tramp-handle-directory-files-and-attributes',
	`tramp-handle-file-exists-p' and
	`tramp-handle-file-newer-than-file-p'.
	(tramp-smb-handle-directory-files-and-attributes)
	(tramp-smb-handle-file-exists-p)
	(tramp-smb-handle-file-newer-than-file-p): Removed.
	(tramp-smb-maybe-open-connection): Replace
	`tramp-set-process-query-on-exit-flag' by
	`tramp-compat-set-process-query-on-exit-flag'.

2010-10-05  Glenn Morris  <rgm@gnu.org>

	* obsolete/rnews.el, obsolete/rnewspost.el: Remove files.

2010-10-04  Michael Albinus  <michael.albinus@gmx.de>

	Continue reorganization of load dependencies.  (Bug#7156)

	* net/tramp.el (tramp-handle-file-local-copy-hook)
	(tramp-delete-temp-file-function): Move down.
	(tramp-exists-file-name-handler): Move up.
	(tramp-register-file-name-handlers): Simplify autoload.
	(tramp-handle-write-region-hook, tramp-handle-directory-file-name)
	(tramp-handle-directory-files, tramp-handle-dired-uncache)
	(tramp-handle-file-modes, tramp-handle-file-name-as-directory)
	(tramp-handle-file-name-completion)
	(tramp-handle-file-name-directory)
	(tramp-handle-file-name-nondirectory, tramp-handle-file-regular-p)
	(tramp-handle-file-remote-p, tramp-handle-file-symlink-p)
	(tramp-handle-find-backup-file-name)
	(tramp-handle-insert-file-contents, tramp-handle-load)
	(tramp-handle-substitute-in-file-name)
	(tramp-handle-unhandled-file-name-directory)
	(tramp-mode-string-to-int, tramp-local-host-p)
	(tramp-make-tramp-temp-file): Moved from tramp-sh.el.

	* net/tramp-gvfs.el (top):
	* net/tramp-smb.el (top): Do not require 'tramp-sh.

	* net/tramp-sh.el (all): Move several objects to tramp.el, see
	there.  Rename `tramp-handle-*' to `tramp-sh-handle-*'.

2010-10-04  Glenn Morris  <rgm@gnu.org>

	* calendar/appt.el (appt-add): Ensure reminders are enabled.
	(appt-activate): Give status messages.

2010-10-03  Teodor Zlatanov  <tzz@lifelogs.com>

	* net/gnutls.el: Improve docs.  Remove starttls and ssl emulation.
	Provide only `open-gnutls-stream' (formerly `open-ssl-stream') and
	`gnutls-negotiate' (formerly `starttls-negotiate').  Remove
	trivial wrapper `starttls-open-stream'.

2010-10-03  Dan Nicolaescu  <dann@ics.uci.edu>

	Make 'g' (AKA revert-buffer) rerun the VC log, log-incoming and
	log-outgoing commands.
	* vc/vc.el (vc-log-internal-common): Add a new argument and use it
	to create a buffer local revert-buffer-function variable.
	(vc-print-log-internal, vc-log-incoming, vc-log-outgoing): Pass a
	revert-buffer-function lambda.

2010-10-03  Teodor Zlatanov  <tzz@lifelogs.com>

	* net/gnutls.el (starttls-negotiate): Use the plist interface to
	`gnutls-boot'.  Make TYPE the only required parameter.  Allow
	TRUSTFILES and KEYFILES to be lists.
	(open-ssl-stream): Use it.

2010-10-03  Glenn Morris  <rgm@gnu.org>

	* subr.el (directory-sep-char): Remove obsolete variable.
	* net/tramp-compat.el: Don't mess about with the byte-compiler unless
	it is "necessary".

	* vc/vc-hooks.el (vc-header-alist): Remove obsolete variable.
	* vc/vc.el (vc-static-header-alist): Doc fix.
	* vc/vc-cvs.el (vc-cvs-header):
	* vc/vc-rcs.el (vc-rcs-header):
	* vc/vc-sccs.el (vc-sccs-header):
	* vc/vc-svn.el (vc-svn-header): Do not consult vc-header-alist.
	* obsolete/vc-mcvs.el (vc-mcvs-header):
	* progmodes/cperl-mode.el (cperl-mode): Only set vc-header-alist
	on XEmacs.

2010-10-03  Chong Yidong  <cyd@stupidchicken.com>

	* emacs-lisp/bytecomp.el (byte-compile-from-buffer): Remove
	obsolete use of binary-overwrite-mode (Bug#7001).

2010-10-03  Glenn Morris  <rgm@gnu.org>

	* obsolete/x-menu.el: Remove file, obsolete since 21.1

	* textmodes/rst.el (rst-font-lock-keywords-function):
	Drop Emacs 20 code.

	* textmodes/artist.el (artist-replace-char): Drop Emacs 20 code.

	* printing.el: Drop Emacs 20 code.

	* calendar/appt.el (appt-delete): Don't autoload it (you can't use it
	without having used appt.el already).

	* subr.el (make-local-hook): Remove function obsolete since 21.1.
	* progmodes/cc-mode.el (make-local-hook): Don't do cc-bytecomp stuff.
	(c-basic-common-init, c-font-lock-init): Only call make-local-hook on
	XEmacs.
	* progmodes/cc-styles.el (make-local-hook): Don't do cc-bytecomp stuff.
	(c-make-styles-buffer-local): Only call make-local-hook on XEmacs.

	* ps-def.el (leading-code-private-22, charset-bytes, charset-id)
	(charset-width, find-charset-region, chars-in-region, forward-point)
	(encode-coding-string, coding-system-p, ccl-execute-on-string)
	(define-ccl-program, multibyte-string-p, string-make-multibyte):
	Remove compatibility cruft (none of these are used by ps*.el).

2010-10-03  Kevin Rodgers  <kevin.d.rodgers@gmail.com>

	* subr.el (booleanp): Return t instead of a list (Bug#7086).

2010-10-03  Chong Yidong  <cyd@stupidchicken.com>

	* server.el (server-process-filter, server-return-error): Give
	emacsclient time to shut down after receiving an error string.

2010-10-02  Michael Albinus  <michael.albinus@gmx.de>

	* files.el (remote-file-name-inhibit-cache): New defcustom.

	* time.el (display-time-file-nonempty-p): Use
	`remote-file-name-inhibit-cache'.

	* net/tramp.el (tramp-completion-reread-directory-timeout): Fix
	docstring.

	* net/tramp-cache.el (tramp-cache-inhibit-cache): Remove.
	(tramp-get-file-property): Replace `tramp-cache-inhibit-cache' by
	`remote-file-name-inhibit-cache'.  Check also for an integer
	value.  Add/increase counter when `tramp-verbose' >= 10.
	(tramp-set-file-property): Add/increase counter when
	`tramp-verbose' >= 10.

	* net/tramp-cmds.el (tramp-cleanup-all-connections)
	(tramp-cleanup-all-buffers): Set tramp-autoload cookie.
	(tramp-bug): Set tramp-autoload cookie.  Report all interned
	tramp-* variables.  Report also `remote-file-name-inhibit-cache'.
	(tramp-reporter-dump-variable): Fix docstring.  Mask non-7bit
	characters only in strings.

	* net/tramp-compat.el (remote-file-name-inhibit-cache): Define due
	to backward compatibility.

	* net/tramp-sh.el (tramp-handle-verify-visited-file-modtime)
	(tramp-handle-file-name-all-completions)
	(tramp-handle-vc-registered): Use
	`remote-file-name-inhibit-cache'.
	(tramp-open-connection-setup-interactive-shell): Call
	`tramp-cleanup-connection' directly.

2010-10-02  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/checkdoc.el (checkdoc-minor-keymap): Remove obsolete alias.

	* subr.el (char-bytes): Remove obsolete function.

	* isearch.el (isearch-return-char): Remove obsolete function.

	* mouse.el: No longer provide mldrag.
	(mldrag-drag-mode-line, mldrag-drag-vertical-line):
	Remove obsolete aliases.

	* comint.el (comint-kill-output): Remove obsolete alias.

	* composite.el (decompose-composite-char): Remove obsolete function.
	* ps-def.el (decompose-composite-char): Remove unused function.

	* iswitchb.el (iswitchb-default-keybindings): Remove obsolete function.

	* outline.el (outline-visible): Remove obsolete function.

	* term/pc-win.el (x-frob-font-slant, x-frob-font-weight):
	* faces.el (internal-find-face, internal-get-face)
	(frame-update-faces, frame-update-face-colors)
	(x-frob-font-weight, x-frob-font-slant)
	(internal-frob-font-weight, internal-frob-font-slant)
	(x-make-font-bold, x-make-font-demibold, x-make-font-unbold)
	(x-make-font-italic, x-make-font-oblique, x-make-font-unitalic)
	(x-make-font-bold-italic): Remove functions and aliases, obsolete
	since Emacs 21.1.
	* emulation/viper-util.el (viper-get-face):
	* obsolete/lucid.el (find-face, get-face): Use facep.
	* vc/ediff-init.el (ediff-valid-color-p, ediff-get-face):
	Remove unused functions.
	* vc/ediff-util.el (ediff-submit-report): Doc fix.

	* emacs-lisp/bytecomp.el (byte-compile-file): Use kill-emacs-hook to
	delete tempfile if interrupted during compilation.

2010-10-01  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* net/tls.el (tls-starttls-switches): Give up on using starttls with
	gnutls-cli.
	(tls-program): Add --insecure to be consistent with the defaults from
	openssl s_client.  Now all three commands are insecure.

2010-10-01  Eli Zaretskii  <eliz@gnu.org>

	* makefile.w32-in (DEST, TAGS, TAGS-LISP, TAGS-nmake)
	(TAGS-LISP-nmake, TAGS-gmake, TAGS-LISP-gmake, TAGS-SH)
	(TAGS-LISP-SH, TAGS-CMD, TAGS-LISP-CMD): New targets.

2010-10-01  Glenn Morris  <rgm@gnu.org>

	* obsolete/sc.el: Remove file.

	* files.el (temporary-file-directory): On darwin, also try
	DARWIN_USER_TEMP_DIR (see discussion in bug#7135).

2010-10-01  Juanma Barranquero  <lekktu@gmail.com>

	* server.el (server-start): Revert part of 2010-09-30T02:53:26Z!lekktu@gmail.com.
	Let's not break compatibility gratuitously, shall we?

2010-09-30  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* net/tls.el (tls-starttls-switches): New variable.
	(tls-find-starttls-argument): Use it.
	(open-tls-stream): Ditto.

	* net/netrc.el (netrc-credentials): Return the value of the "default"
	entry.
	(netrc-machine): Ditto.

2010-09-30  Eli Zaretskii  <eliz@gnu.org>

	* vc/vc-hooks.el (vc-default-mode-line-string): Doc fix.

2010-09-30  Juanma Barranquero  <lekktu@gmail.com>

	* server.el (server-start): Don't write pid to the authentication file.
	(server-create-tty-frame): Don't send pid.
	(server-process-filter): Send pid at the start of every connection.

2010-09-30  Glenn Morris  <rgm@gnu.org>

	* calendar/diary-lib.el (view-diary-entries, list-diary-entries)
	(show-all-diary-entries): Remove obsolete function aliases.

	* calendar/appt.el (appt-issue-message, appt-visible, appt-msg-window):
	Remove options, obsolete since 22.1.
	(appt-display-format, appt-display-message): Remove
	backwards-compatibility code.
	(appt-check): No longer check appt-issue-message.
	(appt-make-list): No longer autoload it.  Doc fix.  No longer
	activate the package.

2010-09-29  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* net/gnutls.el (starttls-negotiate): Loop a lot longer.
	(starttls-negotiate): Just call boot, and let the handshake be
	triggered from the read loop.

2010-09-29  Glenn Morris  <rgm@gnu.org>

	* calendar/diary-lib.el (diary-list-entries): Use temp buffers when
	not displaying the diary.
	(diary-add-to-list): If no buffer-file-name, fall back to diary-file.
	* calendar/appt.el (appt-check): No longer need to kill diary.

	* calendar/diary-lib.el (diary-list-entries): Move the
	"Preparing..." message entirely here.
	(diary-simple-display, diary-fancy-display): Move "Preparing..."
	messages to diary-list-entries.
	(diary-include-other-diary-files): Use LIST-ONLY rather than setting
	diary-display-function.

	* calendar/diary-lib.el (diary-include-other-diary-files):
	Trap some recursive includes.

	* calendar/appt.el (appt-activate): Check diary file.

2010-09-29  Katsumi Yamaoka  <yamaoka@jpl.org>

	* pgg.el (pgg-run-at-time-1): Define it for XEmacs only; fix if/else
	construction.

	* calendar/time-date.el: No need to require cl for Emacs 21.

2010-09-28  Glenn Morris  <rgm@gnu.org>

	* calendar/appt.el (appt-check): Minor simplification.

2010-09-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mail/sendmail.el (mail-citation-prefix-regexp): Remove "}" from
	citation prefix.

2010-09-27  Andreas Schwab  <schwab@linux-m68k.org>

	* emacs-lisp/byte-opt.el (byte-optimize-form-code-walker):
	Avoid infinite recursion on erroneous lambda form.  (Bug#7114)

2010-09-27  Kenichi Handa  <handa@m17n.org>

	* tar-mode.el (tar-header-block-tokenize): Decode filenames in
	"ustar" format.

2010-09-27  Kenichi Handa  <handa@m17n.org>

	* international/mule.el (define-coding-system): Docstring fixed.

	* international/mule-diag.el (describe-character-set): Use princ
	with proper print-length and print-level instead of insert.

2010-09-27  Juanma Barranquero  <lekktu@gmail.com>

	* window.el (walk-windows): Doc fix (bug#7105).

2010-09-27  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/float-sup.el (e): Remove.

2010-09-27  Teodor Zlatanov  <tzz@lifelogs.com>

	* net/gnutls.el (gnutls, gnutls-log-level): Add group and custom
	variable.
	(starttls-negotiate): Use it.

2010-09-27  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* net/gnutls.el (starttls-negotiate): Stop looping when we get a t
	back.

2010-09-26  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/pcase.el (pcase-let*, pcase-let): plet -> pcase-let.

2010-09-26  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* net/gnutls.el (starttls-negotiate): Avoid the cl.el decf function.

	* net/netrc.el (netrc-store-data): New function.

2010-09-26  Teodor Zlatanov  <tzz@lifelogs.com>

	* net/gnutls.el: GnuTLS glue code to set up a connection.

2010-09-25  Julien Danjou  <julien@danjou.info>

	* notifications.el: Call dbus-register-signal only if it is bound.

2010-09-25  Glenn Morris  <rgm@gnu.org>

	* eshell/em-alias.el, eshell/em-banner.el, eshell/em-basic.el:
	* eshell/em-cmpl.el, eshell/em-dirs.el, eshell/em-glob.el:
	* eshell/em-hist.el, eshell/em-ls.el, eshell/em-pred.el:
	* eshell/em-prompt.el, eshell/em-rebind.el, eshell/em-script.el:
	* eshell/em-smart.el, eshell/em-term.el, eshell/em-unix.el:
	* eshell/esh-cmd.el, eshell/esh-ext.el, eshell/esh-io.el:
	* eshell/esh-mode.el, eshell/esh-proc.el, eshell/esh-test.el:
	* eshell/esh-util.el, eshell/esh-var.el:
	Remove leading `*' from docs of faces and defcustoms.

2010-09-25  Ulrich Mueller  <ulm@gentoo.org>

	* eshell/em-ls.el (eshell-ls-archive-regexp):
	* eshell/esh-util.el (eshell-tar-regexp):
	* ibuffer.el (ibuffer-compressed-file-name-regexp):
	* info.el (Info-suffix-list):
	* international/mule.el (auto-coding-alist):
	* woman.el (woman-file-regexp, woman-file-compression-regexp):
	* progmodes/etags.el (tags-compression-info-list):
	Support xz compression.

2010-09-25  Chong Yidong  <cyd@stupidchicken.com>

	* files.el (get-free-disk-space): Don't assume the "df" output
	columns line up (Bug#6995).

2010-09-25  Juanma Barranquero  <lekktu@gmail.com>

	* finder.el (finder-unknown-keywords):
	* progmodes/gdb-mi.el (gdb-jsonify-buffer, gdb-running-threads-count):
	* progmodes/etags.el (tags-table-including): Fix typos in docstrings.

2010-09-25  Juanma Barranquero  <lekktu@gmail.com>

	* server.el (server-start): Revert part of 2010-08-08 change.  Using
	address 127.0.0.1 for local host is now done in Fmake_network_process.

2010-09-24  Glenn Morris  <rgm@gnu.org>

	* image-mode.el, progmodes/compile.el, progmodes/gud.el:
	* progmodes/mixal-mode.el, textmodes/bibtex-style.el:
	* textmodes/css-mode.el, textmodes/dns-mode.el:
	Move autoloaded auto-mode-alist entries to files.el.
	* files.el (auto-mode-alist): Move entries here.

2010-09-23  Glenn Morris  <rgm@gnu.org>

	* isearch.el (isearch-lazy-highlight-cleanup)
	(isearch-lazy-highlight-initial-delay)
	(isearch-lazy-highlight-interval)
	(isearch-lazy-highlight-max-at-a-time, isearch-lazy-highlight-face):
	* net/net-utils.el (ipconfig-program-options):
	Move aliases to options before the associated definitions.

2010-09-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* newcomment.el (comment-normalize-vars): Better test validity of
	comment-end-skip.

2010-09-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/float-sup.el (float-pi): New name for `pi'.
	(float-e): New name for `e'.
	(degrees-to-radians, radians-to-degrees):
	* calendar/solar.el (solar-longitude):
	* calculator.el (calculator-registers, calculator-funcall):
	* textmodes/artist.el (artist-spray-random-points):
	* play/bubbles.el (bubbles--initialize-images): Use new names.

2010-09-23  Eric M. Ludlam  <zappo@gnu.org>

	Update to CEDET 1.0's version of EIEIO.

	* emacs-lisp/eieio.el (eieio-specialized-key-to-generic-key):
	New function.
	(eieio-defmethod, eieio-generic-form, eieio-generic-call): Use it.
	(eieio-default-eval-maybe): Eval val instead of unquoting only.
	(class-precedence-list): If class is nil, return nil.
	(eieio-generic-call): If class of first input arg is nil, don't
	look up static methods, and do check for primary methods.
	(initialize-instance): See if the default needs to be evaluated
	during the constructor.
	(eieio-perform-slot-validation-for-default): Don't do the check
	for values that will eventually be evaluated.
	(eieio-eval-default-p): New function.
	(eieio-default-eval-maybe): Use it.

2010-09-23  Jan Moringen  <jan.moringen@uni-bielefeld.de>

	* emacs-lisp/eieio.el (eieio-defclass): Allow :c3
	method-invocation-order.
	(eieio-c3-candidate, eieio-c3-merge-lists): New functions.
	(eieio-class-precedence-dfs): Compute class precedence list using
	dfs algorithm.
	(eieio-class-precedence-bfs): Compute class precedence list using
	bfs algorithm.
	(eieio-class-precedence-c3): Compute class precedence list using
	c3 algorithm.
	(class-precedence-list): New function.
	(eieiomt-method-list, eieiomt-sym-optimize): Use it.
	(inconsistent-class-hierarchy): New error symbol.
	(call-next-method): Stow the replacement argument list for future
	call-next-method invocations.

2010-09-23  Glenn Morris  <rgm@gnu.org>

	* calendar/appt.el (appt-check): If not displaying the diary,
	use (diary 1) to only get the entries we need.
	(appt-make-list): Sort diary-list-entries, if we cannot guarantee
	that it is in day order.  (Bug#7019)

	* calendar/appt.el (appt-check): Rather than showing the diary,
	just turn off invisible display, and only if needed.

	* calendar/diary-lib.el (diary-list-entries): Doc fix.  (Bug#7019)

2010-09-23  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/bytecomp.el (byte-compile-file-form-defvar):
	(byte-compile-defvar, byte-compile-cl-warn):
	Start warnings with lower-case, like the majority.

	* files.el (auto-mode-alist): Add .xa, .xw, .xsw for ld-script-mode.

	* files.el (auto-mode-alist): Prefer C-mode for .xs.  (Bug#7071)

	* progmodes/ld-script.el (auto-mode-alist): Move to files.el.
	* files.el (auto-mode-alist): Move ld-script entries here, further down
	the list.

	* vc/add-log.el: Don't require timezone when compiling.
	(timezone-make-date-sortable): Autoload it.
	(change-log-sortable-date-at): Don't require timezone.
	Use `ignore-errors'.

	* comint.el (comint-use-prompt-regexp-instead-of-fields):
	Move alias before definition, so it does not need autoloading.

	* emulation/crisp.el, emulation/cua-base.el, emulation/edt.el:
	* emulation/pc-select.el, emulation/vip.el, international/iso-ascii.el:
	* international/kkc.el, international/ogonek.el, mail/feedmail.el:
	* net/browse-url.el, net/eudc-vars.el, net/net-utils.el:
	* net/rcompile.el, net/rlogin.el, textmodes/enriched.el:
	* textmodes/makeinfo.el, textmodes/page-ext.el, textmodes/picture.el:
	* textmodes/refer.el, textmodes/spell.el, textmodes/table.el:
	* textmodes/tex-mode.el, textmodes/two-column.el:
	Remove leading `*' from docs of defcustoms etc.

2010-09-23  Teodor Zlatanov  <tzz@lifelogs.com>

	* net/netrc.el (netrc-parse): Remove encrypt.el mentions.

2010-09-22  Dan Christensen  <jdc@uwo.ca>

	* calendar/time-date.el (date-to-time): Try using parse-time-string
	first before using the slower timezone-make-date-arpa-standard.

2010-09-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* calendar/time-date.el (format-seconds): Comment fix.

2010-09-22  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/package.el (package-menu-mode): `revert-buffer-function'
	is not automatically buffer-local.

2010-09-21  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/smie.el (smie-debug--describe-cycle): Fix typo.
	(smie-indent-comment): Be more careful with comment-start-skip.
	(smie-indent-comment-close, smie-indent-comment-inside): New funs.
	(smie-indent-functions): Use them.

2010-09-21  Michael Albinus  <michael.albinus@gmx.de>

	* net/ange-ftp.el (ange-ftp-skip-msgs): Add "^504 ..." message.

2010-09-21  Jan Djärv  <jan.h.d@swipnet.se>

	* menu-bar.el (menu-bar-set-tool-bar-position): customize-set-variable
	tool-bar-position.  Don't modify frame parameters here.
	(menu-bar-options-save): Add tool-bar-position.

	* tool-bar.el (tool-bar-position): New defcustom (Bug#7049).

2010-09-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/reftex-parse.el (reftex-what-macro)
	(reftex-context-substring): Let-bind forward-sexp-function to nil
	since we don't need/want to treat \begin...\end as a block (bug#7053).

	* emacs-lisp/lisp.el (up-list): Don't do nothing silently.

	* simple.el (blink-matching-open): Use syntax-class.

	* progmodes/pascal.el (pascal-mode): Use define-derived-mode.
	Set invisibility spec for pascal's outline mode.
	(pascal-outline-change): Clean up calling convention.
	(pascal-show-all, pascal-hide-other-defuns): Update callers.

	* progmodes/prolog.el (prolog-smie-forward-token)
	(prolog-smie-backward-token): New functions.
	(prolog-mode-variables): Use them to parse "!," correctly.
	Set up smie-blink-matching for ".".

	* textmodes/ispell.el (ispell-start, ispell-end): Rename from `start'
	and `end'.
	(ispell-region, ispell-process-line): Update users.

	* textmodes/reftex-parse.el (reftex-what-macro): Don't hardcode
	point-min==1.

	* textmodes/ispell.el: Fix commenting convention.
	(ispell-parse-output): Simplify, use push.
	(ispell-region): Use match-string-no-properties.
	(ispell-begin-skip-region-regexp): Use mapconcat to simplify.
	(ispell-minor-mode): Use define-minor-mode.
	(ispell-message): Remove unused var `skip-regexp'.
	(ispell-add-per-file-word-list): Use dynamic let-binding.
	Try and use the proper comment marker.

	* mail/sendmail.el: Fix commenting convention.
	(sendmail-send-it): Use line-beginning-position.

	* help-fns.el (describe-variable): Add original value, if applicable.

2010-09-20  Juanma Barranquero  <lekktu@gmail.com>

	* subr.el (y-or-n-p): Remove leftover code from 2010-09-17T13:30:30Z!monnier@iro.umontreal.ca.

	* emacs-lisp/smie.el (smie-indent--hanging-p): Use `smie-indent--bolp'.

2010-09-19  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/smie.el (smie-bnf-precedence-table): Improve error message.
	(smie-debug--prec2-cycle, smie-debug--describe-cycle): New functions.
	(smie-prec2-levels): Use them to better diagnose precedence cycles.
	(smie-blink-matching-check): Don't signal a mismatch if car is t.
	(smie-blink-matching-open): Rewrite to remove assumptions, so that
	something like "." can also be a closer.
	(smie--associative-p, smie-indent--hanging-p, smie-indent--bolp)
	(smie-indent--offset, smie-indent--offset-rule, smie-indent--column):
	Rename internal functions to use "--".  Update callers.

	* frame.el (make-frame-names-alist): Don't list frames on other displays.

	* fringe.el (fringe-styles): New var.
	(fringe-mode, fringe-query-style): Use it.

2010-09-18  Michael R. Mauger  <mmaug@yahoo.com>

	* progmodes/sql.el: Version 2.8
	(sql-login-params): Update widget structure; changes still needed.
	(sql-product-alist): Add :list-all and :list-table features for
	SQLite, Postgres and MySQL products.
	(sql-redirect): Handle default value.
	(sql-execute, sql-execute-feature): New functions.
	(sql-read-table-name): New function.
	(sql-list-all, sql-list-table): New functions.  User API.
	(sql-mode-map, sql-interactive-mode-map): Add key definitions
	for above functions.
	(sql-mode-menu, sql-interactive-mode-menu): Add menu definitions
	for above functions.
	(sql-postgres-login-params): Add user and database defaults.
	(sql-buffer-live-p): Bug fix.
	(sql-product-history): New variable.
	(sql-read-product): New function. Use it.
	(sql-set-product, sql-product-interactive): Use it.
	(sql-connection-history): New variable.
	(sql-read-connection): New function.  Use it.
	(sql-connect): New function.
	(sql-for-each-login): Redesign function interface.
	(sql-make-alternate-buffer-name, sql-save-connection): Use it.
	(sql-get-login-ext, sql-get-login): Use it.  Handle default values.
	(sql-comint): Check for program.  Existing live buffer.
	(sql-comint-postgres): Add port parameter.

2010-09-19  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/warnings.el: Fix commenting convention.
	(display-warning): Use special mode and make the buffer read-only.

2010-09-18  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-prog.el (calc-read-parse-table-part): Don't "fix" the
	empty string when it follows a repeated or optional pattern.

2010-09-18  Stefan Monnier  <monnier@iro.umontreal.ca>

	* indent.el (indent-according-to-mode): Apply syntax-propertize.
	(indent-region): Use indent-according-to-mode.

2010-09-18  Eli Zaretskii  <eliz@gnu.org>

	* fringe.el (fringe-mode): Doc fix.

2010-09-14  Kan-Ru Chen  <kanru@kanru.info>  (tiny change)

	* textmodes/nroff-mode.el (nroff-view): Kill old buffer before
	refreshing the preview buffer.

2010-09-18  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/tex-mode.el (tex-syntax-propertize-rules)
	(latex-syntax-propertize-rules): New consts; replace
	tex-font-lock-syntactic-keywords.
	(tex-env-mark, latex-env-before-change): New functions.
	(latex-electric-env-pair-mode): New minor mode.
	(tex-font-lock-verb): Change arguments; do move point.
	(tex-font-lock-syntactic-face-function): Adjust to new verbatim
	representation as a form of comment.
	(tex-font-lock-keywords-1): Remove workaround, now unneeded.
	(doctex-syntax-propertize-rules): New const; replaces
	doctex-font-lock-syntactic-keywords.
	(tex-common-initialization, doctex-mode): Use syntax-propertize-rules.

	* progmodes/fortran.el (fortran--font-lock-syntactic-keywords): Remove.
	(fortran-make-syntax-propertize-function): New function; replaces
	fortran-font-lock-syntactic-keywords.
	(fortran-mode): Use it.
	(fortran-line-length): Use it.  Improve interactive spec.

	* emacs-lisp/syntax.el (syntax-propertize-precompile-rules): New macro.
	(syntax-propertize-rules): Add var-ref case.  Fix offset computation
	when adding surrounding \(..\).

	* progmodes/js.el (js-mode): Fix last change (bug#7054).

2010-09-17  Stefan Monnier  <monnier@iro.umontreal.ca>

	* obsolete/old-whitespace.el (whitespace-rescan-files-in-buffers):
	Use with-current-buffer.

	* isearch.el (isearch-face): Rename from `isearch'.
	(isearch-highlight): Use new name.

2010-09-17  Eli Zaretskii  <eliz@gnu.org>

	* fringe.el (fringe-mode, fringe-query-style): Use 4 pixels, not
	5, for `half' width fringes.  (Bug#6933)

2010-09-17  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/bytecomp.el (byte-compile-file-form-defvar)
	(byte-compile-defvar): "foo/bar" does not lack a prefix.

	* subr.el (y-or-n-p): Add the "(y or n)" that was lost somehow.

2010-09-17  Stephen Berman  <stephen.berman@gmx.net>

	* dframe.el (dframe-reposition-frame-emacs): Use tool-bar-pixel-width
	in calculating new frame position.  Add more space between new and
	parent on the left (Bug#7048).

2010-09-17  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-compat.el (tramp-compat-with-temp-message): Make it a
	defmacro.

2010-09-16  Chong Yidong  <cyd@stupidchicken.com>

	* mail/sendmail.el: Add "*unsent mail*" to same-window-buffer-names.

	* term/x-win.el (x-cut-buffer-or-selection-value): Define as
	obsolete alias for x-selection-value.

	* ido.el (ido-make-buffer-list): Fix error in 2010-08-22 merge.

2010-09-16  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-cmds.el (tramp-cleanup-connection): Set tramp-autoload
	cookie.

2010-09-15  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-compat.el (tramp-compat-with-temp-message)
	(tramp-compat-font-lock-add-keywords, tramp-compat-process-get)
	(tramp-compat-process-put): New defuns.

	* net/tramp.el (top):
	* net/tramp-gvfs.el (top):
	* net/tramp-cache.el (top): Use `tramp-compat-font-lock-add-keywords'.

	* net/tramp.el (tramp-progress-reporter-update):
	Use `tramp-compat-funcall'.

	* net/tramp.el (tramp-process-actions):
	* net/tramp-gvfs.el (tramp-handle-vc-registered):
	* net/tramp-sh.el (tramp-gvfs-handler-askquestion)
	(tramp-get-remote-stat, tramp-get-remote-readlink):
	Use `tramp-compat-with-temp-message'.

	* net/tramp-sh.el (top): Require 'cl.
	(tramp-handle-start-file-process): Use `tramp-compat-process-get'.
	(tramp-open-connection-setup-interactive-shell):
	Use `tramp-compat-process-put'.

2010-09-15  Alan Mackenzie  <acm@muc.de>

	* progmodes/cc-engine.el (c-forward-<>-arglist-recur): Correct the
	indentation.
	(c-forward-<>-arglist-recur): Fix an infinite recursion.

2010-09-15  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/bytecomp.el (byte-compile-warning-types): New type
	`lexical' for warnings related to lexical scoping.
	(byte-compile-file-form-defvar, byte-compile-defvar): Warn about
	global vars which don't have a prefix and could hence affect lexical
	scoping in unrelated files.

2010-09-14  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* net/imap.el: Revert back to version
	cb950ed8ff3e0f40dac437a51b269166f9ffb60d, since some of the changes
	seem problematic.

2010-09-14  Juanma Barranquero  <lekktu@gmail.com>

	* obsolete/old-whitespace.el (whitespace-unload-function):
	Explicitly pass `obarray' to `unintern' to avoid a warning.

2010-09-14  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/byte-run.el (set-advertised-calling-convention):
	Add `when' argument.  Update callers.

	* subr.el (unintern): Declare the obarray arg mandatory.

2010-09-14  Glenn Morris  <rgm@gnu.org>

	* calendar/diary-lib.el (diary-list-entries-hook, diary-sort-entries):
	Doc fixes.

	* calendar/diary-lib.el (diary-included-files): New variable.
	(diary-list-entries): Maybe initialize diary-included-files.
	(diary-include-other-diary-files): Append to diary-included-files.
	* calendar/appt.el (appt-update-list): Also check the members of
	diary-included-files.  (Bug#6999)
	(appt-check): Doc fix.

2010-09-14  David Reitter  <david.reitter@gmail.com>

	* simple.el (line-move-visual): Do not truncate goal column to
	integer size.  (Bug#7020)

2010-09-14  Stefan Monnier  <monnier@iro.umontreal.ca>

	* repeat.el (repeat): Allow repeating when the last event is a click.
	Suggested by Drew Adams (bug#6256).

2010-09-14  Sascha Wilde  <wilde@sha-bang.de>

	* vc/vc-hg.el (vc-hg-state,vc-hg-working-revision):
	Replace setting HGRCPATH to "" by some less invasive --config options.

2010-09-14  Stefan Monnier  <monnier@iro.umontreal.ca>

	* font-lock.el (font-lock-beginning-of-syntax-function):
	Mark as obsolete.

2010-09-14  Glenn Morris  <rgm@gnu.org>

	* menu-bar.el (menu-bar-options-save): Fix handling of menu-bar
	and tool-bar modes.  (Bug#6211)
	(menu-bar-mode): Move setting of standard-value after the
	minor-mode definition, otherwise it seems to have no effect.

2010-09-14  Masatake YAMATO  <yamato@redhat.com>

	* progmodes/antlr-mode.el (antlr-font-lock-additional-keywords):
	Fix typo.  (Bug#6976)

2010-09-14  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* whitespace.el: Allow cleaning up blanks without blank
	visualization (Bug#6651).  Adjust help window for
	whitespace-toggle-options (Bug#6479).  Allow to use fill-column
	instead of whitespace-line-column (from EmacsWiki).  New version 13.1.
	(whitespace-style): Add new value 'face.  Adjust docstring.
	(whitespace-space, whitespace-hspace, whitespace-tab):
	Adjust foreground property face.
	(whitespace-line-column): Adjust docstring and type declaration.
	(whitespace-style-value-list, whitespace-toggle-option-alist)
	(whitespace-help-text): Adjust const initialization.
	(whitespace-toggle-options, global-whitespace-toggle-options):
	Adjust docstring.
	(whitespace-display-window, whitespace-interactive-char)
	(whitespace-style-face-p, whitespace-color-on): Adjust code.
	(whitespace-help-scroll): New fun.

2010-09-14  Katsumi Yamaoka  <yamaoka@jpl.org>

	* calendar/time-date.el (format-seconds): Comment fix.

2010-09-13  Michael R. Mauger  <mmaug@yahoo.com>

	* progmodes/sql.el: Version 2.7.
	(sql-buffer-live-p): Improve detection.
	(sql-find-sqli-buffer, sql-set-sqli-buffer-generally)
	(sql-set-sqli-buffer): Use it.
	(sql-product-interactive): Run `sql-set-sqli-hook'.
	(sql-rename-buffer): Code cleanup.
	(sql-redirect, sql-redirect-value): New functions.  More to come.

2010-09-13  Juanma Barranquero  <lekktu@gmail.com>

	Port tramp-related Makefile changes of 2010-09-08T14:42:54Z!michael.albinus@gmx.de, 2010-09-13T15:17:01Z!michael.albinus@gmx.de to Windows.
	* makefile.w32-in (LOADDEFS): Add $(lisp)/net/tramp-loaddefs.el.
	(TRAMP_SRC): New macro.
	($(lisp)/net/tramp-loaddefs.el): New target.

2010-09-13  Michael Albinus  <michael.albinus@gmx.de>

	Major code cleanup.  Split tramp.el into tramp.el and tramp-sh.el.

	* Makefile.in (TRAMP_SRC): Remove tramp-fish.el.  Add tramp-sh.el.

	* net/tramp.el (top): Don't show loading message.  Require just
	'tramp-compat, everything else is required there.
	Use `ignore-errors' where appropriate.
	(tramp-inline-compress-start-size, tramp-copy-size-limit)
	(tramp-terminal-type, tramp-end-of-output)
	(tramp-initial-end-of-output, tramp-completion-function-alist-rsh)
	(tramp-completion-function-alist-ssh)
	(tramp-completion-function-alist-telnet)
	(tramp-completion-function-alist-su)
	(tramp-completion-function-alist-putty, tramp-remote-path)
	(tramp-remote-process-environment, tramp-sh-extra-args)
	(tramp-actions-before-shell, tramp-uudecode)
	(tramp-perl-file-truename, tramp-perl-file-name-all-completions)
	(tramp-perl-file-attributes)
	(tramp-perl-directory-files-and-attributes)
	(tramp-perl-encode-with-module, tramp-perl-decode-with-module)
	(tramp-perl-encode, tramp-perl-decode)
	(tramp-vc-registered-read-file-names, tramp-file-mode-type-map)
	(tramp-file-name-handler-alist, tramp-make-tramp-temp-file)
	(tramp-handle-make-symbolic-link, tramp-handle-load)
	(tramp-handle-file-name-as-directory)
	(tramp-handle-file-name-directory)
	(tramp-handle-file-name-nondirectory, tramp-handle-file-truename)
	(tramp-handle-file-exists-p, tramp-handle-file-attributes)
	(tramp-do-file-attributes-with-ls)
	(tramp-do-file-attributes-with-perl)
	(tramp-do-file-attributes-with-stat)
	(tramp-handle-set-visited-file-modtime)
	(tramp-handle-verify-visited-file-modtime)
	(tramp-handle-set-file-modes, tramp-handle-set-file-times)
	(tramp-set-file-uid-gid, tramp-remote-selinux-p)
	(tramp-handle-file-selinux-context)
	(tramp-handle-set-file-selinux-context)
	(tramp-handle-file-executable-p, tramp-handle-file-readable-p)
	(tramp-handle-file-newer-than-file-p, tramp-handle-file-modes)
	(tramp-handle-file-directory-p, tramp-handle-file-regular-p)
	(tramp-handle-file-symlink-p, tramp-handle-file-writable-p)
	(tramp-handle-file-ownership-preserved-p)
	(tramp-handle-directory-file-name, tramp-handle-directory-files)
	(tramp-handle-directory-files-and-attributes)
	(tramp-do-directory-files-and-attributes-with-perl)
	(tramp-do-directory-files-and-attributes-with-stat)
	(tramp-handle-file-name-all-completions)
	(tramp-handle-file-name-completion, tramp-handle-add-name-to-file)
	(tramp-handle-copy-file, tramp-handle-copy-directory)
	(tramp-handle-rename-file, tramp-do-copy-or-rename-file)
	(tramp-do-copy-or-rename-file-via-buffer)
	(tramp-do-copy-or-rename-file-directly)
	(tramp-do-copy-or-rename-file-out-of-band)
	(tramp-handle-make-directory, tramp-handle-delete-directory)
	(tramp-handle-delete-file)
	(tramp-handle-dired-recursive-delete-directory)
	(tramp-handle-dired-compress-file, tramp-handle-dired-uncache)
	(tramp-handle-insert-directory)
	(tramp-handle-unhandled-file-name-directory)
	(tramp-handle-expand-file-name)
	(tramp-handle-substitute-in-file-name)
	(tramp-handle-executable-find, tramp-process-sentinel)
	(tramp-handle-start-file-process, tramp-handle-process-file)
	(tramp-handle-call-process-region, tramp-handle-shell-command)
	(tramp-handle-file-local-copy, tramp-handle-file-remote-p)
	(tramp-handle-insert-file-contents)
	(tramp-handle-insert-file-contents-literally)
	(tramp-handle-find-backup-file-name)
	(tramp-handle-make-auto-save-file-name, tramp-handle-write-region)
	(tramp-vc-registered-file-names, tramp-handle-vc-registered)
	(tramp-sh-file-name-handler, tramp-vc-file-name-handler)
	(tramp-maybe-send-script, tramp-set-auto-save, tramp-run-test)
	(tramp-run-test2, tramp-find-executable, tramp-set-remote-path)
	(tramp-find-file-exists-command, tramp-open-shell)
	(tramp-find-shell, tramp-barf-if-no-shell-prompt)
	(tramp-open-connection-setup-interactive-shell)
	(tramp-local-coding-commands, tramp-remote-coding-commands)
	(tramp-find-inline-encoding, tramp-call-local-coding-command)
	(tramp-inline-compress-commands, tramp-find-inline-compress)
	(tramp-compute-multi-hops, tramp-maybe-open-connection)
	(tramp-send-command, tramp-wait-for-output)
	(tramp-send-command-and-check, tramp-barf-unless-okay)
	(tramp-send-command-and-read, tramp-mode-string-to-int)
	(tramp-convert-file-attributes, tramp-check-cached-permissions)
	(tramp-file-mode-from-int, tramp-file-mode-permissions)
	(tramp-shell-case-fold, tramp-make-copy-program-file-name)
	(tramp-method-out-of-band-p, tramp-local-host-p)
	(tramp-get-remote-path, tramp-get-remote-tmpdir)
	(tramp-get-ls-command, tramp-get-ls-command-with-dired)
	(tramp-get-test-command, tramp-get-test-nt-command)
	(tramp-get-file-exists-command, tramp-get-remote-ln)
	(tramp-get-remote-perl, tramp-get-remote-stat)
	(tramp-get-remote-readlink, tramp-get-remote-trash)
	(tramp-get-remote-id, tramp-get-remote-uid, tramp-get-remote-gid)
	(tramp-get-local-uid, tramp-get-local-gid)
	(tramp-get-inline-compress, tramp-get-inline-coding): Move to
	tramp-sh.el.
	(tramp-methods, tramp-default-method-alist)
	(tramp-default-user-alist, tramp-foreign-file-name-handler-alist):
	Move initialization to tramp-sh.el.
	(tramp-temp-name-prefix): Make it a defconst.
	(tramp-dissect-file-name): Don't check anymore for multi-hop
	methods.
	(tramp-debug-outline-regexp): Add a docstring.
	(tramp-debug-outline-level): Rename from `tramp-outline-level'.
	(tramp-get-debug-buffer): Use it.

	* net/tramp-cache.el (top): Set tramp-autoload cookie for
	initialization forms.
	(tramp-set-connection-property): Don't protect `tramp-message'
	call, it isn't necessary any longer.
	(tramp-dump-connection-properties): Use `ignore-errors'.

	* net/tramp-compat.el (top): Require 'advice, 'format-spec,
	'password-cache and 'auth-source.

	* net/tramp-gvfs.el (top):
	* net/tramp-smb.el (top): Require 'tramp-sh.

	* net/tramp-gw.el (tramp-gw-open-network-stream): Use `ignore-errors'.

	* net/tramp-sh.el: New file, derived from tramp.el.
	(top): Initialize `tramp-methods', `tramp-default-method-alist',
	`tramp-default-user-alist', `tramp-foreign-file-name-handler-alist'.
	Remove "scp1_old", "scp2_old", "ssh1_old", "ssh2_old".
	Use `ignore-errors' where appropriate.
	(tramp-sh-file-name-handler-alist): Rename from
	`tramp-file-name-handler-alist'.
	(tramp-send-command-and-check): Return t or nil.  Remove all
	`zerop' checks, where called.
	(tramp-handle-set-file-modes)
	(tramp-do-copy-or-rename-file-directly)
	(tramp-handle-delete-directory, tramp-handle-delete-file)
	(tramp-maybe-send-script): Use `tramp-barf-unless-okay'.
	(tramp-sh-file-name-handler, tramp-send-command-and-check)
	(tramp-get-remote-ln): Set tramp-autoload cookie.

	* net/tramp-fish.el: Remove file.

2010-09-13  Daiki Ueno  <ueno@unixuser.org>

	* epa-file.el (epa-file-insert-file-contents): If visiting, bind
	buffer-file-name to avoid file-locking.  (Bug#7026)

2010-09-13  Julien Danjou  <julien@danjou.info>

	* notifications.el (notifications-notify): Add support for
	image-path and sound-name.
	(notifications-specification-version): Add this variable.

2010-09-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* subr.el (y-or-n-p): New function, moved from src/fns.c; use read-key.

2010-09-12  Leo  <sdl.web@gmail.com>

	* net/rcirc.el (rcirc-server-commands, rcirc-client-commands)
	(rcirc-completion-start): New variables.
	(rcirc-nick-completions): Rename to rcirc-completions.
	(rcirc-nick-completion-start-offset): Delete.
	(rcirc-completion-at-point): New function for constructing
	completion data for both nicks and irc commands.  Add to
	completion-at-point-functions in rcirc mode.
	(rcirc-complete): Rename from rcirc-nick-complete; use
	rcirc-completion-at-point.
	(defun-rcirc-command): Update rcirc-client-commands.

2010-09-11  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/bytecomp.el (byte-compile-file): Create .elc files
	atomically, to avoid parallel build errors.  (Bug#4196)

2010-09-11  Michael R. Mauger  <mmaug@yahoo.com>

	* progmodes/sql.el: Version 2.6
	(sql-dialect): Synonym for "sql-product".
	(sql-find-sqli-buffer, sql-set-sqli-buffer-generally)
	(sql-set-sqli-buffer, sql-show-sqli-buffer, sql-interactive-mode):
	Set "sql-buffer" to buffer name not buffer object so multiple sql
	interactive buffers work properly.  Reverts misguided changes in
	earlier work.
	(sql-comint): Make sure different buffer name is used if "*SQL*"
	buffer is for a different product.
	(sql-make-alternate-buffer-name): Fix bug with "sql-database"
	login param.
	(sql-oracle, sql-sybase, sql-informix, sql-sqlite, sql-mysql)
	(sql-solid, sql-ingres, sql-ms, sql-postgres, sql-interbase)
	(sql-db2, sql-linter, sql-product-interactive, sql-rename-buffer):
	Accept new buffer name or prompt for one.
	(sql-port): Default to zero.
	(sql-comint-mysql): Handle "sql-port" as a numeric.
	(sql-port-history): Delete unused variable.
	(sql-get-login): Default "sql-port" to a number.
	(sql-product-alist): Correct Postgres prompt and terminator regexp.
	(sql-sqlite-program): Dynamically detect presence of "sqlite" or
	"sqlite3" executables.
	(sql-sqlite-login-params): Add "*.sqlite[23]?" database name pattern.
	(sql-buffer-live-p): New function.
	(sql-mode-menu, sql-send-string): Use it.
	(sql-mode-oracle-font-lock-keywords): Improve SQL*Plus REMARK
	syntax pattern.
	(sql-mode-postgres-font-lock-keywords): Support Postgres V9.
	(sql-mode-sqlite-font-lock-keywords): Hilight sqlite commands.

2010-09-10  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* net/netrc.el (netrc-credentials): New convenience function.

2010-09-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/texinfo.el (texinfo-syntax-propertize-function): New fun
	to replace texinfo-font-lock-syntactic-keywords.
	(texinfo-mode): Use it.

	* textmodes/tex-mode.el (tex-common-initialization, doctex-mode):
	Use syntax-propertize-function.

	* textmodes/sgml-mode.el (sgml-syntax-propertize-function): New var to
	replace sgml-font-lock-syntactic-keywords.
	(sgml-mode): Use it.

	* textmodes/reftex.el (font-lock-syntactic-keywords): Don't declare
	since we don't use it.

	* textmodes/bibtex.el (bibtex-mode): Use syntax-propertize-function.

	* progmodes/vhdl-mode.el (vhdl-mode): Use syntax-propertize-function
	if available.
	(vhdl-fontify-buffer): Adjust.

	* progmodes/tcl.el (tcl-syntax-propertize-function): New var to
	replace tcl-font-lock-syntactic-keywords.
	(tcl-mode): Use it.

	* progmodes/simula.el (simula-syntax-propertize-function): New var to
	replace simula-font-lock-syntactic-keywords.
	(simula-mode): Use it.

	* progmodes/sh-script.el (sh-st-symbol): Remove.
	(sh-font-lock-close-heredoc, sh-font-lock-open-heredoc): Add eol arg.
	(sh-font-lock-flush-syntax-ppss-cache, sh-font-lock-here-doc): Remove.
	(sh-font-lock-quoted-subshell): Assume we've already matched $(.
	(sh-font-lock-paren): Set syntax-multiline.
	(sh-font-lock-syntactic-keywords): Remove.
	(sh-syntax-propertize-function): New function to replace it.
	(sh-mode): Use it.

	* progmodes/ruby-mode.el (ruby-here-doc-beg-re):
	Define while compiling.
	(ruby-here-doc-end-re, ruby-here-doc-beg-match)
	(ruby-font-lock-syntactic-keywords, ruby-comment-beg-syntax)
	(syntax-ppss, ruby-in-ppss-context-p, ruby-in-here-doc-p)
	(ruby-here-doc-find-end, ruby-here-doc-beg-syntax)
	(ruby-here-doc-end-syntax): Only define when
	syntax-propertize is not available.
	(ruby-syntax-propertize-function, ruby-syntax-propertize-heredoc):
	New functions.
	(ruby-in-ppss-context-p): Update to new syntax of heredocs.
	(electric-indent-chars): Silence bytecompiler.
	(ruby-mode): Use prog-mode, syntax-propertize-function, and
	electric-indent-chars.

	* progmodes/python.el (python-syntax-propertize-function): New var to
	replace python-font-lock-syntactic-keywords.
	(python-mode): Use it.
	(python-quote-syntax): Simplify and adjust to new use.

	* progmodes/perl-mode.el (perl-syntax-propertize-function): New fun to
	replace perl-font-lock-syntactic-keywords.
	(perl-syntax-propertize-special-constructs): New fun to replace
	perl-font-lock-special-syntactic-constructs.
	(perl-font-lock-syntactic-face-function): New fun.
	(perl-mode): Use it.

	* progmodes/octave-mod.el (octave-syntax-propertize-sqs): New function
	to replace octave-font-lock-close-quotes.
	(octave-syntax-propertize-function): New function to replace
	octave-font-lock-syntactic-keywords.
	(octave-mode): Use it.

	* progmodes/mixal-mode.el (mixal-syntax-propertize-function): New var;
	replaces mixal-font-lock-syntactic-keywords.
	(mixal-mode): Use it.

	* progmodes/make-mode.el (makefile-syntax-propertize-function):
	New var; replaces makefile-font-lock-syntactic-keywords.
	(makefile-mode): Use it.
	(makefile-imake-mode): Adjust.

	* progmodes/js.el (js--regexp-literal): Define while compiling.
	(js-syntax-propertize-function): New var; replaces
	js-font-lock-syntactic-keywords.
	(js-mode): Use it.

	* progmodes/gud.el (gdb-script-syntax-propertize-function): New var;
	replaces gdb-script-font-lock-syntactic-keywords.
	(gdb-script-mode): Use it.

	* progmodes/fortran.el (fortran-mode): Use syntax-propertize-function.
	(fortran--font-lock-syntactic-keywords): New var.
	(fortran-line-length): Update syntax-propertize-function and
	fortran--font-lock-syntactic-keywords.

	* progmodes/cperl-mode.el (cperl-mode): Use syntax-propertize-function.

	* progmodes/cfengine.el (cfengine-mode):
	Use syntax-propertize-function.
	(cfengine-font-lock-syntactic-keywords): Remove.

	* progmodes/autoconf.el (autoconf-mode):
	Use syntax-propertize-function.
	(autoconf-font-lock-syntactic-keywords): Remove.

	* progmodes/ada-mode.el (ada-set-syntax-table-properties)
	(ada-after-change-function, ada-initialize-syntax-table-properties)
	(ada-handle-syntax-table-properties): Only define when
	syntax-propertize is not available.
	(ada-mode): Use syntax-propertize-function.

	* font-lock.el (font-lock-syntactic-keywords): Make obsolete.
	(font-lock-fontify-syntactic-keywords-region): Move handling of
	font-lock-syntactically-fontified to...
	(font-lock-default-fontify-region): ...here.
	Let syntax-propertize-function take precedence.
	(font-lock-fontify-syntactically-region): Cal syntax-propertize.

	* emacs-lisp/syntax.el (syntax-propertize-function)
	(syntax-propertize-chunk-size, syntax-propertize--done)
	(syntax-propertize-extend-region-functions): New vars.
	(syntax-propertize-wholelines, syntax-propertize-multiline)
	(syntax-propertize--shift-groups, syntax-propertize-via-font-lock)
	(syntax-propertize): New functions.
	(syntax-propertize-rules): New macro.
	(syntax-ppss-flush-cache): Set syntax-propertize--done.
	(syntax-ppss): Call syntax-propertize.

	* emacs-lisp/regexp-opt.el (regexp-opt-depth): Skip named groups.

2010-09-10  Agustín Martín  <agustin.martin@hispalinux.es>

	* textmodes/ispell.el (ispell-init-process): Improve comments.
	XEmacs compatibility changes regarding (add-hook) 'local option
	and (set-process-query-on-exit-flag).

2010-09-09  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-cache.el (tramp-parse-connection-properties):
	Set tramp-autoload cookie.

2010-09-09  Glenn Morris  <rgm@gnu.org>

	* image.el (imagemagick-types-inhibit): Add :type, :version, :group.
	(imagemagick-register-types): Doc fix.

2010-09-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/octave-mod.el (electric-indent-chars): Silence bytecomp.

	* progmodes/js.el (require): Require is already "eval-and-compile".
	(js--re-search-forward): Avoid `eval'.  Preserve the error data.
	(js--re-search-backward): Use js--re-search-forward.

	* progmodes/fortran.el (fortran-line-length): Don't recompute
	syntactic keywords redundantly a second time.

	* progmodes/ada-mode.el: Replace "(set '" with setq.
	(ada-mode): Simplify.
	(ada-create-case-exception, ada-adjust-case-interactive)
	(ada-adjust-case-region, ada-format-paramlist, ada-indent-current)
	(ada-search-ignore-string-comment, ada-move-to-start)
	(ada-move-to-end): Use with-syntax-table.

	* font-lock.el (save-buffer-state): Remove `varlist' arg.
	(font-lock-unfontify-region, font-lock-default-fontify-region):
	Update usage correspondingly.
	(font-lock-fontify-syntactic-keywords-region):
	Set parse-sexp-lookup-properties buffer-locally here.
	(font-lock-fontify-syntactically-region): Remove unused `ppss' arg.

	* simple.el (blink-matching-open): Don't burp if we can't find a match.

2010-09-08  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/bytecomp.el (byte-compile-report-ops):
	Error if not compiled with -DBYTE_CODE_METER.

	* emacs-lisp/bytecomp.el (byte-recompile-directory):
	Ignore dir-locals-file.

2010-09-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/compile.el (compilation-error-regexp-alist-alist):
	Not a const.
	(compilation-error-regexp-alist-alist): Rule out ": " in file names
	for the `gnu' messages.
	(compilation-set-skip-threshold): New command.
	(compilation-start): Use \' rather than $.
	(compilation-forget-errors): Use clrhash.

2010-09-08  Agustín Martín  <agustin.martin@hispalinux.es>

	* textmodes/ispell.el (ispell-valid-dictionary-list):
	Simplify logic.

2010-09-08  Michael Albinus  <michael.albinus@gmx.de>

	Migrate to Tramp 2.2.  Rearrange load dependencies.
	(Bug#1529, Bug#5448, Bug#5705)

	* Makefile.in (TRAMP_DIR, TRAMP_SRC): New variables.
	($(TRAMP_DIR)/tramp-loaddefs.el): New target.
	(LOADDEFS): Add $(lisp)/net/tramp-loaddefs.el.

	* net/tramp.el (top): Remove all other tramp-* loads except
	tramp-compat.el.  Remove all changes to tramp-unload-hook for
	other tramp-* packages.  Rearrange defun order.  Change calls of
	`tramp-compat-call-process', `tramp-compat-decimal-to-octal',
	`tramp-compat-octal-to-decimal' to new function names.
	(tramp-terminal-type, tramp-initial-end-of-output)
	(tramp-methods, tramp-foreign-file-name-handler-alist)
	(tramp-tramp-file-p, tramp-completion-mode-p)
	(tramp-send-command-and-check, tramp-get-remote-path)
	(tramp-get-remote-tmpdir, tramp-get-remote-ln)
	(tramp-shell-quote-argument): Set tramp-autoload cookie.
	(with-file-property, with-connection-property): Move to
	tramp-cache.el.
	(tramp-local-call-process, tramp-decimal-to-octal)
	(tramp-octal-to-decimal): Move to tramp-compat.el.
	(tramp-handle-shell-command): Do not require 'shell.
	(tramp-compute-multi-hops): No special handling for tramp-gw-*
	symbols.
	(tramp-unload-tramp): Do not call `tramp-unload-file-name-handlers'.

	* net/tramp-cache.el (top): Require 'tramp.  Add to
	`tramp-unload-hook'.
	(tramp-cache-data, tramp-get-file-property)
	(tramp-set-file-property, tramp-flush-file-property)
	(tramp-flush-directory-property, tramp-get-connection-property)
	(tramp-set-connection-property, tramp-flush-connection-property)
	(tramp-cache-print, tramp-list-connections): Set tramp-autoload
	cookie.
	(with-file-property, with-connection-property): New defuns, moved
	from tramp.el.
	(tramp-flush-file-function): Use `with-parsed-tramp-file-name'
	macro.

	* net/tramp-cmds.el (top): Add to `tramp-unload-hook'.
	(tramp-version): Set tramp-autoload cookie.

	* net/tramp-compat.el (top): Require 'tramp-loaddefs.  Remove all
	changes to tramp-unload-hook for other tramp-* packages.  Add to
	`tramp-unload-hook'.
	(tramp-compat-decimal-to-octal, tramp-compat-octal-to-decimal)
	(tramp-compat-call-process): New defuns, moved from tramp.el.

	* net/tramp-fish.el (top) Require just 'tramp.  Add objects to
	`tramp-methods' and `tramp-foreign-file-name-handler-alist'.  Add
	to `tramp-unload-hook'.  Change call of
	`tramp-compat-decimal-to-octal' to new function name.
	(tramp-fish-method): Make it a defconst.
	(tramp-fish-file-name-p): Make it a defsubst.
	(tramp-fish-method, tramp-fish-file-name-handler)
	(tramp-fish-file-name-p): Set tramp-autoload cookie.

	* net/tramp-ftp.el (top) Add objects to `tramp-methods' and
	`tramp-foreign-file-name-handler-alist'.  Add to
	`tramp-unload-hook'.
	(tramp-ftp-method): Make it a defconst.
	(tramp-ftp-file-name-p): Make it a defsubst.
	(tramp-ftp-method, tramp-ftp-file-name-handler)
	(tramp-ftp-file-name-p): Set tramp-autoload cookie.

	* net/tramp-gvfs.el (top) Add objects to `tramp-methods' and
	`tramp-foreign-file-name-handler-alist'.  Add to
	`tramp-unload-hook'.  Change checks, whether package can be
	loaded.
	(tramp-gvfs-file-name-p): Make it a defsubst.
	(tramp-gvfs-methods, tramp-gvfs-file-name-handler)
	(tramp-gvfs-file-name-p): Set tramp-autoload cookie.
	(tramp-gvfs-handle-file-directory-p): New defun.
	(tramp-gvfs-file-name-handler-alist): Use it.

	* net/tramp-gw.el (top) Add objects to `tramp-methods' and
	`tramp-foreign-file-name-handler-alist'.  Add to
	`tramp-unload-hook'.
	(tramp-gw-tunnel-method, tramp-gw-default-tunnel-port)
	(tramp-gw-socks-method, tramp-gw-default-socks-port): Make it a
	defconst.
	(tramp-gw-tunnel-method, tramp-gw-socks-method)
	(tramp-gw-open-connection): Set tramp-autoload cookie.

	* net/tramp-imap.el (top) Require just 'tramp.  Add objects to
	`tramp-methods' and `tramp-foreign-file-name-handler-alist'.  Add
	to `tramp-unload-hook'.  Change checks, whether package can be
	loaded.
	(tramp-imap-file-name-p): Make it a defsubst.
	(tramp-imap-method, tramp-imaps-method)
	(tramp-imap-file-name-handler)
	(tramp-imap-file-name-p): Set tramp-autoload cookie.

	* net/tramp-smb.el (top) Require just 'tramp.  Add objects to
	`tramp-methods' and `tramp-foreign-file-name-handler-alist'.  Add
	to `tramp-unload-hook'.  Change checks, whether package can be
	loaded.  Change call of `tramp-compat-decimal-to-octal' to new
	function name.
	(tramp-smb-tunnel-method): Make it a defconst.
	(tramp-smb-file-name-p): Make it a defsubst.
	(tramp-smb-method, tramp-smb-file-name-handler)
	(tramp-smb-file-name-p): Set tramp-autoload cookie.

	* net/tramp-uu.el (top) Add to `tramp-unload-hook'.
	(tramp-uuencode-region): Set tramp-autoload cookie.

	* net/trampver.el (top) Add to `tramp-unload-hook'.
	(tramp-version, tramp-bug-report-address): Set tramp-autoload
	cookie.  Update release number.

2010-09-07  Agustín Martín  <agustin.martin@hispalinux.es>

	* textmodes/ispell.el (ispell-start-process): Make sure original
	arg list is properly initialized (Bug#6993, Bug#6994).

2010-09-06  Alexander Klimov  <alserkli@inbox.ru>  (tiny change)

	* files.el (directory-abbrev-alist): Use \` as default regexp.

	* emacs-lisp/rx.el (rx-any): Don't explode ranges that end in special
	chars like - or ] (bug#6984).
	(rx-any-condense-range): Explode 2-char ranges.

2010-09-06  Glenn Morris  <rgm@gnu.org>

	* desktop.el (desktop-path): Bump :version after 2009-09-15 change.

2010-09-06  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/bibtex.el:
	* proced.el: Update to new email for Roland Winkler <winkler@gnu.org>.

2010-09-05  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* net/imap.el (imap-message-map): Remove optional buffer parameter,
	since no callers use it.
	(imap-message-get): Ditto.
	(imap-message-put): Ditto.
	(imap-mailbox-map): Ditto.
	(imap-mailbox-put): Ditto.
	(imap-mailbox-get): Ditto.
	(imap-mailbox-get): Revert last change for this function.

2010-09-05  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* net/imap.el (imap-fetch-safe): Remove function, and alter all
	callers to use `imap-fetch' instead.  According to the comments, this
	should be safe, since all other IMAP clients use the 1:* syntax.
	(imap-enable-exchange-bug-workaround): Remove.
	(imap-debug): Remove -- doesn't seem very useful.

2010-09-05  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* net/imap.el (imap-log): New convenience function used throughout
	instead of repeating the same code all over the place.

2010-09-05  David De La Harpe Golden  <david@harpegolden.net>

	* mouse.el (mouse-save-then-kill): Save region to kill-ring
	when mouse-drag-copy-region is non-nil (Bug#6956).

2010-09-05  Chong Yidong  <cyd@stupidchicken.com>

	* dired.el (dired-ls-sorting-switches, dired-sort-by-name-regexp):
	Improve regexps (Bug#6987).
	(dired-sort-toggle): Search more robustly for -t flag.

	* files.el (get-free-disk-space): Search more robustly for
	"available" column.  Suggested by Ehud Karni
	<ehud@unix.mvs.co.il>.

2010-09-05  Juanma Barranquero  <lekktu@gmail.com>

	* international/uni-bidi.el:
	* international/uni-category.el:
	* international/uni-combining.el:
	* international/uni-decimal.el:
	* international/uni-mirrored.el:
	* international/uni-name.el: Regenerate.

2010-09-04  Stefan Monnier  <monnier@iro.umontreal.ca>

	* electric.el (electric-indent-post-self-insert-function):
	Don't reindent with a sloppy indentation function.

	* emacs-lisp/syntax.el (syntax-ppss): More sanity check to catch
	border case in change-log-mode.

2010-09-04  Chong Yidong  <cyd@stupidchicken.com>

	* progmodes/compile.el (compilation-error-regexp-alist-alist):
	Remove ruby regexp; handle Ruby errors with gcc-include and gnu.
	Recognize leading tab in gcc-include regexp.  Ignore names with
	leading "from" or "in" in gnu regexp (Bug#6937).

2010-09-04  Stefan Monnier  <monnier@iro.umontreal.ca>

	Avoid global recursive calls to kill-buffer-hooks; fit into 80 cols.
	* textmodes/ispell.el (ispell-process-buffer-name): Remove.
	(ispell-start-process): Avoid setq and simplify logic.
	(ispell-init-process): Setup kill-buffer-hook locally when needed.
	(kill-buffer-hook): Don't use it globally with code that uses
	expand-file-name since that may call kill-buffer via
	code_conversion_restore.

2010-09-04  Noorul Islam K M  <noorul@noorul.com>  (tiny change)

	* emacs-lisp/package.el (package-directory-list): Only call
	file-name-nondirectory on a string.

2010-09-02  Chong Yidong  <cyd@stupidchicken.com>

	* emacs-lisp/package.el (package--download-one-archive):
	Ensure that archive-contents is valid before saving it.
	(package-activate-1, package-mark-obsolete, define-package)
	(package-compute-transaction, package-list-maybe-add): Use push.

2010-09-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	Use SMIE's blink-paren for octave-mode.
	* progmodes/octave-mod.el (octave-font-lock-close-quotes):
	Backslashes do not escape single-quotes, single-quotes do.
	(octave-block-else-regexp, octave-block-end-regexp)
	(octave-block-match-alist): Remove.
	(octave-smie-bnf-table): New var, with old content.
	(octave-smie-op-levels): Use it.
	(octave-smie-closer-alist): New var.
	(octave-mode): Use it.  Setup smie-blink-matching and electric-indent.
	(octave-blink-matching-block-open): Remove.
	(octave-reindent-then-newline-and-indent, octave-electric-semi)
	(octave-electric-space): Let self-insert-command run expand-abbrev and
	blink parens.

	* electric.el (electricity): New group.
	(electric-indent-chars): New var.
	(electric-indent-post-self-insert-function): New fun.
	(electric-indent-mode): New minor mode.
	(electric-pair-skip-self): New custom.
	(electric-pair-post-self-insert-function): New function.
	(electric-pair-mode): New minor mode.

	* calc/calc-aent.el (calcAlg-blink-matching-check): New fun, to replace
	calcAlg-blink-matching-open.
	(calc-alg-ent-map, calc-alg-ent-esc-map): Initialize in the declaration.
	(calc-do-alg-entry): Only touch the part of the keymap that varies.
	Use the new blink-matching-check-function.

	Provide blink-matching support to SMIE.
	* emacs-lisp/smie.el (smie-bnf-closer-alist): New function.
	(smie-blink-matching-triggers, smie-blink-matching-inners): New vars.
	(smie-blink-matching-check, smie-blink-matching-open): New functions.

	* simple.el (newline): Fix last change to properly remove itself from
	the hook.

2010-09-02  Stefan Monnier  <monnier@iro.umontreal.ca>

	* simple.el (newline): Eliminate optimization.
	Use post-self-insert-hook to set hard-newline and things before
	running post-self-insert-hook.
	(blink-matching-check-mismatch): New function.
	(blink-matching-check-function): New variable.
	(blink-matching-open): Use them.
	Skip back forward over prefix chars skipped by forward-sexp.
	Don't check if the parens are backslash escaped.
	(blink-paren-post-self-insert-function): Check backslash escaping here.

2010-09-02  Chong Yidong  <cyd@stupidchicken.com>

	* emacs-lisp/package.el (package-menu-mode-map):
	Change package-menu-revert bindings to revert-buffer.
	(package-menu-mode): Set revert-buffer-function.
	(package-menu-revert): Doc fix.

2010-09-02  Agustín Martín  <agustin.martin@hispalinux.es>

	* textmodes/ispell.el (ispell-init-process): Use "~/" as
	`default-directory' unless using Ispell per-directory personal
	dictionaries and not in a mini-buffer under XEmacs.
	(kill-buffer-hook): Do not kill ispell process on exit when
	`ispell-process-directory' is "~/".  (Bug#6143)

2010-09-02  Jan Djärv  <jan.h.d@swipnet.se>

	* simple.el (kill-new): Call interprogram-cut-function with only
	one argument.

	* term.el (term-mouse-paste): Don't call x-get-cutbuffer.
	Remove cut buffer from error message.

	* term/x-win.el (x-select-text):
	* term/pc-win.el (x-selection-value):
	* term/ns-win.el (x-selection-value):
	* eshell/em-term.el:
	* w32-fns.el (x-get-selection-value):
	* mouse-sel.el (mouse-sel-set-selection-function):
	* frame.el (display-selections-p): Remove cut-buffer in documentation.

	* term/x-win.el: Update documentation for x-last-selected-text-*.
	(x-last-selected-text-cut, x-last-selected-text-cut-encoded)
	(x-last-cut-buffer-coding, x-cut-buffer-max): Remove.
	(x-select-text): Remove argument PUSH, update documentation.  Remove
	cut-buffer code.
	(x-selection-value-internal): Was previously x-selection-value.
	(x-selection-value): Rename from x-cut-buffer-or-selection-value.
	Update documentation, remove cut-buffer code.  Call
	x-selection-value-internal.
	(x-clipboard-yank): Call x-selection-value-internal.
	(x-initialize-window-system): Remove setting of x-cut-buffer-max.

	* term/pc-win.el (x-last-selected-text):
	x-cut-buffer-or-selection-value renamed to x-selection-value
	(x-select-text): Remove argument PUSH, update documentation.

	* term/ns-win.el (x-setup-function-keys, ns-last-selected-text):
	x-cut-buffer-or-selection-value renamed to x-selection-value
	(x-selection-value): Renamed from x-cut-buffer-or-selection-value.
	(x-select-text): Remove argument PUSH, update documentation.

	* emacs-lisp/cl-macs.el (x-get-cutbuffer, x-get-cut-buffer): Remove.

	* w32-fns.el (x-last-selected-text):
	x-cut-buffer-or-selection-value renamed to x-selection-value.
	(x-cut-buffer-max): Remove.
	(x-select-text): Remove argument PUSH, update documentation.

	* simple.el (interprogram-cut-function): Remove mention of PUSH.

	* select.el (x-get-cut-buffer, x-set-cut-buffer): Remove.

	* mouse-sel.el (mouse-sel-get-selection-function):
	x-cut-buffer-or-selection-value renamed to x-selection-value.
	(x-select-text): Remove optional push.

2010-09-01  Stefan Monnier  <monnier@iro.umontreal.ca>

	* simple.el (blink-paren-function): Move from C to here.
	(blink-paren-post-self-insert-function): New function.
	(post-self-insert-hook): Use it.

	* emacs-lisp/pcase.el (pcase-split-memq):
	Fix overenthusiastic optimisation.
	(pcase-u1): Handle the case of a lambda pred.

2010-08-31  Kenichi Handa  <handa@m17n.org>

	* international/mule-cmds.el (standard-display-european-internal):
	Setup standard-display-table for 8-bit characters by storing 8-bit
	characters in the element vector.

	* disp-table.el (standard-display-8bit):
	Setup standard-display-table for 8-bit characters by storing 8-bit
	characters in the element vector.
	(standard-display-european): Likewise.

2010-08-31  Masatake YAMATO  <yamato@redhat.com>

	* textmodes/nroff-mode.el (nroff-view): New command.
	(nroff-mode-map): Bind it to C-c C-c.

2010-08-31  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/smie.el (smie-down-list): New command.

	Remove old indentation and navigation code on octave-mode.
	* progmodes/octave-mod.el (octave-mode-map): Remap down-list to
	smie-down-list rather than add a binding for octave-down-block.
	(octave-mark-block, octave-blink-matching-block-open):
	Rely on forward-sexp-function.
	(octave-fill-paragraph): Don't narrow, so you can use
	indent-according-to-mode.
	(octave-block-begin-regexp, octave-block-begin-or-end-regexp): Remove.
	(octave-in-block-p, octave-re-search-forward-kw)
	(octave-re-search-backward-kw, octave-indent-calculate)
	(octave-end-as-array-index-p, octave-block-end-offset)
	(octave-scan-blocks, octave-forward-block, octave-backward-block)
	(octave-down-block, octave-backward-up-block, octave-up-block)
	(octave-before-magic-comment-p, octave-indent-line): Remove.

2010-08-31  Chong Yidong  <cyd@stupidchicken.com>

	* emacs-lisp/package.el (package--read-archive-file): Just use
	`read', to avoid copying an additional string.
	(package-menu-mode): Set header-line-format here.
	(package-menu-refresh, package-menu-revert): Signal an error if
	not in the Package Menu.
	(package-menu-package-list): New var.
	(package--generate-package-list): Operate on the current buffer;
	don't assume that it is *Packages*, since the user may rename it.
	Allow persistent package listings and sort keys using
	package-menu-package-list and package-menu-package-sort-key.
	(package-menu--version-predicate): Fix version calculation.
	(package-menu-sort-by-column): Don't select the window.
	(package--list-packages): Create the *Packages* buffer.
	Set package-menu-package-list-key.
	(list-packages): Sorting by status is now the default.
	(package-buffer-info): Use match-string-no-properties.
	(define-package): Add a &rest argument for future proofing, but
	don't use it yet.
	(package-install-from-buffer, package-install-buffer-internal):
	Merge into a single function, package-install-from-buffer.
	(package-install-file): Change caller.

	* finder.el: Load finder-inf using `require'.
	(finder-list-matches): Sorting by status is now the default.
	(finder-compile-keywords): Simpify printing.

2010-08-30  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/octave-mod.el (octave-font-lock-keywords): Use regexp-opt.
	(octave-mode-map): Remove special bindings for forward/backward-block
	and octave-backward-up-block.  Use smie-close-block.
	(octave-continuation-marker-regexp): New var.
	(octave-continuation-regexp): Use it.
	(octave-operator-table, octave-smie-op-levels)
	(octave-operator-regexp, octave-smie-indent-rules): New vars.
	(octave-smie-backward-token, octave-smie-forward-token): New funs.
	(octave-mode): Use SMIE.
	(octave-close-block): Delete.

2010-08-30  Eli Zaretskii  <eliz@gnu.org>

	* menu-bar.el (menu-bar-edit-menu) <"Paste">: Check selection in
	CLIPBOARD, not in PRIMARY.  (Bug#6944)

2010-08-30  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/smie.el (smie-indent-offset-rule): Let :parent take
	a list of parents.
	(smie-indent-column): Allow indirection through variables.

	* composite.el (save-buffer-state): Delete, unused.
	* font-lock.el (save-buffer-state): Use with-silent-modifications.
	(font-lock-default-fontify-region): Use with-syntax-table.
	* jit-lock.el (with-buffer-unmodified): Remove.
	(with-buffer-prepared-for-jit-lock): Use with-silent-modifications.

	Use `declare' in defmacros.
	* window.el (save-selected-window):
	* subr.el (with-temp-file, with-temp-message, with-syntax-table):
	* progmodes/python.el (def-python-skeleton):
	* net/dbus.el (dbus-ignore-errors):
	* jka-cmpr-hook.el (with-auto-compression-mode):
	* international/mule.el (with-category-table):
	* emacs-lisp/timer.el (with-timeout):
	* emacs-lisp/lisp-mnt.el (lm-with-file):
	* emacs-lisp/eieio.el (with-slots):
	* emacs-lisp/easymenu.el (easy-menu-define):
	* emacs-lisp/debug.el (debugger-env-macro):
	* emacs-lisp/cl-compat.el (Multiple-value-bind, Multiple-value-setq)
	(Multiple-value-call, Multiple-value-prog1):
	* emacs-lisp/cl-seq.el (cl-parsing-keywords, cl-check-key)
	(cl-check-test-nokey, cl-check-test, cl-check-match): Move indent and
	edebug rule to definition.
	* emacs-lisp/lisp-mode.el (save-selected-window)
	(with-current-buffer, combine-after-change-calls)
	(with-output-to-string, with-temp-file, with-temp-buffer)
	(with-temp-message, with-syntax-table, read-if, eval-after-load)
	(dolist, dotimes, when, unless):
	* emacs-lisp/byte-run.el (inline): Remove indent rule, redundant.

2010-08-29  Chong Yidong  <cyd@stupidchicken.com>

	* finder.el: Require `package'.
	(finder-known-keywords): Tweak descriptions.  Retire `oop' keyword.
	(finder-package-info): Var deleted.
	(finder-keywords-hash, finder--builtins-alist): New vars.
	(finder-compile-keywords): Compute package--builtins and
	finder-keywords-hash instead of finder-keywords-hash, respecting
	the "Package" header.
	(finder-unknown-keywords, finder-list-matches):
	Use finder-keywords-hash and package--list-packages.
	(finder-mode): Don't set font-lock-defaults.
	(finder-exit): We don't use "*Finder-package*" and "*Finder
	Category*" buffers anymore.

	* emacs-lisp/package.el (package--builtins-base): Var deleted.
	(package--builtins): Set default value to nil.
	(package-initialize): Load precomputed value of package--builtins
	from finder-inf.el.
	(package-alist, package-compute-transaction)
	(package-download-transaction): Improve docstring.
	(package-read-all-archive-contents): Do not change
	package--builtins here.
	(list-packages): Make package-list-packages an alias for this.
	Sort by status by default.
	(package--list-packages): Add optional PACKAGES arg.
	(describe-package-1): Use font-lock-face property.  For built-in
	packages, insert file commentary.
	(package--generate-package-list): Rename from
	package-list-packages-internal; all callers changed.  Add optional
	PACKAGES arg.  Add alphabetical sort fallbacks.
	(package-menu--version-predicate, package-menu--status-predicate)
	(package-menu--description-predicate)
	(package-menu--name-predicate): New functions.

	* info.el (Info-finder-find-node): Search package-alist instead of
	finder-package-info.

2010-08-29  Chong Yidong  <cyd@stupidchicken.com>

	* subr.el (version-regexp-alist): Don't use "a" and "b" for
	"alpha" and "beta".
	(version-to-list): Handle versions like "10.3d".

2010-08-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/macroexp.el (macroexpand-all-1): Use pcase.
	(macroexp-accumulate): Use `declare'.

2010-08-27  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* whitespace.el (whitespace-style): Adjust type declaration.

2010-08-26  Magnus Henoch  <magnus.henoch@gmail.com>

	* net/tramp-gvfs.el (tramp-gvfs-handle-copy-file): Do not pass
	empty argument to gvfs-copy.

2010-08-26  Chong Yidong  <cyd@stupidchicken.com>

	* net/tramp-compat.el (tramp-compat-delete-file): Rewrite to
	handle new TRASH arg of `delete-file'.

2010-08-26  Christian Lynbech  <christian.lynbech@tieto.com>  (tiny change)

	* net/tramp.el (tramp-handle-insert-directory): Don't use
	`forward-word', its default syntax could be changed.

2010-08-26  Toru TSUNEYOSHI  <t_tuneyosi@hotmail.com>
            Michael Albinus  <michael.albinus@gmx.de>

	Implement compression for inline methods.

	* net/tramp.el (tramp-inline-compress-start-size): New defcustom.
	(tramp-copy-size-limit): Allow also nil.
	(tramp-inline-compress-commands): New defconst.
	(tramp-find-inline-compress, tramp-get-inline-compress)
	(tramp-get-inline-coding): New defuns.
	(tramp-get-remote-coding, tramp-get-local-coding): Remove,
	replaced by `tramp-get-inline-coding'.
	(tramp-handle-file-local-copy, tramp-handle-write-region)
	(tramp-method-out-of-band-p): Use `tramp-get-inline-coding'.

2010-08-26  Noah Lavine  <noah549@gmail.com>  (tiny change)

	Detect ssh 'ControlMaster' argument automatically in some cases.

	* net/tramp.el (tramp-detect-ssh-controlmaster): New defun.
	(tramp-default-method): Use it.

2010-08-26  Karel Klíč  <kklic@redhat.com>

	* net/tramp.el (tramp-file-name-for-operation):
	Add file-selinux-context.

2010-08-26  Łukasz Stelmach  <lukasz.stelmach@iem.pw.edu.pl>  (tiny change)

	* play/cookie1.el (read-cookie): Fix off-by-one error (bug#6921).

2010-08-26  Chong Yidong  <cyd@stupidchicken.com>

	* simple.el (beginning-of-buffer, end-of-buffer): Doc fix
	(Bug#6907).

2010-08-26  Nathan Weizenbaum  <nweiz@cressida.sea.corp.google.com>  (tiny change)

	* progmodes/js.el: Make indentation more customizable (Bug#6914).
	(js-paren-indent-offset, js-square-indent-offset)
	(js-curly-indent-offset): New options.
	(js--proper-indentation): Use them.

2010-08-26  Daniel Colascione  <dan.colascione@gmail.com>

	* progmodes/sh-script.el (sh-get-indent-info): Use syntax-ppss
	instead of inspecting font-lock properties (Bug#6916).

2010-08-26  David Reitter  <david.reitter@gmail.com>

	* server.el (server-visit-files): Run pre-command-hook and
	post-command-hook for each buffer while it is current (Bug#6910).
	(server-execute): Do not run hooks here.

2010-08-26  Michael Albinus  <michael.albinus@gmx.de>

	Sync with Tramp 2.1.19.

	* net/tramp-cmds.el (tramp-cleanup-all-connections)
	(tramp-reporter-dump-variable, tramp-load-report-modules)
	(tramp-append-tramp-buffers): Use `tramp-compat-funcall'.
	(tramp-bug): Recommend setting of `tramp-verbose' to 9.

	* net/tramp-compat.el (top): Do not autoload
	`tramp-handle-file-remote-p'.  Load tramp-util.el and tramp-vc.el
	only when `start-file-process' is not bound.
	(byte-compile-not-obsolete-vars): Define if not bound.
	(tramp-compat-funcall): New defmacro.
	(tramp-compat-line-beginning-position)
	(tramp-compat-line-end-position)
	(tramp-compat-temporary-file-directory)
	(tramp-compat-make-temp-file, tramp-compat-file-attributes)
	(tramp-compat-copy-file, tramp-compat-copy-directory)
	(tramp-compat-delete-file, tramp-compat-delete-directory)
	(tramp-compat-number-sequence, tramp-compat-process-running-p):
	Use it.
	(tramp-advice-file-expand-wildcards): Do not use
	`tramp-handle-file-remote-p'.
	(tramp-compat-make-temp-file): Simplify fallback implementation.
	(tramp-compat-copy-file): Add PRESERVE-SELINUX-CONTEXT.
	(tramp-compat-copy-tree): Remove function.
	(tramp-compat-delete-file): New defun.
	(tramp-compat-delete-directory): Provide implementation for older
	Emacsen.
	(tramp-compat-file-attributes): Handle only
	`wrong-number-of-arguments' error.

	* net/tramp-fish.el (tramp-fish-handle-copy-file):
	Add PRESERVE_SELINUX_CONTEXT.
	(tramp-fish-handle-delete-file): Add TRASH arg.
	(tramp-fish-handle-directory-files-and-attributes):
	Do not use `tramp-fish-handle-file-attributes.
	(tramp-fish-handle-file-local-copy)
	(tramp-fish-handle-insert-file-contents)
	(tramp-fish-maybe-open-connection): Use `with-progress-reporter'.

	* net/tramp-gvfs.el (top): Require url-util.
	(tramp-gvfs-mount-point): Remove.
	(tramp-gvfs-file-name-handler-alist): Add `file-selinux-context'
	and `set-file-selinux-context'.
	(tramp-gvfs-stringify-dbus-message, tramp-gvfs-send-command)
	(tramp-gvfs-handle-file-selinux-context)
	(tramp-gvfs-handle-set-file-selinux-context): New defuns.
	(with-tramp-dbus-call-method): Format trace message.
	(tramp-gvfs-handle-copy-file): Handle PRESERVE-SELINUX-CONTEXT.
	(tramp-gvfs-handle-copy-file, tramp-gvfs-handle-rename-file):
	Implement backup call, when operation on local files fails.
	Use progress reporter.  Flush properties of changed files.
	(tramp-gvfs-handle-delete-file): Add TRASH arg.  Use
	`tramp-compat-delete-file'.
	(tramp-gvfs-handle-expand-file-name): Expand "~/".
	(tramp-gvfs-handle-make-directory): Make more traces.
	(tramp-gvfs-handle-write-region): Protect deleting tmpfile.
	(tramp-gvfs-url-file-name): Hexify file name in url.
	(tramp-gvfs-fuse-file-name): Take also prefix (like dav shares)
	into account for the resulting file name.
	(tramp-gvfs-handler-askquestion): Preserve current message, in
	order to let progress reporter continue afterwards.  (Bug#6257)
	Return dummy mountpoint, when the answer is "no".
	See `tramp-gvfs-maybe-open-connection'.
	(tramp-gvfs-handler-mounted-unmounted)
	(tramp-gvfs-connection-mounted-p): Test also for new mountspec
	attribute "default_location".  Set "prefix" property.
	Handle default-location.
	(tramp-gvfs-mount-spec): Return both prefix and mountspec.
	(tramp-gvfs-maybe-open-connection): Test, whether mountpoint
	exists.  Raise an error, if not (due to a corresponding answer
	"no" in interactive questions, for example).
	Use `tramp-compat-funcall'.

	* net/tramp-imap.el (top): Autoload `epg-make-context'.
	(tramp-imap-handle-copy-file): Add PRESERVE-SELINUX-CONTEXT.
	(tramp-imap-do-copy-or-rename-file)
	(tramp-imap-handle-insert-file-contents)
	(tramp-imap-handle-file-local-copy): Use `with-progress-reporter'.
	(tramp-imap-handle-delete-file): Add TRASH arg.

	* net/tramp-smb.el (tramp-smb-handle-copy-file):
	Add PRESERVE-SELINUX-CONTEXT.
	(tramp-smb-handle-copy-file)
	(tramp-smb-handle-file-local-copy, tramp-smb-handle-rename-file)
	(tramp-smb-handle-write-region, tramp-smb-maybe-open-connection):
	Use `with-progress-reporter'.
	(tramp-smb-handle-delete-file): Add TRASH arg.

	* net/tramp.el (tramp-methods): Move hostname to the end in all
	ssh `tramp-login-args'.  Add `tramp-async-args' attribute where
	appropriate.
	(tramp-verbose): Describe verbose level 9.
	(tramp-completion-function-alist)
	(tramp-file-name-regexp, tramp-chunksize)
	(tramp-local-coding-commands, tramp-remote-coding-commands)
	(with-connection-property, tramp-completion-mode-p)
	(tramp-action-process-alive, tramp-action-out-of-band)
	(tramp-check-for-regexp, tramp-file-name-p, tramp-equal-remote)
	(tramp-exists-file-name-handler): Fix docstring.
	(tramp-remote-process-environment): Use `format' instead of
	`concat'.  Protect version string by apostroph.
	(tramp-shell-prompt-pattern): Do not use a shy group in case of
	XEmacs.
	(tramp-file-name-regexp-unified)
	(tramp-completion-file-name-regexp-unified): On W32 systems, do
	not regard the volume letter as remote filename.  (Bug#5447)
	(tramp-perl-file-attributes)
	(tramp-perl-directory-files-and-attributes): Don't pass "$3".
	(tramp-vc-registered-read-file-names): Read input as
	here-document, otherwise the command could exceed maximum length
	of command line.
	(tramp-file-name-handler-alist): Add `file-selinux-context' and
	`set-file-selinux-context'.
	(tramp-debug-message): Add `tramp-compat-funcall' to ignored
	backtrace functions.
	(tramp-error-with-buffer): Don't show the connection buffer when
	we are in completion mode.
	(tramp-progress-reporter-update, tramp-remote-selinux-p)
	(tramp-handle-file-selinux-context)
	(tramp-handle-set-file-selinux-context, tramp-process-sentinel)
	(tramp-connectable-p, tramp-open-shell, tramp-get-remote-trash):
	New defuns.
	(with-progress-reporter): New defmacro.
	(tramp-debug-outline-regexp): New defconst.
	(top, tramp-rfn-eshadow-setup-minibuffer)
	(tramp-rfn-eshadow-update-overlay, tramp-handle-set-file-times)
	(tramp-handle-dired-compress-file, tramp-handle-shell-command)
	(tramp-completion-mode-p, tramp-check-for-regexp)
	(tramp-open-connection-setup-interactive-shell)
	(tramp-compute-multi-hops, tramp-read-passwd, tramp-clear-passwd)
	(tramp-time-diff, tramp-coding-system-change-eol-conversion)
	(tramp-set-process-query-on-exit-flag, tramp-unload-tramp):
	Use `tramp-compat-funcall'.
	(tramp-handle-make-symbolic-link): Flush file properties.
	(tramp-handle-load, tramp-handle-file-local-copy)
	(tramp-handle-insert-file-contents, tramp-handle-write-region)
	(tramp-handle-vc-registered, tramp-maybe-send-script)
	(tramp-find-shell): Use `with-progress-reporter'.
	(tramp-do-file-attributes-with-stat): Add space in format string,
	in order to work around a bug in pdksh.  Reported by Gilles Pion
	<gpion@lfdj.com>.
	(tramp-handle-verify-visited-file-modtime): Do not send a command
	when the connection is not established.
	(tramp-handle-set-file-times): Simplify the check for utc.
	(tramp-handle-directory-files-and-attributes)
	(tramp-get-remote-path): Use `copy-tree'.
	(tramp-completion-handle-file-name-all-completions): Ensure, that
	non remote files are still checked.  Oops.
	(tramp-handle-copy-file, tramp-do-copy-or-rename-file):
	Handle PRESERVE-SELINUX-CONTEXT.
	(tramp-do-copy-or-rename-file): Add progress reporter.
	(tramp-do-copy-or-rename-file-directly): Do not use
	`tramp-handle-file-remote-p'.
	(tramp-do-copy-or-rename-file-out-of-band):
	Use `tramp-compat-delete-directory'.
	(tramp-do-copy-or-rename-file-out-of-band)
	(tramp-compute-multi-hops, tramp-maybe-open-connection):
	Use `format-spec-make'.
	(tramp-handle-delete-file): Add TRASH arg.
	(tramp-handle-dired-uncache): Flush directory cache, not only file
	cache.
	(tramp-handle-expand-file-name)
	(tramp-completion-handle-file-name-all-completions)
	(tramp-completion-handle-file-name-completion):
	Use `tramp-connectable-p'.
	(tramp-handle-start-file-process): Set connection property "vec".
	Use it, in order to invalidate file caches.  Check only for
	`remote-tty' process property.
	Implement tty setting.  (Bug#4604, Bug#6360)
	(tramp-file-name-for-operation): Add `call-process-region' and
	`set-file-selinux-context'.
	(tramp-find-foreign-file-name-handler)
	(tramp-advice-make-auto-save-file-name)
	(tramp-set-auto-save-file-modes): Remove superfluous check for
	`stringp'.  This is done inside `tramp-tramp-file-p'.
	(tramp-file-name-handler): Trace 'quit.  Catch the error for some
	operations when we are in completion mode.  This gives the user
	the chance to correct the file name in the minibuffer.
	(tramp-completion-mode-p): Use `non-essential'.
	(tramp-handle-file-name-all-completions): Backward/ XEmacs
	compatibility: Use `completion-ignore-case' if
	`read-file-name-completion-ignore-case' does not exist.
	(tramp-get-debug-buffer): Use `tramp-debug-outline-regexp'.
	(tramp-find-shell, tramp-open-connection-setup-interactive-shell):
	`tramp-open-shell'.
	(tramp-action-password): Hide password prompt before next run.
	(tramp-process-actions): Widen connection buffer for the trace.
	(tramp-open-connection-setup-interactive-shell): Set `remote-tty'
	process property.  Trace stty settings if `tramp-verbose' >= 9.
	Apply workaround for IRIX64 bug.  Move argument of last
	`tramp-send-command' where it belongs to.
	(tramp-maybe-open-connection): Use `async-args' and `gw-args' in
	front of `login-args'.
	(tramp-get-ls-command, tramp-get-ls-command-with-dired): Run tests
	on "/dev/null" instead of "/".
	(tramp-get-ls-command-with-dired): Make test for "--dired"
	stronger.
	(tramp-set-auto-save-file-modes): Adapt version check.
	(tramp-set-process-query-on-exit-flag): Fix wrong parentheses.
	(tramp-handle-process-file): Call the program in a subshell, in
	order to preserve working directory.
	(tramp-handle-shell-command): Don't use hard-wired "/bin/sh" but
	`tramp-remote-sh' from `tramp-methods'.
	(tramp-get-ls-command): Make test for "--color=never" stronger.
	(tramp-check-for-regexp): Use (forward-line 1).

	* net/trampver.el: Update release number.

2010-08-26  Chong Yidong  <cyd@stupidchicken.com>

	* help.el (help-map): Bind `C-h P' to describe-package.

	* menu-bar.el (menu-bar-describe-menu): Add describe-package.

	* emacs-lisp/package.el (package-refresh-contents): Catch errors
	when downloading archives.
	(describe-package-1): Add package commentary.
	(package-install-button-action): New function.
	(package-menu-mode-map): Bind ? to package-menu-describe-package.
	(package-menu-view-commentary): Function removed.
	(package-list-packages-internal): Hide the `package' package too.

2010-08-25  Kenichi Handa  <handa@m17n.org>

	* language/misc-lang.el ("Arabic"): New language environment.
	Setup composition-function-table for Arabic characters.

	* international/fontset.el (setup-default-fontset): Fix typo for
	arabic OTF spec (fini->fina).

2010-08-25  Jan Djärv  <jan.h.d@swipnet.se>

	* menu-bar.el (menu-bar-set-tool-bar-position): Set frame parameter
	on all frames.

2010-08-24  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* whitespace.el: Allow cleaning up blanks without blank
	visualization (Bug#6651).  Adjust help window for
	whitespace-toggle-options (Bug#6479).  Allow to use fill-column
	instead of whitespace-line-column (from EmacsWiki).  New version
	13.1.
	(whitespace-style): Added new value 'face.  Adjust docstring.
	(whitespace-space, whitespace-hspace, whitespace-tab): Adjust
	foreground property face.
	(whitespace-line-column): Adjust docstring and type declaration.
	(whitespace-style-value-list, whitespace-toggle-option-alist)
	(whitespace-help-text): Adjust const initialization.
	(whitespace-toggle-options, global-whitespace-toggle-options):
	Adjust docstring.
	(whitespace-display-window, whitespace-interactive-char)
	(whitespace-style-face-p, whitespace-color-on): Adjust code.
	(whitespace-help-scroll): New fun.

2010-08-24  Chong Yidong  <cyd@stupidchicken.com>

	* emacs-lisp/package.el (list-packages): Alias for
	package-list-packages.

2010-08-24  Kevin Ryde  <user42@zip.com.au>

	* textmodes/flyspell.el (flyspell-check-tex-math-command): Doc fix
	(Bug#5651).

	* progmodes/ruby-mode.el (ruby): Add defgroup.

2010-08-24  Chong Yidong  <cyd@stupidchicken.com>

	* progmodes/python.el: Add Ipython support (Bug#5390).
	(python-shell-prompt-alist)
	(python-shell-continuation-prompt-alist): New options.
	(python--set-prompt-regexp): New function.
	(inferior-python-mode, run-python, python-shell): Require
	ansi-color.  Use python--set-prompt-regexp to set the comint
	prompt based on the Python interpreter.
	(python--prompt-regexp): New var.
	(python-check-comint-prompt)
	(python-comint-output-filter-function): Use it.
	(run-python): Use a pipe (Bug#5694).

2010-08-24  Fabian Ezequiel Gallina  <galli.87@gmail.com>  (tiny change)

	* progmodes/python.el (python-send-region): Send a different
	Python command if Ipython is in use.
	(python-check-version): Use a Python command to find the version.

2010-08-24  Chong Yidong  <cyd@stupidchicken.com>

	* mouse.el (mouse-yank-primary): Avoid setting primary when
	deactivating the mark (Bug#6872).

2010-08-23  Chris Foote  <chris@foote.com.au>  (tiny change)

	* progmodes/python.el (python-block-pairs): Allow use of "finally"
	with "else" (Bug#3991).

2010-08-23  Michael Albinus  <michael.albinus@gmx.de>

	* net/dbus.el: Accept UNIX domain sockets as bus address.
	(top): Don't initialize `dbus-registered-objects-table' anymore,
	this is done in dbusbind,c.
	(dbus-check-event): Adapt test for bus.
	(dbus-return-values-table, dbus-unregister-service)
	(dbus-event-bus-name, dbus-introspect, dbus-register-property):
	Adapt doc string.

2010-08-23  Juanma Barranquero  <lekktu@gmail.com>

	* ido.el (ido-use-virtual-buffers): Fix typo in docstring.

2010-08-22  Juri Linkov  <juri@jurta.org>

	* simple.el (read-extended-command): New function with the logic
	for `completing-read' moved to Elisp from `execute-extended-command'.
	Use `function-called-at-point' in `minibuffer-default-add-function'
	to get a command name for M-n (bug#5364, bug#5214).

2010-08-22  Chong Yidong  <cyd@stupidchicken.com>

	* startup.el (command-line-1): Issue warning for ignored arguments
	--unibyte, etc (Bug#6886).

2010-08-22  Leo  <sdl.web@gmail.com>

	* net/rcirc.el (rcirc-add-or-remove): Accept a list of elements.
	(ignore, bright, dim, keyword): Split list of nicknames before
	passing to rcirc-add-or-remove (Bug#6894).

2010-08-22  Chong Yidong  <cyd@stupidchicken.com>

	* emacs-lisp/easy-mmode.el (define-minor-mode): Doc fix (Bug#6880).

2010-08-22  Leo  <sdl.web@gmail.com>

	Fix buffer-list rename&refresh after killing a buffer in ido.
	* ido.el: Revert Óscar's.
	(ido-kill-buffer-at-head): Exit the minibuffer with ido-exit=refresh.
	Remember the buffers at head, rather than their name.
	* iswitchb.el (iswitchb-kill-buffer): Re-make the list.

2010-08-22  Kirk Kelsey  <kirk.kelsey@0x4b.net>  (tiny change)
            Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/make-mode.el (makefile-fill-paragraph): Account for the
	extra backslash added to each line (bug#6890).

2010-08-22  Stefan Monnier  <monnier@iro.umontreal.ca>

	* subr.el (read-key): Don't echo keystrokes (bug#6883).

2010-08-22  Glenn Morris  <rgm@gnu.org>

	* menu-bar.el (menu-bar-games-menu): Add landmark.

2010-08-22  Glenn Morris  <rgm@gnu.org>

	* align.el (align-regexp): Make group and spacing arguments
	use the interactive defaults when non-interactive.  (Bug#6698)

	* mail/rmail.el (rmail-forward): Replace mail-text-start with its
	expansion, so as not to need sendmail.
	(mail-text-start): Remove declaration.
	(rmail-retry-failure): Require sendmail.

2010-08-22  Chong Yidong  <cyd@stupidchicken.com>

	* subr.el (read-key): Don't hide the menu-bar entries (bug#6881).

2010-08-22  Michael Albinus  <michael.albinus@gmx.de>

	* progmodes/flymake.el (flymake-start-syntax-check-process):
	Use `start-file-process' in order to let it run also on remote hosts.

2010-08-22  Kenichi Handa  <handa@m17n.org>

	* files.el: Add `word-wrap' as safe local variable.

2010-08-22  Glenn Morris  <rgm@gnu.org>

	* woman.el (woman-translate): Case matters.  (Bug#6849)

2010-08-22  Chong Yidong  <cyd@stupidchicken.com>

	* simple.el (kill-region): Doc fix (Bug#6787).

2010-08-22  Glenn Morris  <rgm@gnu.org>

	* calendar/diary-lib.el (diary-header-line-format):
	Fit it to the window, not the frame.

2010-08-22  Andreas Schwab  <schwab@linux-m68k.org>

	* subr.el (ignore-errors): Add debug declaration.

2010-08-22  Geoff Gole  <geoffgole@gmail.com>  (tiny change)

	* whitespace.el (whitespace-color-off): Remove post-command-hook
	locally.

2010-08-21  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc/add-log.el (add-log-file-name): Don't get confused by symlinks.

2010-08-21  Chong Yidong  <cyd@stupidchicken.com>

	* cus-edit.el (custom-group-value-create): Add extra newline
	before end line (Bug#6876).

2010-08-21  Chong Yidong  <cyd@stupidchicken.com>

	* mouse.el (mouse-save-then-kill): Don't save region to kill ring
	when extending it.  Before killing on the second click, check if
	the buffer is the correct one.  Doc fix.
	(mouse-secondary-save-then-kill): Allow usage without first
	calling mouse-start-secondary, by defaulting to point.  Don't save
	an empty secondary selection.  Doc fix.

2010-08-21  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* whitespace.el: Fix slow cursor movement (Bug#6172).  Reported by
	Christoph Groth <cwg@falma.de> and Liu Xin <x_liu@neusoft.com>.
	New version 13.0.
	(whitespace-empty-at-bob-regexp, whitespace-empty-at-eob-regexp):
	Adjust initialization.
	(whitespace-bob-marker, whitespace-eob-marker)
	(whitespace-buffer-changed): New vars.
	(whitespace-cleanup, whitespace-color-on, whitespace-color-off)
	(whitespace-empty-at-bob-regexp, whitespace-empty-at-eob-regexp)
	(whitespace-post-command-hook, whitespace-display-char-on):
	Adjust code.
	(whitespace-looking-back, whitespace-buffer-changed): New funs.
	(whitespace-space-regexp, whitespace-tab-regexp): Fun eliminated.

2010-08-19  Stefan Monnier  <monnier@iro.umontreal.ca>

	* files.el (locate-file-completion-table): Only list the .el and .elc
	extensions if there's no other choice (bug#5955).

	* facemenu.el (facemenu-self-insert-data): New var.
	(facemenu-post-self-insert-function, facemenu-set-self-insert-face):
	New functions.
	(facemenu-add-face): Use them.

	* simple.el (blink-matching-open): Obey forward-sexp-function.

2010-08-18  Stefan Monnier  <monnier@iro.umontreal.ca>

	* simple.el (prog-mode-map): New var.
	(prog-indent-sexp): New command.

	* progmodes/octave-mod.el (octave-mode-menu): Make toggle buttons.

	* progmodes/prolog.el (smie): Require.

	* emacs-lisp/smie.el (smie-default-backward-token)
	(smie-default-forward-token): Strip properties.
	(smie-next-sexp): Be more careful with associative operators.
	(smie-forward-sexp-command): Generalize.
	(smie-backward-sexp-command): Simplify.
	(smie-closer-alist): New var.
	(smie-close-block): New command.
	(smie-indent-debug-log): New var.
	(smie-indent-offset-rule): Add a few more cases.
	(smie-indent-column): New function.
	(smie-indent-after-keyword): Use it.
	(smie-indent-keyword): Use it.
	Fix up the opener code's point position.
	(smie-indent-comment): Only applies at BOL.
	(smie-indent-debug): New command.

	* emacs-lisp/autoload.el (make-autoload): Preload the macros's
	declarations that are useful before running the macro.

2010-08-18  Joakim Verona  <joakim@verona.se>

	* image.el (imagemagick-types-inhibit): New variable.
	(imagemagick-register-types): New function.
	* image-mode.el (image-transform-properties): New function.
	(image-transform-set-scale, image-transform-fit-to-height)
	(image-transform-set-rotation, image-transform-set-resize)
	(image-transform-fit-to-width, image-transform-fit-to-height):
	New functions.
	(image-toggle-display-image): Support image transforms.

2010-08-18  Katsumi Yamaoka  <yamaoka@jpl.org>

	* image.el (create-animated-image): Don't add heuristic mask to image
	(Bug#6839).

2010-08-18  Jan Djärv  <jan.h.d@swipnet.se>

	* term/ns-win.el (ns-get-pasteboard, ns-set-pasteboard):
	Use QCLIPBOARD instead of QPRIMARY (Bug#6677).

2010-08-17  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/lisp.el (up-list): Obey forward-sexp-function if set.

	Font-lock '...' strings, plus various simplifications and fixes.
	* progmodes/octave-mod.el (octave-font-lock-keywords): Use regexp-opt.
	(octave-font-lock-close-quotes): New function.
	(octave-font-lock-syntactic-keywords): New var.
	(octave-mode): Use it.  Set beginning-of-defun-function.
	(octave-mode-map): Don't override the <foo>-defun commands.
	(octave-mode-menu): Pass it directly to easy-menu-define;
	remove (now generic) <foo>-defun commands; use info-lookup-symbol.
	(octave-block-match-alist): Fix up last change so that
	octave-close-block uses the more specific keyword.
	(info-lookup-mode): Silence byte-compiler.
	(octave-beginning-of-defun): Not interactive any more.
	Optimize slightly.
	(octave-end-of-defun, octave-mark-defun, octave-in-defun-p): Remove.
	(octave-indent-defun, octave-send-defun): Use mark-defun instead.
	(octave-completion-at-point-function): Make sure point is within
	beg..end.
	(octave-reindent-then-newline-and-indent):
	Use reindent-then-newline-and-indent.
	(octave-add-octave-menu): Remove.

2010-08-17  Jan Djärv  <jan.h.d@swipnet.se>

	* mail/emacsbug.el (report-emacs-bug-insert-to-mailer)
	(report-emacs-bug-can-use-xdg-email): New functions.
	(report-emacs-bug): Set can-xdg-email to result of
	report-emacs-bug-can-use-xdg-email.  If can-xdg-email bind
	\C-cm to report-emacs-bug-insert-to-mailer and add help text
	about it.

	* net/browse-url.el (browse-url-default-browser): Add cond
	for browse-url-xdg-open.
	(browse-url-can-use-xdg-open, browse-url-xdg-open): New functions.

2010-08-17  Glenn Morris  <rgm@gnu.org>

	* progmodes/cc-engine.el (c-new-BEG, c-new-END)
	(c-fontify-recorded-types-and-refs): Define for compiler.
	* progmodes/cc-mode.el (c-new-BEG, c-new-END): Move definitions
	before use.

	* calendar/icalendar.el (icalendar--convert-recurring-to-diary):
	Fix format call.

2010-08-17  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-handle-make-symbolic-link): Flush file
	properties.
	(tramp-handle-process-file): Call the program in a subshell, in
	order to preserve working directory.
	(tramp-action-password): Hide password prompt before next run.
	(tramp-process-actions): Widen connection buffer for the trace.

2010-08-16  Deniz Dogan  <deniz.a.m.dogan@gmail.com>

	* net/rcirc.el (rcirc-log-process-buffers): New option.
	(rcirc-print): Use it.
	(rcirc-generate-log-filename): New function.
	(rcirc-log-filename-function): Change default to
	rcirc-generate-log-filename (Bug#6828).

2010-08-16  Chong Yidong  <cyd@stupidchicken.com>

	* simple.el (deactivate-mark): If select-active-regions is `only',
	only set selection for temporarily active regions.

	* cus-start.el: Change defcustom for select-active-regions.

2010-08-15  Chong Yidong  <cyd@stupidchicken.com>

	* mouse.el (mouse--drag-set-mark-and-point): New function.
	(mouse-drag-track): Use LOCATION arg to push-mark.
	Use mouse--drag-set-mark-and-point to take click-count into
	consideration when updating point and mark (Bug#6840).

2010-08-15  Chong Yidong  <cyd@stupidchicken.com>

	* progmodes/compile.el (compilation-error-regexp-alist-alist):
	Give the Ruby rule a lower priority than Gnu (Bug#6778).

2010-08-14  Štěpán Němec  <stepnem@gmail.com>  (tiny change)

	* font-lock.el (lisp-font-lock-keywords-2):
	Add combine-after-change-calls, condition-case-no-debug,
	with-demoted-errors, and with-silent-modifications (Bug#6025).

2010-08-14  Kevin Ryde  <user42@zip.com.au>

	* emacs-lisp/copyright.el (copyright-update-year)
	(copyright-update): Temporary switch-to-buffer to ensure the
	buffer change being queried is visible (Bug#5394).

2010-08-14  Tom Tromey  <tromey@redhat.com>

	* progmodes/etags.el (tags-file-name): Mark safe if stringp
	(Bug#6733).

2010-08-14  Eli Zaretskii  <eliz@gnu.org>

	* mouse.el (mouse-yank-primary): Fix mouse-2 on MS-Windows and
	MS-DOS.  (Bug#6689)

2010-08-13  Jan Djärv  <jan.h.d@swipnet.se>

	* menu-bar.el (menu-bar-set-tool-bar-position): New function.
	(menu-bar-showhide-tool-bar-menu-customize-enable-left)
	(menu-bar-showhide-tool-bar-menu-customize-enable-right)
	(menu-bar-showhide-tool-bar-menu-customize-enable-top)
	(menu-bar-showhide-tool-bar-menu-customize-enable-bottom):
	Call menu-bar-set-tool-bar-position.

2010-08-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/octave-mod.el (octave-mode-syntax-table): Use the new "c"
	comment style (bug#6834).
	* progmodes/scheme.el (scheme-mode-syntax-table):
	* emacs-lisp/lisp-mode.el (lisp-mode-syntax-table): Remove spurious
	"b" flag in "' 14b" syntax.

	* progmodes/octave-mod.el (octave-mode-map): Remove special bindings
	for (un)commenting the region and performing completion.
	(octave-mode-menu): Use standard commands for help and completion.
	(octave-mode-syntax-table): Support %{..%} comments (sort of).
	(octave-mode): Use define-derived-mode.
	Set completion-at-point-functions and don't set columns.
	Don't disable adaptive-fill-regexp.
	(octave-describe-major-mode, octave-comment-region)
	(octave-uncomment-region, octave-comment-indent)
	(octave-indent-for-comment): Remove.
	(octave-indent-calculate): Rename from calculate-octave-indent.
	(octave-indent-line, octave-fill-paragraph): Update caller.
	(octave-initialize-completions): No need to make an alist.
	(octave-completion-at-point-function): New function.
	(octave-complete-symbol): Use it.
	(octave-insert-defun): Use define-skeleton.

	* progmodes/octave-mod.el (octave-mode): Set comment-add.
	(octave-mode-map): Use comment-dwim (bug#6829).

2010-08-12  Antoine Levitt  <antoine.levitt@gmail.com>  (tiny change)

	* cus-edit.el (custom-save-variables, custom-save-faces): Fix up
	indentation of inserted comment.

2010-08-11  Jan Djärv  <jan.h.d@swipnet.se>

	* faces.el (region): Add type gtk that uses gtk colors.

	* dynamic-setting.el (dynamic-setting-handle-config-changed-event):
	Handle theme-name change.

2010-08-10  Michael R. Mauger  <mmaug@yahoo.com>

	* progmodes/sql.el: Version 2.5
	(sql-product-alist): Add :prompt-cont-regexp property for several
	database products.
	(sql-prompt-cont-regexp): New variable.
	(sql-output-newline-count, sql-output-by-send):
	New variables.  Record number of newlines in input text.
	(sql-send-string): Handle multiple filters and count newlines.
	(sql-send-magic-terminator): Count terminator newline.
	(sql-interactive-remove-continuation-prompt): Filters output to
	remove continuation prompts; one for each newline.
	(sql-interactive-mode): Set up new variables, prompt regexp and
	output filter.
	(sql-mode-sqlite-font-lock-keywords): Correct some keywords.
	(sql-make-alternate-buffer-name): Correct buffer name in edge cases.

2010-08-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/pcase.el: New file.

2010-08-10  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-vc-registered-read-file-names): Read input
	as here-document, otherwise the command could exceed maximum
	length of command line.
	(tramp-handle-vc-registered): Call script accordingly.
	Reported by Toru TSUNEYOSHI <t_tuneyosi@hotmail.com>.

2010-08-10  Kenichi Handa  <handa@m17n.org>

	* language/hebrew.el: Exclude U+05C3 (Hebrew SOF PASUQ) from the
	composable pattern.

2010-08-09  Chong Yidong  <cyd@stupidchicken.com>

	* emacs-lisp/package.el (package-version-split)
	(package--version-first-nonzero, package-version-compare):
	Functions removed.
	(package-directory-list, package-load-all-descriptors)
	(package--built-in, package-activate, define-package)
	(package-installed-p, package-compute-transaction)
	(package-read-all-archive-contents)
	(package--add-to-archive-contents, package-buffer-info)
	(package-tar-file-info, package-list-packages-internal):
	Use version-to-list and version-list-*.

	* emacs-lisp/package-x.el (package-upload-buffer-internal):
	Use version-to-list.
	(package-upload-buffer-internal): Use version-list-<=.

2010-08-09  Kenichi Handa  <handa@m17n.org>

	* language/hebrew.el: Exclude U+05BD (Hebrew MAQAF) from the
	composable pattern.

2010-08-08  Chong Yidong  <cyd@stupidchicken.com>

	* tutorial.el (tutorial--default-keys): C-d is now bound to
	delete-forward-char (Bug#6826).

	* mouse.el (mouse-drag-track): Remove accidentally-removed check
	for `double' value of mouse-1-click-follows-link (Bug#6807).

2010-08-08  Johan Bockgård  <bojohan@gnu.org>

	* replace.el (replace-highlight): Bind isearch-forward and
	isearch-error, ensuring that highlighting is updated if the user
	switches the search direction (Bug#6808).

	* isearch.el (isearch-lazy-highlight-forward): New var.
	(isearch-lazy-highlight-new-loop, isearch-lazy-highlight-search):
	(isearch-lazy-highlight-update): Use it.

2010-08-08  Kenichi Handa  <handa@m17n.org>

	* international/mule.el (define-charset): Store NAME as :base property.
	(ctext-non-standard-encodings-table): Pay attention to charset aliases.
	(ctext-pre-write-conversion): Sort ctext-standard-encodings by the
	current priority.  Force using the designation of the specific
	charset by adding `charset' text property.  Improve the whole algorithm.

2010-08-08  Juanma Barranquero  <lekktu@gmail.com>

	* emulation/pc-select.el (pc-selection-mode-hook)
	(copy-region-as-kill-nomark, beginning-of-buffer-mark)
	(pc-selection-mode): Fix typos in docstrings.

2010-08-08  Kenichi Handa  <handa@m17n.org>

	* language/cyrillic.el: Don't add "microsoft-cp1251" to
	ctext-non-standard-encodings-alist here.

	* international/mule.el (ctext-non-standard-encodings-alist):
	Add "koi8-r" and "microsoft-cp1251".
	(ctext-standard-encodings): New variable.
	(ctext-non-standard-encodings-table): List only elements for
	non-standard encodings.
	(ctext-pre-write-conversion): Adjust for the above change.
	Check ctext-standard-encodings.

	* international/mule-conf.el (compound-text): Doc fix.
	(ctext-no-compositions): Doc fix.
	(compound-text-with-extensions): Doc fix.

2010-08-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* simple.el (exchange-dot-and-mark): Mark obsolete, finally.

2010-08-08  Juanma Barranquero  <lekktu@gmail.com>

	* progmodes/which-func.el (which-func-format): Split help-echo text
	into lines, like other mode-line tooltips.

	* server.el (server-start): When using TCP sockets, force IPv4
	and use a literal 127.0.0.1 for localhost.  (Related to bug#6781.)

2010-08-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* bindings.el (complete-symbol): Run completion-at-point as a fallback.

2010-08-08  Juanma Barranquero  <lekktu@gmail.com>

	* term.el (term-delimiter-argument-list): Reflow docstring.
	(term-read-input-ring, term-write-input-ring, term-send-input)
	(term-bol, term-erase-in-display, serial-supported-or-barf):
	Fix typos in docstrings.

2010-08-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* bindings.el (function-key-map): Add a S-tab => backtab fallback.

2010-08-08  Juanma Barranquero  <lekktu@gmail.com>

	* dabbrev.el (dabbrev-completion): Fix typo in docstring.

2010-08-08  MON KEY  <monkey@sandpframing.com>  (tiny change)

	* emacs-lisp/syntax.el (syntax-ppss-toplevel-pos):
	Fix typo in docstring (bug#6747).

2010-08-08  Leo  <sdl.web@gmail.com>

	* eshell/esh-io.el (eshell-get-target): Better detection of
	read-only file (Bug#6762).

2010-08-08  Juanma Barranquero  <lekktu@gmail.com>

	* align.el (align-default-spacing): Doc fix.
	(align-region-heuristic, align-regexp): Fix typos in docstrings.

2010-08-08  Stephen Peters  <speters@itasoftware.com>

	* calendar/icalendar.el
	(icalendar--split-value): Fix splitting regexp.  (Bug#6766)
	(icalendar--get-weekday-numbers): New.
	(icalendar--convert-recurring-to-diary): Handle multiple byday
	values in weekly rules.  (Bug#6766)

2010-08-08  Ulf Jasper  <ulf.jasper@web.de>

	* calendar/icalendar.el (icalendar-uid-format): Doc fix.
	(icalendar--create-uid, icalendar-export-region)
	(icalendar--parse-summary-and-rest): Code formatting.

2010-08-08  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc.el (calc-trail-mode,calc-refresh): Use `face' property
	to italicize headers.
	(calc-highlight-selections-with-faces): New variable.
	(calc-selected-face, calc-nonselected-face): New faces.

	* calc/calccomp.el (math-comp-highlight-string): Use
	`calc-highlight-selections-with-faces' to determine how to highlight
	sub-formulas.

	* calc/calc-sel.el (calc-show-selections): Change message to when
	using faces to highlight selections.

2010-08-07  Michael R. Mauger  <mmaug@yahoo.com>

	* progmodes/sql.el (sql-mode-sqlite-font-lock-keywords):
	Add SQLite 3 keywords, functions and datatypes.
	(sql-interactive-mode): Remove `comint-process-echoes' set to t
	(Bug#6686).

2010-08-07  Chong Yidong  <cyd@stupidchicken.com>

	* simple.el (select-active-regions): Move to keyboard.c.
	(deactivate-mark): Used saved-region-selection.
	(select-active-region): Function removed.
	(activate-mark, set-mark, push-mark-command)
	(handle-shift-selection): Don't call it.
	(keyboard-quit): Avoid adding the region to the window selection.

	* mouse.el (mouse-drag-track): Remove hacks to deal with old
	select-active-regions implementation.
	(mouse-yank-at-click): Doc fix.

	* cus-start.el: Add custom declaration for select-active-regions.

2010-08-07  Eli Zaretskii  <eliz@gnu.org>

	* simple.el (delete-forward-char): Doc fix.

	* tutorial.el (help-with-tutorial): Hack safe file-local variables
	after reading the tutorial.

2010-08-06  Alan Mackenzie  <bug-cc-mode@gnu.org>

	* progmodes/cc-cmds.el (c-mask-paragraph, c-fill-paragraph): Fix
	for the case that a C style comment has its delimiters alone on
	their respective lines.

2010-08-06  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-handle-start-file-process): Set connection
	property "vec".
	(tramp-process-sentinel): Use it for flushing the cache.  We
	cannot do it via the process buffer, the buffer could be deleted
	already when running the sentinel.

2010-08-06  Jürgen Hötzel  <juergen@archlinux.org>  (tiny change)

	* comint.el (comint-mode): Make directory tracking functions
	functional on remote files.  (Bug#6764)

2010-08-06  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc/diff-mode.el (diff-mode-shared-map): Bind g to revert-buffer.

2010-08-05  Eli Zaretskii  <eliz@gnu.org>

	* emacs-lisp/find-gc.el (find-gc-source-files): Rename
	unexec.c => unexcoff.c.

	* emacs-lisp/authors.el (authors-fixed-entries): Rename
	unexec.c => unexcoff.c.

2010-08-05  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-handle-dired-uncache): Flush directory
	cache, not only file cache.
	(tramp-process-sentinel): New defun.
	(tramp-handle-start-file-process): Use it, in order to invalidate
	file caches.

2010-08-03  Leo  <sdl.web@gmail.com>

	* server.el (server-start): Simplify loop.

2010-08-02  Stefan Monnier  <monnier@iro.umontreal.ca>

	* frame.el (screen-height, screen-width, set-screen-width)
	(set-screen-height): Remove ancient compatibility aliases.

	* textmodes/fill.el (justify-current-line): Don't add 1 to nspaces
	when justifying.  It seems useless and harmful for ncols=1 (bug#6738).

	* emacs-lisp/timer.el (timer-event-handler): Protect against timers
	that change current buffer.

2010-08-01  YAMAMOTO Mitsuharu  <mituharu@math.s.chiba-u.ac.jp>

	* mouse.el (mouse-fixup-help-message): Match "mouse-2" only at the
	beginning of the string.  Use `string-match-p'.  (Bug#6765)

2010-08-01  Jan Djärv  <jan.h.d@swipnet.se>

	* cus-start.el (x-gtk-use-system-tooltips): New variable.

2010-08-01  Chong Yidong  <cyd@stupidchicken.com>

	* emacs-lisp/package.el (package--list-packages): Fix column alignment.
	(package--builtins): Tweak descriptions.
	(package-print-package): Upcase descriptions if necessary.
	Show all built-in packages in font-lock-builtin-face.
	(package-list-packages-internal): Omit "emacs" package.
	Show status of built-in packages as "built-in".

2010-07-31  Chong Yidong  <cyd@stupidchicken.com>

	* mouse.el (mouse-save-then-kill): Doc fix.  Deactivate mark
	before killing to preserve the primary selection (Bug#6701).

	* term/x-win.el (x-select-text): Doc fix.

2010-07-31  Nathaniel Flath  <flat0103@gmail.com>

	Enhance Java Mode to handle Java 5.0 (Tiger) and Java 6 (Mustang).
	The following functions were modified or created:

	* progmodes/cc-vars.el (c-offsets-alist, c-inside-block-syms)
	(objc-font-lock-extra-types):
	* progmodes/cc-mode.el (c-basic-common-init):
	* progmodes/cc-langs.el (c-make-mode-syntax-table)
	(c++-make-template-syntax-table)
	(c-identifier-syntax-modifications, c-symbol-start, c-operators)
	(c-<-op-cont-regexp, c->-op-cont-regexp, c-class-decl-kwds)
	(c-brace-list-decl-kwds, c-modifier-kwds, c-prefix-spec-kwds-re)
	(c-type-list-kwds, c-decl-prefix-re, c-opt-type-suffix-key):
	* progmodes/cc-fonts.el (c-make-inverse-face)
	(c-basic-matchers-after):
	* progmodes/cc-engine.el (c-forward-keyword-clause)
	(c-forward-<>-arglist, c-forward-<>-arglist-recur)
	(c-forward-name, c-forward-type, c-forward-decl-or-cast-1)
	(c-guess-continued-construct, c-guess-basic-syntax):

2010-07-31  Jan Djärv  <jan.h.d@swipnet.se>

	* faces.el (face-all-attributes): Improve documentation (Bug#6767).

2010-07-31  Eli Zaretskii  <eliz@gnu.org>

	* files.el (bidi-paragraph-direction): Define safe local values.

	* language/hebrew.el ("Hebrew"): Add TUTORIAL.he to
	language-info-alist.  Remove outdated FIXME in a comment.

2010-07-31  Alan Mackenzie  <acm@muc.de>

	* progmodes/cc-cmds.el (c-mask-paragraph): Fix bug #6688:
	Auto-fill broken in C/C++ modes.

2010-07-29  Jan Djärv  <jan.h.d@swipnet.se>

	* menu-bar.el (menu-bar-showhide-tool-bar-menu-customize-enable-left)
	(menu-bar-showhide-tool-bar-menu-customize-disable)
	(menu-bar-showhide-tool-bar-menu-customize-enable-right)
	(menu-bar-showhide-tool-bar-menu-customize-enable-bottom)
	(menu-bar-showhide-tool-bar-menu-customize-enable-top): New functions
	(menu-bar-showhide-tool-bar-menu): If tool bar is moveable,
	make a menu for Options => toolbar that can move it.

2010-07-29  Chong Yidong  <cyd@stupidchicken.com>

	* emacs-lisp/package-x.el (package--make-rss-entry):
	(package-maint-add-news-item, package--update-news)
	(package-upload-buffer-internal): New arg ARCHIVE-URL.

	* emacs-lisp/package.el (package-archive-url): Rename from
	package-archive-id.
	(package-install): Doc fix.
	(package-download-single, package-download-tar, package-install)
	(package-menu-view-commentary): Callers changed.

2010-07-29  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-handle-start-file-process): Check only for
	`remote-tty' process property.
	(tramp-open-shell): Don't check for tty.
	(tramp-open-connection-setup-interactive-shell): Set `remote-tty'
	process property.

	* progmodes/gdb-mi.el (gdb-init-1): Check also for tty on a remote
	host.

2010-07-28  Chong Yidong  <cyd@stupidchicken.com>

	* emacs-lisp/package.el (package-load-list, package-archives)
	(package-archive-contents, package-user-dir)
	(package-directory-list, package--builtins, package-alist)
	(package-activated-list, package-obsolete-alist): Mark as risky.

2010-07-28  Phil Hagelberg  <phil@evri.com>

	Add support for non-default package repositories.
	* emacs-lisp/package.el (package-archive-base): Var deleted.
	(package-archives): New variable.
	(package-archive-contents): Doc fix.
	(package-load-descriptor): Do nothing if descriptor file is missing.
	(package--write-file-no-coding): New function.
	(package-unpack-single): Use it.
	(package-archive-id): New function.
	(package-download-single, package-download-tar)
	(package-menu-view-commentary): Use it.
	(package-installed-p): Make second argument optional.
	(package-read-all-archive-contents): New function.
	(package-initialize): Use it.
	(package-read-archive-contents): Add ARCHIVE argument.
	(package--add-to-archive-contents): New function.
	(package-install): Don't call package-read-archive-contents.
	(package--download-one-archive): Store archive file in a
	subdirectory of package-user-dir.
	(package-menu-execute): Remove spurious line movement.

2010-07-28  Jan Djärv  <jan.h.d@swipnet.se>

	* cus-start.el (tool-bar-style): Add text-image-horiz.

2010-07-28  Michael Albinus  <michael.albinus@gmx.de>

	* progmodes/gud.el (gud-common-init): Check for remoteness of
	`file', and not of `default-directory'.

2010-07-28  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-methods): Move hostname to the end in all
	ssh `tramp-login-args'.
	(tramp-verbose): Describe verbose level 9.
	(tramp-open-shell): Check for tty if `tramp-verbose' >= 9.
	(tramp-open-connection-setup-interactive-shell): Trace stty
	settings if `tramp-verbose' >= 9.
	(tramp-handle-start-file-process): Implement tty setting.
	(Bug#4604, Bug#6360)

	* net/tramp-cmds.el (tramp-bug): Recommend setting of
	`tramp-verbose' to 9.

2010-07-27  Aaron S. Hawley  <ashawley@burlingtontelecom.net>

	* emacs-lisp/re-builder.el (reb-re-syntax, reb-lisp-mode)
	(reb-lisp-syntax-p, reb-change-syntax, reb-cook-regexp):
	Remove references to package `lisp-re' (bug#4369).

2010-07-27  Tom Tromey  <tromey@redhat.com>

	* progmodes/js.el (js-mode):
	* progmodes/make-mode.el (makefile-mode):
	* progmodes/simula.el (simula-mode):
	* progmodes/tcl.el (tcl-mode): Derive from prog-mode.

2010-07-27  Juanma Barranquero  <lekktu@gmail.com>

	* help-fns.el (find-lisp-object-file-name): Doc fix (bug#6494).

	* time.el (display-time-day-and-date): Remove spurious * in docstring.
	(display-time-world-buffer-name, display-time-world-mode-map):
	Fix typos in docstrings.

2010-07-27  Shyam Karanatt  <shyam@swathanthran.in>  (tiny change)

	* image-mode.el (image-display-size): New function.
	(image-forward-hscroll, image-next-line, image-eol, image-eob)
	(image-mode-fit-frame): Use it (Bug#6639).

2010-07-27  Chong Yidong  <cyd@stupidchicken.com>

	* dired.el (dired-buffers-for-dir): Handle list values of
	dired-directory (Bug#6636).

2010-07-26  Sam Steingold  <sds@gnu.org>

	* mouse.el (mouse-yank-primary, mouse-yank-secondary):
	Do not call `x-get-selection' the second time, reuse the value.

2010-07-26  Daiki Ueno  <ueno@unixuser.org>

	* epa-mail.el (epa-mail-mode-map): Add alternative key bindings
	which consist of control chars only.  Suggested by Richard Stallman.

2010-07-25  Daiki Ueno  <ueno@unixuser.org>

	* epa-file.el (epa-file-insert-file-contents): Check if LOCAL-FILE
	exists before passing an error to find-file-not-found-functions
	(bug#6723).

2010-07-23  Lukas Huonker  <l.huonker@gmail.com>

	* play/tetris.el (tetris-tty-colors, tetris-x-colors, tetris-blank):
	Remove leading nil element, adjust values.
	(tetris-shapes, tetris-shape-scores):
	Change representation of shapes and remove some redundancy.
	(tetris-get-shape-cell, tetris-shape-width, tetris-draw-next-shape)
	(tetris-draw-shape, tetris-erase-shape, tetris-test-shape):
	Adjust for working with new representation of shapes.
	(tetris-shape-rotations): New function.
	(tetris-move-bottom, tetris-move-left, tetris-move-right)
	(tetris-rotate-prev, tetris-rotate-next):
	Adjust for working with the new version of tetris-test-shape.

2010-07-23  Markus Triska  <markus.triska@gmx.at>

	* progmodes/ps-mode.el: Use comint (bug#5954).
	(ps-run-mode-map): Adapt for comint-mode; omit "\r", [return]..
	(ps-mode-other-newline): Simplify.
	(ps-run-mode): Derive from comint-mode instead of
	fundamental-mode, yielding input history etc.
	(ps-run-start, ps-run-quit, ps-run-clear, ps-run-region)
	(ps-run-send-string): Adapt for comint-mode.
	(ps-run-newline): Remove now unneeded function.

2010-07-23  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-methods): Move hostname to the end in all
	plink `tramp-login-args'.

2010-07-23  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-open-shell): New defun.
	(tramp-find-shell, tramp-open-connection-setup-interactive-shell):
	Use it.

2010-07-23  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-file-name-regexp-unified)
	(tramp-completion-file-name-regexp-unified): On W32 systems, do
	not regard the volume letter as remote filename.  (Bug#5447)

2010-07-23  Juanma Barranquero  <lekktu@gmail.com>

	* custom.el (custom-declare-variable): Give a clearer error message
	when the docstring is missing (bug#6476).

2010-07-22  Michael R. Mauger  <mmaug@yahoo.com>

	* progmodes/sql.el: Version 2.4.  Improved Login prompting.
	(sql-login-params): New widget definition.
	(sql-oracle-login-params, sql-mysql-login-params)
	(sql-solid-login-params, sql-sybase-login-params)
	(sql-informix-login-params, sql-ingres-login-params)
	(sql-ms-login-params, sql-postgres-login-params)
	(sql-interbase-login-params, sql-db2-login-params)
	(sql-linter-login-params): Use it.
	(sql-sqlite-login-params): Use it; Define "database" parameter as
	a file name.
	(sql-sqlite-program): Change to "sqlite3".
	(sql-comint-sqlite): Make sure database name is complete.
	(sql-for-each-login): New function.
	(sql-connect, sql-save-connection): Use it.
	(sql-get-login-ext): New function.
	(sql-get-login): Use it.
	(sql-make-alternate-buffer-name): Handle :file parameters.

2010-07-22  Juanma Barranquero  <lekktu@gmail.com>

	* dired.el (dired-no-confirm): Document value t and fix defcustom to
	accept it (bug#6597).  Suggested by Drew Adams <drew.adams@oracle.com>.

2010-07-22  Teemu Likonen  <tlikonen@iki.fi>  (tiny change)

	* dired.el (dired-mode-map): Use command remapping (bug#6632).

2010-07-22  Lawrence Mitchell  <wence@gmx.li>

	* term/vt100.el (vt100-wide-mode): Fix :init-value keyword (bug#6620).

2010-07-21  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-get-ls-command)
	(tramp-get-ls-command-with-dired): Run tests on "/dev/null"
	instead of "/".

2010-07-20  Michael R. Mauger  <mmaug@yahoo.com>

	* progmodes/sql.el: Version 2.3.
	(sql-connection-alist): Changed keys from symbols to strings;
	enhanced the widget definition.
	(sql-mode-menu): Added submenu to select connections.
	(sql-interactive-mode-menu): Added "Save Connection" item.
	(sql-add-product): Fixed menu item.
	(sql-get-product-feature): Improved error handling.
	(sql--alt-buffer-part, sql--alt-if-not-empty): Removed.
	(sql-make-alternate-buffer-name): Simplified.
	(sql-product-interactive): Handle missing product.
	(sql-connect): Support string keys, minor improvements.
	(sql-save-connection): New function.
	(sql-connection-menu-filter): New function.

2010-07-20  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-file-name-handler): Trace 'quit.
	(tramp-open-connection-setup-interactive-shell): Apply
	workaround for IRIX64 bug.  Move argument of last
	`tramp-send-command' where it belongs to.

2010-07-20  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-perl-file-attributes)
	(tramp-perl-directory-files-and-attributes): Don't pass "$3".
	(tramp-maybe-open-connection): Use `async-args' and `gw-args' in
	front of `login-args'.

2010-07-19  Juanma Barranquero  <lekktu@gmail.com>

	* time.el (display-time-world-mode): Define with `define-derived-mode'.
	Set `show-trailing-whitespace' to nil.
	(display-time-world-display): Simplify.

2010-07-18  Alan Mackenzie  <acm@muc.de>

	Enhance `c-file-style' in file/directory local variables.
	* progmodes/cc-mode.el (c-count-cfss): New function.
	(c-before-hack-hook): Call `c-set-style' differently according to
	whether c-file-style was set in file or directory local
	variables.

2010-07-18  Michael R. Mauger  <mmaug@yahoo.com>

	* progmodes/sql.el: Version 2.2.
	(sql-product, sql-user, sql-database, sql-server, sql-port): Use
	defcustom :safe keyword rather than putting safe-local-variable
	property.
	(sql-password): Use defcustom :risky keyword rather than putting
	risky-local-variable property.
	(sql-oracle-login-params, sql-sqlite-login-params)
	(sql-solid-login-params, sql-sybase-login-params)
	(sql-informix-login-params, sql-ingres-login-params)
	(sql-ms-login-params, sql-postgres-login-params)
	(sql-interbase-login-params, sql-db2-login-params)
	(sql-linter-login-params): Add `port' option.
	(sql-get-product-feature): Added NO-INDIRECT parameter.
	(sql-comint-oracle, sql-comint-sybase)
	(sql-comint-informix, sql-comint-sqlite, sql-comint-mysql)
	(sql-comint-solid, sql-comint-ingres, sql-comint-ms)
	(sql-comint-postgres, sql-comint-interbase, sql-comint-db2)
	(sql-comint-linter): Renamed sql-connect-* functions to
	sql-comint-*.
	(sql-product-alist, sql-mode-menu): Renamed as above and
	:sqli-connect-func to :sqli-comint-func.
	(sql-connection): New variable.
	(sql-interactive-mode): Set it.
	(sql-connection-alist): New variable.
	(sql-connect): New function.
	(sql--alt-buffer-part, sql--alt-if-not-empty)
	(sql-make-alternate-buffer-name): Improved alternative buffer name.

2010-07-17  Thierry Volpiatto  <thierry.volpiatto@gmail.com>

	* image-mode.el (image-bookmark-make-record): Do not set context
	in an image (Bug#6650).

2010-07-17  Chong Yidong  <cyd@stupidchicken.com>

	* simple.el (select-active-region): New function.
	(push-mark-command, set-mark, activate-mark)
	(handle-shift-selection): Use it.
	(deactivate-mark): Don't check for size of region.

	* mouse.el (mouse-drag-track): Use select-active-region.

2010-07-17  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-get-ls-command-with-dired): Make test for
	"--dired" stronger.

2010-07-17  Chong Yidong  <cyd@stupidchicken.com>

	* term/x-win.el (x-select-enable-primary): Change default to nil.
	(x-select-enable-clipboard): Add :version keyword.

	* mouse.el (mouse-drag-copy-region):
	* simple.el (select-active-regions): Likewise.

2010-07-16  Reiner Steib  <Reiner.Steib@gmx.de>

	* vc/vc.el (vc-coding-system-inherit-eol): New defvar.
	(vc-coding-system-for-diff): Use it to decide whether to inherit
	from the file the EOL format for reading the diffs of that file.
	(Bug#4451)

2010-07-16  Eli Zaretskii  <eliz@gnu.org>

	* mail/rmailmm.el (rmail-mime-save): Make the temp buffer
	unibyte, so compressed attachments are not compressed again.

2010-07-16  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-handle-shell-command): Don't use hard-wired
	"/bin/sh" but `tramp-remote-sh' from `tramp-methods'.
	(tramp-find-shell): Simplify setting connection property.
	(tramp-get-ls-command): Make test for "--color=never" stronger.

2010-07-15  Simon South  <ssouth@member.fsf.org>

	* progmodes/delphi.el (delphi-previous-indent-of): Indent case
	blocks within record declarations (i.e. variant parts) correctly.

2010-07-15  Simon South  <ssouth@member.fsf.org>

	* progmodes/delphi.el (delphi-token-at): Give newlines precedence
	over literal tokens when parsing so newlines aren't "absorbed" by
	single-line comments.  Corrects the indentation of case blocks
	that have a comment on the first line.

2010-07-14  Karl Fogel  <kfogel@red-bean.com>

	* bookmark.el (bookmark-load-hook): Fix doc string as suggested
	by Drew Adams (Bug#5504).

2010-07-14  Jan Djärv  <jan.h.d@swipnet.se>

	* xt-mouse.el (xterm-mouse-event-read): Fix for characters > 127
	now that Unicode is used (Bug#6594).

2010-07-14  Chong Yidong  <cyd@stupidchicken.com>

	* term/x-win.el (x-select-enable-clipboard): Default to t.
	(x-initialize-window-system): Don't overwrite Paste menu item.

	* simple.el (select-active-regions): Default to t.
	(push-mark-command): Don't overwrite primary with empty string.

	* mouse.el: Bind mouse-2 to mouse-yank-primary.
	(mouse-drag-copy-region): Default to nil.

	* menu-bar.el (menu-bar-enable-clipboard): Don't overwrite
	Cut/Copy/Paste menu bar items.

2010-07-13  Thierry Volpiatto  <thierry.volpiatto@gmail.com>

	Allow C-w when setting a bookmark in a Gnus Article buffer (Bug#5975).
	Patch applied by Karl Fogel.

	* bookmark.el (bookmark-set): Don't set `bookmark-yank-point'
	and `bookmark-current-buffer' if they have been already set in
	another buffer (e.g gnus-art).

2010-07-13  Karl Fogel  <kfogel@red-bean.com>
            Thierry Volpiatto  <thierry.volpiatto@gmail.com>

	Preparation for setting bookmarks in Gnus article buffers (Bug#5975).

	* bookmark.el (bookmark-make-record-default): Allow unneeded
	information to be omitted from the record.

	Adjust declarations and calls:

	* info.el (bookmark-make-record-default): Adjust declaration.
	(Info-bookmark-make-record): Adjust call.

	* woman.el (bookmark-make-record-default): Adjust declaration.
	(woman-bookmark-make-record): Adjust call.

	* man.el (bookmark-make-record-default): Adjust declaration.
	(Man-bookmark-make-record): Adjust call.

	* image-mode.el (bookmark-make-record-default): Adjust declaration.

	* doc-view.el (bookmark-make-record-default): Adjust declaration.

2010-07-13  Karl Fogel  <kfogel@red-bean.com>

	* bookmark.el (bookmark-show-annotation): Use `when' instead of `if'.
	This is also from Thierry Volpiatto's patch in bug #6444.  However,
	because it was extraneous to the functional change in that patch,
	and causes a re-indendation, I am committing it separately.

2010-07-13  Thierry Volpiatto  <thierry.volpiatto@gmail.com>

	* bookmark.el (bookmark-show-annotation): Ensure annotations show,
	e.g. in Info bookmarks, by using `switch-to-buffer-other-window'.
	Patch applied by Karl Fogel (Bug#6444).

2010-07-13  Chong Yidong  <cyd@stupidchicken.com>

	* frame.el (make-frame): Fix typo in 2010-06-30 change (Bug#6625).

2010-07-13  Adrian Robert  <Adrian.B.Robert@gmail.com>

	* term/ns-win.el: Bind M-~ to 'ns-prev-frame (due to Matthew
	Dempsky; bug#5084).  Remove incorrect binding for S-tab.
	(ns-alternatives-map): Change S-tab binding to backtab
	(bug#6616).

	* simple.el (normal-erase-is-backspace-setup-frame): Set mode on
	under ns.

2010-07-12  Andreas Schwab  <schwab@linux-m68k.org>

	* language/tai-viet.el ("TaiViet"): Try to fix re-encoding bugs.
	(Bug#5806)

	* language/tv-util.el (tai-viet-re): Remove format.

2010-07-12  Kenichi Handa  <handa@m17n.org>

	* language/hebrew.el: Remove no-byte-compile declaration.
	Change coding: tag to utf-8.  Register hebrew-shape-gstring in
	composition-function-table for 3-character looking back.
	(hebrew-font-get-precomposed): New function.
	(hebrew-shape-gstring): Utilize precomposed glyphs if available.

2010-07-11  Chong Yidong  <cyd@stupidchicken.com>

	* mouse.el (mouse-drag-track): Handle select-active-regions
	(Bug#6612).

2010-07-11  Magnus Henoch  <magnus.henoch@gmail.com>

	* net/tramp-gvfs.el (tramp-gvfs-handle-copy-file): Do not pass
	empty argument to gvfs-copy.

2010-07-10  Glenn Morris  <rgm@gnu.org>

	* calendar/calendar.el (calendar-week-end-day): New function.
	* calendar/cal-tex.el (cal-tex-cursor-month): Remove unused vars.
	Respect calendar-week-start-day.  (Bug#6606)
	(cal-tex-insert-day-names, cal-tex-insert-blank-days)
	(cal-tex-insert-blank-days-at-end): Respect calendar-week-start-day.
	(cal-tex-first-blank-p, cal-tex-last-blank-p): Simplify, and
	respect calendar-week-start-day.

2010-07-10  Chong Yidong  <cyd@stupidchicken.com>

	* simple.el (use-region-p): Doc fix (Bug#6607).

2010-07-10  Aleksei Gusev  <aleksei.gusev@gmail.com>  (tiny change)

	* progmodes/compile.el (compilation-error-regexp-alist-alist): Add
	regexps for cucumber and ruby.

2010-07-08  Daiki Ueno  <ueno@unixuser.org>

	* epa-file.el (epa-file-error, epa-file--find-file-not-found-function)
	(epa-file-insert-file-contents): Hack to prevent
	find-file from opening empty buffer when decryption failed
	(bug#6568).

2010-07-07  Agustín Martín  <agustin.martin@hispalinux.es>

	* textmodes/ispell.el (ispell-alternate-dictionary):
	Use file-readable-p.
	Return nil if no word-list is found at default locations.
	(ispell-complete-word-dict): Default to nil.
	(ispell-command-loop): Use 'word-list' when using lookup-words.
	(lookup-words): Use ispell-complete-word-dict or
	ispell-alternate-dictionary.  Check for word-list availability
	and handle errors if needed with better messages (Bug#6539).
	(ispell-complete-word): Use ispell-complete-word-dict or
	ispell-alternate-dictionary.

2010-07-07  Christoph Scholtes  <cschol2112@gmail.com>

	* progmodes/python.el (python-font-lock-keywords): Add Python 2.7
	builtins (BufferError, BytesWarning, WindowsError; callables
	bin, bytearray, bytes, format, memoryview, next, print; __package__).

2010-07-07  Glenn Morris  <rgm@gnu.org>

	* play/zone.el (top-level): Do not require timer, tabify, or cl.
	(zone-shift-left): Ignore intangibility, and any errors from
	forward-char.
	(zone-shift-right): Remove no-op end-of-line.  Ignore intangibility.
	(zone-pgm-putz-with-case): Use upcase-region rather than inserting,
	deleting, and copying text properties.
	(zone-line-specs, zone-pgm-stress): Check forward-line exit status.
	(zone-pgm-rotate): Handle odd buffers like that of gomoku, where getting
	to point-max is hard.
	(zone-fret, zone-fill-out-screen): Replace cl's do with dotimes.
	(zone-fill-out-screen): Ignore intangibility.

2010-07-05  Chong Yidong  <cyd@stupidchicken.com>

	* menu-bar.el (menu-bar-mode):
	* tool-bar.el (tool-bar-mode): Replace default-frame-alist element
	if it has been set.

	* mouse.el (mouse-drag-track): Call mouse-start-end to handle
	word/line selection (Bug#6565).

2010-07-04  Juanma Barranquero  <lekktu@gmail.com>

	* net/dbus.el (dbus-send-signal): Declare function.

2010-07-04  Michael Albinus  <michael.albinus@gmx.de>

	* net/dbus.el: Implement signal "PropertiesChanged" (from D-Bus 1.3.1).
	(dbus-register-property): New optional argument EMITS-SIGNAL.
	(dbus-property-handler): Send signal "PropertiesChanged" if requested.

2010-07-03  Chong Yidong  <cyd@stupidchicken.com>

	* mouse.el (mouse-drag-overlay): Variable deleted.
	(mouse-move-drag-overlay, mouse-show-mark): Functions deleted.
	(mouse--remap-link-click-p): New function.
	(mouse-drag-track): Handle dragging by using temporary Transient
	Mark mode, instead of a special overlay.
	(mouse-kill-ring-save, mouse-save-then-kill): Don't call
	mouse-show-mark.

	* mouse-sel.el (mouse-sel-selection-alist): mouse-drag-overlay
	deleted.

2010-07-02  Juri Linkov  <juri@jurta.org>

	* autoinsert.el (auto-insert-alist): Fix readability
	by using dotted pair notation for lambda.

2010-07-02  Juri Linkov  <juri@jurta.org>

	* faces.el (read-face-name): Rename arg `string-describing-default'
	to `default'.  Doc fix.  Display the default value in quotes
	in the prompt.  With empty input, return the `default' arg,
	unless the default value is a string (in which case return nil).
	(describe-face): Replace the string `default' arg of `read-face-name'
	with the symbol `default'.

2010-07-02  Chong Yidong  <cyd@stupidchicken.com>

	* emulation/viper-cmd.el (viper-delete-backward-char)
	(viper-del-backward-char-in-insert)
	(viper-del-backward-char-in-replace, viper-change)
	(viper-backward-indent): Replace delete-backward-char with
	delete-char (Bug#6552).

2010-07-01  Chong Yidong  <cyd@stupidchicken.com>

	* ruler-mode.el (ruler--save-header-line-format): Fix typos.

2010-06-30  Chong Yidong  <cyd@stupidchicken.com>

	* frame.el (make-frame): Add default-frame-alist to the PARAMETERS
	argument passed to frame-creation-function (Bug#5378).

	* faces.el (x-handle-named-frame-geometry)
	(x-handle-reverse-video, x-create-frame-with-faces)
	(face-set-after-frame-default, tty-create-frame-with-faces): Don't
	separately consult default-frame-alist.  It is now passed as the
	PARAMETER argument.

2010-06-30  Andreas Schwab  <schwab@linux-m68k.org>

	* startup.el (command-line): Don't call tool-bar-setup in a
	tty-only build.

2010-06-30  Chong Yidong  <cyd@stupidchicken.com>

	* ruler-mode.el (ruler--save-header-line-format): New fun.
	(ruler-mode): Use it as a setter function, so as not to overwrite
	ruler-mode-header-line-format-old if Ruler mode is on (Bug#5370).

2010-06-29  Chong Yidong  <cyd@stupidchicken.com>

	* vc/vc.el (vc-deduce-backend): New fun.  Handle diff buffers.
	(vc-root-diff, vc-print-root-log, vc-log-incoming)
	(vc-log-outgoing): Use it.
	(vc-diff-internal): Set diff-vc-backend.

	* vc/diff-mode.el (diff-vc-backend): New var.

2010-06-28  Jan Djärv  <jan.h.d@swipnet.se>

	* dynamic-setting.el (font-setting-change-default-font): Remove
	call to message.

2010-06-28  Kenichi Handa  <handa@m17n.org>

	* international/quail.el (quail-insert-kbd-layout): Fix the
	showing of untranslated characters.

2010-06-28  Chong Yidong  <cyd@stupidchicken.com>

	* simple.el (delete-active-region): New option.
	(delete-backward-char): Implement in Lisp.
	(delete-forward-char): New command.

	* mouse.el (mouse-region-delete-keys): Deleted.
	(mouse-show-mark): Simplify.

	* bindings.el (global-map): Bind delete and DEL, the former to
	delete-forward-char.

2010-06-27  Lennart Borgman  <lennart.borgman@gmail.com>

	* progmodes/ruby-mode.el (ruby-mode-map): Don't bind TAB.
	(ruby-mode): Bind indent-line-function (Bug#5119).

2010-06-27  Chong Yidong  <cyd@stupidchicken.com>

	* startup.el (command-line): Recognize "0" X resource value.

2010-06-27  Chong Yidong  <cyd@stupidchicken.com>

	* startup.el (command-line): Use X resources to set the value of
	menu-bar-mode and tool-bar-mode, before calling frame-initialize.

	* menu-bar.el (menu-bar-mode):
	* tool-bar.el (tool-bar-mode): Don't change default-frame-alist.
	Set init-value to t.

	* frame.el (frame-notice-user-settings): Don't change
	default-frame-alist based on menu-bar-mode and tool-bar-mode, or
	vice versa (Bug#2249).

2010-06-26  Eli Zaretskii  <eliz@gnu.org>

	* w32-fns.el (w32-convert-standard-filename): Doc fix.

2010-06-25  Agustín Martín  <agustin.martin@hispalinux.es>

	* textmodes/flyspell.el (flyspell-check-previous-highlighted-word):
	Make sure `flyspell-word' re-checks word after function run (Bug#6504).

	* textmodes/ispell.el (ispell-init-process): Make sure ispell and
	default directories are expanded (Bug#6143).

2010-06-24  Juri Linkov  <juri@jurta.org>

	* minibuffer.el (completions-format): Change default from nil to
	`horizontal'.  Remove `nil' value from :type.  Doc fix.  (Bug#6459)

2010-06-24  Juri Linkov  <juri@jurta.org>

	* vc/vc.el (vc-diff-internal): Set `revert-buffer-function'
	buffer-locally to lambda that re-runs the vc diff command.
	(Bug#6447)

2010-06-24  Chong Yidong  <cyd@stupidchicken.com>

	* kmacro.el (kmacro-call-macro): Don't issue hint message if the
	echo area is in use (Bug#3412).

2010-06-22  Glenn Morris  <rgm@gnu.org>

	* textmodes/texinfmt.el (texinfo-format-region)
	(texinfo-raise-lower-sections, texinfo-format-separate-node)
	(texinfo-itemize-item, texinfo-multitable-item, texinfo-alias)
	(texinfo-format-option, texinfo-noindent):
	Use line-beginning-position and line-end-position.

	* calc/calc-aent.el, calc/calc-ext.el, calc/calc-lang.el:
	* calc/calc-store.el, calc/calc-units.el, calc/calc.el:
	* calc/calccomp.el: Add explicit utf-8 coding cookies to files with
	utf-8 characters.

2010-06-21  Karl Fogel  <kfogel@red-bean.com>

	* play/zone.el (zone-fall-through-ws): Fix next-line ->
	forward-line fallout.

2010-07-06  Chong Yidong  <cyd@stupidchicken.com>

	* mouse.el (mouse-appearance-menu): Add docstring.

	* help.el (describe-key): Print up-event using key-description.

2010-07-03  Michael Albinus  <michael.albinus@gmx.de>

	* net/zeroconf.el (zeroconf-resolve-service)
	(zeroconf-service-resolver-handler): Use `dbus-byte-array-to-string'.
	(zeroconf-publish-service): Use `dbus-string-to-byte-array'.

2010-07-03  Jan Moringen  <jan.moringen@uni-bielefeld.de>

	* net/zeroconf.el (zeroconf-service-remove-hook): New defun.

2010-06-30  Dan Nicolaescu  <dann@ics.uci.edu>

	Avoid displaying files with a nil state in vc-dir.
	* vc/vc-dir.el (vc-dir-update): Obey the noinsert argument in all
	cases that cause insertion.
	(vc-dir-resynch-file): Tell vc-dir-update to avoid inserting files
	with a nil state.

2010-06-30  Chong Yidong  <cyd@stupidchicken.com>

	* xml.el (xml-parse-region): Avoid infloop (Bug#5281).

2010-06-29  Leo  <sdl.web@gmail.com>

	* emacs-lisp/rx.el (rx): Doc fix.  (Bug#6537)

2010-06-27  Oleksandr Gavenko  <gavenkoa@gmail.com>  (tiny change)

	* generic-x.el (bat-generic-mode): Fix regexp for command line
	switches (Bug#5719).

2010-06-27  Masatake YAMATO  <yamato@redhat.com>

	* htmlfontify.el (hfy-face-attr-for-class): Use append instead
	of nconc to avoid pure storage error (Bug#6239).

2010-06-27  Christoph  <cschol2112@googlemail.com>  (tiny change)

	* bookmark.el (bookmark-bmenu-2-window, bookmark-bmenu-other-window)
	(bookmark-bmenu-other-window-with-mouse): Remove unnecessary
	bindings of bookmark-automatically-show-annotations (Bug#6515).

2010-06-25  Eli Zaretskii  <eliz@gnu.org>

	* arc-mode.el (archive-zip-extract): Don't quote the file name on
	MS-Windows and MS-DOS.  (Bug#6467, Bug#6144)

2010-06-24  Štěpán Němec  <stepnem@gmail.com>  (tiny change)

	* comint.el (make-comint, make-comint-in-buffer): Mention return
	value in the docstrings.  (Bug#6498)

2010-06-24  Yoni Rabkin  <yoni@rabkins.net>

	* bs.el (bs-mode-font-lock-keywords): Remove "by" from Dired pattern,
	since it is not present when using some non-default switches.

2010-06-23  Karl Fogel  <kfogel@red-bean.com>

	* simple.el (compose-mail): Fix doc string to refer to
	`compose-mail-user-agent-warnings', instead of to the
	nonexistent `compose-mail-check-user-agent'.

2010-06-21  Alan Mackenzie  <bug-cc-mode@gnu.org>

	Fix an indentation bug:

	* progmodes/cc-mode.el (c-common-init): Initialise c-new-BEG/END.
	(c-neutralize-syntax-in-and-mark-CPP): c-new-BEG/END: Take account
	of existing values.

	* progmodes/cc-engine.el (c-clear-<-pair-props-if-match-after)
	(c-clear->-pair-props-if-match-before): now return t when they've
	cleared properties, nil otherwise.
	(c-before-change-check-<>-operators): Set c-new-beg/end correctly
	by taking account of the existing value.

	* progmodes/cc-defs.el
	(c-clear-char-property-with-value-function): Fix this to clear the
	property rather than overwriting it with nil.

2010-06-20  Chong Yidong  <cyd@stupidchicken.com>

	* emacs-lisp/package.el (package-print-package): Add link to
	package description via describe-package.
	(describe-package-1): List package requirements.  Add button to
	perform installation.
	(package-menu-describe-package): New command.

	* help-mode.el (help-package): New button type.

2010-06-19  Chong Yidong  <cyd@stupidchicken.com>

	* emacs-lisp/package.el: Move package-list-packages binding to
	menu-bar.el.
	(describe-package, describe-package-1, package--dir): New funs.
	(package-activate-1): Use package--dir.

	* emacs-lisp/package-x.el (gnus-article-buffer): Require package.

	* help-mode.el (help-package-def): New button type.

	* menu-bar.el: Move package-list-packages binding here from
	package.el.

2010-06-19  Gustav Hållberg  <gustav@gmail.com>  (tiny change)

	* descr-text.el (describe-char): Avoid trailing whitespace.  (Bug#6423)

2010-06-18  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/edebug.el (edebug-read-list):
	Phase out old-style backquotes.

2010-06-17  Juri Linkov  <juri@jurta.org>

	* help-mode.el (help-mode): Set buffer-local variable
	revert-buffer-function to help-mode-revert-buffer.
	(help-mode-revert-buffer): New function.

	* info.el (Info-revert-find-node): Check for major-mode Info-mode
	before popping to "*info*" (like in other Info functions).
	Keep buffer-name in old-buffer-name.  Keep Info-history-forward in
	old-history-forward.  Pop to old-buffer-name or "*info*" to
	recreate the killed buffer.  Set Info-history-forward from
	old-history-forward.
	(Info-breadcrumbs-depth): Add :group and :version.

2010-06-17  Dan Nicolaescu  <dann@ics.uci.edu>

	* emacs-lisp/package.el (package-menu-mode-map): Add a menu.

2010-06-17  Agustín Martín  <agustin.martin@hispalinux.es>

	* textmodes/ispell.el (ispell-aspell-find-dictionary): Fix regexp
	for languages like Portuguese with pt_{BR,PT} and no plain pt.

2010-06-17  Juanma Barranquero  <lekktu@gmail.com>

	* emacs-lisp/package.el (package-menu-mode-map):
	Move initialization into declaration.

	* menu-bar.el (menu-bar-options-menu): Fix typo in menu entry.

2010-06-17  Chong Yidong  <cyd@stupidchicken.com>

	* emacs-lisp/package.el (package-archive-base): Point to
	elpa.gnu.org.
	(package-enable, package-load-list): New defcustoms.
	(package-user-dir, package-directory-list): Turn into defcustoms.
	Don't include package-user-dir in package-directory-list.
	(package--builtins-base): Don't include Emacs as a "package".
	(package-subdirectory-regexp): New var.
	(package-load-all-descriptors, package-compute-transaction)
	(package-download-transaction): Obey package-load-list.
	(package-activate-1): Rename from package-do-activate.
	(package-list-packages-internal): Check package-load-list.
	(package-load-descriptor, package-generate-autoloads)
	(package-unpack, package-unpack-single)
	(package--read-archive-file, package-delete): Use
	expand-file-name.

	* emacs-lisp/package-x.el: New file.  Package uploading
	functionality split out from package.el.

	* startup.el (command-line): Load packages after reading init file.

2010-06-17  Tom Tromey  <tromey@redhat.com>

	* emacs-lisp/package.el: New file.

2010-06-22  Dan Nicolaescu  <dann@ics.uci.edu>

	Fix vc-annotate for renamed files when using Git.
	* vc/vc-git.el (vc-git-find-revision): Deal with empty results from
	ls-files.  Doe not pass the object as a file name to cat-file, it
	is not a file name.
	(vc-git-annotate-command): Pass the file name using -- to avoid
	ambiguity with the revision.
	(vc-git-previous-revision): Pass a relative file name.

2010-06-22  Glenn Morris  <rgm@gnu.org>

	* progmodes/js.el (js-mode-map): Use standard capitalization and
	ellipses for menu entries.

	* wid-edit.el (widget-complete): Doc fix.

2010-06-22  Jürgen Hötzel  <juergen@hoetzel.info>  (tiny change)

	* wid-edit.el (widget-complete): Fix typo in 2009-12-02 change.

2010-06-22  Dan Nicolaescu  <dann@ics.uci.edu>

	Fix annotating other revisions for renamed files in vc-annotate.
	* vc/vc-annotate.el (vc-annotate): Add an optional argument for the
	VC backend.  Use it when non-nil.
	(vc-annotate-warp-revision): Pass the VC backend to vc-annotate.
	(Bug#6487)

	Fix vc-annotate-show-changeset-diff-revision-at-line for git.
	* vc/vc-annotate.el (vc-annotate-show-diff-revision-at-line-internal):
	Do not pass the file name to the 'previous-revision call when we
	don't want a file diff.  (Bug#6489)

2010-06-21  Dan Nicolaescu  <dann@ics.uci.edu>

	Fix finding revisions for renamed files in vc-annotate.
	* vc/vc.el (vc-find-revision): Add an optional argument for
	the VC backend.  Use it when non-nil.
	* vc/vc-annotate.el (vc-annotate-find-revision-at-line): Pass the VC
	backend to vc-find-revision.  (Bug#6487)

2010-06-21  Dan Nicolaescu  <dann@ics.uci.edu>

	Fix reading file names in Git annotate buffers.
	* vc/vc-git.el (vc-git-annotate-extract-revision-at-line):
	Remove trailing whitespace.  Suggested by Eric Hanchrow.  (Bug#6481)

2010-06-20  Alan Mackenzie  <acm@muc.de>

	* progmodes/cc-mode.el (c-before-hack-hook): When the mode is set
	in file local variables, set it first.

2010-06-19  Glenn Morris  <rgm@gnu.org>

	* descr-text.el (describe-char-unicode-data): Insert separating
	space when needed.  (Bug#6422)

	* progmodes/idlwave.el (idlwave-action-and-binding):
	Fix typo in 2009-12-03 change.  (Bug#6450)

2010-06-17  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/macroexp.el (macroexpand-all-1): Put back special
	handling for `lambda' (misunderstanding).

2010-06-16  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-poly.el (math-accum-factors): Make sure that
	constants aren't distributed after they are factored out.

2010-06-16  Juri Linkov  <juri@jurta.org>

	* facemenu.el (list-colors-display): Call `pop-to-buffer' before
	`list-colors-print'.  (Bug#6332)

	* subr.el (read-quoted-char): Fix up last change (bug#6290).

2010-06-16  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/macroexp.el (macroexpand-all-1): Don't handle `lambda'
	specially, since it's a macro.  Fix up wrong hint passed to maybe-cons.

	* font-lock.el (font-lock-major-mode): Rename from
	font-lock-mode-major-mode to distinguish it from
	global-font-lock-mode's own font-lock-mode-major-mode (bug#6135).
	(font-lock-set-defaults):
	* font-core.el (font-lock-default-function): Adjust users.
	(font-lock-mode): Don't set it at all.

2010-06-16  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc/vc-annotate.el (vc-annotate): Use vc-read-revision.

2010-06-16  Glenn Morris  <rgm@gnu.org>

	* calendar/appt.el (appt-time-msg-list): Doc fix.
	(appt-check): Let-bind appt-warn-time.
	(appt-add): Make the 3rd argument optional.
	Simplify argument names.  Doc fix.  Check for integer WARNTIME.
	Only add WARNTIME to the output list if non-nil.

2010-06-16  Ivan Kanis  <apple@kanis.eu>

	* calendar/appt.el (appt-check): Let the 3rd element of
	appt-time-msg-list specify the warning time.
	(appt-add): Add new argument with the warning time.  (Bug#5176)

2010-06-16  Bob Rogers  <rogers-emacs@rgrjr.dyndns.org>  (tiny change)

	* vc/vc-svn.el (vc-svn-after-dir-status): Fix regexp for Subversions
	older than version 1.6.  (Bug#6361)

2010-06-16  Helmut Eller  <eller.helmut@gmail.com>

	* emacs-lisp/cl-macs.el (destructuring-bind): Bind `bind-enquote',
	used by cl-do-arglist.  (Bug#6408)

2010-06-16  Agustín Martín  <agustin.martin@hispalinux.es>

	* textmodes/ispell.el (ispell-dictionary-base-alist): Fix
	portuguese casechars/not-casechars for missing 'çÇ'.
	Suggested by Rolando Pereira (bug#6434).

2010-06-15  Juanma Barranquero  <lekktu@gmail.com>

	* facemenu.el (list-colors-sort): Doc fix.

2010-06-15  Bob Rogers  <rogers-emacs@rgrjr.dyndns.org>  (tiny change)

	* progmodes/sql.el (sql-connect-mysql): Fix typo.

2010-06-14  Juri Linkov  <juri@jurta.org>

	Add sort option `list-colors-sort'.  (Bug#6332)
	* facemenu.el (color-rgb-to-hsv): New function.
	(list-colors-sort): New defcustom.
	(list-colors-sort-key): New function.
	(list-colors-display): Doc fix.  Sort list according to the option
	`list-colors-sort'.
	(list-colors-print): Add HSV values to `help-echo' property of
	RGB strings.

2010-06-14  Juri Linkov  <juri@jurta.org>

	* compare-w.el: Move to the "vc" subdirectory.

2010-06-14  Stefan Monnier  <monnier@iro.umontreal.ca>

	* image-mode.el (image-mode-map): Remap left-char and right-char.

	* nxml/nxml-mode.el (nxml-indent-line): Standardize indent behavior.

2010-06-12  Chong Yidong  <cyd@stupidchicken.com>

	* term/common-win.el (x-colors): Add all the color names defined
	in rgb.txt (Bug#6332).

	* facemenu.el (list-colors-print): Don't print extra names if it
	will overflow the window width.

	* vc/log-edit.el (log-edit-font-lock-keywords): Revert 2010-06-02
	change (Bug#6343).

2010-06-12  Eli Zaretskii  <eliz@gnu.org>

	* files.el (make-directory): Doc fix (bug#6396).

2010-06-12  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-remote-process-environment): Protect version
	string by apostroph.
	(tramp-shell-prompt-pattern): Do not use a shy group in case of
	XEmacs.
	(tramp-file-name-for-operation): Add `call-process-region'.
	(tramp-set-process-query-on-exit-flag): Fix wrong parentheses.

	* net/tramp-compat.el (top): Do not autoload
	`tramp-handle-file-remote-p'.  Load tramp-util.el and tramp-vc.el
	only when `start-file-process' is not bound.
	(tramp-advice-file-expand-wildcards): Do not use
	`tramp-handle-file-remote-p'.
	(tramp-compat-make-temp-file): Handle the case, that
	`make-temp-file' has no third argument EXTENSION.

2010-06-11  Juanma Barranquero  <lekktu@gmail.com>

	* makefile.w32-in (WINS_BASIC): Include new directory vc.

	* loadup.el ("vc-hooks", "ediff-hook"): Load from lisp/vc/.

2010-06-11  Juri Linkov  <juri@jurta.org>

	* finder.el (finder-known-keywords): Add keyword "vc"
	for version control.

	* add-log.el, cvs-status.el, diff.el, diff-mode.el, ediff.el,
	* emerge.el, log-edit.el, log-view.el, pcvs.el, smerge-mode.el,
	* vc-annotate.el, vc-bzr.el, vc-dir.el, vc-dispatcher.el, vc-git.el,
	* vc-hg.el, vc-mtn.el, vc.el: Add keyword "vc".

2010-06-11  Juri Linkov  <juri@jurta.org>

	Move version control related files to the "vc" subdirectory.
	* add-log.el, cvs-status.el, diff.el, diff-mode.el, ediff-diff.el,
	* ediff.el, ediff-help.el, ediff-hook.el, ediff-init.el,
	* ediff-merg.el, ediff-mult.el, ediff-ptch.el, ediff-util.el,
	* ediff-vers.el, ediff-wind.el, emerge.el, log-edit.el, log-view.el,
	* pcvs-defs.el, pcvs.el, pcvs-info.el, pcvs-parse.el, pcvs-util.el,
	* smerge-mode.el, vc-annotate.el, vc-arch.el, vc-bzr.el, vc-cvs.el,
	* vc-dav.el, vc-dir.el, vc-dispatcher.el, vc.el, vc-git.el,
	* vc-hg.el, vc-hooks.el, vc-mtn.el, vc-rcs.el, vc-sccs.el, vc-svn.el:
	Move files to the "vc" subdirectory.

2010-06-11  Chong Yidong  <cyd@stupidchicken.com>

	* comint.el (comint-password-prompt-regexp): Fix 2010-04-10 change
	(Bug#6367).

2010-06-11  Stephen Eglen  <stephen@gnu.org>

	* shell.el: Bind `shell-resync-dirs' to M-RET.

2010-06-10  Michael Albinus  <michael.albinus@gmx.de>

	* notifications.el: Move file from lisp/net, because it is
	supposed to talk locally to the user.

2010-06-10  Julien Danjou  <julien@danjou.info>

	* net/notifications.el (notifications-on-action-signal)
	(notifications-on-closed-signal): Pass notification id as first
	argument to the callback functions.  Add docstrings.
	(notifications-notify): Fix docstring.

2010-06-10  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/authors.el (authors-ignored-files)
	(authors-valid-file-names): Add some files.

2010-06-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* net/rcirc.el (rcirc-server-alist, rcirc, rcirc-connect): Resolve
	merge conflict, giving preference to the emacs-23 version of the code.

2010-06-09  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/advice.el (ad-compile-function):
	Define warning-suppress-types before we let-bind it (bug#6275).

	* vc-dispatcher.el: Rename mode-line-hook to vc-mode-line-hook;
	declare it, make it buffer-local and permanent-local (bug#6324).
	(vc-resynch-window): Adjust name.
	* vc-hooks.el (vc-find-file-hook): Adjust name.

2010-06-09  Michael Albinus  <michael.albinus@gmx.de>

	* net/notifications.el (notifications-notify): Fix docstring.

2010-06-09  Juanma Barranquero  <lekktu@gmail.com>

	Update to Unicode 6.0.0 beta.
	* international/charprop.el: Update copyright.
	* international/mule-cmds.el (ucs-names): Update character ranges.
	* international/uni-bidi.el:
	* international/uni-category.el:
	* international/uni-combining.el:
	* international/uni-comment.el:
	* international/uni-decimal.el:
	* international/uni-decomposition.el:
	* international/uni-digit.el:
	* international/uni-lowercase.el:
	* international/uni-mirrored.el:
	* international/uni-name.el:
	* international/uni-numeric.el:
	* international/uni-old-name.el:
	* international/uni-titlecase.el:
	* international/uni-uppercase.el: Regenerate.

2010-06-09  Juanma Barranquero  <lekktu@gmail.com>

	* emacs-lisp/smie.el (comment-string-strip): Declare function.
	(smie-precs-precedence-table): Fix typo in docstring.

	* vc-mtn.el (log-edit-extract-headers): Declare function.

	* vc-hg.el (log-edit-extract-headers): Remove duplicate declaration.

	* net/notifications.el (dbus-register-signal): Declare function.
	(notifications-notify): Fix typos and reflow docstring.

2010-06-09  Dan Nicolaescu  <dann@ics.uci.edu>

	Improve VC create/retrieve tag/branch.
	* vc.el (vc-create-tag): Do not read the directory name for VCs
	with repository revision granularity.  Adjust the tag/branch
	prompt.  Reset VC properties.
	(vc-retrieve-tag): Do not read the directory name for VCs
	with repository revision granularity.  Reset VC properties.

2010-06-09  Julien Danjou  <julien@danjou.info>

	* net/notifications.el: New file.

2010-06-09  Dan Nicolaescu  <dann@ics.uci.edu>

	Add optional support for resetting VC properties.
	* vc-dispatcher.el (vc-resynch-window): Add new optional argument,
	call vc-file-clearprops when true.
	(vc-resynch-buffer): Add new optional argument, pass it down.
	(vc-resynch-buffers-in-directory): Likewise.

	Improve support for special markup in the VC commit message.
	* vc-mtn.el (vc-mtn-checkin): Add support for Author: and Date: markup.
	* vc-hg.el (vc-hg-checkin): Add support for Date:.
	* vc-git.el (vc-git-checkin):
	* vc-bzr.el (vc-bzr-checkin): Likewise.

2010-06-09  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/smie.el (smie-indent-keyword): Remove special case that
	can be handled with a ((:before "fn") (:prev "=>" parent)) rule.

2010-06-07  Martin Pohlack  <mp26@os.inf.tu-dresden.de>

	* iimage.el: Remove images as soon as the underlying text is modified.
	(iimage-modification-hook): New function.
	(iimage-mode-buffer): Use it.

2010-06-07  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/smie.el (smie-indent-offset-rule): Rename from
	smie-indent-offset-after.  Add :prev case.  Make a bit more generic.
	(smie-indent-virtual): Remove `virtual' arg.  Update callers.
	(smie-indent-keyword): Add handling of open-paren keywords.
	(smie-indent-comment-continue): Don't assume comment-continue.

2010-06-07  Martin Rudalics  <rudalics@gmx.at>

	* window.el (pop-to-buffer): Remove the conditional that
	compares new-window and old-window, so it will reselect
	the selected window unconditionally.
	http://lists.gnu.org/archive/html/emacs-devel/2010-06/msg00078.html

2010-06-07  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/smie.el (smie-indent-offset-after)
	(smie-indent-forward-token, smie-indent-backward-token): New functions.
	(smie-indent-after-keyword): Use them.
	(smie-indent-fixindent): Only applies to the indentation of the BOL.
	(smie-indent-keyword): Tweak the black magic.
	(smie-indent-comment-continue): Strip comment-continue before use.
	(smie-indent-functions): Indent comments before keywords.

2010-06-06  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-lazy-highlight-search): Fix looping
	by checking for empty match.  This syncs this loop with the
	similar loop in `isearch-search'.  (Bug#6362)

2010-06-05  Juanma Barranquero  <lekktu@gmail.com>

	* net/dbus.el (dbus-register-method): Declare function.
	(dbus-handle-event, dbus-property-handler): Fix typos in docstrings.
	(dbus-introspect): Doc fix.
	(dbus-event-bus-name, dbus-introspect-get-interface)
	(dbus-introspect-get-argument): Reflow docstrings.

2010-06-05  Dan Nicolaescu  <dann@ics.uci.edu>

	vc-log-incoming/vc-log-outgoing fixes for Git.
	* vc-git.el (vc-git-log-view-mode): Fix font lock for
	incoming/outgoing logs.
	(vc-git-log-outgoing, vc-git-log-incoming): Use @{upstream}
	instead of vc-git-compute-remote.
	(vc-git-compute-remote): Remove.

2010-06-04  Chong Yidong  <cyd@stupidchicken.com>

	* term/common-win.el (x-colors): Add "dark green" and "dark
	turquoise" (Bug#6332).

2010-06-04  Juri Linkov  <juri@jurta.org>

	* simple.el (kill-new): Fix logic of kill-do-not-save-duplicates.
	Instead of setting `replace' to t and replacing the same string
	with itself, don't do certain actions when
	kill-do-not-save-duplicates is non-nil and string is equal to car
	of kill-ring: don't call menu-bar-update-yank-menu, don't push
	interprogram-paste strings to kill-ring, and don't push the input
	argument `string' to kill-ring.
	http://lists.gnu.org/archive/html/emacs-devel/2010-06/msg00072.html

2010-06-04  Juanma Barranquero  <lekktu@gmail.com>

	* subr.el (directory-sep-char): Move from fileio.c and make a defconst.

2010-06-04  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-gvfs.el (tramp-gvfs-handle-expand-file-name): Expand "~/".
	(tramp-gvfs-handler-mounted-unmounted)
	(tramp-gvfs-connection-mounted-p): Handle default-location.

	* net/tramp-smb.el (tramp-smb-handle-delete-directory): Don't try to
	move files to trash.

2010-06-04  Juanma Barranquero  <lekktu@gmail.com>

	* international/mule-cmds.el (nonascii-insert-offset)
	(nonascii-translation-table): Add obsolescence information.

	* international/mule.el (make-translation-table-from-vector): Doc fix.

2010-06-03  Glenn Morris  <rgm@gnu.org>

	* desktop.el (desktop-clear-preserve-buffers):
	Add "*Warnings*" buffer.  (Bug#6336)

2010-06-03  Dan Nicolaescu  <dann@ics.uci.edu>

	vc-log-incoming/vc-log-outgoing improvements for Git.
	* vc-git.el (vc-git-log-outgoing): Use the same format as the
	short log.
	(vc-git-log-incoming): Likewise.  Run "git fetch" before the log command.

	Add bindings for vc-log-incoming and vc-log-outgoing.
	* vc-hooks.el (vc-prefix-map): Add bindings for vc-log-incoming
	and vc-log-outgoing.
	* vc-dir.el (vc-dir-menu-map): Add menu bindings for vc-log-incoming
	and vc-log-outgoing.

2010-06-03  Chong Yidong  <cyd@stupidchicken.com>

	* net/rcirc.el (rcirc-sort-nicknames): Remove.
	(rcirc-handler-366): Always sort nicknames.

2010-06-03  Juanma Barranquero  <lekktu@gmail.com>

	* emacs-lisp/smie.el (comment-continue): Declare for byte-compiler.

2010-06-03  Chong Yidong  <cyd@stupidchicken.com>

	* net/rcirc.el (rcirc-nickname<, rcirc-sort-nicknames-join): Doc fix.

2010-06-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	* net/rcirc.el (rcirc-sort-nicknames): Change default.
	(rcirc-sort-nicknames-join): Avoid setq.

2010-06-03  Deniz Dogan  <deniz.a.m.dogan@gmail.com>

	* net/rcirc.el (rcirc-sort-nicknames): New custom.
	(rcirc-nickname<, rcirc-sort-nicknames-join): New funs.
	(rcirc-handler-366): Use them.

2010-06-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	Split smie-indent-calculate into more manageable chunks.
	* emacs-lisp/smie.el (smie-indent-virtual, smie-indent-fixindent)
	(smie-indent-comment, smie-indent-after-keyword, smie-indent-keyword)
	(smie-indent-close, smie-indent-comment-continue, smie-indent-bob)
	(smie-indent-exps): Extract from smie-indent-calculate.
	(smie-indent-functions): New var.
	(smie-indent-functions): Use them.

2010-06-02  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/smie.el (smie-indent-hanging-p): Use smie-bolp.
	(smie-indent-calculate): Simplify and cleanup.

2010-06-02  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-gvfs.el (top): Require url-util.
	(tramp-gvfs-mount-point): Remove.
	(tramp-gvfs-stringify-dbus-message, tramp-gvfs-send-command):
	New defuns.
	(with-tramp-dbus-call-method): Format trace message.
	(tramp-gvfs-handle-copy-file, tramp-gvfs-handle-rename-file):
	Implement backup call, when operation on local files fails.
	Use progress reporter.  Flush properties of changed files.
	(tramp-gvfs-handle-make-directory): Make more traces.
	(tramp-gvfs-url-file-name): Hexify file name in url.
	(tramp-gvfs-fuse-file-name): Take also prefix (like dav shares)
	into account for the resulting file name.
	(tramp-gvfs-handler-askquestion): Return dummy mountpoint, when
	the answer is "no".  See `tramp-gvfs-maybe-open-connection'.
	(tramp-gvfs-handler-mounted-unmounted)
	(tramp-gvfs-connection-mounted-p): Test also for new mountspec
	attribute "default_location".  Set "prefix" property.
	(tramp-gvfs-mount-spec): Return both prefix and mountspec.
	(tramp-gvfs-maybe-open-connection): Test, whether mountpoint
	exists.  Raise an error, if not (due to a corresponding answer
	"no" in interactive questions, for example).

2010-06-02  Dan Nicolaescu  <dann@ics.uci.edu>

	* log-edit.el (log-edit-font-lock-keywords): Make group 4 match lax.

2010-06-01  Juanma Barranquero  <lekktu@gmail.com>

	* emacs-lisp/eldoc.el: Add completions for new commands left-* and
	right-*.  (Bug#6265)

2010-06-01  Dan Nicolaescu  <dann@ics.uci.edu>

	Add support for vc-log-incoming, improve vc-log-outgoing for Git.
	* vc-git.el (vc-git-compute-remote): New function.
	(vc-git-log-outgoing): Use it instead of hard coding a value.
	(vc-git-log-incoming): New function.

	Improve state updating for VC tag commands.
	* vc.el (vc-create-tag, vc-retrieve-tag): Call vc-resynch-buffer
	to update the state of all buffers in the directory.

	* vc-dir.el (vc-dir-update): Remove entries with a nil state (bug#5539).

2010-06-01  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-bzr.el (vc-bzr-revision-completion-table): Apply
	`file-directory-p' to the filename part rather than to the whole text.

2010-05-31  Stefan Monnier  <monnier@iro.umontreal.ca>

	* man.el (Man-completion-table): Let the user type "-k " (bug#6319).

2010-05-31  Drew Adams  <drew.adams@oracle.com>

	* files.el (directory-files-no-dot-files-regexp): Doc fix (bug#6298).

2010-05-31  Juanma Barranquero  <lekktu@gmail.com>

	* subr.el (momentary-string-display): Just use read-event to read
	the exit event (Bug#6238).

2010-05-30  Eli Zaretskii  <eliz@gnu.org>

	* international/mule.el (define-coding-system): Doc fix (bug#6313).

2010-05-30  Juanma Barranquero  <lekktu@gmail.com>

	* emulation/cua-base.el: Recognize also `right-word' and `left-word'.
	Suggested by Eli Zaretskii <eliz@gnu.org>.

2010-05-30  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuffer.el (completion-file-name-table): Don't return a boundary
	past the end of `string' (bug#6299).
	(completion--file-name-table): Delegate to completion-file-name-table
	for the `boundaries' case.

2010-05-30  Juanma Barranquero  <lekktu@gmail.com>

	* emulation/cua-base.el: Recognize `right-char' and `left-char' as
	movement commands.

	* progmodes/ada-xref.el (ada-prj-ada-project-path-sep): Set from
	`path-separator', but maintain compatibility with Emacs 20.2.

2010-05-29  Chong Yidong  <cyd@stupidchicken.com>

	* server.el (server-process-filter): Receive parent-id argument
	from emacsclient.
	(server-create-window-system-frame): New arg.  Pass parent-id as
	frame parameter.

2010-05-29  Eli Zaretskii  <eliz@gnu.org>

	Bidi-sensitive word movement with arrow keys.
	* subr.el (right-arrow-command, left-arrow-command): Move to
	bindings.el.

	* bindings.el (right-char, left-char): Move from subr.el and
	rename from right-arrow-command and left-arrow-command.
	(right-word, left-word): New functions.
	(global-map) <right>: Bind to right-char.
	(global-map) <left>: Bind to left-char.
	(global-map) <C-right>: Bind to right-word.
	(global-map) <C-left>: Bind to left-word.

	* ls-lisp.el (ls-lisp-classify-file): New function.
	(ls-lisp-insert-directory): Call it if switches include -F (bug#6294).
	(ls-lisp-classify): Call ls-lisp-classify-file.
	(insert-directory): Remove blanks from switches.

2010-05-29  Chong Yidong  <cyd@stupidchicken.com>

	* ansi-color.el: Delete unused escape sequences (Bug#6085).
	(ansi-color-drop-regexp): New constant.
	(ansi-color-apply, ansi-color-filter-region)
	(ansi-color-apply-on-region): Delete unrecognized control sequences.
	(ansi-color-apply): Build string list before calling concat.

2010-05-28  Juri Linkov  <juri@jurta.org>

	* image-dired.el (image-dired-dired-toggle-marked-thumbs):
	Replace LOCALP arg of `dired-get-filename' 'no-dir with nil.
	(Bug#5270)

2010-05-28  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-debug-message): Add `tramp-compat-funcall'
	to ignored backtrace functions.
	(with-progress-reporter): Expand docstring.
	(tramp-handle-delete-file): Implement TRASH argument.
	(tramp-get-remote-trash): New defun.

2010-05-28  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-compat.el (tramp-compat-delete-file): Use
	`symbol-value' for backward compatibility.

	* net/tramp.el (tramp-handle-make-symbolic-link)
	(tramp-handle-load)
	(tramp-do-copy-or-rename-file-via-buffer)
	(tramp-do-copy-or-rename-file-directly)
	(tramp-do-copy-or-rename-file-out-of-band)
	(tramp-handle-process-file, tramp-handle-call-process-region)
	(tramp-handle-shell-command, tramp-handle-file-local-copy)
	(tramp-handle-insert-file-contents, tramp-handle-write-region)
	(tramp-delete-temp-file-function): Use `delete-file' instead
	of `tramp-compat-delete-file'.

	* net/tramp-fish.el (tramp-fish-handle-delete-directory)
	(tramp-fish-handle-make-symbolic-link)
	(tramp-fish-handle-process-file): Use `delete-file' instead
	of `tramp-compat-delete-file'.

	* net/tramp-ftp.el (tramp-ftp-file-name-handler): Use
	`delete-file' instead of `tramp-compat-delete-file'.

	* net/tramp-gvfs.el (tramp-gvfs-handle-delete-file): Rename arg.
	(tramp-gvfs-handle-write-region): Use `delete-file' instead of
	`tramp-compat-delete-file'.

	* net/tramp-imap.el (tramp-imap-do-copy-or-rename-file): Use
	`delete-file' instead of `tramp-compat-delete-file'.

	* net/tramp-smb.el (tramp-smb-handle-copy-file)
	(tramp-smb-handle-file-local-copy, tramp-smb-handle-rename-file)
	(tramp-smb-handle-write-region): Use `delete-file' instead of
	`tramp-compat-delete-file'.
	(tramp-smb-handle-delete-directory): Use 'trash as arg.

2010-05-27  Chong Yidong  <cyd@stupidchicken.com>

	* dired.el (dired-delete-file): New arg TRASH.
	(dired-internal-do-deletions): New arg TRASH.  Use progress reporter.
	(dired-do-flagged-delete, dired-do-delete): Use trash.

	* speedbar.el (speedbar-item-delete): Allow trashing.

	* files.el (delete-directory): New arg TRASH.

	* net/ange-ftp.el (ange-ftp-del-tmp-name, ange-ftp-delete-file)
	(ange-ftp-rename-remote-to-remote)
	(ange-ftp-rename-local-to-remote)
	(ange-ftp-rename-remote-to-local, ange-ftp-load)
	(ange-ftp-compress, ange-ftp-uncompress): Remove optional arg from
	`delete-file'.
	(ange-ftp-delete-directory): Add optional arg to `delete-file', to
	allow trashing.

	* net/tramp-compat.el (tramp-compat-delete-file): Rewrite to
	handle new TRASH arg of `delete-file'.

	* net/tramp.el (tramp-handle-delete-file): Change FORCE arg to TRASH.
	(tramp-handle-make-symbolic-link, tramp-handle-load)
	(tramp-do-copy-or-rename-file-via-buffer)
	(tramp-do-copy-or-rename-file-directly)
	(tramp-do-copy-or-rename-file-out-of-band)
	(tramp-handle-process-file, tramp-handle-call-process-region)
	(tramp-handle-shell-command, tramp-handle-file-local-copy)
	(tramp-handle-insert-file-contents, tramp-handle-write-region)
	(tramp-delete-temp-file-function): Use null TRASH arg in
	tramp-compat-delete-file call.

	* net/tramp-fish.el (tramp-fish-handle-delete-directory)
	(tramp-fish-handle-delete-file)
	(tramp-fish-handle-make-symbolic-link)
	(tramp-fish-handle-process-file): Use null TRASH arg in
	`tramp-compat-delete-file' call.

	* net/tramp-ftp.el (tramp-ftp-file-name-handler): Use null TRASH
	arg in `tramp-compat-delete-file' call.

	* net/tramp-gvfs.el (tramp-gvfs-handle-delete-file): Rename arg.
	(tramp-gvfs-handle-write-region): Use null TRASH arg in
	`tramp-compat-delete-file' call.

	* net/tramp-imap.el (tramp-imap-handle-delete-file): Rename arg.
	(tramp-imap-do-copy-or-rename-file): Use null TRASH arg in
	`tramp-compat-delete-file' call.

	* net/tramp-smb.el (tramp-smb-handle-copy-file)
	(tramp-smb-handle-file-local-copy, tramp-smb-handle-rename-file)
	(tramp-smb-handle-write-region): Use null TRASH arg in
	tramp-compat-delete-file call.
	(tramp-smb-handle-delete-directory): Use tramp-compat-delete-file.
	(tramp-smb-handle-delete-file): Rename arg.

	* diff.el (diff-sentinel):
	* epg.el (epg--make-temp-file, epg-decrypt-string)
	(epg-verify-string, epg-sign-string, epg-encrypt-string):
	* jka-compr.el (jka-compr-partial-uncompress)
	(jka-compr-call-process, jka-compr-write-region):
	* server.el (server-sentinel): Remove optional arg from
	delete-file, reverting 2010-05-03 change.

2010-05-27  Chong Yidong  <cyd@stupidchicken.com>

	* progmodes/verilog-mode.el (verilog-type-font-keywords): Use
	font-lock-constant-face, not obsolete font-lock-reference-face.

2010-05-27  Kenichi Handa  <handa@m17n.org>

	* language/hebrew.el (hebrew-shape-gstring): Check if a glyph
	element of GSTRING is nil.

2010-05-27  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/smie.el (smie-forward-token-function)
	(smie-backward-token-function): New vars.
	(smie-backward-sexp, smie-forward-sexp)
	(smie-indent-hanging-p, smie-indent-calculate): Use them.
	(smie-default-backward-token): Rename from smie-backward-token and
	skip comments.
	(smie-default-forward-token): Rename from smie-forward-token and
	skip comments.
	(smie-next-sexp): Handle nil results from next-token.
	(smie-indent-calculate): Add a new case for special `fixindent' comments.

2010-05-27  Chong Yidong  <cyd@stupidchicken.com>

	* progmodes/verilog-mode.el (verilog-type-font-keywords):
	Use font-lock-constant-face, not obsolete font-lock-reference-face.

2010-05-27  Masatake YAMATO  <yamato@redhat.com>

	* htmlfontify.el (hfy-face-resolve-face): New function.
	(hfy-face-to-style): Use it (Bug#6279).

2010-05-26  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/ada-xref.el (ada-gnat-parse-gpr):
	* emulation/edt.el (edt-load-keys): Avoid (expand-file-name ".").

2010-05-26  Glenn Morris  <rgm@gnu.org>

	* emulation/edt.el (edt-load-keys): Use locate-library.

2010-05-25  Chong Yidong  <cyd@stupidchicken.com>

	* log-edit.el (log-edit-strip-single-file-name): Default to nil.
	(log-edit-changelog-entries): Doc fix.
	(log-edit-changelog-insert-entries): Args changed.
	Rename relative filenames in ChangeLog entries.  Delete tabs.
	(log-edit-insert-changelog-entries): Reorganize return value of
	`log-edit-changelog-entries' to pass filenames to
	log-edit-changelog-insert-entries.

2010-05-25  Thierry Volpiatto  <thierry.volpiatto@gmail.com>

	* dired.el (dired-mode-map): Rebind "\C-t\C-t" from
	`image-dired-dired-insert-marked-thumbs' to
	`image-dired-dired-toggle-marked-thumbs'.

	* image-dired.el: Require cl when compiling.
	(image-dired-dired-toggle-marked-thumbs): Rename from
	`image-dired-dired-insert-marked-thumbs'.  Add ARG.  Doc fix.
	Use interactive spec "P".  Set LOCALP arg of `dired-get-filename'
	to 'no-dir.  Skip files whose names don't match
	`image-file-name-regexp'.  When file has a thumbnail overlay,
	delete it.  (Bug#5270)

2010-05-25  Juri Linkov  <juri@jurta.org>

	* image-mode.el (image-mode): Add image-after-revert-hook to
	after-revert-hook.
	(image-after-revert-hook): New function.  (Bug#5669)

2010-05-25  Juri Linkov  <juri@jurta.org>

	* image.el (image-animated-p): When delay between animated images
	is 0, set it to 10 (0.1 sec).  (Bug#6258)

2010-05-25  Christian Lynbech  <christian.lynbech@tieto.com>  (tiny change)

	* net/tramp.el (tramp-handle-insert-directory): Don't use
	`forward-word', its default syntax could be changed.

2010-05-25  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-progress-reporter-update): New defun.
	(with-progress-reporter): Use it.
	(tramp-process-actions):
	* net/tramp-gvfs.el (tramp-gvfs-handler-askquestion): Preserve
	current message, in order to let progress reporter continue
	afterwards.  (Bug#6257)

2010-05-25  Glenn Morris  <rgm@gnu.org>

	* net/rcirc.el (rcirc-default-user-name, rcirc-default-full-name):
	Add :version.

2010-05-25  Ryan Yeske  <rcyeske@gmail.com>

	* net/rcirc.el (rcirc-default-user-name): Change to "user".
	(rcirc-default-full-name): Change to "unknown".
	(rcirc-user-name-history): Add variable.

2010-05-25  Ryan Yeske  <rcyeske@gmail.com>
            Jonathan Rockway  <jon@jrock.us>

	* net/rcirc.el (rcirc-server-alist): Add :pass.
	(rcirc): When prompting for connection parameters, also prompt for
	username and password.
	(rcirc-connect): Take a PASS argument.  If PASS is non-nil, send
	value to server when connecting.

2010-05-25  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/smie.el (smie-set-prec2tab): Check override before use.
	(smie-merge-prec2s): Pass the tables as separate args.
	(smie-bnf-precedence-table): Adjust call accordingly.
	(smie-prec2-levels): Set levels at the end.

	Replace Lisp calls to delete-backward-char by delete-char.
	* bs.el, expand.el, ido.el, image-dired.el, lpr.el, pcomplete.el,
	* skeleton.el, term.el, time.el, wid-edit.el, woman.el,
	* calc/calc-graph.el, calc/calc-help.el, calc/calc-incom.el,
	* calc/calc.el, emacs-lisp/cl-extra.el, emacs-lips/cl-loaddefs.el,
	* emulation/cua-rect.el, emulation/viper-ex.el, eshell/esh-test.el,
	* eshell/eshell.el, gnus/gnus-uu.el, gnus/nndoc.el, gnus/nnrss.el,
	* gnus/rfc2047.el, gnus/utf7.el, international/utf-7.el,
	* language/ethio-util.el, mh-e/mh-alias.el, mh-e/mh-search.el,
	* net/imap.el, net/rcirc.el, obsolete/complete.el, play/decipher.el,
	* progmodes/ada-mode.el, progmodes/cc-awk.el, progmodes/dcl-mode.el,
	* progmodes/ps-mode.el, progmodes/verilog-mode.el,
	* progmodes/vhdl-mode.el, textmodes/bibtex.el, textmodes/fill.el,
	* textmodes/reftex-auc.el, textmodes/rst.el, textmodes/sgml-mode.el,
	* textmodes/table.el, textmodes/texinfmt.el: Replace Lisp calls to
	delete-backward-char by calls to delete-char.

2010-05-25  Kenichi Handa  <handa@m17n.org>

	* language/hebrew.el (hebrew-shape-gstring): New function.
	Register it in composition-function-table for all Hebrew combining
	characters.

2010-05-25  Stefan Monnier  <monnier@iro.umontreal.ca>

	* epa.el (epa--select-keys): Don't explicitly delete the window since
	that can fail (e.g. sole window in frame).  Use dedication instead.

2010-05-24  Uday S Reddy  <u.s.reddy@cs.bham.ac.uk>  (tiny change)

	* textmodes/fill.el (fill-region): Don't fill past the end (bug#6201).

2010-05-22  Chong Yidong  <cyd@stupidchicken.com>

	* image.el (image-refresh): Define as an alias for image-flush.

	* image-mode.el (image-toggle-display-image): Caller changed.

2010-05-21  Juri Linkov  <juri@jurta.org>

	* progmodes/grep.el (grep-read-files): Fix multi-pattern aliases.
	Remove "all" from grep-files-aliases.  Split grep-files-aliases by
	whitespace, call wildcard-to-regexp on substrings and concat them
	with "\\|".  (Bug#6114)

2010-05-21  Alan Mackenzie  <acm@muc.de>

	* progmodes/cc-engine.el (c-parse-state-get-strategy):
	Replace parameter `here' with `here-' and `here-plus', which sandwich
	any pertinent CPP construct.
	(c-remove-stale-state-cache-backwards): Fix a bug which happens
	when doing (c-parse-state) in a CPP construct: Exclude any "new"
	CPP construct from taking part in the scanning.

2010-05-21  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-do-copy-or-rename-file)
	(tramp-handle-file-local-copy, tramp-maybe-open-connection):
	Tune `with-progress-reporter' messages.
	(tramp-handle-vc-registered):
	* net/tramp-fish.el (tramp-fish-handle-file-local-copy)
	(tramp-fish-handle-insert-file-contents)
	(tramp-fish-maybe-open-connection):
	* net/tramp-gvfs.el (tramp-gvfs-maybe-open-connection):
	* net/tramp-imap.el (tramp-imap-do-copy-or-rename-file)
	(tramp-imap-handle-insert-file-contents)
	(tramp-imap-handle-file-local-copy): Use `with-progress-reporter'.

2010-05-21  Juanma Barranquero  <lekktu@gmail.com>

	* add-log.el (change-log-font-lock-keywords):
	Highlight all authors in multi-author entries.

	* smerge-mode.el (smerge-refine-ignore-whitespace)
	(smerge-refine-weight-hack, smerge-refine, smerge-makeup-conflict):
	Fix typos in docstrings.
	(smerge-resolve, smerge-refine-subst): Reflow docstrings.

2010-05-21  Glenn Morris  <rgm@gnu.org>

	* progmodes/fortran.el (fortran-mode):
	* progmodes/f90.el (f90-mode): Derive from prog-mode.

	* loadup.el [CANNOT_DUMP]: Update for bootstrap-emacs no longer
	having a relative path in src/Makefile.in.

2010-05-20  Kevin Ryde  <user42@zip.com.au>

	* help-mode.el (help-make-xrefs): For Info node links turn
	newlines into spaces.  Link node names with newlines are matched
	by help-xref-info-regexp and buttonized, this change ensures they
	can be followed successfully with RET.  (Bug#6206)

2010-05-20  Juri Linkov  <juri@jurta.org>

	* locate.el (locate): Use pop-to-buffer instead of
	switch-to-buffer-other-window.  (Bug#6204)

2010-05-20  Juri Linkov  <juri@jurta.org>

	* replace.el (replace-highlight): Fix lazy-highlighting
	for `M-s w str M-% str RET'.

2009-12-15  Masatake YAMATO  <yamato@redhat.com>

	* isearch.el (isearch-yank-word-or-char): Pull next subword
	when `subword-mode' is activated.  (Bug#6220)

2010-05-20  Mark A. Hershberger  <mah@everybody.org>

	* isearch.el (isearch-update-post-hook): New hook.
	(isearch-update): Use the new hook.  (Bug#6225)

2010-05-20  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-mode-map): Bind more keys to isearch-help-map:
	[f1], [help], and (char-to-string help-char) instead of "\C-h".
	(Bug#6222)

2010-05-20  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-yank-string): Use isearch-process-search-string.
	(Bug#6223)

2010-05-20  Juri Linkov  <juri@jurta.org>

	* dired-x.el (dired-jump, dired-jump-other-window): Add arg
	FILE-NAME to read from the minibuffer when called interactively
	with prefix argument instead of using buffer-file-name.
	http://lists.gnu.org/archive/html/emacs-devel/2010-05/msg00534.html

	* dired.el: Update autoloads.

2010-05-20  Chong Yidong  <cyd@stupidchicken.com>

	* nxml/nxml-mode.el (nxml-mode-map): Bind C-c / to
	nxml-finish-element, for consistency with SGML mode.

	* progmodes/octave-mod.el (octave-mode-map): Bind C-c / to
	octave-close-block.

2010-05-20  Juanma Barranquero  <lekktu@gmail.com>

	* composite.el: Require cl when compiling.
	(reference-point-alist, compose-gstring-for-graphic)
	(compose-gstring-for-terminal): Fix typos in docstrings.

2010-05-19  Juri Linkov  <juri@jurta.org>

	* emacs-lisp/cl-macs.el (window-parameter): Add defsetf with
	set-window-parameter.

2010-05-19  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-methods): Add `tramp-async-args' attribute
	where appropriate.
	(tramp-maybe-open-connection): Use it.

2010-05-19  Eli Zaretskii  <eliz@gnu.org>

	* simple.el (move-end-of-line): Make sure we are at line beginning
	before backing up to end of previous line.

2010-05-19  Michael Albinus  <michael.albinus@gmx.de>

	* password-cache.el (password-cache-remove): Fix docstring.

	* net/secrets.el: Autoload the widget functions.
	(secrets-search-items, secrets-create-item)
	(secrets-get-attributes, secrets-expand-item): Attributes will be
	stored on the password database without leading ":", as all other
	clients do as well.
	(secrets-mode): Fix docstring.
	(secrets-show-secrets): Provide it as autoloaded command only when
	D-Bus support is available.  Check existence of Secret Service API.

2010-05-19  Stefan Monnier  <monnier@iro.umontreal.ca>

	* indent.el (indent-region): Deactivate region (bug#6200).

2010-05-19  Glenn Morris  <rgm@gnu.org>

	* vc-dir.el (vc-dir): Don't pop-up-windows.  (Bug#6204)

2010-05-19  Kenichi Handa  <handa@m17n.org>

	* composite.el: Register compose-gstring-for-graphic in
	composition-function-table only for combining characters (Mn, Mc, Me).

2010-05-18  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-trail.el (calc-trail-isearch-forward)
	(calc-trail-isearch-backward): Ensure that the new window
	point is set correctly.

2010-05-18  Stefan Monnier  <monnier@iro.umontreal.ca>

	* subr.el (read-quoted-char): Resolve modifiers after key
	remapping (bug#6212).

2010-05-18  Michael Albinus  <michael.albinus@gmx.de>

	Add visualization code for secrets.
	* net/secrets.el (secrets-mode): New major mode.
	(secrets-show-secrets, secrets-show-collections)
	(secrets-expand-collection, secrets-expand-item)
	(secrets-tree-widget-after-toggle-function)
	(secrets-tree-widget-show-password): New defuns.

2010-05-18  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/smie.el (smie-next-sexp): Break inf-loop at BOB.
	(smie-backward-sexp, smie-forward-sexp): Remove boundary condition now
	handled in smie-next-sexp.
	(smie-indent-calculate): Provide a starting indentation (so the
	recursion is well-founded ;-).

	Fix handling of non-associative equal levels.
	* emacs-lisp/smie.el (smie-prec2-levels): Choose distinct levels even
	when it's not needed.
	(smie-op-left, smie-op-right): New functions.
	(smie-next-sexp): New function, extracted from smie-backward-sexp.
	Better handle equal levels to distinguish the associative case from
	the "multi-keyword construct" case.
	(smie-backward-sexp, smie-forward-sexp): Use it.

2010-05-18  Juanma Barranquero  <lekktu@gmail.com>

	* progmodes/prolog.el (smie-indent-basic): Declare for byte-compiler.

	* emacs-lisp/smie.el (smie-precs-precedence-table, smie-backward-sexp)
	(smie-forward-sexp, smie-indent-calculate): Fix typos in docstrings.

2010-05-17  Stefan Monnier  <monnier@iro.umontreal.ca>

	Provide a simple generic indentation engine and use it for Prolog.
	* emacs-lisp/smie.el: New file.
	* progmodes/prolog.el (prolog-smie-op-levels)
	(prolog-smie-indent-rules): New var.
	(prolog-mode-variables): Use them to configure SMIE.
	(prolog-indent-line, prolog-indent-level): Remove.

2010-05-17  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-vec.el (math-vector-avg): Put the vector elements in
	order before computing the averages.

2010-05-16  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-vec.el (calc-histogram):
	(calcFunc-histogram): Allow vectors as inputs.
	(math-vector-avg): New function.

	* calc/calc-ext.el (math-group-float): Have the number of digits
	being grouped depend on the radix (Bug#6189).

2010-05-15  Ken Raeburn  <raeburn@raeburn.org>

	* version.el (emacs-copyright, emacs-version): Don't define here,
	now that emacs.c defines it.

2010-05-15  Eli Zaretskii  <eliz@gnu.org>

	* international/mule-cmds.el (mule-menu-keymap): Fix definition of
	"Describe Language Environment" menu item.

	* language/hebrew.el ("Hebrew", "Windows-1255"): Doc fix.

	Bidi-sensitive movement with arrow keys.
	* subr.el (right-arrow-command, left-arrow-command): New functions.

	* bindings.el (global-map): Bind them to right and left arrow keys.

	Don't override standard definition of convert-standard-filename.
	* files.el (convert-standard-filename): Call
	w32-convert-standard-filename and dos-convert-standard-filename on
	the corresponding systems.

	* w32-fns.el (w32-convert-standard-filename): Rename from
	convert-standard-filename.  Doc fix.

	* dos-fns.el (dos-convert-standard-filename): Doc fix.
	(convert-standard-filename): Don't defalias.
	(register-name-alist, make-register, register-value)
	(set-register-value, intdos): Obsolete aliases for the
	corresponding dos-* functions and variables.
	(dos-intdos): Add a doc string.

2010-05-15  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-aent.el (math-read-token, math-find-user-tokens):
	* calc/calc-lang.el (math-read-big-rec, math-lang-read-symbol):
	(math-compose-tex-func):
	* calc/calccomp.el (math-compose-expr):
	* calc/calc-ext.el (math-format-flat-expr-fancy):
	* calc/calc-store.el (calc-read-var-name):
	* calc/calc-units.el (calc-explain-units-rec): Allow Greek letters.

	* calc/calc.el (var-π, var-φ, var-γ): New variables.
	* calc/calc-aent.el (math-read-replacement-list): Add "micro" symbol.
	* calc/calc-units.el (math-unit-prefixes): Add mu for micro.
	(math-standard-units): Add units.

2010-05-15  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/asm-mode.el (asm-mode):
	* progmodes/prolog.el (prolog-mode): Use define-derived-mode.

	* pcomplete.el (pcomplete-completions-at-point): New function,
	extracted from pcomplete-std-complete.
	(pcomplete-std-complete): Use it.

2010-05-15  Glenn Morris  <rgm@gnu.org>

	* Makefile.in (setwins, setwins_almost, setwins_for_subdirs):
	Remove references to CVS, RCS and Old directories.

2010-05-14  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-bin.el (math-format-twos-complement): Group digits when
	appropriate.

2010-05-14  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/sh-script.el (sh-mode-default-syntax-table): Remove.
	(sh-mode-syntax-table): Give it a default value instead.
	(sh-header-marker): Make buffer-local.
	(sh-mode): Move make-local-variable to the corresponding setq.
	(sh-add-completer): Avoid gratuitously let-binding a buffer-local var.
	Use complete-with-action.

	* simple.el (prog-mode): New (abstract) major mode.
	* emacs-lisp/lisp-mode.el (emacs-lisp-mode, lisp-mode): Use it.
	* progmodes/sh-script.el (sh-mode): Remove redundant var assignment.

2010-05-14  Juanma Barranquero  <lekktu@gmail.com>

	* progmodes/sql.el (sql-oracle-program): Reflow docstring.
	(sql-oracle-scan-on, sql-sybase-program, sql-product-font-lock)
	(sql-add-product-keywords, sql-highlight-product, sql-set-product)
	(sql-make-alternate-buffer-name, sql-placeholders-filter)
	(sql-escape-newlines-filter, sql-input-sender)
	(sql-send-magic-terminator, sql-sybase): Fix typos in docstrings.

2010-05-13  Chong Yidong  <cyd@stupidchicken.com>

	Add TeX open-block and close-block keybindings to SGML, and vice versa.

	* textmodes/tex-mode.el (tex-mode-map): Bind C-c C-t to
	latex-open-block and C-c / to latex-close-block.

	* textmodes/sgml-mode.el (sgml-mode-map): Bind C-c C-o to sgml-tag
	and C-c C-e to sgml-close-tag.

2010-05-13  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (with-progress-reporter): Create reporter object
	only when the message would be displayed.  Handle nested calls.
	(tramp-handle-load, tramp-handle-file-local-copy)
	(tramp-handle-insert-file-contents, tramp-handle-write-region)
	(tramp-maybe-send-script, tramp-find-shell):
	Use `with-progress-reporter'.
	(tramp-handle-dired-compress-file, tramp-maybe-open-connection):
	Fix message text.

	* net/tramp-smb.el (tramp-smb-handle-copy-file)
	(tramp-smb-handle-file-local-copy, tramp-smb-handle-rename-file)
	(tramp-smb-handle-write-region, tramp-smb-maybe-open-connection):
	Use `with-progress-reporter'.

2010-05-13  Agustín Martín  <agustin.martin@hispalinux.es>

	* textmodes/ispell.el (ispell-init-process): Do not kill ispell
	process everytime when spellchecking from the minibuffer (bug#6143).

2010-05-13  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/sh-script.el (sh-mode): Use define-derived-mode.

	* dos-fns.el: Add "dos-" prefix for namespace control.
	(convert-standard-filename): Define as alias for
	dos-convert-standard-filename but only if applicable.

2010-05-12  Alan Mackenzie  <acm@muc.de>

	* progmodes/cc-cmds.el (c-beginning-of-defun, c-end-of-defun):
	Push the mark at the start of these functions when appropriate.

2010-05-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuffer.el (completion-cycle-threshold): New custom var.
	(completion--do-completion): Use it.
	(minibuffer-complete): Use cycling if appropriate.

2010-05-11  Juanma Barranquero  <lekktu@gmail.com>

	* dirtrack.el (dirtrackp): Remove defcustom; don't make automatically
	buffer-local (it's an obsolete alias for `dirtrack-mode') (bug#6173).

2010-05-11  Juri Linkov  <juri@jurta.org>

	* scroll-all.el (scroll-all-check-to-scroll):
	Add `scroll-up-command' and `scroll-down-command' (bug#6164).

2010-05-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* iimage.el (iimage-mode-map): Move initialization into declaration.
	(iimage-mode-buffer): Use with-silent-modifications.
	Simplify calling convention.  Adjust callers.
	(iimage-mode): Don't run hook redundantly.

	* minibuffer.el (completion-pcm--pattern->regex):
	Fix last change (bug#6160).

2010-05-10  Juri Linkov  <juri@jurta.org>

	Remove nodes visited during Isearch from the Info history.
	* info.el (Info-isearch-initial-history)
	(Info-isearch-initial-history-list): New variables.
	(Info-isearch-start): Record initial values of
	Info-isearch-initial-history and Info-isearch-initial-history-list.
	Add Info-isearch-end to isearch-mode-end-hook.
	(Info-isearch-end): New function.

2010-05-10  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-do-file-attributes-with-stat): Add space in
	format string, in order to work around a bug in pdksh.
	Reported by Gilles Pion <gpion@lfdj.com>.
	(tramp-handle-verify-visited-file-modtime): Do not send a command
	when the connection is not established.
	(tramp-handle-set-file-times): Simplify the check for utc.

2010-05-10  Juanma Barranquero  <lekktu@gmail.com>

	Fix use of `filter-buffer-substring' (rework previous change).
	* emulation/cua-base.el (cua--filter-buffer-noprops): New function.
	(cua-repeat-replace-region):
	* emulation/cua-rect.el (cua--extract-rectangle, cua-incr-rectangle):
	* emulation/cua-gmrk.el (cua-copy-region-to-global-mark)
	(cua-cut-region-to-global-mark): Use it.

2010-05-09  Michael R. Mauger  <mmaug@yahoo.com>

	* progmodes/sql.el: Version 2.1.
	(sql-product-alist): Redesign structure of product info.
	(sql-product, sql-user, sql-server, sql-database): Safe variables.
	(sql-port, sql-port-history): New variables.
	(sql-interactive-product): New variable.
	(sql-send-terminator): New variable.
	(sql-imenu-generic-expression): Add "Types" imenu entry.
	(sql-oracle-login-params, sql-sqlite-login-params)
	(sql-mysql-login-params, sql-solid-login-params)
	(sql-sybase-login-params, sql-informix-login-params)
	(sql-ingres-login-params, sql-ms-login-params)
	(sql-postgres-login-params, sql-interbase-login-params)
	(sql-db2-login-params, sql-linter-login-params)
	(sql-oracle-scan-on): New variables.
	(sql-mode-map): Add C-c C-i to start interactive mode.
	(sql-mode-menu): Update existing menu entries.
	(sql-font-lock-keywords-builder): Compile-time font-lock optimization.
	(sql-mode-oracle-font-lock-keywords)
	(sql-mode-postgres-font-lock-keywords)
	(sql-mode-ms-font-lock-keywords)
	(sql-mode-sybase-font-lock-keywords)
	(sql-mode-informix-font-lock-keywords)
	(sql-mode-interbase-font-lock-keywords)
	(sql-mode-ingres-font-lock-keywords)
	(sql-mode-solid-font-lock-keywords)
	(sql-mode-mysql-font-lock-keywords)
	(sql-mode-sqlite-font-lock-keywords)
	(sql-mode-db2-font-lock-keywords)
	(sql-mode-linter-font-lock-keywords): Update initialization to
	reduce run-time complexity.
	(sql-add-product, sql-del-product): New functions.
	(sql-set-product-feature, sql-get-product-feature): New functions.
	(sql-product-font-lock): Update product API.
	(sql-add-product-keywords): New function.
	(sql-highlight-product): Update product API.
	(sql-help-list-products): New function.
	(sql-help): Dynamically lists free and non-free products.
	(sql-get-login): Correct bug in handling history and added
	prompt for port.
	(sql-copy-column): Copy without properties.
	(sqli-input-sender): Apply filters to SQLi input.
	(sql-query-placeholders-and-send): Obey `sql-oracle-scan-on' setting.
	Implement as a filter.
	(sql-escape-newlines-filter): Implement as a filter.
	(sql-remove-tabs-filter): New function.
	(sql-send-magic-terminator): New function.
	(sql-send-string): Implement magic terminator.
	(sql-send-region): Use `sql-send-string'.
	(sql-interactive-mode): Use product API.
	(sql-product-interactive): Use product API.
	(sql-oracle, sql-sybase, sql-informix, sql-sqlite, sql-mysql)
	(sql-solid, sql-ingres, sql-ms, sql-postgres, sql-interbase)
	(sql-db2, sql-linter): Use `sql-product-interactive'.
	(sql-connect): New function.
	(sql-connect-oracle, sql-connect-sybase, sql-connect-informix)
	(sql-connect-sqlite, sql-connect-mysql, sql-connect-solid)
	(sql-connect-ingres, sql-connect-ms, sql-connect-postgres)
	(sql-connect-interbase, sql-connect-db2, sql-connect-linter):
	Use `sql-connect'.

2010-05-09  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuffer.el (completion-pcm-complete-word-inserts-delimiters):
	New custom variable.
	(completion-pcm--string->pattern): Use it.
	(completion-pcm--pattern->regex, completion-pcm--pattern->string):
	Make it handle any symbol as `any'.
	(completion-pcm--merge-completions): Extract common suffix for the new
	`prefix' symbol as well.
	(completion-substring--all-completions): Use the new `prefix' symbol.

2010-05-09  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-compat.el (byte-compile-not-obsolete-vars): Define if
	not bound.
	(tramp-compat-copy-file): Add PRESERVE-SELINUX-CONTEXT.
	(tramp-compat-funcall): New defmacro.
	(tramp-compat-line-beginning-position)
	(tramp-compat-line-end-position)
	(tramp-compat-temporary-file-directory)
	(tramp-compat-make-temp-file, tramp-compat-file-attributes)
	(tramp-compat-copy-file, tramp-compat-copy-directory)
	(tramp-compat-delete-file, tramp-compat-delete-directory)
	(tramp-compat-number-sequence, tramp-compat-process-running-p)
	* net/tramp.el (top, with-progress-reporter)
	(tramp-rfn-eshadow-setup-minibuffer)
	(tramp-rfn-eshadow-update-overlay, tramp-handle-set-file-times)
	(tramp-handle-dired-compress-file, tramp-handle-shell-command)
	(tramp-completion-mode-p, tramp-check-for-regexp)
	(tramp-open-connection-setup-interactive-shell)
	(tramp-compute-multi-hops, tramp-read-passwd, tramp-clear-passwd)
	(tramp-time-diff, tramp-coding-system-change-eol-conversion)
	(tramp-set-process-query-on-exit-flag, tramp-unload-tramp)
	* net/tramp-cmds.el (tramp-cleanup-all-connections)
	(tramp-reporter-dump-variable, tramp-load-report-modules)
	(tramp-append-tramp-buffers)
	* net/tramp-gvfs.el (tramp-gvfs-handle-file-selinux-context): Use it.

	* net/tramp-imap.el (top): Autoload `epg-make-context'.

2010-05-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/compile.el (compilation-buffer-modtime): Rename from
	buffer-modtime.  Adjust users.

2010-05-08  Chong Yidong  <cyd@stupidchicken.com>

	* international/mule.el (auto-coding-alist): Only purecopy
	car of each item, not the whole list (Bug#6083).

2010-05-08  Chong Yidong  <cyd@stupidchicken.com>

	* progmodes/js.el (js-mode): Make paragraph variables local before
	calling c-setup-paragraph-variables (Bug#6071).

2010-05-08  Eli Zaretskii  <eliz@gnu.org>

	* composite.el (compose-region, reference-point-alist): Fix typos
	in the doc strings.

2010-05-08  Alexander Klimov  <alserkli@inbox.ru>  (tiny change)

	* calc/calc-graph.el (calc-graph-plot): Use the proper form for
	gnuplot's "set" command.

2010-05-08  Juanma Barranquero  <lekktu@gmail.com>

	* abbrev.el (last-abbrev-text): Doc fix.
	(abbrev-prefix-mark): Don't escape parenthesis.

2010-05-08  Andreas Schwab  <schwab@linux-m68k.org>

	* composite.el (find-composition): Doc fix.

2010-05-08  Juanma Barranquero  <lekktu@gmail.com>

	* progmodes/sql.el (sql-electric-stuff): Fix typo in tag.
	(sql-oracle-program, sql-sqlite-options)
	(sql-query-placeholders-and-send): Doc fixes.
	(sql-set-product, sql-interactive-mode): Reflow docstrings.
	(sql-imenu-generic-expression, sql-buffer)
	(sql-mode-ansi-font-lock-keywords, sql-mode-oracle-font-lock-keywords)
	(sql-mode-postgres-font-lock-keywords, sql-mode-ms-font-lock-keywords)
	(sql-mode-sybase-font-lock-keywords)
	(sql-mode-informix-font-lock-keywords)
	(sql-mode-interbase-font-lock-keywords)
	(sql-mode-ingres-font-lock-keywords, sql-mode-solid-font-lock-keywords)
	(sql-mode-mysql-font-lock-keywords, sql-mode-sqlite-font-lock-keywords)
	(sql-mode-db2-font-lock-keywords, sql-mode-font-lock-keywords)
	(sql-product-feature, sql-highlight-product)
	(comint-line-beginning-position, sql-rename-buffer)
	(sql-toggle-pop-to-buffer-after-send-region sql-oracle)
	(sql-sybase, sql-informix, sql-sqlite, sql-mysql, sql-solid)
	(sql-ingres, sql-ms, sql-postgres, sql-interbase, sql-db2, sql-linter):
	Fix typos in docstrings.

2010-05-08  Juri Linkov  <juri@jurta.org>

	* info.el (Info-fontify-node): Put Info-breadcrumbs to the `display'
	property instead of `invisible' and `after-string' (bug#5998).

2010-05-08  Juri Linkov  <juri@jurta.org>

	* image-mode.el (image-mode-as-text): Fix typo in docstring.

2010-05-08  Juanma Barranquero  <lekktu@gmail.com>

	* filecache.el (file-cache-add-directory-list)
	(file-cache-add-directory-recursively): Fix typos in docstrings.

2010-05-08  Kenichi Handa  <handa@m17n.org>

	* language/indian.el (gurmukhi-composable-pattern): Fix typo.
	(gujarati-composable-pattern): Fix typo.

2010-05-08  Kenichi Handa  <handa@m17n.org>

	* language/indian.el (oriya-composable-pattern)
	(tamil-composable-pattern, malayalam-composable-pattern):
	Add two-part vowels to "v" (vowel sign).

2010-05-08  Chong Yidong  <cyd@stupidchicken.com>

	* files.el (copy-directory): Handle symlinks (Bug#5982).

2010-05-08  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-hg.el (vc-hg-state): Use HGRCPATH, not HGRC.
	(vc-hg-working-revision): Likewise.  Use hg parents, not hg parent
	(Bug#5846).

2010-05-08  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/lisp.el (lisp-completion-at-point): Give it a doc string.

	* minibuffer.el (completion-at-point): Doc fix.

2010-05-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* electric.el (Electric-command-loop): Minor tweak.

	* ebuff-menu.el (electric-buffer-list): Try and make it behave a bit
	better with dedicated windows.

2010-05-07  Chong Yidong  <cyd@stupidchicken.com>

	* Version 23.2 released.

2010-05-07  Deniz Dogan  <deniz.a.m.dogan@gmail.com>  (tiny change)
            Stefan Monnier  <monnier@iro.umontreal.ca>

	Highlight vendor specific properties.
	* textmodes/css-mode.el (css-proprietary-nmstart-re): New var.
	(css-proprietary-property): New face.
	(css-font-lock-keywords): Use them.

2010-05-07  Eli Zaretskii  <eliz@gnu.org>

	* cus-start.el (all): Add native condition for tool-bar-* symbols.

2010-05-07  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/dns-mode.el (auto-mode-alist): Add entry for .zone files.
	* files.el (auto-mode-alist): Remove redundant entries.

	* files.el (auto-save-mode): Move to simple.el to fix bootstrap.
	* simple.el (auto-save-mode): Move from files.el.
	* minibuffer.el (completion--common-suffix): Fix copy&paste error.

2010-05-07  Christian von Roques  <roques@mti.ag>  (tiny change)

	* epg.el (epg-key-capablity-alist): Add "D" flag (Bug#5592).

2010-05-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mail/binhex.el (binhex-decode-region-internal)
	* mail/uudecode.el (uudecode-decode-region-internal)
	* net/dns.el (dns-read-string-name, dns-write, dns-read)
	(dns-read-type, dns-query)
	* pgg-parse.el (pgg-parse-armor)
	* pgg.el (pgg-verify-region)
	* sha1.el (sha1-string-external): Don't run set-buffer-multibyte for
	XEmacs.

	* net/imap.el (imap-disable-multibyte): Redefine it as a macro.

2010-05-07  Juanma Barranquero  <lekktu@gmail.com>

	* progmodes/cperl-mode.el (cperl-mode-unload-function): New function.

	Fix use of `filter-buffer-substring' (4th arg NOPROPS removed).
	* emulation/cua-base.el (cua-repeat-replace-region):
	* emulation/cua-gmrk.el (cua-copy-region-to-global-mark)
	(cua-cut-region-to-global-mark):
	Remove text properties with `set-text-properties'.

2010-05-06  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (top, with-progress-reporter):
	Use `symbol-function' inside `funcall'.

	* net/tramp-compat.el (tramp-compat-file-attributes)
	(tramp-compat-delete-file, tramp-compat-delete-directory):
	Handle only `wrong-number-of-arguments' error.

	* net/tramp-gvfs.el (tramp-gvfs-handle-copy-file): Fix typo.
	(tramp-gvfs-handle-file-selinux-context): Use `symbol-function'
	inside `funcall'.

2010-05-06  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuffer.el (completion--sreverse, completion--common-suffix):
	New functions.
	(completion-pcm--merge-completions): Extract common suffix when safe.

	* emacs-lisp/easy-mmode.el (define-minor-mode):
	Make :variable more flexible.
	* files.el (auto-save-mode): Use it to define using define-minor-mode.

2010-05-05  Juri Linkov  <juri@jurta.org>

	Add `slow' and `history' tags to the desktop data.

	* info.el (Info-virtual-nodes) [*Index*]: Add `slow' tag.
	(Info-virtual-files) [*Apropos*]: Add `slow' tag.
	(Info-finder-find-node): Require `finder.el' to be able
	to restore node from the desktop.
	(Info-desktop-buffer-misc-data): Save all nodes.  Save additional
	data `Info-history' and `slow' tag in the assoc list.
	(Info-restore-desktop-buffer): Don't restore nodes with the
	`slow' tag.  Restore `Info-history'.

2010-05-05  Michael Albinus  <michael.albinus@gmx.de>

	Add FORCE argument to `delete-file'.

	* net/ange-ftp.el (ange-ftp-del-tmp-name): Make it a defun,
	forcing to delete the temporary file.
	(ange-ftp-delete-file): Add FORCE arg.
	(ange-ftp-rename-remote-to-remote)
	(ange-ftp-rename-local-to-remote, ange-ftp-rename-remote-to-local)
	(ange-ftp-load, ange-ftp-compress, ange-ftp-uncompress):
	Force file deletion.

	* net/tramp-compat.el (tramp-compat-delete-file): New defun.

	* net/tramp.el (tramp-handle-delete-file): Add FORCE arg.
	(tramp-handle-make-symbolic-link, tramp-handle-load)
	(tramp-do-copy-or-rename-file-via-buffer)
	(tramp-do-copy-or-rename-file-directly)
	(tramp-do-copy-or-rename-file-out-of-band)
	(tramp-handle-process-file, tramp-handle-call-process-region)
	(tramp-handle-shell-command, tramp-handle-file-local-copy)
	(tramp-handle-insert-file-contents, tramp-handle-write-region)
	(tramp-delete-temp-file-function): Use `tramp-compat-delete-file'.

	* net/tramp-fish.el (tramp-fish-handle-delete-file): Add FORCE arg.
	(tramp-fish-handle-make-symbolic-link)
	(tramp-fish-handle-process-file): Use `tramp-compat-delete-file'.

	* net/tramp-ftp.el (tramp-ftp-file-name-handler):
	Use `tramp-compat-delete-file'.

	* net/tramp-gvfs.el (tramp-gvfs-handle-delete-file): Add FORCE arg.
	(tramp-gvfs-handle-write-region): Use `tramp-compat-delete-file'.

	* net/tramp-imap.el (tramp-imap-handle-delete-file): Add FORCE arg.
	(tramp-imap-do-copy-or-rename-file): Use `tramp-compat-delete-file'.

	* net/tramp-smb.el (tramp-smb-handle-delete-file): Add FORCE arg.
	(tramp-smb-handle-copy-file, tramp-smb-handle-file-local-copy)
	(tramp-smb-handle-rename-file, tramp-smb-handle-write-region): Use
	`tramp-compat-delete-file'.

2010-05-05  Stefan Monnier  <monnier@iro.umontreal.ca>

	Minor cleanups.
	* subr.el (add-minor-mode): Use push.
	* mail/supercite.el (sc-electric-mode): Use more descriptive arg name.
	* emulation/edt.el (edt-select-mode): Simplify.

	Use define-minor-mode in more cases.
	* term/tvi970.el (tvi970-set-keypad-mode):
	* simple.el (auto-fill-mode, overwrite-mode, binary-overwrite-mode)
	(normal-erase-is-backspace-mode):
	* scroll-bar.el (scroll-bar-mode): Use it and define-minor-mode.
	(set-scroll-bar-mode-1): (Re)move to its sole caller.
	(get-scroll-bar-mode): New function.
	* emacs-lisp/cl-macs.el (eq): Handle a non-variable first arg.

	Use define-minor-mode for less obvious cases.
	* emacs-lisp/easy-mmode.el (define-minor-mode): Add :variable keyword.
	* emacs-lisp/cl-macs.el (terminal-parameter, eq): Add setf method.
	* international/iso-ascii.el (iso-ascii-mode):
	* frame.el (auto-raise-mode, auto-lower-mode):
	* composite.el (global-auto-composition-mode): Use define-minor-mode.

2010-05-04  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-methods): Remove "-q" from `tramp-login-args'
	in order to see error messages for failed logins.

2010-05-03  Chong Yidong  <cyd@stupidchicken.com>

	* diff.el (diff-sentinel):

	* epg.el (epg--make-temp-file, epg-decrypt-string)
	(epg-verify-string, epg-sign-string, epg-encrypt-string):

	* jka-compr.el (jka-compr-partial-uncompress)
	(jka-compr-call-process, jka-compr-write-region, jka-compr-load):

	* server.el (server-sentinel): Use delete-file's new FORCE arg
	(Bug#6070).

2010-05-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	Use define-minor-mode where applicable.
	* view.el (view-mode):
	* type-break.el (type-break-query-mode)
	(type-break-mode-line-message-mode):
	* textmodes/reftex.el (reftex-mode):
	* term/vt100.el (vt100-wide-mode):
	* tar-mode.el (tar-subfile-mode):
	* savehist.el (savehist-mode):
	* ibuf-ext.el (ibuffer-auto-mode):
	* composite.el (auto-composition-mode):
	* progmodes/vhdl-mode.el (vhdl-electric-mode, vhdl-stutter-mode):
	Use define-minor-mode.
	(vhdl-mode): Use static mode-line format.
	(vhdl-mode-line-update): Delete.
	(vhdl-create-mode-menu, vhdl-activate-customizations)
	(vhdl-hs-minor-mode): Don't bother calling it.

2010-05-02  Stefan Monnier  <monnier@iro.umontreal.ca>

	* simple.el (with-wrapper-hook): Move.
	(buffer-substring-filters): Mark obsolete.
	(filter-buffer-substring-functions): New variable.
	(filter-buffer-substring): Use it.  Remove unused arg `noprops'.

2010-05-01  Toru TSUNEYOSHI  <t_tuneyosi@hotmail.com>
            Michael Albinus  <michael.albinus@gmx.de>

	Implement compression for inline methods.

	* net/tramp.el (tramp-inline-compress-start-size): New defcustom.
	(tramp-copy-size-limit): Allow also nil.
	(tramp-inline-compress-commands): New defconst.
	(tramp-find-inline-compress, tramp-get-inline-compress)
	(tramp-get-inline-coding): New defuns.
	(tramp-get-remote-coding, tramp-get-local-coding): Remove,
	replaced by `tramp-get-inline-coding'.
	(tramp-handle-file-local-copy, tramp-handle-write-region)
	(tramp-method-out-of-band-p): Use `tramp-get-inline-coding'.

2010-05-01  Stefan Monnier  <monnier@iro.umontreal.ca>

	* bindings.el (mode-line-abbrev-mode, mode-line-auto-fill-mode):
	Remove unused functions.

	* emacs-lisp/lisp-mode.el (lisp-mode): Use define-derived-mode.
	Set find-tag-default-function as a variable rather than a property.

	* minibuffer.el (tags-completion-at-point-function): Move to etags.el.
	* progmodes/etags.el (tags-completion-at-point-function):
	Remove left over interactive spec.  Add autoloading stub.
	(complete-tag): Use tags-completion-at-point-function.

2010-04-30  Chong Yidong  <cyd@stupidchicken.com>

	* minibuffer.el (tags-completion-at-point-function): Fix return value.

2010-04-29  Chong Yidong  <cyd@stupidchicken.com>

	* ido.el (ido-init-completion-maps): Remove C-v binding.
	(ido-minibuffer-setup): Don't set cua-inhibit-cua-keys (Bug#5765).

2010-04-29  Chong Yidong  <cyd@stupidchicken.com>

	* minibuffer.el (tags-completion-at-point-function): New function.
	(completion-at-point-functions): Use it.

	* progmodes/etags.el (complete-tag): Revert last change.

2010-04-29  Alan Mackenzie  <acm@muc.de>

	* progmodes/cc-mode.el (c-extend-region-for-CPP): Fix an
	off-by-one error (in end of macro position).

2010-04-29  Stefan Monnier  <monnier@iro.umontreal.ca>

	* net/browse-url.el (browse-url-firefox-program): Use iceweasel if
	firefox is absent.  Don't autoload.
	(browse-url-galeon-program): Don't autoload.

2010-04-28  Chong Yidong  <cyd@stupidchicken.com>

	* bindings.el (complete-symbol): Move into minibuffer.el.

	* minibuffer.el (complete-tag): Move from etags.el.  If tags
	completion cannot be performed, return nil instead of signalling
	an error.
	(completion-at-point): Make it an alias for complete-symbol.
	(complete-symbol): Move from bindings.el, and replace with the
	body of completion-at-point.

	* progmodes/etags.el (complete-tag): Move to minibuffer.el.

2010-04-28  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-remote-selinux-p): New defun.
	(tramp-handle-file-selinux-context)
	(tramp-handle-set-file-selinux-context): Use it.

2010-04-28  Sam Steingold  <sds@gnu.org>

	* progmodes/bug-reference.el (bug-reference-url-format): Mark as
	`safe-local-variable' if the value is a string or a symbol with
	the property `bug-reference-url-format'.

2010-04-28  Chong Yidong  <cyd@stupidchicken.com>

	* progmodes/bug-reference.el (bug-reference-url-format):
	Revert 2010-04-27 change due to security risk.

2010-04-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	Make it possible to locally disable a globally enabled mode.
	* simple.el (fundamental-mode): Run fundamental-mode-hook.
	* emacs-lisp/derived.el (define-derived-mode): Use fundamental-mode
	rather than kill-all-local-variables so it runs fundamental-mode-hook.
	* emacs-lisp/easy-mmode.el (define-globalized-minor-mode):
	Use fundamental-mode-hook to run MODE-enable-in-buffers earlier, so
	that subsequent hooks get a chance to disable it.

2010-04-27  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/easy-mmode.el (define-globalized-minor-mode):
	Avoid re-enabling a minor mode after the user turned the minor mode
	off if MODE-enable-in-buffers is run twice (typically once from
	fundamental-mode's after-change-major-mode-hook and a second time from
	run-mode-hook's own after-change-major-mode-hook).

	* emacs-lisp/lisp.el (lisp-complete-symbol): Fail gracefully.

2010-04-27  Sam Steingold  <sds@gnu.org>

	* progmodes/bug-reference.el (bug-reference-url-format): Mark as
	`safe-local-variable' if the value is a string or a function, as
	documented and implemented on 2010-04-02.

2010-04-27  Juanma Barranquero  <lekktu@gmail.com>

	* ido.el (ido-buffer-internal): Bind `ido-use-virtual-buffers' to nil
	when method is 'kill.

2010-04-27  Agustín Martín  <agustin.martin@hispalinux.es>

	* textmodes/ispell.el (ispell-init-process): Fix personal dictionary
	condition in default directory check.
	(ispell-init-process,ispell-kill-ispell,kill-buffer-hook):
	Kill ispell process when killing its associated buffer.

2010-04-27  Jan Djärv  <jan.h.d@swipnet.se>

	* desktop.el (desktop-kill): ask-if-new: Ask if desktop file exists,
	but we aren't using it.

2010-04-25  Jan Djärv  <jan.h.d@swipnet.se>

	* tool-bar.el (tool-bar-local-item-from-menu): Revert unintended
	checkin in 2010-04-23T16:26:11Z!monnier@iro.umontreal.ca.

2010-04-24  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/authors.el (authors-obsolete-files-regexps):
	Ignore VCS-ignore files, and deleted nextstep preferences files.
	(authors-ignored-files): Ignore deleted cedet test files, and "*.el".
	(authors-ambiguous-files): New list.
	(authors-valid-file-names): Add some deleted files.
	(authors-renamed-files-alist): Add font-setting.el, edt-user.doc.
	(authors-disambiguate-file-name): New function.  (Bug#5501)
	(authors-canonical-file-name): Doc fix.
	Don't warn about obsolete files.
	(authors-canonical-file-name, authors-scan-el):
	Use authors-disambiguate-file-name.

	* hfy-cmap.el (htmlfontify-load-rgb-file, hfy-fallback-colour-values):
	Add autoload cookies.
	(htmlfontify-unload-rgb-file, hfy-fallback-colour-values): Add docs.
	(generated-autoload-file): Set file-local value to "htmlfontify.el".
	* htmlfontify.el (caddr, cadddr): Remove fallback definitions.
	They have definitions / compiler macros in cl.el.
	(htmlfontify-load-rgb-file, hfy-fallback-colour-values):
	Replace manual autoloads with generated ones.
	(htmlfontify-unload-rgb-file): Remove autoload.
	* Makefile.in (autoloads): Ensure htmlfontify.el is writable.

2010-04-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/bytecomp.el (byte-compile-set-default): New function.
	(byte-compile-setq-default): Optimize for the
	single-var case and don't call byte-compile-form in this case to avoid
	inf-loop with byte-compile-set-default.

	* progmodes/compile.el (compilation-start): Abbreviate default directory.

2010-04-23  Michael Albinus  <michael.albinus@gmx.de>

	Implement SELINUX backends.

	* net/tramp.el (tramp-file-name-handler-alist):
	Add `file-selinux-context' and `set-file-selinux-context'.
	(tramp-handle-file-selinux-context)
	(tramp-handle-set-file-selinux-context): New defuns.
	(tramp-handle-copy-file, tramp-do-copy-or-rename-file):
	Handle PRESERVE-SELINUX-CONTEXT.

	* net/tramp-gvfs.el (tramp-gvfs-file-name-handler-alist):
	Add `file-selinux-context' and `set-file-selinux-context'.
	(tramp-gvfs-handle-file-selinux-context)
	(tramp-gvfs-handle-set-file-selinux-context): New defuns.
	(tramp-gvfs-handle-copy-file): Handle PRESERVE-SELINUX-CONTEXT.

	* net/ange-ftp.el (ange-ftp-copy-file):
	* net/tramp-fish.el (tramp-fish-handle-copy-file):
	* net/tramp-imap.el (tramp-imap-handle-copy-file):
	* net/tramp-smb.el (tramp-smb-handle-copy-file):
	Add PRESERVE-SELINUX-CONTEXT.

2010-04-22  Michael Albinus  <michael.albinus@gmx.de>

	Synchronize with Tramp repository.

	* net/tramp.el (with-connection-property, tramp-completion-mode-p)
	(tramp-action-process-alive, tramp-action-out-of-band)
	(tramp-check-for-regexp, tramp-file-name-p, tramp-equal-remote)
	(tramp-exists-file-name-handler): Fix docstring.
	(with-progress-reporter): New defmacro.
	(tramp-do-copy-or-rename-file, tramp-handle-dired-compress-file)
	(tramp-maybe-open-connection): Use it.

2010-04-22  Noah Lavine  <noah549@gmail.com>  (tiny change)

	Detect ssh 'ControlMaster' argument automatically in some cases.

	* net/tramp.el (tramp-detect-ssh-controlmaster): New defun.
	(tramp-default-method): Use it.

2010-04-22  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-handle-copy-file): Add new optional
	parameter `preserve-selinux-context'.
	(tramp-file-name-for-operation): Add `set-file-selinux-context'.

2010-04-22  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-completion-handle-file-name-all-completions):
	Ensure, that non remote files are still checked.  Oops.

2010-04-21  Michael Albinus  <michael.albinus@gmx.de>

	Fix Bug#5840.

	* icomplete.el (icomplete-completions): Use `non-essential'.

	* net/tramp.el (tramp-connectable-p): New defun.
	(tramp-handle-expand-file-name)
	(tramp-completion-handle-file-name-all-completions)
	(tramp-completion-handle-file-name-completion): Use it.

2010-04-21  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/lisp.el (lisp-completion-at-point): Try and handle errors.

2010-04-21  Jan Djärv  <jan.h.d@swipnet.se>

	* vc-dir.el (vc-dir-tool-bar-map): Add :label on some tool bar items.

	* tool-bar.el (tool-bar-setup): Add :label on some tool bar items.

	* loadup.el: Load dynamic-setting.el if feature dynamic-setting
	is present.

	* info.el (info-tool-bar-map): Add labels.

	* cus-start.el (all): Add tool-bar-style and tool-bar-max-label-size.

	* cus-edit.el (custom-commands): Add labels for tool bar.
	(custom-buffer-create-internal, Custom-mode): Adjust for
	labels in custom-commands.

	* dynamic-setting.el: Renamed from font-setting.el.

2010-04-21  John Wiegley  <jwiegley@gmail.com>

	* ido.el (ido-init-completion-maps): For ido-switch-buffer, C-o
	toggles the use of virtual buffers.
	(ido-buffer-internal): Guard `ido-use-virtual-buffers' global value.
	(ido-toggle-virtual-buffers): New function.

2010-04-21  Juanma Barranquero  <lekktu@gmail.com>

	Use `define-derived-mode'; fix window selection; doc fixes.
	* play/tetris.el (tetris, tetris-update-speed-function)
	(tetris-tty-colors, tetris-x-colors, tetris-move-bottom)
	(tetris-move-left, tetris-move-right, tetris-rotate-prev)
	(tetris-rotate-next, tetris-end-game, tetris-start-game)
	(tetris-pause-game): Fix typos in docstrings.
	(tetris-mode-map, tetris-null-map):
	Move initialization into declaration.
	(tetris-mode): Define with `define-derived-mode';
	set show-trailing-whitespace to nil.
	(tetris): Prefer window already displaying the "*Tetris*" buffer.

2010-04-21  Karel Klíč  <kklic@redhat.com>

	* files.el (backup-buffer): Handle SELinux context, and return it
	if a backup was made by renaming.
	(backup-buffer-copy): Set SELinux context to the target file.
	(basic-save-buffer): Set SELinux context of the newly written file.
	(basic-save-buffer-1): Now it also returns any SELinux context.
	(basic-save-buffer-2): Set SELinux context of the newly created file,
	and return it.
	* net/tramp.el (tramp-file-name-for-operation):
	Add file-selinux-context.

2010-04-21  Stefan Monnier  <monnier@iro.umontreal.ca>

	Make the log-edit comments use RFC822 format throughout.

	* vc.el (vc-checkin, vc-modify-change-comment):
	Adjust to new vc-start/finish-logentry.
	(vc-find-conflicted-file): New command.
	(vc-transfer-file): Adjust to new vc-checkin.
	(vc-next-action): Improve scoping.

	* vc-hg.el (vc-hg-log-edit-mode): Remove.
	(vc-hg-checkin): Remove extra arg.  Use log-edit-extract-headers.

	* vc-git.el (vc-git-log-edit-mode): Remove.
	(vc-git-checkin): Remove extra arg.  Use log-edit-extract-headers.
	(vc-git-commits-coding-system): Rename from git-commits-coding-system.

	* vc-dispatcher.el (vc-log-edit): Shorten names for log-edit-show-files.
	(vc-start-logentry): Remove argument `extra'.
	(vc-finish-logentry): Remove extra args.

	* vc-bzr.el (vc-bzr-log-edit-mode): Remove.
	(vc-bzr-checkin): Remove extra arg.  Use log-edit-extract-headers.
	(vc-bzr-conflicted-files): New function.

	* log-edit.el (log-edit-extra-flags)
	(log-edit-before-checkin-process): Remove.
	(log-edit-summary, log-edit-header, log-edit-unknown-header): New faces.
	(log-edit-headers-alist): New var.
	(log-edit-header-contents-regexp): New const.
	(log-edit-match-to-eoh): New function.
	(log-edit-font-lock-keywords): Use them.
	(log-edit): Insert a "Summary:" header as default.
	(log-edit-mode): Mark font-lock rules as case-insensitive.
	(log-edit-done): Cleanup headers.
	(log-view-process-buffer): Remove.
	(log-edit-extract-headers): New function to replace it.

2010-04-20  Juanma Barranquero  <lekktu@gmail.com>

	* subr.el (default-direction-reversed): Remove obsolescence info.

2010-04-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-dispatcher.el (vc-finish-logentry): Don't mess so badly with the
	windows/frames.

	* emacs-lisp/lisp.el (lisp-completion-at-point): Complete around point.
	I.e. include text after point in the completion region.
	Also, return nil when we're not after/in a symbol.

	* international/mule-cmds.el (view-hello-file): Don't fiddle with the
	default enable-multibyte-characters.

2010-04-19  Stefan Monnier  <monnier@iro.umontreal.ca>

	* international/mule.el: Help the user choose a valid coding-system.
	(read-buffer-file-coding-system): New function.
	(set-buffer-file-coding-system): Use it.  Prompt the user if the
	coding-system cannot encode all the chars.

	* vc-bzr.el: Use standard *vc* and *vc-diff* buffers.
	(vc-bzr-shelve-show, vc-bzr-shelve-apply)
	(vc-bzr-shelve-apply-and-keep, vc-bzr-shelve-snapshot):
	Don't use *vc-bzr-shelve*.

2010-04-19  Dan Nicolaescu  <dann@ics.uci.edu>

	Fix the version number for added files.
	* vc-hg.el (vc-hg-working-revision): Check if the file is
	registered after hg parent fails (Bug#5961).

2010-04-19  Glenn Morris  <rgm@gnu.org>

	* htmlfontify.el (htmlfontify-buffer)
	(htmlfontify-copy-and-link-dir): Autoload entry points.

2010-04-19  Magnus Henoch  <magnus.henoch@gmail.com>

	* vc-hg.el (vc-hg-annotate-extract-revision-at-line): Expand file
	name relative to the project root (Bug#5960).

2010-04-19  Glenn Morris  <rgm@gnu.org>

	* vc-git.el (vc-git-print-log): Doc fix.

2010-04-19  Óscar Fuentes  <ofv@wanadoo.es>

	* ido.el (ido-file-internal): Fix 2009-12-02 change.

2010-04-19  Christoph  <cschol2112@googlemail.com>  (tiny change)

	* progmodes/grep.el (grep-compute-defaults): Fix handling of host
	default settings (Bug#5928).

2010-04-19  Glenn Morris  <rgm@gnu.org>

	* progmodes/fortran.el (fortran-match-and-skip-declaration):
	New function.
	(fortran-font-lock-keywords-3): Use it.  (Bug#1385)

2010-04-19  Kenichi Handa  <handa@m17n.org>

	* language/indian.el (malayalam-composable-pattern): Fix previous
	change (add U+0D4D "SIGN VIRAMA").
	(oriya-composable-pattern): Add U+0B30 and fix typo in the regexp.
	(tamil-composable-pattern): Fix typo in the regexp.
	(telugu-composable-pattern): Fix U+0C4D and typo in the regexp.
	(kannada-composable-pattern): Fix U+0CB0 and typo in the regexp.
	(malayalam-composable-pattern): Fix U+0D4D and typo in the regexp.

2010-04-19  Chong Yidong  <cyd@stupidchicken.com>

	* textmodes/tex-mode.el (latex-mode): Revert 2008-03-03 change to
	paragraph-separate (Bug#5821).

2010-04-19  Juri Linkov  <juri@jurta.org>

	Put breadcrumbs on overlay instead of inserting to buffer (bug#5809).

	* info.el (Info-find-node-2): Comment out code that skips
	breadcrumbs line.
	(Info-mouse-follow-link): New command.
	(Info-link-keymap): New keymap.
	(Info-breadcrumbs): Rename from `Info-insert-breadcrumbs'.
	Return a string with links instead of inserting breadcrumbs
	to the Info buffer.
	(Info-fontify-node): Comment out code that inserts breadcrumbs.
	Instead of putting the `invisible' text property over the Info
	header, make an overlay over the Info header with the `invisible'
	property and `after-string' set to the string returned by
	`Info-breadcrumbs'.

2010-04-19  Chong Yidong  <cyd@stupidchicken.com>

	* help.el (help-window-setup-finish): Doc fix (Bug#5830).
	Reported by monkey@sandpframing.com.

2010-04-19  Stefan Monnier  <monnier@iro.umontreal.ca>

	* tmm.el (tmm-prompt): Remove obsolete call to x-popup-menu.
	(tmm-get-keymap): Add key-binding shortcuts now that they're not
	available in the "keyseq cache" any more.

	* custom.el (defcustom): Add edebug spec.

2010-04-18  Juri Linkov  <juri@jurta.org>

	Test for special mode-class in view-buffer instead of view-file (bug#5513).

	* view.el (view-file, view-buffer): Move test for special mode-class
	from view-file to view-buffer.

	* tar-mode.el (tar-extract): Turn if's into one cond
	like in arc-mode.el.

2010-04-18  Juri Linkov  <juri@jurta.org>

	Add 7z archive format support (bug#5475).

	* arc-mode.el (archive-zip-extract): Try to find 7z executable.
	(archive-7z-extract): New defcustom.
	(archive-find-type): Add magic string for 7z.
	(archive-extract-by-stdout): Add new optional arg `stderr-file'.
	If `stderr-file' is non-nil, use `(t stderr-file)' for the
	`buffer' arg of `call-process'.
	(archive-zip-extract): Check `archive-zip-extract' for "7z" and
	call the function `archive-7z-extract' with the variable
	`archive-7z-extract' let-bound to `archive-zip-extract'.
	(archive-7z-summarize, archive-7z-extract): New functions.

	* international/mule.el (auto-coding-alist):
	* files.el (auto-mode-alist): Add 7z file extension.

2010-04-18  Stefan Monnier  <monnier@iro.umontreal.ca>

	* loadup.el: Setup hash-cons for pure data.

	Fix duplicate entries in cedet's loaddefs.el files.
	* emacs-lisp/autoload.el (autoload-file-load-name): Be more clever.
	Should make most file-local generated-autoload-file unnecessary.
	(print-readably): Silence warnings.
	(autoload-find-destination): Take load-name as an arg to make sure
	it's the same as the one that will be in the file.
	(autoload-generate-file-autoloads): Adjust to above changes.
	Try to make the dataflow a bit simpler.

	* cvs-status.el (cvs-refontify): Remove unused.

2010-04-18  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc.el (calc-mode-map): Bind "O" to `calc-missing-key'.

	* calc/calc-bin.el (calc-radix): Have the "O" option turn on
	twos-complement mode.

2010-04-17  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-ext.el (calc-init-extensions): Add keybinding for
	'calc-option'.  Add `calc-option-prefix-help' to calc-help autoloads.
	(calc-inverse): Add "Option" to message, as appropriate.
	(calc-hyperbolic): Add "Option" to message, as appropriate.
	(calc-option, calc-is-option): New functions.

	* calc/calc-help.el (calc-full-help): Add `calc-option-help'.
	(calc-option-prefix-help): New function.

	* calc/calc-misc.el (calc-help): Add "Option" entry.

	* calc/calc.el (calc-local-var-list): Add `calc-option-flag'.
	(calc-option-flag): New variable.
	(calc-do): Set `calc-option-flag to nil.
	(calc-set-mode-line): Add "Opt " as appropriate.

2010-04-16  Juri Linkov  <juri@jurta.org>

	Move scrolling commands from simple.el to window.el
	because their primitives are implemented in window.c.

	* simple.el (scroll-error-top-bottom)
	(scroll-up-command, scroll-down-command, scroll-up-line)
	(scroll-down-line, scroll-other-window-down)
	(beginning-of-buffer-other-window, end-of-buffer-other-window):
	* window.el (scroll-error-top-bottom)
	(scroll-up-command, scroll-down-command, scroll-up-line)
	(scroll-down-line, scroll-other-window-down)
	(beginning-of-buffer-other-window, end-of-buffer-other-window):
	Move from simple.el to window.el because their primitives are
	implemented in window.c.

2010-04-16  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-lookup-scroll-key): Check both
	`isearch-scroll' and `scroll-command' properties.
	(scroll-up, scroll-down): Remove `isearch-scroll' property.

	* mwheel.el (mwheel-scroll): Remove `isearch-scroll' property.

	* simple.el (scroll-up-command, scroll-down-command)
	(scroll-up-line, scroll-down-line): Remove `isearch-scroll' property.

2010-04-15  Juri Linkov  <juri@jurta.org>

	* simple.el (scroll-up-command, scroll-down-command)
	(scroll-up-line, scroll-down-line): Put `scroll-command'
	property on the these symbols.  Remove them from
	`scroll-preserve-screen-position-commands'.

	* mwheel.el (mwheel-scroll): Put `scroll-command' and
	`isearch-scroll' properties on the `mwheel-scroll' symbol.
	Remove it from `scroll-preserve-screen-position-commands'.

	* isearch.el (isearch-allow-scroll): Doc fix.

2010-04-15  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-error-with-buffer): Don't show the
	connection buffer when we are in completion mode.
	(tramp-file-name-handler): Catch the error for some operations
	when we are in completion mode.  This gives the user the chance to
	correct the file name in the minibuffer.

2010-04-15  Glenn Morris  <rgm@gnu.org>

	* progmodes/verilog-mode.el (verilog-forward-sexp): Avoid free variable.

2010-04-15  Juanma Barranquero  <lekktu@gmail.com>

	Simplify by using `define-derived-mode'.
	* info.el (Info-mode):
	* calendar/todo-mode.el (todo-mode):
	* play/gomoku.el (gomoku-mode): Define with `define-derived-mode'.
	(gomoku-mode-map): Move initialization into declaration.

2010-04-14  Michael Albinus  <michael.albinus@gmx.de>

	Fix Bug#5840.
	* ido.el (ido-file-name-all-completions-1):
	* minibuffer.el (minibuffer-completion-help):
	* net/tramp.el (tramp-completion-mode-p): Use `non-essential'.

2010-04-14  Stefan Monnier  <monnier@iro.umontreal.ca>

	* simple.el (non-essential): New var.

	Add a new field `location' to bookmarks for non-file bookmarks.
	* bookmark.el (bookmark-location): Use the new field, if present.
	(bookmark-insert-location): Undo last change, not needed any more.
	* man.el (Man-bookmark-make-record):
	* woman.el (woman-bookmark-make-record): Add `location' field.

2010-04-14  Juri Linkov  <juri@jurta.org>

	* simple.el (scroll-error-top-bottom): New defcustom.
	(scroll-up-command, scroll-down-command): Use it.  Doc fix.

	* emulation/pc-select.el (pc-select-override-scroll-error):
	Obsolete in favor of `scroll-error-top-bottom'.

2010-04-14  Juri Linkov  <juri@jurta.org>

	* tutorial.el (tutorial--default-keys): Rebind `C-v' to
	`scroll-up-command' and `M-v' to `scroll-down-command'.

	* emulation/cua-rect.el (cua--init-rectangles):
	* forms.el (forms--change-commands):
	* image-mode.el (image-mode-map):
	Remap scroll-down-command and scroll-up-command
	in addition to scroll-down and scroll-up.

2010-04-14  Juri Linkov  <juri@jurta.org>

	* mwheel.el (scroll-preserve-screen-position-commands):
	Add mwheel-scroll to this list of commands.

	* simple.el (scroll-preserve-screen-position-commands):
	Add scroll-up-command, scroll-down-command, scroll-up-line,
	scroll-down-line to this list of commands.

2010-04-13  Stefan Monnier  <monnier@iro.umontreal.ca>

	* obsolete/complete.el: Move from lisp/complete.el.

	* pcomplete.el (pcomplete-here*): Fix mistaken change (bug#5935).

	* emacs-lisp/easy-mmode.el (define-minor-mode): Passing a nil argument
	to the minor mode function now turns the mode ON unconditionally.

2010-04-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-dir.el (vc-dir-kill-line): New command.
	(vc-dir-mode-map): Bind it to C-k.

	* bookmark.el (bookmark-insert-location): Handle a nil filename.

	* woman.el: Add bookmark declarations to silence the compiler.
	(bookmark-prop-get): Use `man-args' rather than `filename' as a first
	step to compatibility between man and woman bookmarks.
	Adjust for Man-default-bookmark-title renaming.
	(woman-bookmark-jump): Adjust accordingly.  Don't forget to autoload.

	* man.el: Add bookmark declarations to silence the compiler.
	(Man-name-local-regexp): Make it match NAME as well.
	(Man-getpage-in-background): Return the buffer.
	(Man-notify-when-ready): Use `case'.
	(man-set-default-bookmark-title): Rename to Man-default-bookmark-title.
	Don't hardcode "NAME".  Simplify.
	(Man-bookmark-make-record): Use Man-arguments rather than buffer-name.
	Rename from Man-bookmark-make-record.
	(Man-bookmark-jump): Rename from man-bookmark-jump.  Simplify now that
	we have the actual man-args.  Use Man-getpage-in-background rather
	than `man' since the arg is already processed.  Let bookmark.el do the
	window handling.  Only wait for the relevant process.
	Don't forget to autoload.

	* bookmark.el (bookmark-default-file): Use locate-user-emacs-file.

2010-04-12  Thierry Volpiatto  <thierry.volpiatto@gmail.com>

	* woman.el (woman-bookmark-make-record, woman-bookmark-jump):
	New functions.
	(woman-mode): Setup bookmark support.

	* man.el (man-set-default-bookmark-title, man-bookmark-make-record)
	(man-bookmark-jump): New functions.
	(Man-mode): Setup bookmark support.

2010-04-10  Jari Aalto  <jari.aalto@cante.net>

	* comint.el (comint-password-prompt-regexp): Use regexp-opt, and
	recognize ssh-keygen prompt (Bug#2817).

2010-04-10  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-do-copy-or-rename-file): Add progress reporter.

2010-04-10  Michael Albinus  <michael.albinus@gmx.de>

	Synchronize with Tramp repository.

	* net/tramp.el (tramp-completion-function-alist)
	(tramp-file-name-regexp, tramp-chunksize)
	(tramp-local-coding-commands, tramp-remote-coding-commands):
	Fix docstring.
	(tramp-remote-process-environment): Use `format' instead of `concat'.
	(tramp-handle-directory-files-and-attributes)
	(tramp-get-remote-path): Use `copy-tree'.
	(tramp-handle-file-name-all-completions): Backward/ XEmacs
	compatibility: Use `completion-ignore-case' if
	`read-file-name-completion-ignore-case' does not exist.
	(tramp-do-copy-or-rename-file-directly): Do not use
	`tramp-handle-file-remote-p'.
	(tramp-do-copy-or-rename-file-out-of-band):
	Use `tramp-compat-delete-directory'.
	(tramp-do-copy-or-rename-file-out-of-band)
	(tramp-compute-multi-hops, tramp-maybe-open-connection):
	Use `format-spec-make'.
	(tramp-find-foreign-file-name-handler)
	(tramp-advice-make-auto-save-file-name)
	(tramp-set-auto-save-file-modes): Remove superfluous check for
	`stringp'.  This is done inside `tramp-tramp-file-p'.
	(tramp-debug-outline-regexp): New defconst.
	(tramp-get-debug-buffer): Use it.
	(tramp-check-for-regexp): Use (forward-line 1).
	(tramp-set-auto-save-file-modes): Adapt version check.

	* net/tramp-compat.el (tramp-advice-file-expand-wildcards):
	Wrap call of `featurep' for 2nd argument.
	(tramp-compat-make-temp-file): Simplify fallback implementation.
	(tramp-compat-copy-tree): Remove function.
	(tramp-compat-delete-directory): Provide implementation for older
	Emacsen.

	* net/tramp-fish.el (tramp-fish-handle-directory-files-and-attributes):
	Do not use `tramp-fish-handle-file-attributes.

	* net/trampver.el: Update release number.

2010-04-10  Glenn Morris  <rgm@gnu.org>

	* progmodes/compile.el (compilation-save-buffers-predicate):
	Add missing :version tag.

2010-04-09  Sam Steingold  <sds@gnu.org>

	* progmodes/compile.el (compilation-save-buffers-predicate):
	Remove the "autoload" cookie.

	* progmodes/bug-reference.el (turn-on-bug-reference-mode)
	(turn-on-bug-reference-prog-mode): Remove, `bug-reference-mode'
	and `bug-reference-prog-mode' can be used in hooks directly.

2010-04-09  Dan Nicolaescu  <dann@ics.uci.edu>

	Add --author support to git commit.
	* vc-git.el (vc-git-checkin): Pass extra-args to the commit command.
	(vc-git-log-edit-mode): New minor mode.
	(log-edit-mode, log-edit-extra-flags, log-edit-mode):
	New declarations.

2010-04-09  Eric Raymond  <esr@snark.thyrsus.com>

	* vc-hooks.el, vc-git.el: Improve documentation comments.

2010-04-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	Fix some of the problems in defsubst* (bug#5728).
	* emacs-lisp/cl-macs.el (defsubst*): Don't substitute non-trivial args.
	(cl-defsubst-expand): Do the substitutions simultaneously (bug#5728).

2010-04-07  Sam Steingold  <sds@gnu.org>

	* progmodes/compile.el (compilation-save-buffers-predicate):
	New custom variable.
	(compile, recompile): Pass it to `save-some-buffers'.

2010-04-07  Jan Djärv  <jan.h.d@swipnet.se>

	* wid-edit.el (widget-choose): Move cursor to the second line of
	the buffer (Bug#5695).

2010-04-07  Dan Nicolaescu  <dann@ics.uci.edu>

	Add new VC methods: vc-log-incoming and vc-log-outgoing.
	* vc.el (vc-print-log-setup-buttons): New function split out from
	vc-print-log-internal.
	(vc-log-internal-common): New function, a parametrized version of
	vc-print-log-internal.
	(vc-print-log-internal): Just call vc-log-internal-common with the
	right arguments.
	(vc-incoming-outgoing-internal):
	(vc-log-incoming, vc-log-outgoing): New functions.
	(vc-log-view-type): New permanent local variable.

	* vc-hooks.el (vc-menu-map): Bind vc-log-incoming and vc-log-outgoing.

	* vc-bzr.el (vc-bzr-log-view-mode): Use vc-log-view-type instead
	of the dynamic bound vc-short-log.
	(vc-bzr-log-incoming, vc-bzr-log-outgoing): New functions.

	* vc-git.el (vc-git-log-outgoing): New function.
	(vc-git-log-view-mode): Use vc-log-view-type instead
	of the dynamic bound vc-short-log.

	* vc-hg.el (vc-hg-log-view-mode): Use vc-log-view-type instead
	of the dynamic bound vc-short-log.  Highlight the tag.
	(vc-hg-log-incoming, vc-hg-log-outgoing): New functions.
	(vc-hg-outgoing, vc-hg-incoming, vc-hg-outgoing-mode):
	(vc-hg-incoming-mode): Remove.
	(vc-hg-extra-menu-map): Do not bind vc-hg-incoming and vc-hg-outgoing.

2010-04-07  Dan Nicolaescu  <dann@ics.uci.edu>

	Fix default-directory for vc-root-diff.
	* vc.el (vc-root-diff): Bind default-directory to the root
	directory for the diff command.

2010-04-07  Michael McNamara  <mac@mail.brushroad.com>

	* progmodes/verilog-mode.el (verilog-forward-sexp):
	(verilog-calc-1): Support "disable fork" and "fork wait" multi
	word keywords, suggested by Steve Pearlmutter.
	(verilog-pretty-declarations): Support lineup of declarations in
	port lists.
	(verilog-skip-backward-comments, verilog-skip-forward-comment-p):
	fix bug for /* / comments.
	(verilog-backward-syntactic-ws, verilog-forward-syntactic-ws):
	Speed up and simplfy as this is never called with a bound.
	(verilog-pretty-declarations): Enhance to line up declarations
	inside a parameter list, suggested by Alan Morgan.
	(verilog-pretty-expr): Tune assignment regular expression match
	string for corner cases; also use markers instead of character
	number as indent changes the later.

2010-04-07  Wilson Snyder  <wsnyder@wsnyder.org>

	* progmodes/verilog-mode.el (verilog-type-keywords): Fix pulldown
	as missing keyword.
	(verilog-read-sub-decls-line): Fix comments in AUTO_TEMPLATE
	causing truncation of AUTOWIRE signals.  Reported by Bruce Tennant.
	(verilog-auto-inst, verilog-auto-inst-port): Add vl_mbits for
	AUTO_TEMPLATEs needing multiple array bits.  Suggested by Bruce
	Tennant.
	(verilog-keywords):
	(verilog-1800-2005-keywords, verilog-1800-2009-keywords): Add IEEE
	1800-2009 keywords, including "global.".

2010-04-06  John Wiegley  <jwiegley@gmail.com>

	* ido.el (ido-add-virtual-buffers-to-list): Fix duplicated names
	appearing in buffer list (if a live buffer name matched a recentf
	file basename).  Should use uniquify to offer a real solution.

2010-04-06  John Wiegley  <jwiegley@gmail.com>

	* ido.el (ido-use-virtual-buffers, ido-virtual): Move a ChangeLog
	comment to code, and add a :version tag.
	(ido-virtual-buffers): Move defvar to fix byte-compiler warning.

2010-04-06  Juanma Barranquero  <lekktu@gmail.com>

	Enable recentf-mode if using virtual buffers.
	* ido.el (recentf-list): Declare for byte-compiler.
	(ido-virtual-buffers): Move up to silence byte-compiler.  Add docstring.
	(ido-make-buffer-list): Simplify.
	(ido-add-virtual-buffers-to-list): Simplify.  Enable recentf-mode.

2010-04-05  Juri Linkov  <juri@jurta.org>

	Scrolling commands which scroll a line instead of full screen.
	http://lists.gnu.org/archive/html/emacs-devel/2010-03/msg01452.html

	* simple.el (scroll-up-line, scroll-down-line): New commands.
	Put property isearch-scroll=t on them.

	* emulation/ws-mode.el (scroll-down-line, scroll-up-line):
	Remove commands.

2010-04-05  Juri Linkov  <juri@jurta.org>

	Scrolling commands which do not signal errors at top/bottom.
	http://lists.gnu.org/archive/html/emacs-devel/2010-03/msg01452.html

	* simple.el (scroll-up-command, scroll-down-command): New commands.
	Put property isearch-scroll=t on them.

	* bindings.el (global-map): Rebind [prior] from `scroll-down' to
	`scroll-down-command' and [next] from `scroll-up' to
	`scroll-up-command'.

	* emulation/cua-base.el: Put property CUA=move on
	`scroll-up-command' and `scroll-down-command'.
	(cua--init-keymaps): Remap `scroll-up-command' to `cua-scroll-up'
	and `scroll-down-command' to `cua-scroll-down'.

2010-04-05  Juanma Barranquero  <lekktu@gmail.com>

	* help.el (describe-mode): Return nil.

2010-04-04  John Wiegley  <jwiegley@gmail.com>

	* ido.el (ido-use-virtual-buffers): New variable to indicate
	whether "virtual buffer" support is enabled for IDO.
	(ido-virtual): Face used to indicate virtual buffers in the list.
	(ido-buffer-internal): If a buffer is chosen, and no such buffer
	exists, but a virtual buffer of that name does (which would be why
	it was in the list), recreate the buffer by reopening the file.
	(ido-make-buffer-list): If virtual buffers are being used, call
	`ido-add-virtual-buffers-to-list' before the make list hook.
	(ido-virtual-buffers): New variable which contains a copy of the
	current contents of the `recentf-list', albeit pared down for the
	sake of speed, and with proper faces applied.
	(ido-add-virtual-buffers-to-list): Using the `recentf-list',
	create a list of "virtual buffers" to present to the user in
	addition to the currently open set.  Note that this logic could
	get rather slow if that list is too large.  With the default
	`recentf-max-saved-items' of 200, there is little speed penalty.

2010-04-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	* font-lock.el: Require CL when compiling.
	(font-lock-turn-on-thing-lock): Use `case'.

2010-04-03  Eli Zaretskii  <eliz@gnu.org>

	* emacs-lisp/authors.el (authors-fixed-entries): Add entry for Eli
	Zaretskii.

2010-04-02  Juri Linkov  <juri@jurta.org>

	* ehelp.el (electric-help-orig-major-mode):
	New buffer-local variable.
	(electric-help-mode): Set it to original major-mode.  Doc fix.
	(with-electric-help): Use `electric-help-orig-major-mode' instead
	of (default-value 'major-mode).  Doc fix.
	http://lists.gnu.org/archive/html/emacs-devel/2010-04/msg00069.html

2010-04-02  Sam Steingold  <sds@gnu.org>

	* vc-hg.el (vc-hg-push, vc-hg-pull): Use `apply' when calling
	`vc-hg-command' with a list of flags.

	* progmodes/bug-reference.el (bug-reference-bug-regexp):
	Also accept "patch" and "RFE".
	(bug-reference-fontify): `bug-reference-url-format' can also be a
	function to be able to handle the bug kind.
	(turn-on-bug-reference-mode, turn-on-bug-reference-prog-mode): Add.

2010-04-02  Jan Djärv  <jan.h.d@swipnet.se>

	* tmm.el (tmm-get-keymap): Check with symbolp before passing
	value to fboundp, it may not be a symbol.

2010-03-31  Chong Yidong  <cyd@stupidchicken.com>

	* cus-edit.el (custom-buffer-sort-alphabetically): Update :version.

2010-03-31  Juri Linkov  <juri@jurta.org>

	* simple.el (next-line, previous-line): Re-throw a signal
	with `signal' instead of using `ding'.
	http://lists.gnu.org/archive/html/emacs-devel/2010-03/msg01432.html

2010-03-31  Juri Linkov  <juri@jurta.org>

	* simple.el (keyboard-escape-quit): Raise deselecting the active
	region higher than exiting the minibuffer.
	http://lists.gnu.org/archive/html/emacs-devel/2010-03/msg00904.html

2010-03-31  Juri Linkov  <juri@jurta.org>

	* image.el (image-animated-p): Use `image-metadata' instead of
	`image-extension-data'.  Get GIF extenstion data from metadata
	property `extension-data'.

2010-03-31  Stefan Monnier  <monnier@iro.umontreal.ca>

	* simple.el (append-to-buffer): Simplify.

2010-03-31  Tomas Abrahamsson  <tab@lysator.liu.se>

	* textmodes/artist.el (artist-mode): Fix typo in docstring.
	Reported by Alex Schröder <kensanata@gmail.com>.  (Bug#5807)

2010-03-31  Kenichi Handa  <handa@m17n.org>

	* language/sinhala.el (composition-function-table): Fix regexp for
	the new Unicode specification.

	* language/indian.el (devanagari-composable-pattern)
	(tamil-composable-pattern, kannada-composable-pattern)
	(malayalam-composable-pattern): Adjust for the new Unicode
	specification.
	(bengali-composable-pattern, gurmukhi-composable-pattern)
	(gujarati-composable-pattern, oriya-composable-pattern)
	(telugu-composable-pattern): New variables to cope with the new
	Unicode specification.  Use them in composition-function-table.

2010-03-31  Stefan Monnier  <monnier@iro.umontreal.ca>

	Make tmm-menubar work for the Buffers menu again (bug#5726).
	* tmm.el (tmm-prompt): Also handle keymap entries in the form of
	vectors rather than cons cells, as used in menu-bar-update-buffers.

2010-03-31  Chong Yidong  <cyd@stupidchicken.com>

	* progmodes/js.el (js-auto-indent-flag, js-mode-map)
	(js-insert-and-indent): Revert 2009-08-15 change, restoring
	electric punctuation for "{}();,:" (Bug#5586).

	* mail/sendmail.el (mail-default-directory): Doc fix.

2010-03-31  Chong Yidong  <cyd@stupidchicken.com>

	* mail/sendmail.el (mail-default-directory): Doc fix.

2010-03-31  Eli Zaretskii  <eliz@gnu.org>

	* subr.el (version-regexp-alist, version-to-list)
	(version-list-<, version-list-=, version-list-<=)
	(version-list-not-zero, version<, version<=, version=): Doc fix.
	(Bug#5744).

2010-02-31  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc.el (vc-root-diff): Doc fix.

2010-03-31  Chong Yidong  <cyd@stupidchicken.com>

	* vc.el (vc-print-log, vc-print-root-log): Doc fix.

	* simple.el (append-to-buffer): Fix last change.

2010-03-31  Chong Yidong  <cyd@stupidchicken.com>

	* simple.el (append-to-buffer): Ensure that point is preserved if
	BUFFER is the current buffer.  Suggested by YAMAMOTO Mitsuharu.
	(Bug#5749)

2010-03-31  Stefan Monnier  <monnier@iro.umontreal.ca>

	* files.el (auto-mode-case-fold): Change default to t.

2010-03-30  Juri Linkov  <juri@jurta.org>

	* dired-x.el (dired-omit-mode): Doc fix.

2010-03-30  Juri Linkov  <juri@jurta.org>

	* replace.el (occur-accumulate-lines): Move occur-engine related
	functions `occur-accumulate-lines' and `occur-engine-add-prefix'
	to be located after `occur-engine'.

2010-03-30  Juri Linkov  <juri@jurta.org>

	Make occur handle multi-line matches cleanly with context.
	http://lists.gnu.org/archive/html/emacs-devel/2010-03/msg01280.html

	* replace.el (occur-accumulate-lines): Add optional arg `pt'.
	(occur-engine): Add local variables `ret', `prev-after-lines',
	`prev-lines'.  Use more arguments for `occur-context-lines'.
	Set first elem of its returned list to `data', and the second elem
	to `prev-after-lines'.  Don't print the separator line.
	In the end, print remaining context after-lines.
	(occur-context-lines): Add new arguments `begpt', `endpt',
	`lines', `prev-lines', `prev-after-lines'.  Rewrite to combine
	after-lines of the previous match with before-lines of the
	current match and not overlap them.  Return a list with two
	values: the output line and the list of context after-lines.

2010-03-30  Juri Linkov  <juri@jurta.org>

	* replace.el (occur-accumulate-lines): Fix a bug where the first
	context line at the beginning of the buffer was missing.

2010-03-30  Eli Zaretskii  <eliz@gnu.org>

	* files.el: Make bidi-display-reordering safe variable for boolean
	values.

2010-03-29  Phil Hagelberg  <phil@evri.com>
            Chong Yidong  <cyd@stupidchicken.com>

	* subr.el: Extend progress reporters to perform "spinning".
	(progress-reporter-update, progress-reporter-do-update):
	Handle non-numeric value arguments.
	(progress-reporter--pulse-characters): New var.

2010-03-28  Chong Yidong  <cyd@stupidchicken.com>

	* progmodes/compile.el (compilation-start): Fix regexp detection
	of initial cd command (Bug#5771).

2010-03-28  Stefan Guath  <stefan@automata.se>  (tiny change)

	* find-dired.el (find-dired): Use read-directory-name (Bug#5777).

2010-03-27  Nick Roberts  <nickrob@snap.net.nz>

	Restore GDB/MI fuctionality removed by 2009-12-29T07:15:34Z!nickrob@snap.net.nz.
	* progmodes/gdb-mi.el: Restore.
	* progmodes/gdb-ui.el: Remove.
	* progmodes/gud.el: Re-accommodate for gdb-mi.el.

2010-03-25  Glenn Morris  <rgm@gnu.org>

	* desktop.el (desktop-save-buffer-p): Don't mistakenly include
	all dired buffers, even tramp ones.  (Bug#5755)

2010-03-25  Stefan Monnier  <monnier@iro.umontreal.ca>

	Add "union tags" in mpc.el.
	* mpc.el: Remove backward compatibility code.
	(mpc-browser-tags): Change default.
	(mpc--find-memoize-union-tags): New var.
	(mpc-cmd-flush, mpc-cmd-special-tag-p): New fun.
	(mpc-cmd-find): Handle the case where the playlist does not exist.
	Handle union-tags.
	(mpc-cmd-list): Use mpc-cmd-special-tag-p.  Handle union-tags.
	(mpc-cmd-add): Use mpc-cmd-flush.
	(mpc-tagbrowser-tag-name): New fun.
	(mpc-tagbrowser-buf): Use it.
	(mpc-songs-refresh): Use cond.  Move to point-min as a fallback.

2010-03-24  Stefan Monnier  <monnier@iro.umontreal.ca>

	Misc cleanup.
	* progmodes/make-mode.el (makefile-bsdmake-rule-action-regex):
	Use replace-regexp-in-string.
	(makefile-mode-abbrev-table): Merge defvar and define-abbrev-table.
	(makefile-imake-mode-syntax-table): Move init into defvar.
	(makefile-mode): Use define-derived-mode.

	* progmodes/make-mode.el (makefile-rule-action-regex): Backtrack less.
	(makefile-make-font-lock-keywords): Adjust rule since submatch 1 may
	not be present any more.

2010-03-24  Juanma Barranquero  <lekktu@gmail.com>

	* faces.el (set-face-attribute): Fix typo in docstring.
	(face-valid-attribute-values): Reflow docstring.

2010-03-24  Glenn Morris  <rgm@gnu.org>

	* textmodes/flyspell.el (sgml-lexical-context): Autoload it (Bug#5752).

2010-03-24  Chong Yidong  <cyd@stupidchicken.com>

	* indent.el (indent-for-tab-command): Doc fix.

2010-03-24  Alan Mackenzie  <acm@muc.de>

	* progmodes/cc-engine.el (c-remove-stale-state-cache):
	Fix off-by-one error.  Fixes bug #5747.

2010-03-24  Juanma Barranquero  <lekktu@gmail.com>

	* image-dired.el (image-dired-display-thumbs): Fix typo in docstring.
	(image-dired-read-comment): Doc fix.

	* json.el (json-object-type, json-array-type, json-key-type)
	(json-false, json-null, json-read-number):
	* minibuffer.el (completion-in-region-functions):
	* calendar/cal-tex.el (cal-tex-daily-end, cal-tex-number-weeks)
	(cal-tex-cursor-week):
	* emacs-lisp/trace.el (trace-function):
	* eshell/em-basic.el (eshell/printnl):
	* eshell/em-dirs.el (eshell-last-dir-ring, eshell-parse-drive-letter)
	(eshell-read-last-dir-ring, eshell-write-last-dir-ring):
	* obsolete/levents.el (allocate-event, event-key, event-object)
	(event-point, event-process, event-timestamp, event-to-character)
	(event-window, event-x, event-x-pixel, event-y, event-y-pixel):
	* textmodes/reftex-vars.el (reftex-index-macros-builtin)
	(reftex-section-levels, reftex-auto-recenter-toc, reftex-toc-mode-hook)
	(reftex-cite-punctuation, reftex-search-unrecursed-path-first)
	(reftex-highlight-selection): Fix typos in docstrings.

2010-03-24  Juanma Barranquero  <lekktu@gmail.com>

	* minibuffer.el (completion-in-region-functions): Fix docstring typos.

2010-03-24  Glenn Morris  <rgm@gnu.org>

	* mail/rmail.el (rmail-highlight-face): Restore option deleted
	2008-02-13 without comment; mark it obsolete.
	(rmail-highlight-headers): Use rmail-highlight-face once more.

2010-03-24  Chong Yidong  <cyd@stupidchicken.com>

	* woman.el (woman2-process-escapes): Only consume the newline if
	the filler character is on a line by itself (Bug#5729).

2010-03-24  Kenichi Handa  <handa@m17n.org>

	* language/indian.el (devanagari-composable-pattern): Add more
	consonants.

2010-03-24  Michael Albinus  <michael.albinus@gmx.de>

	* net/trampver.el: Update release number.

2010-03-24  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-find-executable):
	Use `tramp-get-connection-buffer'.  Make the regexp for checking
	output of "wc -l" more robust.
	(tramp-find-shell): Use another shell but /bin/sh on OpenSolaris.
	(tramp-open-connection-setup-interactive-shell): Remove workaround
	for OpenSolaris bug, it is not needed anymore.

2010-03-24  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/cl-macs.el (defsubst*): Add autoload cookie.  (Bug#4427)

2010-03-24  Wilson Snyder  <wsnyder@wsnyder.org>

	* files.el (auto-mode-alist): Accept more verilog file patterns.

2010-03-24  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-dir.el (vc-dir-headers): Abbreviate the working dir.

2010-03-24  Glenn Morris  <rgm@gnu.org>

	* vc-bzr.el (vc-bzr-log-edit-mode): Add --fixes support to
	log-edit-before-checkin-process.

	* vc.el (vc-modify-change-comment): Pass MODE to vc-start-logentry.

	* vc.el, vc-bzr.el, vc-hg.el (log-edit-mode): Declare.

	* vc-dispatcher.el (vc-start-logentry): Doc fix.
	(log-view-process-buffer, log-edit-extra-flags): Declare.

	* log-edit.el (log-edit-before-checkin-process): Doc fix.

2010-03-23  Sam Steingold  <sds@gnu.org>

	Fix bug#5620: recalculate all markers on compilation buffer
	modifications, not on file modifications.
	* progmodes/compile.el (buffer-modtime): New buffer-local variable:
	the buffer modification time, for buffers not associated with files.
	(compilation-mode): Create it.
	(compilation-filter): Update it.
	(compilation-next-error-function): Use it instead of
	`visited-file-modtime' for timestamp.

2010-03-23  Juri Linkov  <juri@jurta.org>

	Implement Occur multi-line matches.
	http://lists.gnu.org/archive/html/emacs-devel/2010-03/msg01044.html

	* replace.el (occur): Doc fix.
	(occur-engine): Set `begpt' to the beginning of the first line.
	Set `endpt' to the end of the last match line.  At first, count
	line numbers between `origpt' and `begpt'.  Split out code from
	`out-line' variable to new let-bindings `match-prefix' and
	`match-str'.  In `out-line' add non-numeric prefix to all
	non-first lines of multi-line matches.  Finally, count lines
	between `begpt' and `endpt' and add to `lines'.

2010-03-23  Juri Linkov  <juri@jurta.org>

	* replace.el (occur-accumulate-lines, occur-engine):
	Use `occur-engine-line' instead of duplicate code.
	(occur-engine-line): New function created from duplicate code
	in `occur-accumulate-lines' and `occur-engine'.

	* replace.el (occur-engine-line): Add optional arg `keep-props'.
	(occur-accumulate-lines, occur-engine): Add arg `keep-props'.

2010-03-23  Juri Linkov  <juri@jurta.org>

	* finder.el: Remove TODO tasks.

	* info.el (Info-finder-find-node): Add node "all"
	with all package info.  Handle a list of multiple keywords
	separated by comma.
	(info-finder): In interactive use with a prefix argument,
	use `completing-read-multiple' to read a list of keywords
	separated by comma.

2010-03-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	Add a new completion style `substring'.
	* minibuffer.el (completion-basic--pattern): New function.
	(completion-basic-try-completion, completion-basic-all-completions):
	Use it.
	(completion-substring--all-completions)
	(completion-substring-try-completion)
	(completion-substring-all-completions): New functions.
	(completion-styles-alist): New style `substring'.

2010-03-22  Stefan Monnier  <monnier@iro.umontreal.ca>

	Get rid of .elc files after removal of the corresponding .el.
	* Makefile.in (compile-clean): New target.
	(compile-main): Use it.

2010-03-22  Jan Djärv  <jan.h.d@swipnet.se>

	* Makefile.in (compile-main): cd to $(lisp) in a sub-shell, so we
	don't do make there.  When compiling with separate object dir, there
	is no Makefile there.

2010-03-22  Stefan Monnier  <monnier@iro.umontreal.ca>

	Get rid of the ELCFILES abomination, again.
	* Makefile.in (update-elclist, ELCFILES, compile-last): Remove.
	(all, compile): Don't call compile-last.
	(compile-main): Build the "elcfiles" list dynamically.
	(compile-targets): New (internal) target.

2010-03-21  Andreas Schwab  <schwab@linux-m68k.org>

	* Makefile.in (top_srcdir): Define.
	(abs_top_builddir): Define.
	(srcdir): Don't append `/..'.
	(EMACS): Use ${abs_top_builddir}.
	(all, compile, compile-always, compile-last): Don't set emacswd.
	(update-subdirs, update-authors): Use $(top_srcdir) instead of
	$(srcdir).
	(lisp): Use $(srcdir) instead of @srcdir@.

2010-03-21  Juri Linkov  <juri@jurta.org>

	Fix message of multi-line occur regexps and multi-buffer header lines.
	http://lists.gnu.org/archive/html/emacs-devel/2010-03/msg00457.html

	* replace.el (occur-1): Don't display regexp if it is longer
	than window-width.  Use `query-replace-descr' to display regexp.
	(occur-engine): Don't display regexp in the buffer header for
	multi-buffer occur.  Display a separate header line with total
	match count and regexp for multi-buffer occur.
	Use `query-replace-descr' to display regexp.

2010-03-20  Teodor Zlatanov  <tzz@lifelogs.com>

	* net/secrets.el: Fix parenthesis.
	(secrets-enabled): Fix parenthesis.

2010-03-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	Use more relative file and directory names.
	* Makefile.in (EMACS): Arrange for it to work when we chdir.
	(setwins, setwins_almost, setwins_for_subdirs):
	Don't `cd'; output relative names.
	(all, compile, compile-always, compile-last): Set emacswd.
	(custom-deps, finder-data, autoloads, update-subdirs, compile-last):
	Just cd to the lisp source dir so we can use relative file names.

	* outline.el (hide-sublevels): Unfix the paren non-typo! (bug#5738).

2010-03-20  Glenn Morris  <rgm@gnu.org>

	* textmodes/rst.el: Use faces for font-lock customization, and make the
	old -face variables obsolete.
	(rst-block, rst-external, rst-definition, rst-directive, rst-comment)
	(rst-emphasis1, rst-emphasis2, rst-literal, rst-reference): New faces.
	(rst-block-face, rst-external-face, rst-definition-face)
	(rst-directive-face, rst-comment-face, rst-emphasis1-face)
	(rst-emphasis2-face, rst-literal-face, rst-reference-face):
	Make obsolete.
	(rst-font-lock-keywords-function): Update for above changes.

2010-03-20  Juri Linkov  <juri@jurta.org>

	* s-region.el:
	* obsolete/s-region.el: Move to obsolete.

2010-03-19  Juanma Barranquero  <lekktu@gmail.com>

	* vc-dispatcher.el (vc-do-command): Remove reference to `vc-path'.

2010-03-19  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-hooks.el (vc-path): Remove variable and obsolete declaration.

2010-03-19  Dan Nicolaescu  <dann@ics.uci.edu>

	Add special markup processing for commit logs.
	* log-edit.el (log-edit-extra-flags): New variable.
	(log-edit): Add new argument MODE.  Use that mode when non-nil
	instead of the log-view-mode.
	(log-view-process-buffer): New function.

	* vc.el: Document that the checkin method takes optional
	arguments.  Document new backend specific method: log-view-mode.
	(vc-default-log-edit-mode): New function.
	(vc-checkin): Use a backend specific log-view-mode.
	Pass extra arguments to the checkin method.
	(vc-modify-change-comment): Pass a dummy extra argument.

	* vc-dispatcher.el (vc-log-edit): Add a mode argument, pass it to
	log-edit.
	(vc-start-logentry): Add a mode argument, pass it to vc-log-edit.
	(vc-finish-logentry): Process the log buffer before passing it
	down.  Pass log-edit-extra-flags.

	* vc-bzr.el (vc-bzr-checkin): Pass extra arguments to the commit
	command.
	(log-edit-extra-flags, log-edit-before-checkin-process):
	New declarations.

	* vc-hg.el (vc-hg-checkin): Pass extra arguments to the commit
	command.
	(log-edit-extra-flags, log-edit-before-checkin-process):
	New declarations.
	(vc-hg-log-edit-mode): New derived mode.

	* vc-arch.el (vc-arch-checkin):
	* vc-cvs.el (vc-cvs-checkin):
	* vc-git.el (vc-git-checkin):
	* vc-mtn.el (vc-mtn-checkin):
	* vc-rcs.el (vc-rcs-checkin):
	* vc-sccs.el (vc-sccs-checkin):
	* vc-svn.el (vc-svn-checkin): Add an optional ignored argument.

2010-03-19  Stefan Monnier  <monnier@iro.umontreal.ca>

	* outline.el (hide-sublevels): Don't hide trailing newline (and fix
	parent typo).

2010-03-19  Glenn Morris  <rgm@gnu.org>

	* password-cache.el (password-cache, password-cache-expiry): Autoload.

2010-03-18  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/autoload.el (autoload-rubric): Doc fix.

	* replace.el (query-replace-history): Give it a doc string.
	(map-query-replace-regexp): Use query-replace-from-history-variable
	and query-replace-to-history-variable.

	* mail/hashcash.el (declare-function): Remove duplicate definition.

	* mail/emacsbug.el (report-emacs-bug-pretest-address):
	Make it an obsolete alias for report-emacs-bug-address.
	(message-strip-special-text-properties): Declare.
	(report-emacs-bug): Remove test for a pretest bug address.
	Combine message-mode-specific code.

	* mail/supercite.el: Don't require sendmail.
	(mh-in-header-p): Declare rather than using with-no-warnings.
	(sc-no-blank-line-or-header): Use rfc822-goto-eoh rather than
	mail-header-end.  Don't bind mysterious variable `kill-lines-magic'.

	* calendar/cal-french.el: Convert to utf-8.

	* files.el (interpreter-mode-alist): Use emacs-lisp-mode for
	Emacs scripts.

2010-03-16  Michael Albinus  <michael.albinus@gmx.de>

	* net/secrets.el (secrets-enabled): New variable.  Use it instead
	of a subfeature.

2010-03-15  Michael Albinus  <michael.albinus@gmx.de>

	* net/secrets.el (top): Register the D-Bus signals only when the
	service "org.freedesktop.secrets" can be pinged.
	Provide subfeature `enabled'.

2010-03-14  Juri Linkov  <juri@jurta.org>

	Add finder unknown keywords.

	* finder.el (finder-unknown-keywords): New function.

	* info.el (Info-finder-find-node): Use `finder-unknown-keywords'
	to create a Finder node with unknown keywords.

2010-03-14  Juri Linkov  <juri@jurta.org>

	* finder.el (finder-compile-keywords): Replace `princ' with
	`prin1' on a list of symbols interned from keyword strings.

	* emacs-lisp/lisp-mnt.el (lm-keywords-list): If `keywords' contains
	a comma, then split keywords using a comma and optional whitespace.
	Otherwise, split by whitespace.

	* complete.el:
	* face-remap.el:
	* log-view.el:
	* net/hmac-def.el:
	* net/hmac-md5.el:
	* net/netrc.el:
	* progmodes/mixal-mode.el: Fix keywords.

2010-03-13  Michael Albinus  <michael.albinus@gmx.de>

	* Makefile.in (ELCFILES): Add net/secrets.elc.

	* net/secrets.el: New file.

2010-03-12  Chong Yidong  <cyd@stupidchicken.com>

	* facemenu.el (list-colors-display, list-colors-print): New arg
	callback.  Use it to allow selecting colors.

	* wid-edit.el (widget-image-insert): Insert image prop even if the
	current display is non-graphic.
	(widget-field-value-set): New fun.
	(editable-field): Use it.
	(widget-field-value-get): Clean up unused var.
	(widget-color-value-create, widget-color--choose-action):
	New funs.  Allow using list-colors-display to choose color.

2010-03-12  Chong Yidong  <cyd@stupidchicken.com>

	* cus-edit.el: Resort topmost custom groups.
	(custom-buffer-sort-alphabetically): Default to t.
	(customize-apropos): Use apropos-parse-pattern.
	(custom-search-field): New var.
	(custom-buffer-create-internal): Add custom-apropos search field.
	(custom-add-parent-links): Don't display parent doc.
	(custom-group-value-create): Don't sort top-level custom group.
	(custom-magic-value-create): Show visibility button before option name.

	(custom-variable-state): New fun, from custom-variable-state-set.
	(custom-variable-state-set): Use it.
	(custom-group-value-create): Hide options with standard values
	using the :hidden-states property.  Use progress reporter.

	(custom-show): Simplify.
	(custom-visibility): Disable images by default.
	(custom-variable): New property :hidden-states.
	(custom-variable-value-create): Enable images for
	custom-visibility widgets.  Use :hidden-states property to
	determine initial visibility.

	* wid-edit.el (widget-image-find): Give images center ascent.
	(visibility): Add :on-image and :off-image properties.
	(widget-visibility-value-create): Use them.

2010-03-12  Chong Yidong  <cyd@stupidchicken.com>

	* cus-edit.el (processes): Remove from development group.
	(oop, hypermedia): Delete group.
	(comm): Promote to top-level group.

	* net/browse-url.el (browse-url):
	* net/xesam.el (xesam):
	* net/tramp.el (tramp):
	* net/goto-addr.el (goto-address):
	* net/ange-ftp.el (ange-ftp): Put in comm group.

	* view.el (view): Remove from editing group.

	* uniquify.el (uniquify): Put in files group.

	* net/browse-url.el (browse-url):
	* ps-print.el (postscript): Put in external group.

	* cus-edit.el (outlines):
	* textmodes/text-mode.el (text-mode-hook):
	* textmodes/table.el (table):
	* textmodes/picture.el (picture):
	* outline.el (outlines): Put in wp group.

	* nxml/nxml-mode.el (nxml): Remove from wp group.

	* net/tramp-imap.el (tramp-imap): Put in tramp group.

	* mail/metamail.el (metamail): Remove from hypermedia group.

	* cus-edit.el (abbrev):
	* whitespace.el (whitespace):
	* vcursor.el (vcursor):
	* reveal.el (reveal):
	* hl-line.el (hl-line): Put in convenience group.

	* epg-config.el (epg): Put in data group.

	* emulation/pc-select.el (pc-select): Put in emulations group.

	* calculator.el (calculator): Put in applications group.

2010-03-12  Dan Nicolaescu  <dann@ics.uci.edu>

	Add .dir-locals.el support for file-less buffers.
	* files.el (hack-local-variables): Split out code to apply local
	variable settings ...
	(hack-local-variables-apply): ... here.  New function.
	(hack-dir-local-variables): Use the default directory for when the
	buffer does not have an associated file.
	(hack-dir-local-variables-non-file-buffer): New function.
	* diff-mode.el (diff-mode):
	* vc-annotate.el (vc-annotate-mode):
	* vc-dir.el (vc-dir-mode):
	* log-edit.el (log-edit-mode):
	* log-view.el (log-view-mode): Call hack-dir-local-variables-non-file-buffer.

2010-03-12  Dan Nicolaescu  <dann@ics.uci.edu>

	Add support for shelving snapshots and for showing shelves.
	* vc-bzr.el (vc-bzr-shelve-show, vc-bzr-shelve-show-at-point)
	(vc-bzr-shelve-apply-and-keep-at-point, vc-bzr-shelve-snapshot):
	New functions.
	(vc-bzr-shelve-map, vc-bzr-shelve-menu-map)
	(vc-bzr-extra-menu-map): Map them.

2010-03-11  Glenn Morris  <rgm@gnu.org>

	* cus-edit.el (customize-changed-options-previous-release):
	Bump to 23.1.

	* image.el (image-animate-max-time): Fix :version tag.

2010-03-10  Chong Yidong  <cyd@stupidchicken.com>

	* Branch for 23.2.

2010-03-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-git.el (vc-git-revision-table): Include remote branches.

2010-03-10  Kim F. Storm  <storm@cua.dk>

	Animated image API.
	http://lists.gnu.org/archive/html/emacs-devel/2010-03/msg00211.html

	* image.el (image-animate-max-time): New defcustom.
	(image-animated-types): New defconst.
	(create-animated-image, image-animate-timer)
	(image-animate-start, image-animate-stop, image-animate-timeout)
	(image-animated-p): New functions.

	* image-mode.el (image-toggle-display-image):
	Replace `create-image' with `create-animated-image'.

2010-03-09  Miles Bader  <miles@gnu.org>

	* vc-git.el (vc-git-print-log): Use "tformat:" for shortlog,
	instead of "format:"; this ensures that the output is
	newline-terminated.

2010-03-08  Chong Yidong  <cyd@stupidchicken.com>

	* mail/rfc822.el (rfc822-addresses): Use nested catches to ensure
	that all errors are caught, and that the return value is always a
	list (Bug#5692).

2010-03-08  Kenichi Handa  <handa@m17n.org>

	* language/misc-lang.el (windows-1256): New coding system.
	(cp1256): New alias of windows-1256 (bug#5690).

2010-03-07  Andreas Schwab  <schwab@linux-m68k.org>

	* mail/rfc822.el (rfc822-addresses): Move catch clause down around
	call to rfc822-bad-address.  (Bug#5692)

2010-03-07  Štěpán Němec  <stepnem@gmail.com>  (tiny change)

	* vc-git.el (vc-git-annotate-extract-revision-at-line):
	Use vc-git-root as default directory for revision path (Bug#5657).

2010-03-06  Chong Yidong  <cyd@stupidchicken.com>

	* calculator.el (calculator): Don't bind split-window-keep-point
	(Bug#5674).

2010-03-06  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-git.el: Re-flow to fit into 80 columns.
	(vc-git-after-dir-status-stage, vc-git-dir-status-goto-stage):
	Remove spurious `quote' element in each case alternative.
	(vc-git-show-log-entry): Use prog1.
	(vc-git-after-dir-status-stage): Remove unused var `remaining'.

2010-03-05  Stefan Monnier  <monnier@iro.umontreal.ca>

	* man.el (Man-files-regexp): Tighten up the regexp (bug#5686).

2010-03-03  Chong Yidong  <cyd@stupidchicken.com>

	* macros.el (insert-kbd-macro): Look up keyboard macro using the
	definition, not the name (Bug#5481).

2010-03-03  Štěpán Němec  <stepnem@gmail.com>  (tiny change)

	* subr.el (momentary-string-display): Don't overwrite the MESSAGE
	argument with a local variable.  (Bug#5670)

2010-03-02  Juri Linkov  <juri@jurta.org>

	* info.el (Info-index-next): Decrement line number by 2.  (Bug#5652)

2010-03-02  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-do-copy-or-rename-file-out-of-band): Fix an
	error when FILENAME and NEWNAME are existing remote directories.

	* net/tramp-compat.el (tramp-compat-make-temp-file): Add optional
	parameter DIR-FLAG.

2010-03-02  Glenn Morris  <rgm@gnu.org>

	* calendar/cal-hebrew.el (holiday-hebrew-passover): Fix date
	of Yom HaAtzma'ut when it falls on a Monday (rule changed in 2004).

2010-03-01  Kenichi Handa  <handa@m17n.org>

	* language/burmese.el (burmese-composable-pattern): Rename from
	myanmar-composable-pattern.

	* international/characters.el (script-list):
	* international/fontset.el (script-representative-chars):
	Change myanmar to burmese.
	(otf-script-alist): Likewise.
	(setup-default-fontset): Likewise.  Re-fix :otf spec.

2010-02-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* menu-bar.el (menu-bar-manuals-menu): Fix typo.

2010-02-28  Jan Djärv  <jan.h.d@swipnet.se>

	* scroll-bar.el (scroll-bar-drag-1): Add save-excursion, bug #5654.

2010-02-28  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-handle-write-region): START can be a string.
	Take care in the checks.  Reported by Dan Davison
	<davison@stats.ox.ac.uk>.

2010-02-28  Michael Albinus  <michael.albinus@gmx.de>

	* net/dbus.el (dbus-introspect, dbus-get-property)
	(dbus-set-property, dbus-get-all-properties):
	Use `dbus-call-method' when noninteractive.  (Bug#5645)

2010-02-28  Chong Yidong  <cyd@stupidchicken.com>

	* textmodes/reftex-toc.el (reftex-toc-promote-prepare):
	* emacs-lisp/elint.el (elint-add-required-env):
	* calendar/icalendar.el (icalendar--add-diary-entry):
	* calc/calcalg2.el (math-tracing-integral):
	* files.el (recover-session-finish): Use with-current-buffer
	instead of save-excursion.

2010-02-27  Stefan Monnier  <monnier@iro.umontreal.ca>

	Fix in-buffer completion when after-change-functions modify the buffer.
	* minibuffer.el (completion--replace): New function.
	(completion--do-completion): Use it and use relative movement.

2010-02-27  Chong Yidong  <cyd@stupidchicken.com>

	* international/fontset.el (setup-default-fontset): Fix :otf spec.

2010-02-27  Jeremy Whitlock  <jcscoobyrs@gmail.com>  (tiny change)

	* progmodes/python.el (python-pdbtrack-stack-entry-regexp):
	Allow the characters _<> in the stack entry (Bug#5653).

2010-02-26  Kenichi Handa  <handa@m17n.org>

	* language/burmese.el: Fix entries in composition-function-table.
	(myanmar-composable-pattern): New variable.

	* international/fontset.el (setup-default-fontset): Add an entry
	for myanmar.

	* international/characters.el (script-list): Add Myanmar
	Extended-A.

2010-02-26  Glenn Morris  <rgm@gnu.org>

	* custom.el (custom-initialize-delay): Doc fix.

	* mail/sendmail.el (send-mail-function): Autoload the call
	to custom-initialize-delay, not otherwise preserved in loaddefs.el.

2010-02-24  Chong Yidong  <cyd@stupidchicken.com>

	* files.el (hack-local-variables-filter): For eval forms, also
	check safe-local-variable-p (Bug#5636).

2010-02-22  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-do-copy-or-rename-file-out-of-band): Protect
	setting the modes by `ignore-errors'.  It might fail, for example
	if the file is not owned by the user but the group.
	(tramp-handle-write-region): Ensure, that `tmpfile' is always readable.

2010-02-21  Chong Yidong  <cyd@stupidchicken.com>

	* files.el (directory-listing-before-filename-regexp): Use
	stricter matching for iso-style dates, to avoid false matches with
	date-like filenames (Bug#5597).

	* htmlfontify.el (htmlfontify): Doc fix.

	* eshell/eshell.el (eshell): Doc fix.

	* startup.el (fancy-about-screen): In mode-line, apply
	mode-line-buffer-id face only to the buffer name (Bug#5613).

2010-02-20  Kevin Ryde  <user42@zip.com.au>

	* progmodes/compile.el (compilation-error-regexp-alist-alist):
	In `watcom' anchor regexp to start of line, to avoid slowness
	(Bug#5599).

2010-02-20  Eli Zaretskii  <eliz@gnu.org>

	* subr.el (remove-yank-excluded-properties): Explain in a comment
	why `category' property is removed.

2010-02-19  Chong Yidong  <cyd@stupidchicken.com>

	* isearch.el (isearch-update-post-hook, isearch-update): Revert
	2010-02-17 change.

2010-02-19  Ulf Jasper  <ulf.jasper@web.de>

	* calendar/icalendar.el (icalendar--convert-ordinary-to-ical)
	(icalendar--convert-weekly-to-ical)
	(icalendar--convert-yearly-to-ical)
	(icalendar--convert-block-to-ical)
	(icalendar--convert-cyclic-to-ical)
	(icalendar--convert-anniversary-to-ical): Take care of time
	specifications where hour has 1-digit only (Bug#5549).

2010-02-19  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-assembler-handler): Accommodate change
	of disassemble output in GDB 7.1.

2010-02-19  Glenn Morris  <rgm@gnu.org>

	* progmodes/f90.el (f90-electric-insert): Give it a delete-selection
	property.  (Bug#5593)

2010-02-18  Sam Steingold  <sds@gnu.org>

	* vc-cvs.el (vc-cvs-merge-news): Yet another fix of message parsing.

2010-02-18  Stefan Monnier  <monnier@iro.umontreal.ca>

	Use abbreviated file names in bookmarks (bug#5591).
	* bookmark.el (bookmark-maybe-load-default-file): Remove redundant
	calls to expand-file-name.
	(bookmark-relocate): Use abbreviated file names in bookmarks.
	(bookmark-load): Use abbreviated file names in messages.

2010-02-18  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-handle-directory-files): When FULL, do not
	expand "." and "..".  Reported by Thierry Volpiatto
	<thierry.volpiatto@gmail.com>.

2010-02-18  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-handle-insert-file-contents): Set always the
	permissions of the temporary file to "0600".  In case the remote
	file has no read permissions for the owner, there might be
	problems otherwise.  Reported by Ole Laursen <olau@iola.dk>.

22010-02-18  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/authors.el (authors-renamed-files-alist):
	Add entries for INSTALL.CVS.

2010-02-17  Mark A. Hershberger  <mah@everybody.org>

	* vc-bzr.el: Fix typo in Known Bugs section.

	* isearch.el (isearch-update-post-hook): New hook.
	(isearch-update): Use the new hook.

2010-02-16  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-do-copy-or-rename-file-out-of-band):
	Fix errors in copying directories.
	(tramp-handle-add-name-to-file, tramp-handle-copy-directory)
	(tramp-do-copy-or-rename-file, tramp-handle-delete-directory)
	(tramp-handle-delete-file)
	(tramp-handle-dired-recursive-delete-directory)
	(tramp-handle-write-region): Flush also the cache for the upper
	directory.

2010-02-16  Chong Yidong  <cyd@stupidchicken.com>

	* simple.el (save-interprogram-paste-before-kill): Doc fix.

	* cus-edit.el (hardware): Doc fix.

	* man.el (man): Add to external custom group.

	* delim-col.el (columns): Move to wp custom group.

	* doc-view.el (doc-view): Add to data custom group.

	* nxml/nxml-mode.el (nxml-faces): Remove from font-lock-faces group.

	* textmodes/flyspell.el (flyspell-word): Obey the offset specified
	by ispell-parse-output (Bug#5575).

2010-02-16  Kenichi Handa  <handa@m17n.org>

	* international/ja-dic-cnv.el (iso-2022-7bit-short): Delete it.
	(skkdic-convert-okuri-ari): Ignore lines starting with '>'.
	(skkdic-convert): Use `euc-japan' coding system for writing.

2010-02-16  Glenn Morris  <rgm@gnu.org>

	* textmodes/tex-mode.el (tex-bibtex-file): Expand the result of
	tex-main-file before using it.  (Bug#5562)

2010-02-15  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/advice.el (ad-compile-function): Suppress byte-compiler
	warnings, since it is annoying for the user to see them each time he
	runs the code.

2010-02-15  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-process-actions, tramp-read-passwd):
	* net/tramp-gvfs.el (tramp-gvfs-maybe-open-connection): Use VEC
	instead of PROC for caching "first-password-request".  Otherwise,
	new processes would not profit from passwords already entered.

	* net/tramp-cache.el (tramp-dump-connection-properties):
	Don't save "first-password-request" property.

2010-02-14  Juanma Barranquero  <lekktu@gmail.com>

	* outline.el (outline-head-from-level):
	* simple.el (with-wrapper-hook):
	* emacs-lisp/elint.el (elint-extra-errors, elint-current-buffer)
	(elint-defun, elint-buffer-env, elint-top-form-logged)
	(elint-unbound-variable):
	* textmodes/reftex-toc.el (reftex-toc-newhead-from-alist):
	Fix typos in docstrings.

2010-02-14  Michael Albinus  <michael.albinus@gmx.de>

	* files.el (insert-directory): When WILDCARD-REGEXP and
	FULL-DIRECTORY-P are nil, insert the file entry instead of the
	whole directory.  (Bug#5551)

	* net/ange-ftp.el (ange-ftp-insert-directory): Insert "  " for
	dired's alignment sanity.  (Bug#5516)

2010-02-14  Juri Linkov  <juri@jurta.org>

	* man.el (Man-fontify-manpage, Man-cleanup-manpage):
	Remove remaining ^H with their preceding chars.  (Bug#5566)

2010-02-13  Glenn Morris  <rgm@gnu.org>

	* simple.el (transpose-subr): Give it a doc-string.

	* textmodes/paragraphs.el (transpose-paragraphs, transpose-sentences):
	Doc fixes.

2010-02-12  Juri Linkov  <juri@jurta.org>

	* arc-mode.el (archive-unique-fname): Make directories for nested
	archives.  (Bug#5540)

2010-02-12  Juri Linkov  <juri@jurta.org>

	* ffap.el (dired-at-point): Fix docstring.  (Bug#5565)

2010-02-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* subr.el (copy-overlay): Handle deleted overlays.

	* man.el (Man-completion-table): Don't signal an error if we can't run
	manual-program (bug#4056).

2010-02-10  Juanma Barranquero  <lekktu@gmail.com>

	* textmodes/artist.el (artist-mt): Fix typos in docstring.

2010-02-10  Thierry Volpiatto  <thierry.volpiatto@gmail.com>

	* info.el (Info-bookmark-jump): Simplify.

	* bookmark.el (bookmark-handle-bookmark): Catch the right error.
	(bookmark-default-handler): Accept new bookmark field `buffer'.

2010-02-10  Chong Yidong  <cyd@stupidchicken.com>

	* iswitchb.el (iswitchb-completions): Revert last change.

2010-02-10  Michael Albinus  <michael.albinus@gmx.de>

	* ls-lisp.el (ls-lisp-insert-directory): When WILDCARD-REGEXP and
	FULL-DIRECTORY-P are nil, and FILE is absolute, expand it.
	This prevents file names like "~/" being listed literally.

2010-02-10  Dan Nicolaescu  <dann@ics.uci.edu>

	* term/xterm.el (xterm-maybe-set-dark-background-mode):
	Remove dead code.  (Bug#5546)

2010-02-09  Chong Yidong  <cyd@stupidchicken.com>

	* eshell/em-ls.el (eshell-ls-applicable): Frob file attributes
	correctly (Bug#5548).

2010-02-08  Jose E. Marchesi  <jemarch@gnu.org>

	* progmodes/ada-mode.el (ada-in-numeric-literal-p): New function.
	(ada-adjust-case): Don't adjust case in hexadecimal number literals.

2010-02-08  Kenichi Handa  <handa@m17n.org>

	* international/mule-util.el (with-coding-priority): Add autoload
	cookie for putting `lisp-indent-function'.

2010-02-07  Glenn Morris  <rgm@gnu.org>

	* progmodes/f90.el (f90-font-lock-keywords-1, f90-font-lock-keywords-2):
	Move F2003 named interfaces from keywords-2 to keywords-1, and
	use function-name-face rather than constant-face.
	Simplify "abstract interface" regexp.

2010-02-07  Chong Yidong  <cyd@stupidchicken.com>

	* eshell/esh-util.el (eshell-file-attributes): New optional arg
	ID-FORMAT.  Pass it to `file-attributes'.

	* eshell/em-ls.el (eshell-do-ls): Use it (Bug#5528).

2010-02-07  sj  <prime.wizard+emacs@gmail.com>  (tiny change)

	* faces.el (set-face-attribute): Allow calling
	internal-set-lisp-face-attribute with 'unspecified family and
	foundry argument (Bug#5536).

2010-02-07  Glenn Morris  <rgm@gnu.org>

	* progmodes/f90.el (f90-font-lock-keywords-2)
	(f90-looking-at-type-like, f90-looking-at-program-block-end):
	Handle F2003 named interfaces.

2010-02-06  Chong Yidong  <cyd@stupidchicken.com>

	* progmodes/cc-mode.el (c-common-init): Bind temporary variables
	beg and end before calling c-get-state-before-change-functions.

2010-02-06  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-bzr.el (vc-bzr-dir-extra-headers): Disable the pending merges header.

2010-02-05  Juri Linkov  <juri@jurta.org>

	* doc-view.el (doc-view-mode):
	* image-mode.el (image-mode): Put property mode-class=special.
	(Bug#4896)

2010-02-05  Mark A. Hershberger  <mah@everybody.org>

	* vc-svn.el (vc-svn-revision-table): New function.

2010-02-05  Michael Albinus  <michael.albinus@gmx.de>

	* net/ange-ftp.el (ange-ftp-insert-directory):
	* net/tramp-imap.el (tramp-imap-handle-insert-directory):
	* net/tramp-smb.el (tramp-smb-handle-insert-directory):
	Handle also directories.  (Bug#5478)

2010-02-05  Glenn Morris  <rgm@gnu.org>

	* progmodes/f90.el (f90-font-lock-keywords-2): Fix `enum'.

2010-02-05  Chong Yidong  <cyd@stupidchicken.com>

	* startup.el (command-line-1): Convert options beginning with a
	single dash as well (Bug#5519).

2010-02-05  Stefan Monnier  <monnier@iro.umontreal.ca>

	Make `initials' completion work for /hh -> /home/horn again (bug#5524).
	* minibuffer.el (completion-initials-expand): Only check the presence
	of delims *within* the boundaries, since otherwise the / delim is
	always found for files.

	Fix up various corner case problems.
	* doc-view.el (doc-view-last-page-number): New function.
	(doc-view-mode, doc-view-last-page, doc-view-goto-page): Use it.
	(doc-view-goto-page): Avoid inf-loops when the conversion fails.
	(doc-view-kill-proc): Avoid inf-loop in freak cases.
	(doc-view-reconvert-doc): Use the new recursive delete-directory.
	(doc-view-convert-current-doc): Don't create the resolution.el file
	here any more.
	(doc-view-pdf/ps->png): Do it here instead.
	(doc-view-already-converted-p): Check that resolution.el is present.
	(doc-view-pdf->png): Don't rely on doc-view-pdf/ps->png for the few
	windows that are not yet showing images.

2010-02-04  Michael Albinus  <michael.albinus@gmx.de>

	* dired.el (dired-revert): If DIRED-DIRECTORY is a cons cell, call
	`dired-uncache' for every elemnt which is an absolute file name.

	* net/tramp.el (tramp-handle-dired-uncache): When DIR is not a
	directory, handle its directory component.
	(tramp-handle-file-remote-p): Let-bind `tramp-verbose' to 3; this
	function is called permanently and creates noise, otherwise.

	* net/tramp-imap.el (tramp-imap-handle-insert-directory):
	* net/tramp-smb.el (tramp-smb-handle-insert-directory):
	Handle the case, FILENAME is not in `default-directory'.  (Bug#5478)

2010-02-04  David Burger  <dburger@google.com>  (tiny change)

	* macros.el (apply-macro-to-region-lines):
	Minor simplification.  (Bug#5485)

2010-02-04  Glenn Morris  <rgm@gnu.org>

	* mail/rmail.el (rmail-show-message-1): Handle malformed
	quoted-printable text.  (Bug#5441)

	* mail/mail-utils.el (mail-unquote-printable-region): Doc fix.

	* simple.el (visual-line-mode): Capitalize lighter.

2010-02-03  John Wiegley  <jwiegley@gmail.com>

	* iswitchb.el (iswitchb-completions): Add bookmark files to the
	list of files considered for "virtual buffer" completions.

2010-02-03  Michael Albinus  <michael.albinus@gmx.de>

	* net/ange-ftp.el (ange-ftp-insert-directory): Parse directory
	also in case of (and (not full) (not wildcard)).  This is needed
	when dired is called with a list of files, which are not in
	`default-directory'.  (Bug#5478)

2010-02-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-hooks.el (vc-path): Make it an obsolete var, rather than function.

2010-02-02  Juri Linkov  <juri@jurta.org>

	* textmodes/ispell.el (ispell-message-text-end): Remove final newline
	from unidiff to allow function-line after @@.

2010-02-02  Juri Linkov  <juri@jurta.org>

	* ediff-util.el (ediff-file-checked-in-p): Replace '(nil CVS) by
	'(RCS SCCS) with inverted condition.

2010-02-02  Michael Albinus  <michael.albinus@gmx.de>

	* net/ange-ftp.el (ange-ftp-skip-msgs): Ignore all ""^500 .*AUTH"
	messages.

2010-02-01  Juri Linkov  <juri@jurta.org>

	* arc-mode.el (archive-zip-extract): Use `member-ignore-case' to
	compare with "pkunzip" and "pkzip" instead of only "pkzip".
	In the `archive-extract-by-stdout' branch use `shell-quote-argument'
	only when (car archive-zip-extract) is "unzip".  (Bug#5475)

2010-02-01  Stefan Monnier  <monnier@iro.umontreal.ca>

	* doc-view.el (doc-view-new-window-function): Be a bit more defensive.
	(doc-view-revert-buffer): New command.
	(doc-view-mode-map): Use it.

2010-02-01  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-bzr.el (vc-bzr-dir-extra-headers): Add a header when a
	pending merge is detected.

2010-01-31  Juri Linkov  <juri@jurta.org>

	* progmodes/grep.el (zrgrep): Call `grep-compute-defaults' at the
	beginning of interactive spec like all other grep commands do.
	Put "all" in front of "gz".  (Bug#5260)

2010-01-29  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-bzr.el (vc-bzr-after-dir-status): Match another renaming indicator.

2010-01-29  Chong Yidong  <cyd@stupidchicken.com>

	* dirtrack.el (dirtrack): Warn instead of signalling error if the
	regexp is incorrect (Bug#5476).

2010-01-29  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-handle-insert-directory): Handle also
	symlinks, when FILENAME is not in `default-directory'.

2010-01-28  Michael Albinus  <michael.albinus@gmx.de>

	* net/ange-ftp.el (ange-ftp-insert-directory): Handle the case,
	FILE is not in `default-directory'.  (Bug#5478)

	* net/tramp.el (tramp-handle-insert-directory): Simplify handling
	of SWITCHES.  Handle the case, FILENAME is not in
	`default-directory'.  (Bug#5478)
	(tramp-register-file-name-handlers): Add safe-magic property.

2010-01-28  Chong Yidong  <cyd@stupidchicken.com>

	* arc-mode.el (archive-zip-extract): Quote the argument passed to
	unzip (Bug#5475).

2010-01-28  Nil Geisweiller  <ngeiswei@googlemail.com>  (tiny change)

	* progmodes/flymake.el (flymake-allowed-file-name-masks)
	(flymake-master-make-header-init): Add other C++ filename masks.
	(flymake-find-possible-master-files)
	(flymake-check-patch-master-file-buffer): Doc fixes (Bug#5488).

2010-01-28  Michael Albinus  <michael.albinus@gmx.de>

	Fix some busybox annoyances.

	* net/tramp.el (tramp-wrong-passwd-regexp): Add "Timeout, server
	not responding." string.
	(tramp-open-connection-setup-interactive-shell): Dump stty
	settings.  Enable "neveropen" arg for all `tramp-send-command'
	calls.  Handle "=" in variable values properly.
	(tramp-find-inline-encoding): Raise an error, when no encoding is
	found.
	(tramp-wait-for-output): Check, whether PROC buffer is available.
	Remove spurious " ^H" sequences, sent by busybox.
	(tramp-get-ls-command): Suppress coloring, if possible.

2010-01-28  Glenn Morris  <rgm@gnu.org>

	* vc-svn.el (vc-svn-update): Use "svn --non-interactive".  (Bug#4280)

	* log-edit.el (log-edit-strip-single-file-name): Add missing
	:safe, :group, and :version tags.

2010-01-27  Stephen Berman  <stephen.berman@gmx.net>

	* calendar/diary-lib.el (diary-unhide-everything): Handle narrowed
	buffers.  (Bug#5477)

2010-01-27  David De La Harpe Golden  <david@harpegolden.net>

	* files.el (delete-directory): Handle moving to trash without
	first doing recursion (Bug#5436).

2010-01-26  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-hooks.el (vc-path): Mark as obsolete.

2010-01-25  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-annotate.el (vc-annotate-revision-at-line): Compare file
	names too.

	* vc-bzr.el (vc-bzr-print-log): Use the more compact --line option
	for the short log.
	(vc-bzr-log-view-mode): Adjust regexp for the above change.

2010-01-25  Mark A. Hershberger  <mah@everybody.org>

	* progmodes/python.el: Replace reference to obsolete c-subword-mode.

	* vc-bzr.el (vc-bzr-revision-table): New function.

2010-01-25  Eric Hanchrow  <eric.hanchrow@gmail.com>  (tiny change)

	* vc-git.el (vc-git-dir-status-goto-stage): Pass --relative to the
	diff-index command.  This requires at least git-1.5.5.  (Bug#1589).

2010-01-24  Dan Nicolaescu  <dann@ics.uci.edu>

	Remove support for adding --signoff on commit.
	Future support will use an incompatible generic mechanism.
	* vc-git.el (vc-git-add-signoff): Remove variable.
	(vc-git-toggle-signoff): Remove function.
	(vc-git-extra-menu-map): Do not bind vc-git-toggle-signoff.

	* term/xterm.el (xterm-maybe-set-dark-background-mode): Rename
	from xterm-set-background-mode.  Return t if the background mode
	was set.
	(terminal-init-xterm): Move tty-set-up-initial-frame-faces
	earlier, call it again in case the background mode has changed.

2010-01-23  Dmitri Paduchikh  <dpaduch@k66.ru>  (tiny change)

	* emacs-lisp/advice.el (ad-set-orig-definition): Fix typo
	(Bug#3541).

2010-01-23  Chong Yidong  <cyd@stupidchicken.com>

	* emacs-lisp/assoc.el (aelement): Doc fix.
	(aput, adelete, amake): Use lexical-let (Bug#5450).

2010-01-23  Stephen Leake  <stephen_leake@member.fsf.org>

	* progmodes/ada-mode.el (ada-in-paramlist-p): Pragma syntax
	is the same as subprogram call, not declaration.  (Bug#5435).

2010-01-23  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-smb.el (tramp-smb-conf): New defcustom.
	(tramp-smb-maybe-open-connection): Use it.

2010-01-22  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-imap.el (top): Autoload needed packages.  (Bug#5448)

2010-01-22  Stefan Monnier  <monnier@iro.umontreal.ca>

	* mail/rmailmm.el (rmail-mime-handle): Don't set the buffer to unibyte
	just because we see "encoding: 8bit".
	* mail/rmail.el (rmail-show-message-1): Decode the body's QP into bytes.

2010-01-22  Chong Yidong  <cyd@stupidchicken.com>

	* isearch.el (isearch-allow-scroll): Doc fix (Bug#5446).

2010-01-22  Eli Zaretskii  <eliz@gnu.org>

	* jka-compr.el (jka-compr-load): If load-file is not in
	load-history, try its file-truename version.  (bug#5447)

2010-01-21  Alan Mackenzie  <acm@muc.de>

	Fix a situation where deletion of a cpp construct throws an error.
	* progmodes/cc-engine.el (c-invalidate-state-cache):
	Before invoking c-with-all-but-one-cpps-commented-out, check that the
	special cpp construct is still in the buffer.
	(c-parse-state): Record the special cpp with markers, not numbers.

2010-01-21  Kenichi Handa  <handa@m17n.org>

	* textmodes/sgml-mode.el (sgml-maybe-name-self): No need to
	process last-command-event, as it is now decoded first (Bug#5380).

2010-01-20  Chong Yidong  <cyd@stupidchicken.com>

	* term.el (term-send-raw-meta): Revert 2009-12-04 change (Bug#5330).

2010-01-20  Glenn Morris  <rgm@gnu.org>

	* indent.el (tab-always-indent): Fix custom-type.

2010-01-19  Alan Mackenzie  <acm@muc.de>

	* progmodes/cc-defs.el: Fix bug#5395: typing '#' in an empty
	buffer throws "args out of range".
	(c-set-cpp-delimiters, c-clear-cpp-delimiters): Check for EOB
	playing the role of delimiter.

2010-01-18  Stephen Leake  <stephen_leake@member.fsf.org>

	* progmodes/ada-mode.el: Fix bug#5400.
	(ada-matching-decl-start-re): Move into ada-goto-decl-start.
	(ada-goto-decl-start): Rename from ada-goto-matching-decl-start; callers
	changed.  Delete RECURSIVE parameter; never used.  Improve doc string.
	Improve comments in "is" portion.  Handle null procedure declaration.
	(ada-move-to-end): Improve doc string.

2010-01-18  Óscar Fuentes  <ofv@wanadoo.es>

	* ido.el (ido-cur-list): Initialize to nil.
	Remove obsolete information from commentary.
	(ido-choice-list): Initialize to nil.
	(ido-get-bufname): Reject minibuffers.
	(ido-make-buffer-list): If "default" is a nonexistent
	buffer, ignore it, as per the function's comment.
	(ido-kill-buffer-internal): New function.
	(ido-kill-buffer-at-head): Use it.
	(ido-visit-buffer): Likewise.

2010-01-18  Chong Yidong  <cyd@stupidchicken.com>

	* calendar/time-date.el (date-to-time): Doc fix (Bug#5408).

2010-01-18  Juanma Barranquero  <lekktu@gmail.com>

	* emacs-lisp/chart.el (chart-file-count, chart-rmail-from):
	Fix typos in chart titles.

	* whitespace.el (whitespace-style, global-whitespace-newline-mode):
	* emacs-lisp/eieio.el (eieio-error-unsupported-class-tags)
	(eieio-generic-form, eieio-help-mode-augmentation-maybee, eieio-browse)
	(describe-class, eieio-describe-generic, describe-generic):
	* emacs-lisp/eieio-speedbar.el (eieio-speedbar-handle-click)
	(eieio-speedbar-expand):
	* emulation/viper-cmd.el (viper-exec-form-in-vi)
	(viper-exec-form-in-emacs, viper-harness-minor-mode, viper-ESC)
	(viper-repeat, viper-replace-state-exit-cmd, viper-toggle-search-style)
	(viper-del-backward-char-in-replace, viper-backward-indent)
	(viper-brac-function, viper-register-to-point, viper-submit-report):
	* net/tramp.el (tramp-remote-coding-commands):
	* term/x-win.el (emacs-session-save, x-menu-bar-open, icon-map-list):
	Fix typos in docstrings.

2010-01-17  Chong Yidong  <cyd@stupidchicken.com>

	* mail/sendmail.el (mail-yank-original): Set the mark if the
	specified function for yanking does not do it.

2010-01-17  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc.el (with-vc-properties): Deal with directory arguments.  (Bug#5298)

	* vc-dir.el (vc-dir-resynch-file): Update the vc-dir header when
	resyncing a directory.

2010-01-17  Stephen Leake  <stephen_leake@member.fsf.org>

	* progmodes/ada-mode.el: Fix bug#1920.
	(ada-ident-re): Delete ., allow multibyte characters.
	(ada-goto-label-re): New; matches goto labels.
	(ada-block-label-re): New; matches block labels.
	(ada-label-re): New; matches both.
	(ada-named-block-re): Deleted; callers changed to use
	`ada-block-label-re' instead.
	(ada-get-current-indent, ada-get-indent-noindent, ada-get-indent-loop):
	Use `ada-block-label-re'.
	(ada-indent-on-previous-lines): Improve handling of goto labels.
	(ada-get-indent-block-start): Special-case block label.
	(ada-get-indent-label): Split into `ada-indent-block-label' and
	`ada-indent-goto-label'.
	(ada-goto-stmt-start, ada-goto-next-non-ws):
	Optionally ignore goto labels.
	(ada-goto-next-word): Simplify.
	(ada-indent-newline-indent-conditional): Insert newline before
	trying to fix indentation; doc fix.

2010-01-17  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc.el (calc-command-flags): Give it an initial value.

2010-01-17  Juanma Barranquero  <lekktu@gmail.com>

	* files.el (minibuffer-with-setup-hook):
	* textmodes/artist.el (artist-mt, artist-key-undraw-continously)
	(artist-key-draw-continously, artist-key-do-continously-continously)
	(artist-key-set-point-continously, artist-mouse-draw-continously):
	Fix typos in docstrings.

2010-01-16  Lennart Borgman  <lennart.borgman@gmail.com>

	* nxml/nxml-mode.el (nxml-extend-after-change-region): Never
	return t (Bug#3898).

2010-01-16  Frédéric Perrin  <frederic.perrin@resel.fr>  (tiny change)

	* vc-dispatcher.el (vc-do-command): Set LC_MESSAGES, so that we
	can parse the output of the external commands (Bug#5279).

2010-01-16  Jari Aalto  <jari.aalto@cante.net>

	* pcmpl-unix.el (pcmpl-unix-read-passwd-file): Doc fix.

2010-01-16  Chong Yidong  <cyd@stupidchicken.com>

	* emacs-lisp/advice.el (ad-add-advice): Doc fix (Bug#5274)

	* emacs-lisp/cl-macs.el (defstruct): Doc fix (Bug#5267).

	* startup.el (command-line): Remove unused --icon-type arg.
	Handle --display arg, passing it to command-line-1 (Bug#5392).

2010-01-16  Mario Lang  <mlang@delysid.org>

	* emacs-lisp/chart.el (chart-translate-namezone):
	* textmodes/artist.el (artist-compute-popup-menu-table):
	Remove duplicated words in doc-strings.

2010-01-15   David Abrahams  <dave@boostpro.com>  (tiny change)

	* net/mairix.el (mairix-widget-send-query): Send -1 instead of nil
	to mairix-search to suppress threading (Bug#5342).

2010-01-15  Kenichi Handa  <handa@m17n.org>

	* international/mule-cmds.el (canonicalize-coding-system-name):
	Convert "msXXX", "ibmXXX", "windows-XXX" to "cpXXX" (Bug#5387).

2010-01-15  Glenn Morris  <rgm@gnu.org>

	* log-view.el (top-level): Require 'wid-edit.  (Bug#5311)

	* wid-edit.el (widget-keymap): Doc fix.

	* vc-svn.el (vc-svn-print-log): Use --limit rather than -l since the
	former seems to be more widely accepted by various svn versions.

2010-01-14  Juanma Barranquero  <lekktu@gmail.com>

	* find-cmd.el (find-constituents):
	* vc-arch.el (vc-arch-root):
	* window.el (window-body-height, pop-up-frames):
	* emacs-lisp/eieio-base.el (eieio-singleton, slot-missing):
	* progmodes/ada-stmt.el (ada-if):
	* progmodes/gdb-ui.el (gdb-jsonify-buffer):
	* textmodes/ispell.el (ispell-grep-options, ispell-dictionary-alist)
	(ispell-encoding8-command, ispell-aspell-supports-utf8)
	(ispell-last-program-name, ispell-help): Fix typos in docstrings.

	* progmodes/flymake.el (flymake-post-syntax-check):
	Fix typo in error message.

2010-01-14  Juanma Barranquero  <lekktu@gmail.com>

	* hexl.el (hexl-printable-character): Fix check of `hexl-iso',
	which is always a string.  (Bug#5313)

2010-01-14  Juanma Barranquero  <lekktu@gmail.com>

	* progmodes/ada-xref.el (ada-default-prj-properties):
	Simplify previous change.

2010-01-14  Stephen Leake  <stephen_leake@member.fsf.org>

	* progmodes/ada-xref.el (ada-default-prj-properties):
	Default ada_project_path to $ADA_PROJECT_PATH.

2010-01-14  Stephen Leake  <stephen_leake@member.fsf.org>

	* progmodes/ada-mode.el (ada-create-keymap):
	Override `narrow-to-defun' with `ada-narrow-to-defun'.

2010-01-14  Stephen Leake  <stephen_leake@member.fsf.org>

	* progmodes/ada-mode.el: Deal with Ada 2005 "overriding" keyword.
	(ada-subprog-start-re, ada-imenu-subprogram-menu-re): Add keyword.
	(ada-get-current-indent, ada-imenu-generic-expression)
	(ada-which-function): Check for it.

2010-01-14  Stephen Leake  <stephen_leake@member.fsf.org>

	* progmodes/ada-mode.el (ada-clean-buffer-before-saving): Make obsolete.
	(ada-mode): Don't obey `ada-clean-buffer-before-saving' anymore.

2010-01-14  Glenn Morris  <rgm@gnu.org>

	* frame.el (show-trailing-whitespace): Safe if boolean.  (Bug#5312)

2010-01-14  Kenichi Handa  <handa@m17n.org>

	* composite.el (auto-composition-mode): Make it a buffer local
	variable (permanent-local).
	(auto-composition-function): Set the default value to
	auto-compose-chars.
	(auto-composition-mode): Make it a simple function, not a minor mode.
	(global-auto-composition-mode): Likewise.
	(turn-on-auto-composition-if-enabled): Delete it.

2010-01-13  Karl Fogel  <kfogel@red-bean.com>

	* bookmark.el (bookmark-bmenu-execute-deletions): Doc fix (Bug#5276).

2010-01-12  Michael Albinus  <michael.albinus@gmx.de>

	* files.el (copy-directory): Compute target for recursive
	directories with identical names.  (Bug#5343)

2010-01-12  Glenn Morris  <rgm@gnu.org>

	* mail/emacsbug.el (report-emacs-bug-pretest-address): Set
	it to bug-gnu-emacs rather than emacs-pretest-bug.

2010-01-11  Sam Steingold  <sds@gnu.org>

	* imenu.el (imenu-default-create-index-function): Detect infinite
	loops caused by imenu-prev-index-position-function.

2010-01-11  Juanma Barranquero  <lekktu@gmail.com>

	* htmlfontify.el (htmlfontify-load-rgb-file)
	(htmlfontify-unload-rgb-file, hfy-fallback-colour-values)
	(htmlfontify-manual, htmlfontify, hfy-page-header, hfy-page-footer)
	(hfy-src-doc-link-style, hfy-src-doc-link-unstyle, hfy-link-extn)
	(hfy-link-style-fun, hfy-index-file, hfy-instance-file)
	(hfy-html-quote-regex, hfy-init-kludge-hook, hfy-post-html-hooks)
	(hfy-default-face-def, hfy-etag-regex, hfy-html-quote-map)
	(hfy-etags-cmd-alist-default, hfy-etags-bin, hfy-ignored-properties)
	(hfy-which-etags, hfy-etags-cmd, hfy-istext-command, hfy-display-class)
	(hfy-optimisations, hfy-tags-cache, hfy-tags-sortl, hfy-tags-rmap)
	(hfy-style-assoc, hfy-sheet-assoc, hfy-facemap-assoc, hfy-interq)
	(hfy-colour-vals, hfy-default-header, hfy-link-style-string)
	(hfy-triplet, hfy-slant, hfy-weight, hfy-combined-face-spec)
	(hfy-face-attr-for-class, hfy-face-to-style-i, hfy-size-to-int)
	(hfy-flatten-style, hfy-face-to-style, hfy-face-or-def-to-name)
	(hfy-face-to-css, hfy-p-to-face, hfy-p-to-face-lennart, hfy-face-at)
	(hfy-fontified-p, hfy-merge-adjacent-spans, hfy-buffer)
	(hfy-html-enkludge-buffer, hfy-html-quote, hfy-html-dekludge-buffer)
	(hfy-force-fontification, htmlfontify-buffer, hfy-dirname)
	(hfy-make-directory, hfy-text-p, hfy-mark-tag-names, hfy-relstub)
	(hfy-href-stub, hfy-href, hfy-mark-tag-hrefs, hfy-prepare-index-i)
	(hfy-prepare-index, hfy-prepare-tag-map, hfy-subtract-maps)
	(htmlfontify-run-etags): Fix typos in docstrings and remove superfluous
	backslash-quoting from parentheses, etc.

2010-01-11  Chong Yidong  <cyd@stupidchicken.com>

	* progmodes/js.el: Autoload javascript-mode alias.

2010-01-11  Juanma Barranquero  <lekktu@gmail.com>

	* ffap.el (ffap-shell-prompt-regexp, ffap-all-subdirs, ffap-url-p)
	(ffap-alist, ffap-tex-path, ffap-url-at-point, ffap-gopher-regexp)
	(ffap-gopher-at-point, ffap-file-at-point, ffap-read-file-or-url)
	(ffap-read-url-internal, ffap-menu, ffap-at-mouse):
	Fix typos in docstrings.
	(ffap-url-regexp): Doc fix.
	(ffap-at-mouse): Fix typo in message.

2010-01-11  Glenn Morris  <rgm@gnu.org>

	* version.el (emacs-copyright): Set copyright year to 2010.

2010-01-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* format.el (format-annotate-function): Only set
	write-region-post-annotation-function after running to-fn so as not to
	affect nested write-region calls (bug#5273).

2010-01-10  Chong Yidong  <cyd@stupidchicken.com>

	* Makefile.in (ELCFILES): Add wisent/python-wy.el and
	wisent/python.el.

2010-01-09  Chong Yidong  <cyd@stupidchicken.com>

	* man.el (Man-goto-section): Signal error if the section is not
	found (Bug#5317).

2010-01-09  Juanma Barranquero  <lekktu@gmail.com>

	* vc-bzr.el (vc-bzr-working-revision): On Windows and MS-DOS, accept
	URLs with a leading triple slash in the file: scheme.  (Bug#5345)

2010-01-09  Chong Yidong  <cyd@stupidchicken.com>

	* progmodes/compile.el: Don't treat compile-command as safe if
	compilation-read-command might be nil (Bug#4218).

2010-01-09  Jan Djärv  <jan.h.d@swipnet.se>

	* startup.el (command-line-1): Use orig-argi to check for ignored X and
	NS options.

2010-01-08  Kenichi Handa  <handa@m17n.org>

	* international/fontset.el (build-default-fontset-data):
	Exclude characters in scripts kana, hangul, han, or cjk-misc.

2010-01-07  Juanma Barranquero  <lekktu@gmail.com>

	* vc-dir.el (vc-dir-prepare-status-buffer): Pass a (fake) filename
	to `create-file-buffer' as it expects, not just a buffer name.
	(vc-dir-mode): Include the buffer name in `list-buffers-directory',
	to help uniquify.  (Bug#3224)

2010-01-06  Jan Djärv  <jan.h.d@swipnet.se>

	* font-setting.el (font-setting-change-default-font): Use user-spec
	instead of name.

2010-01-06  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-bzr.el (vc-bzr-after-dir-status): Ignore pending merges.

2010-01-05  Tom Tromey  <tromey@redhat.com>

	* progmodes/python.el (python-font-lock-keywords):
	Handle qualified decorators (Bug#881).

2010-01-05  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-bzr.el (vc-bzr-working-revision): Fix looking for a revision
	in a lightweight checkout.

2010-01-05  Kenichi Handa  <handa@m17n.org>

	* language/indian.el (malayalam-composable-pattern): Fix ZWNJ and ZWJ.

2010-01-05  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-bzr.el (vc-bzr-diff): Obey vc-disable-async-diff.

2010-01-04  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-bzr.el (vc-bzr-state-heuristic): Make it work for lightweight
	checkouts.  (Bug#618)
	(vc-bzr-log-view-mode): Also highlight the author.
	(vc-bzr-shelve-map): Change binding for vc-bzr-shelve-apply-at-point.
	(vc-bzr-shelve-menu-map):
	(vc-bzr-dir-extra-headers): Improve menu and tooltip text.
	(vc-bzr-shelve-apply): Make prompt more explicit.

2010-01-02  Chong Yidong  <cyd@stupidchicken.com>

	* net/browse-url.el (browse-url-encode-url): Don't escape commas.
	They are valid characters in URL paths (rfc3986), and at least
	Firefox does not understand the encoded version (Bug#3166).

2010-01-02  Daniel Elliott  <danelliottster@gmail.com>  (tiny change)

	* progmodes/octave-mod.el (octave-end-keywords)
	(octave-block-begin-or-end-regexp, octave-block-match-alist):
	Add "end" keyword (Bug#3061).
	(octave-end-as-array-index-p): New function.
	(calculate-octave-indent): Use it.

2010-01-02  Karl Fogel  <kfogel@red-bean.com>

	* bookmark.el: Consistently put the text property on the bookmark name.
	(bookmark-bmenu-marks-width): Bump back to 2, to include
	annotation marks.
	(bookmark-bmenu-hide-filenames): Adjust for above, and put the text
	property on the bookmark name, instead of not putting it at all.
	(bookmark-bmenu-list): Fix where we put the text property.

2010-01-02  Karl Fogel  <kfogel@red-bean.com>

	* bookmark.el (bookmark-bmenu-save): Just depend on the new logic
	for showing buffer modified state (as added in the previous change).

2010-01-02  Karl Fogel  <kfogel@red-bean.com>

	* bookmark.el: Show modified state of bookmark buffer more accurately.
	(bookmark-bmenu-list): Initialize buffer-modified-p properly.
	(bookmark-send-edited-annotation): Mark bookmark-alist as modified.
	(with-buffer-modified-unmodified): New macro.
	(bookmark-bmenu-show-filenames, bookmark-bmenu-hide-filenames)
	(bookmark-bmenu-mark, bookmark-bmenu-unmark, bookmark-bmenu-delete):
	Use new macro to preserve the buffer modified state.

2010-01-02  Karl Fogel  <kfogel@red-bean.com>

	* bookmark.el (bookmark-bmenu-select, bookmark-bmenu-1-window)
	(bookmark-bmenu-2-window, bookmark-bmenu-this-window)
	(bookmark-bmenu-other-window, bookmark-bmenu-switch-other-window)
	(bookmark-bmenu-show-annotation, bookmark-bmenu-edit-annotation)
	(bookmark-bmenu-rename, bookmark-bmenu-locate)
	(bookmark-bmenu-relocate, bookmark-bmenu-goto-bookmark):
	Remove unnecessary calls to `bookmark-bmenu-ensure-position'.

2010-01-02  Eli Zaretskii  <eliz@gnu.org>

	* emacs-lisp/easy-mmode.el (define-globalized-minor-mode):
	Make the lines in the generated doc string shorter.  (Bug#4668)

2010-01-02  Ryan Yeske  <rcyeske@gmail.com>

	* net/rcirc.el: Add follow-link binding (Bug#4738).

2010-01-02  Eli Zaretskii  <eliz@gnu.org>

	* Makefile.in (bzr-update): Rename from cvs-update.
	(cvs-update): New target for backward compatibility.

	* makefile.w32-in (bzr-update): Rename from cvs-update.
	(cvs-update): New target for backward compatibility.

2010-01-02  Karl Fogel  <kfogel@red-bean.com>

	* bookmark.el: Remove gratuitous gratitude.

2010-01-02  Karl Fogel  <kfogel@red-bean.com>

	* bookmark.el (bookmark-bmenu-any-marks): New function.
	(bookmark-bmenu-save): Clear buffer modification if no marks.

2010-01-02  Karl Fogel  <kfogel@red-bean.com>

	* bookmark.el (bookmark-bmenu-marks-width): Define to 1, not 2.
	(bookmark-bmenu-list, bookmark-bmenu-bookmark): Calculate property
	positions by using `bookmark-bmenu-marks-width', instead of hardcoding.
	This fixes the `bookmark-bmenu-execute-deletions' bug reported here:

	http://lists.gnu.org/archive/html/emacs-devel/2009-12/msg00819.html
	From: Sun Yijiang <sunyijiang {_AT_} gmail.com>
	To: emacs-devel {_AT_} gnu.org
	Subject: bookmark.el bug report
	Date: Mon, 28 Dec 2009 14:19:16 +0800
	Message-ID: 5065e2900912272219y3734fc9fsdaee41167ef99ad7@mail.gmail.com

2010-01-02  Karl Fogel  <kfogel@red-bean.com>

	* bookmark.el: Improvements suggested by Drew Adams:
	(bookmark-bmenu-ensure-position): New name for
	`bookmark-bmenu-check-position'.  Just ensure the position,
	don't return any meaningful value.
	(bookmark-bmenu-header-height, bookmark-bmenu-marks-width):
	New constants.

2010-01-02  Juanma Barranquero  <lekktu@gmail.com>

	* bookmark.el (bookmarks-already-loaded): Doc fix (don't use `iff').
	(bookmark-yank-point, bookmark-bmenu-check-position):
	Fix typos in docstrings.
	(bookmark-save-flag, bookmark-bmenu-toggle-filenames)
	(bookmark-name-from-full-record, bookmark-get-position)
	(bookmark-set-position, bookmark-set, bookmark-handle-bookmark)
	(bookmark-delete, bookmark-save, bookmark-save, bookmark-bmenu-mode):
	Remove useless quoting of parenthesis, etc. in docstrings.

	* ediff-mult.el (ediff-prepare-meta-buffer): Fix typo in help message.
	(ediff-append-custom-diff): Fix typo in error message.
	(ediff-meta-mark-equal-files): Fix typos in messages.

	* mpc.el (mpc-playlist-delete): Fix typo in error messages.

	* net/imap-hash.el (imap-hash-make): Doc fix.
	(imap-hash-test): Fix typo in error message; reflow docstring.
	(imap-hash-p, imap-hash-get, imap-hash-put, imap-hash-make-message)
	(imap-hash-count, imap-hash-server, imap-hash-port, imap-hash-ssl)
	(imap-hash-mailbox, imap-hash-user, imap-hash-password):
	Fix typos in docstrings.
	(imap-hash-open-connection): Fix typo in error message.

	* play/gomoku.el (gomoku): Fix typos in docstring.

	* progmodes/gdb-ui.el (gdb-location-alist): Reflow docstring.
	(gdb-jsonify-buffer): Fix typos in docstring.
	(gdb-goto-breakpoint): Fix typo in error message.
	("Display Other Windows"): Fix typo in help message.
	(gdb-speedbar-expand-node): Fix typo in question.

	* progmodes/idlw-help.el (idlwave-help-browse-url-available)
	(idlwave-html-system-help-location, idlwave-html-help-location)
	(idlwave-help-browser-function, idlwave-help-browser-generic-program)
	(idlwave-help-browser-generic-args, idlwave-help-directory)
	(idlwave-html-help-is-available, idlwave-help-mode-line-indicator)
	(idlwave-help-mode-map, idlwave-help-mode, idlwave-do-context-help)
	(idlwave-online-help, idlwave-help-html-link)
	(idlwave-help-show-help-frame, idlwave-help-assistant-command):
	Fix typos in docstrings.
	(idlwave-help-with-source, idlwave-help-find-routine-definition):
	Reflow docstrings.
	(idlwave-help-assistant-start): Fix typo in error message.

	* progmodes/octave-mod.el (octave-mode, octave-electric-semi)
	(octave-electric-space): Fix typos in docstrings.

2010-01-01  Chong Yidong  <cyd@stupidchicken.com>

	* files.el (minibuffer-with-setup-hook): Doc fix (Bug#5149).

2010-01-01  Juri Linkov  <juri@jurta.org>

	* comint.el (comint-input-ring-size): Make it a defcustom and
	increase the default to 500 (Bug#5148).

2009-12-31  Nick Roberts  <nickrob@snap.net.nz>

	Further changes from EMACS_23_1_RC branch (2009-12-29 contd).
	* term/x-win.el (x-gtk-stock-map): Map some GUD buttons.
	* progmodes/gud.el (gud-menu-map): Add reverse-execution commands.

2009-12-30  Nick Roberts  <nickrob@snap.net.nz>

	Show working revision correctly for mercurial.
	* vc-hg.el (vc-hg-working-revision): Use hg parent instead of
	hg log as suggested by Alex Harsanyi <alexharsanyi@gmail.com>.

2009-12-29  Juanma Barranquero  <lekktu@gmail.com>

	Declare some functions for the byte-compiler.
	* progmodes/gdb-ui.el (speedbar-change-initial-expansion-list)
	(speedbar-timer-fn, speedbar-change-expand-button-char)
	(speedbar-delete-subblock, speedbar-center-buffer-smartly): Declare.

2009-12-29  Nick Roberts  <nickrob@snap.net.nz>

	This changeset reverts GDB Graphical Interface to use annotations.
	* progmodes/gdb-ui.el, progmodes/gud.el: Import from EMACS_23_1_RC.

2009-12-29  Dan Nicolaescu  <dann@ics.uci.edu>

	Make vc-dir work on subdirectories of the bzr root.
	* vc-bzr.el (vc-bzr-after-dir-status): Add new argument.  Return
	file names relative to it.
	(vc-bzr-dir-status, vc-bzr-dir-status-files): Pass the bzr root
	relative directory to vc-bzr-after-dir-status.

2009-12-28  Tassilo Horn  <tassilo@member.fsf.org>

	* font-lock.el (font-lock-refresh-defaults): New function, which
	can be used to let font-lock react to external changes in
	variables like font-lock-defaults and keywords.
	See http://thread.gmane.org/gmane.emacs.devel/118777/focus=118802

2009-12-28  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-rcs.el (vc-rcs-register): Fix registering a specific version.

	* vc-bzr.el (vc-bzr-log-view-mode): Fix short log regexp.

2009-12-28  Juanma Barranquero  <lekktu@gmail.com>

	Supersede color.diff settings in git log (bug#5211).

	* vc-git.el (vc-git-print-log): Pass "--no-color" to log to avoid
	escape chars in its output when the user has color.diff set to `always'.
	This fix works on git 1.4.2 and newer (released on 2006-08-13).

2009-12-26  Kevin Ryde  <user42@zip.com.au>

	* info-look.el (sh-mode): Look for coreutils new "Concept Index"
	node.  Keep previous "Index" name to work with past coreutils too.

	* man.el (man): Revise docstring a bit to show -a and -l as
	examples.  Add -k description since support for it has otherwise
	been a secret.  (Further to bug#3717.)
	(Man-bgproc-sentinel): When "-k foo" produces no output show error
	"no matches" rather than "Can't find manpage", as the latter reads
	like -k was interpreted as a page name, which is not so.  (Bug#5431)

2009-12-26  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-handle-insert-directory): Quote "'" in the
	switches.  Check also for //SUBDIRED// line.

2009-12-25  Kenichi Handa  <handa@m17n.org>

	* language/indian.el (devanagari-composable-pattern): Fixed to
	handle ZWNJ and ZWJ.  Use it in composition-function-table for
	Devanagari.
	(malayalam-composable-pattern): Fix previous change.

2009-12-23  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-print.el (ps-face-attributes): It was not returning the
	attribute face for faces specified as string.  Reported by harven
	<harven@free.fr>.  (Bug#5254)
	(ps-print-version): New version 7.3.5.

2009-12-18  Ulf Jasper  <ulf.jasper@web.de>

	* calendar/icalendar.el (icalendar--convert-tz-offset):
	Fix timezone names.
	(icalendar--convert-tz-offset): Fix the "last-day-problem".
	(icalendar--add-diary-entry): Remove the trailing blank that
	diary-make-entry inserts.

2009-12-17  Michael Albinus  <michael.albinus@gmx.de>

	Make `file-expand-wildcards' work for remote files.

	* files.el (file-expand-wildcards): In case of remote files, check
	only local file name part for wildcards.  Provide feature 'files
	and subfeature 'remote-wildcards.  (Bug#5198)

	* net/tramp.el (tramp-handle-file-remote-p): Expand file name only
	if there is already an established connection.
	(tramp-advice-file-expand-wildcards): Remove it.

	* net/tramp-compat.el (top): Autoload `tramp-handle-file-remote-p'.
	(tramp-advice-file-expand-wildcards): Move from tramp.el.
	Activate advice for older GNU Emacs versions.  (Bug#5237)

2009-12-17  Juanma Barranquero  <lekktu@gmail.com>

	Some doc fixes (more needed).

	* find-cmd.el (find-constituents): Reflow docstring.
	(find-cmd, find-prune, find-command): Fix typos in docstrings.
	(find-generic): Doc fix.

2009-12-17  Juri Linkov  <juri@jurta.org>

	Fix regression from 23.1 to allow multiple modes in Local Variables.

	* files.el (hack-local-variables-filter): While ignoring duplicates,
	don't take `mode' into account.
	(hack-local-variables-filter, hack-dir-local-variables):
	Don't remove duplicate `mode' from local-variables-alist (like `eval').

2009-12-17  Juri Linkov  <juri@jurta.org>

	Make `dired-diff' safer.  (Bug#5225)

	* dired-aux.el (dired-diff): Signal an error when `file' equals to
	`current' or when `file' is a directory of the `current' file.

2009-12-17  Andreas Schwab  <schwab@linux-m68k.org>

	* emacs-lisp/autoload.el (batch-update-autoloads): Only exclude
	unconditionally preloaded files.

2009-12-16  Juri Linkov  <juri@jurta.org>

	Revert to old 23.1 logic of using the file at the mark as default.
	* dired-aux.el (dired-diff): Use the file at the mark as default
	if it's not the same as the current file, and the target dir is
	the current dir or the mark is active.  Add the current file
	as the arg of `dired-dwim-target-defaults'.  Use the default file
	in the prompt.  (Bug#5225)

2009-12-15  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-echo-mark-marker-length): New defconst.
	(tramp-echo-mark, tramp-echoed-echo-mark-regexp): Use it.
	(tramp-check-for-regexp): Check also, when an echoing shell stops
	to echo sent commands.

2009-12-14  Chong Yidong  <cyd@stupidchicken.com>

	* Makefile.in: Revert last change (Bug#5191).

2009-12-14  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-hg.el (vc-hg-print-log): Fix argument order.
	(vc-hg-working-revision): Make sure the command is executed in a
	known environment so that we can parse the output.  (Bug#4417)

2009-12-14  Chong Yidong  <cyd@stupidchicken.com>

	* progmodes/python.el (python-symbol-completions): Remove text
	properties from symbol string before calling python-send-receive.

2009-12-14  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-mi.el (gdb-frame-handler): Only set gud-lat-frame
	when there are values for both file and line.  (Bug#5060)

2009-12-14  Juri Linkov  <juri@jurta.org>

	* ediff-ptch.el (ediff-context-diff-label-regexp): Don't match
	whitespace after the file name of the first line of unified format,
	because git-diff doesn't output whitespace and file modification time
	after the file name.

2009-12-14  David Kastrup  <dak@gnu.org>

	* info.el (Info-hide-cookies-node): Before hiding a cookie,
	check if it already has the `display' property added by
	`Info-display-images-node', and not put the `invisible' property
	in this case.

2009-12-13  Glenn Morris  <rgm@gnu.org>

	* mail/emacsbug.el (message-sort-headers): Define for compiler.
	(report-emacs-bug): In message-mode, sort manually before storing
	original report text.  (Bug#5178)
	Remove superfluous save-excursion.

2009-12-12  Michael Albinus  <michael.albinus@gmx.de>

	* net/dbus.el (dbus-property-handler): Filter lambda forms out
	when responding to "GetAll" properties.

2009-12-12  Chong Yidong  <cyd@stupidchicken.com>

	* simple.el (compose-mail): Remove mail-setup-with-from from
	customization checks.

2009-12-12  Eli Zaretskii  <eliz@gnu.org>

	* arc-mode.el (archive-rar-summarize): Support Attribute fields in
	RAR archives created on Unix systems.

2009-12-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuffer.el (minibuffer-local-must-match-filename-map): Re-instate
	the varalias that was accidentally removed by the 2009-11-19 change
	(bug#5186).

2009-12-12  Kenichi Handa  <handa@m17n.org>

	* language/indian.el (indian-compose-regexp): New function.
	(malayalam-composable-pattern): Fix the pattern.
	(composition-function-table): Set malayalam-composable-pattern for
	Malayalam characters.

2009-12-11  Chong Yidong  <cyd@stupidchicken.com>

	* progmodes/bug-reference.el (bug-reference-map): Bind mouse-2
	rather than down-mouse-1, based on follow-link conventions.

	* makefile.w32-in: Ensure that Lisp files in CEDET subdirectories
	are compiled.

2009-12-11  Michael McNamara  <mac@mail.brushroad.com>

	* progmodes/verilog-mode.el (verilog-vmm-begin-re, verilog-vmm-end-re)
	(verilog-vmm-statement-re, verilog-ovm-statement-re)
	(verilog-defun-level-not-generate-re, verilog-calculate-indent)
	(verilog-leap-to-head, verilog-backward-token):
	Fix indenting VMM macros.  Reported by Jonathan Ashbrook.

2009-12-11  Wilson Snyder  <wsnyder@wsnyder.org>

	* progmodes/verilog-mode.el (verilog-auto-lineup)
	(verilog-nameable-item-re): Cleanup user-visible spelling and
	documentation errors.  One reported by Gary Delp.
	(verilog-submit-bug-report): Mention bug tracking and CC co-author.
	(verilog-read-decls): Fix AUTOWIRE with types declared in a
	package, bug195.  Reported by Pierre-David Pfister.

2009-12-11  Glenn Morris  <rgm@gnu.org>

	* progmodes/cc-engine.el (safe-pos-list): Define for compiler.

	* mail/emacsbug.el: No longer require sendmail.
	Replace sendmail's `mail-text' by `rfc822-goto-eoh'.  (Bug#5174)
	(report-emacs-bug-orig-text): Doc fix.
	(report-emacs-bug-send-command, report-emacs-bug-send-hook):
	New local variables, to adapt to different mail-user-agents.
	(report-emacs-bug): Fix test for a gnu.org address.
	Use overlays for emphasis, since font-lock defeats 'face property.
	Pretest bugs also end up at the newsgroup these days.
	Stop message-mode stripping text properties.
	Set and use the new buffer-local variables.
	(report-emacs-bug-hook): Add doc-string.
	Remove some unnecessary save-excursions and simplify.
	Use the appropriate hook and send-command.

	* emacs-lisp/lisp-mode.el (emacs-lisp-mode-map): Standardize the
	capitalization of some menu entries.

2009-12-10  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* whitespace.el (whitespace-display-char-on):
	Ensure `buffer-display-table' is unique when two or more windows are
	visible.  Reported by Martin Pohlack <mp26@os.inf.tu-dresden.de>.
	New version 12.1.

2009-12-10  Eli Zaretskii  <eliz@gnu.org>

	* arc-mode.el (archive-rar-summarize): Allow between 6 and 7
	characters in the Attribute field.

2009-12-10  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-svn.el (vc-svn-after-dir-status): Fix regexp.  (Bug#4741)

2009-12-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	Let loaddefs.el adjust to changes in autoload-excludes (bug#5162).
	* emacs-lisp/autoload.el (autoload-generate-file-autoloads):
	Disregard autoload-excludes.
	(update-directory-autoloads): Obey autoload-excludes here instead.
	But don't store its contents in no-autoloads and remove entries that
	refer to excludes files.

2009-12-10  Glenn Morris  <rgm@gnu.org>

	* mail/feedmail.el (top-level): Move require 'mail-utils to start.
	(expand-mail-aliases): Define for compiler.

	* vc-annotate.el (log-view-vc-backend, log-view-vc-fileset):
	Define for compiler.

	* mail/emacsbug.el (report-emacs-bug): Use whichever send command is
	appropriate for the mail-user-agent in use.

2009-12-09  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-handle-insert-directory): Suppress error messages.

2009-12-09  Dan Nicolaescu  <dann@ics.uci.edu>

	Fix short log parsing and fontification.
	* vc-bzr.el (vc-bzr-log-view-mode): Match dot in revision number.
	Fix fontification for the [merge] label.

2009-12-09  Vivek Dasmohapatra  <vivek@etla.org>

	Drop some properties to avoid surprises (bug#5002).
	* htmlfontify.el (hfy-ignored-properties): New defcustom.
	(hfy-fontify-buffer): Use it.

2009-12-09  Stefan Monnier  <monnier@iro.umontreal.ca>

	Minor cleanup.
	* ffap.el (ffap-symbol-value): Replace ffap-soft-value.
	Adjust all callers.
	(ffap-locate-file): Remove unused arg `dir-ok' and make other
	args compulsory.  Adjust callers.
	(ffap-gopher-at-point): Remove unused var `name'.

	Get rid of the ELCFILES abomination.
	* Makefile.in (update-elclist, ELCFILES, compile-last): Remove.
	(compile-elcfiles): New phony target.
	(compile-main): Compute ELCFILES dynamically.
	(compile-clean): New target to remove left-over elc files.
	(compile, all): Use it.

2009-12-09  Kenichi Handa  <handa@etlken>

	* international/mule-diag.el: Require help-mode instead of help-fns.

2009-12-09  Kenichi Handa  <handa@m17n.org>

	* international/mule-cmds.el (ucs-names): Supply sufficiently
	fine ranges instead of pre-calculating accurate ranges.
	Iterate with bigger gc-cons-threshold.

2009-12-08  Dan Nicolaescu  <dann@ics.uci.edu>

	Add support for stashing a snapshot of the current tree.
	* vc-git.el (vc-git-stash-snapshot): New function.
	(vc-git-stash-map, vc-git-extra-menu-map): Add a mapping for it.

2009-12-08  Jose E. Marchesi  <jemarch@gnu.org>

	* play/gomoku.el (gomoku-mode-map): Remap `move-(beginning|end)-of-line'
	instead of `(beginning|end)-of-line'.

2009-12-08  Glenn Morris  <rgm@gnu.org>

	* vc-mtn.el (vc-mtn-print-log): Fix typo in previous.

	* Makefile.in (ELCFILES): Regenerate.

2009-12-07  Juri Linkov  <juri@jurta.org>

	Don't lazy-highlight the comint output in history Isearch mode.

	* comint.el (comint-history-isearch-search): Instead of
	`comint-line-beginning-position', use `comint-after-pmark-p'
	to check if point if before the process mark, and go to
	`process-mark' in this case.

2009-12-07  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/tex-mode.el (latex-complete)
	(latex-indent-or-complete): Remove.
	(latex-mode): Set completion-at-point-functions instead.

	Provide a standard completion command and hook it into TAB.
	* minibuffer.el (completion-at-point-functions): New var.
	(completion-at-point): New command.
	* indent.el (indent-for-tab-command): Handle the `complete' behavior.
	* progmodes/python.el (python-mode-map): Use completion-at-point.
	(python-completion-at-point): Rename from python-partial-symbol and
	adjust for use in completion-at-point-functions.
	(python-mode): Setup completion-at-point for Python completion.
	* emacs-lisp/lisp.el (lisp-completion-at-point): New function
	extracted from lisp-complete-symbol.
	(lisp-complete-symbol): Use it.
	* emacs-lisp/lisp-mode.el (emacs-lisp-mode): Use define-derived-mode,
	setup completion-at-point for Elisp completion.
	(emacs-lisp-mode-map, lisp-interaction-mode-map):
	Use completion-at-point.
	* ielm.el (ielm-map): Use completion-at-point.
	(inferior-emacs-lisp-mode): Setup completion-at-point-functions.
	* progmodes/sym-comp.el: Move to...
	* obsolete/sym-comp.el: Move from progmodes.

2009-12-07  Eli Zaretskii  <eliz@gnu.org>

	Prevent save-buffer in Rmail buffers from using the coding-system
	of the current message, and from clobbering the encoding mnemonics
	in the mode line (Bug#4623).

	* mail/rmail.el (rmail-swap-buffers): Swap encoding and modified
	flag, too.
	(rmail-message-encoding): New variable.
	(rmail-write-region-annotate): Record the encoding of the current
	message in rmail-message-encoding.
	(rmail-after-save-hook): New function, restores the encoding of
	the current message after the message collection is saved.

2009-12-07  Juri Linkov  <juri@jurta.org>

	* progmodes/grep.el (grep-read-files): Use `completing-read'
	instead of `read-string'.  Set its `collection' arg to
	`read-file-name-internal'.  (Bug#4301)

2009-12-07  Juri Linkov  <juri@jurta.org>

	Correctly restore original Isearch point.  (Bug#4994)

	* isearch.el (isearch-mode): Move `isearch-push-state' after
	`(run-hooks 'isearch-mode-hook)'.
	(isearch-cancel): When `isearch-push-state-function' is defined,
	let-bind `isearch-cmds' to the first state (the last element of
	`isearch-cmds') and call `isearch-top-state' (it calls pop-state
	function and restores the original point).  Otherwise, move point
	to `isearch-opoint'.

2009-12-07  Stefan Monnier  <monnier@iro.umontreal.ca>

	* international/mule-cmds.el (ucs-names): Weed out at compile-time the
	chars that don't have names, so the table can be built much faster at
	run-time.

2009-12-07  Chong Yidong  <cyd@stupidchicken.com>

	* vc-bzr.el (vc-bzr-annotate-command): More elegant form for last
	change.  Suggested by David Kastrup.

	* simple.el (compose-mail): Check for incompatibilities and warn.
	(compose-mail-user-agent-warnings): New option.

2009-12-07  Dan Nicolaescu  <dann@ics.uci.edu>

	Support showing a single log entry from vc-annotate.
	* vc.el (print-log): Add a new argument: START-REVISION.
	(vc-print-log-internal): Add a new optional argument and
	pass it to the backend.
	(vc-print-log, vc-print-root-log): Adjust callers.
	* vc-annotate.el (vc-annotate-show-log-revision-at-line): If a
	buffer already displays the requested log entry, use it.
	Otherwise display only the log entry in question.
	* vc-svn.el (vc-svn-print-log):
	* vc-mtn.el (vc-mtn-print-log):
	* vc-hg.el (vc-hg-state):
	* vc-git.el (vc-git-print-log): Add support for new argument START-REVISION.
	(vc-git-show-log-entry): Return t on success.
	* vc-bzr.el (vc-bzr-print-log): Add support new argument START-REVISION.
	(vc-bzr-show-log-entry): Return t on success.
	* vc-rcs.el (vc-rcs-print-log):
	* vc-sccs.el (vc-sccs-print-log):
	* vc-cvs.el (vc-cvs-print-log): Add new argument, ignore it.

2009-12-07  Dan Nicolaescu  <dann@ics.uci.edu>

	* ediff-mult.el (ediff-setup-meta-map, ediff-prepare-meta-buffer):
	Add menus to the meta mode.  (Bug#5043)

2009-12-07  Michael Kifer  <kifer@cs.stonybrook.edu>

	* ediff-init.el (ediff-event-key): Use event-to-character instead of
	event-key.

	* ediff.el (ediff-buffers-internal): Add unwind-protect.

2009-12-07  Michael Albinus  <michael.albinus@gmx.de>

	Handle prompt rules of ksh in OpenBSD 4.5.  Reported by Raphaël
	Berbain <raphael.berbain@gmail.com>.

	* net/tramp.el (tramp-end-of-output): Move up.  Use `#' and `$'
	characters.
	(tramp-initial-end-of-output): New defconst.
	(tramp-methods, tramp-find-shell)
	(tramp-open-connection-setup-interactive-shell)
	(tramp-maybe-open-connection): Use it.
	(tramp-shell-prompt-pattern, tramp-wait-for-output): Handle
	existence of `#' and `$'.

	* net/tramp-fish.el (tramp-fish-maybe-open-connection): Use
	`tramp-initial-end-of-output'.

2009-12-07  Dan Nicolaescu  <dann@ics.uci.edu>

	Get the background mode from the terminal for xterm, and set
	faces accordingly.
	* term/xterm.el (xterm-set-background-mode): New function.
	(terminal-init-xterm): Use it in case xterm supports background
	color queries.  Recompute faces after getting the background
	color.

2009-12-07  Ulrich Mueller  <ulm@gentoo.org>

	* emacs-lisp/bytecomp.el (byte-compile-insert-header): Put the version
	number comment back on its own line, for easier parsing.

2009-12-07  Stefan Monnier  <monnier@iro.umontreal.ca>

	Make it work for non-file buffers (bug#5102).
	* doc-view.el (doc-view-current-cache-dir):
	Use doc-view-buffer-file-name rather than buffer-file-name.
	(doc-view-mode): Use buffer-name when buffer-file-name is nil.

2009-12-06  Óscar Fuentes  <ofv@wanadoo.es>

	* vc-bzr.el (vc-bzr-annotate-command): Handle the case where the
	author field is too short.

2009-12-06  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-git.el (vc-git-print-log): Handle a limit argument.
	Display the short log in graph form and with labels.
	(vc-git-log-view-mode): Handle labels.

	Make vc-revert change VC state from 'added to 'unregistered.
	* vc-git.el (vc-git-revert): Call git reset first.

2009-12-06  Ulf Jasper  <ulf.jasper@web.de>

	* net/newst-backend.el, net/newst-plainview.el:
	* net/newst-reader.el, net/newst-ticker.el:
	* net/newst-treeview.el, net/newsticker.el:
	Require/provide newst-... (instead of newsticker-...).  (Bug#5096)

2009-12-06  Chong Yidong  <cyd@stupidchicken.com>

	* log-view.el (log-view-mode-map): Bind "=" to log-view-diff too.

	* vc-bzr.el (vc-bzr-annotate-command): Show author in annotation.
	Handle empty author field (Bug#4144).  Suggested by Óscar Fuentes.
	(vc-bzr-annotate-time, vc-bzr-annotate-extract-revision-at-line):
	Update annotation regexp.

	* simple.el (beginning-of-visual-line): Constrain to field
	boundaries (Bug#5106).

2009-12-06  Ulf Jasper  <ulf.jasper@web.de>

	* xml.el (xml-substitute-numeric-entities): Move
	newsticker--decode-numeric-entities in newst-backend.el to
	xml-substitute-numeric-entities in xml.el.  (Bug#5008)
	* net/newst-backend.el (newsticker--parse-generic-feed)
	(newsticker--parse-generic-items)
	(newsticker--decode-numeric-entities): Move
	newsticker--decode-numeric-entities in newst-backend.el to
	xml-substitute-numeric-entities in xml.el.  (Bug#5008)

2009-12-06  Daniel Colascione  <dan.colascione@gmail.com>

	* progmodes/js.el (js--js-not): Add null to the list of values.

2009-12-06  Chong Yidong  <cyd@stupidchicken.com>

	* ansi-color.el (ansi-color-for-comint-mode): Add :version keyword.

2009-12-06  Roland Winkler  <Roland.Winkler@physik.uni-erlangen.de>

	* textmodes/bibtex.el (bibtex-enclosing-field): Exclude entry
	delimiter if it is at the end of the current line.
	(bibtex-generate-url-list): Fix docstring.

2009-12-06  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuffer.el (minibuffer-complete-and-exit): Don't replace the
	minibuffer's content with itself.
	Fold the confirm-after-completion case into the `confirm' case.
	(completion-pcm-word-delimiters): Add : and / to the delimiters.

2009-12-06  Kevin Ryde  <user42@zip.com.au>

	* ffap.el (ffap-rfc-path): Make this a defcustom since
	`ffap-rfc-directories' is also a defcustom.  (Bug#4514.)

	* info-look.el: Add setup for apropos-mode to use emacs-lisp-mode
	manuals, similar to existing setup for help-mode.  (Bug#3913.)

2009-12-05  Juri Linkov  <juri@jurta.org>

	Save and restore dired buffer's point positions too.  (Bug#4880)

	* dired.el (dired-save-positions): Return in the first element
	buffer's position in format (BUFFER DIRED-FILENAME BUFFER-POINT).
	Doc fix.
	(dired-restore-positions): First restore buffer's position.
	While restoring window's positions, check if window still displays
	the original buffer.

2009-12-05  Chong Yidong  <cyd@stupidchicken.com>

	* bindings.el (complete-symbol): Call semantic-ia-complete-symbol
	if possible.

	* shell.el (shell): Require ansi-color (Bug#5113).

	* ansi-color.el (ansi-color-for-comint-mode): Default to t.

	* hl-line.el (global-hl-line-highlight): Minor doc fix (Bug#4925).

2009-12-05  Alan Mackenzie  <acm@muc.de>

	* progmodes/cc-mode.el (c-before-hack-hook)
	(c-postprocess-file-styles): Revert change 2009-07-18T21:03:43Z!acm@muc.de to permit
	`c-file-style' to work again.  This reversion restores the current
	software to its state in Emacs 23.1.  (Bug#4146)

2009-12-05  Kevin Ryde  <user42@zip.com.au>

	* textmodes/sgml-mode.el (sgml-lexical-context): Recognise
	comment-start-skip to comment-end-skip as comment (Bug#4781).

2009-12-05  Juri Linkov  <juri@jurta.org>

	* info.el (Info-find-node-2): Set `Info-current-subfile' to nil
	for virtual nodes.  (Bug#4147)
	(Info-find-node-2): Set `Info-current-node-virtual' to nil
	when moving from a virtual node.
	(Info-mode-menu): Add `Info-virtual-index' to the menu.
	(Info-mode): Add `Info-virtual-index' to the docstring.

2009-12-05  Roland Winkler  <Roland.Winkler@physik.uni-erlangen.de>

	* textmodes/bibtex.el (bibtex-map-entries): Use marker to keep
	track of the buffer position of the end of a BibTeX entry as this
	position may change during reformatting.
	(bibtex-format-entry): Remove whitespace before processing
	numerical fields so that we recognize the latter properly.
	(bibtex-reformat): Do not use push which changes the global value
	of bibtex-entry-format.
	(bibtex-field-braces-alist, bibtex-field-strings-alist)
	(bibtex-field-re-init): Replace only space characters by regexp
	for whitespace.
	(bibtex-generate-url-list, bibtex-cite-matcher-alist): Fix docstring.
	(bibtex-initialize): Also update bibtex-strings.
	(bibtex-kill-field): Preserve white space at end of entry.
	(bibtex-kill-entry, bibtex-yank-pop, bibtex-insert-kill):
	Update bibtex-reference-keys.

2009-12-05  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuffer.el (completion-pcm--merge-try): Also consider placing
	point after a star, if that's the only place where modifications can
	make progress.

2009-12-05  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-dir.el (vc-dir): Use the correct markup for showing keymaps
	in docstrings.

2009-12-04  Juri Linkov  <juri@jurta.org>

	* proced.el (proced): Call `(proced-update t)' to update process
	information instead of only running proced-post-display-hook.
	(proced-send-signal): Add a leading space to the buffer name
	" *Marked Processes*" to make this buffer ephemeral.

2009-12-04  Juri Linkov  <juri@jurta.org>

	* dired.el (dired-auto-revert-buffer): New defcustom.
	(dired-internal-noselect): Use it.

2009-12-04  Juri Linkov  <juri@jurta.org>

	Change roles of modes and functions in image-mode.el (Bug#5062).

	* image-mode.el: Replace `image-mode-maybe' with `image-mode'
	in `auto-mode-alist'.
	(image-mode-previous-major-mode): New variable.
	(image-minor-mode-map): Rename from `image-mode-text-map'.
	(image-mode): Move graceful error-handling code from
	`image-minor-mode' to here.  On errors call `image-mode-as-text'.
	(image-minor-mode): Remove all image-handling code.
	Replace `image-mode-text-map' with `image-minor-mode-map'.
	Check for `image-type' in mode-line format string.
	(image-mode-maybe): Make obsolete with an alias to `image-mode'.
	(image-mode-as-text): New function with most code from
	`image-mode-maybe'.
	(image-toggle-display-text): Move code that removes image
	properties from `image-toggle-display' to here.
	(image-toggle-display-image): New function with code that adds
	image properties copied from `image-toggle-display'.
	(image-toggle-display): Remove most code with leaving only code
	that toggles between `image-mode-as-text' and `image-mode'.

2009-12-04  Ulf Jasper  <ulf.jasper@web.de>

	* net/newst-treeview.el
	(newsticker--treeview-list-highlight-start): Restored call to
	save-excursion: Selected item was stuck.
	(newsticker--treeview-list-select): New.
	(newsticker--treeview-item-show-text)
	(newsticker--treeview-item-show)
	(newsticker--treeview-item-update): Use new
	newsticker-treeview-item-mode.
	(newsticker-treeview-update): Keep current item.
	(newsticker-treeview-next-new-or-immortal-item): Doc change.
	(newsticker--treeview-first-feed): Doc change.
	(newsticker-treeview-list-menu)
	(newsticker-treeview-item-menu): Added menu entries.
	(newsticker-treeview-item-mode): New.

	* net/newst-backend.el (newsticker-customize): Delete other
	windows.

2009-12-04  Sam Steingold  <sds@gnu.org>

	* log-view.el (log-view-mode-map): "q" calls quit-window,
	like in all the other non-self-insert buffers.

2009-12-04  Stefan Monnier  <monnier@iro.umontreal.ca>

	Minor cleanup.
	* term.el (term-send-raw, term-send-raw-meta): Use read-key-sequence's
	key decoding rather than do it manually via last-input-event +
	ascii-character.
	(term-exec): Use delete-and-extract-region.
	(term-handle-ansi-terminal-messages): Remove unused var `end'.
	(term-process-pager): Remove unused var `i'.
	(term-dynamic-simple-complete): Make obsolete.
	(serial-update-config-menu): Remove unused vars `y' and `str'.
	(term-update-mode-line): Remove unused var `temp'.

2009-12-03  Dan Nicolaescu  <dann@ics.uci.edu>

	Limit the number of log entries displayed by default.
	* vc.el (vc-print-log-internal): Fix check for limit-unsupported.
	(vc-print-log, vc-print-root-log): Use vc-log-show-limit when not
	using a prefix argument.

2009-12-03  Glenn Morris  <rgm@gnu.org>

	* progmodes/idlwave.el (class): Restore still useful declaration.

2009-12-03  Alan Mackenzie  <acm@muc.de>

	Enhance `c-parse-state' to run efficiently in "brace deserts".

	* progmodes/cc-mode.el (c-basic-common-init):
	Call c-state-cache-init.
	(c-neutralize-syntax-in-and-mark-CPP): Rename from
	c-extend-and-neutralize-syntax-in-CPP.  Mark each CPP construct by
	placing `category' properties value 'c-cpp-delimiter at its boundaries.

	* progmodes/cc-langs.el (c-before-font-lock-function):
	c-extend-and-neutralize-syntax-in-CPP has been renamed
	c-neutralize-syntax-in-and-mark-CPP.

	* progmodes/cc-fonts.el (c-cpp-matchers): Mark template brackets
	with `category' properties now, not `syntax-table' ones.

	* progmodes/cc-engine.el (c-syntactic-end-of-macro): A new
	enhanced (but slower) version of c-end-of-macro that won't land
	inside a literal or on another awkward character.
	(c-state-cache-too-far, c-state-cache-start)
	(c-state-nonlit-pos-interval, c-state-nonlit-pos-cache)
	(c-state-nonlit-pos-cache-limit, c-state-point-min)
	(c-state-point-min-lit-type, c-state-point-min-lit-start)
	(c-state-min-scan-pos, c-state-brace-pair-desert)
	(c-state-old-cpp-beg, c-state-old-cpp-end): New constants and
	buffer local variables.
	(c-state-literal-at, c-state-lit-beg)
	(c-state-cache-non-literal-place, c-state-get-min-scan-pos)
	(c-state-mark-point-min-literal, c-state-cache-top-lparen)
	(c-state-cache-top-paren, c-state-cache-after-top-paren)
	(c-get-cache-scan-pos, c-get-fallback-scan-pos)
	(c-state-balance-parens-backwards, c-parse-state-get-strategy)
	(c-renarrow-state-cache)
	(c-append-lower-brace-pair-to-state-cache)
	(c-state-push-any-brace-pair, c-append-to-state-cache)
	(c-remove-stale-state-cache)
	(c-remove-stale-state-cache-backwards, c-state-cache-init)
	(c-invalidate-state-cache-1, c-parse-state-1)
	(c-invalidate-state-cache): New defuns/defmacros/defsubsts.
	(c-parse-state): Enhance and refactor.
	(c-debug-parse-state): Amend to deal with all the new variables.

	* progmodes/cc-defs.el (c-<-as-paren-syntax, c-mark-<-as-paren)
	(c->-as-paren-syntax, c-mark->-as-paren, c-unmark-<->-as-paren):
	modify to use category text properties rather than syntax-table ones.
	(c-suppress-<->-as-parens, c-restore-<->-as-parens): New defsubsts
	to switch off/on the syntactic paren property of C++ template
	delimiters using the category property.
	(c-with-<->-as-parens-suppressed): Macro to invoke code with
	template delims suppressed.
	(c-cpp-delimiter, c-set-cpp-delimiters, c-clear-cpp-delimiters):
	New constant/macros which apply category properties to the start
	and end of preprocessor constructs.
	(c-comment-out-cpps, c-uncomment-out-cpps): Defsubsts which
	"comment out" the syntactic value of characters in preprocessor
	constructs.
	(c-with-cpps-commented-out)
	(c-with-all-but-one-cpps-commented-out): Macros to invoke code
	with characters in all or all but one preprocessor constructs
	"commented out".

2009-12-03  Roland Winkler  <Roland.Winkler@physik.uni-erlangen.de>

	* proced.el (proced-filter-alist): Use regexp-quote.

2009-12-03  Michael Albinus  <michael.albinus@gmx.de>

	Cleanup.
	* eshell/em-unix.el (top): Require 'esh-opt and 'pcomplete.
	(eshell/su, eshell/sudo): Require 'tramp.  Fix problems reading
	arguments.  Expand `default-directory'.

	* net/tramp.el (tramp-handle-file-remote-p): Expand FILENAME for
	the benefit of returning an expanded localname.
	(tramp-tramp-file-p): Handle the case NAME is not a string.

2009-12-03  Dan Nicolaescu  <dann@ics.uci.edu>

	Add support for bzr shelve/unshelve.
	* vc-bzr.el (vc-bzr-shelve-map, vc-bzr-shelve-menu-map)
	(vc-bzr-extra-menu-map): New variables.
	(vc-bzr-extra-menu, vc-bzr-extra-status-menu, vc-bzr-shelve)
	(vc-bzr-shelve-apply, vc-bzr-shelve-list)
	(vc-bzr-shelve-get-at-point, vc-bzr-shelve-delete-at-point)
	(vc-bzr-shelve-apply-at-point, vc-bzr-shelve-menu): New functions.
	(vc-bzr-dir-extra-headers): Display shelves.

	* vc-bzr.el (vc-bzr-print-log): Deal with nil arguments better.

2009-12-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/bibtex.el (bibtex-complete-internal):
	Use completion-in-region.
	(bibtex-text-in-field-bounds): Remove unused var `opoint'.

2009-12-03  Dan Nicolaescu  <dann@ics.uci.edu>

	Support applying stashes.  Improve UI.
	* vc-git.el (vc-git-dir-extra-headers): Add tooltips.
	(vc-git-stash-apply, vc-git-stash-pop)
	(vc-git-stash-apply-at-point, vc-git-stash-pop-at-point)
	(vc-git-stash-menu): New functions.
	(vc-git-stash-menu-map): New variable.
	(vc-git-stash-map): Add bindings to popup a menu and to apply stashes.

2009-12-03  Glenn Morris  <rgm@gnu.org>

	* vc.el (log-view-vc-backend, log-view-vc-fileset): Declare.
	(vc-print-log-internal): Fix previous change.
	(vc-revert): Correct pluralization.

2009-12-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/make-mode.el (makefile-special-targets-list): No need for
	it to be an alist any more.
	(makefile-complete): Use completion-in-region.

	* progmodes/octave-mod.el (octave-complete-symbol):
	Use completion-in-region.

	Misc cleanup.
	* progmodes/idlwave.el (idlwave-comment-hook): Simplify with `or'.
	(idlwave-code-abbrev, idlwave-display-user-catalog-widget)
	(idlwave-complete-class): Don't quote lambda.
	(idlwave-find-symbol-syntax-table, idlwave-mode-syntax-table)
	(idlwave-mode-map): Move initialization into declaration.
	(idlwave-action-and-binding): Use backquotes.
	(idlwave-in-quote, idlwave-reset-sintern, idlwave-complete-in-buffer):
	Simplify.
	(idlwave-is-pointer-dereference): Remove unused var `pos'.
	(idlwave-xml-create-rinfo-list): Remove unused var `entry'.
	(idlwave-convert-xml-clean-sysvar-aliases): Remove unused vars `new',
	`parts', and `all-parts'.
	(idlwave-xml-create-sysvar-alist): Remove unused var `fields'.
	(idlwave-convert-xml-system-routine-info): Remove unused string
	`version-string'.
	(idlwave-display-user-catalog-widget): Use dolist.
	(idlwave-scanning-lib): Declare dynamically-scoped var.
	(idlwave-scan-library-catalogs): Remove unused var `flags'.
	(completion-highlight-first-word-only): Declare to silence bytecomp.
	(idlwave-popup-select): Tighten scope of `resp'.
	(idlwave-find-struct-tag): Remove unused var `beg'.
	(idlwave-after-load-rinfo-hook): Declare.
	(idlwave-sintern-class-info): Remove unused var `taglist'.
	(idlwave-find-class-definition): Remove unused var `list'.
	(idlwave-complete-sysvar-tag-help): Remove unused var `main-base'.
	(idlwave-what-module-find-class): Remove unused var `classes'.

2009-12-03  Juanma Barranquero  <lekktu@gmail.com>

	* progmodes/pascal.el: Require CL when compiling (for lexical-let).

2009-12-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	* hippie-exp.el (try-expand-dabbrev-visible): Preserve point in the
	buffers visited.  Remove redundant current-buffer-saving.

2009-12-02  Stefan Monnier  <monnier@iro.umontreal.ca>

	Use completion-in-buffer and remove uses of dynamic scoping.
	* progmodes/pascal.el (pascal-str, pascal-all, pascal-pred)
	(pascal-buffer-to-use, pascal-flag): Don't declare.
	(pascal-func-completion, pascal-type-completion, pascal-var-completion)
	(pascal-get-completion-decl, pascal-keyword-completion):
	Add `pascal-str' argument, save-excursion,
	return the found completions, and don't filter with pascal-pred.
	(pascal-completion-cache): New var.
	(pascal-completion): Don't switch buffer any more (it was never
	necessary).  Don't save-excursion any more (it's done by the called
	subroutines).  Use a cache to avoid redundant computations.
	Use complete-with-action rather than pascal-completion-response and
	let it apply the predicate as well.
	(pascal-complete-word): Use completion-in-buffer when
	pascal-toggle-completions is nil.
	(pascal-show-completions): Don't bind pascal-buffer-to-use since it's
	not used any more.
	(pascal-comp-defun): Don't change buffer any more.
	Use complete-with-action rather than pascal-completion-response and
	let it apply the predicate as well.
	(pascal-goto-defun): Change buffer before calling pascal-comp-defun
	when neded.

2009-12-02  Kenichi Handa  <handa@m17n.org>

	* language/indian.el: Include ZWJ and ZWNJ in the patterns to
	shape for all Indic scripts.

2009-12-02  Stefan Monnier  <monnier@iro.umontreal.ca>

	Use completion-in-buffer.
	* wid-edit.el (widget-field-text-end): New function.
	(widget-field-value-get): Use it.
	(widget-string-complete, widget-file-complete)
	(widget-color-complete): Use it and completion-in-region.
	(widget-complete): Don't narrow the buffer.

2009-12-02  Glenn Morris  <rgm@gnu.org>

	* mail/rmail.el (rmail-pop-to-buffer): New function.  (Bug#2282)
	(rmail-select-summary): Use rmail-pop-to-buffer.
	* mail/rmailsum.el: Replace all pop-to-buffer calls with
	rmail-pop-to-buffer, to prevent horizontal splits.

	* calendar/diary-lib.el (diary-list-entries): Replace superfluous
	save-excursion with save-current-buffer.
	Widen before searching.  (Bug#5093)
	(diary-list-sexp-entries): Remove superfluous save-excursion.

2009-12-02  Michael Welsh Duggan  <mwd@cert.org>

	* woman.el (woman-make-bufname): Handle man-pages with "." in the
	name.  (Bug#5038)

2009-12-02  Andreas Politz  <politza@fh-trier.de>  (tiny change)

	* ido.el (ido-file-internal): Handle filenames at point that do
	not have a directory part.  (Bug#5049)

2009-12-02  Juanma Barranquero  <lekktu@gmail.com>

	* mpc.el (mpc-intersection, mpc-host, mpc-songs-playlist)
	(mpc-songs-jump-to, mpc-resume): Doc fixes.

2009-12-01  Rob Riepel  <riepel@networking.Stanford.EDU>

	* emulation/tpu-extras.el (tpu-cursor-free-mode): Emit message.
	(tpu-set-cursor-free, tpu-set-cursor-bound): Don't emit a message
	any more.

2009-12-01  Stefan Monnier  <monnier@iro.umontreal.ca>

	* comint.el (comint-insert-input): Ignore clicks to the right of
	the field.  Reported by Bob Nnamtrop <bobnnamtrop@gmail.com>.

	* vc.el (vc-print-log-internal): Don't wait for the process to
	terminate before setting up the major mode.

	* pcmpl-unix.el (pcomplete/cd): Complete more than one argument, just
	in case.

	* pcomplete.el (pcomplete-std-complete): Don't try to complete past
	the last element.

	* simple.el (normal-erase-is-backspace-mode): Fix thinko in message.

2009-12-01  Glenn Morris  <rgm@gnu.org>

	* window.el (window--display-buffer-2): Fix previous changes.

2009-12-01  Chong Yidong  <cyd@stupidchicken.com>

	* mail/sendmail.el (mail-setup-hook, mail-send-hook): Doc fixes.

2009-12-01  Glenn Morris  <rgm@gnu.org>

	* Makefile.in (ELCFILES): Add mpc.elc.

2009-12-01  Stefan Monnier  <monnier@iro.umontreal.ca>

	* mpc.el: New file.

2009-12-01  Glenn Morris  <rgm@gnu.org>

	* window.el (window-to-use): Define for compiler.

	* emacs-lisp/bytecomp.el (byte-compile-save-excursion): Make message
	consistent with others (no final period).

	* mail/rmailmm.el (rmail-mime-handle): Doc fix.
	(rmail-mime-show): Downcase the encoding.  (Bug#5070)

2009-12-01  Dan Nicolaescu  <dann@ics.uci.edu>

	Make vc-print-log buttons work.
	* log-view.el (log-view-mode-map): Inherit from widget-keymap.

2009-11-30  Ryan C. Thompson  <rct@thompsonclan.org>  (tiny change)

	* savehist.el (savehist-autosave-interval): Allow setting to nil
	through customize.  (Bug#5056)

2009-11-30  Juanma Barranquero  <lekktu@gmail.com>

	Fix references to jit-lock properties.
	* progmodes/perl-mode.el (perl-font-lock-syntactic-keywords):
	Refer to jit-lock-defer-multiline, not jit-lock-multiline.
	(perl-font-lock-special-syntactic-constructs):
	Quote jit-lock-defer-multiline property.

2009-11-30  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-git.el (vc-git-registered): Call vc-git-root only once.

2009-11-30  Juri Linkov  <juri@jurta.org>

	* misearch.el (multi-isearch-search-fun): Always provide a non-nil
	value `buffer' of `multi-isearch-next-buffer-current-function'.
	Use `(current-buffer)' when `buffer' is nil.
	(multi-isearch-next-buffer-from-list): Don't fallback to
	`(current-buffer)' when `buffer' is nil.  (Bug#4947)

2009-11-30  Juri Linkov  <juri@jurta.org>

	* misearch.el (multi-isearch-read-buffers): Move canonicalization
	of buffers with `get-buffer' to `multi-isearch-buffers'.
	(multi-isearch-buffers, multi-isearch-buffers-regexp):
	Canonicalize BUFFERS with `get-buffer'.  Doc fix.
	(multi-isearch-files, multi-isearch-files-regexp): Canonicalize
	FILES with `expand-file-name' converting relative file names
	to absolute.  Doc fix.  (Bug#4727)

2009-11-30  Juri Linkov  <juri@jurta.org>

	* misearch.el (multi-isearch-read-buffers)
	(multi-isearch-read-matching-buffers): New functions.
	(multi-isearch-buffers, multi-isearch-buffers-regexp):
	Use them in the `interactive' spec.  Doc fix.
	(multi-isearch-read-files, multi-isearch-read-matching-files):
	New functions.
	(multi-isearch-files, multi-isearch-files-regexp):
	Use them in the `interactive' spec.  Doc fix.  (Bug#4725)

2009-11-30  Juri Linkov  <juri@jurta.org>

	* doc-view.el (doc-view-continuous):
	Rename from `doc-view-continuous-mode'.
	(doc-view-menu): Move "Toggle display" to the top.
	Add submenu "Continuous" with radio buttons "Off"/"On"
	and "Save as Default".
	(doc-view-scroll-up-or-next-page)
	(doc-view-scroll-down-or-previous-page)
	(doc-view-next-line-or-next-page)
	(doc-view-previous-line-or-previous-page): Rename
	`doc-view-continuous-mode' to `doc-view-continuous'.  (Bug#4896)

2009-11-30  Juri Linkov  <juri@jurta.org>

	* comint.el (comint-mode-map): Rebind `M-r' from
	`comint-previous-matching-input' to
	`comint-history-isearch-backward-regexp'.
	Unbind `M-s' to allow global key binding `M-s'.
	Add menu items for `comint-history-isearch-backward' and
	`comint-history-isearch-backward-regexp'.  (Bug#3746)

2009-11-30  Juri Linkov  <juri@jurta.org>

	* replace.el (perform-replace): Let-bind recenter-last-op to nil.
	For def=recenter, replace `recenter' with `recenter-top-bottom'
	that is called with `this-command' and `last-command' let-bound
	to `recenter-top-bottom'.  When the last `def' was not `recenter',
	set `recenter-last-op' to nil.  (Bug#4981)

2009-11-30  Stefan Monnier  <monnier@iro.umontreal.ca>

	Minor cleanup and simplification.
	* filecache.el (file-cache-add-directory)
	(file-cache-add-directory-recursively)
	(file-cache-add-from-file-cache-buffer)
	(file-cache-delete-file-regexp, file-cache-delete-directory)
	(file-cache-files-matching-internal, file-cache-display): Use dolist.
	(file-cache-temp-minibuffer-message): Delete function.
	(file-cache-minibuffer-complete): Use minibuffer-message instead.

	* progmodes/perl-mode.el (perl-font-lock-special-syntactic-constructs):
	Don't signal an error when bumping into EOB in tr, s, or y.

2009-11-29  Juri Linkov  <juri@jurta.org>

	* startup.el (fancy-about-text): Fix wording of Guided Tour.
	(Bug#4960)

	* descr-text.el (describe-char-unidata-list): Use lowercase name
	for "Unicode name" like in other tags.

2009-11-29  Juri Linkov  <juri@jurta.org>

	* ediff-util.el (ediff-minibuffer-with-setup-hook):
	New compatibility macro.
	(ediff-read-file-name): Use it instead of `minibuffer-with-setup-hook'.

2009-11-29  Juri Linkov  <juri@jurta.org>

	Add defcustom to define the cycling order of `recenter-top-bottom'.
	(Bug#4981)

	* window.el (recenter-last-op): Doc fix.
	(recenter-positions): New defcustom.
	(recenter-top-bottom): Rewrite to use `recenter-positions'.
	(move-to-window-line-top-bottom): Rewrite to use `recenter-positions'.

2009-11-29  Michael Albinus  <michael.albinus@gmx.de>

	Improve integration of Tramp and ange-ftp in eshell.

	* eshell/em-unix.el (eshell/whoami): Make it a defun but a defalias.
	(eshell/su): Flatten args.  Apply better args parsing.  Use "cd".
	(eshell/sudo): Flatten args.  Let-bind `default-directory'.

	* eshell/esh-util.el (top): Require also Tramp when compiling.
	(eshell-directory-files-and-attributes): Check for FTP remote
	connection.
	(eshell-parse-ange-ls): Let-bind `ange-ftp-name-format',
	`ange-ftp-ftp-name-arg', `ange-ftp-ftp-name-res'.
	(eshell-file-attributes): Handle ".".  Return `entry'.

	* net/ange-ftp.el (ange-ftp-parse-filename): Use `save-match-data'.
	(ange-ftp-directory-files-and-attributes)
	(ange-ftp-real-directory-files-and-attributes): New defuns.

	* net/tramp.el (tramp-maybe-open-connection): Open the remote
	shell with "exec" when possible.  This prevents trailing prompts
	in `start-file-process'.

2009-11-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	Try and remove assumptions about point-min==1.
	* nxml/rng-valid.el (rng-validate-mode): Don't hardcode point-min==1.
	(rng-compute-mode-line-string): Show the validation percentage in
	terms of the narrowed text, not the widened text.
	(rng-do-some-validation): Don't catch internal errors when debugging.
	(rng-first-error): Simplify.
	(rng-after-change-function): Remove work around.  AFAIK the bug has
	been fixed a while ago.

	* image-mode.el (image-minor-mode): Exit more gracefully when the image
	cannot be displayed (e.g. when doing C-x C-f some-new-file.svg RET).

	* man.el (Man-completion-table): Make it easier to enter "<sec> <name>".

	* eshell/em-prompt.el (eshell-prompt-function): Abbreviate pwd, since
	`cd' doesn't always do it for us (bug#5067).

	* pcomplete.el (pcomplete-entries): Revert change installed mistakenly
	on 2009-10-25 as part of some other change (bug#5067).

2009-11-27  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/bytecomp.el (byte-compile-warning-types): New type
	`suspicious'.
	(byte-compile-warnings): Use byte-compile-warning-types.
	(byte-compile-save-excursion): Warn about use of set-buffer right
	after save-excursion.

	* progmodes/gud.el (gud-basic-call): Don't only save the buffer but
	the excursion as well.

2009-11-27  Michael Albinus  <michael.albinus@gmx.de>

	* eshell/em-unix.el (eshell/su, eshell/sudo): New defuns,
	providing a Tramp related implementation of "su" and "sudo".
	(eshell-unix-initialize): Add "su" and "sudo".

2009-11-27  Daiki Ueno  <ueno@unixuser.org>

	* net/socks.el (socks-send-command): Convert binary request to
	unibyte before sending.  This fixes mishandling of some port
	numbers such as 129.

2009-11-27  Stefan Monnier  <monnier@iro.umontreal.ca>

	* help.el (describe-bindings-internal): Remove `interactive'.

	* man.el (Man-completion-table): Trim a terminating "(".
	Remove the space between name page a section.
	Add the command's description on the `help-echo' property.
	Remove `process-connection-type' binding since it's unused by
	call-process.
	Provide completion for the "<section> <name>" format as well.
	(Man-default-man-entry): Remove spurious var shadowing the argument.

2009-11-26  Kevin Ryde  <user42@zip.com.au>

	* log-view.el: Add "Keywords: tools", since its other keywords
	aren't in finder-known-keywords, and following vc.el.

	* sha1.el (sha1-string-external): default-directory "/" in case
	otherwise non-existent.  process-connection-type pipe for touch of
	efficiency recommended by elisp manual.  (An aside in Bug#3911.)

2009-11-26  Stefan Monnier  <monnier@iro.umontreal.ca>

	Misc coding convention cleanups.
	* htmlfontify.el (hfy-init-kludge-hook): Rename from
	hfy-init-kludge-hooks.
	(hfy-etags-cmd, hfy-flatten-style, hfy-invisible-name, hfy-face-at)
	(hfy-fontify-buffer, hfy-prepare-index-i, hfy-subtract-maps)
	(hfy-save-kill-buffers, htmlfontify-copy-and-link-dir): Use dolist
	and push.
	(hfy-slant, hfy-weight): Use tables rather than code.
	(hfy-box-to-border-assoc, hfy-box-to-style, hfy-decor)
	(hfy-face-to-style-i, hfy-fontify-buffer): Use `case'.
	(hfy-face-attr-for-class): Initialize `face-spec' directly.
	(hfy-face-to-css): Remove `nconc' with single arg.
	(hfy-p-to-face-lennart): Use `or'.
	(hfy-face-at): Hoist common code.  Remove spurious quotes in `case'.
	(hfy-overlay-props-at, hfy-mark-tag-hrefs): Eta-reduce.
	(hfy-compile-stylesheet, hfy-merge-adjacent-spans)
	(hfy-compile-face-map, hfy-parse-tags-buffer): Use push.
	(hfy-force-fontification): Use run-hooks.

2009-11-26  Vivek Dasmohapatra  <vivek@etla.org>

	Various minor fixes.
	* htmlfontify.el (hfy-default-header): Add toggle_invis since
	Javascript belongs in the header, not the body.
	(hfy-javascript): Remove.
	(hfy-fontify-buffer): Don't insert it any more.
	(hfy-face-at): Handle (face0 face1 face2) style face properties.
	Fix bug in invis handling when there were no invis props in a chunk.

2009-11-26  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-bzr.el (vc-bzr-annotate-command): Make operation asynchronous.

2009-11-26  Dan Nicolaescu  <dann@ics.uci.edu>

	* finder.el (finder-mode-map): Add a menu.

2009-11-26  Michael McNamara  <mac@mail.brushroad.com>

	* progmodes/verilog-mode.el (verilog-at-struct-p): Support "signed" and
	"unsigned" structs.

	(verilog-leap-to-head, verilog-backward-token): Handle "disable
	fork" statement better.

2009-11-26  Wilson Snyder  <wsnyder@wsnyder.org>

	* progmodes/verilog-mode.el (verilog-auto-insert-lisp)
	(verilog-delete-auto, verilog-delete-empty-auto-pair)
	(verilog-library-filenames): Fix AUTOINSERTLISP to support insert-file.
	Reported by Clay Douglass.

	(verilog-auto-inst, verilog-auto-star-safe)
	(verilog-delete-auto-star-implicit, verilog-read-sub-decls):
	Fix removing "// Interfaces" when saving .* expansions.  Reported by
	Pierre-David Pfister.

2009-11-26  Glenn Morris  <rgm@gnu.org>

	* eshell/em-dirs.el (eshell/cd): Don't throw to a tag outside
	the scope.

2009-11-25  Johan Bockgård  <bojohan@gnu.org>

	* vc-annotate.el (vc-annotate-revision-previous-to-line):
	Really use previous revision.

2009-11-25  Kevin Ryde  <user42@zip.com.au>

	* man.el (Man-completion-table): default-directory "/" in case
	doesn't otherwise exist.  process-environment COLUMNS=999 so as
	not to truncate long names.  process-connection-type pipe to avoid
	any chance of hitting the pseudo-tty TIOCGWINSZ.
	(man): completion-ignore-case t for friendliness and since man
	itself is case-insensitive on the command line.
	Further to Bug#3717.

	* arc-mode.el: Add "Keywords: files", so the details in its
	commentary can be reached from finder-by-keyword.
	* textmodes/dns-mode.el: Add "Keywords: comm".  It's only an
	editing mode, but it's comms related and sgml-mode.el has "comm"
	on that basis too.
	* textmodes/bibtex-style.el: Add "Keywords: tex".
	* international/isearch-x.el, international/ja-dic-cnv.el:
	* international/ja-dic-utl.el, international/kkc.el:
	Add "Keywords: i18n", so they can be reached from finder-by-keyword.

2009-11-25  Juri Linkov  <juri@jurta.org>

	* man.el (Man-completion-table): Modify regexp to include
	section names to completion strings.  (Bug#3717)

2009-11-25  Juri Linkov  <juri@jurta.org>

	Search recursively in gzipped files.  (Bug#4982)

	* progmodes/grep.el (grep-highlight-matches): Add new options
	`always' and `auto'.  Doc fix.
	(grep-process-setup): Check `grep-highlight-matches' for
	`auto-detect' to determine the need to compute grep defaults.
	Move Windows/DOS specific --colors settings handling
	to `grep-compute-defaults'.  Check `grep-highlight-matches'
	to get the value of "--color=".
	(grep-compute-defaults): Compute `grep-highlight-matches' when it
	has the value `auto-detect'.  Move Windows/DOS specific settings
	from `grep-process-setup'.
	(zrgrep): New command with alias `rzgrep'.

2009-11-25  Juri Linkov  <juri@jurta.org>

	* doc-view.el (doc-view-mode): Set buffer-local `view-read-only'
	to nil instead of switching off view-mode.  (Bug#4896)

2009-11-25  Juri Linkov  <juri@jurta.org>

	Mouse-wheel scrolling for DocView Continuous mode.  (Bug#4896)

	* mwheel.el (mwheel-scroll-up-function)
	(mwheel-scroll-down-function): New defvars.
	(mwheel-scroll): Funcall `mwheel-scroll-up-function' instead of
	`scroll-up', and `mwheel-scroll-down-function' instead of
	`scroll-down'.

	* doc-view.el (doc-view-scroll-up-or-next-page)
	(doc-view-scroll-down-or-previous-page): Add optional ARG.
	Use this ARG in the call to image-scroll-up/image-scroll-down.
	Change `interactive' spec to "P".  Goto next/previous page only
	when `doc-view-continuous-mode' is non-nil or ARG is nil (for the
	SPC/DEL case).  Doc fix.
	(doc-view-next-line-or-next-page)
	(doc-view-previous-line-or-previous-page): Rename arg to ARG
	for consistency.
	(doc-view-mode): Set buffer-local `mwheel-scroll-up-function' to
	`doc-view-scroll-up-or-next-page', and buffer-local
	`mwheel-scroll-down-function' to
	`doc-view-scroll-down-or-previous-page'.

2009-11-25  Juri Linkov  <juri@jurta.org>

	Provide additional default values (directories at other Dired
	windows) via M-n in the minibuffer of some Dired commands.

	* dired-aux.el (dired-diff, dired-compare-directories)
	(dired-do-create-files): Use `dired-dwim-target-defaults' to set
	`minibuffer-default' in `minibuffer-with-setup-hook'.
	(dired-dwim-target-directory): Find a window that displays Dired
	buffer instead of failing when the next window is not Dired.
	Use `get-window-with-predicate' to find for the next Dired window.
	(dired-dwim-target-defaults): New function.

	* ediff-util.el (ediff-read-file-name):
	Use `dired-dwim-target-defaults' to set `minibuffer-default'
	in `minibuffer-with-setup-hook'.

2009-11-25  Juri Linkov  <juri@jurta.org>

	Provide additional default values (file name at point or at the
	current Dired line) via M-n for file reading minibuffers.  (Bug#5010)

	* minibuffer.el (read-file-name-defaults): New function.
	(read-file-name): Reset `minibuffer-default' to nil when
	it duplicates initial input `insdef'.
	Bind `minibuffer-default-add-function' to lambda that
	calls `read-file-name-defaults' in `minibuffer-selected-window'.
	(minibuffer-insert-file-name-at-point): New command.

	* files.el (file-name-at-point-functions): New defcustom.
	(find-file-default): Remove defvar.
	(find-file-read-args): Don't use `find-file-default'.
	Move `minibuffer-with-setup-hook' that sets `minibuffer-default'
	to `read-file-name'.
	(find-file-literally): Use `read-file-name' with
	`confirm-nonexistent-file-or-buffer'.

	* ffap.el (ffap-guess-file-name-at-point): New autoloaded function.

	* dired.el (dired-read-dir-and-switches):
	Move `minibuffer-with-setup-hook' that sets `minibuffer-default'
	to `read-file-name'.
	(dired-file-name-at-point): New function.
	(dired-mode): Add hook `dired-file-name-at-point' to
	`file-name-at-point-functions'.

2009-11-25  Stefan Monnier  <monnier@iro.umontreal.ca>

	Really make the *Completions* window soft-dedicated (bug#5030).
	* window.el (window--display-buffer-2): Add `dedicated' argument.
	(display-buffer): Pass it when needed so the dedicated flag is set
	after calling set-window-buffer, which would otherwise reset it.

2009-11-25  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/meta-mode.el (meta-complete-symbol):
	* progmodes/etags.el (complete-tag):
	* mail/mailabbrev.el (mail-abbrev-complete-alias):
	Use completion-in-region.

	* dabbrev.el (dabbrev--minibuffer-origin): Use minibuffer-selected-window.
	(dabbrev-completion): Use completion-in-region.
	(dabbrev--abbrev-at-point): Simplify regexp.

	* abbrev.el (abbrev--before-point): Use word-motion functions
	if :regexp is not specified (bug#5031).

	* subr.el (string-prefix-p): New function.

	* man.el (Man-completion-cache): New var.
	(Man-completion-table): Use it.

	* vc.el (vc-print-log-internal): Make `limit' optional for better
	compatibility (e.g. with vc-annotate.el).

2009-11-24  Kevin Ryde  <user42@zip.com.au>

	* emacs-lisp/checkdoc.el (checkdoc-proper-noun-regexp):
	Build value with regexp-opt instead of explicit joining loop.  (Bug#4927)

	* emacs-lisp/elint.el (elint-add-required-env): Better error message
	when .el source file not found or other error.

2009-11-24  Markus Triska  <markus.triska@gmx.at>

	* linum.el (linum-update-window): Ignore intangible (bug#4996).

2009-11-24  Stefan Monnier  <monnier@iro.umontreal.ca>

	Handle the [back] button properly (bug#4979).
	* descr-text.el (describe-text-properties): Add a `buffer' argument.
	Use help-setup-xref, help-buffer, and with-help-window.
	(describe-char): Add `buffer' argument.
	Pass proper command to help-setup-xref.  Don't meddle with
	help-xref-stack-item directly.
	(describe-text-category): Use with-help-window and help-buffer.

	* emacs-lisp/shadow.el (list-load-path-shadows): Setup a major mode
	for the displayed buffer (bug#4887).

	* man.el (Man-completion-table): New function.
	(man): Use it.

2009-11-24  David Reitter  <david.reitter@gmail.com>

	* vc-git.el (vc-git-registered): Use checkout directory (where
	.git is) rather than the file's directory and a relative path spec
	to work around a bug in git.

2009-11-24  Michael Albinus  <michael.albinus@gmx.de>

	Improve handling of processes on remote hosts.

	* eshell/esh-util.el (eshell-path-env): New defvar.
	(eshell-parse-colon-path): New defun.
	(eshell-file-attributes): Use `eshell-parse-colon-path'.

	* eshell/esh-ext.el (eshell-search-path):
	Use `eshell-parse-colon-path'.
	(eshell-remote-command): Remove argument HANDLER.
	(eshell-external-command): Check for FTP remote connection.

	* eshell/esh-proc.el (eshell-gather-process-output):
	Use `file-truename', in order to start also symlinked files.
	Apply `start-file-process' instead of `start-process'.
	Shorten `command' to the local file name part.

	* eshell/em-cmpl.el (eshell-complete-commands-list):
	Use `eshell-parse-colon-path'.

	* eshell/em-unix.el (eshell/du): Check for FTP remote connection.

	* net/tramp.el (tramp-eshell-directory-change): New defun.  Add it
	to `eshell-directory-change-hook'.

2009-11-24  Tassilo Horn  <tassilo@member.fsf.org>

	* doc-view.el (doc-view-mode): Switch off view-mode explicitly,
	because it could be enabled automatically if view-read-only is non-nil.

2009-11-24  Michael Kifer  <kifer@cs.stonybrook.edu>

	* ediff-vers.el (ediff-rcs-get-output-buffer): Revert the change
	made on 2009-11-22.

2009-11-24  Glenn Morris  <rgm@gnu.org>

	* bookmark.el (bookmark-bmenu-hide-filenames): Remove assignment to
	deleted variable bookmark-bmenu-bookmark-column.

2009-11-24  Stefan Monnier  <monnier@iro.umontreal.ca>

	* bookmark.el (bookmark-bmenu-search): Clear echo area when exiting.

2009-11-23  Ken Brown  <kbrown@cornell.edu>  (tiny change)

	* net/browse-url.el (browse-url-filename-alist): On Windows, add
	two slashes to the "file:" prefix.
	(browse-url-file-url): De-munge Cygwin filenames before passing
	them to Windows browser.
	(browse-url-default-windows-browser): Use call-process.

2009-11-23  Juri Linkov  <juri@jurta.org>

	Implement DocView Continuous mode.  (Bug#4896)
	* doc-view.el (doc-view-continuous-mode): New defcustom.
	(doc-view-mode-map): Bind C-n/<down> to
	`doc-view-next-line-or-next-page', C-p/<up> to
	`doc-view-previous-line-or-previous-page'.
	(doc-view-next-line-or-next-page)
	(doc-view-previous-line-or-previous-page): New commands.

2009-11-23  Juri Linkov  <juri@jurta.org>

	Implement Isearch in comint input history.  (Bug#3746)
	* comint.el (comint-mode): Add `comint-history-isearch-setup' to
	`isearch-mode-hook'.
	(comint-history-isearch): New defcustom.
	(comint-history-isearch-backward)
	(comint-history-isearch-backward-regexp): New commands.
	(comint-history-isearch-message-overlay): New buffer-local variable.
	(comint-history-isearch-setup, comint-history-isearch-end)
	(comint-goto-input, comint-history-isearch-search)
	(comint-history-isearch-message, comint-history-isearch-wrap)
	(comint-history-isearch-push-state)
	(comint-history-isearch-pop-state): New functions.

2009-11-23  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-shell-prompt-pattern): Use \r for carriage
	return.
	(tramp-handle-make-symbolic-link)
	(tramp-handle-dired-compress-file, tramp-handle-expand-file-name):
	Quote file names.
	(tramp-send-command-and-check): New argument DONT-SUPPRESS-ERR.
	(tramp-handle-process-file): Use it.

2009-11-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* window.el (move-to-window-line-last-op): Remove.
	(move-to-window-line-top-bottom): Reuse recenter-last-op instead.

2009-11-23  Deniz Dogan  <deniz.a.m.dogan@gmail.com>  (tiny change)

	Make M-r mirror the new cycling behavior of C-l.
	* window.el (move-to-window-line-last-op): New var.
	(move-to-window-line-top-bottom): New command.
	(global-map): Bind M-r move-to-window-line-top-bottom.

2009-11-23  Sven Joachim  <svenjoac@gmx.de>

	* dired-x.el (dired-guess-shell-alist-default):
	Support xz format.  (Bug#4953)

2009-11-22  Michael Kifer  <kifer@cs.stonybrook.edu>

	* emulation/viper-cmd.el: Use viper-last-command-char instead of
	last-command-char/last-command-event.
	(viper-prefix-arg-value): Do correct conversion of event-char for
	XEmacs.

	* emulation/viper-util.el, emulation/viper.el:
	Use viper-last-command-char instead of
	last-command-char/last-command-event.

	* ediff-init.el, ediff-mult.el, ediff-util.el:
	Replace last-command-char and last-command-event
	with (ediff-last-command-char) everywhere.

	* ediff-vers.el (ediff-rcs-get-output-buffer): Make sure the buffer is
	created in fundamental mode.

	* ediff.el (ediff-version): Revert the change of interactive-p to
	called-interactively-p.

2009-11-22  Tassilo Horn  <tassilo@member.fsf.org>

	* progmodes/subword.el (subword-mode-map): Fix subword-mode-map
	generation from word-movement command names.

2009-11-21  Jan Djärv  <jan.h.d@swipnet.se>

	* cus-start.el (all): Add native condition for font-use-system-font.

2009-11-21  Nathaniel Flath  <flat0103@gmail.com>

	* progmodes/cc-menus.el (cc-imenu-java-generic-expression):
	Correct the patch from 2009-11-18.  (Bug#3910)

2009-11-21  Tassilo Horn  <tassilo@member.fsf.org>

	* progmodes/subword.el: Rename from lisp/subword.el.

	* subword.el: Rename to progmodes/subword.el.

	* Makefile.in (ELCFILES): Adapt to subword.el move.

2009-11-21  Thierry Volpiatto  <thierry.volpiatto@gmail.com>
            Stefan Monnier  <monnier@iro.umontreal.ca>

	* bookmark.el (bookmark-bmenu-bookmark-column): Remove var.
	(bookmark-bmenu-list): Save name on `bookmark-name-prop' text-prop.
	(bookmark-bmenu-show-filenames): Use push.
	(bookmark-bmenu-hide-filenames): Use local var instead of
	bookmark-bmenu-bookmark-column.  Use pop.  Don't save window-excursion.
	(bookmark-bmenu-bookmark): Use the new `bookmark-name-prop' text-prop.
	(bookmark-bmenu-execute-deletions): Don't bother adding/removing the
	filenames now that the bookmark names are always available.

2009-11-21  Stefan Monnier  <monnier@iro.umontreal.ca>

	* bookmark.el (bookmark-search-prompt, bookmark-search-timer): Remove.
	(bookmark-search-pattern): Move and leave unbound.
	(bookmark-bmenu-mode-map): Change binding.
	(bookmark-read-search-input): Simplify.
	Don't use text-char-description.  Don't error on non-char events.
	(bookmark-filtered-alist-by-regexp-only): Remove by folding into the
	only caller (i.e. bookmark-bmenu-filter-alist-by-regexp).
	(bookmark-bmenu-search): Don't check we're in a bookmark-list buffer.
	Use a local var for the timer.
	(bookmark-bmenu-cancel-search): Remove by folding into the only caller
	(i.e. bookmark-bmenu-search).

2009-11-21  Glenn Morris  <rgm@gnu.org>

	* mail/rmailmm.el (rmail-mime): Decode in fundamental-mode.  (Bug#4993)

2009-11-20  Ken Brown  <kbrown@cornell.edu>  (tiny change)

	* net/browse-url.el (browse-url-default-windows-browser):
	Use cygstart for cygwin.

2009-11-20  Karl Fogel  <karl.fogel@red-bean.com>

	* bookmark.el: Formatting and doc fixes only:
	(bookmark-search-delay): Shorten doc string to fit in 80 columns.
	(bookmark-bmenu-search): Wrap to fit within 80 columns.
	Minor grammar and punctuation fixes in doc string.
	(bookmark-read-search-input): Adjust to fit within 80 columns.

2009-11-20  Tassilo Horn  <tassilo@member.fsf.org>

	* progmodes/cc-cmds.el (c-forward-into-nomenclature)
	(c-backward-into-nomenclature): Adapt to subword renaming.

	* subword.el (subword-forward, subword-backward, subword-mark)
	(subword-kill, subword-backward-kill, subword-transpose)
	(subword-downcase, subword-upcase, subword-capitalize)
	(subword-forward-internal, subword-backward-internal):
	Rename from forward-subword, backward-subword, mark-subword,
	kill-subword, backward-kill-subword, transpose-subwords,
	downcase-subword, upcase-subword, capitalize-subword,
	forward-subword-internal, backward-subword-internal.

2009-11-20  Thierry Volpiatto  <thierry.volpiatto@gmail.com>

	* bookmark.el (bookmark-search-delay, bookmark-search-prompt):
	New options.
	(bookmark-search-pattern, bookmark-search-timer, bookmark-quit-flag):
	New vars.
	(bookmark-read-search-input, bookmark-filtered-alist-by-regexp-only)
	(bookmark-bmenu-filter-alist-by-regexp)
	(bookmark-bmenu-goto-bookmark, bookmark-bmenu-cancel-search): New funs.
	(bookmark-bmenu-search): New command.
	(bookmark-bmenu-mode-map): Bind it.

2009-11-20  Tassilo Horn  <tassilo@member.fsf.org>

	* progmodes/cc-cmds.el: declare-functioned forward-subword and
	backward-subword to quit the byte-compiler.

	* makefile.w32-in: Don't refer cc-subword.elc but subword.elc.

	* Makefile.in: Don't refer cc-subword.elc but subword.elc.

	* progmodes/cc-cmds.el (c-update-modeline)
	(c-forward-into-nomenclature, c-backward-into-nomenclature):
	Refer to subword.el functions instead of cc-subword.el.

	* progmodes/cc-mode.el (subword-mode, c-mode-base-map): Refer to
	subword.el functions instead of cc-subword.el.

	* progmodes/cc-subword.el: Rename to subword.el.
	* subword.el: Rename from progmodes/cc-subword.el.
	(subword-mode-map): Rename from c-subword-mode-map.
	(subword-mode): Rename from c-subword-mode.
	(global-subword-mode): New global minor mode.
	(forward-subword): Rename from c-forward-subword.
	(backward-subword): Rename from c-backward-subword.
	(mark-subword): Rename from c-mark-subword.
	(kill-subword): Rename from c-kill-subword.
	(backward-kill-subword): Rename from c-backward-kill-subword.
	(transpose-subwords): Rename from c-tranpose-subword.
	(downcase-subword): Rename from c-downcase-subword.
	(capitalize-subword): Rename from c-capitalize-subword.
	(forward-subword-internal): Rename from c-forward-subword-internal.
	(backward-subword-internal): Rename from c-backward-subword-internal.

2009-11-20  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc.el (vc-deduce-fileset): Allow non-state changing operations
	from a dired buffer.
	(vc-dired-deduce-fileset): New function.
	(vc-root-diff, vc-print-root-log): Use it.

	* vc-annotate.el (vc-annotate-show-log-revision-at-line): Pass a
	nil LIMIT argument to vc-print-log-internal.

2009-11-20  Glenn Morris  <rgm@gnu.org>

	* Makefile.in (ELCFILES): Regenerate.

2009-11-20  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc.el (calc-set-mode-line):
	Rename `calc-complement-signed-mode' to `calc-twos-complement-mode'.
	(math-format-number): Rename `math-format-complement-signed' to
	`math-format-twos-complement'.

	* calc/calc-bin.el (math-format-twos-complement): Rename from
	math-format-complement-signed.
	(calc-radix): Rename `calc-complement-signed-mode' to
	`calc-twos-complement-mode'.
	(calc-octal-radix, calc-hex-radix): Add an argument for
	two's complement.

	* calc/calc-embed.el (calc-embedded-mode-vars):
	Rename `calc-complement-signed-mode' to `calc-twos-complement-mode'.

	* calc/calc-ext.el (calc-init-extensions):
	Rename `calc-complement-signed-mode' to `calc-twos-complement-mode'.
	(math-format-number-fancy): Let `calc-twos-complement-mode' be nil.

	* calc/calc-units.el (math-build-units-table-buffer):
	Let `calc-twos-complement-mode' be nil.

	* calc/calc-menu.el (calc-modes-menu): Clean up two's complement
	entries.

	* calc/calc-vec.el (calcFunc-vunpack):
	* calc/calc-aent.el (calc-do-calc-eval):
	* calc/calc-forms.el (math-format-date):
	* calc/calc-graph.el (calc-graph-plot):
	* calc/calc-math.el (math-use-emacs-fn):
	* calc/calccomp.el (math-compose-expr):
	Let `calc-twos-complement-mode' be nil.

2009-11-19  Stefan Monnier  <monnier@iro.umontreal.ca>

	* abbrev.el (abbrev-with-wrapper-hook): (re)move...
	* simple.el (with-wrapper-hook): ...to here.  Add argument `args'.
	* minibuffer.el (completion-in-region-functions): New hook.
	(completion-in-region): New function.
	* emacs-lisp/lisp.el (lisp-complete-symbol):
	* pcomplete.el (pcomplete-std-complete): Use it.

2009-11-19  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/tex-mode.el (latex-complete-bibtex-cache)
	(latex-complete-alist): New vars.
	(latex-string-prefix-p, latex-complete-bibtex-keys)
	(latex-complete-envnames, latex-complete-refkeys)
	(latex-complete-data): New functions.
	(latex-complete, latex-indent-or-complete): New commands.

	* window.el (display-buffer-mark-dedicated): New var.
	(display-buffer): Obey it.
	* minibuffer.el (minibuffer-completion-help): Use it.

	* progmodes/sym-comp.el (symbol-complete): Use completion-in-region.

	* filecache.el (file-cache-add-file): Use push and cons.
	(file-cache-delete-file-regexp): Use push.
	(file-cache-complete): Use completion-in-region.

	* simple.el (with-wrapper-hook): Fix thinko.

	* hfy-cmap.el (hfy-rgb-file): Use locate-file.
	(htmlfontify-load-rgb-file): Remove unnused var `ff'.
	Use with-current-buffer and string-to-number.
	(hfy-fallback-colour-values): Use assoc-string.
	* htmlfontify.el (hfy-face-to-css): Remove unused var `style'.
	(hfy-face-at): Remove unused var `found-face'.
	(hfy-compile-stylesheet): Remove unused var `css'.
	(hfy-fontify-buffer): Remove unused vars `in-style', `invis-button',
	and `orig-buffer'.
	(hfy-buffer, hfy-copy-and-fontify-file, hfy-parse-tags-buffer):
	Use with-current-buffer.
	(hfy-text-p): Use expand-file-name and fewer setq.

2009-11-19  Vivek Dasmohapatra  <vivek@etla.org>

	* htmlfontify.el, hfy-cmap.el: New files.

2009-11-19  Juri Linkov  <juri@jurta.org>

	* minibuffer.el (completions-format): New defcustom.
	(completion--insert-strings): Implement vertical format.

	* simple.el (switch-to-completions): Move point to the first
	completion when point was at the beginning of the buffer.

2009-11-19  Juri Linkov  <juri@jurta.org>

	* find-dired.el (find-name-arg): Remove autoload.  (Bug#4387)

	* progmodes/grep.el (rgrep): Require `find-dired' for `find-name-arg'.

2009-11-19  Chong Yidong  <cyd@stupidchicken.com>

	* mail/sendmail.el (mail-yank-prefix): Change default to "> ".
	(mail-signature): Change default to t.
	(mail-from-style): Deprecate `system-default' value.
	(mail-insert-from-field): For default value of mail-from-style,
	default to `angles' unless `angles' needs quoting and `parens'
	does not.
	(mail-citation-prefix-regexp): Use citation regexp from
	message-mode.

2009-11-19  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-do-copy-or-rename-file-out-of-band):
	Set variables for computing the prompt for reading password.

2009-11-19  Glenn Morris  <rgm@gnu.org>

	* dired-aux.el (dired-compress-file-suffixes): Add ".xz".  (Bug#4953)

	* textmodes/flyspell.el (sgml-lexical-context): Declare.

	* net/newst-treeview.el (newsticker-treeview-treewindow-width)
	(newsticker-treeview-listwindow-height): Fix custom type.

2009-11-19  Kenichi Handa  <handa@m17n.org>

	* descr-text.el (describe-char-padded-string): Compose with TAB
	only if there's a font for CH.
	(describe-char): Fix the condition for detecting a trivial composition.

2009-11-18  Nathaniel Flath  <flat0103@gmail.com>

	* progmodes/cc-menus.el (cc-imenu-java-generic-expression): A new,
	more accurate version of the regexp.  (Bug#3910)

2009-11-18  Bernhard Herzog  <bernhard.herzog@intevation.de>  (tiny change)

	* vc-hg.el (vc-hg-diff): Fix last patch: do not change directory.

2009-11-18  Juanma Barranquero  <lekktu@gmail.com>

	* font-setting.el (font-use-system-font): Declare for byte-compiler.
	(font-setting-change-default-font): Fix typo in docstring.

2009-11-18  Alan Mackenzie  <acm@muc.de>

	* progmodes/cc-defs.el (c-version): Bump to 5.31.8.

2009-11-17  Jan Djärv  <jan.h.d@swipnet.se>

	* font-setting.el (font-use-system-font): Move ...

	* cus-start.el (all): ... to here.

2009-11-17  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-advice-file-expand-wildcards): Simplify.
	Don't set `ad-return-value' if `ad-do-it' doesn't.

	* net/tramp-gvfs.el (tramp-gvfs-handle-write-region): Set file
	modification time.

2009-11-17  Jan Djärv  <jan.h.d@swipnet.se>

	* menu-bar.el: Put "Use system font" in Option-menu.
	(menu-bar-options-save): Add font-use-system-font.

	* loadup.el: If feature system-font-setting or font-render-setting is
	there, load font-setting.

	* Makefile.in (ELCFILES): Add font-settings.el.
	* font-setting.el: New file.

2009-11-17  Glenn Morris  <rgm@gnu.org>

	* vc-svn.el (vc-svn-print-log): Fix typo in previous.

	* net/newst-treeview.el (newsticker--treeview-list-update-faces):
	Preserve point in the list buffer.  (Bug#4939)
	Use point-at-eol.
	(newsticker--treeview-list-update-highlight)
	(newsticker--treeview-tree-update-highlight): Use point-at-bol/eol.

2009-11-16  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-bin.el (math-symclip, calcFunc-symclip, calc-symclip):
	Remove.

	* calc/calc-ext.el (calc-init-extensions): Remove references to
	symclip.

	* calc/calc-menu.el (calc-arithmetic-menu): Remove `calc-symclip'.

	* calc/calc-map.el (calc-get-operator, calc-b-oper-keys):
	* calc/calc-help.el (calc-b-prefix-help): Remove references to
	`calc-symclip'.

2009-11-16  Kevin Ryde  <user42@zip.com.au>

	* textmodes/flyspell.el (sgml-mode-flyspell-verify):
	Use `sgml-lexical-context' instead of own parse for tag (Bug#4511).

	* emacs-lisp/lisp-mnt.el (lm-keywords): Allow multi-line keywords.
	(lm-keywords-list): Allow comma-only separator like "foo,bar".
	Ignore trailing spaces by omit-nulls to split-string (fixing
	regression from Emacs 21 due to the incompatible split-string
	change).  (Bug #4928.)

2009-11-16  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc.el (vc-log-show-limit): Default to 2000.
	(vc-print-log-internal): Insert buttons to request more entries
	when limiting the output.

	* vc-sccs.el (vc-sccs-print-log):
	* vc-rcs.el (vc-rcs-print-log):
	* vc-cvs.el (vc-cvs-print-log):
	* vc-git.el (vc-git-print-log): Return 'limit-unsupported when
	LIMIT is non-nil.

2009-11-16  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-gvfs.el (tramp-gvfs-dbus-event-error): Raise only an
	error when `tramp-gvfs-dbus-event-vector' is set.
	(tramp-gvfs-maybe-open-connection): Loop over `read-event'.

2009-11-16  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-rcs.el (vc-rcs-consult-headers): Add missing save-excursion.

2009-11-16  Michael Albinus  <michael.albinus@gmx.de>

	* net/dbus.el (dbus-unregister-service): New defun.
	(dbus-register-property): Register the handlers of
	"org.freedesktop.DBus.Properties" for SERVICE.
	(dbus-property-handler): Fix docstring.

2009-11-16  YAMAMOTO Mitsuharu  <mituharu@math.s.chiba-u.ac.jp>

	* emacs-lisp/bytecomp.el (byte-compile-output-file-form):
	Quote doc string reference in defvaralias as it is not in special form.
	(byte-compile-output-docform): Doc fix.

2009-11-16  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc.el (math-2-word-size, math-half-2-word-size)
	(calc-complement-signed-mode): New variables.
	(calc-set-mode-line): Add indicator for twos-complements.
	(math-format-number): Format twos-complement notation.

	* calc/calc-bin.el (calc-word-size): Reset the variables
	`math-2-word-size' and `math-half-2-word-size'.
	(math-format-complement-signed, math-symclip, calcFunc-symclip)
	(calc-symclip): New functions.

	* calc/calc-aent.el (math-read-token): Read complement signed numbers.

	* calc/calc-embed.el (calc-embedded-mode-vars):
	Add `calc-complement-signed-mode' to the list of modes.

	* calc/calc-map.el (calc-get-operator): Add `calc-symclip'.
	(calc-b-oper-keys): Add `calc-symclip' to list.

	* calc/calc-ext.el (math-read-number-fancy): Read complement
	signed numbers.
	(calc-init-extensions): Add binding for `calc-symclip'.
	Add autoload for `calcFunc-symclip' and `calc-symclip'.

	* calc/calc-menu.el (calc-arithmetic-menu): Add item for
	`calc-symclip'.
	(calc-modes-menu): Add item for twos complement mode.

	* calc/calc-help.el (calc-b-prefix-help): Add help for `calc-symclip'.

2009-11-15  Chong Yidong  <cyd@stupidchicken.com>

	* register.el (jump-to-register, insert-register): Handle Semantic
	tags.  From commented-out advice in semantic/senator.el.

2009-11-15  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc.el (vc-log-show-limit): New variable.
	(vc-print-log, vc-print-root-log): Add new argument LIMIT.  Set it
	when using a prefix argument.
	(vc-print-log-internal): Add new argument LIMIT.

	* vc-svn.el (vc-svn-print-log):
	* vc-mtn.el (vc-mtn-print-log):
	* vc-hg.el (vc-hg-print-log):
	* vc-bzr.el (vc-bzr-print-log): Add new optional argument LIMIT,
	pass it to the log command when set.  Make the BUFFER argument
	non-optional.

	* vc-sccs.el (vc-sccs-print-log):
	* vc-rcs.el (vc-rcs-print-log):
	* vc-git.el (vc-git-print-log):
	* vc-cvs.el (vc-cvs-print-log): Add new optional argument LIMIT,
	ignore it.  Make the BUFFER argument non-optional

	* bindings.el (mode-line-buffer-identification): Do not purecopy.

2009-11-15  Chong Yidong  <cyd@stupidchicken.com>

	* dired.el (dired-mode-map): Move encryption items to "Operate"
	menu (Bug#4703).

	* strokes.el (strokes-update-window-configuration): Make strokes
	buffer current before erasing (Bug#4906).

2009-11-15  Juri Linkov  <juri@jurta.org>

	* simple.el (set-mark-default-inactive): Add :type, :group
	and :version.  (Bug#4876)

2009-11-15  Michael Albinus  <michael.albinus@gmx.de>

	* arc-mode.el (archive-maybe-copy): Move creation of directory ...
	(archive-unique-fname): ... here.  (Bug#4929)

2009-11-15  Stefan Monnier  <monnier@iro.umontreal.ca>

	* help-mode.el (help-make-xrefs): Undo the last revert, and replace it
	with a real fix.

	* novice.el (disabled-command-function): Add useful args.
	Setup the help buffer so that [back] works.
	Remove redundant call to help-mode.
	(disabled-command-function): Use `case'.
	(en/disable-command): New function extracted from enable-command.
	(enable-command, disable-command): Use it.

2009-11-14  Glenn Morris  <rgm@gnu.org>

	* menu-bar.el (menu-bar-tools-menu): Read and send mail entries are not
	constants.  (Bug#4913)

	* emacs-lisp/elint.el (elint-standard-variables): Doc fix.

2009-11-14  Shigeru Fukaya  <shigeru.fukaya@gmail.com>

	* emacs-lisp/elint.el (elint-standard-variables): Add some variables
	defined in C that have no doc-strings.  (Bug#1063)

2009-11-14  Francis Wright  <F.J.Wright@qmul.ac.uk>

	* cus-edit.el (data, files):
	* ps-print.el (postscript): Doc fixes for custom groups.  (Bug#3327)

2009-11-14  Chong Yidong  <cyd@stupidchicken.com>

	* simple.el (shell-command): Doc fix (Bug#4891).

	* help-mode.el (help-make-xrefs): Revert 2009-11-13 change.

2009-11-14  Glenn Morris  <rgm@gnu.org>

	* emulation/viper.el (viper-set-hooks): Remove duplicate advice
	statements for vc-diff, emerge-quit, and rmail-cease-edit.
	If they are already loaded, eval-after-load will do the right thing.

	* speedbar.el (top-level): Remove unnecessary load of ange-ftp when
	compiling.

	* emacs-lisp/bytecomp.el (byte-compile-single-version): Remove, unused.

	* simple.el (x-selection-owner-p): Declare.
	(read-mail-command): Use custom radio type rather than choice.
	(completion-no-auto-exit): Doc fix.

	* custom.el (defgroup):
	* epg-config.el (epg): Doc fixes.

2009-11-14  Dan Nicolaescu  <dann@ics.uci.edu>

	* bindings.el (mode-line-buffer-identification): Purecopy only the string.
	* international/ccl.el (define-ccl-program): Do not purecopy the
	docstring, defconst does it anyway.

2009-11-13  Stefan Monnier  <monnier@iro.umontreal.ca>

	* add-log.el (add-change-log-entry): Avoid displaying the changelog
	a second time.

	* x-dnd.el (x-dnd-maybe-call-test-function):
	* window.el (split-window-vertically):
	* whitespace.el (whitespace-help-on):
	* vc-rcs.el (vc-rcs-consult-headers):
	* userlock.el (ask-user-about-lock-help)
	(ask-user-about-supersession-help):
	* type-break.el (type-break-force-mode-line-update):
	* time-stamp.el (time-stamp-conv-warn):
	* terminal.el (te-set-output-log, te-more-break, te-filter)
	(te-sentinel, terminal-emulator):
	* term.el (make-term, term-exec, term-sentinel, term-read-input-ring)
	(term-write-input-ring, term-check-source, term-start-output-log):
	(term-display-buffer-line, term-dynamic-list-completions):
	(term-ansi-make-term, serial-term):
	* subr.el (selective-display):
	* strokes.el (strokes-xpm-to-compressed-string, strokes-decode-buffer)
	(strokes-encode-buffer, strokes-xpm-for-compressed-string):
	* speedbar.el (speedbar-buffers-tail-notes, speedbar-buffers-item-info)
	(speedbar-reconfigure-keymaps, speedbar-add-localized-speedbar-support)
	(speedbar-remove-localized-speedbar-support)
	(speedbar-set-mode-line-format, speedbar-create-tag-hierarchy)
	(speedbar-update-special-contents, speedbar-buffer-buttons-engine)
	(speedbar-buffers-line-directory):
	* simple.el (shell-command-on-region, append-to-buffer)
	(prepend-to-buffer):
	* shadowfile.el (shadow-save-todo-file):
	* scroll-bar.el (scroll-bar-set-window-start, scroll-bar-drag-1)
	(scroll-bar-maybe-set-window-start):
	* sb-image.el (speedbar-image-dump):
	* saveplace.el (save-place-alist-to-file, save-places-to-alist)
	(load-save-place-alist-from-file):
	* ps-samp.el (ps-print-message-from-summary):
	* ps-print.el (ps-flush-output, ps-insert-file, ps-get-boundingbox)
	(ps-background-image, ps-begin-job, ps-do-despool):
	* ps-bdf.el (bdf-find-file, bdf-read-font-info):
	* printing.el (pr-interface, pr-ps-file-print, pr-find-buffer-visiting)
	(pr-ps-message-from-summary, pr-lpr-message-from-summary):
	(pr-call-process, pr-file-list, pr-interface-save):
	* novice.el (disabled-command-function)
	(enable-command, disable-command):
	* mouse.el (mouse-buffer-menu-alist):
	* mouse-copy.el (mouse-kill-preserving-secondary):
	* macros.el (kbd-macro-query):
	* ledit.el (ledit-go-to-lisp, ledit-go-to-liszt):
	* informat.el (batch-info-validate):
	* ido.el (ido-copy-current-word, ido-initiate-auto-merge):
	* hippie-exp.el (try-expand-dabbrev-visible):
	* help-mode.el (help-make-xrefs):
	* help-fns.el (describe-variable):
	* generic-x.el (bat-generic-mode-run-as-comint):
	* finder.el (finder-mouse-select):
	* find-dired.el (find-dired-sentinel):
	* filesets.el (filesets-file-close):
	* files.el (list-directory):
	* faces.el (list-faces-display, describe-face):
	* facemenu.el (list-colors-display):
	* ezimage.el (ezimage-image-association-dump, ezimage-image-dump):
	* epg.el (epg--process-filter, epg-cancel):
	* epa.el (epa--marked-keys, epa--select-keys, epa-display-info)
	(epa--read-signature-type):
	* emerge.el (emerge-copy-as-kill-A, emerge-copy-as-kill-B)
	(emerge-file-names):
	* ehelp.el (electric-helpify):
	* ediff.el (ediff-regions-wordwise, ediff-regions-linewise):
	* ediff-vers.el (rcs-ediff-view-revision):
	* ediff-util.el (ediff-setup):
	* ediff-mult.el (ediff-append-custom-diff):
	* ediff-diff.el (ediff-exec-process, ediff-process-sentinel)
	(ediff-wordify):
	* echistory.el (Electric-command-history-redo-expression):
	* dos-w32.el (find-file-not-found-set-buffer-file-coding-system):
	* disp-table.el (describe-display-table):
	* dired.el (dired-find-buffer-nocreate):
	* dired-aux.el (dired-rename-subdir, dired-dwim-target-directory):
	* dabbrev.el (dabbrev--same-major-mode-p):
	* chistory.el (list-command-history):
	* apropos.el (apropos-documentation):
	* allout.el (allout-obtain-passphrase):
	(allout-copy-exposed-to-buffer):
	(allout-verify-passphrase): Use with-current-buffer.

2009-11-13  Glenn Morris  <rgm@gnu.org>

	* Makefile.in (ELCFILES): Regenerate.

2009-11-13  Michael Albinus  <michael.albinus@gmx.de>

	* net/dbus.el (dbus-registered-objects-table): Rename from
	`dbus-registered-functions-table', because it contains also properties.
	(dbus-unregister-object): Unregister also properties.
	(dbus-get-property, dbus-set-property, dbus-get-all-properties):
	Use a timeout of 500 msec, in order to not block.
	(dbus-register-property, dbus-property-handler): New defuns.

2009-11-13  Stefan Monnier  <monnier@iro.umontreal.ca>

	* simple.el (minibuffer-default-add-completions): Drop deprecated
	4th arg.

2009-11-13  Tomas Abrahamsson  <tab@lysator.liu.se>

	* textmodes/artist.el (artist-mouse-choose-operation):
	Call `tmm-prompt' instead of `x-popup-menu' if we cannot popup
	menus.  Bug noticed by Eli Zaretskii <eliz@gnu.org>.
	(artist-compute-up-event-key): New function.
	(artist-mouse-choose-operation, artist-down-mouse-1): Call it.

2009-11-13  Kenichi Handa  <handa@m17n.org>

	* language/japan-util.el: Make sure that the value of jisx0208
	property is jisx0208 character.

2009-11-13  Dan Nicolaescu  <dann@ics.uci.edu>

	* international/mule.el (auto-coding-regexp-alist): Only purecopy
	car or each item, not the whole list.

2009-11-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuffer.el (minibuffer-completion-help):
	Use minibuffer-hide-completions.

2009-11-12  Per Starbäck  <per@starback.se>  (tiny change)

	* dired.el (dired-save-positions, dired-restore-positions): New funs.
	(dired-revert): Use them (bug#4880).

2009-11-12  Dan Nicolaescu  <dann@ics.uci.edu>

	* tooltip.el (tooltip-frame-parameters): Undo previous change.

2009-11-12  Juri Linkov  <juri@jurta.org>

	* ffap.el (ffap-alternate-file-other-window, ffap-literally):
	New functions.
	(find-file-literally-at-point): Alias of `ffap-literally'.

2009-11-12  Dan Nicolaescu  <dann@ics.uci.edu>

	* textmodes/ispell.el (ispell-skip-region-alist):
	* textmodes/css-mode.el (auto-mode-alist):
	* progmodes/compile.el (auto-mode-alist):
	* international/mule.el (ctext-non-standard-encodings-alist)
	(ctext-non-standard-encodings-regexp):
	* simple.el (shell-command-switch, text-read-only):
	* replace.el (occur-mode-map):
	* paths.el (rmail-file-name):
	* jka-cmpr-hook.el (jka-compr-build-file-regexp):
	* find-file.el (ff-special-constructs):
	* files.el (file-name-handler-alist):
	* composite.el: Purecopy strings.

	* emacs-lisp/cl-macs.el (define-compiler-macro): Purecopy the file name.

2009-11-11  Dan Nicolaescu  <dann@ics.uci.edu>

	* widget.el (define-widget): Purecopy the docstring.
	* international/mule-cmds.el (charset): Do not purecopy the
	docstring here, define-widget does it.

	* textmodes/texinfo.el (texinfo-open-quote, texinfo-close-quote):
	* textmodes/bibtex-style.el (auto-mode-alist):
	* progmodes/inf-lisp.el (inferior-lisp-prompt):
	* progmodes/compile.el (compile-command):
	* language/korea-util.el (default-korean-keyboard):
	* international/mule-conf.el (file-coding-system-alist):
	* emacs-lisp/eldoc.el (eldoc-minor-mode-string):
	* tooltip.el (tooltip-frame-parameters):
	* newcomment.el (comment-end, comment-padding):
	* dired.el (dired-trivial-filenames):
	* comint.el (comint-file-name-prefix): Purecopy initial values.

2009-11-11  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-advice-minibuffer-electric-separator)
	(tramp-advice-minibuffer-electric-tilde): Unload advices via
	`tramp-unload'.
	(tramp-advice-make-auto-save-file-name)
	(tramp-advice-file-expand-wildcards): Apply also `ad-activate'
	after removing the advice.

2009-11-11  Dan Nicolaescu  <dann@ics.uci.edu>

	* progmodes/grep.el (grep-regexp-alist):
	* international/mule-cmds.el (iso-2022-control-alist):
	* emacs-lisp/timer.el (timer-duration-words):
	* subr.el (version-separator, version-regexp-alist):
	* minibuffer.el (completion-styles-alist):
	* faces.el (face-attribute-name-alist, list-faces-sample-text):
	Change defvars to defconsts.

	* Makefile.in (ELCFILES): Add international/mule-conf.elc.
	* loadup.el ("international/mule-conf"): Load the byte compiled version.
	* international/mule-conf.el: Allow to be byte compiled.

	* international/mule.el (define-charset): Purecopy props.
	(load-with-code-conversion): Purecopy doc string and file name.
	(put-charset-property): Purecopy strings.
	(auto-coding-alist, auto-coding-regexp-alist): Purecopy initial value.

	* international/mule-cmds.el (register-input-method): Purecopy arguments.
	(define-char-code-property): Correctly purecopy the table.

	* international/ccl.el (define-ccl-program): Purecopy the docstring.

	* emacs-lisp/easy-mmode.el (define-minor-mode): Purecopy :lighter.

	* subr.el (add-hook): Purecopy strings.
	(eval-after-load): Purecopy load-history-regexp and the form.

	* custom.el (custom-declare-group): Purecopy load-file-name.

	* subr.el (menu-bar-separator): New defconst.
	* net/eudc.el (eudc-tools-menu):
	* international/mule-cmds.el (set-coding-system-map)
	(mule-menu-keymap):
	* emacs-lisp/lisp-mode.el (emacs-lisp-mode-map):
	* vc-hooks.el (vc-menu-map):
	* replace.el (occur-mode-map):
	* menu-bar.el (menu-bar-file-menu, menu-bar-search-menu)
	(menu-bar-edit-menu, menu-bar-goto-menu)
	(menu-bar-custom-menu, menu-bar-showhide-menu)
	(menu-bar-options-menu, menu-bar-tools-menu)
	(menu-bar-encryption-decryption-menu, menu-bar-describe-menu)
	(menu-bar-search-documentation-menu, menu-bar-manuals-menu)
	(menu-bar-help-menu):
	* ediff-hook.el (menu-bar-ediff-menu, menu-bar-ediff-merge-menu):
	* buff-menu.el (Buffer-menu-mode-map): Use menu-bar-separator.

	* term/x-win.el (x-gtk-stock-map):
	* progmodes/vera-mode.el (auto-mode-alist):
	* progmodes/inf-lisp.el (inferior-lisp-filter-regexp)
	(inferior-lisp-program, inferior-lisp-load-command):
	* progmodes/hideshow.el (hs-special-modes-alist):
	* progmodes/gud.el (same-window-regexps):
	* progmodes/grep.el (grep-program, find-program, xargs-program):
	* net/telnet.el (same-window-regexps):
	* net/rlogin.el (same-window-regexps):
	* language/ethiopic.el (font-ccl-encoder-alist):
	* vc-sccs.el (vc-sccs-master-templates):
	* vc-rcs.el (vc-rcs-master-templates):
	* subr.el (cl-assertion-failed):
	* simple.el (next-error-overlay-arrow-position):
	* lpr.el (lpr-command):
	* locate.el (locate-ls-subdir-switches):
	* info.el (same-window-regexps, info)
	(Info-goto-emacs-command-node, Info-goto-emacs-key-command-node):
	* image-mode.el (image-mode, auto-mode-alist):
	* hippie-exp.el (hippie-expand-ignore-buffers):
	* format.el (format-alist):
	* find-dired.el (find-ls-subdir-switches, find-grep-options)
	(find-name-arg):
	* facemenu.el (facemenu-keybindings):
	* dired.el (dired-listing-switches, dired-chown-program):
	* diff.el (diff-switches, diff-command):
	* cus-edit.el (same-window-regexps):
	* bindings.el (mode-line-mule-info)
	(mode-line-buffer-identification): Purecopy strings.

2009-11-11  Juri Linkov  <juri@jurta.org>

	* simple.el (dired-get-filename) <declare-function>:
	Tell the byte-compiler about dired-get-filename.
	(shell-command): In Dired mode, get filename from the current line
	as the default value.

2009-11-10  Glenn Morris  <rgm@gnu.org>

	* dired.el, hi-lock.el, calendar/cal-menu.el, calendar/calendar.el:
	* calendar/holidays.el, progmodes/cperl-mode.el:
	Update x-popup-menu declarations.

	* emacs-lisp/shadow.el (find-emacs-lisp-shadows)
	(list-load-path-shadows): Use dolist.
	(list-load-path-shadows): Use with-current-buffer.

2009-11-10  Juri Linkov  <juri@jurta.org>

	* minibuffer.el (read-file-name): Support a list of default values
	in `default-filename'.  Use the first file name where only one
	element is required.  Doc fix.

2009-11-09  Michael Albinus  <michael.albinus@gmx.de>

	* net/dbus.el (dbus-unregister-object): Release service, if no
	other method is registered for it.

2009-11-08  Markus Rost  <rost@math.uni-bielefeld.de>

	* bookmark.el (bookmark-completing-read): Sort bookmark names if
	bookmark-sort-flag is non-nil (Bug#4653).

2009-11-08  Chong Yidong  <cyd@stupidchicken.com>

	* emulation/cua-base.el: Add CUA property to some CC mode commands
	(Bug#4100).

2009-11-08  Kevin Ryde  <user42@zip.com.au>

	* emacs-lisp/checkdoc.el (checkdoc-proper-noun-regexp): Match noun
	at end of sentence (Bug#4818).

2009-11-08  Jared Finder  <jfinder@crypticstudios.com>

	* progmodes/compile.el (compilation-error-regexp-alist-alist):
	Handle "see declaration of" MSFT statements (Bug#4100).

2009-11-08  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-advice-make-auto-save-file-name)
	(tramp-advice-file-expand-wildcards): Unload via
	`ad-remove-advice'.

	* net/trampver.el: Update release number.

2009-11-08  Kevin Ryde  <user42@zip.com.au>

	* net/tramp.el (tramp-advice-file-expand-wildcards): Don't rely on
	`ad-do-it'.

2009-11-08  Andr  <m00naticus@gmail.com>  (tiny change)

	* net/tramp.el (tramp-handle-write-region): Copy but rename temp file,
	in order to keep context in SELinux.

2009-11-08  Chong Yidong  <cyd@stupidchicken.com>

	* dired-aux.el (dired-query): Place cursor in echo area and allow
	C-g.

	* dired.el (dired-mode-map): Disable dired-maybe-insert-subdir
	menu item if not on a directory (Bug#4701).

2009-11-07  Michael Albinus  <michael.albinus@gmx.de>

	Sync with Tramp 2.1.17.

	* net/tramp.el (tramp-handle-copy-directory): Don't use
	`file-remote-p' (due to compatibility).

	* net/tramp-compat.el (tramp-compat-copy-directory)
	(tramp-compat-delete-directory): New defuns.

	* net/tramp-fish.el (tramp-fish-handle-delete-directory):
	* net/tramp-gvfs.el (tramp-gvfs-handle-delete-directory): Use
	`tramp-compat-delete-directory'.

	* net/tramp-smb.el (tramp-smb-handle-copy-directory)
	(tramp-smb-handle-delete-directory): Use
	`tramp-compat-copy-directory' and `tramp-compat-delete-directory'.

	* net/trampver.el: Update release number.

2009-11-07  Chong Yidong  <cyd@stupidchicken.com>

	* tar-mode.el (tar-copy): Call write-region on the right buffer
	(Bug#4857).

	* mail/rmailsum.el (rmail-summary-rmail-update): Call linum-update
	by hand, if necessary (Bug#4878).

2009-11-06  Chong Yidong  <cyd@stupidchicken.com>

	* buff-menu.el (Buffer-menu-buffer+size): Use display property to
	align size column (Bug#4839).

	* emacs-lisp/autoload.el (autoload-rubric): Always issue a provide
	statement.

2009-11-05  Dan Nicolaescu  <dann@ics.uci.edu>

	* progmodes/ld-script.el (auto-mode-alist):
	* vc-hooks.el (vc-directory-exclusion-list): Purecopy strings.

	* cus-face.el (custom-declare-face): Purecopy face spec.

2009-11-06  Kenichi Handa  <handa@m17n.org>

	* international/uni-bidi.el: Re-generated.
	* international/uni-category.el: Re-generated.
	* international/uni-combining.el: Re-generated.
	* international/uni-mirrored.el: Re-generated.

2009-11-05  Dan Nicolaescu  <dann@ics.uci.edu>

	* textmodes/tex-mode.el (tex-alt-dvi-print-command)
	(tex-dvi-print-command, tex-bibtex-command, tex-start-commands)
	(tex-start-options, slitex-run-command, latex-run-command)
	(tex-run-command, tex-directory):
	* textmodes/ispell.el (ispell-html-skip-alists)
	(ispell-tex-skip-alists, ispell-tex-skip-alists):
	* textmodes/fill.el (adaptive-fill-first-line-regexp):
	(adaptive-fill-regexp):
	* textmodes/dns-mode.el (auto-mode-alist):
	* progmodes/python.el (interpreter-mode-alist):
	* progmodes/etags.el (tags-compression-info-list):
	* progmodes/etags.el (tags-file-name):
	* net/browse-url.el (browse-url-galeon-program)
	(browse-url-firefox-program):
	* mail/sendmail.el (mail-signature-file)
	(mail-citation-prefix-regexp):
	* international/mule-conf.el (eight-bit):
	* international/latexenc.el (latex-inputenc-coding-alist):
	* international/fontset.el (x-pixel-size-width-font-regexp):
	* emacs-lisp/warnings.el (warning-type-format):
	* emacs-lisp/trace.el (trace-buffer):
	* emacs-lisp/lisp-mode.el (lisp-interaction-mode-map)
	(emacs-lisp-mode-map):
	* calendar/holidays.el (holiday-solar-holidays)
	(holiday-bahai-holidays, holiday-islamic-holidays)
	(holiday-christian-holidays, holiday-hebrew-holidays)
	(hebrew-holidays-4, hebrew-holidays-3, hebrew-holidays-2)
	(hebrew-holidays-1, holiday-oriental-holidays)
	(holiday-general-holidays):
	* x-dnd.el (x-dnd-known-types):
	* tool-bar.el (tool-bar):
	* startup.el (site-run-file):
	* shell.el (shell-dumb-shell-regexp):
	* rfn-eshadow.el (file-name-shadow-tty-properties)
	(file-name-shadow-properties):
	* paths.el (remote-shell-program, news-directory):
	* mouse.el ([C-down-mouse-3]):
	* menu-bar.el (menu-bar-tools-menu):
	* jka-cmpr-hook.el (jka-compr-load-suffixes)
	(jka-compr-mode-alist-additions, jka-compr-compression-info-list)
	(jka-compr-compression-info-list):
	* isearch.el (search-whitespace-regexp):
	* image-file.el (image-file-name-extensions):
	* find-dired.el (find-ls-option):
	* files.el (directory-listing-before-filename-regexp)
	(directory-free-space-args, insert-directory-program)
	(list-directory-brief-switches, magic-fallback-mode-alist)
	(magic-fallback-mode-alist, auto-mode-interpreter-regexp)
	(automount-dir-prefix):
	* faces.el (face-x-resources, x-font-regexp, x-font-regexp-head)
	(x-font-regexp-slant, x-font-regexp-weight, face-x-resources)
	(face-font-registry-alternatives, face-font-registry-alternatives)
	(face-font-family-alternatives):
	* facemenu.el (facemenu-add-new-face, facemenu-background-menu)
	(facemenu-foreground-menu, facemenu-face-menu):
	* epa-hook.el (epa-file-name-regexp):
	* dnd.el (dnd-protocol-alist):
	* textmodes/rst.el (auto-mode-alist):
	* button.el (default-button): Purecopy strings.

2009-11-06  Glenn Morris  <rgm@gnu.org>

	* Makefile.in (ELCFILES): Update.

2009-11-05  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/lucid.el: Move to obsolete/lucid.el.
	* emacs-lisp/levents.el: Move to obsolete/levents.el.

	* nxml/xsd-regexp.el (xsdre-gen-categories):
	* nxml/xmltok.el (xmltok-parse-entity):
	* nxml/rng-parse.el (rng-parse-validate-file):
	* nxml/rng-maint.el (rng-format-manual)
	(rng-manual-output-force-new-line):
	* nxml/rng-loc.el (rng-save-schema-location-1):
	* nxml/rng-cmpct.el (rng-c-parse-file):
	* nxml/nxml-maint.el (nxml-insert-target-repertoire-glyph-set):
	* nxml/nxml-parse.el (nxml-parse-file): Use with-current-buffer.

2009-11-05  Wilson Snyder  <wsnyder@wsnyder.org>

	* progmodes/verilog-mode.el (verilog-getopt-file, verilog-set-define):
	Remove extra save-excursions and make-variable-buffer-local's.
	Suggested by Stefan Monnier.

	(verilog-getopt-file, verilog-module-inside-filename-p)
	(verilog-set-define): Merge GNU 1.35 and repair changes from
	switching to using with-current-buffer.

	(verilog-read-always-signals-recurse): Fix "a == 2'b00 ? b : c"
	being treated as a number and confusing AUTORESET.
	Reported by Dan Dever.

	(verilog-auto-ignore-concat, verilog-read-sub-decls-expr):
	Add verilog-auto-ignore-concat to fix backward compatibility with
	older verilog-modes.  Reported by Dan Katz.

	(verilog-read-auto-template): Fix AUTO_TEMPLATEs with regexps
	containing closing anchors "...$".

	(verilog-read-decls): Fix AUTOREG not detecting "assign {a,b}".
	Reported by Wade Smith.

	(verilog-batch-execute-func): Comment on function usage.

2009-11-05  Michael McNamara  <mac@mail.brushroad.com>

	* progmodes/verilog-mode.el (verilog-label-re): Fix regular expression
	for labels.

	(verilog-label-re, verilog-calc-1): Support proper indent of named
	asserts.

	(verilog-backward-token, verilog-basic-complete-re)
	(verilog-beg-of-statement, verilog-indent-re): Support proper
	indent of the assert statement at the beginning of a block of text.

	(verilog-beg-block-re, verilog-ovm-begin-re): Support the
	`ovm_object_param_utils_begin and `ovm_component_param_utils_begin
	tokens as begins.

2009-11-05  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/bytecomp.el (byte-compile-insert-header): Drop test for
	Emacs 19.  (Bug#1531)
	(byte-compile-fix-header): Update for the above change.
	Drop test for epoch::version.

	* emacs-lisp/autoload.el (autoload-rubric): Add optional feature arg.
	* cus-dep.el (custom-make-dependencies):
	* finder.el (finder-compile-keywords):
	Use autoload-rubric's feature argument.

	* calendar/diary-lib.el (top-level): Make load behave more like require.

	* vc-git.el (vc-git-stash-map): Move definition before use.

2009-11-04  Dan Nicolaescu  <dann@ics.uci.edu>

	* custom.el (custom-declare-group): Purecopy standard-value.
	(custom-declare-group): Purecopy custom-prefix.

	* international/mule.el (load-with-code-conversion):
	Call do-after-load-evaluation unconditionally.

	* emacs-lisp/bytecomp.el (byte-compile-output-file-form): Handle defvaralias.

2009-11-04  Stefan Monnier  <monnier@iro.umontreal.ca>

	* descr-text.el: Require help-mode rather than help-fns (bug#4861).

2009-11-04  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/bytecomp.el (byte-compile-version-cond): Remove macro.
	(byte-compile-compatibility): Remove option.
	(byte-compile-close-variables, byte-compile-fix-header)
	(byte-compile-insert-header, byte-compile-output-docform)
	(byte-compile-file-form-defmumble, byte-compile-byte-code-maker)
	(byte-compile-lambda, byte-compile-form, byte-defop-compiler19)
	(byte-compile-list, byte-compile-concat, byte-compile-function-form)
	(byte-compile-insert, byte-compile-defun):
	Remove support for byte-compile-compatibility and Emacs 18.  (Bug#4571)
	(byte-defop-compiler19): Remove.
	Without byte-compile-compatibility, the 'emacs19-opcode property is not
	used by anything.  Replace all calls with byte-defop-compiler.

2009-11-04  Juri Linkov  <juri@jurta.org>

	* menu-bar.el (menu-bar-make-mm-toggle): Quote each element of `props'.
	(menu-bar-options-menu): Don't quote the `prop' arg of
	`menu-bar-make-mm-toggle'.

2009-11-04  Juanma Barranquero  <lekktu@gmail.com>

	* calendar/calendar.el (cal-loaddefs):
	* calendar/diary-lib.el (diary-loaddefs):
	* calendar/holidays.el (hol-loaddefs):
	* eshell/esh-module.el (esh-groups): Load rather than require.

2009-11-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	* calendar/todo-mode.el (todo-add-category): Don't hardcode
	point-min==1.
	(todo-top-priorities): Only display-buffer when called interactively.
	(todo-item-start): Don't save excursion point.
	(todo-item-end): Be slightly more careful.  Add `include-sep' arg.
	(todo-insert-item-here, todo-file-item, todo-remove-item):
	Adjust uses of todo-item-start and todo-item-end.

	* emacs-lisp/autoload.el (generated-autoload-feature): Remove.
	(autoload-rubric): Don't use any more.

	* emacs-lisp/byte-run.el (define-obsolete-variable-alias): Use dolist,
	and only put a prop if it is non-nil.

2009-11-03  Juri Linkov  <juri@jurta.org>

	* menu-bar.el (menu-bar-make-mm-toggle, menu-bar-make-toggle)
	(menu-bar-options-menu): Fix list quoting (Bug#4429).

	* buff-menu.el (Buffer-menu-mode-map): Add hyphen between "Buffer"
	and "Menu" to make top-level menu item visually one unit (like
	it's done for "Lisp-Interaction", "Emacs-Lisp" and other
	multi-word menu items).  Fix :help string for quit-window.

2009-11-03  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/bytecomp.el (byte-compile-file-form-defvar)
	(byte-compile-file-form-define-abbrev-table)
	(byte-compile-file-form-custom-declare-variable)
	(byte-compile-variable-ref, byte-compile-defvar):
	Whether or not a warning is enabled should only affect whether we issue
	the warning, not whether or not we collect the relevant data.
	Eg warnings can be turned on and off throughout the course of a file.

	* eshell/esh-mode.el (ansi-color-apply-on-region): Autoload it...
	(eshell-handle-ansi-color): ... Rather than requiring ansi-color.

2009-11-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	* term/ns-win.el (ns-scroll-bar-move, ns-face-at-pos):
	* play/mpuz.el (mpuz-create-buffer):
	* play/landmark.el (lm-prompt-for-move, lm-print-wts, lm-print-smell)
	(lm-print-y,s,noise, lm-print-w0, lm-init):
	* play/gomoku.el (gomoku-prompt-for-move):
	* play/fortune.el (fortune-in-buffer):
	* play/dissociate.el (dissociated-press):
	* play/decipher.el (decipher-adjacency-list, decipher-display-regexp)
	(decipher-analyze-buffer, decipher-stats-buffer, decipher-stats-buffer):
	* mail/supercite.el (sc-eref-show):
	* mail/smtpmail.el (smtpmail-send-it):
	* mail/rmailsum.el (rmail-summary-next-labeled-message)
	(rmail-summary-previous-labeled-message, rmail-summary-wipe)
	(rmail-summary-undelete-many, rmail-summary-rmail-update)
	(rmail-summary-goto-msg, rmail-summary-expunge)
	(rmail-summary-get-new-mail, rmail-summary-search-backward)
	(rmail-summary-add-label, rmail-summary-output-menu)
	(rmail-summary-output-body):
	* mail/rfc822.el (rfc822-addresses):
	* mail/reporter.el (reporter-dump-variable, reporter-dump-state):
	* mail/mailpost.el (post-mail-send-it):
	* mail/hashcash.el (hashcash-generate-payment):
	* mail/feedmail.el (feedmail-run-the-queue)
	(feedmail-queue-send-edit-prompt-help-first)
	(feedmail-send-it-immediately, feedmail-give-it-to-buffer-eater)
	(feedmail-deduce-address-list):
	* eshell/esh-ext.el (eshell-remote-command):
	* eshell/em-unix.el (eshell-occur-mode-mouse-goto):
	* emulation/viper-util.el (viper-glob-unix-files, viper-save-setting)
	(viper-wildcard-to-regexp, viper-glob-mswindows-files)
	(viper-save-string-in-file, viper-valid-marker):
	* emulation/viper-keym.el (viper-toggle-key):
	* emulation/viper-ex.el (ex-expand-filsyms, viper-get-ex-file)
	(ex-edit, ex-global, ex-mark, ex-next-related-buffer, ex-quit)
	(ex-get-inline-cmd-args, ex-tag, ex-command, ex-compile):
	* emulation/viper-cmd.el (viper-exec-form-in-vi)
	(viper-exec-form-in-emacs, viper-brac-function):
	* emulation/viper.el (viper-delocalize-var):
	* emulation/vip.el (vip-mode, vip-get-ex-token, vip-ex, vip-get-ex-pat)
	(vip-get-ex-command, vip-get-ex-opt-gc, vip-get-ex-buffer)
	(vip-get-ex-count, vip-get-ex-file, ex-edit, ex-global, ex-mark)
	(ex-map, ex-unmap, ex-quit, ex-read, ex-tag, ex-command):
	* emulation/vi.el (vi-switch-mode, vi-ex-cmd):
	* emulation/edt.el (edt-electric-helpify):
	* emulation/cua-rect.el (cua--rectangle-aux-replace):
	* emulation/cua-gmrk.el (cua--insert-at-global-mark)
	(cua--delete-at-global-mark, cua--copy-rectangle-to-global-mark)
	(cua-indent-to-global-mark-column):
	* calendar/diary-lib.el (calendar-mark-1):
	* calendar/cal-hebrew.el (calendar-hebrew-mark-date-pattern):
	Use with-current-buffer.
	* emulation/viper.el (viper-delocalize-var): Use dolist.

2009-11-03  Chong Yidong  <cyd@stupidchicken.com>

	* comint.el (comint-replace-by-expanded-history-before-point):
	Replace !! with the previous input string literally (Bug#1795).

2009-11-02  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-forms.el (calc-date-notation): Allow a "blank string"
	to be made up of whitespace.

2009-11-02  Chong Yidong  <cyd@stupidchicken.com>

	* minibuffer.el (read-file-name): Don't use file dialogs for
	remote directories (Bug#99).

2009-11-01  Chong Yidong  <cyd@stupidchicken.com>

	* progmodes/sh-script.el (sh-font-lock-paren): Fix last change.

2009-11-01  Andreas Schwab  <schwab@linux-m68k.org>

	* view.el (view-mode-exit): If OLD-BUF is dead bury the buffer
	instead of deleting the window or frame.

2009-10-31  Chong Yidong  <cyd@stupidchicken.com>

	* textmodes/sgml-mode.el (sgml-mode-facemenu-add-face-function):
	Support face colors.

	* textmodes/tex-mode.el (tex-facemenu-add-face-function):
	New function.  Support face colors (Bug#1168).
	(tex-common-initialization): Use it.

	* facemenu.el (facemenu-enable-faces-p): Enable facemenu if the
	mode allows it (Bug#1168).

2009-10-31  Juri Linkov  <juri@jurta.org>

	* facemenu.el (list-colors-display): Don't mark buffer as
	modified (Bug#3948).

2009-10-31  Chong Yidong  <cyd@stupidchicken.com>

	* international/mule-diag.el (list-character-sets-1): Minor
	message fix (Bug#3526).

	* progmodes/etags.el (etags-list-tags, etags-tags-apropos): Fix
	face property (Bug#4834).
	(etags-list-tags, etags-tags-apropos-additional)
	(etags-tags-apropos, tags-select-tags-table): Add follow-link
	property.

	* menu-bar.el (menu-bar-tools-menu): Add Semantic and EDE menu
	items.

2009-10-31  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/two-column.el (2C-split):
	* textmodes/texnfo-upd.el (texinfo-multi-file-included-list):
	* textmodes/tex-mode.el (tex-set-buffer-directory):
	* textmodes/spell.el (spell-region, spell-string):
	* textmodes/reftex.el (reftex-erase-buffer):
	(reftex-get-file-buffer-force, reftex-kill-temporary-buffers):
	* textmodes/reftex-toc.el (reftex-toc-promote-action):
	* textmodes/reftex-sel.el (reftex-get-offset, reftex-insert-docstruct)
	(reftex-select-item):
	* textmodes/reftex-ref.el (reftex-label-info-update)
	(reftex-offer-label-menu):
	* textmodes/reftex-index.el (reftex-index-change-entry)
	(reftex-index-phrases-info):
	* textmodes/reftex-global.el (reftex-create-tags-file)
	(reftex-save-all-document-buffers, reftex-ensure-write-access):
	* textmodes/reftex-dcr.el (reftex-echo-ref, reftex-echo-cite)
	(reftex-view-crossref-from-bibtex):
	* textmodes/reftex-cite.el (reftex-bibtex-selection-callback)
	(reftex-extract-bib-entries-from-thebibliography)
	(reftex-all-used-citation-keys, reftex-create-bibtex-file):
	* textmodes/refbib.el (r2b-capitalize-title):
	(r2b-convert-buffer, r2b-help):
	* textmodes/page-ext.el (pages-directory)
	(pages-directory-goto-with-mouse):
	* textmodes/bibtex.el (bibtex-validate-globally):
	* textmodes/bib-mode.el (bib-capitalize-title):
	* textmodes/artist.el (artist-clear-buffer, artist-system):
	* progmodes/xscheme.el (global-set-scheme-interaction-buffer):
	(local-set-scheme-interaction-buffer, xscheme-process-filter)
	(verify-xscheme-buffer, xscheme-enter-interaction-mode)
	(xscheme-enter-debugger-mode, xscheme-debugger-mode-p)
	(xscheme-send-control-g-interrupt, xscheme-start-process)
	(xscheme-process-sentinel, xscheme-cd):
	* progmodes/verilog-mode.el (verilog-read-always-signals)
	(verilog-set-define, verilog-getopt-file)
	(verilog-module-inside-filename-p):
	* progmodes/sh-script.el:
	* progmodes/python.el (python-pdbtrack-get-source-buffer)
	(python-pdbtrack-grub-for-buffer, python-execute-file):
	* progmodes/octave-inf.el (inferior-octave):
	* progmodes/idlwave.el (idlwave-scan-user-lib-files)
	(idlwave-shell-compile-helper-routines, idlwave-set-local)
	(idlwave-display-completion-list-xemacs, idlwave-list-abbrevs)
	(idlwave-display-completion-list-emacs, idlwave-list-load-path-shadows)
	(idlwave-completion-fontify-classes, idlwave-display-calling-sequence):
	* progmodes/idlw-shell.el (idlwave-shell-examine-display-clear)
	(idlwave-shell-filter, idlwave-shell-examine-highlight)
	(idlwave-shell-sentinel, idlwave-shell-filter-directory)
	(idlwave-shell-display-line, idlwave-shell-set-bp-in-module)
	(idlwave-shell-examine-display, idlwave-shell-run-region)
	(idlwave-shell-filter-bp, idlwave-shell-save-and-action)
	(idlwave-shell-sources-filter, idlwave-shell-goto-next-error):
	* progmodes/idlw-help.el (idlwave-help-get-special-help)
	(idlwave-help-get-help-buffer):
	* progmodes/gud.el (gud-basic-call, gud-find-class)
	(gud-tooltip-activate-mouse-motions-if-enabled):
	* progmodes/gdb-mi.el (gdb-mouse-toggle-breakpoint-fringe):
	* progmodes/ebrowse.el (ebrowse-member-table, ebrowse-save-tree-as)
	(ebrowse-view-exit-fn, ebrowse-tags-list-members-in-file)
	(ebrowse-tags-next-file):
	* progmodes/ebnf2ps.el (ebnf-generate-eps, ebnf-generate-eps)
	(ebnf-eps-production-list, ebnf-begin-file, ebnf-log)
	(ebnf-eps-finish-and-write):
	* progmodes/cpp.el (cpp-edit-save):
	* progmodes/cperl-mode.el (cperl-pod-to-manpage):
	* progmodes/cc-defs.el (c-emacs-features):
	* progmodes/antlr-mode.el (antlr-invalidate-context-cache)
	(antlr-directory-dependencies):
	* progmodes/ada-xref.el (ada-gnat-parse-gpr, ada-get-ali-file-name)
	(ada-run-application, ada-find-in-src-path, ada-goto-parent)
	(ada-find-any-references, ada-make-filename-from-adaname)
	(ada-make-body-gnatstub):
	* obsolete/rnews.el (news-list-news-groups):
	* obsolete/resume.el (resume-suspend-hook, resume-write-buffer-to-file):
	* obsolete/iso-acc.el (iso-acc-minibuf-setup):
	* net/rcirc.el (rcirc-debug):
	* net/newst-treeview.el (newsticker--treeview-list-add-item)
	(newsticker--treeview-list-clear, newsticker-treeview-browse-url)
	(newsticker--treeview-list-update-faces, newsticker-treeview-save)
	(newsticker--treeview-item-show-text, newsticker--treeview-item-show)
	(newsticker--treeview-tree-update-tag, newsticker--treeview-buffer-init)
	(newsticker-treeview-show-item, newsticker--treeview-unfold-node)
	(newsticker--treeview-list-clear-highlight)
	(newsticker--treeview-list-update-highlight)
	(newsticker--treeview-list-highlight-start)
	(newsticker--treeview-tree-update-highlight)
	(newsticker--treeview-get-selected-item)
	(newsticker-treeview-mark-list-items-old)
	(newsticker--treeview-set-current-node):
	* net/newst-plainview.el (newsticker--buffer-set-uptodate):
	* net/newst-backend.el (newsticker--get-news-by-funcall)
	(newsticker--get-news-by-wget, newsticker--image-get)
	(newsticker--image-sentinel):
	* net/mairix.el (mairix-rmail-fetch-field, mairix-gnus-fetch-field):
	* net/eudcb-ph.el (eudc-ph-do-request, eudc-ph-open-session):
	(eudc-ph-close-session):
	* net/eudc.el (eudc-save-options):
	* language/thai-word.el (thai-update-word-table):
	* language/japan-util.el (japanese-string-conversion):
	* international/titdic-cnv.el (tsang-quick-converter)
	(ziranma-converter, ctlau-converter):
	* international/mule-cmds.el (describe-language-environment):
	* international/ja-dic-cnv.el (skkdic-convert-okuri-ari)
	(skkdic-convert-postfix, skkdic-convert-prefix):
	(skkdic-convert-okuri-nasi, skkdic-convert):
	* emacs-lisp/re-builder.el (reb-update-overlays):
	* emacs-lisp/pp.el (pp-to-string, pp-display-expression):
	* emacs-lisp/gulp.el (gulp-send-requests):
	* emacs-lisp/find-gc.el (trace-call-tree):
	* emacs-lisp/eieio-opt.el (eieio-browse, eieio-describe-class)
	(eieio-describe-generic):
	* emacs-lisp/eieio-base.el (eieio-persistent-read):
	* emacs-lisp/edebug.el (edebug-outside-excursion):
	* emacs-lisp/debug.el (debugger-make-xrefs):
	* emacs-lisp/cust-print.el (custom-prin1-to-string):
	* emacs-lisp/chart.el (chart-new-buffer):
	* emacs-lisp/authors.el (authors-scan-el, authors-scan-change-log):
	Use with-current-buffer.
	* textmodes/artist.el (artist-system): Don't call
	copy-sequence on a fresh string.
	* progmodes/idlw-shell.el (easymenu setup): Use dolist.

2009-10-31  Stephen Berman  <stephen.berman@gmx.net>

	* calendar/todo-mode.el (todo-edit-item): Signal an error if there
	is no item to edit.  (Bug#4820)
	(todo-top-priorities): Restore point and restore narrowing in Todo
	buffer.  (Bug#4820)

2009-10-31  Glenn Morris  <rgm@gnu.org>

	* net/ange-ftp.el (top-level): Don't require dired when compiling.
	(comint-last-output-start, comint-last-input-start)
	(comint-last-input-end): Don't defvar when compiling.
	(ange-ftp-process-file): Use bound-and-true-p.

	* pcmpl-rpm.el (top-level): Move provide statement to end.
	(pcmpl-rpm): Remove unused custom group.

	* pcmpl-gnu.el (tar-parse-info, tar-header-name): Declare for compiler.

	* mail/emacsbug.el (report-emacs-bug): Request `emacs -Q' recipes.

	* emacs-lisp/bytecomp.el (byte-compile-warning-types)
	(byte-compile-warnings): Add `constants' as an option.
	(byte-compile-callargs-warn, byte-compile-arglist-warn)
	(display-call-tree): Update for byte-compile-fdefinition possibly
	returning `(macro lambda ...)'.  (Bug#4778)
	(byte-compile-variable-ref, byte-compile-setq-default):
	Respect `constants' member of byte-compile-warnings.

2009-10-30  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-bzr.el (vc-bzr-revision-keywords): New var.
	(vc-bzr-revision-completion-table): Use it to fix completion of "s:"
	to "submit:".

2009-10-30  Dan Nicolaescu  <dann@ics.uci.edu>

	* textmodes/ispell.el (ispell-skip-region-alist):
	* international/mule-conf.el (eight-bit):
	* international/fontset.el (font-encoding-alist):
	* startup.el (pure-space-overflow-message):
	* simple.el (overwrite-mode-textual, overwrite-mode-binary):
	* paths.el (gnus-nntp-service, rmail-spool-directory)
	(term-file-prefix):
	* files.el (save-some-buffers-action-alist):
	* cmuscheme.el (same-window-buffer-names):
	* ielm.el (same-window-buffer-names):
	* shell.el (same-window-buffer-names):
	* mail/sendmail.el (same-window-buffer-names):
	* progmodes/inf-lisp.el (same-window-buffer-names):
	* bindings.el (mode-line-client)
	(mode-line-column-line-number-mode-map):
	* language/tibetan.el (tibetan-precomposition-rule-regexp)
	(tibetan-precomposed-regexp): Purecopy string arguments.

2009-10-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* calc/calc.el (calc, calc-refresh, calc-trail-buffer, calc-record)
	(calcDigit-nondigit):
	* calc/calc-yank.el (calc-copy-to-buffer):
	* calc/calc-units.el (calc-invalidate-units-table):
	* calc/calc-trail.el (calc-trail-yank):
	* calc/calc-store.el (calc-insert-variables):
	* calc/calc-rewr.el (math-rewrite, math-rewrite-phase):
	* calc/calc-prog.el (calc-read-parse-table):
	* calc/calc-keypd.el (calc-do-keypad, calc-keypad-right-click):
	* calc/calc-help.el (calc-describe-bindings, calc-describe-key):
	* calc/calc-graph.el (calc-graph-delete, calc-graph-add-curve)
	(calc-graph-juggle, calc-graph-count-curves, calc-graph-plot)
	(calc-graph-plot, calc-graph-format-data, calc-graph-set-styles)
	(calc-graph-name, calc-graph-find-command, calc-graph-view)
	(calc-graph-view, calc-gnuplot-command, calc-graph-init):
	* calc/calc-ext.el (calc-realign):
	* calc/calc-embed.el (calc-do-embedded, calc-do-embedded)
	(calc-embedded-finish-edit, calc-embedded-make-info)
	(calc-embedded-finish-command, calc-embedded-stack-change):
	* calc/calc-aent.el (calcAlg-enter): Use with-current-buffer.

	* pcomplete.el (pcomplete-comint-setup): If there's a choice, replace
	shell-dynamic-complete-filename in preference to
	comint-dynamic-complete-filename.

	* bookmark.el (bookmark-insert-location, bookmark-bmenu-list)
	(bookmark-bmenu-show-filenames, bookmark-bmenu-hide-filenames):
	Don't consider whether the display supports colors.
	(bookmark-import-new-list): Use dolist.
	(bookmark-bmenu-mode-map): Move initialization into declaration.
	(bookmark-bmenu-list): Use dolist, simplify.
	(bookmark-show-all-annotations): Use save-selected-window and dolist.
	(menu-bar-final-items): Use push.

2009-10-28  Bernhard Herzog  <bernhard.herzog@intevation.de>  (tiny change)

	* vc-hg.el (vc-hg-state, vc-hg-working-revision): Use process-file so
	it works on remote files.
	(vc-hg-diff): Don't pass any `--cwd' argument.

2009-10-27  Kevin Ryde  <user42@zip.com.au>

	* emacs-lisp/checkdoc.el (checkdoc-proper-noun-region-engine):
	Use help-xref-info-regexp and help-xref-url-regexp to identify links.
	(Further to Bug#3921).

2009-10-27  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-imap.el (top): Add `X-Size' to `imap-hash-headers'.
	(tramp-imap-do-copy-or-rename-file): Don't use the inode, when
	calling `tramp-imap-put-file'.  Add file size to the call.
	(tramp-imap-get-file-entries): Compute also user name, file size,
	and date.
	(tramp-imap-handle-insert-directory): Insert uid and gid.
	(tramp-imap-handle-file-attributes): Transform uid and gid
	according to `id-format'.
	(tramp-imap-put-file): New optional parameter SIZE.  Encode file
	size in header X-Size.

2009-10-26  Juanma Barranquero  <lekktu@gmail.com>

	* simple.el (transpose-subr): Give clearer error when the mark
	is not set.  (Bug#4807)

2009-10-26  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-perl-file-truename): New defconst.
	Perl code contributed by yary <not.com@gmail.com> (tiny change).
	(tramp-handle-file-truename, tramp-get-remote-perl): Use it.
	Check also for "perl-file-spec" and "perl-cwd-realpath" properties.
	(tramp-handle-write-region): In case of APPEND, reuse the tmpfile name.

	* net/tramp-imap.el (tramp-imap-file-name-handler-alist):
	Ignore `dired-call-process'.
	(tramp-imap-make-iht): Use `user' and `ssl' with `imap-hash-make'.

2009-10-26  Julian Scheid  <julians37@gmail.com>

	* net/tramp.el (tramp-perl-file-name-all-completions): New defconst.
	(tramp-get-remote-readlink): New defun.
	(tramp-handle-file-truename): Use it.
	(tramp-handle-file-exists-p): Check file-attributes cache, assume
	file exists if cache value present.
	(tramp-check-cached-permissions): New defun.
	(tramp-handle-file-readable-p): Use it.
	(tramp-handle-file-writable-p): Likewise.
	(tramp-handle-file-executable-p): Likewise.
	(tramp-handle-file-name-all-completions): Try using Perl to get
	partial completions.  When perl not available, combine `cd' and
	`ls' into single remote operation and use shell expansion to get
	partial remote directory contents.  Set `file-exists-p' cache for
	directory and any files returned by ls.  Change cache handling to
	support partial directory contents.  Use error message emitted by
	remote `cd' or Perl code for local tramp-error.
	(tramp-do-copy-or-rename-file-directly): Avoid separate
	tramp-send-command-and-check call.
	(tramp-handle-process-file): Merge three remote ops into one.
	Do not flush all caches when `process-file-side-effects' is set.
	(tramp-handle-write-region): Avoid tramp-set-file-uid-gid if
	file-attributes shows uid/gid to be set already.

2009-10-26  Dan Nicolaescu  <dann@ics.uci.edu>

	* textmodes/tex-mode.el (tex-dvi-view-command)
	(tex-show-queue-command, tex-open-quote):
	* progmodes/ruby-mode.el (auto-mode-alist)
	(interpreter-mode-alist): Purecopy strings.

	* emacs-lisp/lisp-mode.el (emacs-lisp-mode-map): Purecopy item names.

	* emacs-lisp/derived.el (define-derived-mode): Purecopy the doc
	string for the hook, keymap and abbrev table.

	* emacs-lisp/byte-run.el (make-obsolete): Purecopy the current name.

	* x-dnd.el (x-dnd-xdnd-to-action):
	* startup.el (fancy-startup-text, fancy-about-text): Change to
	defconst from defvar.

	* ps-print.el (ps-page-dimensions-database): Purecopy initial value.

	* mouse.el (mouse-buffer-menu-mode-groups, x-fixed-font-alist):
	Purecopy initialization strings.

	* mail/sendmail.el (mail-header-separator)
	(mail-personal-alias-file):
	* mail/rmail.el (rmail-default-dont-reply-to-names)
	(rmail-ignored-headers, rmail-retry-ignored-headers)
	(rmail-highlighted-headers, rmail-secondary-file-directory)
	(rmail-secondary-file-regexp):
	* files.el (null-device, file-name-invalid-regexp)
	(locate-dominating-stop-dir-regexp)
	(inhibit-first-line-modes-regexps): Purecopy initialization strings.
	(interpreter-mode-alist): Use mapcar instead of mapc.

	* buff-menu.el (Buffer-menu-mode-map): Purecopy name.

	* bindings.el (mode-line-major-mode-keymap): Purecopy name.
	(completion-ignored-extensions):
	(debug-ignored-errors): Purecopy strings.

2009-10-26  Stefan Monnier  <monnier@iro.umontreal.ca>

	* pcomplete.el (pcomplete-std-complete): Obey pcomplete-use-paring.
	(pcomplete, pcomplete-parse-buffer-arguments, pcomplete-opt)
	(pcomplete--here): Use push.

	* subr.el (all-completions): Declare the 4th arg obsolete.

2009-10-25  Stefan Monnier  <monnier@iro.umontreal.ca>

	* pcomplete.el (pcomplete-unquote-argument-function): New var.
	(pcomplete-unquote-argument): New function.
	(pcomplete--common-suffix): Always pay attention to case.
	(pcomplete--table-subvert): Quote and unquote the text.
	(pcomplete--common-quoted-suffix): New function.
	(pcomplete-std-complete): Use it and pcomplete-begin.

	* bookmark.el (bookmark-bmenu-list): Don't use switch-to-buffer if
	we're inside a dedicated or minibuffer window.

2009-10-24  Karl Fogel  <kfogel@red-bean.com>

	* bookmark.el: Update documentation, especially documentation
	of `bookmark-alist' and of the bookmark file format.
	Patch by Drew Adams, with minor tweaks from me.  (Bug#4195)

2009-10-24  Chong Yidong  <cyd@stupidchicken.com>

	* mail/emacsbug.el (report-emacs-bug): Clarify that the
	keybindings apply to the mail buffer (Bug#4003).  Shrink help
	window to buffer.

	* whitespace.el (whitespace-mode, whitespace-newline-mode)
	(global-whitespace-mode, global-whitespace-newline-mode)
	(whitespace-toggle-options, global-whitespace-toggle-options):
	Doc fix (Bug#3660).

	* nxml/nxml-mode.el (nxml-balanced-close-start-tag): Use the value
	of xmltok-start before the end tag was inserted (Bug#2840).

	* progmodes/sh-script.el (sh-font-lock-paren): Handle case
	patterns that are preceded by an open-paren (Bug#1320).

2009-10-24  Sven Joachim  <svenjoac@gmx.de>

	* files.el (delete-directory): Delete symlinks to directories with
	delete-file (Bug#4739).

2009-10-24  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc.el (vc-backend-for-registration): Rename from
	vc-get-backend-for-registration.  Update callers.

	* international/mule-cmds.el (set-language-info-alist):
	Purecopy lang-env.
	(leim-list-header, leim-list-entry-regexp): Change defvars to defconst.
	(charset): Purecopy the name.
	(define-char-code-property): Purecopy string arguments.

	* emacs-lisp/byte-run.el (make-obsolete, make-obsolete-variable):
	Purecopy string arguments.

	* emacs-lisp/lisp-mode.el (emacs-lisp-mode-map):
	* ediff-hook.el (menu-bar-ediff-menu):
	* buff-menu.el (Buffer-menu-mode-map): Purecopy names and tooltips.
	* bookmark.el (menu-bar-bookmark-map): Add :help and purecopy the name.

2009-10-24  Glenn Morris  <rgm@gnu.org>

	* comint.el (comint-dynamic-list-completions):
	* term.el (term-dynamic-list-completions): Use choose-completion rather
	than obsolete alias mouse-choose-completion.

	* filecache.el (file-cache-completions-keymap): Bind mouse-2 to
	file-cache-choose-completion.
	(file-cache-choose-completion): Handle an optional event argument.
	(file-cache-mouse-choose-completion): Make it an obsolete alias.

	* progmodes/octave-mod.el (octave-complete-symbol):
	Use choose-completion if mouse-choose-completion is ever removed.

	* textmodes/sgml-mode.el (sgml-looking-back-at): Move definition before
	use.

	* emacs-lisp/checkdoc.el (generate-autoload-cookie): Define for
	compiler.

	* vc-hooks.el (vc-responsible-backend): Fix declaration.

2009-10-24  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuffer.el (completion--embedded-envvar-table): Fix last change.
	Ignore `pred' now that we receive one.
	Handle test-completion specially.

2009-10-23  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc.el (vc-responsible-backend): Throw an error if not backend is
	found.  Remove the REGISTER argument.  Move the code dealing with
	REGISTER ...
	(vc-get-backend-for-registration): ... here.  New function.
	(vc-deduce-fileset): Call vc-get-backend-for-registration instead
	of vc-responsible-backend, pass the file name instead of the
	directory name.

2009-10-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* pcomplete.el (pcomplete-common-suffix, pcomplete-table-subvert):
	New funs.
	(pcomplete-std-complete): Use them.  Obey pcomplete-termination-string.
	(pcomplete-comint-setup): Don't modify a global var via
	accidental side-effects.
	(pcomplete-shell-setup): Adjust call accordingly.
	(pcomplete-parse-comint-arguments): Use push.

2009-10-23  Chong Yidong  <cyd@stupidchicken.com>

	* emacs-lisp/checkdoc.el (checkdoc-proper-noun-region-engine):
	Allow uncapitalized info node names (Bug#3921).

	* mail/emacsbug.el (report-emacs-bug): Tweak the sentence pointing
	to the DEBUG file (Bug#3781).

2009-10-23  Jari Aalto  <jari.aalto@cante.net>

	* textmodes/ispell.el (ispell-dictionary-base-alist): Add finnish
	dictionary entry (Bug#4579).

2009-10-23  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (top): Remove `tramp-rfn-eshadow-update-overlay'
	from `rfn-eshadow-update-overlay-hook' when unloading.
	(tramp-methods): Add `tramp-copy-keep-tmpfile' for "rsync" and
	"rsyncc".  Adjust doc string.
	(tramp-temp-buffer-file-name): New buffer-local defvar.
	(tramp-handle-insert-file-contents, tramp-handle-write-region):
	Keep temporary file when indicated by method ("rsync" and
	"rsyncc").
	(tramp-handle-write-region): Handle APPEND.
	(tramp-delete-temp-file-function): New defun.  Added to
	`kill-buffer-hook'.

2009-10-23  Juanma Barranquero  <lekktu@gmail.com>

	* menu-bar.el (cua-enable-cua-keys): Declare for the byte-compiler.

2009-10-23  Dan Nicolaescu  <dann@ics.uci.edu>

	* term/tty-colors.el (msdos-color-values): Remove declaration, unused.
	(color-name-rgb-alist, tty-standard-colors)
	(tty-color-mode-alist): Change to defconst.

	* simple.el (mark-inactive): Purecopy message.

	* menu-bar.el (menu-bar-make-mm-toggle, menu-bar-make-toggle): Fix macro.
	(global-map, yank-menu):
	* textmodes/ispell.el (ispell-menu-map):
	* net/eudc.el (eudc-tools-menu):
	* international/mule-cmds.el (describe-language-environment-map)
	(setup-language-environment-map, set-coding-system-map)
	(mule-menu-keymap):
	* vc-hooks.el (vc-menu-entry, vc-menu-map):
	* replace.el (occur-mode-map):
	* pcvs-defs.el (cvs-global-menu): Purecopy names and tooltips.

2009-10-23  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc.el (math-read-number, math-read-number-simple): Use
	`save-match-data'.

2009-10-22  Stefan Monnier  <monnier@iro.umontreal.ca>

	* simple.el (normal-erase-is-backspace-mode): Use input-decode-map
	rather than fiddling with global-map bindings, since it should only
	affect per-terminal settings.
	See http://bugs.gentoo.org/show_bug.cgi?id=289709.

	* minibuffer.el (completion-table-with-terminator): Allow to specify
	the terminator-regexp.

	* simple.el (switch-to-completions): Look for *Completions* in other
	frames as well.

	* pcomplete.el: Allow the use of completion-tables.
	(pcomplete-std-complete): New command.
	(pcomplete-dirs-or-entries): Use a single call to pcomplete-entries.
	(pcomplete--here): Use a function for `form' rather than an expression,
	so it can be byte-compiled.
	(pcomplete-here, pcomplete-here*): Adjust accordingly.
	Add edebug declaration.
	(pcomplete-show-completions): Remove unused var `curbuf'.
	(pcomplete-do-complete, pcomplete-stub):
	Don't assume `completions' is a list of strings any more.

2009-10-22  Juanma Barranquero  <lekktu@gmail.com>

	* find-dired.el (find-name-arg): Fix typo in docstring.

2009-10-22  Stefan Monnier  <monnier@iro.umontreal.ca>

	* pcmpl-linux.el (pcomplete/kill): Don't abuse pcomplete-entries.
	(pcmpl-linux-fs-types): Same, and update to new modules layout.

	* pcmpl-gnu.el (pcmpl-gnu-makefile-names): Use a single call to
	pcomplete-entries.

	* comint.el (comint-read-input-ring, comint-write-input-ring)
	(comint-substitute-in-file-name)
	(comint-dynamic-complete-as-filename)
	(comint-dynamic-simple-complete)
	(comint-dynamic-list-filename-completions)
	(comint-dynamic-list-completions)
	(comint-redirect-results-list-from-process): Minor simplifications.

2009-10-21  Kevin Ryde  <user42@zip.com.au>

	* emacs-lisp/checkdoc.el (checkdoc-file-comments-engine):
	When inserting ";;; Code" put it before any ";;;###autoload" cookie on
	the first form.  And insert a blank line after ";;; Code" since
	that's usual style.  (Bug#4612)

	* net/dns.el: Add "Keywords: comm", as per net/net-utils.el.

2009-10-21  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuffer.el (completion-table-with-terminator): Properly implement
	boundaries, in case `terminator' appears in the suffix.
	(completion--embedded-envvar-table): Don't return boundaries if
	there's no valid completion.  Simplify.
	(completion-file-name-table): New completion table extracted from
	completion--file-name-table.
	(completion--file-name-table): Use it.
	(read-file-name-predicate): Declare obsolete.
	(read-file-name): Use the pred arg i.s.o read-file-name-predicate.
	* vc-bzr.el (vc-bzr-revision-completion-table): Use the new
	completion-file-name-table, and use the `pred' argument.
	* files.el (locate-file-completion-table): Use the `pred' arg rather
	than read-file-name-predicate.
	(abbreviate-file-name): Use \` rather than ^ for BOS.

2009-10-21  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc.el (vc-deduce-fileset): Undo previous change, do not tell
	vc-responsible-backend to register, it causes problems.

2009-10-21  Stefan Monnier  <monnier@iro.umontreal.ca>

	* help-fns.el: Don't require help-mode (to avoid bootstrap issues).

2009-10-21  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-smb.el (tramp-smb-get-stat-capability): New defun.
	(tramp-smb-handle-file-attributes): Use it.
	(tramp-smb-do-file-attributes-with-stat): Don't raise an error.
	(tramp-smb-handle-insert-directory): Use `mapc' rather than
	`mapcar'.  Use `tramp-smb-get-stat-capability'.
	Add `dired-filename' text properties.
	(tramp-smb-get-cifs-capabilities): Apply `save-match-data'.
	(tramp-smb-maybe-open-connection): Simplify check for smbclient
	version.

2009-10-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* subr.el (read-key-delay): Reduce to 0.01.
	(read-key): Use read-key-sequence-vector to avoid turning M-t into 244
	(bug#4751).

2009-10-19  Stefan Monnier  <monnier@iro.umontreal.ca>

	* bindings.el (function-key-map): Map C-@ to C-SPC if C-@ is unbound.

	* info.el (Info-complete-menu-item): Handle `boundaries' explicitly.
	(Info-menu): Remove unused vars `last' and `completions'.
	(Info-index-nodes): Remove unused var `node'.

	* info.el (Info-complete-menu-item): Use complete-with-action.

2009-10-19  Dan Nicolaescu  <dann@ics.uci.edu>

	Make vc-annotate work through copies and renames.
	* vc-annotate.el (vc-annotate-extract-revision-at-line):
	Return the file name too.
	(vc-annotate-revision-at-line)
	(vc-annotate-find-revision-at-line)
	(vc-annotate-revision-previous-to-line)
	(vc-annotate-show-log-revision-at-line): Update to get the file
	name from vc-annotate-extract-revision-at-line.
	(vc-annotate-show-diff-revision-at-line-internal): Change the
	argument to mean whether to show a file diff or not.  Get the file
	name from vc-annotate-extract-revision-at-line.
	(vc-annotate-show-diff-revision-at-line):
	Update vc-annotate-show-diff-revision-at-line call.
	(vc-annotate-warp-revision): Add an optional file argument.

	* vc-git.el (vc-git-annotate-command): Pass -C -C to the blame command.
	(vc-git-annotate-extract-revision-at-line): Also return the file
	name if found.

	* vc-hg.el (vc-hg-annotate-command): Pass --follow to the annotate
	command.  Remove unused code.
	(vc-hg-annotate-re): Update to match --follow output.
	(vc-hg-annotate-extract-revision-at-line): Also return the file
	name if found.

	* vc.el: Update annotate-extract-revision-at-line documentation.

2009-10-18  Kevin Ryde  <user42@zip.com.au>

	* ibuffer.el (ibuffer-confirm-operation-on): Correction to error
	re-throw, `err' is a pair not a list so can't use apply (Bug#4740).

	* net/browse-url.el (browse-url): Identify alist with "consp and
	not functionp" and let all other things go down the `apply' leg,
	as suggested by Stefan.  (Further to bug#4531.)

2009-10-18  Chong Yidong  <cyd@stupidchicken.com>

	* minibuffer.el (read-file-name): Check for repeat before putting
	a default argument in file-name-history (Bug#4657).

	* emacs-lisp/lisp-mode.el (preceding-sexp): Recognize hash table
	read syntax (Bug#4737).

	* textmodes/sgml-mode.el (sgml-delete-tag): Use sgml-looking-back-at.

2009-10-18  Aaron S. Hawley  <aaron.s.hawley@gmail.com>

	* textmodes/sgml-mode.el (sgml-tag-help): Prompt user for tag.
	(html-tag-alist, html-tag-help): Add descriptions for undocumented
	entries and make note of obsolete tags.

2009-10-18  Stefan Monnier  <monnier@iro.umontreal.ca>

	* net/ange-ftp.el (ange-ftp-file-size): Use unwind-protect.

2009-10-18  Glenn Morris  <rgm@gnu.org>

	* Makefile.in (compile-last): Ensure GREP_OPTIONS is null before calling
	grep, so that binary files (eg international/uni-bidi.el) can match.
	Remove test for "UnicodeData" files, since it is hopefully unnecessary
	now, and in any case the file header format has changed.

2009-10-17  Glenn Morris  <rgm@gnu.org>

	* textmodes/flyspell.el (flyspell-large-region, flyspell-word)
	(flyspell-get-word, flyspell-large-region)
	(flyspell-auto-correct-previous-word): Doc/error message fixes.

2009-10-17  Chong Yidong  <cyd@stupidchicken.com>

	* Makefile.in (ELCFILES): Add ede/shell.

2009-10-17  Dan Nicolaescu  <dann@ics.uci.edu>

	* term/common-win.el (x-colors): Purecopy it.

2009-10-17  Stefan Monnier  <monnier@iro.umontreal.ca>

	* tar-mode.el (tar-data-swapped-p): Make the assertion a bit more
	permissive for when the buffer is empty.
	(tar-header-block-tokenize): Decode the username and groupname.
	(tar-chown-entry, tar-chgrp-entry): Encode the names (bug#4730).

2009-10-17  Eric Ludlam  <zappo@gnu.org>

	* emacs-lisp/eieio-base.el (eieio-persistent-save): If buffer
	contains multibyte characters, choose first applicable coding
	system automatically.

2009-10-17  Stefan Monnier  <monnier@iro.umontreal.ca>

	* international/mule-cmds.el (select-safe-coding-system): If the file
	has a coding cookie, use it regardless of any other setting (bug#4712).

2009-10-17  Glenn Morris  <rgm@gnu.org>

	* foldout.el (foldout-mouse-swallow-events):
	* gs.el (gs-load-image): Replace obsolete forms of sit-for, sleep-for.

	* dired.el (dired-ls-F-marks-symlinks, dired-keep-marker-rename)
	(dired-keep-marker-copy, dired-keep-marker-hardlink)
	(dired-keep-marker-symlink, dired-dwim-target)
	(dired-copy-preserve-time): Do not autoload these defcustoms.

	* mail/rmail.el (rmail-write-region-annotate): Prevent viewing different
	messages from messing up the file coding.  (Bug#4623)

2009-10-17  Jari Aalto  <jari.aalto@cante.net>

	* textmodes/ispell.el (ispell-get-decoded-string): Give an error
	if no match is found for the current dictionary.  (Bug#4578)

	* textmodes/flyspell.el (flyspell-get-word): Make `following' argument
	optional, since that is how it is documented, and this is often called
	with a nil argument.  (Bug#4577)
	(flyspell-external-point-words, flyspell-auto-correct-word)
	(flyspell-correct-word-before-point, flyspell-word-search-forward)
	(flyspell-word-search-backward): Remove nil argument in calls to
	flyspell-get-word, since it is not needed now.

2009-10-17  Ulrich Mueller  <ulm@gentoo.org>

	* play/doctor.el (doctor-adverbp): Exclude some nouns.  (Bug#4565)

2009-10-16  Glenn Morris  <rgm@gnu.org>

	* net/rcirc.el (rcirc-authenticate): Simplify previous change.

2009-10-16  Toru TSUNEYOSHI  <t_tuneyosi@hotmail.com>

	* net/ange-ftp.el (ange-ftp-send-cmd): Handle `size' like `mdtm'.
	(ange-ftp-file-size): New function.
	(ange-ftp-file-attributes): Use it.

2009-10-16  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-smb.el (tramp-smb-version): New defvar.
	(tramp-smb-maybe-open-connection): Use it, in order to avoid
	repeated checks.

2009-10-16  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/byte-run.el (define-obsolete-variable-alias): Doc fix.
	Maybe copy some custom properties from old to new name.  (Bug#4706)

2009-10-16  Juanma Barranquero  <lekktu@gmail.com>

	* subr.el (error, sit-for, start-process-shell-command)
	(start-file-process-shell-command): Set the calling convention
	after the function definition.

2009-10-16  Stefan Monnier  <monnier@iro.umontreal.ca>

	* subr.el (error, sit-for, start-process-shell-command)
	(start-file-process-shell-command): Use the new
	set-advertised-calling-convention feature.

2009-10-16  Taichi Kawabata  <kawabata.taichi@gmail.com>

	* international/ucs-normalize.el (ucs-normalize-version):
	Change to 1.2.
	(check-range): Adjust for Unicode 5.2.

2009-10-15  Juri Linkov  <juri@jurta.org>

	* menu-bar.el (menu-bar-file-menu): Convert `separator-exit'
	to the `menu-item' format.

2009-10-15  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-replace-environment-variables): Do not fail
	if the environment variable does not exist.

	* net/tramp-smb.el (tramp-smb-errors): Add error messages.
	(tramp-smb-get-share, tramp-smb-get-localname): Use only VEC as
	parameter.
	(tramp-smb-handle-add-name-to-file)
	(tramp-smb-handle-copy-directory, tramp-smb-handle-copy-file)
	(tramp-smb-handle-delete-directory, tramp-smb-handle-delete-file)
	(tramp-smb-handle-file-attributes)
	(tramp-smb-do-file-attributes-with-stat)
	(tramp-smb-handle-file-local-copy)
	(tramp-smb-handle-insert-directory)
	(tramp-smb-handle-make-directory)
	(tramp-smb-handle-make-directory-internal)
	(tramp-smb-handle-make-symbolic-link)
	(tramp-smb-handle-rename-file, tramp-smb-handle-set-file-modes)
	(tramp-smb-handle-write-region, tramp-smb-get-file-entries)
	(tramp-smb-maybe-open-connection): Apply the changed parameters.
	(tramp-smb-read-file-entry): Read Disk names in compressed format.
	Handle long file names.
	(tramp-smb-get-cifs-capabilities): Check, whether the connection
	process is running.
	(tramp-smb-maybe-open-connection): Trace "smbclient -V" command.
	Read share names with "-g" option.

2009-10-15  Ryan Yeske  <rcyeske@gmail.com>

	* net/rcirc.el (rcirc-view-log-file): New command.
	(rcirc-track-minor-mode-map): Remove C-c ` binding.
	(rcirc-authenticate, rcirc-authinfo): Allow nickserv-nick to be
	specified.

2009-10-15  Glenn Morris  <rgm@gnu.org>

	* w32-fns.el (w32-batch-update-autoloads): Take autoload-make-program
	from the second command-line argument.
	* makefile.w32-in (autoloads, $(lisp)/calendar/cal-loaddefs.el)
	($(lisp)/calendar/diary-loaddefs.el, $(lisp)/calendar/hol-loaddefs.el)
	($(lisp)/mh-e/mh-loaddefs.el): Pass $(MAKE) as second argument to
	w32-batch-update-autoloads.
	* emacs-lisp/autoload.el (autoload-make-program): New variable.
	(batch-update-autoloads): Handle autoload-excludes on windows-nt.

	* mail/rmailedit.el (rmail-cease-edit): Give an error if the end of
	the headers cannot be located.  Simplify, subtracting superflous
	save-excursions.

2009-10-15  Stefan Monnier  <monnier@iro.umontreal.ca>

	Replace completion-base-size by completion-base-position to fix bugs
	such as (bug#4699).
	* simple.el (completion-base-position): New var.
	(completion-base-size): Mark as obsolete.
	(choose-completion): Make it work for mouse events as well.
	Pass the new base-position to choose-completion-string.
	(choose-completion-guess-base-position): New function, extracted from
	choose-completion-delete-max-match.
	(choose-completion-delete-max-match): Use it.  Make obsolete.
	(choose-completion-string): Use the new base-position info.
	(completion-root-regexp): Delete.
	(completion-setup-function): Preserve completion-base-position.
	Eliminate obsolete base-size manipulation.
	* minibuffer.el (display-completion-list): Don't mess with base-size.
	(minibuffer-completion-help): Set completion-base-position instead.
	* mouse.el (mouse-choose-completion): Redefine as a mere alias to
	choose-completion.
	* textmodes/bibtex.el (bibtex-complete):
	* emacs-lisp/crm.el (crm--choose-completion-string):
	Adjust to new calling convention.
	* complete.el (partial-completion-mode): Use minibufferp to avoid
	bumping into incompatible change to choose-completion-string-functions.
	* ido.el (ido-choose-completion-string): Make its calling convention
	more permissive.
	* comint.el (comint-dynamic-list-input-ring-select): Remove obsolete
	base-size manipulation.
	(comint-dynamic-list-input-ring): Use dotimes and push.
	* iswitchb.el (iswitchb-completion-help): Remove dead-code call to
	fundamental-mode.  Use `or'.

2009-10-14  Juri Linkov  <juri@jurta.org>

	* misearch.el (multi-isearch-next-buffer-from-list)
	(multi-isearch-next-file-buffer-from-list): Doc fix.  (Bug#4723)

2009-10-14  Stefan Monnier  <monnier@iro.umontreal.ca>

	* Makefile.in (compile-onefile): Load `bytecomp' rather than
	`bytecomp.el'.

	* minibuffer.el (completion-pcm--merge-completions): Make sure the
	string we return is all made up of text from the completions rather
	than part from the completions and part from the input (bug#4219).

	* ido.el (ido-everywhere): Use define-minor-mode.

	* buff-menu.el (list-buffers, ctl-x-map):
	Mark the entry points with ;;;###autoload cookies.

2009-10-14  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-git.el (vc-git-dir-extra-headers): Set the branch name
	correctly in the detached head case.
	(vc-git-print-log): Remove unused binding.

	* vc.el (vc-responsible-backend): When a directory is passed for
	for registration create a VC repository if no backend is
	responsible for the directory argument.
	(vc-deduce-fileset): Tell vc-responsible-backend to register.

	* vc.el: Move comments about RCS and SCCS ...
	* vc-rcs.el:
	* vc-sccs.el: ... here, respectively.

2009-10-14  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuffer.el (completion--file-name-table): Return nil if there's
	no file completion, even if substitute-in-file-name changed
	the string (bug#4708).

2009-10-13  Juri Linkov  <juri@jurta.org>

	* files-x.el (read-file-local-variable-value): Don't filter out
	minor modes from mode name completion (bug#4664).

2009-10-13  Juanma Barranquero  <lekktu@gmail.com>

	* international/mule-cmds.el (ucs-names): Remove exclusion of
	"Enclosed Ideographic Supplement" range (U+1F200..U+1F2FF).

2009-10-13  Kenichi Handa  <handa@m17n.org>

	* international/uni-name.el: Regenerated.

2009-10-13  Juanma Barranquero  <lekktu@gmail.com>

	* bs.el (bs-mode): Fix last change.  (`revert-buffer-function'
	should be automatically buffer-local, but isn't.)

2009-10-12  Sam Steingold  <sds@gnu.org>

	* progmodes/compile.el (compilation-next-error-function): Fix the
	timestamps if the buffer has been visited before.
	(compilation-mode-font-lock-keywords): Do not prepend "^ *" to
	non-anchored patterns, like the perl one (bug#3928).

2009-10-12  Glenn Morris  <rgm@gnu.org>

	* net/tramp-smb.el (tramp-smb-do-file-attributes-with-stat):
	Let-bind `size'.

2009-10-12  Juanma Barranquero  <lekktu@gmail.com>

	* proced.el (proced-unload-function): New function.

	* bs.el (bs-mode): Set `revert-buffer-function' to `bs-refresh'.
	(bs-refresh): Add IGNORED arg for `revert-buffer' compatibility.
	Doc fix.

	* menu-bar.el (menu-bar-file-menu): Fix format of `separator-exit' item.

2009-10-11  Juri Linkov  <juri@jurta.org>

	* files-x.el (read-file-local-variable-value):
	Provide default value only for bound variables (bug#4664).

2009-10-11  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-local-host-p): Function shall return nil for
	connection methods like smb.

	* net/tramp-cache.el (tramp-flush-connection-property): The hash
	can be empty.

	* net/tramp-smb.el (tramp-smb-errors): Add error messages.
	(tramp-smb-file-name-handler-alist): Add handlers for
	`add-name-to-file', `make-symbolic-link'.
	(tramp-smb-handle-add-name-to-file)
	(tramp-smb-do-file-attributes-with-stat)
	(tramp-smb-handle-make-symbolic-link)
	(tramp-smb-get-cifs-capabilities): New defuns.
	(tramp-smb-handle-copy-directory, tramp-smb-handle-copy-file)
	(tramp-smb-handle-delete-directory, tramp-smb-handle-delete-file)
	(tramp-smb-handle-file-local-copy)
	(tramp-smb-handle-make-directory-internal)
	(tramp-smb-handle-rename-file, tramp-smb-handle-write-region):
	The file name syntax depends on cifs capabilities.
	(tramp-smb-handle-file-attributes):
	Call `tramp-smb-do-file-attributes-with-stat' if possible.
	(tramp-smb-handle-insert-directory): Use posix attributes if possible.
	(tramp-smb-handle-set-file-modes): It is applicable for posix only.

2009-10-11  Chong Yidong  <cyd@stupidchicken.com>

	* emacs-lisp/eieio.el: Avoid requiring cl at runtime.
	(eieio-defclass): Apply deftype handler and setf-method properties
	directly.
	(eieio-add-new-slot): Avoid union function from cl library.
	(eieio--typep): New function.
	(eieio-perform-slot-validation): Use it.

2009-10-10  Karl Fogel  <kfogel@red-bean.com>

	* bookmark.el (bookmark-yank-word, bookmark-insert-current-bookmark):
	Update documentation to refer to the variables documented in r1.135.
	(Bug#4188)

2009-10-10  Karl Fogel  <kfogel@red-bean.com>

	* bookmark.el (Info-suffix-list): Remove this unused variable.
	(bookmark-current-point): Remove this obsolete variable.
	(bookmark-set, bookmark-rename, bookmark-send-edited-annotation):
	Adjust for removal of bookmark-current-point.

	(bookmarks-already-loaded, bookmark-current-buffer)
	(bookmark-yank-point): Document.  (Bug#4188)

2009-10-10  Glenn Morris  <rgm@gnu.org>

	* frame.el (frame-height): Doc fix.

	* calendar/calendar.el (calendar-split-width-threshold): New option.
	(calendar-basic-setup): Use calendar-split-width-threshold.

2009-10-09  Juanma Barranquero  <lekktu@gmail.com>

	* international/mule-cmds.el (ucs-names): Exclude new "Enclosed
	Ideographic Supplement" range (U+1F200..U+1F2FF).

2009-10-09  Karl Fogel  <kfogel@red-bean.com>

	* bookmark.el (bookmark-bmenu-rename): Don't call bookmark-bmenu-list,
	since the list will have been rebuilt anyway.  (Bug#4349)

2009-10-09  Karl Fogel  <kfogel@red-bean.com>

	* bookmark.el (bookmark-delete): Don't let batch arg prevent saving.
	(bookmark-bmenu-execute-deletions): Don't save here, as
	bookmark-delete will now do so if necessary.
	Suggested by Thierry Volpiatto <thierry.volpiatto {_AT_} gmail.com>.
	(Bug#4348)

2009-10-09  Glenn Morris  <rgm@gnu.org>

	* mail/emacsbug.el (report-emacs-bug): Also print `features'.

2009-10-09  Karl Fogel  <kfogel@red-bean.com>

	* bookmark.el (bookmark-jump): Add new `display-func' parameter.
	(bookmark-jump-other-window): Just invoke bookmark-jump with new
	argument now, so the two function's behaviors will match.  (Bug#3645)

2009-10-08  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-file-name-real-user, tramp-file-name-domain)
	(tramp-file-name-real-host, tramp-file-name-port):
	Apply `save-match-data'.

	* net/tramp-smb.el (tramp-smb-handle-copy-directory): Handle the
	case both directories are remote.
	(tramp-smb-handle-expand-file-name): Implement "~" expansion.
	(tramp-smb-maybe-open-connection): Flush the cache only if necessary.

2009-10-07  Juanma Barranquero  <lekktu@gmail.com>

	* makefile.w32-in (WINS_UPDATES): Fix typo in previous change.

2009-10-07  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/autoload.el (batch-update-autoloads): Remove useless use
	of concat.

2009-10-07  Stefan Monnier  <monnier@iro.umontreal.ca>

	* files-x.el (read-file-local-variable): Include some
	non-user-variables in the completion table (bug#4664).

2009-10-07  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-cache.el (tramp-flush-connection-property): Add trace
	message.

	* net/tramp-smb.el (tramp-smb-errors): Add error messages.
	(tramp-smb-file-name-handler-alist): Add handler for
	`copy-directory', `expand-file-name', `set-file-modes'.
	(tramp-smb-handle-copy-directory)
	(tramp-smb-handle-expand-file-name)
	(tramp-smb-handle-set-file-modes): New defuns.
	(tramp-smb-handle-copy-file): Handle KEEP-DATE.
	(tramp-smb-handle-file-attributes): Simplify check for retrieving
	entry.
	(tramp-smb-handle-insert-directory): Don't flush the cache.
	(tramp-smb-maybe-open-connection): Check for samba client and
	server versions.

2009-10-07  Eli Zaretskii  <eliz@gnu.org>

	* emacs-lisp/autoload.el (batch-update-autoloads): Fix last change
	to not error out of search for "^lisp=" fails.

2009-10-07  Juanma Barranquero  <lekktu@gmail.com>

	* makefile.w32-in (WINS_UPDATES): New macro.
	(custom-deps, finder-data, autoloads): Use it.

2009-10-07  Glenn Morris  <rgm@gnu.org>

	* Makefile.in (autoloads): Revert previous change.
	* emacs-lisp/autoload.el (batch-update-autoloads): Rather than having
	the list of preloaded files passed on the command-line, get
	it from src/Makefile.

	* calendar/calendar.el (calendar-basic-setup): In the wide frame case,
	show the original buffer rather than a random one.

2009-10-07  Markus Rost  <rost@math.uni-bielefeld.de>

	* help.el (describe-no-warranty): Place point in a slightly better
	position in the GPLv3 text.

2009-10-06  Sam Steingold  <sds@gnu.org>

	* net/tramp-compat.el (tramp-compat-process-running-p): Check that
	the comm attribute is present before calling regexp-quote.

2009-10-06  Juanma Barranquero  <lekktu@gmail.com>

	* play/animate.el (animate-string): For good effect, make sure
	`indent-tabs-mode' and `show-trailing-whitespace' are nil.

	* play/animate.el (animate-sequence, animate-birthday-present):
	* misc.el (butterfly): Don't set `indent-tabs-mode'.

2009-10-06  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/byte-run.el (define-obsolete-face-alias): Doc fix.

	* emacs-lisp/autoload.el (autoload-excludes): New variable.
	(autoload-generate-file-autoloads): Skip files in autoload-excludes.
	(batch-update-autoloads): Process a string value of autoload-excludes,
	set during the build process.
	* Makefile.in (autoloads): Skip preloaded files.  (Bug#4446)

	* net/tramp.el (tramp-handle-start-file-process): Move tramp-error call
	inside with-parsed...  macro so that `v' is defined.

	* progmodes/f90.el (f90-end-of-block, f90-beginning-of-block):
	* progmodes/fortran.el (fortran-end-of-block)
	(fortran-beginning-of-block):
	Also push mark in the macro case.

	* emerge.el (emerge-show-file-name):
	* calc/calc.el (calc-quit):
	* calc/calc-misc.el (calc-big-or-small):
	* calc/calc-graph.el (calc-graph-view):
	* calc/calc-ext.el (calc-reset):
	* calendar/calendar.el (calendar-basic-setup):
	Use window-full-height-p.

	* mail/rmailedit.el (rmail-cease-edit): If there is a Content-Type
	header we don't understand, don't insert another.  (Bug#4624)
	If changing mime charset, insert the new one in the right place.

2009-10-06  Matthew Junker  <matthew.junker@sbcglobal.net>  (tiny change)

	* calendar/cal-tex.el (cal-tex-cursor-month-landscape)
	(cal-tex-cursor-month): Correctly increment the end date for diary and
	holiday listing.  (Bug#4626)

2009-10-05  Stefan Monnier  <monnier@iro.umontreal.ca>

	* help-fns.el (describe-function-1): Don't burp if the function is not
	a symbol.

2009-10-05  Juanma Barranquero  <lekktu@gmail.com>

	* emacs-lisp/chart.el (chart-face-pixmap-list, chart-new-buffer, chart)
	(chart-axis-range, chart-axis-names, chart-sequece, chart-bar)
	(chart-draw, chart-axis-draw, chart-sort, chart-sort-matchlist)
	(chart-draw-line, chart-bar-quickie): Fix typos in docstrings.

	* emacs-lisp/eieio.el (generic-p, eieiomt-next, eieio-generic-form)
	(eieio-default-superclass): Reflow docstrings.
	(this, class-option-assoc, defclass, eieio-class-un-autoload)
	(eieio-unbind-method-implementations, defmethod)
	(eieio-validate-slot-value, eieio-validate-class-slot-value)
	(oref-default, eieio-oref-default, eieio-oset, eieio-oset-default)
	(with-slots, eieio-add-new-slot, object-assoc, object-remove-from-list)
	(eieio-slot-originating-class-p, eieio-slot-name-index)
	(eieio-pre-method-execution-hooks, eieio-initarg-to-attribute)
	(constructor, initialize-instance, no-next-method, object-print)
	(object-write, eieio-override-prin1, eieio-edebug-prin1-to-string):
	Fix typos in docstrings.
	(eieio-defclass, eieio-perform-slot-validation-for-default, defgeneric)
	(child-of-class-p, object-slots, slot-boundp, slot-exists-p)
	(next-method-p): Doc fixes.
	(eieio-add-new-slot, call-next-method, eieiomt-add, change-class):
	Fix typos in error messages.
	(eieio-defmethod): Fix typo in description of generic method.

	* emacs-lisp/eieio-base.el (eieio-instance-inheritor, slot-unbound)
	(eieio-persistent-save-interactive, slot-missing):
	Fix typos in docstrings.
	(eieio-instance-inheritor-slot-boundp): Doc fix.

	* emacs-lisp/eieio-comp.el (byte-compile-file-form-defmethod)
	(byte-compile-defmethod-param-convert): Fix typos in docstrings.

	* emacs-lisp/eieio-custom.el (eieio-done-customizing)
	(eieio-custom-object-apply-reset):
	Fix typos in docstrings and error messages.

	* emacs-lisp/eieio-datadebug.el (data-debug-show):
	Fix typo in docstring.

	* emacs-lisp/eieio-opt.el (top): Fix typo in error message.
	(eieio-browse-tree): Doc fix.
	(eieio-all-generic-functions, eieio-class-speedbar): Reflow docstrings.
	(eieio-help-mode-augmentation-maybee, eieio-class-speedbar-make-map):
	Fix typos in docstrings.

	* emacs-lisp/eieio-speedbar.el (eieio-speedbar-file-button): Doc fix.
	(eieio-speedbar-key-map, eieio-speedbar-create-engine)
	(eieio-speedbar-buttons, eieio-speedbar, eieio-speedbar-object-children)
	(eieio-speedbar-make-tag-line, eieio-speedbar-object-expand):
	Reflow docstrings.

2009-10-05  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-hg.el (log-view-vc-backend): Declare for compiler.
	(vc-hg-outgoing-mode, vc-hg-incoming-mode):
	Set log-view-vc-backend so that diff can work.

	* log-view.el (log-view-diff): Use vc-diff-internal instead of
	vc-version-diff.
	(vc-diff-internal): Autoload this instead of vc-version-diff.

2009-10-05  Eli Zaretskii  <eliz@gnu.org>

	* simple.el (eval-expression): Doc fix.

	* progmodes/cwarn.el (cwarn-mode): Doc fix.

2009-10-05  Michael Albinus  <michael.albinus@gmx.de>

	* files.el (directory-files-no-dot-files-regexp): New defconst.
	(delete-directory): Use it.
	(copy-directory): Use it.  Remove parameter PRESERVE-UID-GID.

	* net/tramp.el (tramp-verbose): Fix docstring.
	(tramp-methods): Add recursive option to `tramp-copy-args'.
	Add `tramp-copy-recursive'.  Valid for "rcp", "scp", "scp1", "scp2",
	"scp1_old", "scp2_old", "rsync", "rsyncc".
	(tramp-default-method): Check also for `auth-source-user-or-password'.
	(tramp-file-name-handler-alist, tramp-file-name-for-operation):
	Add handler for `copy-directory'.
	(tramp-handle-copy-directory): New defun.
	(tramp-do-copy-or-rename-file-out-of-band): Handle directory case.
	(tramp-handle-start-file-process): Raise an error when PROGRAM is nil.
	Optimize sent command.

2009-10-05  Stefan Monnier  <monnier@iro.umontreal.ca>

	* calendar/diary-lib.el (diary-show-all-entries): Re-fit the calendar
	window if necessary.

	* calendar/calendar.el (calendar-basic-setup): Don't call
	switch-to-buffer in a dedicated window.

2009-10-05  Karl Fogel  <kfogel@red-bean.com>

	* bookmark.el (bookmark-handle-bookmark): If bookmark has no file,
	don't do anything related to relocating, just return nil.
	(bookmark-error-no-filename): New error.
	(bookmark-default-handler): Signal `bookmark-error-no-filename' if
	bookmark has no file.  Don't even attempt to handle things that
	are not files; the whole point of custom handlers is to keep that
	knowledge elsewhere anyway.  Tighten some comments.
	(bookmark-file-or-variation-thereof): Remove now-unused function.
	(bookmark-location): Doc string fix.
	(Bug#4250)

2009-10-04  Karl Fogel  <kfogel@red-bean.com>

	* bookmark.el (bookmark-handle-bookmark): When relocating a bookmark,
	don't use a file dialog, because they usually don't know how to read
	a directory target from the user.  (Bug#4230)
	Also, make sure the prompt can display directories as well as files.

2009-10-04  Karl Fogel  <kfogel@red-bean.com>

	* bookmark.el (bookmark-set, bookmark-buffer-name):
	Improve doc strings.  (Bug#1193)

2009-10-04  Karl Fogel  <kfogel@red-bean.com>

	* bookmark.el (bookmark-get-bookmark, bookmark-get-bookmark-record)
	(bookmark-set-name, bookmark-prop-get, bookmark-prop-set)
	(bookmark-get-annotation, bookmark-set-annotation)
	(bookmark-get-filename, bookmark-set-filename, bookmark-get-position)
	(bookmark-set-position, bookmark-get-front-context-string)
	(bookmark-set-front-context-string, bookmark-get-rear-context-string)
	(bookmark-set-rear-context-string, bookmark-location, bookmark-jump)
	(bookmark-jump-other-window, bookmark-handle-bookmark)
	(bookmark-relocate, bookmark-insert-location, bookmark-rename)
	(bookmark-insert, bookmark-delete, bookmark-time-to-save-p)
	(bookmark-edit-annotation-mode, bookmark-edit-annotation):
	Improve doc strings to say whether bookmark can be a string or
	a record or both, and make other consistency and clarity fixes.
	(bookmark-get-handler, bookmark--jump-via, bookmark-write-file)
	(bookmark-default-annotation-text, bookmark-yank-word)
	(bookmark-maybe-load-default-file, bookmark-maybe-sort-alist)
	(bookmark-import-new-list, bookmark-maybe-rename)
	(bookmark-bmenu-show-filenames, bookmark-bmenu-hide-filenames)
	(bookmark-bmenu-bookmark): Give these doc strings.
	(bookmark-bmenu-check-position): Give this a doc string, but also
	add a FIXME comment about how the function may be pointless.
	(bookmark-default-handler): Rework doc string and change a
	parameter name, to clarify that this takes a bookmark record
	not a bookmark name.
	(bookmark-set): Change a parameter name to indicate its meaning,
	and improve the doc string a bit.
	(Bug#4188)

2009-10-04  Karl Fogel  <kfogel@red-bean.com>

	* bookmark.el (bookmark-alist): Document the new `handler' element
	in the param alist.
	(bookmark-make-record-function): Adjust documentation for above.
	(Bug#4193)

2009-10-04  Karl Fogel  <kfogel@red-bean.com>

	* info.el (Info-bookmark-make-record): Document this function.
	(Info-bookmark-jump): Document with a doc string, not just a comment.
	(Bug#4203)

2009-10-04  Michael Albinus  <michael.albinus@gmx.de>

	* files.el (copy-directory): New defun.

	* dired-aux.el (dired-copy-file-recursive): Use it.

2009-10-04  Juanma Barranquero  <lekktu@gmail.com>

	* files-x.el (modify-dir-local-variable)
	(copy-dir-locals-to-file-locals-prop-line): Fix typos in
	docstrings.

	* recentf.el (recentf-unload-function): New function.

2009-10-04  Glenn Morris  <rgm@gnu.org>

	* window.el (window-full-height-p): Add doc string.

2009-10-04  Martin Rudalics  <rudalics@gmx.at>

	* window.el (window-full-height-p): New function.  (Bug#4543)

2009-10-03  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc.el: Remove commented out code.
	(vc-derived-from-dir-mode): Remove, unused.
	(vc-version-diff, vc-diff): Consistently pass t to vc-deduce-fileset.

2009-10-03  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-ftp.el (tramp-ftp-file-name-handler):
	Disable `file-name-handler-alist' when loading 'ange-ftp.  Otherwise,
	there could be recursive loading when `default-directory' is a
	remote file name.  (Bug#4614)

2009-10-03  Glenn Morris  <rgm@gnu.org>

	* calendar/calendar.el (calendar-basic-setup): Handle the case where
	the frame is wide.
	(calendar-generate-window): Test for shrinkability rather than width.

	* mail/rmail.el (rmail-generate-viewer-buffer): Be more careful about
	reusing existing buffers, in case we happen to visit two files with the
	same basename.  (Bug#4593)

2009-10-02  Eli Zaretskii  <eliz@gnu.org>

	* makefile.w32-in (update-subdirs-CMD): Add cedet to $(WINS_SUBDIR).
	(WINS_CEDET_SUBDIRS): List of subdirectories of cedet.
	(bootstrap-clean-CMD, bootstrap-clean-SH): Remove *.elc files in
	subdirs of cedet as well.
	(AUTOGENEL): Add loaddefs.el files in cedet subdirectories.

2009-10-02  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/eldoc.el (eldoc-get-fnsym-args-string):
	Obey advertised-signature-table.

	* help-fns.el (help-function-arglist): Don't check
	advertised-signature-table.
	(describe-function-1): Do it here instead so it also applies to subrs.

2009-10-02  Michael Albinus  <michael.albinus@gmx.de>

	* simple.el (start-file-process): Say in the doc-string, that file
	handlers might not support pty association, if PROGRAM is nil.

	* net/ange-ftp.el (ange-ftp-generate-passwd-key): Check, whether
	HOST and USER are strings.  They are nil, when there are
	incomplete entries in ~/.netrc, for example.
	(ange-ftp-delete-directory): Implement RECURSIVE case.  Change to
	root directory ("device busy" error otherwise).

	* net/tramp-smb.el (tramp-smb-handle-make-directory-internal):
	Flush file properties of created directory.

2009-10-02  Eli Zaretskii  <eliz@gnu.org>

	* makefile.w32-in (WINS_BASIC): Remove cedet.
	(WINS_CEDET): Add cedet.
	(update-subdirs-SH): Use $(WINS_SUBDIR), not $(WINS).

2009-10-02  Kevin Ryde  <user42@zip.com.au>

	* net/browse-url.el (browse-url): Pass any symbol in
	browse-url-browser-function to `apply', since if you've mistakenly put
	an unbound symbol then the error is clearer.  (Bug#4531)

2009-10-02  Juanma Barranquero  <lekktu@gmail.com>

	* allout.el (allout-init, allout-back-to-current-heading)
	(allout-beginning-of-current-entry, allout-ascend-to-depth)
	(allout-ascend, allout-up-current-level, allout-end-of-level)
	(allout-previous-visible-heading, allout-forward-current-level)
	(allout-backward-current-level, allout-show-children):
	* apropos.el (apropos-describe-plist):
	* bookmark.el (bookmark-maybe-historicize-string, bookmark-bmenu-list):
	* comint.el (comint-strip-ctrl-m, comint-goto-process-mark):
	* completion.el (add-completion, add-permanent-completion):
	* descr-text.el (describe-text-category, describe-char):
	* desktop.el (desktop-lazy-abort):
	* dired-x.el (dired-omit-expunge, dired-x-bind-find-file):
	* dired.el (dired-build-subdir-alist):
	* ediff.el (ediff-version):
	* elide-head.el (elide-head, elide-head-show):
	* emerge.el (emerge-version):
	* env.el (getenv):
	* face-remap.el (variable-pitch-mode):
	* faces.el (describe-face):
	* ffap.el (ffap-next-url, find-file-at-point, ffap-at-mouse)
	(dired-at-point):
	* files.el (find-file-existing, auto-save-mode):
	* font-lock.el (font-lock-fontify-buffer):
	* help-fns.el (describe-function, describe-variable)
	(describe-syntax, describe-categories):
	* help.el (view-lossage, describe-bindings, describe-key)
	(describe-mode):
	* hexl.el (hexl-current-address):
	* hi-lock.el (hi-lock-mode, hi-lock-find-patterns):
	* info.el (Info-goto-emacs-key-command-node):
	* log-edit.el (log-edit-insert-cvs-template)
	(log-edit-insert-cvs-rcstemplate):
	* menu-bar.el (menu-bar-mode):
	* mouse.el (mouse-appearance-menu):
	* newcomment.el (comment-indent-new-line):
	* pgg.el (pgg-save-coding-system, pgg-encrypt-region)
	(pgg-encrypt-symmetric-region, pgg-encrypt-symmetric)
	(pgg-encrypt, pgg-decrypt-region, pgg-decrypt)
	(pgg-sign-region, pgg-sign, pgg-verify-region, pgg-verify):
	* recentf.el (recentf-mode):
	* savehist.el (savehist-mode, savehist-save):
	* shadowfile.el (shadow-copy-files):
	* simple.el (kill-ring-save, next-line, previous-line)
	(normal-erase-is-backspace-mode):
	* strokes.el (strokes-update-window-configuration)
	(strokes-load-user-strokes, strokes-prompt-user-save-strokes)
	(strokes-xpm-for-stroke):
	* time.el (emacs-uptime, emacs-init-time):
	* tutorial.el (tutorial--describe-nonstandard-key)
	(tutorial--detailed-help):
	* type-break.el (type-break-mode)
	(type-break-mode-line-message-mode, type-break-query-mode)
	(type-break-guesstimate-keystroke-threshold):
	* vc.el (vc-version-diff, vc-diff, vc-root-diff):
	* version.el (emacs-version):
	* vt-control.el (vt-keypad-on, vt-keypad-off, vt-numlock):
	* winner.el (winner-mode):
	* calendar/timeclock.el (timeclock-in, timeclock-out)
	(timeclock-status-string, timeclock-change)
	(timeclock-workday-remaining-string)
	(timeclock-workday-elapsed-string)
	(timeclock-when-to-leave-string):
	* calendar/todo-mode.el (todo-add-category):
	* emacs-lisp/advice.el (ad-enable-regexp, ad-disable-regexp):
	* emacs-lisp/autoload.el (update-file-autoloads):
	* emacs-lisp/checkdoc.el (checkdoc-current-buffer)
	(checkdoc-start, checkdoc-continue, checkdoc-rogue-spaces)
	(checkdoc-message-text, checkdoc-defun):
	* emacs-lisp/debug.el (debugger-list-functions):
	* emacs-lisp/easy-mmode.el (easy-mmode-define-navigation):
	* emacs-lisp/eieio-opt.el (eieio-describe-class)
	(eieio-describe-generic):
	* emacs-lisp/lisp-mnt.el (lm-synopsis):
	* emacs-lisp/shadow.el (list-load-path-shadows):
	* emulation/cua-base.el (cua-mode):
	* emulation/edt.el (edt-set-scroll-margins):
	* emulation/tpu-edt.el (tpu-toggle-newline-and-indent)
	(tpu-toggle-regexp, tpu-toggle-search-direction)
	(tpu-toggle-rectangle, tpu-toggle-control-keys):
	* emulation/tpu-extras.el (tpu-set-scroll-margins):
	* emulation/viper-cmd.el (viper-set-searchstyle-toggling-macros)
	(viper-set-parsing-style-toggling-macro)
	(viper-set-emacs-state-searchstyle-macros):
	* emulation/viper.el (viper-set-hooks):
	* eshell/esh-mode.el (eshell-truncate-buffer):
	* international/mule-cmds.el (prefer-coding-system)
	(describe-input-method, describe-language-environment):
	* international/mule-diag.el (list-character-sets)
	(describe-character-set, describe-coding-system)
	(describe-fontset, list-fontsets, list-input-methods):
	* mail/sendmail.el (mail-signature):
	* net/ange-ftp.el (ange-ftp-copy-file):
	* net/browse-url.el (browse-url):
	* net/eudc.el (eudc-set-server, eudc-get-attribute-list):
	* net/quickurl.el (quickurl-add-url):
	* net/rcirc.el (names, topic):
	* net/xesam.el (xesam-mode):
	* play/5x5.el (5x5-new-game):
	* play/yow.el (apropos-zippy):
	* progmodes/ada-mode.el (ada-mode-version):
	* progmodes/f90.el (f90-beginning-of-subprogram, f90-end-of-subprogram)
	(f90-end-of-block)
	(f90-beginning-of-block):
	* progmodes/fortran.el (fortran-end-of-block)
	(fortran-beginning-of-block):
	* progmodes/js.el (js-syntactic-context, js-gc, js-eval):
	* progmodes/python.el (python-describe-symbol, python-shell):
	* term/ns-win.el (ns-print-buffer):
	* textmodes/bibtex.el (bibtex-end-of-entry, bibtex-url):
	* textmodes/flyspell.el (flyspell-mode-on):
	* textmodes/page-ext.el (set-page-delimiter, pages-directory)
	(pages-directory-for-addresses):
	* textmodes/table.el (table-recognize-cell)
	(table-query-dimension, table-generate-source)
	(table-insert-sequence, table--warn-incompatibility):
	* textmodes/tex-mode.el (tex-validate-buffer):
	* textmodes/texinfmt.el (texinfmt-version)
	(texinfo-format-buffer):
	Use `called-interactively-p' instead of `interactive-p'.

2009-10-02  Juanma Barranquero  <lekktu@gmail.com>

	* image-mode.el (image-toggle-display):
	* emacs-lisp/elp.el (elp-instrument-function):
	* emacs-lisp/advice.el (ad-make-advised-definition):
	* emacs-lisp/easy-mmode.el (define-minor-mode):
	* net/browse-url.el (browse-url-maybe-new-window):
	* progmodes/sh-script.el (sh-learn-buffer-indent):
	Pass new argument 'any to `called-interactively-p'.

2009-10-01  Juanma Barranquero  <lekktu@gmail.com>

	* international/uni-bidi.el:
	* international/uni-category.el:
	* international/uni-combining.el:
	* international/uni-comment.el:
	* international/uni-decimal.el:
	* international/uni-decomposition.el:
	* international/uni-digit.el:
	* international/uni-lowercase.el:
	* international/uni-mirrored.el:
	* international/uni-name.el:
	* international/uni-numeric.el:
	* international/uni-old-name.el:
	* international/uni-titlecase.el:
	* international/uni-uppercase.el:
	Regenerate from Unicode 5.2.0 data.

2009-10-01  Glenn Morris  <rgm@gnu.org>

	* Makefile.in (ELCFILES): Regenerate.

2009-10-01  Stefan Monnier  <monnier@iro.umontreal.ca>

	* subr.el (interactive-p): Mark obsolete.
	(called-interactively-p): Make the optional-ness of `kind' obsolete.
	* emacs-lisp/bytecomp.el (byte-compile-fdefinition): Make it obey
	advertised-signature-table for subroutines as well.

	* emacs-lisp/byte-run.el (advertised-signature-table): New var.
	(set-advertised-calling-convention): New function.
	(make-obsolete, define-obsolete-function-alias)
	(make-obsolete-variable, define-obsolete-variable-alias):
	Make the optional-ness of `when' obsolete.
	(define-obsolete-face-alias): Make `when' non-optional.
	* help-fns.el (help-function-arglist):
	* emacs-lisp/bytecomp.el (byte-compile-fdefinition):
	Use advertised-signature-table.

2009-10-01  Michael Albinus  <michael.albinus@gmx.de>

	* files.el (delete-directory): New defun.  The original function
	in fileio.c has been renamed to `delete-directory-internal'.

	* dired.el (dired-delete-file): Call `delete-directory' with
	RECURSIVE parameter.

	* net/ange-ftp.el (ange-ftp-delete-directory): Add optional
	parameter RECURSIVE.  Implementation is missing.

	* net/tramp.el (tramp-handle-make-directory): Flush upper
	directory's file properties.
	(tramp-handle-delete-directory): Handle optional parameter RECURSIVE.
	(tramp-handle-dired-recursive-delete-directory): Flush directory
	properties after the remove command only.

	* net/tramp-fish.el (tramp-fish-handle-delete-directory):
	Handle optional parameter RECURSIVE.

	* net/tramp-gvfs.el (tramp-gvfs-handle-delete-directory):
	Handle optional parameter RECURSIVE.

	* net/tramp-smb.el (tramp-smb-errors): Add error message for
	connection timeout.
	(tramp-smb-handle-delete-directory): Handle optional parameter
	RECURSIVE.

2009-10-01  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/bytecomp.el (byte-compile-defmacro-declaration): New fun.
	(byte-compile-file-form-defmumble, byte-compile-defmacro): Use it.
	(byte-compile-defmacro): Use backquotes.

	* files.el (cd-absolute): Don't abbreviate-file-name (bug#4599).

	* vc-dispatcher.el (vc-resynch-window): Don't revert a buffer which
	has no associated file.
	(vc-resynch-buffer): Use vc-dir-buffers.

2009-10-01  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/chart.el (chart-zap-chars, chart-bar-quickie)
	(chart-file-count):
	* emacs-lisp/eieio-comp.el (byte-compile-defmethod-param-convert):
	* emacs-lisp/eieio-datadebug.el (data-debug-insert-object-button):
	* emacs-lisp/eieio-opt.el (eieio-describe-class):
	* emacs-lisp/eieio-speedbar.el (eieio-speedbar-create):
	* emacs-lisp/eieio.el (defclass, eieio-defclass-autoload)
	(eieio-copy-parents-into-subclass, make-instance, class-children)
	(eieio-generic-form):

	* vc-cvs.el (vc-cvs-parse-entry): Be more careful with the
	match-data.  (Bug#4555).

	* emacs-lisp/check-declare.el (check-declare-scan): Read the declaration
	rather than parsing it as a regexp.  This relaxes the layout
	requirements and makes errors easier to detect.
	(check-declare-verify): Check file is regular.
	(check-declare-directory): Doc fix.
	* subr.el (declare-function): Doc fix.

	* ibuffer.el (ibuffer-format-qualifier):
	* isearch.el (hi-lock-regexp-okay):
	* calc/calc.el (math-zerop):
	* mail/uce.el (rmail-msgbeg, rmail-msgend):
	* term/w32-win.el (setup-default-fontset, set-fontset-font):
	Remove unused declarations.

2009-09-30  Eric Ludlam  <zappo@gnu.org>

	* emacs-lisp/eieio.el (boolean-p): Delete.

2009-09-30  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/authors.el (authors-ignored-files): Add "js2-mode.el".

	* emacs-lisp/elint.el (elint-init-form): Report declarations where the
	filename is not a string.

2009-09-29  Chong Yidong  <cyd@stupidchicken.com>

	* files.el (safe-local-eval-forms): Fix typo.

2009-09-29  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-hooks.el (vc-dir-buffers): New var.
	(vc-state-refresh): New function.
	(vc-state): Use it.
	(vc-after-save): Always ask the backend to recompute the new state.
	Always call vc-dir if necessary, using vc-dir-buffers.
	* vc-dir.el (vc-dir-prepare-status-buffer, vc-dir-resynch-file):
	Use vc-dir-buffers.
	(vc-dir-mode): Use vc-dir-buffers rather than after-save-hook.
	(vc-dir-prepare-status-buffer, vc-dir-update)
	(vc-dir-resync-directory-files, vc-dir-resynch-file, vc-dir-mode):
	Don't call expand-file-name on default-directory.

2009-09-29  Juanma Barranquero  <lekktu@gmail.com>

	* speedbar.el (speedbar-item-delete):
	* calc/calc-prog.el (calc-kbd-if):
	* language/hanja-util.el (hanja-init-load): Fix typos in messages.

	* epa.el (epa-key-list-mode-map):
	* hi-lock.el (hi-lock-menu): Fix typos in menus.

	* progmodes/hideshow.el (hs-allow-nesting): Reflow docstring.
	(hs-show-hook): Fix typo in docstring.

2009-09-29  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/check-declare.el (check-declare-locate): Remove pointless
	file-name-nondirectory call preventing location of cedet files.
	(check-declare-verify): Use literal search rather than re-search.
	Add basic defmethod and defclass, and define-overloadable-function.

	* net/tramp-smb.el (tramp-smb-handle-directory-files-and-attributes):
	Use tramp-compat-file-attributes rather than nonexistent
	tramp-compat-handle-file-attributes.

	* Makefile.in (lisptagsfiles4): New.
	(AUTOGENEL): Add cedet loaddefs files.
	(TAGS, TAGS-LISP): Use $lisptagsfiles4.
	(update-elclist, compile-always, backup-compiled-files)
	(bootstrap-clean): Add yet another directory level.
	(update-elclist): Use LC_COLLATE rather than COLLATE.
	(ELCFILES): Update, via `make update-elclist'.

2009-09-29  Juanma Barranquero  <lekktu@gmail.com>

	* makefile.w32-in (WINS_CEDET, WINS_BASIC, WINS_SUBDIR): New macros.
	(WINS_ALMOST): Set from WINS_BASIC and WINS_CEDET.
	(update-subdirs-CMD): Use WINS_SUBDIR, not WINS_ALMOST.

2009-09-28  Andreas Schwab  <schwab@linux-m68k.org>

	* Makefile.in (lisptagsfiles3): Define.
	(TAGS, TAGS-LISP): Use it.
	(update-elclist): Add third directory level to look for elc files.
	(compile-always): Likewise.
	(backup-compiled-files): Likewise.
	(bootstrap-clean): Likewise.
	(ELCFILES): Update.

2009-09-28  Chong Yidong  <cyd@stupidchicken.com>

	* Makefile.in (ELCFILES): Add CEDET files.

2009-09-28  Michael Albinus  <michael.albinus@gmx.de>

	* Makefile.in (ELCFILES): Add net/tramp-imap.elc.

	* net/tramp.el (top): Require tramp-imap.

	* net/tramp-smb.el (tramp-smb-handle-directory-files-and-attributes):
	Use `tramp-compat-handle-file-attributes'.

2009-09-28  Teodor Zlatanov  <tzz@lifelogs.com>

	* net/tramp-imap.el: New package.

2009-09-28  Eric Ludlam  <zappo@gnu.org>

	* emacs-lisp/chart.el:
	* emacs-lisp/eieio-base.el:
	* emacs-lisp/eieio-comp.el:
	* emacs-lisp/eieio-custom.el:
	* emacs-lisp/eieio-datadebug.el:
	* emacs-lisp/eieio-opt.el:
	* emacs-lisp/eieio-speedbar.el:
	* emacs-lisp/eieio.el: New files.

2009-09-27  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* whitespace.el (whitespace-trailing-regexp)
	(whitespace-empty-at-bob-regexp, whitespace-empty-at-eob-regexp):
	Fix doc string.

2009-09-27  Chong Yidong  <cyd@stupidchicken.com>

	* menu-bar.el: Remove menu-bar-ediff-misc-menu from the Tools
	menu.

	* ediff-hook.el: Move menu-bar-ediff-misc-menu into
	menu-bar-ediff-menu.

	* emacs-lisp/lisp-mode.el: Add doc-string-elt property to
	define-overloadable-function.

	* progmodes/autoconf.el: Provide autoconf as well, so that this
	file can be `require'd.

	* emacs-lisp/cl-macs.el (deftype): Add to cl-loaddefs.

	* emacs-lisp/autoload.el (generated-autoload-feature)
	(generated-autoload-load-name): New vars.
	(autoload-rubric, autoload-generate-file-autoloads): Use them.
	(make-autoload): Recognize define-overloadable-function and
	defclass forms (for EIEIO).

	* Makefile.in (update-subdirs): Exclude cedet directory.

2009-09-27  Adrian Robert  <Adrian.B.Robert@gmail.com>

	* term/ns-win.el: Don't set the region face background.  (Bug#4381)

	* faces.el: Default light-background background for region face to
	ns_selection_color under NS.

2009-09-27  Teodor Zlatanov  <tzz@lifelogs.com>

	* net/imap-hash.el: New library, see NEWS.

	* Makefile.in (ELCFILES): Add imap-hash.el.

2009-09-27  Stefan Monnier  <monnier@iro.umontreal.ca>

	* help.el (help-for-help-internal): Don't purecopy the text (bug#4560).
	* isearch.el (isearch-help-for-help-internal): Purecopy the second arg.
	* help-macro.el (make-help-screen): Avoid using an ambiguous function
	definition where the docstring could be taken for the return value.

2009-09-26  Glenn Morris  <rgm@gnu.org>

	* mail/rmailmm.el (rmail-mime-show-images, rmail-mime-bulk-handler):
	Add option to only show images below a certain size.
	(rmail-mime-multipart-handler): Remove unnecessary save-match-data and
	save-excursion calls.

2009-09-26  Eli Zaretskii  <eliz@gnu.org>

	* makefile.w32-in (WINS_ALMOST): Add cedet (with its
	subdirectories) and eieio.

2009-09-26  Alan Mackenzie  <acm@muc.de>

	* progmodes/cc-engine.el (c-beginning-of-statement-1): Correct
	buggy bracketing.  (Bug#4289)

	* progmodes/cc-langs.el (c-nonlabel-token-key): Allow quoted
	character constants (as case labels).  (Bug#4289)

2009-09-25  Juri Linkov  <juri@jurta.org>

	* files.el (safe-local-eval-forms): Allow time-stamp in
	before-save-hook (Bug#4554).

2009-09-25  Drew Adams  <drew.adams@oracle.com>

	* menu-bar.el (list-buffers-directory): Doc fix.

2009-09-25  Stefan Monnier  <monnier@iro.umontreal.ca>

	* log-edit.el (log-edit-changelog-entries): Avoid inf-loops.
	Try and avoid copying twice the same paragraph.
	(log-edit-changelog-paragraph, log-edit-changelog-subparagraph):
	Remove save-excursion.
	(log-edit-changelog-entry): Do it here instead.

2009-09-25  Juanma Barranquero  <lekktu@gmail.com>

	* bs.el (bs--get-file-name): Use `list-buffers-directory'
	when available, instead of hardcoding mode names.  Doc fix.

	* menu-bar.el (list-buffers-directory): Add docstring.
	Make automatically buffer-local.

	* dired.el (dired-mode):
	* files.el (cd-absolute):
	* pcvs.el (cvs-temp-buffer):
	* pcvs-util.el (cvs-get-buffer-create):
	* shell.el (shell-mode):
	* vc-dir.el (vc-dir-mode):
	Don't make `list-buffers-directory' buffer local.

2009-09-25  Devon Sean McCullough  <emacs-hacker@Jovi.Net>

	* comint.el (comint-exec, comint-run, make-comint):
	Doc fixes (Bug#4542).

2009-09-25  Glenn Morris  <rgm@gnu.org>

	* mail/rmailmm.el (rmail-mime): New custom group.
	Move all defcustoms in this file into this group.
	(rmail-mime-media-type-handlers-alist): Revert previous change.
	(rmail-mime-show-images): New option.
	(rmail-mime-total-number-of-bulk-attachments): Remove variable and all
	references to it, since it wasn't actually used for anything.
	(rmail-mime-insert-image): New function.
	(rmail-mime-image): Use rmail-mime-insert-image.
	(rmail-mime-bulk-handler): Remove optional `image' argument, instead
	obey the value of `rmail-mime-show-images' option.  Print the size of
	attachments.

2009-09-25  David Engster  <deng@randomsample.de>

	* progmodes/hideshow.el (hs-show-block): Run `hs-show-hook'.  (Bug#4548)

2009-09-24  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* whitespace.el: Does not highlight trailing spaces While point is
	at end of line.  Does not highligt spaces at beginning of buffer
	while point is at beginning of buffer.  Does not highlight spaces
	at end of buffer while point is at end of buffer.  (Bug#4177)
	New version 12.0.
	(whitespace-display-mappings): Adjust initialization.
	(whitespace-point, whitespace-font-lock-refontify): New vars.
	(whitespace-color-on, whitespace-color-off): Adjust code.
	(whitespace-trailing-regexp, whitespace-empty-at-bob-regexp)
	(whitespace-empty-at-eob-regexp, whitespace-space-regexp)
	(whitespace-tab-regexp, whitespace-post-command-hook): New funs.

2009-09-24  Chong Yidong  <cyd@stupidchicken.com>

	* nxml/nxml-mode.el: Alias xml-mode to nxml-mode.

	* textmodes/sgml-mode.el: Remove xml-mode alias.

	* files.el (auto-mode-alist, conf-mode-maybe)
	(magic-fallback-mode-alist): Revert 2009-09-18 and 2009-09-21 changes.

2009-09-24  Alan Mackenzie  <acm@muc.de>

	* progmodes/cc-cmds.el (c-scan-conditionals): A new function like
	c-forward-conditionals, but it doesn't move point and doesn't set
	the mark.
	(c-up-conditional, c-up-conditional-with-else, c-down-conditional)
	(c-down-conditional-with-else, c-backward-conditional)
	(c-forward-conditional): Refactor to use c-scan-conditionals.

2009-09-24  Juanma Barranquero  <lekktu@gmail.com>

	* help-fns.el (help-downcase-arguments): New option, defaulting to nil.
	(help-default-arg-highlight): Remove.
	(help-highlight-arg): New function.
	(help-do-arg-highlight): Use it.
	Suggested by Drew Adams <drew.adams@oracle.com>.  (Bug#4510, bug#4520)

2009-09-24  Stefan Monnier  <monnier@iro.umontreal.ca>

	* term.el (term-set-scroll-region, term-handle-ansi-escape):
	Undo last change, which didn't fix the problem and introduced others.

2009-09-24  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-mi.el: Don't require speedbar.
	(gdb-jsonify-buffer): Handle case where "=" is part of value string.

2009-09-24  Glenn Morris  <rgm@gnu.org>

	* calendar/diary-lib.el (diary-fancy-display): Always run the hook.

	* term/ns-win.el (ns-reg-to-script): Define for compiler.

	* mail/rmailmm.el (rmail-mime-multipart-handler): Accept the case where
	there is no newline after the final mime boundary.  (Bug#4539)
	Move markers on insertion so that any buttons inserted don't end up in
	the next part of a multipart message.
	(rmail-mime-media-type-handlers-alist): Doc fix.  Add image handler.
	(rmail-mime-bulk-handler): Optionally handle images.
	(rmail-mime-image): New button action.
	(rmail-mime-image-handler): New function.
	(rmail-mime-mode): New mode.
	(rmail-mime): Doc fix.  Use rmail-mime-mode (for font-lock).

2009-09-24  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuffer.el (minibuffer-force-complete): Cycle the list, rather
	than just dropping elements from it (bug#4504).

	* term.el (term-set-scroll-region): Don't move cursor any more.
	(term-handle-ansi-escape): Call term-goto here instead.
	Suggested by Ivan Kanis <apple@kanis.eu>.

	* term.el: Require CL.
	(term-ansi-reset): New function.
	(term-mode, term-emulate-terminal, term-handle-colors-array): Use it.
	(term-handle-colors-array): Simplify.

2009-09-24  Juanma Barranquero  <lekktu@gmail.com>

	* allout.el (allout-overlay-interior-modification-handler)
	(allout-obtain-passphrase):
	* epa-file.el (epa-file-write-region):
	* ps-print.el (ps-begin-job):
	* vc-hooks.el (vc-toggle-read-only):
	* vc-rcs.el (vc-rcs-rollback):
	* vc-sccs.el (vc-sccs-rollback):
	* vc.el (vc-deduce-fileset, vc-next-action, vc-register-with)
	(vc-version-diff, vc-revert, vc-rollback):
	* wdired.el (wdired-check-kill-buffer):
	* emacs-lisp/authors.el (authors):
	* net/socks.el (socks-open-connection):
	* net/zeroconf.el (zeroconf-service-add-hook):
	* obsolete/vc-mcvs.el (vc-mcvs-register):
	* progmodes/gdb-mi.el (def-gdb-thread-buffer-gud-command)
	(gdb-select-frame):
	* progmodes/grep.el (lgrep, rgrep):
	* progmodes/idlw-help.el (idlwave-help-check-locations)
	(idlwave-help-html-link, idlwave-help-assistant-open-link):
	* textmodes/ispell.el (ispell-find-aspell-dictionaries):
	* textmodes/reftex-toc.el (reftex-toc-promote-prepare)
	(reftex-toc-rename-label): Fix typos in error messages.

	* dired-aux.el (dired-do-shell-command): Reflow docstring.
	(dired-copy-how-to-fn): Doc fix.
	(dired-files-attributes, dired-read-shell-command):
	Fix typos in docstrings.

	* dired-x.el (dired-enable-local-variables, dired-filename-at-point)
	(dired-x-find-file-other-window): Reflow docstrings.
	(dired-omit-marker-char, dired-read-shell-command)
	(dired-x-submit-report): Fix typos in docstrings.

	* shell.el (shell-mode-hook):
	* view.el (View-scroll-line-forward):
	* progmodes/inf-lisp.el (inferior-lisp-mode-hook):
	Fix typos in docstrings.

	* net/dig.el (dig-invoke): Fix typo in docstring.
	(query-dig): Reflow docstring.

	* progmodes/idlwave.el (idlwave-create-user-catalog-file)
	(idlwave-quoted, idlwave-rinfo-max-source-lines): Doc fixes.
	(idlwave-abbrev-move, idlwave-auto-routine-info-updates)
	(idlwave-begin-block-reg, idlwave-begin-unit-reg)
	(idlwave-beginning-of-subprogram, idlwave-block-jump-out)
	(idlwave-block-match-regexp, idlwave-calculate-paren-indent)
	(idlwave-check-abbrev, idlwave-class-file-or-buffer)
	(idlwave-class-found-in, idlwave-complete, idlwave-complete-in-buffer)
	(idlwave-completion-map, idlwave-current-indent)
	(idlwave-custom-ampersand-surround, idlwave-customize)
	(idlwave-default-font-lock-items, idlwave-default-insert-timestamp)
	(idlwave-define-abbrev, idlwave-determine-class-special)
	(idlwave-do-action, idlwave-doc-header, idlwave-doc-modification)
	(idlwave-end-block-reg, idlwave-end-of-statement)
	(idlwave-end-of-statement0, idlwave-end-of-subprogram)
	(idlwave-end-unit-reg, idlwave-entry-find-keyword)
	(idlwave-explicit-class-listed, idlwave-file-header)
	(idlwave-fill-paragraph, idlwave-find-class-definition)
	(idlwave-fix-keywords, idlwave-hang-indent-regexp, idlwave-hard-tab)
	(idlwave-idlwave_routine_info-compiled, idlwave-in-comment)
	(idlwave-in-quote, idlwave-indent-action-table)
	(idlwave-indent-expand-table, idlwave-indent-line)
	(idlwave-indent-subprogram, idlwave-indent-to-open-paren)
	(idlwave-is-comment-line, idlwave-is-comment-or-empty-line)
	(idlwave-is-continuation-line, idlwave-is-pointer-dereference)
	(idlwave-kill-autoloaded-buffers, idlwave-lib-p, idlwave-look-at)
	(idlwave-make-tags, idlwave-mode, idlwave-mode-abbrev-table)
	(idlwave-mouse-active-rinfo, idlwave-newline, idlwave-no-change-comment)
	(idlwave-outlawed-buffers, idlwave-popup-select)
	(idlwave-previous-statement, idlwave-rescan-catalog-directories)
	(idlwave-routine-entry-compare, idlwave-routine-info.pro)
	(idlwave-scan-all-buffers-for-routine-info, idlwave-scan-class-info)
	(idlwave-shell-automatic-start, idlwave-shell-explicit-file-name)
	(idlwave-show-begin, idlwave-split-line, idlwave-split-link-target)
	(idlwave-statement-type, idlwave-struct-skip)
	(idlwave-substitute-link-target, idlwave-toggle-comment-region)
	(idlwave-update-current-buffer-info, idlwave-use-library-catalogs)
	(idlwave-what-module-find-class): Fix typos in docstrings.
	(idlwave-all-method-classes, idlwave-calc-hanging-indent)
	(idlwave-calculate-cont-indent, idlwave-expand-equal)
	(idlwave-find-module, idlwave-find-structure-definition)
	(idlwave-init-rinfo-when-idle-after, idlwave-insert-source-location)
	(idlwave-list-load-path-shadows, idlwave-next-statement)
	(idlwave-routine-entry-compare-twins, idlwave-routine-info)
	(idlwave-routines, idlwave-sintern-rinfo-list, idlwave-statement-match)
	(idlwave-template): Reflow docstrings.

	* progmodes/idlw-shell.el (idlwave-shell-syntax-error): Doc fix.
	(idlwave-shell-batch-command, idlwave-shell-bp-alist)
	(idlwave-shell-bp-get, idlwave-shell-bp-overlays)
	(idlwave-shell-bp-query, idlwave-shell-break-here, idlwave-shell-buffer)
	(idlwave-shell-display-line, idlwave-shell-display-wframe)
	(idlwave-shell-electric-debug-mode, idlwave-shell-examine-select)
	(idlwave-shell-file-name-chars, idlwave-shell-filter-bp)
	(idlwave-shell-goto-frame, idlwave-shell-halt-messages-re)
	(idlwave-shell-highlighting-and-faces, idlwave-shell-idl-wframe)
	(idlwave-shell-mode-hook, idlwave-shell-mode-line-info)
	(idlwave-shell-mode-map, idlwave-shell-module-source-filter)
	(idlwave-shell-mouse-help, idlwave-shell-mouse-print)
	(idlwave-shell-pc-frame, idlwave-shell-pending-commands)
	(idlwave-shell-print, idlwave-shell-quit, idlwave-shell-redisplay)
	(idlwave-shell-scan-for-state, idlwave-shell-send-command)
	(idlwave-shell-sentinel-hook, idlwave-shell-separate-examine-output)
	(idlwave-shell-shell-command, idlwave-shell-sources-alist)
	(idlwave-shell-sources-bp, idlwave-shell-sources-filter)
	(idlwave-shell-step, idlwave-shell-use-breakpoint-glyph)
	(idlwave-toolbar-add-everywhere, idlwave-toolbar-toggle):
	Fix typos in docstrings.
	(idlwave-shell-bp, idlwave-shell-clear-current-bp)
	(idlwave-shell-hide-output, idlwave-shell-mode)
	(idlwave-shell-run-region, idlwave-shell-set-bp-in-module):
	Reflow docstrings.

	* textmodes/bibtex.el (bibtex-sort-entry-class): Fix group name.

2009-09-24  Ivan Kanis  <apple@kanis.eu>

	* term.el (term-bold-attribute): New var.
	(term-handle-colors-array): Use it.

2009-09-23  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-mi.el (gdb-version): New variable.
	(gdb-non-stop-handler): Set gdb-version.
	(gdb-gud-context-command, gdb-current-context-command, gdb-stopped):
	Condition "--thread" option on gdb-version.
	(gdb-invalidate-threads): Remove unused argument.

2009-09-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/flyspell.el (sgml-mode-flyspell-verify): Pass limit args
	to looking-back to avoid ridiculous slow down in large files (bug#4511).

2009-09-23  Glenn Morris  <rgm@gnu.org>

	* mail/rmail.el (rmail-reply): Don't try to add a References header when
	replying to mail without References or Message-Id.  (Bug#4525)

2009-09-23  Adrian Robert  <Adrian.B.Robert@gmail.com>

	* term/ns-win.el (ns-reg-to-script): New variable.

2009-09-23  Daiki Ueno  <ueno@unixuser.org>

	* epg.el (epg-wait-for-status): Preserve existing 'error results.

2009-09-22  Sam Steingold  <sds@gnu.org>

	* vc-hg.el (vc-hg-print-log): Fix shortlog arg passing.
	(vc-hg-outgoing, vc-hg-incoming): Bump okstatus in `vc-hg-command'
	to 1 because hg returns status 1 when nothing is found.
	Bind `vc-short-log' for the sake of `vc-hg-log-view-mode'.

2009-09-22  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/fill.el: Convert to utf-8 encoding.
	(fill-french-nobreak-p): Remove redundant » and « inherited from our
	pre-Unicode days.

	* add-log.el (change-log-fill-forward-paragraph): New function.
	(change-log-mode): Use it so fill-region DTRT.
	Set fill-indent-according-to-mode here rather than in
	change-log-fill-paragraph.
	(change-log-fill-paragraph): Remove.

2009-09-22  Juanma Barranquero  <lekktu@gmail.com>

	* info.el (Info-try-follow-nearest-node): Use the URL extracted by
	`Info-get-token', instead of `browse-url-url-at-point'.  (Bug#4508)

2009-09-22  Glenn Morris  <rgm@gnu.org>

	* calendar/calendar.el (calendar-mode-map): Make mouse-1 and 3 clicks on
	the scroll-bar scroll the calendar window rather than the buffer.

	* calendar/cal-menu.el (cal-menu-scroll-menu): Add a sub-section with
	commands that move point (as opposed to scrolling).

	* emulation/tpu-edt.el (tpu-copy-keyfile): Fix condition-case handler.

	* emacs-lisp/elint.el (elint): New custom group.
	(elint-log-buffer): Make it a defcustom.
	(elint-scan-preloaded, elint-ignored-warnings)
	(elint-directory-skip-re): New options.
	(elint-builtin-variables): Doc fix.
	(elint-preloaded-env): New variable.
	(elint-unknown-builtin-args): Add an entry for encode-time.
	(elint-extra-errors): Make it a variable rather than a constant.
	(elint-preloaded-skip-re): New constant.
	(elint-directory): Skip files matching elint-directory-skip-re.
	(elint-features): New variable, local to linted buffers.
	(elint-update-env): Initialize elint-features.  Possibly add
	elint-preloaded-env to the buffer's environment.
	(elint-get-top-forms): Bind elint-current-pos, for log messages.
	Skip quoted forms.
	(elint-init-form): New function, extracted from elint-init-env.
	Make non-list forms a warning rather than an error.
	Add the mode-map for define-derived-mode.  Handle define-minor-mode,
	easy-menu-define, put that adds an error-condition, and provide.
	When requiring cl, also require cl-macs.  Really require cl, to handle
	some cl macros.  Store required libraries in the list elint-features,
	so as not to re-load them.  Treat cc-require like require.
	(elint-init-env): Call elint-init-form to do the work.
	Handle eval-and-compile and such like.
	(elint-add-required-env): Do not clear messages.
	(elint-special-forms): Add handlers for function, defalias, if, when,
	unless, and, or.
	(elint-form): Add optional argument to ignore elint-special-forms,
	useful to prevent recursive calls from handlers.  Doc fix.
	Respect elint-ignored-warnings.
	(elint-form): Respect elint-ignored-warnings.
	(elint-bound-variable, elint-bound-function): New variables.
	(elint-unbound-variable): Respect elint-bound-variable.
	(elint-get-args): Respect elint-bound-function.
	(elint-check-cond-form): Add some simple handling for (f)boundp and
	featurep tests.
	(elint-check-defalias-form): New handler.
	(elint-check-let-form): Make an empty let a warning rather than an
	error.
	(elint-check-setq-form): Make an empty setq a warning rather than an
	error.  Respect elint-ignored-warnings.
	(elint-check-defvar-form): Accept null doc-strings.
	(elint-check-conditional-form): New handler.  Does some simple-minded
	checking of featurep and (f)boundp tests.
	(elint-put-function-args): New function.
	(elint-initialize): Use elint-scan-doc-file rather than
	elint-find-builtin-variables.  Use elint-put-function-args.
	Possibly scan preloaded-file-list.
	(elint-scan-doc-file): Rename from elint-find-builtin-variables and
	extend to handle functions as well.

2009-09-22  Lennart Borgman  <lennart.borgman@gmail.com>

	* linum.el (linum-delete-overlays, linum-update-window):
	Do not modify the right margin.  (Bug#3971)

2009-09-21  Chong Yidong  <cyd@stupidchicken.com>

	* files.el (conf-mode-maybe, magic-fallback-mode-alist): Use
	nxml-mode instead of xml-mode.

2009-09-21  Kevin Ryde  <user42@zip.com.au>

	* net/dig.el: Add "Keywords: comm", as per net-utils.el.  (Bug#4501)

2009-09-21  Stefan Monnier  <monnier@iro.umontreal.ca>

	* net/dig.el (dig-mode): Use define-derived-mode.

2009-09-20  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-dispatcher.el (vc-do-command): Return the process object in
	the asynchronous case.  Use when instead of if.  Do not run
	vc-exec-after to display a message if not enabled.  (Bug#4463)

	* vc-git.el (vc-git-dir-extra-headers): Add keymap and mouse-face
	properties to the stash strings.
	(vc-git-stash-list): Return a list of strings.
	(vc-git-stash-get-at-point, vc-git-stash-delete-at-point)
	(vc-git-stash-show-at-point): New functions.
	(vc-git-stash-map): New keymap.

	* register.el (ctl-x-r-map): Define the keys here instead of
	using autoload.

2009-09-20  Thierry Volpiatto  <thierry.volpiatto@gmail.com>  (tiny change)

	* bookmark.el (bookmark-write-file): Avoid calling `pp' with large
	list, to workaround performance problem (bug#4485).

2009-09-20  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gud.el (gud-sentinel): Revert indavertant change.

2009-09-20  Daiki Ueno  <ueno@unixuser.org>

	* epa-file.el (epa-file-cache-passphrase-for-symmetric-encryption):
	Document that this option is not recommended to use.

2009-09-19  Glenn Morris  <rgm@gnu.org>

	* calc/calc-graph.el (calc-graph-lookup): Avoid assignment to free
	variable `var'.

	* calc/calc-alg.el (var):
	* calc/calcalg2.el (var): Define for compiler.

2009-09-19  Chong Yidong  <cyd@stupidchicken.com>

	* emacs-lisp/advice.el (ad-get-argument, ad-set-argument):
	Doc fix (Bug#3932).

	* subr.el (baud-rate): Remove long-obsolete function (Bug#4372).

	* time-stamp.el (time-stamp-month-dd-yyyy)
	(time-stamp-dd/mm/yyyy, time-stamp-mon-dd-yyyy)
	(time-stamp-dd-mon-yy, time-stamp-yy/mm/dd)
	(time-stamp-yyyy/mm/dd, time-stamp-yyyy-mm-dd)
	(time-stamp-yymmdd, time-stamp-hh:mm:ss, time-stamp-hhmm):
	Remove functions that have been obsolete since 1995 (Bug#4436).

	* progmodes/sh-script.el (sh-learn-buffer-indent): Pop to the
	indent buffer only if called interactively (Bug#4452).

2009-09-19  Juanma Barranquero  <lekktu@gmail.com>
            Eli Zaretskii  <eliz@gnu.org>

	This fixes bug#4197 (merged to bug#865, though not identical).
	* server.el (server-auth-dir): Add docstring note about FAT32.
	(server-ensure-safe-dir): Accept FAT32 directories as "safe",
	but warn against using them.

2009-09-19  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-mi.el (gdb-var-update-handler-1): Include case of
	older GDB where there is no has_more field.

2009-09-19  Glenn Morris  <rgm@gnu.org>

	* pgg-pgp.el (pgg-pgp-encrypt-region): Add missing mapconcat separator.

2009-09-18  Chong Yidong  <cyd@stupidchicken.com>

	* files.el (auto-mode-alist): Change default for XML files to nXML
	mode (Bug#4169).

2009-09-18  Juanma Barranquero  <lekktu@gmail.com>

	* server.el (server-ensure-safe-dir): Pass 'integer
	to `file-attributes', as suggested.

2009-09-18  Stefan Monnier  <monnier@iro.umontreal.ca>

	* dired-aux.el (dired-query-alist): Remove spurious backslash.
	(dired-query): Use read-key.

2009-09-18  Adrian Robert  <Adrian.B.Robert@gmail.com>

	* cus-start.el (ns-use-qd-smoothing): Remove.

2009-09-18  Glenn Morris  <rgm@gnu.org>

	* allout.el (top-level): Remove unnecessary progn.

	* progmodes/js.el (js-end-of-defun): Remove malformed and unneeded let.

	* emacs-lisp/derived.el (define-derived-mode): Fix paren typo in
	definition of abbrev table.

	* speedbar.el (speedbar-track-mouse):
	* net/eudc-bob.el (eudc-bob-pipe-object-to-external-program):
	* net/eudc.el (eudc-expand-inline):
	* net/newst-backend.el (newsticker--cache-read-feed):
	* nxml/nxml-outln.el (nxml-end-of-heading): Fix typos in
	condition-case handlers.

2009-09-18  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-mi.el (gdb-frame-address): New variable.
	(gdb-var-list): Add an element for has_more field.
	(gdb-non-stop-handler): Enable pretty printing for STL containers.
	(gdb-var-create-handler, gdb-var-list-children-handler-1)
	(gdb-var-update-handler-1): Parse output of dynamic variable
	objects (STL containers).
	(gdb-var-delete-1): Pass var1 as an explicit second argument.
	(gdb-get-field): Delete alias.  Use bindat-get-field directly.

	* progmodes/gud.el (gud-speedbar-item-info): Adjust for change to
	gdb-var-list.
	(gud-speedbar-buttons): Make node expandable if expression "has more"
	children.

2009-09-17  Juanma Barranquero  <lekktu@gmail.com>

	* startup.el (emacs-quick-startup): Remove variable and all uses.
	(command-line): Set `inhibit-x-resources' instead.
	(command-line-1): Use `inhibit-x-resources' instead.

2009-09-17  Chong Yidong  <cyd@stupidchicken.com>

	* subr.el: Fix last change to avoid using the `unless' macro,
	which breaks bootstrapping.

2009-09-17  Stefan Monnier  <monnier@iro.umontreal.ca>

	* subr.el (push, pop, dolist, dotimes, declare): Don't overwrite CL's
	extended definitions, in case we reload subr.el after having
	loaded CL.
	(eval-next-after-load): Mark as obsolete.

2009-09-17  Juri Linkov  <juri@jurta.org>

	* menu-bar.el (menu-bar-search-menu, menu-bar-edit-menu)
	(menu-bar-options-menu, menu-bar-showhide-fringe-menu)
	(menu-bar-showhide-menu, menu-bar-tools-menu)
	(menu-bar-describe-menu, menu-bar-help-menu)
	(minibuffer-local-completion-map, minibuffer-local-map):
	Fix list quoting.

2009-09-17  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/bytecomp.el (byte-compile-form): Always check the function
	arguments, whether or not it has a handler.

	* ansi-color.el (ansi-color-get-face-1): Fix typo in handler.

	* simple.el (hard-newline): Give it a doc-string.

	* emacs-lisp/lisp-mode.el (emacs-lisp-mode-syntax-table):
	(lisp-mode-syntax-table): Give them doc-strings.

2009-09-17  Dan Nicolaescu  <dann@ics.uci.edu>

	* menu-bar.el (menu-bar-file-menu, menu-bar-file-menu)
	(menu-bar-i-search-menu, menu-bar-edit-menu, menu-bar-custom-menu)
	(menu-bar-options-menu, menu-bar-showhide-menu)
	(menu-bar-showhide-fringe-ind-menu, menu-bar-showhide-fringe-menu)
	(menu-bar-showhide-scroll-bar-menu, menu-bar-showhide-menu)
	(menu-bar-options-menu, menu-bar-line-wrapping-menu)
	(menu-bar-options-menu, menu-bar-tools-menu)
	(menu-bar-describe-menu, menu-bar-search-documentation-menu)
	(menu-bar-help-menu):
	(menu-bar-make-mm-toggle, menu-bar-make-toggle): Purecopy the
	string arguments.

	* ediff-hook.el (menu-bar-ediff-menu, menu-bar-ediff-merge-menu)
	(menu-bar-epatch-menu, menu-bar-ediff-misc-menu): Add purecopy
	calls for the menu names and :help.

2009-09-17  Stefan Monnier  <monnier@iro.umontreal.ca>

	* mouse.el (minor-mode-menu-from-indicator): Pay attention
	to :minor-mode-function (bug#4455).

2009-09-16  Stefan Monnier  <monnier@iro.umontreal.ca>

	* startup.el (command-line): Initialize the window-system after
	processing the command-line.

	* textmodes/page.el (what-page): Make sure we don't inf-loop if
	page-delimiter matches the empty string.

2009-09-16  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/bytecomp.el (byte-compile-not-obsolete-vars): Rename from
	byte-compile-not-obsolete-var.  It's a list now.
	(byte-compile-not-obsolete-funcs): New variable.
	(byte-compile-warn-obsolete): Don't warn about functions if they are in
	byte-compile-not-obsolete-funcs.
	(byte-compile-variable-ref, byte-compile-defvar): Update for
	byte-compile-not-obsolete-vars name-change and list nature.
	(byte-compile-maybe-guarded): Suppress warnings about obsolete functions
	and variables behind (f)boundp tests.
	* net/tramp-compat.el (byte-compile-not-obsolete-vars): Set if bound.

2009-09-15  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-git.el (vc-git-log-view-mode): Undo inadvertent change.

2009-09-15  Stefan Monnier  <monnier@iro.umontreal.ca>

	* Makefile.in (compile-onefile): Use byte-compile-refresh-preloaded.
	* emacs-lisp/bytecomp.el (byte-compile-refresh-preloaded):
	Don't autoload.

2009-09-15  Stephen Eglen  <stephen@gnu.org>

	* iswitchb.el (iswitchb-read-buffer): When selecting a match from
	the virtual-buffers, use the name of the buffer specified by
	find-file-noselect, as the match may be a symlink.  (This was a
	problem if the target and the symlink had different names.)

2009-09-15  Stefan Monnier  <monnier@iro.umontreal.ca>

	* custom.el (custom-initialize-default, custom-initialize-set): CSE.

	* desktop.el (desktop-path): Check user-emacs-directory.

	* emacs-lisp/bytecomp.el (byte-compile-refresh-preloaded): New function.

	* loadup.el: Use after-load-functions to GC after loading each file.
	Remove the explicit GC calls that used to be sprinkled around.

	* subr.el (after-load-functions): New hook.
	(do-after-load-evaluation): Run it.  Use string-match-p to detect
	`obsolete' packages, rather than painfully extracting the relevant
	directory name.

2009-09-15  Glenn Morris  <rgm@gnu.org>

	* apropos.el (apropos-documentation-check-doc-file): Avoid assignment to
	free variable `doc'.

	* dired.el (dired-mode-map): Add menu entry for async shell command.

	* help-fns.el (find-lisp-object-file-name): When looking for autoloaded
	variables, also consider the .elc files, since the .el files are
	normally gzipped (subsequent code locates the .el.gz from the .elc).

	* calc/calc-prog.el (arglist): Define for compiler.

	* calendar/diary-lib.el (diary-display-function): Change the default to
	fancy display.
	(body): Define for compiler.

	* emacs-lisp/bytecomp.el (byte-compile-keep-pending)
	(byte-compile-file-form, byte-compile-lambda)
	(byte-compile-top-level-body, byte-compile-form)
	(byte-compile-variable-ref, byte-compile-setq)
	(byte-compile-setq-default, byte-compile-body)
	(byte-compile-body-do-effect, byte-compile-and, byte-compile-or)
	(batch-byte-compile): Give some more local variables with common names
	a "bytecomp-" prefix to avoid masking warnings about free variables.

	* startup.el (command-line-1): Give local variables with common names a
	distinguishing prefix, so as not to hide free variable warnings during
	bootstrap.

	* mail/rmailmm.el (rmail-mime-save): If file exists, don't try to be
	clever and add a suffix to make a unique name, just let the user decide
	whether or not to overwrite it.  If the input is a directory, write the
	default filename to that directory.  (Bug#4388)
	(rmail-mime-bulk-handler): Ensure the save button's 'directory property
	is a filename-as-a-directory.

2009-09-15  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/page.el (what-page): Don't move to beginning of line.
	See <87tyz5ajte.fsf@x2.delysid.org> in emacs-devel.

2009-09-15  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-git.el (vc-git-dir-extra-headers): Show the remote location.

2009-09-14  Dan Nicolaescu  <dann@ics.uci.edu>

	* bindings.el (mode-line-mode-menu): Add purecopy calls for :help.
	* help.el (help-for-help-internal): Add purecopy calls for text.

	* vc.el (top): print-log method now takes an optional SHORTLOG
	argument.  Add a new method: root.
	(vc-root-diff, vc-print-root-log): New functions.
	(vc-log-short-style): New variable.
	(vc-print-log-internal): Add support for showing short logs.

	* vc-hooks.el (vc-prefix-map, vc-menu-map): Add bindings for
	vc-print-root-log and vc-print-root-diff.

	* vc-bzr.el (vc-bzr-log-view-mode, vc-bzr-print-log):
	* vc-git.el (vc-git-print-log, vc-git-log-view-mode):
	* vc-hg.el (vc-hg-print-log, vc-hg-log-view-mode): Add support for
	short logs.

	* vc-cvs.el (vc-cvs-print-log):
	* vc-mtn.el (vc-mtn-print-log):
	* vc-rcs.el (vc-rcs-print-log):
	* vc-sccs.el (vc-sccs-print-log):
	* vc-svn.el (vc-svn-print-log): Add an optional argument shortlog
	that is ignored for now.

	* vc-mtn.el (vc-mtn-annotate-command):
	* vc-svn.el (vc-svn-annotate-command): Run asynchronously.

2009-09-14  Stefan Monnier  <monnier@iro.umontreal.ca>

	* simple.el: Add mapping for backspace/delete/clear/tab/escape/return
	to function-key-map, and give them ascii-character property.
	* term/x-win.el (x-alternatives-map):
	* term/ns-win.el (ns-alternatives-map):
	* term/internal.el (msdos-key-remapping-map):
	* w32-fns.el (x-alternatives-map): Remove redundant mappings.

2009-09-14  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/elint.el (elint-add-required-env): Revert to not using
	temp-buffers (2009-09-12).

2009-09-13  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/ispell.el (ispell-command-loop): Improve last fix, using
	the new read-key function.

2009-09-13  Chong Yidong  <cyd@stupidchicken.com>

	* term/x-win.el (x-menu-bar-open): Only call accelerate-menu if it
	is defined (Bug#4405).

2009-09-13  Vincent Belaïche  <vincent.belaiche@gmail.com>

	* recentf.el (recentf-cleanup): Use a hash table to find
	duplicates (Bug#4407).

2009-09-13  Per Starbäck  <per@starback.se>  (tiny change)

	* textmodes/ispell.el (ispell-command-loop): Convert keys such as
	kp-0 to ascii equivalents (Bug#4325).

2009-09-13  Chong Yidong  <cyd@stupidchicken.com>

	* progmodes/cperl-mode.el (cperl-init-faces): Revert last change.

	* eshell/em-hist.el:
	* eshell/em-dirs.el (eshell-complete-user-reference):
	Declare pcomplete functions and variables to avoid compiler warnings.

2009-09-13  Leo  <sdl.web@gmail.com>  (tiny change)

	* eshell/em-script.el (eshell-login-script, eshell-rc-script):
	* eshell/em-dirs.el (eshell-last-dir-ring-file-name):
	* eshell/em-alias.el (eshell-aliases-file):
	* eshell/em-hist.el (eshell-history-file-name):
	Use expand-file-name instead of concat to make file names (Bug#4308).

2009-09-13  Glenn Morris  <rgm@gnu.org>

	* ediff-merg.el (ediff-do-merge):
	* filesets.el (filesets-run-cmd):
	* emulation/ws-mode.el (ws-show-markers, ws-move-block, ws-delete-block)
	(ws-find-marker-0, ws-find-marker-1, ws-find-marker-2, ws-find-marker-3)
	(ws-find-marker-4, ws-find-marker-5, ws-find-marker-6, ws-find-marker-7)
	(ws-find-marker-8, ws-find-marker-9, ws-goto-block-begin)
	(ws-goto-block-end, ws-goto-last-cursorposition, ws-copy-block):
	Replace empty `let's with `progn'.

2009-09-13  Stefan Monnier  <monnier@iro.umontreal.ca>

	* mail/sendmail.el (send-mail-function):
	* tooltip.el (tooltip-mode):
	* simple.el (transient-mark-mode):
	* rfn-eshadow.el (file-name-shadow-mode):
	* frame.el (blink-cursor-mode):
	* font-core.el (global-font-lock-mode):
	* files.el (temporary-file-directory)
	(small-temporary-file-directory, auto-save-file-name-transforms):
	* epa-hook.el (auto-encryption-mode):
	* composite.el (global-auto-composition-mode):
	Use custom-initialize-delay.
	* startup.el (command-line): Don't explicitly call
	custom-reevaluate-setting for all the above vars.
	* custom.el (custom-initialize-safe-set)
	(custom-initialize-safe-default): Delete.

2009-09-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* term/x-win.el (x-initialize-window-system):
	* term/w32-win.el (w32-initialize-window-system):
	* term/ns-win.el (ns-initialize-window-system): Don't call
	mouse-wheel-mode since it's enabled globally by default already.

	* mwheel.el (mouse-wheel-mode): Make sure the new defvar doesn't
	actually define the variable, but only silences the byte-compiler.
	(mouse-wheel-change-button): Check whether mouse-wheel-mode is bound
	before looking it up.
	(mouse-wheel-scroll-amount): Also reset the bindings if this value
	is changed.

2009-09-12  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/elint.el (elint-file): Make max-lisp-eval-depth at least
	1000.
	(elint-add-required-env): Don't beep on error.
	(elint-forms): In case of error, return ENV unchanged.
	(elint-init-env): Skip non-list forms.
	(elint-log): Handle unknown file positions.

2009-09-12  Daiki Ueno  <ueno@unixuser.org>

	* epg.el (epg-make-context): Add autoload cookie.
	(epg-list-keys, epg-cancel, epg-start-decrypt, epg-decrypt-file)
	(epg-decrypt-string, epg-start-verify, epg-verify-file)
	(epg-verify-string, epg-start-sign, epg-sign-file)
	(epg-sign-string, epg-start-encrypt, epg-encrypt-file)
	(epg-encrypt-string, epg-start-export-keys)
	(epg-export-keys-to-file, epg-export-keys-to-string)
	(epg-start-import-keys, epg-import-keys-from-file)
	(epg-import-keys-from-string, epg-start-receive-keys)
	(epg-receive-keys, epg-import-keys-from-server)
	(epg-start-delete-keys, epg-delete-keys, epg-start-sign-keys)
	(epg-sign-keys, epg-start-generate-key)
	(epg-generate-key-from-file, epg-generate-key-from-string):
	Remove autoload cookie.

2009-09-12  Eli Zaretskii  <eliz@gnu.org>

	* dos-fns.el (dos-reevaluate-defcustoms): Comment out the
	reevaluation of trash-directory.

	* mwheel.el: Fix last change.
	(mouse-wheel-mode): New defvar.
	(mouse-wheel-mode): Remove autoload cookie.

2009-09-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* mwheel.el (mwheel-installed-bindings): New var.
	(mouse-wheel-mode): Use it, so as to make sure we really remove all
	the bindings we set last time.  Use custom-initialize-delay.
	* loadup.el: Load mwheel after term/*-win.el.
	* startup.el (command-line): Don't reevaluate mouse-wheel-down-event
	and mouse-wheel-up-event now that their first evaluation is done
	sufficiently late to be correct.

	* startup.el (tutorial-directory): Make it a defcustom.
	Use custom-initialize-delay rather than eval-at-startup to set it.
	* image.el (image-load-path): Make it a defcustom.
	Use custom-initialize-delay rather than eval-at-startup to set it.
	* subr.el (eval-at-startup): Remove.
	* font-lock.el (lisp-font-lock-keywords-2): Remove eval-at-startup.

	* subr.el (do-after-load-evaluation): Warn the user after loading an
	obsolete package.

2009-09-12  Glenn Morris  <rgm@gnu.org>

	* proced.el (proced-mark-alt): Remove alias.
	(proced-mode-map): Remove proced-mark-alt.

	* emacs-lisp/lisp-mode.el (emacs-lisp-mode-map): Add menu entries to
	Elint file and directory.  Remove initialization entry.

	* emacs-lisp/elint.el (elint-file, elint-directory): New autoloaded
	commands.
	(elint-current-buffer): Set mode-line-process.
	(elint-init-env): Handle define-derived-mode.
	Fix declare-function with unspecified arglist.  Guard against odd
	defalias statements (eg iso-insert's 8859-1-map).
	(elint-add-required-env): Use a temp buffer.
	(elint-form): Just print the function/macro name, not the whole form.
	Return env unchanged if we fail to parse a macro.
	(elint-forms): Guard against parse errors.
	(elint-output): New function, to handle batch mode.
	(elint-log-message): Add optional argument.  Use elint-output.
	(elint-set-mode-line): New function.

2009-09-12  Andreas Politz  <politza@fh-trier.de>  (tiny change)

	* emacs-lisp/elp.el (elp-not-profilable): Add more
	functions (Bug#4233).

2009-09-12  Chong Yidong  <cyd@stupidchicken.com>

	* emulation/pc-select.el (scroll-down-mark, scroll-down-nomark)
	(scroll-up-mark, scroll-up-nomark): Doc fix (Bug#4190).

2009-09-11  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-mi.el (gdb-var-list-children-regexp): Delete.
	(gdb-var-list-children): Use json parsing.

2009-09-11  Daniel Colascione  <dan.colascione@gmail.com>

	* progmodes/js.el (js--proper-indentation): Handle the case where
	char-before is null.  Reported by Deniz Dogan.

2009-09-11  Juanma Barranquero  <lekktu@gmail.com>

	* emacs-lisp/cl-macs.el (help-add-fundoc-usage): Declare.

2009-09-11  Daiki Ueno  <ueno@unixuser.org>

	* epg.el (epg-cipher-algorithm-alist): Add CAMELLIA.
	(epg-digest-algorithm-alist): Add SHA224.
	(epg-context-set-passphrase-callback)
	(epg-context-set-progress-callback): Add description about
	callback function.

2009-09-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* custom.el (custom-delayed-init-variables): New var.
	(custom-initialize-delay): New function.
	* startup.el (command-line): "Re"evaluate all vars in
	custom-delayed-init-variables.  Don't reevaluate abbrev-file-name
	explicitly any more.
	* abbrev.el (abbrev-file-name): Use custom-initialize-delay
	to avoid creating a ~/.emacs.d at build-time (bug#4347).

	* proced.el (proced-mode-map): Prefer "m" for proced-mark (bug#4362).

2009-09-11  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-mi.el (gdb-var-update-regexp): Delete.
	(gdb-var-update-handler): Use json parsing.

2009-09-11  Juanma Barranquero  <lekktu@gmail.com>

	* vc-annotate.el (vc-annotate): Use the main file's coding-system to
	decode annotated text, regardless of language environment.  (Bug#2741)

2009-09-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* Makefile.in (autoloads): Make rmail.el writable as well.

2009-09-11  Glenn Morris  <rgm@gnu.org>

	* dired-aux.el, dired-x.el: Put autoloads in dired.el rather than
	loaddefs.el.
	* dired.el: Regenerate with extracted autoloads.
	* Makefile.in (autoloads): Make dired.el writable.

	* ibuf-ext.el: Put autoloads in ibuffer.el rather than loaddefs.el.
	* ibuffer.el: Regenerate with extracted autoloads.
	* Makefile.in (autoloads): Make ibuffer.el writable.

	* paths.el (prune-directory-list, gnus-nntp-service, rmail-file-name):
	* version.el (emacs-copyright, emacs-major-version)
	(emacs-minor-version): Reformat doc-strings for make-docfile.

	* apropos.el (apropos-documentation-check-doc-file): Exclude unbound
	functions and variables, since they must be stuff specific to some other
	platform.
	(apropos-print): Make mouse-click message less specific about button.

	* emacs-lisp/cl-macs.el (define-compiler-macro): Add a property
	that records where a macro was defined.
	* help-fns.el (describe-function-1): Mention if a function has a
	compiler-macro.
	* help-mode.el (help-function-cmacro): New button.

	* locate.el (top-level): Always require dired.
	(locate-mode-map): Initialize inside the defvar.

	* net/ange-ftp.el (dired-compress-file): Declare.
	(ange-ftp-dired-compress-file): Add doc string.

	* term/ns-win.el (x-display-name, x-setup-function-keys):
	Unify doc-strings with X versions.

2009-09-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emulation/crisp.el (crisp-mode-map): Move initialization
	into declaration.
	(crisp-mode): Use define-minor-mode.

	* progmodes/xscheme.el (xscheme-evaluation-commands):
	Put a :advertised-binding property rather than using
	advertised-xscheme-send-previous-expression.
	(advertised-xscheme-send-previous-expression): Declare obsolete.
	* emulation/crisp.el (crisp-mode-map): Use `undo' rather than
	`advertised-undo'.
	(crisp-mode): Add corresponding bindings to
	undo's :advertised-binding instead.
	* dired.el (dired-mode-map): Put a :advertised-binding property rather
	than using dired-advertised-find-file.
	(dired-advertised-find-file):
	* simple.el (advertised-undo):
	* wid-edit.el (advertised-widget-backward): Declare obsolete.
	(widget-keymap): Put a :advertised-binding property rather
	than using advertised-widget-backward.
	* bindings.el (ctl-x-map): Put a :advertised-binding property rather
	than using advertised-undo.
	* tutorial.el (tutorial--default-keys): Adjust accordingly.

2009-09-10  Simon South  <ssouth@slowcomputing.org>

	* progmodes/delphi.el (delphi-tab): Indent region when Transient
	Mark mode is enabled and region is active; otherwise indent or
	insert TAB as usual.
	(delphi-mode): Update description of TAB-key binding.

2009-09-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* subr.el (define-key-rebound-commands): Mark obsolete.
	* startup.el (precompute-menubar-bindings): Remove.
	(normal-top-level): Remove obsolete code that tried to precompute
	menubar bindings.
	* loadup.el (define-key-rebound-commands): Don't bother fiddling with
	define-key-rebound-commands and precompute-menubar-bindings.

2009-09-10  Teodor Zlatanov  <tzz@lifelogs.com>

	* net/imap.el (imap-interactive-login): Better messages.
	(imap-open): Fix bug with renamed buffer on reconnect.
	(imap-authenticate): Add buffer-local imap-last-authenticator variable
	for easier debugging and cleaner code.  On successful (guessed based on
	server capabilities) secondary authentication, set imap-state
	correctly.
	(imap-last-authenticator): Define imap-last-authenticator as a variable
	to avoid warnings.

2009-09-10  Glenn Morris  <rgm@gnu.org>

	* pcvs.el (cvs-mode-find-file): Use forward-line rather than goto-line.

	* emacs-lisp/bytecomp.el (byte-compile-function-environment): Doc fix.
	(byte-compile-file-form-autoload): Don't warn about unknown functions
	where the autoload statement comes after the use.
	(with-no-warnings): Give it a byte-hunk-handler like than of progn, so
	that any handlers inside the body (eg require) are in turn respected.

	* emacs-lisp/byte-opt.el (degrees-to-radians): Mark as free from side
	effects.

	* emacs-lisp/derived.el (define-derived-mode): Give the mode's map,
	and syntax and abbrev tables basic docs, if they don't have any.

	* emacs-lisp/easy-mmode.el (easy-mmode-defmap): Add doc-string.

	* international/mule-cmds.el (top-level): Require cl when compiling.
	(view-hello-file): Use default-value rather than
	default-enable-multibyte-characters.

	* progmodes/fortran.el: Move all safe and risky properties into the
	defcustoms.

	* mail/rmailedit.el, mail/rmailkwd.el, mail/rmailmm.el:
	* mail/rmailmsc.el, mail/rmailsort.el, mail/rmailsum.el:
	* mail/undigest.el:
	Put autoloads in rmail.el rather than loaddefs.el.
	* mail/rmail.el: Regenerate with extracted autoloads.

	* mail/rmailsum.el (rmail-user-mail-address-regexp): Move to rmail.el.
	* mail/rmail.el (rmail-user-mail-address-regexp): Move from rmailsum.el.

2009-09-10  Nick Roberts  <nickrob@snap.net.nz>

	Reported in thread for Bug#4375.
	* progmodes/gud.el (gud-tooltip-print-command): Use MI command
	"-data-evaluate-expression" instead of print.
	* progmodes/gdb-mi.el (gdb-tooltip-print-1): Ditto.
	(gdb-tooltip-print): Parse output from above MI command.
	(gdb): Revert 2009-08-11 change.  User should detach inferior
	manually.

	Remove the word "separate" from IO functions as inferior
	output is now never displayed in the GUD buffer.

2009-09-10  Juanma Barranquero  <lekktu@gmail.com>

	* startup.el (command-line-normalize-file-name): On Windows and
	MS-DOS, also convert C:\/ and C:\\ (two backslashes) into C:/.

2009-09-10  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-text-char-description): Propertize escape
	character sequences with the `escape-glyph' face.  (Bug#4344)

	* simple.el (shell-command): Set asynchronous process filter to
	`comint-output-filter'.  (Bug#4343)

	* progmodes/grep.el (grep-template): Add "<X>" to docstring.
	(grep-files-aliases): Add "all".  Move "el" and "ch" to the top of
	the list.  Move "asm" to the bottom.
	(grep-find-ignored-directories): Add `choice' with nil value
	to empty the list easily.
	(grep-find-ignored-files): New option.
	(grep-files-history): Set to nil by default instead of '("ch" "el").
	(grep-compute-defaults): Add "<X>" to `grep-template'.
	(grep-read-files): Bind new local variables `default-alias' and
	`default-extension'.  Use a list of default values for the file prompt.
	(lgrep): Add `--exclude=' command line options composed from
	`grep-find-ignored-files'.
	(rgrep): Add `-name' command line options composed from
	`grep-find-ignored-files'.  (Bug#4301)

2009-09-09  Stefan Monnier  <monnier@iro.umontreal.ca>

	* diff-mode.el (diff-hunk-kill): Fix the search of the next hunk
	(bug#4368).

2009-09-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* calendar/time-date.el (autoload):
	Expand define-obsolete-function-alias into defalias and make-obsolete
	for old Emacsen that Gnus supports.
	(with-no-warnings): Define it for old Emacsen.
	(time-to-seconds): Don't use (featurep 'xemacs) to check if float-time
	is available.
	(time-to-number-of-days): Don't use (featurep 'xemacs) to check if
	float-time is available; suppress compile warning for time-to-seconds.

2009-09-09  Teodor Zlatanov  <tzz@lifelogs.com>

	* net/imap.el (imap-message-map): Docstring fix.

2009-09-09  Glenn Morris  <rgm@gnu.org>

	* ffap.el (ffap-file-at-point): Handle absolute (non-remote) files with
	line numbers too.  (Bug#4374)

2009-09-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* smerge-mode.el (smerge-remove-props, smerge-refine):
	Use with-silent-modifications (bug#4342).

	* subr.el (with-silent-modifications): New macro.

2009-09-07  Juanma Barranquero  <lekktu@gmail.com>

	* files.el (top-level): Require `cl' when compiling.

2009-09-07  Glenn Morris  <rgm@gnu.org>

	* files.el (auto-mode-alist): Use delphi-mode for .dpr files.

	* proced.el (proced-mode-map): Bind "d" to proced-mark-alt.
	(proced-mark-alt): New alias, to control the advertised key.  (Bug#4362)

2009-09-06  Nick Roberts  <nickrob@snap.net.nz>

	* vc-git.el (vc-git-annotate-command): Use separator to parse
	arguments correctly.

2009-09-06  Eli Zaretskii  <eliz@gnu.org>

	* proced.el (proced-mode): Doc fix.

2009-09-06  Julian Scheid  <julians37@gmail.com>  (tiny change)

	* net/tramp.el (tramp-perl-file-attributes): Print "nil" when
	lstat fails.
	(tramp-do-file-attributes-with-ls): Check for file existence at
	remote end.
	(tramp-do-file-attributes-with-stat): Likewise.
	(tramp-convert-file-attributes): Return nil when attr is nil.

2009-09-05  Glenn Morris  <rgm@gnu.org>

	* calendar/diary-lib.el (diary-entry): Add help-echo and follow-link
	properties to this button.
	(diary-fancy-display): Don't extend the button to the final newline.
	(diary-fancy-display-mode): Continue to define "q" as a local key.

	* calendar/cal-china.el (holiday-chinese): Make it slightly more
	efficient.

	* font-lock.el (lisp-font-lock-keywords-2): Add letf.

	* emacs-lisp/bytecomp.el (emacs-lisp-file-regexp): Doc fix.
	(byte-compile-dest-file-function): New option.
	(byte-compile-dest-file): Doc fix.
	Obey byte-compile-dest-file-function.
	(byte-compile-cl-file-p): New function.
	(byte-compile-eval): Only suppress noruntime warnings about cl functions
	if the cl-functions warning is enabled.  Use byte-compile-cl-file-p.
	(byte-compile-eval): Check for non-nil byte-compile-cl-functions rather
	than for file being previously loaded.
	(byte-compile-find-cl-functions): Use byte-compile-cl-file-p.
	(byte-compile-file-form-require): Handle the case where requiring a file
	indirectly causes CL to be loaded.

2009-09-05  Karl Fogel  <kfogel@red-bean.com>

	* files.el (find-alternate-file): Run `kill-buffer-hook' manually
	before killing the old buffer, since by the time `kill-buffer' is
	run so many buffer variables have been set to nil that it may not
	behave as expected.  (Bug#4061)

2009-09-05  Karl Fogel  <kfogel@red-bean.com>

	* files.el (find-alternate-file): If the old buffer is modified
	and visiting a file, behave similarly to `kill-buffer' when
	killing it, thus reverting to the pre-1.878 behavior; see
	http://lists.gnu.org/archive/html/emacs-devel/2009-09/msg00101.html
	for discussion.  Also, consult `buffer-file-name' as a variable
	not as a function, for consistency with the rest of the code.

2009-09-04  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-handle-insert-directory): Handle "--dired"
	also when adding a new directory.

	* net/tramp-compat.el (tramp-compat-line-beginning-position): New
	defun.

2009-09-04  Stefan Monnier  <monnier@iro.umontreal.ca>

	* files.el (locate-file-completion-table): Make it provide boundary
	information, so partial-completion works better.

2009-09-04  Leo  <sdl.web@gmail.com>  (tiny change)

	* mail/footnote.el (Footnote-text-under-cursor):
	Check footnote-text-marker-alist before using it (bug#4324).

2009-09-04  Glenn Morris  <rgm@gnu.org>

	* play/5x5.el, play/decipher.el, play/gametree.el, play/handwrite.el:
	* play/hanoi.el, play/landmark.el, play/mpuz.el, play/pong.el:
	* play/solitaire.el, play/tetris.el:
	Remove leading * from defcustom and defface docs.

	* calendar/diary-lib.el (diary-fancy-display): Only switch modes if
	necessary.
	(diary-fancy-overriding-map): New variable.
	(diary-fancy-display-mode): Set minor-mode-overriding-map-alist.
	Use view-mode.

	* vc-rcs.el (vc-rcs-annotate-command): Use forward-line rather than
	goto-line.

2009-09-03  Glenn Morris  <rgm@gnu.org>

	* arc-mode.el (archive-mode):
	* dos-fns.el (set-default-process-coding-system):
	* man.el (Man-getpage-in-background):
	* menu-bar.el (menu-bar-describe-menu):
	* server.el (server-process-filter):
	* startup.el (command-line):
	* tar-mode.el (tar-header-block-tokenize, tar-extract):
	* w32-fns.el (set-default-process-coding-system):
	* x-dnd.el (x-dnd-handle-file-name):
	* international/mule-cmds.el (mule-menu-keymap)
	(set-default-coding-systems, language-info-alist, set-language-info)
	(set-language-environment, standard-display-european-internal)
	(set-locale-environment):
	* international/mule-diag.el (mule-diag):
	* mail/emacsbug.el (report-emacs-bug):
	* mail/rmail.el (rmail-mode):
	* mail/sendmail.el (mail-setup):
	Use default-value rather than default-enable-multibyte-characters.

	* progmodes/f90.el: Move all safe properties into the defcustoms.
	(f90-get-correct-indent, f90-indent-region, f90-abbrev-start): Use memq.

	* calendar/appt.el (appt-check):
	* calendar/diary-lib.el (diary-set-header, diary-live-p)
	(diary-check-diary-file, diary-list-entries)
	(diary-include-other-diary-files, diary-simple-display)
	(diary-fancy-display, diary-print-entries)
	(diary-mark-included-diary-files, diary-make-entry):
	Don't call substitute-in-file-name on diary-file.

2009-09-03  Eduard Wiebe  <usenet@pusto.de>
            Stefan Monnier  <monnier@iro.umontreal.ca>

	* mail/footnote.el (footnote-prefix): Make it a defcustom.
	(footnote-mode-map): Move initialization into the declaration.
	(footnote-minor-mode-map): Define it rather than changing global-map.
	(footnote-mode): Use define-minor-mode.

2009-09-02  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-handle-file-attributes-with-ls)
	(tramp-do-file-attributes-with-perl)
	(tramp-do-file-attributes-with-stat): Rename from
	`tramp-handle-file-attributes-with-*'.
	(tramp-handle-file-attributes): Use them.
	(tramp-do-directory-files-and-attributes-with-perl)
	(tramp-do-directory-files-and-attributes-with-stat): Rename from
	`tramp-handle-directory-files-and-attributes-with-*'.
	(tramp-handle-directory-files-and-attributes): Use them.
	(tramp-method-out-of-band-p): Additional parameter SIZE.
	(tramp-do-copy-or-rename-file, tramp-handle-file-local-copy)
	(tramp-handle-write-region): Use it.
	(tramp-handle-insert-directory): Use "?\ " for compatibility reasons.
	(tramp-handle-vc-registered): Check, whether the first run did
	return files to be tested.
	(tramp-advice-make-auto-save-file-name): Do not call directly
	`tramp-handle-make-auto-save-file-name', because this would bypass
	the locking mechanism.

	* net/tramp-compat.el (top): Autoload used functions from tramp.el.
	(file-remote-p, process-file, start-file-process, set-file-times)
	(tramp-compat-file-attributes): Compatibility functions shall not
	call directly `tramp-handle-*', because this would bypass the
	locking mechanism.
	(tramp-compat-number-sequence): New defun.

2009-09-02  Glenn Morris  <rgm@gnu.org>

	* calendar/time-date.el (time-to-seconds): In Emacs, make it an obsolete
	alias for float-time.
	(time-to-number-of-days): In Emacs, use float-time.
	* net/newst-backend.el (time-add): Suppress warnings from compat
	function.
	* time.el (emacs-uptime, emacs-init-time):
	* net/rcirc.el (rcirc-keepalive, rcirc-handler-ctcp-KEEPALIVE):
	Use float-time rather than time-to-seconds.

	* minibuffer.el (completion-initials-expand): Fix typo.

	* faces.el (modeline, modeline-inactive, modeline-highlight)
	(modeline-buffer-id):
	* info.el (info-menu-5): Mark these face aliases as obsolete.

2009-09-01  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-mi.el (gdb-current-context-command): Move the
	space ...
	(gdb-gud-context-call): ... to here for pre GDB 7.0 when there is
	no "--thread" option.
	(gdb-stopped): Don't print "Switched to thread" message when it is
	unchanged.

2009-09-01  Stefan Monnier  <monnier@iro.umontreal.ca>

	* minibuffer.el (completion-try-completion)
	(completion-all-completions): Remove ill-defined (and
	mistakenly installed and luckily never used nor documented)
	`completion-styles' property.
	(completion-initials-expand, completion-initials-all-completions)
	(completion-initials-try-completion): New functions.
	(completion-styles-alist): Add doc to each entry.
	Add new `initials' entry.

2009-09-01  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-mi.el (gdb-var-create-handler): Remove redundant
	MI command -var-evaluate-expression.
	(gdb-var-list-children-regexp): Update from regexp-1 in gdb-ui.el
	and tweak for case of string child.
	(gdb-var-list-children-handler): Update from handler-1 in gdb-ui.el.

2009-09-01  Glenn Morris  <rgm@gnu.org>

	* add-log.el (change-log-date-face, change-log-name-face)
	(change-log-email-face, change-log-file-face, change-log-list-face)
	(change-log-conditionals-face, change-log-function-face)
	(change-log-acknowledgement-face):
	* cus-edit.el (custom-invalid-face, custom-rogue-face)
	(custom-modified-face, custom-set-face, custom-changed-face)
	(custom-saved-face, custom-button-face, custom-button-pressed-face)
	(custom-documentation-face, custom-state-face, custom-comment-face)
	(custom-comment-tag-face, custom-variable-tag-face)
	(custom-variable-button-face, custom-face-tag-face)
	(custom-group-tag-face-1, custom-group-tag-face):
	* diff-mode.el (diff-header-face, diff-file-header-face)
	(diff-index-face, diff-hunk-header-face, diff-removed-face)
	(diff-added-face, diff-changed-face, diff-function-face)
	(diff-context-face, diff-nonexistent-face):
	* generic-x.el (show-tabs-tab-face, show-tabs-space-face):
	* hilit-chg.el (highlight-changes-face, highlight-changes-delete-face):
	* info.el (Info-title-1-face, Info-title-2-face, Info-title-3-face)
	(Info-title-4-face):
	* isearch.el (isearch-lazy-highlight-face):
	* log-view.el (log-view-file-face, log-view-message-face):
	* paren.el (show-paren-match-face, show-paren-mismatch-face):
	* pcvs-info.el (cvs-header-face, cvs-filename-face, cvs-unknown-face)
	(cvs-handled-face, cvs-need-action-face, cvs-marked-face)
	(cvs-msg-face):
	* smerge-mode.el (smerge-mine-face, smerge-other-face)
	(smerge-base-face, smerge-markers-face):
	* wid-edit.el (widget-documentation-face, widget-button-face)
	(widget-field-face, widget-single-line-field-face)
	(widget-inactive-face, widget-button-pressed-face):
	* woman.el (woman-italic-face, woman-bold-face, woman-unknown-face)
	(woman-addition-face):
	* eshell/em-ls.el (eshell-ls-directory-face, eshell-ls-symlink-face)
	(eshell-ls-executable-face, eshell-ls-readonly-face)
	(eshell-ls-unreadable-face, eshell-ls-special-face)
	(eshell-ls-missing-face, eshell-ls-archive-face)
	(eshell-ls-backup-face, eshell-ls-product-face)
	(eshell-ls-clutter-face):
	* eshell/em-prompt.el (eshell-prompt-face):
	* eshell/esh-test.el (eshell-test-ok-face, eshell-test-failed-face):
	* obsolete/old-whitespace.el (whitespace-highlight-face):
	* progmodes/antlr-mode.el (antlr-font-lock-default-face)
	(antlr-font-lock-keyword-face, antlr-font-lock-syntax-face)
	(antlr-font-lock-ruledef-face, antlr-font-lock-tokendef-face)
	(antlr-font-lock-ruleref-face, antlr-font-lock-tokenref-face)
	(antlr-font-lock-literal-face):
	* progmodes/ebrowse.el (ebrowse-tree-mark-face)
	(ebrowse-root-class-face, ebrowse-file-name-face)
	(ebrowse-default-face, ebrowse-member-attribute-face)
	(ebrowse-member-class-face, ebrowse-progress-face):
	* progmodes/make-mode.el (makefile-space-face):
	* progmodes/sh-script.el (sh-heredoc-face):
	* textmodes/flyspell.el (flyspell-incorrect-face)
	(flyspell-duplicate-face):
	* textmodes/tex-mode.el (tex-math-face, tex-verbatim-face):
	* textmodes/texinfo.el (texinfo-heading-face):
	Mark face aliases with "-face" suffix as obsolete.

	* mail/feedmail.el (file-name-buffer-file-type-alist): Define for
	compiler.

	* net/eudc-bob.el (eudc-bob-generic-menu, eudc-bob-image-menu)
	(eudc-bob-sound-menu): Use defvar rather than defconst, since
	easy-menu-define wants to modify these.

	* net/net-utils.el (nslookup): Use make-comint rather than comint-run.

	* net/browse-url.el (browse-url-file-url):
	* term/internal.el (dos-codepage-setup):
	Use default-value rather than default-enable-multibyte-characters.

	* progmodes/etags.el (etags-goto-tag-location):
	* progmodes/flymake.el (flymake-highlight-line)
	(flymake-goto-file-and-line, flymake-goto-line):
	* progmodes/gdb-mi.el (gdb-mouse-until, gdb-mouse-jump)
	(gdb-goto-breakpoint):
	* progmodes/idlw-shell.el (idlwave-shell-move-to-bp):
	* progmodes/python.el (python-find-function)
	(python-pdbtrack-track-stack-file):
	* progmodes/verilog-mode.el (verilog-surelint-off):
	* term/ns-win.el (ns-open-file-select-line):
	* textmodes/bibtex.el (bibtex-validate, bibtex-validate-globally):
	Use forward-line rather than goto-line.

	* textmodes/reftex-cite.el (reftex-offer-bib-menu):
	* textmodes/reftex-index.el (reftex-display-index):
	* textmodes/reftex-ref.el (reftex-offer-label-menu):
	* textmodes/reftex-toc.el (reftex-toc):
	Remove unnecessary bindings of default-major-mode (all are followed by
	major-mode check and possible mode switch).

2009-08-31  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-mi.el (gdb-breakpoints-list-handler-custom):
	Handle watchpoints (bug#4282).
	(def-gdb-thread-buffer-command): Enable thread to be selected by
	clicking without selecting threads buffer first.
	(gdb-current-context-command): Use selected frame so that "up",
	"down" etc work in the GUD buffer.
	(gdb-update): Find selected frame before rendering stack buffer.
	(gdb-frame-handler): Set gdb-frame-number for stack buffer.

2009-08-31  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/sym-comp.el (displayed-completions): Remove.
	(symbol-complete): Use minibuffer-complete.

2009-08-31  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/byte-run.el (define-obsolete-face-alias): New macro.

	* apropos.el (apropos-symbols-internal):
	Handle (obsolete) face aliases.

	* faces.el (describe-face): Adjust the output format to be more like
	describe-variable, and to mention (obsolete) face aliases.
	Adjust the whitespace so that help-setup-xref works.

	* calendar/calendar.el (calendar-today-face, diary-face, holiday-face):
	* calendar/diary-lib.el (diary-button-face):
	Mark these face aliases as obsolete.

	* calendar/calendar.el (calendar-today): Doc fix.

2009-08-31  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-mi.el (gdb-control-all-threads)
	(gdb-control-current-thread): Force tool bar update.
	(gdb-non-stop-handler): New function.
	(gdb-init-1): Use it to test if non-stop mode is supported.
	Remove unused gdbmi buffer type.

2009-08-30  Kevin Rodgers  <kevin.d.rodgers@gmail.com>

	* progmodes/grep.el (grep-read-files): Strip trailing <N> from
	buffer names not visiting a file (e.g. cloned buffers).  (Bug#4210)

2009-08-30  Nick Roberts  <nickrob@snap.net.nz>

	* comint.el (comint-exec-1): Check command is non-null first.
	Part of gdb-mi.el change (2009-08-28).

2009-08-30  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/lisp.el (lisp-complete-symbol): Use minibuffer-complete.

2009-08-30  Juanma Barranquero  <lekktu@gmail.com>

	* subr.el (do-after-load-evaluation): Fix last change: use `mapc'
	instead of `dolist' to avoid a recursive require when bootstrapping.

2009-08-30  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/lisp.el (field-complete): Use minibuffer-complete.

	* net/ldap.el (ldap-search-internal): Use with-current-buffer and push.

	* net/imap.el (imap-send-command): Simplify.
	(imap-wait-for-tag): point-max -> buffer-size.

	* net/ange-ftp.el (internal-ange-ftp-mode): Use define-derived-mode.

	* emacs-lisp/easy-mmode.el (define-minor-mode): Don't use symbol-value
	with constant argument.

	* emacs-lisp/debug.el (debugger-setup-buffer): Make it multibyte.

	* emacs-lisp/cl.el (cl-macro-environment): Don't define it here.

	* emacs-lisp/checkdoc.el (checkdoc-force-history-flag):
	Change default, since most of our files don't have a history.
	(checkdoc-display-status-buffer): Don't use a hidden buffer to show to
	the user.

	* emacs-lisp/bytecomp.el (byte-compile-interactive-only-functions):
	Add comint-run.

	* calc/calc.el: Improve commenting convention.
	(calc-digit-map, toplevel): Simplify.

	* comint.el (comint-insert-input): Be careful to only set point if we
	don't delegate to some other command.

	* proced.el (proced-signal-list): Make it an alist.
	(proced-grammar-alist): Capitalize names.
	(proced-send-signal): Use a non-hidden buffer (since it's displayed).
	Disable undo manually and make it read-only.
	Use completion-annotate-function.

	* minibuffer.el (minibuffer-message): If the current buffer is not
	a minibuffer, insert the message in the echo area rather than at the
	end of the buffer.
	(completion-annotate-function): New variable.
	(minibuffer-completion-help): Use it.
	(completion--embedded-envvar-table): Environment vars are
	always case-sensitive.

2009-08-30  Glenn Morris  <rgm@gnu.org>

	* progmodes/fortran.el (fortran-start-prog-re): New constant, extracted
	from fortran-current-defun.
	(fortran-beginning-of-subprogram): Be more precise about finding the
	start, to avoid an infinite loop in end-of-defun.  (Bug#4259)
	(fortran-end-of-subprogram): Simplify.
	(fortran-current-defun): Use fortran-start-prog-re.

2009-08-29  Juanma Barranquero  <lekktu@gmail.com>

	* subr.el (do-after-load-evaluation): Simplify.

2009-08-29  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc.el (vc-print-log-internal): Move RCS/CVS specific code ...

	* vc-rcs.el (vc-rcs-print-log-cleanup): ... here.  New function.
	(vc-rcs-print-log): Use it.

	* vc-cvs.el (vc-cvs-print-log): Use vc-rcs-print-log-cleanup.

2009-08-29  Stefan Monnier  <monnier@iro.umontreal.ca>

	* paths.el (abbrev-file-name): Move to abbrev.el.
	* abbrev.el (abbrev-file-name): Move from paths.el.
	Obey user-emacs-directory.
	* calc/calc.el (calc-settings-file): Don't autoload and instead obey
	user-emacs-directory.
	* dos-fns.el (dos-reevaluate-defcustoms): Don't reevaluate
	abbrev-file-name and calc-settings-file any more.
	* startup.el (command-line): Recompute abbrev-file-name and
	abbreviated-home-dir.
	(normal-no-mouse-startup-screen): Improve the generic code and get rid
	of the special code for when C-h bindings haven't been changed.
	(display-startup-echo-area-message): Use with-current-buffer.
	(command-line-1): Use a list of strings, rather than a list of lists
	of strings for longopts.

	* files.el (get-free-disk-space): Use / for default-directory.

	* textmodes/ispell.el (ispell-accept-output, ispell-command-loop):
	Use with-current-buffer.

	* emacs-lisp/bytecomp.el (byte-compile-const-symbol-p):
	Recognize immutable variables like most-positive-fixnum.
	(byte-compile-setq-default): Check and warn if trying to assign
	to an immutable variable, or a non-variable.

	* progmodes/cc-vars.el (c-comment-continuation-stars):
	* progmodes/cc-engine.el (c-looking-at-bos):
	* progmodes/cc-cmds.el (c-toggle-auto-state)
	(c-forward-into-nomenclature, c-backward-into-nomenclature)
	(c-comment-line-break-function): Add version of obsolescence.

2009-08-28  Juri Linkov  <juri@jurta.org>

	* files.el (magic-fallback-mode-alist): Add ZIP magic number
	associated with `archive-mode'.

	* image.el (image-type-header-regexps): Use only JPEG magic number
	to determine JPEG images, and don't use `image-jpeg-p' because
	Emacs can display non-JFIF non-Exif JPEG images.

2009-08-28  Juanma Barranquero  <lekktu@gmail.com>

	* arc-mode.el (archive-mode):
	* emacs-lisp/re-builder.el (re-builder-unload-function):
	Protect against the default value of `major-mode' being nil.

2009-08-28  Juanma Barranquero  <lekktu@gmail.com>

	* international/ucs-normalize.el (ucs-normalize-sort, quick-check-list):
	Fix typos in docstrings.

	* progmodes/js.el (js--macro-decl-re): Doc fix.
	(js--plain-method-re, js--split-name): Refloc docstring.
	(js--class-styles, js--make-merged-item, js--splice-into-items):
	Fix typos in docstrings; reflow docstrings.
	(js--maybe-join, js--function-prologue-beginning, js--flush-caches)
	(js--variable-decl-matcher, js--inside-pitem-p)
	(js--parse-state-at-point, js--get-all-known-symbols)
	(js--symbol-history, js-find-symbol, js--js-references)
	(js--moz-interactor, js--js-encode-value, js--read-tab):
	Fix typos in docstrings.

2009-08-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/reftex.el (reftex-get-file-buffer-force):
	* progmodes/verilog-mode.el (verilog-batch-execute-func):
	* emulation/viper.el (viper-go-away, viper-set-hooks):
	* emacs-lisp/re-builder.el (re-builder-unload-function):
	* emacs-lisp/bytecomp.el (byte-compile-file):
	* ses.el (ses-unload-function):
	* hexl.el (hexl-find-file):
	* files.el (normal-mode):
	* ehelp.el (with-electric-help):
	* autoinsert.el (auto-insert-alist):
	* arc-mode.el (archive-mode):
	Use (default-value 'major-mode) instead of default-major-mode.

	* textmodes/ispell.el (ispell-check-version, ispell-send-string):
	* international/mule.el (load-with-code-conversion):
	* emacs-lisp/debug.el (debug):
	* ediff-vers.el (ediff-rcs-get-output-buffer):
	* dired.el (dired-internal-noselect): Don't let-bind
	default-major-mode around code that doesn't use it.
	E.g. buffer creation via get-buffer-create doesn't use it.

2009-08-28  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (all): Replace "'(lambda" by "(lambda".
	(tramp-handle-file-local-copy): Unset `file-name-handler-alist'
	when writing the temp file.  Otherwise, epa-file gets confused.
	(tramp-register-file-name-handlers): Make it a defun.  Move also
	`epa-file-handler' to the front of `file-name-handler-alist'.

2009-08-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* net/tramp.el (tramp-shell-prompt-pattern): Allow a prompt to
	start right after a ^M.
	(tramp-root-regexp, tramp-completion-file-name-regexp-unified)
	(tramp-completion-file-name-regexp-separate)
	(tramp-completion-file-name-regexp-url): Use \\` and \\'.
	(tramp-handle-file-attributes, tramp-set-file-uid-gid):
	Don't modify last-coding-system-used by accident.
	(tramp-completion-file-name-handler): Apply the checks here,
	instead during registration.
	(tramp-register-file-name-handlers): Renamed from
	`tramp-register-file-name-handler'.  Register both
	`tramp-file-name-handler' and `tramp-completion-file-name-handler'.
	(tramp-register-completion-file-name-handler): Remove.  (Bug#4260)

2009-08-28  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-mi.el (gdb-use-separate-io-buffer):
	Remove variable ...
	(gdb-init-1, gdb-display-separate-io-buffer)
	(gdb-frame-separate-io-buffer, gdb-setup-windows): ... and
	references to it.
	(gdb-inferior-io-mode): Use make-comint-in-buffer.
	(gdb-inferior-filter): Use comint-output-filter to stop
	echoing and remove ^M characters.

2009-08-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emulation/viper-init.el (viper-restore-cursor-type):
	* emulation/cua-base.el (cua--update-indications):
	Replace default-cursor-type with (default-value 'cursor-type).

	* mail/sendmail.el (mail-recover-1):
	* international/mule-diag.el (describe-current-coding-system-briefly)
	(describe-current-coding-system):
	* international/mule-cmds.el (select-safe-coding-system)
	(select-message-coding-system)
	(set-language-environment-coding-systems, set-locale-environment):
	* hexl.el (hexl-insert-multibyte-char):
	* dos-w32.el (find-buffer-file-type-coding-system):
	* simple.el (what-cursor-position):
	Replace uses of default-buffer-file-coding-system
	with (default-value 'buffer-file-coding-system).

	* emacs-lisp/edebug.el (edebug-display, edebug-outside-excursion):
	Replace uses of default-cursor-in-non-selected-windows
	with (default-value 'cursor-in-non-selected-windows).
	Use with-current-buffer.

	* mail/feedmail.el: Use CL macros.
	(feedmail-run-the-queue, feedmail-send-it-immediately):
	* dos-w32.el (find-buffer-file-type): Replace uses of
	default-buffer-file-type with (default-value 'buffer-file-type).

2009-08-28  Glenn Morris  <rgm@gnu.org>

	* calendar/diary-lib.el (diary-list-entries, diary-goto-entry)
	(diary-show-all-entries, diary-mark-entries, diary-make-entry):
	Use default-value of major-mode rather than default-major-mode.

2009-08-27  Stefan Monnier  <monnier@iro.umontreal.ca>

	* Makefile.in (update-elcfiles): Report left over elc files.

	* mail/mailalias.el (build-mail-aliases): Use with-temp-buffer,
	expand-file-name and with-current-buffer.
	(mail-get-names, mail-directory): Use with-current-buffer.

	* vc.el (vc-read-revision): New function.
	(vc-version-diff, vc-merge): Use it.

2009-08-27  Sam Steingold  <sds@gnu.org>

	* simple.el (kill-do-not-save-duplicates): New user option.
	(kill-new): When it is non-nil, and the new string is the same as
	the latest kill, set replace to t to avoid duplicates in kill-ring.

2009-08-27  Julian Scheid  <julians37@gmail.com>  (tiny change)

	* net/tramp.el (tramp-handle-process-file): Do not flush all
	caches when `process-file-side-effects' is set.
	(tramp-handle-vc-registered): Use `tramp-get-file-exists-command'
	instead of `tramp-find-file-exists-command'.
	Unset `process-file-side-effects'.

2009-08-27  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-methods): New method "rsyncc".
	(top): Add completion function for "rsyncc".
	(tramp-message-show-message): New defvar.
	(tramp-message, tramp-error): Use it.
	(tramp-do-copy-or-rename-file-directly): Extend check for direct
	remote copying.
	(tramp-do-copy-or-rename-file-out-of-band): Handle new
	`tramp-methods' entry `copy-env' of "rsyncc".
	(tramp-vc-registered-read-file-names): New defconst.
	(tramp-vc-registered-file-names): New defvar.
	(tramp-handle-vc-registered): Implement optimization strategy.
	(tramp-run-real-handler): Add `tramp-vc-file-name-handler'.
	(tramp-vc-file-name-handler): New defun.
	(tramp-get-ls-command, tramp-get-test-command)
	(tramp-get-file-exists-command, tramp-get-remote-ln)
	(tramp-get-remote-perl, tramp-get-remote-stat)
	(tramp-get-remote-id): Remove superfluous `with-current-buffer'.

	* net/tramp-cache.el (top): Autoload `tramp-time-less-p'.
	(tramp-cache-inhibit-cache): Extend doc string.  It allows also
	timestamps.
	(tramp-get-file-property): Check for timestamps in
	`tramp-cache-inhibit-cache'.
	(tramp-set-file-property): Write timestamp.

2009-08-27  ARISAWA Akihiro  <ari@mbf.ocn.ne.jp>  (tiny change)

	* language/japan-util.el (japanese-symbol-table): Add entries for
	cp932-2-byte.

	* international/characters.el: Add category `j' to cp932-2-byte.

2009-08-27  Kenichi Handa  <handa@m17n.org>

	* international/fontset.el (build-default-fontset-data): New macro.
	(setup-default-fontset): Use build-default-fontset-data for CJK,
	tibetan, ethiopic, and ipa.

2009-08-27  Stefan Monnier  <monnier@iro.umontreal.ca>

	* cus-start.el (default-major-mode): Customize `major-mode' instead.
	(enable-multibyte-characters): Not customizable any more.

	* subr.el (default-mode-line-format, default-header-line-format)
	(default-line-spacing, default-abbrev-mode, default-ctl-arrow)
	(default-direction-reversed, default-truncate-lines)
	(default-left-margin, default-tab-width, default-case-fold-search)
	(default-left-margin-width, default-right-margin-width)
	(default-left-fringe-width, default-right-fringe-width)
	(default-fringes-outside-margins, default-scroll-bar-width)
	(default-vertical-scroll-bar, default-indicate-empty-lines)
	(default-indicate-buffer-boundaries, default-fringe-indicator-alist)
	(default-fringe-cursor-alist, default-scroll-up-aggressively)
	(default-scroll-down-aggressively, default-fill-column)
	(default-cursor-type, default-buffer-file-type)
	(default-cursor-in-non-selected-windows)
	(default-buffer-file-coding-system, default-major-mode)
	(default-enable-multibyte-characters): Mark as obsolete.

2009-08-27  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-dir.el (vc-dir-update): Remove debug helper.

	* vc-cvs.el (vc-cvs-update-changelog): Fix typo.

2009-08-26  Sam Steingold  <sds@gnu.org>

	* simple.el (save-interprogram-paste-before-kill): New user option.
	(kill-new): When `save-interprogram-paste-before-kill' is non-nil,
	save the interprogram-paste into kill-ring before overriding it
	with the Emacs kill.

2009-08-26  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc.el (vc-trunk-p): Rename to vc-rcs-trunk-p and move to vc-rcs.el.
	(vc-minor-part): Rename to vc-rcs-minor-part and move to vc-rcs.el.
	(vc-default-previous-revision): Rename to vc-rcs-previous-revision
	and move to vc-rcs.el.
	(vc-default-next-revision): Rename to vc-rcs-next-revision and
	move to vc-rcs.el.
	(vc-cvs-update-changelog): Move to vc-cvs.el, use vc-call-backend.
	(vc-rcs-update-changelog): Remove.
	(vc-update-changelog-rcs2log): Rename to vc-rcs-update-changelog
	and move to vc-rcs.el.

	* vc-rcs.el (vc-rcs-latest-on-branch-p, vc-rcs-checkin)
	(vc-rcs-checkout, vc-rcs-rollback): Adjust for the vc-rcs-trunk-p
	renaming.
	(vc-rcs-trunk-p, vc-rcs-minor-part, vc-rcs-previous-revision)
	(vc-rcs-next-revision, vc-rcs-update-changelog): Move here from
	vc.el, renamed to be RCS specific.

	* vc-cvs.el (vc-cvs-previous-revision, vc-cvs-next-revision):
	New functions.
	(vc-cvs-update-changelog): Move here from vc.el.

	* vc-sccs.el (vc-sccs-previous-revision, vc-sccs-next-revision):
	New functions.

2009-08-26  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/bytecomp.el (byte-compile-lapcode): Fix up last change.

2009-08-26  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-git.el (vc-git-register): Use "git add" for directories.
	(vc-git-stash, vc-git-stash-show): New functions.
	(vc-git-extra-menu-map): Bind them.

	* vc-dir.el (vc-dir-node-directory, vc-dir-update): Get the parent
	directory correctly in case the item is a directory itself.

	* vc.el: Document the desired behavior for reverted files in the
	`added' state.
	(vc-default-prettify-state-info): Remove function, unused.

	* vc-bzr.el (vc-bzr-prettify-state-info): Remove function, unused.

2009-08-26  Glenn Morris  <rgm@gnu.org>

	* bindings.el (standard-mode-line-format): Reposition dashes in
	which-func entry.  (Bug#4217)

	* files.el (enable-local-variables, enable-local-eval)
	(safe-local-variable-values, safe-local-eval-forms): Mark as risky in
	the defcustoms.
	(auto-mode-alist, ignored-local-variables)
	(save-some-buffers-action-alist): Move risky declarations to the
	definitions.
	(dabbrev-case-fold-search, dabbrev-case-replace, display-time-string)
	(font-lock-defaults, format-alist, imenu--index-alist)
	(imenu-generic-expression, input-method-alist, minor-mode-alist)
	(mode-line-buffer-identification, mode-line-client, mode-line-modes)
	(mode-line-modified, mode-line-mule-info, mode-line-position)
	(mode-line-process, mode-line-remote, outline-level)
	(parse-time-rules, rmail-output-file-alist)
	(special-display-buffer-names, vc-mode):
	Move risky declarations to the relevant files.
	* bindings.el (mode-line-client, mode-line-mule-info, mode-line-remote)
	(mode-line-modified, mode-line-process, mode-line-position)
	(mode-line-modes, mode-line-buffer-identification, minor-mode-alist)
	* font-core.el (font-lock-defaults):
	* format.el (format-alist):
	* vc-hooks.el (vc-mode):
	* window.el (special-display-buffer-names):
	* international/mule-cmds.el (input-method-alist):
	Define riskiness here (dumped file) rather than in files.el.
	* dabbrev.el (dabbrev-case-fold-search, dabbrev-case-replace):
	* imenu.el (imenu-generic-expression, imenu--index-alist):
	* outline.el (outline-level):
	* time.el (display-time-string):
	* calendar/parse-time.el (parse-time-rules):
	* mail/rmailout.el (rmail-output-file-alist):
	Autoload riskiness here, rather than placing in files.el.

2009-08-26  Andreas Schwab  <schwab@linux-m68k.org>

	* emacs-lisp/bytecomp.el (byte-compile-lapcode): Signal overflow.

2009-08-25  Michael Albinus  <michael.albinus@gmx.de>

	* simple.el (process-file-side-effects): New defvar.

	* dired-aux.el (dired-show-file-type):
	* vc.el (vc-diff-internal):
	* vc-arch.el (vc-arch-diff):
	* vc-bzr.el (vc-bzr-sha1, vc-bzr-revision-completion-table):
	* vc-cvs.el (vc-cvs-state, vc-cvs-diff, vc-cvs-revision-table):
	* vc-git.el (vc-git-registered, vc-git-working-revision)
	(vc-git-find-revision, vc-git-diff, vc-git-revision-table)
	(vc-git--empty-db-p):
	* vc-hooks.el (vc-user-login-name):
	* vc-svn.el (vc-svn-registered, vc-svn-state)
	(vc-svn-dir-extra-headers, vc-svn-find-revision):
	* progmodes/grep.el (grep-probe): Let-bind
	`process-file-side-effects' with nil.

	* net/dbus.el (dbus-ping): Add optional parameter TIMEOUT.

	* net/tramp-gvfs.el (top): Use timeout of 100 msec pinging GVFS
	daemon.  Replace ping by checking for running service for bluez
	and zeroconf.  (Bug#4239)

2009-08-25  Kevin Ryde  <user42@zip.com.au>

	* net/dig.el (dig): Add autoload cookie.

2009-08-25  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/bytecomp.el (byte-compile-eval): Fix test for cl in
	load-history for absolute file-names.
	(byte-compile-file-form-require): Warn about use of the cl package.

	* format.el (format-alist): Doc fix.

	* play/bubbles.el (top-level): Don't require cl at run-time.

	* progmodes/verilog-mode.el (top-level): Don't require lucid (and hence
	run-time cl).

2009-08-24  Dmitry Dzhus  <dima@sphinx.net.ru>

	* progmodes/gdb-mi.el (gdb-mapcar*): Replacement for `mapcar*'
	from cl package.
	(gdb-table-add-row, gdb-table-string): Use `gdb-mapcar*'.

2009-08-24  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-alg.el (math-trig-rewrite)
	(math-hyperbolic-trig-rewrite): New functions.
	(calc-simplify): Simplify trig functions when asked.

2009-08-24  Stefan Monnier  <monnier@iro.umontreal.ca>

	* diff-mode.el (diff-find-source-location): Avoid goto-line.

2009-08-24  Kenichi Handa  <handa@m17n.org>

	* language/ind-util.el (mapthread): Delete it.
	(combinatorial): New function.
	(indian--puthash-cv): Use combinatorial instead of mapthread.

2009-08-22  Kevin Ryde  <user42@zip.com.au>

	* emacs-lisp/checkdoc.el (checkdoc-force-history-flag)
	(checkdoc-arguments-in-order-flag): Add safe-local-variable booleanp.
	(checkdoc-symbol-words): Add safe-local-variable for list of strings.
	Clarify docstring that the value is strings not symbols.
	(checkdoc-list-of-strings-p): New function.

2009-08-22  Glenn Morris  <rgm@gnu.org>

	* files.el (auto-mode-alist):
	* hippie-exp.el (he-concat-directory-file-name):
	* lpr.el (lpr-windows-system, printer-name):
	* ls-lisp.el (ls-lisp-emulation, ls-lisp-use-insert-directory-program):
	* ps-print.el (ps-windows-system):
	* startup.el (command-line):
	* emulation/viper-ex.el (viper-glob-function):
	* international/mule-cmds.el (set-language-environment-coding-systems):
	* net/ange-ftp.el (ange-ftp-write-region):
	* obsolete/fast-lock.el (fast-lock-cache-name):
	Remove code for defunct system-types emx, macos, mswindows, next-mach,
	unisoft-unix, vax-vms, win32, w32.

	* calendar/diary-lib.el (diary-mark-entries-1): Only mark all days of a
	given name if the pattern is not more specific.

	* calendar/lunar.el (lunar-phase-names): New option.
	(lunar-phase): Doc fix.
	(lunar-cycles-per-year): New constant.
	(lunar-index): New function.
	(lunar-phase-list, diary-lunar-phases): Use lunar-index.
	(lunar-phase-name): Use lunar-phase-names.
	(calendar-lunar-phases): Use format.
	(lunar-new-moon-on-or-after): Use lunar-cycles-per-year.

	* progmodes/cperl-mode.el (cperl-imenu-name-and-position):
	Copy imenu-example--name-and-position function here for own use.
	(cperl-xsub-scan): Use cperl-imenu-name-and-position.

	* bs.el (bs--redisplay):
	* cus-edit.el (custom-redraw):
	* ibuffer.el (ibuffer-bury-buffer):
	* server.el (server-goto-line-column):
	* startup.el (command-line-1):
	* strokes.el (strokes-xpm-for-stroke):
	* term.el (term-display-buffer-line):
	* view.el (View-goto-line):
	* calc/calc.el (calc-do, calc-trail-buffer):
	* play/gamegrid.el (gamegrid-add-score-insecure):
	* progmodes/ada-mode.el (ada-compile-goto-error):
	* progmodes/ada-xref.el (ada-xref-find-in-modified-ali):
	(ebrowse-select-1st-to-9nth):
	* progmodes/cperl-mode.el (cperl-time-fontification):
	* progmodes/ebrowse.el (ebrowse-toggle-file-name-display)
	* progmodes/gud.el (gud-display-line):
	(idlwave-shell-display-line):
	* progmodes/idlw-shell.el (idlwave-shell-goto-frame)
	* progmodes/make-mode.el (makefile-browser-toggle):
	(vhdl-speedbar-port-copy, vhdl-compose-components-package):
	* progmodes/vhdl-mode.el (vhdl-speedbar-find-file)
	* textmodes/picture.el (picture-draw-rectangle):
	* textmodes/reftex-index.el (reftex-index-goto-letter):
	(reftex-select-jump-to-previous):
	* textmodes/reftex-sel.el (reftex-find-start-point)
	* textmodes/reftex-toc.el (reftex-toc, reftex-toc-restore-region):
	(rst-straighten-deco-spacing, rst-section-tree, rst-toc):
	* textmodes/rst.el (rst-promote-region, rst-straighten-decorations)
	* textmodes/tex-mode.el (tex-compilation-parse-errors):
	* textmodes/two-column.el (2C-associated-buffer):
	Use forward-line rather than goto-line.

	* emulation/vi.el (vi-goto-line): Don't warn about non-interactive
	goto-line.

	* international/ucs-normalize.el (nfd, decomposition-translation-alist)
	(decomposition-char-recursively, alist-list-to-vector, quick-check-list)
	(quick-check-list-to-regexp): Declare.

	* progmodes/make-mode.el (makefile-browser-insert-selection):
	Use goto-char rather than goto-line.

	* progmodes/prolog.el (compilation-error-regexp-alist)
	(compilation-forget-errors): Declare.

2009-08-22  Juri Linkov  <juri@jurta.org>

	* progmodes/grep.el (lgrep, rgrep): At the beginning
	set `dir' to `default-directory' unless `dir' is a non-nil
	readable directory.  (Bug#4052)
	(lgrep, rgrep): Change a weird way to report an error
	from using `read-string' to using `error'.
	Instead of using interactive arguments in the function body,
	add new argument `confirm'.

2009-08-21  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/remember.el (remember-buffer):
	* progmodes/cperl-mode.el (cperl-vc-header-alist):
	* calendar/icalendar.el (icalendar-convert-diary-to-ical)
	(icalendar-extract-ical-from-buffer):
	* net/newst-treeview.el (newsticker-groups-filename):
	* net/newst-backend.el (newsticker-cache-filename):
	* speedbar.el (speedbar-update-speed, speedbar-navigating-speed)
	(speedbar-ignored-path-expressions, speedbar-ignored-path-regexp)
	(speedbar-add-ignored-path-regexp, speedbar-line-path)
	(speedbar-buffers-line-path, speedbar-path-line)
	(speedbar-buffers-line-path):
	* epg.el (epg-passphrase-callback-function, epg-start-sign-keys)
	(epg-sign-keys):
	* epa.el (epa-display-verify-result):
	* progmodes/pascal.el (pascal-outline): Add version of obsolescence.

2009-08-21  Glenn Morris  <rgm@gnu.org>

	* progmodes/js.el (inferior-moz-process): Fix declaration.

	* imenu.el (imenu-example--name-and-position): Fix obsolescence message.

	* obsolete/rnewspost.el (news-mail-reply):
	Use goto-char rather than goto-line.

	* term/ns-win.el (ns-open-file-select-line):
	Use line-beginning-position rather than goto-line.

	* apropos.el (apropos-command):
	* ehelp.el (electric-helpify):
	* printing.el (pr-show-setup):
	* strokes.el (strokes-help):
	* tutorial.el (tutorial--describe-nonstandard-key)
	(tutorial--detailed-help):
	* woman.el (woman-mini-help, woman-display-extended-fonts):
	* calc/calc-help.el (calc-describe-key):
	* emulation/edt.el (edt-electric-helpify):
	* international/mule-diag.el (mule-diag):
	* play/yow.el (apropos-zippy):
	* progmodes/python.el (python-describe-symbol):
	* progmodes/vhdl-mode.el (vhdl-doc-variable, vhdl-doc-mode):
	* textmodes/table.el (*table--cell-describe-mode)
	(*table--cell-describe-bindings):
	Use help-print-return-message rather than the now obsolete alias.

	* calendar/cal-move.el (calendar-cursor-to-nearest-date)
	(calendar-cursor-to-visible-date):
	* play/5x5.el (5x5-position-cursor):
	* play/decipher.el (decipher):
	* play/gomoku.el (gomoku-goto-xy):
	* play/landmark.el (lm-goto-xy):
	* play/mpuz.el (mpuz-paint-errors, mpuz-paint-statistics)
	(mpuz-paint-digit):
	Use forward-line, not goto-line.

	* mail/rmail.el (rmail-obsolete): Delete custom group.
	(rmail-pop-password, rmail-pop-password-required): Make into aliases.
	(rmail-remote-password, rmail-remote-password-required):
	Remove unneeded :set-after and :set properties.

2009-08-21  Michael Albinus  <michael.albinus@gmx.de>

	* net/dbus.el (top): Initialize only when `dbusbind' is loaded.

2009-08-21  Dan Nicolaescu  <dann@ics.uci.edu>

	* loadup.el: Remove leftover macos code.

	* vc-git.el (vc-git-annotate-command): Run asynchronously.
	Explicitly pass the date format to git blame so that user local
	so that the output format can be parsed.

2009-08-20  Michael Albinus  <michael.albinus@gmx.de>

	* net/dbus.el (top): Don't check for (getenv
	"DBUS_SESSION_BUS_ADDRESS").  It's done in dbusbind.c now.

2009-08-19  Magnus Henoch  <magnus.henoch@gmail.com>

	* log-edit.el (log-edit-strip-single-file-name): New var.
	(log-edit-insert-changelog): Use it.  Bug#3571

2009-08-19  Stefan Monnier  <monnier@iro.umontreal.ca>

	* subr.el (read-passwd): Use read-key so keypad keys work as well.
	Bug#3287

	* help.el (help-print-return-message): Rename from
	print-help-return-message.

	* log-view.el (log-view-mode-map): Remove `q' binding, and unreliable
	cvs-mode-map parent hack.
	(log-view-mode): Derive from special-mode.

	* linum.el (linum-mode): window-size-change-functions is redundant.
	Adapt to new window-configuration-change-hook behavior.
	(linum-after-size, linum-after-config): Remove.

	* imenu.el (imenu-example--name-and-position)
	(imenu-example--lisp-extract-index-name)
	(imenu-example--create-lisp-index, imenu-example--create-c-index):
	Mark as obsolete.

	* progmodes/prolog.el (inferior-prolog-error-regexp-alist): New var.
	(inferior-prolog-mode): Use it.
	(inferior-prolog-load-file): Reset list of errors.

2009-08-19  ARISAWA Akihiro  <ari@mbf.ocn.ne.jp>  (tiny change)

	* language/tibetan.el ("Tibetan"): Fix sample-text entry.

	* language/tai-viet.el ("TaiViet"): Fix sample-text entry.

2009-08-19  Michael Albinus  <michael.albinus@gmx.de>

	* net/dbus.el (top): Apply `dbus-init-bus' only if the session bus
	is running already.

2009-08-19  Stefan Monnier  <monnier@iro.umontreal.ca>

	* subr.el (listify-key-sequence-1): Use normal syntax since those
	integers are nowadays always represented by the same (positive) number
	on all platforms.
	(read-key-empty-map): New const.
	(read-key-delay): New var.
	(read-key): New function.
	(force-mode-line-update): Use with-current-buffer.
	(locate-user-emacs-file): Don't forget to abbreviate the file name.
	(start-process-shell-command, start-file-process-shell-command):
	Discourage the use of command-args.

2009-08-19  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/authors.el (authors-fixed-entries): Remove cvtmail.

2009-08-19  Stefan Monnier  <monnier@iro.umontreal.ca>

	* simple.el (choose-completion-string): Don't rely on
	minibuffer-completing-file-name and ad-hoc checks to decide whether
	to continue completion or not.

	* minibuffer.el (minibuffer-hide-completions): New function.
	(completion--do-completion): Use it.
	(completions-annotations): New face.
	(completion--insert-strings): Use it.
	(completion-pcm--delim-wild-regex): Add docstring.
	(completion-pcm--string->pattern): Add support for 0-width delimiters
	in completion-pcm--delim-wild-regex.

2009-08-18  Stefan Monnier  <monnier@iro.umontreal.ca>

	* international/ucs-normalize.el (ucs-normalize-hfs-nfd-post-read-conversion):
	Remove unused var `buffer-modified-p'.

	* minibuffer.el (completion--do-completion): Move point for the #b001
	case as well (bug#4176).
	(minibuffer-complete, minibuffer-complete-word): Don't move point.

2009-08-18  Michael Albinus  <michael.albinus@gmx.de>

	* net/dbus.el (dbus-init-bus): Declare.  Apply it for the :system
	and :session buses.

2009-08-18  Kenichi Handa  <handa@m17n.org>

	* international/ucs-normalize.el (ucs-normalize-version):
	Change to 1.1.
	(ucs-normalize-hfs-nfd-pre-write-conversion): New function.
	(utf-8-hfs): Make it perform normalization on encoding too.

	* textmodes/paragraphs.el: Change to utf-8.  Adjust coding cookie.
	(sentence-end-without-space): Delete duplicated chars.
	(sentence-end-base): Likewise.

	* textmodes/sgml-mode.el: Change to utf-8.  Adjust coding cookie.
	(html-mode): Delete duplicated chars from sentence-end-base.

	* textmodes/texinfo.el: Change to utf-8.  Adjust coding cookie.
	(texinfo-mode): Delete duplicated chars from sentence-end-base.

2009-08-17  Chong Yidong  <cyd@stupidchicken.com>

	* files.el (hack-one-local-variable): If the mode function is for
	a minor mode, pass it an argument (Bug#4148).

2009-08-17  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-register-completion-file-name-handler):
	Check also for (member 'partial-completion completion-styles).

2009-08-16  Chong Yidong  <cyd@stupidchicken.com>

	* progmodes/cperl-mode.el (cperl-electric-paren): Don't expand
	abbrev (Bug#3943).

2009-08-16  Ilya Zakharevich  <ilyaz@cpan.org>

	* progmodes/cperl-mode.el: Merge upstream 6.2.
	(cperl-mode-syntax-table): Modify syntax entry for ["'`].
	(cperl-forward-re): Check cperl-brace-recursing.
	(cperl-highlight-charclass): New function.
	(cperl-find-pods-heres): Use it.
	(cperl-fill-paragraph): Synch to save-excursion placement used upstream.
	(cperl-beautify-regexp-piece): Fix column calculation.
	(cperl-make-regexp-x): Handle case where point is between "q" and "rs".
	(cperl-beautify-level): Don't process entire regexp.
	(cperl-build-manpage, cperl-perldoc): Bind Man-switches before
	calling man.
	(cperl-tips-faces, cperl-mode, cperl-electric-backspace): Doc fix.
	(cperl-init-faces): Build a list in the normal way.

2009-08-16  Chong Yidong  <cyd@stupidchicken.com>

	* calendar/parse-time.el (parse-time-string-chars): Save match
	data.

2009-08-16  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/sql.el (sql-product-alist): Add :name tag to entries.
	(sql-product): Use it.
	(sql-mode-menu): Auto-generate the menu based on sql-product-alist.
	(sql-set-product): Add completion.
	(sql-highlight-oracle-keywords, sql-highlight-postgres-keywords)
	(sql-highlight-linter-keywords, sql-highlight-ms-keywords)
	(sql-highlight-ansi-keywords, sql-highlight-sybase-keywords)
	(sql-highlight-informix-keywords, sql-highlight-interbase-keywords)
	(sql-highlight-ingres-keywords, sql-highlight-solid-keywords)
	(sql-highlight-mysql-keywords, sql-highlight-sqlite-keywords)
	(sql-highlight-db2-keywords): Remove.
	(sql-find-sqli-buffer, sql-set-sqli-buffer-generally)
	(sql-highlight-product): Use derived-mode-p.
	(sql-set-sqli-buffer): Use with-current-buffer.
	(sql-connect-informix, sql-connect-ingres, sql-connect-oracle):
	Simplify.

	* emacs-lisp/lisp-mode.el (lisp-indent-region): Remove unused function.

	* term.el: Fix commenting convention, turn comments into docstrings.

2009-08-16  E. Jay Berkenbilt  <ejb@ql.org>  (tiny change)

	* whitespace.el (whitespace-style): Doc fix (Bug#3661).

2009-08-16  Jan Seeger  <jan.seeger@thenybble.de>  (tiny change)

	* calendar/parse-time.el (parse-time-string-chars): Compute using
	character classes, to handle non-ascii characters (Bug#3190).

2009-08-16  Chong Yidong  <cyd@stupidchicken.com>

	* progmodes/sh-script.el (sh-maybe-here-document): Avoid inserting
	another heredoc if the user adds another < (Bug#3226).

	* mwheel.el (mouse-wheel-down-event, mouse-wheel-up-event):
	Don't initialize based on window-system (Bug#4124).

	* facemenu.el (facemenu-read-color): Use a completion function
	that accepts any defined color, such as RGB triplets (Bug#3677).

	* files.el (get-free-disk-space): Change fallback default
	directory to /.  Expand DIR argument before switching to fallback.
	Suggested by Kevin Ryde (Bug#2631, Bug#3911).

2009-08-15  Chong Yidong  <cyd@stupidchicken.com>

	* files.el (load-library): Doc fix.

2009-08-15  Michael Kifer  <kifer@cs.stonybrook.edu>

	* emulation/viper-cmd.el (viper-insert-isearch-string): New function.
	(viper-if-string): Redefine C-s in the minibuffer to insert the last
	incremental search string.

	* ediff-init.el (ediff-coding-system): Use escape-quoted in case of
	XEmacs.

	* ediff-merg.el (ediff-merge-region-is-non-clash-to-skip)
	(ediff-merge-region-is-non-clash)
	(ediff-skip-merge-region-if-changed-from-default-p): Use defun.
	Also check if the job is really a merge job.

	* ediff.el (ediff-current-file): New function.

2009-08-15  Chong Yidong  <cyd@stupidchicken.com>

	* progmodes/js.el: Edit docstrings throughout to follow Emacs
	conventions.
	(js-insert-and-indent): Delete function.
	(js-mode-map): Don't bind keys to js-insert-and-indent.
	(js-beginning-of-defun): Rename from js--beginning-of-defun.
	(js-end-of-defun): Rename from js--end-of-defun.
	(js-auto-indent-flag): Delete variable.

2009-08-14  Chong Yidong  <cyd@stupidchicken.com>

	* progmodes/js.el: Remove proclaim statement.
	Defvar which-func-imenu-joiner-function to silence compiler.

	* files.el (auto-mode-alist): Use js-mode for .js files.

	* progmodes/js2-mode.el: Remove file.

	* Makefile.in (ELCFILES): Add js.el, and remove js2-mode.el.

	* speedbar.el (speedbar-supported-extension-expressions): Add .js.

	* progmodes/hideshow.el (hs-special-modes-alist): Add js-mode entry.

2009-08-14  Daniel Colascione  <dan.colascione@gmail.com>
            Karl Landstrom  <karl.landstrom@brgeight.se>

	* progmodes/js.el: New file.

2009-08-14  Mark A. Hershberger  <mah@everybody.org>

	* timezone.el (timezone-parse-date): Add ability to understand ISO
	basic format (minimal separators) dates in addition to the
	already-supported extended format dates.

2009-08-14  Eli Zaretskii  <eliz@gnu.org>

	* international/ucs-normalize.el: Add a `coding' file variable.

	* Makefile.in (ELCFILES): Add international/ucs-normalize.elc.

2009-08-14  Sam Steingold  <sds@gnu.org>

	* vc-cvs.el (vc-cvs-merge-news): Yet another fix of message parsing.

2009-08-13  Chong Yidong  <cyd@stupidchicken.com>

	* faces.el (help-argument-name): Define it here instead of
	help-fns.el, because in daemon mode help-fns.el may be loaded when
	faces are still uninitialized (Bug#1078).

	* help-fns.el (help-argument-name): Move defface to faces.el.

2009-08-13  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-mi.el (gdb-inferior-io-mode): Use start-process to
	create buffer with a pty but no process so that GDB can make the
	inferior the controlling process.

2009-08-13  Taichi Kawabata  <kawabata.taichi@gmail.com>

	* international/ucs-normalize.el: New file.

2009-08-13  Richard Stallman  <rms@gnu.org>

	* mail/rmail.el (rmail-get-attr-names):
	Accept an attribute header that is too short.

	* mail/rmail.el (rmail-forget-messages):
	Ignore nil elt in rmail-message-vector.  Use dotimes.

	* progmodes/compile.el (compilation-goto-locus):
	Use next-error-move-function.

	* simple.el (next-error-move-function): New variable.

2009-08-12  Juri Linkov  <juri@jurta.org>

	* progmodes/grep.el (lgrep): Ensure that `default-directory' is
	always non-nil.  (Bug#4052)

	* replace.el (read-regexp): Return empty string when
	`default-value' is nil.
	(keep-lines-read-args): Don't use empty string as the
	default value for `read-regexp'.  (Bug#2495)

2009-08-12  Juri Linkov  <juri@jurta.org>

	* international/mule-cmds.el (ucs-insert): Change arguments
	from `arg' to `character', `count', `inherit' to be the same
	as in `insert-char'.  Doc fix.  (Bug#4039)

	* international/mule-conf.el (utf-16be-with-signature): Doc fix.

2009-08-12  Juri Linkov  <juri@jurta.org>

	* files-x.el: New file.

	* files.el: Move code that deals with adding/deleting
	file/directory-local variables to files-x.el.

	* Makefile.in (ELCFILES): Add files-x.elc.

2009-08-11  Dmitry Dzhus  <dima@sphinx.net.ru>

	* progmodes/gdb-mi.el (gdb-line-posns): New helper which helps not
	to use `goto-line'.
	(gdb-place-breakpoints, gdb-get-location): Rewritten without
	`goto-line'.
	(gdb-invalidate-disassembly): Do not refresh upon receiving
	'update signal.  Instead, update all disassembly buffers only after
	threads list.
	(gdb): Send -target-detach when buffer is killed (Bug#3794).
	(gdb-starting): Moved -data-list-register-names...
	(gdb-stopped): ...here so it's sent when first thread stops.
	(gdb-registers-handler-custom): Do nothing if register names are
	unknown yet.

	* progmodes/gud.el (gud-stop-subjob): Rewritten without macros
	from `gdb-mi.el' to avoid extra tangling.

	* progmodes/gdb-mi.el (gdb-gud-context-call): Reverting previous
	change which breaks `gud-def' definitions used in `gdb'.
	(gdb-update-gud-running): No extra fuss for updating frame number.

2009-08-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* international/mule-cmds.el (mule-keymap, mule-menu-keymap)
	(describe-language-environment-map, setup-language-environment-map)
	(set-coding-system-map): Move initialization into declaration.
	(set-language-info-alist): Last arg to define-key-after can be skipped.

	* international/quail.el (quail-completion-1): Simplify.
	(quail-define-rules): Use slightly more compact code.
	(quail-insert-decode-map): Propertize keys, compact columns.

	* emacs-lisp/bytecomp.el (byte-compile-interactive-only-functions):
	Add goto-line.

2009-08-10  Miles Bader  <miles@gnu.org>

	* progmodes/js2-mode.el (js2-warning, js2-error, js2-jsdoc-tag)
	(js2-jsdoc-type, js2-jsdoc-value, js2-function-param)
	(js2-instance-member, js2-private-member, js2-private-function-call)
	(js2-jsdoc-html-tag-name, js2-jsdoc-html-tag-delimiter)
	(js2-magic-paren, js2-external-variable):
	Remove "-face" suffix from face names.
	(js2-jsdoc-highlight-helper, js2-highlight-jsdoc)
	(js2-highlight-undeclared-vars, js2-peek-token)
	(js2-parse-function-params, js2-mode-show-errors)
	(js2-mode-show-warnings, js2-make-magic-delimiter)
	(js2-mode-highlight-magic-parens): Update to use new face names.

2009-08-09  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-get-ls-command-with-dired): New defun.
	(tramp-handle-insert-directory): Handle "--dired".  (Bug#4075)

2009-08-09  Chong Yidong  <cyd@stupidchicken.com>

	* subr.el: Provide hashtable-print-readable.

	* progmodes/hideshow.el (hs-special-modes-alist): Don't use
	hs-c-like-adjust-block-beginning.
	(hs-hide-block-at-point): Stop hiding at the beginning of
	hs-block-end-regexp (Bug#700).

2009-08-09  Dmitry Dzhus  <dima@sphinx.net.ru>

	* progmodes/gdb-mi.el (gdb-gud-context-call): Does not need to be
	a macro.
	(gdb-registers-handler-custom): Do not fail when register names
	are unavailable.

2009-08-08  Dmitry Dzhus  <dima@sphinx.net.ru>

	* progmodes/gdb-mi.el (gdb-control-all-threads)
	(gdb-control-current-thread): Interactive setters for
	`gdb-gud-control-all-threads' to use in menu.
	(gdb-show-run-p): Show «Go» when process is not active.
	(gud-tool-bar-map): Add non-stop/A,T indicator.  Uses
	gud/thread.xpm and gud/all.xpm.

2009-08-08  Yoni Rabkin  <yoni@rabkins.net>

	* net/net-utils.el (net-utils-font-lock-keywords): New var.
	(nslookup-font-lock-keywords): Make it a variable.
	(net-utils-mode): New mode for viewing diagnostic network output.
	(net-utils-remove-ctrl-m-filter): Set inhibit-read-only.
	(net-utils-run-simple): New function.
	(ifconfig, iwconfig, netstat, arp, route): Use it.

2009-08-08  Dmitry Dzhus  <dima@sphinx.net.ru>

	* progmodes/gdb-mi.el (gdb-read-memory-custom)
	(gdb-memory-set-address, def-gdb-set-positive-number)
	(def-gdb-memory-format, def-gdb-memory-unit): Update memory buffer
	after changing settings.
	(gdb-invalidate-disassembly): Update when first shown.
	(gdb-edit-locals-value): Fixed.
	(gdb-registers-handler-custom): Print registers in right order and
	allow changing register values (only for current thread yet).
	(gdb-breakpoints-mode-map): Don't assume threads buffer is present.
	(gdb-threads-mode-map): Don't assume breakpoints buffer is present.
	(gdb-disassembly-handler-custom, gdb-stack-list-frames-custom)
	(gdb-locals-handler-custom, gdb-registers-handler-custom): Thread
	info in mode name.
	(gdb-registers-mode-map): TAB to switch to locals.

2009-08-08  Eli Zaretskii  <eliz@gnu.org>

	* mail/rmail.el (rmail-add-mbox-headers)
	(rmail-set-message-counters-counter): Search for
	rmail-unix-mail-delimiter instead of just "From ".  (Bug#4076)

2009-08-08  Glenn Morris  <rgm@gnu.org>

	* Makefile.in (ELCFILES): Update.

2009-08-07  Eli Zaretskii  <eliz@gnu.org>

	* mail/sendmail.el (mail-yank-original): Set
	buffer-file-coding-system from the one used by the message whose
	text is yanked.

	* calc/calc-graph.el (calc-graph-plot): Set calc-graph-last-device
	to "windows" when "pgnuplot" is used.
	(calc-graph-command, calc-gnuplot-command, calc-graph-init): Don't
	call accept-process-output if "pgnuplot" is used.
	(calc-graph-init): Don't send -display and -geometry to
	"pgnuplot".  If "pgnuplot" is used, glean gnuplot version by
	running "pgnuplot -V" with shell-command-to-string.

	* calc/calc.el (calc-gnuplot-name) [windows-nt]: Use "pgnuplot" as
	the default.

2009-08-07  Eli Zaretskii  <eliz@gnu.org>

	* Makefile.in (ELCFILES): org/org-export-latex.elc renamed to
	org/org-latex.elc.

2009-08-07  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-dispatcher.el (vc-resynch-window): Update comment.

	* term.el (term-handle-ansi-escape): Add comments with the
	terminfo capabilities implemented.

2009-08-06  Dmitry Dzhus  <dima@sphinx.net.ru>

	* progmodes/gdb-mi.el (gdb-var-create-regexp): Removed.
	(gdb-var-create-handler): Rewritten using JSON parser.
	(gdb-propertize-header): Moved earlier.
	(gdb-set-header): Removed to avoid duplication.
	(gdb-thread-list-handler-custom, gdb-invalidate-disassembly):
	Refresh disassembly buffers only after threads list have been
	update.
	(gdb-threads-header, gdb-registers-header): Per-buffer header line
	variables.

2009-08-04  Juri Linkov  <juri@jurta.org>

	* files.el: Commands to add/delete file/directory-local variables.
	(read-file-local-variable, read-file-local-variable-value)
	(read-file-local-variable-mode, modify-file-local-variable)
	(modify-file-local-variable-prop-line)
	(modify-dir-local-variable): New functions.
	(add-file-local-variable, delete-file-local-variable)
	(add-file-local-variable-prop-line, delete-file-local-variable-prop-line)
	(add-dir-local-variable, delete-dir-local-variable)
	(copy-file-locals-to-dir-locals, copy-dir-locals-to-file-locals)
	(copy-dir-locals-to-file-locals-prop-line): New commands.

2009-08-04  Chong Yidong  <cyd@stupidchicken.com>

	* abbrev.el (insert-abbrev-table-description): Prettify output.
	Suggested by Karl Chen.

2009-08-04  Dmitry Dzhus  <dima@sphinx.net.ru>

	* progmodes/gdb-mi.el (gdb-frame-number): Initialize with nil.
	(gdb-overlay-arrow-position): Rename to `gdb-disassembly-position'.
	(gdb-overlay-arrow-position, gdb-thread-position)
	(gdb-disassembly-position): Declare variables.
	(gdb-wait-for-pending): Function now.
	(gdb-add-subscriber, gdb-delete-subscriber, gdb-get-subscribers)
	(gdb-emit-signal, gdb-buf-publisher): Declare before first use so
	compilation goes smoothly.
	(gdb, gdb-non-stop, gdb-buffers): New customization groups.
	(gdb-non-stop-setting): New customization setting which replaces
	`gdb-non-stop' so changing it doesn't break active GDB session.
	(gdb-stack-buffer-locations, gdb-stack-buffer-addresses)
	(gdb-thread-buffer-verbose-names, gdb-thread-buffer-arguments)
	(gdb-thread-buffer-locations, gdb-thread-buffer-addresses)
	(gdb-show-threads-by-default): New customization options.
	(gdb-buffer-type, gdb-buffer-shows-main-thread-p): New helper
	routines.
	(gdb-get-buffer-create): Send buffers update signal when they are
	created.
	(gdb-invalidate-locals, gdb-invalidate-registers)
	(gdb-invalidate-breakpoints)
	(gdb-invalidate-threads, gdb-invalidate-disassembly)
	(gdb-invalidate-memory): Accept update signal.
	(gdb-current-context-command): Use --frame option.
	(gdb-update-gud-running, gdb-running, gdb-setq-thread-number):
	Implement `gdb-frame-number' selection logic.
	(gdb-show-run-p, gdb-show-stop-p): Helper functions which decide
	whether to show GUD toolbar buttons.
	(gdb-thread-exited): Unselect current thread when it exits.
	(gdb-stopped): Typo fixed (now really runs `gdb-stopped-hooks').
	(gdb-mark-line): Routine which sets overlay arrow or inverses
	video on fringeless displays.
	(gdb-table, gdb-table-add-row, gdb-table-string): Structure used
	to build aligned columns of data in GDB buffers and set text
	properties line-by-line.
	(gdb-invalidate-breakpoints)
	(gdb-breakpoints-list-handler-custom)
	(gdb-thread-list-handler-custom, gdb-disassembly-handler-custom)
	(gdb-stack-list-frames-custom, gdb-locals-handler-custom)
	(gdb-registers-handler-custom): Align data columns.
	(gdb-locals-handler-custom): Now prints data like in variable
	declarations.
	(gdb-jump-to, gdb-file-button, gdb-insert-file-location-button):
	Removed confusing buttons.
	(gdb-invalidate-threads): Append --frame.
	(gdb-threads-mode-map, gdb-breakpoints-mode-map): TAB to switch
	between breakpoints/threads buffers.
	(gdb-set-window-buffer): Now can ignore dedicated windows.
	(gdb-propertize-header): Use `gdb-set-window-buffer'.
	(def-gdb-thread-buffer-simple-command): Numerous typos fixed.
	(def-gdb-thread-buffer-gud-command): Replaces
	`def-gdb-thread-buffer-gdb-command' and uses standard GUD commands
	for fine thread control.
	(gdb-preempt-existing-or-display-buffer): New function used to
	display bound buffers without breaking window layout.
	(gdb-frame-location): Replaces `gdb-insert-frame-location'.
	(gdb-select-frame): New version of `gdb-frames-select' which now
	sets `gdb-frame-number' so commands may use --frame option instead
	of inner debugger state.
	(gdb-frame-handler): Do not set `gdb-frame-number'.
	(gdb-threads-mode-map): Select threads with mouse.

	* progmodes/gud.el (gdb-gud-context-call): Declare function to
	avoid compilation warning.
	(gud-menu-map, gud-minor-mode-map): Use `gdb-show-run-p` and
	`gdb-show-stop-p`.

	* progmodes/gdb-mi.el (gdb-get-buffer, gdb-get-buffer-create):
	Argument `key' renamed to `buffer-type'.
	(gdb-current-context-buffer-name): Do not add thread info to
	buffer name when no thread is selected.
	(gdbmi-record-list, gdb-shell): Try to handle GDB `shell'
	command (bug 3794).
	(gdb-thread-selected): Handle `=thread-selected' notification.
	(gdb-wait-for-pending): New macro to deal with congestion problems.
	(gdb-breakpoints-list-handler-custom): Don't fail on pending
	breakpoints.
	(gdb-invalidate-disassembly): Use 'fullname instead of 'file.
	This fixes problem similar to one described in bug 3947.
	(gud-menu-map): More menu items.
	(gdb-init-1): Reset `gdb-thread-number' to nil.

	* progmodes/gud.el (gud-stop-subjob, gud-menu-map): Respect GDB
	non-stop settings.

	* progmodes/gdb-mi.el (gdb-thread-number): Initialize with nil.
	(gdb-current-context-command): Do not append --thread if
	`gdb-thread-number' is nil.
	(gdb-running-threads-count, gdb-stopped-threads-count): New
	variables.
	(gdb-non-stop, gdb-gud-control-all-threads, gdb-switch-reasons)
	(gdb-stopped-hooks, gdb-switch-when-another-stopped): New
	customization options.
	(gdb-gud-context-command, gdb-gud-context-call): New wrappers for
	GUD commands.
	(gdb): `gud-def' definitions changed to use `gdb-gud-context-call'.
	(gdb-init-1): Activate non-stop mode if `gdb-non-stop' is enabled.
	(gdb-setq-thread-number, gdb-update-gud-running): New functions to
	set `gdb-thread-number' and update `gud-running' properly.
	(gdb-running): Update threads list when new threads appear.
	(gdb-stopped): Support non-stop operation and new thread switching
	logic.
	(gdb-jsonify-buffer, gdb-json-read-buffer, gdb-json-string)
	(gdb-json-partial-output): New set of JSON routines.
	(def-gdb-auto-update-trigger): New `signal-list' optional
	argument.
	(gdb-thread-list-handler-custom): Update `gud-running',
	`gdb-stopped-threads-count' and `gdb-running-threads-count'.
	(def-gdb-thread-buffer-gdb-command, gdb-interrupt-thread)
	(gdb-continue-thread, gdb-step-thread): New commands for fine
	thread execution control.
	(gud-menu-map): New menu items to switch non-stop options.
	(gdb-reset): Cleanup `gdb-thread-position' overlay arrow marker.
	(gdb-send): Mimic RET properly (bug 3794).

	* progmodes/gdb-mi.el (gdb-rules-name-maker)
	(gdb-rules-buffer-mode, gdb-rules-update-trigger): Accessors for
	gdb-buffer-rules.
	(def-gdb-auto-update-handler): New nopreserve optional argument.
	(gdb-stack-list-frames-custom): Print stack from top to bottom.

	* progmodes/gdb-mi.el (gdb-pc-address): Removed unused variable.
	(gdb-threads-list, gdb-breakpoints-list): New assoc lists.
	(gdb-parent-mode): New mode to derive other GDB modes from.
	(gdb-display-disassembly-for-thread)
	(gdb-frame-disassembly-for-thread): New commands for threads
	buffer.

	* progmodes/gdb-mi.el (gdb-get-buffer, gdb-get-buffer-create)
	(gdb-init-1, gdb-bind-function-to-buffer, gdb-add-subscriber)
	(gdb-get-subscribers, gdb-emit-signal, gdb-buf-publisher)
	(gdb-update): We now store all GDB buffers in a list so that they
	can be updated by traversing a list instead of calling invalidate
	triggers explicitly.
	(def-gdb-trigger-and-handler): New macro to define trigger-handler
	pair for GDB buffer.
	(gdb-stack-buffer-name): Add thread information.
	(gdb-add-pending, gdb-pending-p, gdb-delete-pending): Macros to
	handle pending triggers.
	(gdb-threads-mode-map, def-gdb-thread-buffer-command)
	(def-gdb-thread-buffer-simple-command)
	(gdb-display-stack-for-thread, gdb-display-locals-for-thread)
	(gdb-display-registers-for-thread, gdb-frame-stack-for-thread)
	(gdb-frame-locals-for-thread, gdb-frame-registers-for-thread):
	New commands which show buffers bound to thread.
	(gdb-stack-list-locals-regexp): Removed unused regexp.

	* progmodes/gdb-mi.el (gdb-breakpoints-buffer-name)
	(gdb-locals-buffer-name, gdb-registers-buffer-name)
	(gdb-memory-buffer-name, gdb-stack-buffer-name): Do not switch
	to (gud-comint-buffer) in *-buffer-name functions
	because (gdb-get-target-string) already does that.
	(gdb-locals-handler-custom, gdb-registers-handler-custom)
	(gdb-changed-registers-handler): Rewritten without regexps.

	* progmodes/gdb-mi.el: Basic thread selection support.
	(gdb-thread-number): New variable.
	(gdb-current-context-command): New macro which adds --thread
	option to command.
	(gdb-threads-mode-map): Select thread with SPC.
	(gdb-thread-list-handler-custom): Mark current thread with overlay
	arrow.  Synchronize GDB thread and Emacs thread.
	(gdb-select-thread): New command which selects current thread.
	(gdb-invalidate-frames, gdb-invalidate-locals)
	(gdb-invalidate-registers): Use --thread option.

2009-08-04  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (top): Make check for tramp-gvfs loading more
	robust.  (Bug#3977)
	(tramp-handle-insert-file-contents): `unwind-protect' must be
	inside `with-parsed-tramp-file-name'.

	* net/tramp-gvfs.el (top): Remove superfluous message when loading
	fails.

2009-08-03  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gud.el (jdb): Set gud-jdb-classpath-string to current
	directory if CLASSPATH is not set.

2009-08-03  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-rfn-eshadow-update-overlay-regexp):
	New defconst.
	(tramp-rfn-eshadow-update-overlay): Use it.  (Bug#4004)

2009-08-02  Kevin Ryde  <user42@zip.com.au>

	* net/newst-backend.el (newsticker--raw-url-list-defaults):
	Update freshmeat link.  Delete newsforge.com as it seems gone.

2009-08-02  Chong Yidong  <cyd@stupidchicken.com>

	* select.el (x-set-selection): Doc fix (Bug#4021).

	* w32-fns.el (x-set-selection): Doc fix (Bug#4021).

	* help-fns.el (describe-variable): Treat list return values from
	dir-locals-find-file properly (Bug#4005).

2009-08-02  Julian Scheid  <julians37@googlemail.com>  (tiny change)

	* net/tramp.el (tramp-debug-message): Print also microseconds.

2009-08-02  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-handle-insert-file-contents): Optimize, when BEG
	or END is non-nil.
	(tramp-handle-vc-registered): Use `tramp-cache-inhibit-cache'.
	(tramp-get-debug-buffer): Change `outline-regexp' according to new
	format.

	* net/tramp-cache.el (tramp-cache-inhibit-cache): New defvar.
	(tramp-get-file-property): Use it.

	* autorevert.el (auto-revert-handler): Allow
	`auto-revert-tail-mode' for remote files.

2009-08-02  Jason Rumney  <jasonr@gnu.org>

	* minibuffer.el (read-file-name): Treat confirm options to
	MUSTMATCH as nil when invoking x-file-dialog.  (Bug#3969)

2009-08-02  Chong Yidong  <cyd@stupidchicken.com>

	* font-lock.el (font-lock-string-face, font-lock-builtin-face)
	(font-lock-variable-name-face, font-lock-constant-face): Darken
	the colors for light backgrounds.

2009-08-01  Eli Zaretskii  <eliz@gnu.org>

	* mail/rmailsum.el (rmail-header-summary): Ignore letter-case of
	month names.  (Bug#3987)

2009-07-31  Chong Yidong  <cyd@stupidchicken.com>

	* simple.el (line-move-finish): Pass whole number to
	line-move-to-column.
	(line-move-visual): Perform hscroll to the recorded position.

2009-07-30  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-mode.el (calc-matrix-brackets): Remove "P" from prompt.

2009-07-29  Alan Mackenzie  <acm@muc.de>

	* progmodes/cc-defs.el (c-version): Bump to 5.31.7.

2009-07-29  Dmitry Dzhus  <dima@sphinx.net.ru>

	* progmodes/gdb-mi.el (gdb-goto-breakpoint)
	(gdb-place-breakpoints): Use full path when setting breakpoints.

2009-07-29  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc.el (calc-mode-map): Add keybinding for
	`calc-transpose-lines'.

2009-07-29  Vincent Belaïche  <vincent.belaiche@gmail.com>

	* calc/calc-misc.el (calc-transpose-lines): New function.

2009-07-28  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-do-copy-or-rename-file): Add messages.
	Simplify check for out-of-band methods.
	(tramp-do-copy-or-rename-file-out-of-band): Allow both files to be
	remote.  Remove messages which are in `tramp-do-copy-or-rename-file'.

2009-07-28  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-git.el (vc-git-checkin): Fix typo.

2009-07-28  Steve Yegge  <steve.yegge@gmail.com>

	* progmodes/js2-mode.el: New file.

2009-07-28  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gud.el (jdb): Add gud-pstar to dump object information.
	(gud-menu-map): Adjust tooltip accordingly.

2009-07-27  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-bzr.el (vc-bzr-print-log): Pass multiple arguments to bzr log.
	(vc-bzr-log-view-mode): Adjust log-view-file-re.

	* add-log.el (change-log-mode-map): Add a menu.

2009-07-27  Michael Albinus  <michael.albinus@gmx.de>

	* net/dbus.el (dbus-call-method-non-blocking): Handle the case the
	function returns nil.
	(dbus-handle-event): Handle special return value :ignore.
	Reported by Jan Moringen <jan.moringen@uni-bielefeld.de>.

2009-07-26  Chong Yidong  <cyd@stupidchicken.com>

	* view.el (view-mode-enable): Don't define Helper-return-blurb if
	it's not needed.

2009-07-25  Eli Zaretskii  <eliz@gnu.org>

	Fix Bug#3888:

	* w32-vars.el (x-select-enable-clipboard): Doc fix.

	* term/pc-win.el (x-display-name, x-colors)
	(x-select-enable-clipboard, x-select-text): Doc fix.

	* term/common-win.el (x-display-name, x-colors): Doc fix.

	* term/ns-win.el (x-select-text, x-setup-function-keys, x-colors)
	(xw-defined-colors): Doc fix.

	* w32-fns.el (x-select-text, x-setup-function-keys)
	(x-get-selection, x-set-selection): Doc fix.

	* term/x-win.el (x-select-text, x-setup-function-keys)
	(x-select-enable-clipboard, xw-defined-colors): Doc fix.

	* select.el (x-set-selection): Doc fix.

2009-07-25  Michael Albinus  <michael.albinus@gmx.de>

	* net/zeroconf.el (zeroconf-init): Check for "GetVersionString"
	instead of "IsNSSSupportAvailable".  Avahi ought to work also when
	"IsNSSSupportAvailable" method is not available.  Reported by
	Steve Youngs <steve@sxemacs.org>.

2009-07-24  Kenichi Handa  <handa@m17n.org>

	* international/characters.el: Fix setting of category ?C, ?|, ?K,
	and ?H.  Fix setting of case for Latin Extended and Greek Extended.
	(build-unicode-category-table): Fix range checks.

2009-07-24  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-dispatcher.el (vc-resynch-buffers-in-directory): Make sure
	the buffer we try to sync is current when calling
	vc-resynch-buffer.

	* vc-dir.el (vc-dir-resynch-file): Make sure vc-dir-update does
	not show up to date files.

2009-07-24  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/elint.el (elint-current-buffer, elint-defun):
	Add autoload cookies.  If necessary, initialize.
	(elint-log): Handle non-file buffers.
	(elint-initialize): Add optional argument to reinitialize.
	(elint-find-builtin-variables): Save excursion.

2009-07-23  Dan Nicolaescu  <dann@ics.uci.edu>

	* emacs-lisp/lisp-mode.el (emacs-lisp-mode-map): Add menu entries
	for Lint.

2009-07-22  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc.el (vc-print-log-internal): New function, split out from ...
	(vc-print-log): ... here.
	(vc-dir-move-to-goal-column): Declare.

	* vc-git.el (vc-git-add-signoff): New variable.
	(vc-git-checkin): Use it.
	(vc-git-toggle-signoff): New function.
	(vc-git-extra-menu-map): Bind it to menu.
	(vc-git--run-command-string): Accept a nil FILE argument.
	(vc-git-stash-list): New function.
	(vc-git-dir-extra-headers): Use it.

2009-07-23  Glenn Morris  <rgm@gnu.org>

	* help-fns.el (describe-variable): Describe ignored and risky local
	variables in a similar way to that in which we describe safe ones.

	* emacs-lisp/bytecomp.el (byte-compile-from-buffer)
	(byte-compile-output-file-form, byte-compile-output-docform)
	(byte-compile-file-form-defmumble, byte-compile-output-as-comment):
	Give some more local variables with common names a "bytecomp-" prefix,
	so as not to shadow things during compilation.
	* emacs-lisp/cl-macs.el (load-time-value)
	* emacs-lisp/cl.el (cl-compiling-file): Update for the name-change
	`outbuffer' to `bytecomp-outbuffer'.

	* emacs-lisp/elint.el (elint-standard-variables): Remove most members,
	since the next two variables cover them automatically now.
	(elint-builtin-variables, elint-autoloaded-variables): New.
	(elint-unknown-builtin-args): Remove all members, since they can be
	parsed automatically now.
	(elint-extra-errors): New.
	(elint-env-add-env, elint-env-add-macro): Use cadr.
	(elint-current-buffer): Use or.  Change final message.
	(elint-get-top-forms): Use line-end-position.
	(elint-init-env): Use cadr.  Handle autoload, declare-function,
	and defalias.
	(elint-add-required-env): Doc fix.  Use or.  Standardize error.
	(regexp-assoc): Remove unused function.
	(elint-top-form): Set elint-current-pos, to record the start of the
	top-level form, for compilation-mode.
	(elint-form): Trap errors in macro expansion.  Use dolist.
	(elint-unbound-variable): Use elint-builtin-variables and
	elint-autoloaded-variables.
	(elint-get-args): Use cadr, or.
	(elint-check-cond-form): Use dolist, cadr.
	(elint-check-condition-case-form): Doc fix.  Use cadr.
	Use elint-extra-errors.
	(elint-log): New function.
	(elint-error, elint-warning): Use elint-log for a bytecomp-style format.
	Distinguish errors and warnings.
	(elint-log-message): Use with-current-buffer.  Inhibit read-only.
	Use a bytecomp-style format.
	(elint-clear-log): Preserve default-directory.  Inhibit read-only.
	(elint-get-log-buffer): Use compilation mode.  Disable undo.
	Don't truncate lines.
	(elint-initialize): Set builtin and autoloaded variable lists.
	Only process elint-unknown-builtin-args if non-nil.
	(elint-find-builtin-variables, elint-find-autoloaded-variables):
	New functions.
	(elint-find-builtin-args): Doc fix.  Handle "BODY...)".

2009-07-22  Kevin Ryde  <user42@zip.com.au>

	* net/newst-backend.el (newsticker--parse-atom-1.0)
	(newsticker--parse-rss-0.91, newsticker--parse-rss-0.92)
	(newsticker--parse-rss-1.0):
	* progmodes/idlwave.el (idlwave-mode):
	* progmodes/idlw-shell.el (idlwave-shell-mode):
	* progmodes/vera-mode.el (vera-mode):
	* progmodes/verilog-mode.el (verilog-auto-inst, verilog-auto):
	* progmodes/vhdl-mode.el (vhdl-mode):
	* textmodes/table.el (table-generate-source)
	(table--warn-incompatibility):
	Hyperlink urls in docstrings with URL `...'.

2009-07-22  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/advice.el, emacs-lisp/checkdoc.el:
	* emacs-lisp/debug.el, emacs-lisp/elp.el, emacs-lisp/gulp.el:
	* emacs-lisp/lisp.el, emacs-lisp/pp.el, emacs-lisp/trace.el:
	Remove leading * from defcustom docs.

	* simple.el (blink-matching-paren-distance): Bump to 100k.  (Bug#3889)

	* emacs-lisp/shadow.el (shadows-compare-text-p): Remove leading * from
	defcustom doc.
	(list-load-path-shadows): Optionally, just return shadows as a string.

	* mail/emacsbug.el (report-emacs-bug): Include any load-path shadows.

2009-07-21  Chong Yidong  <cyd@stupidchicken.com>

	* mail/rmailedit.el (rmail-edit-mode): Use
	auto-save-include-big-deletions.

	* mail/rmail.el (rmail-variables): Use
	auto-save-include-big-deletions.

	* files.el (auto-save-mode): Revert 2009-07-21 and 2009-07-16
	changes.

2009-07-21  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc.el (calc-undo-length): New variable.
	(calc-quit): Truncate rather than eliminate `calc-undo-list'.

2009-07-21  Richard Stallman  <rms@gnu.org>

	* files.el (auto-save-mode): Handle buffer-save-size = -2
	for toggling mode.

2009-07-21  Glenn Morris  <rgm@gnu.org>

	* textmodes/ispell.el (ispell-looking-back): Update declaration.

	* calendar/todo-mode.el (calendar-current-date): Update declaration.

	* ps-print.el (ps-jitify, ps-lazify): Remove aliases only used to
	silence compiler.  Instead...
	(jit-lock-fontify-now, lazy-lock-fontify-region): ...Declare.
	(ps-print-ensure-fontified): Update for above function name changes.

	* printing.el (pr-mh-get-msg-num, pr-mh-show)
	(pr-mh-start-of-uncleaned-message): Remove aliases only used to
	silence compiler.  Instead...
	(mh-get-msg-num, mh-show, mh-start-of-uncleaned-message): ...Declare.
	(mh-show-buffer): Only define for compiler.
	(pr-mh-current-message): Update for above function name changes.

	* files.el (abort-if-file-too-large): Explicitly pass `filename'
	as an argument.
	(find-file-noselect, insert-file-1): Update for above change.

	* mail/rmail.el (rmail-retry-ignored-headers): Bump :version.

	* mail/mailclient.el (mailclient-send-it): Fix message.

	* emacs-lisp/edebug.el (cl-debug-env): Only define for compiler.
	(edebug-eval): Check cl-debug-env is bound.
	(print-level, print-circle): Don't redefine built-in variables.

	* emacs-lisp/cust-print.el: Remove leading * from defcustom docs.
	(custom-print-vectors): Remove old comments from doc.

	* emerge.el (menu-bar-emerge-menu): Remove unused variable.
	(emerge-version): Make the variable an obsolete alias for the
	emacs-version variable.  Make the function obsolete.
	(emerge-fast-keymap, emerge-edit-keymap): Make a separate menu for
	Emerge options, rather than merging in into the main Options menu.
	(emerge-options-menu): Adjust menu text.  Use buttons for skip prefers
	and auto advance modes.  Disable edit/fast items when not relevant.

2009-07-20  Dan Nicolaescu  <dann@ics.uci.edu>

	* term/vt420.el (terminal-init-vt420): Fix typo.

2009-07-20  Sam Steingold  <sds@gnu.org>

	* progmodes/ada-mode.el (compile-auto-highlight): Remove the
	variable (removed from compile.el on 2004-03-11).

2009-07-20  Chong Yidong  <cyd@stupidchicken.com>

	* files.el (hack-local-variables-filter): Fix last change.

2009-07-19  Juri Linkov  <juri@jurta.org>

	* files.el (ignored-local-variables): Add `dir-local-variables-alist'.
	(dir-local-variables-alist): New buffer-local variable.
	(hack-local-variables-filter): If variable is not dir-local,
	i.e. `dir-name' is nil, then remove it from `dir-local-variables-alist',
	because file-local overrides dir-local.
	(c-postprocess-file-styles) <declare-function>:
	Remove obsolete declaration.
	(hack-dir-local-variables): Add dir-local variable/value pair to
	`dir-local-variables-alist' and remove duplicates.  Doc fix.

	* help-fns.el (describe-variable): Add information about
	file-local and dir-local variables.

2009-07-19  Chong Yidong  <cyd@stupidchicken.com>

	* files.el (hack-local-variables-filter): Rewrite.

2009-07-19  Glenn Morris  <rgm@gnu.org>

	* progmodes/verilog-mode.el (verilog-error-regexp-add-xemacs):
	Silence compiler by only defining on XEmacs.

	* international/mule.el (auto-coding-regexp-alist): Only match
	BABYL... at the start of buffer, not of lines.  (Bug#3790)

	* calendar/cal-menu.el (cal-menu-set-date-title): Handle calls from
	non-calendar buffers (Bug#3862).  Restore "not on a date" message.
	(cal-menu-context-mouse-menu): Doc fix.

	* desktop.el (desktop-buffers-not-to-save): Set :version tag.

	* simple.el (mail-user-agent): Doc fix.  Set :version tag.

2009-07-18  Juri Linkov  <juri@jurta.org>

	* info.el: Virtual Info keyword finder.
	(add-to-list) <Info-virtual-files>: Add "\\`\\*Finder.*\\*\\'".
	(Info-finder-file): New variable.
	(Info-finder-find-file): New function.
	(finder-known-keywords, finder-package-info)
	(find-library-name, lm-commentary): Use defvar and
	declare-function to silence compiler warnings.
	(Info-finder-find-node): New function.
	(info-finder): New command.

	* subr.el (process-kill-buffer-query-function): New function.
	(add-hook)<kill-buffer-query-functions>: Add hook
	`process-kill-buffer-query-function'.

2009-07-18  Alan Mackenzie  <acm@muc.de>

	* progmodes/cc-mode.el (c-before-hack-hook)
	(c-postprocess-file-styles): Give invocation of `c-set-style'
	DONT-OVERRIDE parameter of t.  Already set style variables will
	thus not be overridden by style settings given by `c-file-syle'.

	* files.el (hack-local-variables-filter): Remove entries with
	duplicate keys from `file-local-variables-alist'.

2009-07-18  Eli Zaretskii  <eliz@gnu.org>

	* simple.el (deactivate-mark, activate-mark, set-mark): Don't call
	x-set-selection if display-selections-p returns nil for the
	current frame.

2009-07-18  Chong Yidong  <cyd@stupidchicken.com>

	* simple.el (region-active-p, use-region-p): Doc fix (Bug#3873).

2009-07-18  Eli Zaretskii  <eliz@gnu.org>

	* desktop.el (desktop-buffers-not-to-save): Default value is nil.
	Accept nil in addition to a regexp.
	(desktop-files-not-to-save): Add "(ftp)$" to the default regexp.
	Accept nil in addition to a regexp.
	(desktop-save-buffer-p): Don't use desktop-buffers-not-to-save for
	buffers that have an associated file.  Handle nil values of
	desktop-buffers-not-to-save and desktop-files-not-to-save.
	(Bug#3833)

	* term/pc-win.el (x-selection-owner-p, x-own-selection-internal)
	(x-disown-selection-internal): New functions.

2009-07-18  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-mi.el (speedbar-frame): Declare to avoid compiler
	warning.
	(gdb-breakpoints-header): Move forward to avoid compiler warning.
	(gdb-make-header-line-mouse-map): Remove duplicate definition.

2009-07-18  David De La Harpe Golden  <david@harpegolden.net>

	* simple.el (set-mark): Revert last change.

2009-07-17  Tassilo Horn  <tassilo@member.fsf.org>

	* doc-view.el (doc-view-initiate-display): Add yes-or-no-p if
	rendering of pngs is not possible instead of messaging a long
	description.

2009-07-17  David De La Harpe Golden  <david@harpegolden.net>

	* w32-fns.el (x-selection-owner-p): New function.

	* mouse.el (mouse-drag-track): Call deactivate-mark earlier.
	(mouse-yank-at-click, mouse-yank-primary): If
	select-active-regions is non-nil, deactivate the mark before
	insertion.

	* simple.el (deactivate-mark, set-mark): Only save selection if we
	own it.

2009-07-17  Kenichi Handa  <handa@m17n.org>

	* case-table.el (describe-buffer-case-table): Fix for the case
	that KEY is a cons.

2009-07-16  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-rcs.el (vc-rcs-find-file-hook):
	* vc-sccs.el (vc-sccs-find-file-hook): Fix cut and paste error.

2009-07-16  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-wait-for-output): Handle the case when
	commands do not return a newline but a null byte before the shell
	prompt.  (Bug#3858)

2009-07-16  YAMAMOTO Mitsuharu  <mituharu@math.s.chiba-u.ac.jp>

	* term/ns-win.el (ns-set-alpha): Don't declare.
	(ns-set-background-alpha): Remove function.

2009-07-16  Kevin Ryde  <user42@zip.com.au>

	* emacs-lisp/copyright.el (copyright-update): Save match-data across
	y-or-n-p, for safety.

2009-07-16  Richard Stallman  <rms@gnu.org>

	* files.el (auto-save-mode): If buffer-saved-size is -2,
	don't clobber it.

	* mail/rmail.el (rmail-variables): Set buffer-saved-size to -2.
	(rmail-retry-ignored-headers): Add more uninteresting fields.

2009-07-15  Jari Aalto  <jari.aalto@cante.net>

	* net/rcirc.el (rcirc): Use history variables.
	(rcirc-server-name-history, rcirc-nick-name-history)
	(rcirc-server-port-history): New variables.

2009-07-15  Kenichi Handa  <handa@m17n.org>

	* international/mule-cmds.el (set-language-environment-charset):
	If coding-system-charset-list returns `iso-2022' or `emacs-mule',
	ignore them.

	* language/misc-lang.el ("IPA"): Change coding systems to utf-8.
	Delete unibyte-display.

2009-07-15  Chong Yidong  <cyd@stupidchicken.com>

	* simple.el (kill-visual-line): Obey kill-whole-line (Bug#3695).

2009-07-15  Chong Yidong  <cyd@stupidchicken.com>

	* simple.el (deactivate-mark): Optional argument FORCE.
	(set-mark): Use deactivate-mark.

	* info.el (Info-search): No need to check transient-mark-mode
	before calling deactivate-mark.

	* select.el (x-set-selection): Doc fix.
	(x-valid-simple-selection-p): Allow buffer values.
	(xselect--selection-bounds): Handle buffer values.  Suggested by
	David De La Harpe Golden.

	* mouse.el (mouse-set-region, mouse-drag-track): Call
	copy-region-as-kill before setting the mark, to let
	select-active-regions work.

2009-07-15  David De La Harpe Golden  <david@harpegolden.net>

	* simple.el (deactivate-mark): If select-active-regions is
	non-nil, copy the selection data into a string.
	(activate-mark): If select-active-regions is non-nil, set the
	selection to the current buffer.
	(set-mark): Update selection if select-active-regions is non-nil.

	* select.el (x-valid-simple-selection-p): Allow buffer values.

2009-07-14  Stefan Monnier  <monnier@iro.umontreal.ca>

	* simple.el (mail-user-agent): Default to the upwardly-UI-compatible
	and more featureful message-mode.

2009-07-14  Chong Yidong  <cyd@stupidchicken.com>

	* select.el (x-set-selection): Doc fix.
	(x-valid-simple-selection-p): Disallow selection data consisting
	of a list or cons of integers, since that is not used.
	(xselect--selection-bounds, xselect--int-to-cons): New functions.
	(xselect-convert-to-string, xselect-convert-to-length)
	(xselect-convert-to-filename, xselect-convert-to-charpos)
	(xselect-convert-to-lineno, xselect-convert-to-colno): Use them.

2009-07-14  Dmitry Dzhus  <dima@sphinx.net.ru>

	* progmodes/gdb-mi.el (json-partial-output): Fix broken GDB/MI
	output in -break-info command (Emacs bug #3794).

2009-07-14  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/edebug.el (edebug-setup-hook, edebug-all-forms)
	(edebug-eval-macro-args, edebug-save-displayed-buffer-points)
	(edebug-print-length, edebug-print-level, edebug-print-circle)
	(edebug-sit-for-seconds, edebug-view-outside)
	(edebug-bounce-point, edebug-set-global-break-condition)
	(edebug-Go-nonstop-mode, edebug-trace-mode)
	(edebug-Trace-fast-mode, edebug-continue-mode)
	(edebug-Continue-fast-mode, edebug-forward-sexp, edebug-help)
	(edebug-visit-eval-list): Doc fixes.

	* subr.el (def-edebug-spec): Doc fix.

2009-07-14  Kenichi Handa  <handa@m17n.org>

	* international/characters.el: Fix setting of category ?C.

2009-07-13  Jan Djärv  <jan.h.d@swipnet.se>

	* term/ns-win.el (x-select-font): defalias x-select-font to
	ns-popup-font-panel instead of generate-fontset-menu.

2009-07-12  Eli Zaretskii  <eliz@gnu.org>

	* desktop.el (desktop-buffers-not-to-save): Remove ".log".  (Bug#3833)

2009-07-12  Peter Jolly  <peter@jollys.org>  (tiny change)

	* arc-mode.el (archive-find-type): Allow for a PK00 string before
	the PK\003\004 header (Bug#3770).

2009-07-12  Guanpeng Xu  <herberteuler@hotmail.com>

	* pcomplete.el (pcomplete-comint-setup): Check for
	shell-dynamic-complete-filename too.

2009-07-11  Chong Yidong  <cyd@stupidchicken.com>

	* simple.el (temporary-goal-column): Change the value for
	line-move-visual to a cons cell.
	(line-move-visual): Record or set the window hscroll, if
	necessary (Bug#3494).
	(line-move-1): Handle cons value of temporary-goal-column.

2009-07-11  Kenichi Handa  <handa@m17n.org>

	* international/mule-diag.el (describe-character-set): Don't show
	width.

2009-07-10  Sam Steingold  <sds@gnu.org>

	* progmodes/compile.el (compilation-mode-font-lock-keywords):
	Omake sometimes indents the errors it prints, so allow all
	regexps to start with spaces.

2009-07-10  Eli Zaretskii  <eliz@gnu.org>

	* cus-edit.el (customize-changed-options-previous-release):
	Bump value to 22.1.  (Bug#3804)

2009-07-08  Sam Steingold  <sds@gnu.org>

	* progmodes/grep.el (rgrep): Allow grep-find-ignored-directories
	to be a cons cell (test . ignored-directory) to selectively ignore
	some directories depending on the location of the search.

2009-07-08  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-set-file-uid-gid): Handle the case the
	remote user is root, on the local host.
	(tramp-local-host-p): Either the local user or the remote user
	must be root.  (Bug#3771)

2009-07-08  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-mi.el (gdb): Remove description of
	gdb-use-separate-io-buffer.
	(menu): Don't allow toggling of or enable
	gdb-use-separate-io-buffer from menubar.

2009-07-08  E. Jay Berkenbilt  <ejb@ql.org>  (tiny change)

	* mail/unrmail.el (unrmail): Make sure the message ends with two
	newlines (Bug#3769).

2009-07-08  Glenn Morris  <rgm@gnu.org>

	* calendar/calendar.el (calendar-current-date): Rework previous change.

2009-07-08  Ed Reingold  <reingold@emr.cs.iit.edu>

	* calendar/calendar.el (calendar-current-date):
	Add an optional argument giving an offset from today.

2009-07-08  Glenn Morris  <rgm@gnu.org>

	* tutorial.el (tutorial--describe-nonstandard-key):
	Adjust the message for when a key has been unbound.
	(help-with-tutorial): Hide the arch-tag.

2009-07-08  Kenichi Handa  <handa@m17n.org>

	* international/fontset.el (setup-default-fontset): For each
	script, append (not set) font-specs.

	* language/japanese.el (japanese-shift-jis-2004): Fix typo in the
	docstring.

2009-07-08  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-mi.el (gdb-init-1): Move sending
	-data-list-register-names to ...
	(gdb-starting): ... here because GDB 7.0 requires execution to
	have started when using this MI command.
	(gdb-set-header): New function to distinguish select and
	unselected tabs in gdb buffers.
	(gdb-propertize-header): New macro that uses gdb-set-header.
	(gdb-breakpoints-header, gdb-locals-header): Use it.
	(gdb-disassembly-mode-map): Add keybinding to kill buffer.

2009-07-07  Chong Yidong  <cyd@stupidchicken.com>

	* Makefile.in (ELCFILES): Remove fadr.elc.

2009-07-07  Dmitry Dzhus  <dima@sphinx.net.ru>

	* progmodes/gdb-mi.el (gdb-init-1): Disassembly buffer mode name
	may contain frame information, so `string-match' should be used.
	(gdb-update): Disassembly is invalidated through
	`gdb-get-selected-frame'.
	(gdb-pad-string): New function to pad string with spaces.
	(gdb-invalidate-disassembly): Invalidate only if the buffer
	exists.
	(gdb-disassembly-handler-custom): Column alignment.
	(gdb-disassembly-place-breakpoints): Clear old breakpoints before
	placing new ones.
	(gdb-toggle-breakpoint, gdb-delete-breakpoint): Now work from the
	end of line, too.
	(gdb-frame-handler): Match convention to for disassembly buffer
	mode name.
	(gdb-stack-list-frames-handler): Rewritten without regexps.
	(gdb-breakpoints-list-handler-custom): y/n instead of on/off; do
	not highlight breakpoints without line information.
	(gdb-input): Add trailing newline to command.

	* progmodes/gdb-mi.el (gdb-init-1): Set mode name for disassembly
	buffer properly.
	(gdb-breakpoints-list-handler-custom): Replacement for
	`gdb-break-list-handler'.  Using real parser instead of regexps
	now.
	(gdb-place-breakpoints): Replacement for `gdb-break-list-custom'.
	Use `gdb-breakpoints-list' instead of parsing breakpoints buffer
	to place breakpoints.
	(def-gdb-memory-unit): A new macro to define gdb-memory-unit-..
	functions.
	(gdb-disassembly-handler-custom): Show overlay arrow.
	(gdb-disassembly-place-breakpoints): Show breakpoints in
	disassembly buffer.
	(gdb-toggle-breakpoint, gdb-delete-breakpoint)
	(gdb-goto-breakpoint): Using `gdb-breakpoint' text properties
	instead of parsing breakpoints buffer.  Fixed old menu references
	in `gud-menu-map'.

	* fadr.el: Remove.

	* progmodes/gdb-mi.el: Port memory buffer from gdb-ui.el.
	(gdb-memory-address): New variable which holds top address of
	memory page shown in memory buffer.
	(gdb-memory-repeat-count, gdb-memory-format, gdb-memory-unit): New
	customization variables.
	New functions:
	(gdb-display-memory-buffer, gdb-frame-memory-buffer): Functions to
	display the memory buffer.
	(gdb-memory-set-address, gdb-memory-set-repeat-count): Set memory
	buffer display parameters.
	(def-gdb-memory-format, gdb-memory-format-binary)
	(gdb-memory-format-octal, gdb-memory-format-unsigned)
	(gdb-memory-format-signed, gdb-memory-format-hexadecimal):
	Functions for setting memory buffer format.
	(gdb-memory-unit-word, gdb-memory-unit-halfword)
	(gdb-memory-unit-giant, gdb-memory-unit-byte): Functions to set
	unit size used in memory buffer.
	(gdb-memory-show-next-page, gdb-memory-show-previous-page): Switch
	to next/previous page of memory buffer.
	Now using (bindat-get-field) instead of fadr functions.

2009-07-07  Sam Steingold  <sds@gnu.org>

	* vc-cvs.el (vc-cvs-merge-news): Fix message parsing for
	non-top-level files.

2009-07-07  Kenichi Handa  <handa@m17n.org>

	* international/mule-cmds.el (reset-language-environment): Put
	the highset priority to the charset iso-8859-1.

2009-07-06  Chong Yidong  <cyd@stupidchicken.com>

	* progmodes/hideshow.el (hs-hide-block-at-point): Don't move point
	to the end of the line when locating the block (Bug#700).

2009-07-06  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-handle-write-region): Flush file properties
	in case of short track.

2009-07-06  Michael McNamara  <mac@mail.brushroad.com>

	* progmodes/verilog-mode.el (verilog-error-regexp-emacs-alist):
	Coded custom representation of verilog error regular expressions
	to work with Emacs-22's new format.
	(verilog-error-regexp-xemacs-alist): Coded custom representation
	of verilog error regular expressions to work with XEmacs format.
	(verilog-error-regexp-add-xemacs): Hook routine to install verilog
	error recognition into XEmacs.
	(verilog-error-regexp-add-emacs): Hook routine to install verilog
	error recognition into Emacs-22.

2009-07-06  Chong Yidong  <cyd@stupidchicken.com>

	* woman.el: Remove stand-alone closing parentheses.
	(woman-file-name, woman2-format-paragraphs)
	(woman-leave-blank-lines): Code cleanup.
	(woman-use-own-frame): Change default to nil.
	(woman-italic, woman-bold, woman-unknown, woman-addition): Change
	defaults to inherit from default faces.
	(woman2-process-escapes): Consume the newline after a stand-alone
	filler character (Bug#3651).

2009-07-06  Glenn Morris  <rgm@gnu.org>

	* ffap.el (ffap-version): Make it an obsolete alias for emacs-version.
	(top-level): Move provide to the end.
	(ffap): Remove defunct URL from custom group.

	* subr.el (eval-after-load): Doc fix.

2009-07-06  Vincent Belaïche  <vincent.belaiche@gmail.com>

	* calc/calc-embed.el (calc-embedded-make-info): Don't force when
	`calc-embedded-word' is called twice.

2009-07-05  Stefan Monnier  <monnier@iro.umontreal.ca>

	* files.el (find-alternate-file-other-window, find-alternate-file):
	Obey confirm-nonexistent-file-or-buffer.

2009-07-05  Michael Albinus  <michael.albinus@gmx.de>

	* dired-aux.el (dired-show-file-type): Handle remote files.

2009-07-05  Jari Aalto  <jari.aalto@cante.net>

	* desktop.el (desktop-globals-to-save):
	Add file-name-history (Bug#2750).

2009-07-05  Chong Yidong  <cyd@stupidchicken.com>

	* add-log.el (add-log-current-defun-header-regexp): Doc fix (Bug#2217).

2009-07-04  Johan Bockgård  <bojohan@gnu.org>

	* eshell/esh-arg.el (eshell-parse-argument-hook): Put `number'
	property on entire argument since this is what eshell-lisp-command
	expects.

2009-07-03  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-gvfs.el (tramp-gvfs-methods)
	(tramp-gvfs-zeroconf-domain)
	(tramp-bluez-discover-devices-timeout): Add version flag.
	(tramp-gvfs-handler-mounted-unmounted)
	(tramp-gvfs-connection-mounted-p): Polish handling of
	incompatibilities between GVFS 0.2 and 1.0.

2009-07-03  Jan Djärv  <jan.h.d@swipnet.se>

	* cus-start.el (all): Add make-pointer-invisible.

2009-07-03  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-math.el (math-use-emacs-fn): Make sure that the number is
	formatted correctly.

2009-07-02  Juri Linkov  <juri@jurta.org>

	* info.el: Virtual Info files and nodes.
	(Info-virtual-files, Info-virtual-nodes): New variables.
	(Info-current-node-virtual): New variable.
	(Info-virtual-file-p, Info-virtual-fun, Info-virtual-call):
	New functions.
	(Info-file-supports-index-cookies): Use Info-virtual-file-p
	to check for a virtual file instead of checking a fixed list
	of node names.
	(Info-find-file): Use Info-virtual-fun and Info-virtual-call
	instead of ad-hoc processing of "dir" and (apropos history toc).
	(Info-find-node-2): Use Info-virtual-fun and Info-virtual-call
	instead of ad-hoc processing of "dir" and (apropos history toc).
	Reread a file when moving from a virtual node.
	(add-to-list)<Info-virtual-files>: Add "\\`dir\\'".
	(Info-directory-toc-nodes, Info-directory-find-file)
	(Info-directory-find-node): New functions.
	(add-to-list)<Info-virtual-files>: Add "\\`\\*History\\*\\'".
	(Info-history): Move part of code to
	`Info-history-find-node'.
	(Info-history-toc-nodes, Info-history-find-file)
	(Info-history-find-node): New functions.
	(add-to-list)<Info-virtual-nodes>: Add "\\`\\*TOC\\*\\'".
	(Info-toc): Move part of code to `Info-toc-find-node'.
	(Info-toc-find-node): New function.
	(Info-toc-insert): Rename from `Info-insert-toc'.  Don't insert
	the current Info file name to references because now the node
	"*TOC*" belongs to the same Info manual.
	(Info-toc-build): Rename from `Info-build-toc'.
	(Info-toc-nodes): Rename input argument `file' to `filename'.
	Use Info-virtual-fun, Info-virtual-call and Info-virtual-file-p
	instead of ad-hoc processing of ("dir" apropos history toc).
	(Info-index-nodes): Use Info-virtual-file-p
	to check for a virtual file instead of checking a fixed list
	of node names.
	(Info-index-node): Add check for `Info-current-node-virtual'.
	Raise `save-match-data' higher up the tree to contain
	`search-forward' too (bug fix).
	(add-to-list)<Info-virtual-nodes>: Add "\\`\\*Index.*\\*\\'".
	(Info-virtual-index-nodes): New variable.
	(Info-virtual-index-find-node, Info-virtual-index): New functions.
	(add-to-list)<Info-virtual-files>: Add "\\`\\*Apropos\\*\\'".
	(Info-apropos-file, Info-apropos-nodes): New variables.
	(Info-apropos-toc-nodes, Info-apropos-find-file)
	(Info-apropos-find-node, Info-apropos-matches): New functions.
	(info-apropos): Move part of code to `Info-apropos-find-node' and
	`Info-apropos-matches'.
	(Info-mode-map): Bind "I" to `Info-virtual-index'.
	(Info-desktop-buffer-misc-data): Use Info-virtual-file-p to check
	for a virtual file instead of checking a fixed list of node names.

	* simple.el (async-shell-command): New command.

	* bindings.el (esc-map): Bind "&" to `async-shell-command'.

	* net/tramp-gvfs.el (tramp-gvfs-connection-mounted-p): Use `elt'
	instead of `mount-info'.

2009-07-02  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-gvfs.el (tramp-gvfs-handler-mounted-unmounted)
	(tramp-gvfs-connection-mounted-p): Handle changed mount-info interface.

2009-07-02  Kenichi Handa  <handa@m17n.org>

	* international/mule.el (set-keyboard-coding-system): Force *-unix
	coding-system to avoid eol conversion.

2009-07-01  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-gvfs.el (tramp-gvfs-file-name-handler-alist):
	Add handler for `process-file', `shell-command' and
	`start-file-process'.
	(tramp-gvfs-handle-shell-command)
	(tramp-gvfs-handle-start-file-process)
	(tramp-gvfs-handle-process-file): New defuns.
	(tramp-synce-list-devices): Simplify check for existence of property.

2009-07-01  Jan Djärv  <jan.h.d@swipnet.se>

	* startup.el (command-line-x-option-alist): Add -mm and --maximized.

2009-07-01  Eduard Wiebe  <usenet@pusto.de>  (tiny change)

	* language/korean.el (set-language-info-alist): Add korean-cp949,
	cp949 to spec.

2009-07-01  Kenichi Handa  <handa@m17n.org>

	* Makefile.in (ELCFILES): Delete encoded-kb.elc.

	* international/encoded-kb.el: Deleted.

	* international/mule.el (set-keyboard-coding-system): Perform the
	necessary setup here instead of calling encoded-kbd-setup-display.

2009-07-01  Glenn Morris  <rgm@gnu.org>

	* progmodes/f90.el (f90-break-delimiters, f90-no-break-re): Doc fixes.

2009-07-01  Evangelos Evangelou  <vangelis@email.unc.edu>  (tiny change)

	* progmodes/f90.el (f90-no-break-re): Add "(/" and "/)".  (Bug#3730)

2009-06-30  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-do-copy-or-rename-file-directly):
	Handle also the 'rename case, when setting file modes.  (Bug#3712)
	(tramp-default-file-modes): Remove execute permissions.

	* net/tramp-gvfs.el (tramp-gvfs-methods): Add "synce" method.
	(top): Add a default for "synce" in `tramp-default-user-alist'.
	Add completion function for "synce" method.
	(tramp-hal-service, tramp-hal-path-manager)
	(tramp-hal-interface-manager, tramp-hal-interface-device):
	New defconst.
	(tramp-gvfs-connection-mounted-p): Handle empty user name for synce.
	(tramp-synce-list-devices, tramp-synce-parse-device-names):
	New defuns.

	* net/trampver.el: Update release number.

2009-06-30  Kenichi Handa  <handa@m17n.org>

	* international/fontset.el (setup-default-fontset): Add CJK fonts
	for symbols and the other miscellaneous characters.

	* language/korea-util.el (setup-korean-environment-internal):
	Make char-width-table suitable for Korean environments.
	(exit-korean-environment): Cancel above.

	* language/chinese.el ("Chinese-GB", "Chinese-BIG5")
	("Chinese-CNS", "Chinese-EUC-TW", "Chinese-GBK"): Add a
	setup-function to make char-width-table suitable for respective
	environments, and an exit-function to cancel that.

	* language/japan-util.el (setup-japanese-environment-internal):
	Call use-cjk-char-width-table with arg `ja_JP'.

	* international/characters.el (cjk-char-width-table): Delete it.
	(cjk-char-width-table-list): New variable.
	(use-cjk-char-width-table): New arg local-name.
	(use-default-char-width-table): Fix for the case that Emacs is
	already using the default char-width-table.

2009-06-29  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-do-copy-or-rename-file-directly): Set file
	modes mandatory.  (Bug#3712)

2009-06-29  Alan Mackenzie  <acm@muc.de>

	* progmodes/cc-cmds.el (c-mask-paragraph): Remove a spurious
	correction between the visible width of TABs and their number of bytes.

2009-06-29  Chong Yidong  <cyd@stupidchicken.com>

	* server.el (server-buffer-done): Prevent kill-buffer from
	prompting by clearing the buffer modification flag (Bug#3696).

2009-06-28  Michael McNamara  <mac@mail.brushroad.com>

	* progmodes/verilog-mode.el (verilog-beg-of-statement)
	(verilog-endcomment-reason-re): Support unique case and priority case.
	(verilog-basic-complete-re): Support localparam lineup.
	(verilog-beg-of-statement-1): Fix for robustness, unique case.
	(verilog-set-auto-endcomments): Fix for unique case, always_comb
	commenting.
	(verilog-leap-to-case-head): Now support *nested* unique &
	priority case statements.
	(verilog-auto-lineup): Make just declarations the default (as it
	had been).
	(verilog-leap-to-case-head): Support priority/unique case statements.
	(verilog-auto-lineup): Rework to give users radio buttons to
	select the various styles of automatic lineup.
	(verilog-error-regexp-alist): Rework to support the XEmacs style
	of error regular expressions from compilers, lint tools &
	simulators.  Note that GNU Emacs has made it impossible for a mode
	to load such things.
	(electric-verilog-terminate-line, verilog-indent-declaration)
	(verilog-auto-wiure): Rework for radio button selection of
	auto-lineup selection of specification of auto lineup.
	(verilog-beg-of-statement-1): Redesign to support proper operation
	in additional code, based on testing with auto-lineup.
	(verilog-calculate-indent, assignments & declarations)
	(verilog-backward-token): Enhance to support auto-lineup of
	assignments & declarations.
	(verilog-in-directive-p, verilog-at-struct-p): New function for
	easy test of whether we are.
	(verilog-pretty-declarations, verilog-pretty-expr): Massive rework
	to support safe execution at almost anyline.
	(verilog-calc-1): Properly support indenting deep inside generate
	blocks.
	(verilog-init-font): Remove definition & use of verilog-init-font,
	as it is redundant with font-lock-defaults.
	(verilog-mode): Alter the definition of verilog-font-lock-defaults
	to avoid circular calls if syntax-ppss is a function (as is the
	case now in 22.x GNU Emacs) as that function would sometimes call
	itself, leading to (nearly) infinite recursion.
	(verilog-ovm-begin-re, verilog-ovm-end-re)
	(verilog-ovm-statement-re, verilog-leap-to-head)
	(verilog-backward-token): Add support for OVM macros.  Some are
	complete statements, and others open and close scopes like begin
	and end.
	(verilog-defun-level-not-generate-re, verilog-defun-level-re)
	(verilog-defun-level-generate-only-re): Really fix the defun-list
	compilation issue.
	(verilog-calc-1, verilog-beg-of-statement): Enhance support for
	coverpoint, constraint and cross statements.
	(verilog-defun-level-list, verilog-generate-defun-level-list)
	(verilog-all-defun-level-list): Redo these specifications - it is
	too hard to support eval-when compile aggregation of lists also
	built at when-compile time.
	(verilog-defun-level-list): Place defconsts of variables used in
	building regular expressions which are built in eval-when-compile
	bodies in the same eval-when-compile body to facilitate compile
	without load.
	(verilog-beg-block-re-ordered): Support indenting
	virtual/protected tasks and functions.
	(verilog-defun-level-list, verilog-in-generate-region-p)
	(verilog-backward-ws&directives, verilog-calc-1): Speed up
	indentation of some module items (generate items).
	(verilog-forward-sexp, verilog-leap-to-head): Support stepping
	across virtual/protected tasks and functions.

2009-06-28  Wilson Snyder  <wsnyder@wsnyder.org>

	* progmodes/verilog-mode.el (verilog-auto-arg, verilog-auto-arg-sort):
	Allow sorting AUTOARG lists.  Suggested by Andrea Fedeli.
	(verilog-read-sub-decls-line): Fix AUTOWIRE signals getting lost
	in concatenations.  Reported by Yishay Belkind.
	(verilog-auto-ascii-enum): Support one-hot state machines in
	AUTOASCIIENUM.  Suggested by Lloyd Gomez.
	(verilog-auto-inst, verilog-auto-inst-port): Include interface
	modport in AUTOINST and add vl-modport for users.  Reported by
	David Rogoff.
	(verilog-auto-inout-module, verilog-auto-inst)
	(verilog-decls-get-interfaces, verilog-insert-definition)
	(verilog-insert-one-definition, verilog-read-decls)
	(verilog-read-sub-decls, verilog-read-sub-decls-sig)
	(verilog-sig-modport, verilog-signals-combine-bus)
	(verilog-subdecls-get-interfaces): Fix expansion of SystemVerilog
	interfaces in AUTOINOUTMODULE, AUTOINOUTCOMP, and AUTOINST.
	Suggested by David Rogoff.
	(verilog-repair-open-comma): Fix non-insertion of comma when
	`DEFINE occurs in V2K argument list.  Reported by Lane Brooks.
	(verilog-make-width-expression): Simplify [A-1:0] expression
	widths to just {A{1'b0}}.
	(verilog-mode): Cleanup checkdoc warnings.
	(verilog-auto-inout-module, verilog-signals-matching-dir-re):
	Add third optional regexp to AUTOINOUTMODULE to allow selecting only
	inputs/outputs or data type.  Suggested by Vasu Kandadi.
	(next-error-last-buffer): Fix byte-compiler warning.
	(verilog-auto, verilog-auto-insert-lisp, verilog-auto-inst)
	(verilog-delete-auto): Add AUTOINSERTLISP to insert arbitrary lisp
	or shell command text during AUTO expansion.  Suggested by Tad Truex.
	(verilog-read-sub-decls-expr, verilog-read-sub-decls-line)
	(verilog-read-sub-decls-sig, verilog-symbol-detick-text):
	Fix dotted nets {a.b,c.d} and excaped identifiers being mis-included
	in AUTOINOUT.  Reported by Matthew Lovell.
	(verilog-read-always-signals-recurse): Fix AUTORESET "if (a<=b)"
	causing use of <= assignments.  Reported by Alex Reed.
	(verilog-read-decls): Fix triand, trior, wand, wor to be
	recognized by AUTOWIRE.  Reported by Spencer Isaacson.
	(verilog-extended-complete-re): Support import "DPI-C" functions.
	(verilog-read-always-signals-recurse): Fix AUTORESET of "x <=
	y[a+1:a+1]" to not include a in reset list.  Reported by Dan Dever.
	(verilog-insert-date, verilog-insert-year)
	(verilog-sk-header-tmpl): Fix verilog-header inserting error on
	Windows systems.  Reported by Michael Potts.
	(verilog-read-module-name): Fix AUTOINST when the child module
	declaration's name is a tick define.  Reported by Elliot Mednick.
	(verilog-read-decls): Fix V2K parameter bit subscripts getting
	passed to next parameter's definition.  Reported by Bruce T.
	(verilog-read-decls): Fix detecting "parameter int" when using
	AUTOINSTPARAM.  Reported by Bruce T.
	(verilog-goto-defun): Fix goto not finding modules unless first
	perform a verilog-auto expansion.  Suggested by Lawrence Butcher.
	(verilog-mode): Expand -f flag arguments on entry to mode so
	verilog-goto-defun will work.  Reported by Lawrence Butcher.
	(verilog-getopt): Expand environment variables in -f file
	arguments.  Suggested by Lawrence Butcher.
	(verilog-set-define): Fix "Symbol's value as variable is void"
	when reading enumerations.
	(verilog-auto-ascii-enum): Fix duplicate labels in AUTOASCIIENUM.
	Suggested by Stephen Peltan.
	(verilog-read-defines): Fix reading of enumerations in include
	files.  Reported by Steve Peltan.

2009-06-28  David De La Harpe Golden  <david@harpegolden.net>

	* files.el (trash-directory): Fix defcustom type.

2009-06-28  Juri Linkov  <juri@jurta.org>

	* help-fns.el (describe-function-1): Correctly locate adviced
	functions in hyperlink (Bug#2438).

2009-06-28  Chong Yidong  <cyd@stupidchicken.com>

	* files.el (trash-directory): Change default to nil.
	(move-file-to-trash): If trash-directory is nil and
	system-move-file-to-trash is unbound, perform freedesktop-style
	trashing.

2009-06-28  David De La Harpe Golden  <david@harpegolden.net>

	* files.el (move-file-to-trash): Add freedesktop trash
	support (Bug#973).

2009-06-28  Glenn Morris  <rgm@gnu.org>

	* autorevert.el (global-auto-revert-non-file-buffers)
	(global-auto-revert-mode): Doc fixes.

2009-06-27  Johan Bockgård  <bojohan@gnu.org>

	* emacs-lisp/cl-specs.el (defstruct): Fix :conc-name spec.

2009-06-27  Chong Yidong  <cyd@stupidchicken.com>

	* faces.el (x-handle-named-frame-geometry): Ensure that we have
	opened an X connection before calling x-get-resource (Bug#3194).

	* play/doctor.el: Remove reference to obsolete website.
	(make-doctor-variables): Correct grammar mistake (Bug#2633).

2009-06-26  Dan Nicolaescu  <dann@ics.uci.edu>

	Remove find-file-not-found-hook VC method.  (Bug#2757)
	* vc-hooks.el (vc-file-not-found-hook)
	(vc-default-find-file-not-found-hook): Remove functions.
	(find-file-not-found-functions): Do not add vc-file-not-found-hook.
	* vc-rcs.el (vc-rcs-find-file-not-found-hook): Remove function.
	* vc.el:
	* vc-hg.el:
	* vc-git.el: Do not mention find-file-not-found-hook VC method.

2009-06-25  Agustín Martín  <agustin.martin@hispalinux.es>

	* textmodes/ispell.el: Add `ispell-looking-back' XEmacs
	compatibility function for `looking-back'.

	* textmodes/flyspell.el (sgml-mode-flyspell-verify):
	Use `ispell-looking-back'.

2009-06-24  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-gvfs.el (tramp-gvfs-handle-make-directory): Use `dir'
	rather than `filename'.

2009-06-23  Miles Bader  <miles@gnu.org>

	* face-remap.el (text-scale-set): New function.

2009-06-23  Glenn Morris  <rgm@gnu.org>

	* pcmpl-rpm.el (pcomplete/rpm): Doc fix.

	* bindings.el (mode-line-modified): Fix case of "Buffer is modified".

	* textmodes/ispell.el (ispell-local-dictionary): Doc fix.

	* progmodes/gdb-mi.el (gud-remove, gud-break): Update declarations.

	* calendar/cal-dst.el (calendar-time-zone-daylight-rules):
	Simplify Persian conditionals.

	* calc/calc-graph.el (calc-graph-plot): Avoid assignment to free
	variable `filename'.

	* comint.el (comint-insert-input): Doc fix.

	* Makefile.in (ELCFILES): Fix typo in previous change.

2009-06-23  Miles Bader  <miles@gnu.org>

	* cus-start.el: Add entry for `recenter-redisplay'.

2009-06-23  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-hooks.el (vc-stay-local-p, vc-state, vc-working-revision):
	Add an optional argument for the backend, use it instead of
	calling vc-backend.
	(vc-mode-line): Add an optional argument for the backend.
	Pass the backend to vc-state and vc-working-revision.  Move code for
	special handling for vc-state being a buffer to ...

	* vc-rcs.el (vc-rcs-find-file-hook):
	* vc-sccs.el (vc-sccs-find-file-hook): ... here.  New functions.

	* vc-svn.el (vc-svn-state, vc-svn-dir-status, vc-svn-checkout)
	(vc-svn-print-log, vc-svn-diff): Pass 'SVN to vc-state,
	vc-stay-local-p and vc-mode-line calls.

	* vc-cvs.el (vc-cvs-state, vc-cvs-checkout, vc-cvs-print-log)
	(vc-cvs-diff, vc-cvs-annotate-command)
	(vc-cvs-make-version-backups-p, vc-cvs-stay-local-p)
	(vc-cvs-dir-status): Pass 'CVS to vc-state, vc-stay-local-p and
	vc-mode-line calls.

	* vc.el (vc-deduce-fileset): Use vc-deduce-fileset instead of
	direct comparison.
	(vc-next-action, vc-transfer-file, vc-rename-file): Also pass the
	backend when calling vc-mode-line.
	(vc-register): Do not create a closure for calling the vc register
	function, call it directly.

2009-06-23  Dan Nicolaescu  <dann@ics.uci.edu>

	* emacs-lisp/elp.el (elp-output-insert-symname): Add a link face
	to make it obvious item can be clicked.

	* vc-mtn.el (vc-mtn-after-dir-status, vc-mtn-dir-status): New functions.

2009-06-23  Kenichi Handa  <handa@m17n.org>

	* language/korea-util.el (korean-key-bindings): Change the binding
	of F9 to hangul-to-hanja-conversion.  Bind Hangul_Hanja to the
	same command.

2009-06-22  Michael Albinus  <michael.albinus@gmx.de>

	Sync with Tramp 2.1.16.

	* Makefile.in (ELCFILES): Add net/tramp-gvfs.elc.

	* net/tramp.el (top): Require tramp-gvfs.  Catch `tramp-loading',
	when a loading of a package fails.  Completion function for rsync
	is `tramp-completion-function-alist-ssh'.
	(all): Replace all calls of `split-string' and
	`tramp-split-string' by `tramp-compat-split-string'.
	(tramp-default-method): Use `tramp-compat-process-running-p'.
	(tramp-default-proxies-alist): Allow also Lisp forms.
	(tramp-remote-path): Add choice "Private Directories".
	(tramp-wrong-passwd-regexp): Remove "Tramp connection closed" option.
	(tramp-domain-regexp): Allow also "-", "_" and ".".
	(tramp-end-of-output): Remove newlines, and add "$" at the end.
	(tramp-file-name-handler-alist): Add handler for `dired-uncache'.
	(tramp-debug-message): Insert header line in debug buffer.
	(tramp-handle-directory-files-and-attributes-with-stat):
	Care about filenames with spaces, or starting with "-".
	(tramp-handle-dired-uncache): New defun.
	(tramp-handle-insert-directory): Don't flush the directory from
	cache, this is handled by `dired-uncache' now.
	(tramp-handle-insert-file-contents): Improve error handling.
	(tramp-find-shell, tramp-open-connection-setup-interactive-shell):
	Quote `tramp-end-of-output'.
	(tramp-action-password): Improve trace message.
	(tramp-check-for-regexp): Both echoes must be present, before removing.
	(tramp-open-connection-setup-interactive-shell): Trace coding system.
	(tramp-compute-multi-hops): Eval cons cells of
	`tramp-default-proxies-alist'.
	(tramp-maybe-open-connection): Use the same command pattern for
	first hop and further hops.
	(tramp-wait-for-output): Remove handling of newlines.
	(tramp-get-remote-path): Handle also `tramp-own-remote-path'.
	(tramp-split-string): Remove function.  It is handled in
	tramp-compat now.

	* net/tramp-cmds.el (tramp-bug):
	Recommend `tramp-cleanup-all-connections' in the bug mail.

	* net/tramp-compat.el (tramp-compat-split-string)
	(tramp-compat-process-running-p): New defuns.

	* net/tramp-fish.el (tramp-fish-file-name-handler-alist): Add handler
	for `dired-uncache'.

	* net/tramp-gvfs.el: New package.

	* net/tramp-smb.el (tramp-smb-file-name-handler-alist):
	Add handler for `dired-uncache'.
	(tramp-smb-handle-file-local-copy): Cleanup in case of error.

	* net/trampver.el: Update release number.  Make version check fit
	for SXEmacs 22.

2009-06-22  Jim Meyering  <meyering@redhat.com>

	Automatically handle .xz suffix (XZ-compressed files), too.
	* jka-cmpr-hook.el (jka-compr-compression-info-list): Add xz.
	XZ is the successor to LZMA: <http://tukaani.org/xz/>

2009-06-22  Dmitry Dzhus  <dima@sphinx.net.ru>
            Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-mi.el: Pull further modified changes from Dmitry's
	repository (http://sphinx.net.ru/hg/gdb-mi/).

2009-06-22  Glenn Morris  <rgm@gnu.org>

	* files.el (dir-locals-collect-mode-variables): Allow for any number of
	`mode' and `eval' entries.  (Bug#3430)

	* Makefile.in (ELCFILES): Add fadr.elc.

	* calendar/appt.el (appt-make-list): Fix off-by-one error caused by
	differing behavior of \n and ^ in strings.  (Bug#3385)

	* emacs-lisp/cl-indent.el: Remove leading "*" from defcustom docs.

	* emacs-lisp/lisp-mode.el (lisp-indent-offset): Fix safe-local-variable
	property.
	(lisp-indent-function): Make it a defcustom.

2009-06-21  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el: Replace with ...
	* progmodes/gdb-mi.el: ... this file.
	* progmodes/gud.el: Modify for gdb-mi.el.

2009-06-21  Dmitry Dzhus  <dima@sphinx.net.ru>

	* fadr.el: New file.

See ChangeLog.14 for earlier changes.

;; Local Variables:
;; coding: utf-8
;; End:

  Copyright (C) 2009, 2010  Free Software Foundation, Inc.

  This file is part of GNU Emacs.

  GNU Emacs is free software: you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.

  GNU Emacs is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.

  You should have received a copy of the GNU General Public License
  along with GNU Emacs.  If not, see <http://www.gnu.org/licenses/>.
