2007-06-14  Juanma Barranquero  <lekktu@gmail.com>

	* follow.el (follow-all-followers, follow-generic-filter):
	* pcomplete.el (pcomplete-restore-windows):
	* x-dnd.el (x-dnd-maybe-call-test-function, x-dnd-save-state)
	(x-dnd-drop-data):
	* emacs-lisp/edebug.el (edebug-pop-to-buffer, edebug-display):
	* progmodes/python.el (python-complete-symbol):
	* term/mac-win.el (mac-dnd-drop-data): Remove redundant check.

2007-06-13  Ryan Yeske  <rcyeske@gmail.com>

	* rcirc.el (rcirc-format-response-string): Use rcirc-nick-syntax
	around bright and dim regexps. Make sure bright and dim matches
	use word anchors.  Send text through rcirc-markup functions.
	(rcirc-url-regexp): Add single quote character.
	(rcirc-connect): Write logs to disk on auto-save-hook.
	Make server a non-optional argument.
	(rcirc-log-alist): New variable.
	(rcirc-log-directory): Make customizable.
	(rcirc-log-flag): New customizable variable.
	(rcirc-log): New function.
	(rcirc-print): Use above function.
	(rcirc-log-write): New function.
	(rcirc-generate-new-buffer-name): Strip text properties.
	(rcirc-switch-to-buffer-function): Remove variable.
	(rcirc-last-non-irc-buffer): Remove variable.
	(rcirc-non-irc-buffer): Add function.
	(rcirc-next-active-buffer): Use above function.
	(rcirc-keepalive): Send KEEPALIVE ctcp instead of a PING.
	(rcirc-handler-ctcp-KEEPALIVE): Add handler.
	(rcirc-handler-CTCP): Don't print KEEPALIVE responses.
	(rcirc-omit-mode): Add minor-mode.
	(rcirc-mode-map): Change C-c C-o binding.
	(rcirc-mode): Clear mode-line-process. Use a custom
	fill-paragraph-function.  Set up buffer-invisibility-spec.
	(rcirc-response-formats): Remove timestamp code.
	(rcirc-omit-responses): Add variable.
	(rcirc-print): Don't put the overlay arrow on potentially omitted
	lines.  Log line to disk.  Record activity for private messages
	from /dim nicks.  Facify the fill-prefix with rcirc-timestamp face.
	(rcirc-jump-to-first-unread-line): Print message if there is no
	unread text.
	(rcirc-clear-unread): New function.
	(rcirc-markup-text-functions): Add variable.
	(rcirc-markup-timestamp, rcirc-markup-fill): Add functions.
	(rcirc-debug): Don't mess with window configuration.
	(rcirc-send-message): Send message before printing locally.
	Add SILENT argument, do not print message if non-nil.
	(rcirc-visible-buffers): New function and variable.
	(rcirc-window-configuration-change-1): Add function.
	(rcirc-target-buffer): Make sure ACTIONs don't get sent to the
	server buffer.
	(rcirc-clean-up-buffer): Set rcirc-target to nil when finished.
	(rcirc-fill-paragraph): Add function.
	(rcirc-record-activity, rcirc-window-configuration-change-1):
	Only update the activity string if it has actually changed.
	(rcirc-update-activity-string): Remove padding characters from the
	mode-line string.
	(rcirc-disconnect-buffer): New function to be called when a
	channel is parted or the user quits.
	(rcirc-server-name): Warn when the server-name hasn't been set.
	(rcirc-window-configuration-change): Postpone work until
	post-command-hook.
	(rcirc-window-configuration-change-1): Update mode-line and
	overlay arrows here.
	(rcirc-authenticate): Fix chanserv identification.
	(rcirc-default-server): Remove variable.
	(rcirc): Connect according to rcirc-connections.
	(rcirc-connections): Add variable.
	(rcirc-startup-channels-alist): Remove variable.
	(rcirc-startup-channels): Remove function.

2007-06-13  Stefan Monnier  <monnier@iro.umontreal.ca>

	* diff-mode.el (diff-font-lock-keywords): Fix M. Kifer's last change.

2007-06-13  Johan Bockg,Ae(Brd  <bojohan@dd.chalmers.se>  (tiny change)

	* term/xterm.el (terminal-init-xterm): Escape parens in character
	constants.

2007-06-13  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/sh-script.el: Remove unneeded * from docstrings.
	Use [:alpha:] and [:alnum:] where applicable.
	(sh-quoted-subshell): Rewrite to correctly
	handle nested mixes of `...` and $(...).
	(sh-apply-quoted-subshell): Remove.
	(sh-font-lock-syntactic-keywords): Adjust call to sh-quoted-subshell.

	* vc-arch.el (vc-arch-command): Remove bzr.  It's a different program.

2007-06-12  Tom Tromey  <tromey@redhat.com>

	* subr.el (user-emacs-directory): New defconst.
	* cmuscheme.el (scheme-start-file):
	* shell.el (shell):
	* completion.el (save-completions-file-name):
	* custom.el (custom-theme-directory):
	* term/x-win.el (emacs-session-filename):
	* filesets.el (filesets-menu-cache-file):
	* thumbs.el (thumbs-thumbsdir):
	* server.el (server-auth-dir):
	* image-dired.el (image-dired-dir):
	(image-dired-db-file):
	(image-dired-temp-image-file):
	(image-dired-gallery-dir):
	(image-dired-temp-rotate-image-file):
	* play/gamegrid.el (gamegrid-user-score-file-directory):
	* savehist.el (savehist-file):
	* tutorial.el (tutorial--saved-dir):
	* startup.el (auto-save-list-file-prefix): Use user-emacs-directory.

2007-06-12  Ralf Angeli  <angeli@caeruleus.net>

	* scroll-lock.el (scroll-lock-mode): Doc fix.

2007-06-12  Michael Kifer  <kifer@cs.stonybrook.edu>

	* ediff-ptch.el (ediff-context-diff-label-regexp): Spurious parenthesis.

	* ediff-init.el: Doc strings.

2007-06-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/bytecomp.el (byte-compile-current-group): New var.
	(byte-compile-file): Bind it.
	(byte-compile-nogroup-warn): Use it to avoid spurious warnings when the
	group argument is provided implicitly.
	(byte-compile-format-warn, byte-compile-from-buffer)
	(byte-compile-insert-header): Don't hardcode point-min==1.
	(byte-compile-file-form-require): Remove unused var old-load-list.
	(byte-compile-eval): Remove unused vars old-autoloads and hist-nil-new.

2007-06-12  Michael Kifer  <kifer@cs.stonybrook.edu>

	* emulation/viper-cmd.el (viper-prefix-arg-com, viper-prefix-arg-value):
	Display error messages.
	(viper-prev-destructive-command, viper-insert-prev-from-insertion-ring):
	Get rid of cl.el dependencies.

	* emulation/viper-init.el (viper-suppress-input-method-change-message):
	New variable.
	(viper-activate-input-method-action)
	(viper-inactivate-input-method-action):
	Use viper-suppress-input-method-change-message.

	* emulation/viper-kem.el (viper-vi-basic-map): Disable the bindings
	for C-s, C-r.

	* emulation/viper-util.el (viper-set-cursor-color-according-to-state):
	Use viper-replace-overlay-cursor-color instead of
	viper-replace-overlay-cursor-color.
	(viper-sit-for-short): Use sit-for with 3 arguments.

	* emulation/viper.el (viper-insert-state-mode-list): Add gud-mode.
	(viper-major-mode-modifier-list): Add viper-comint-mode-modifier-map
	to gud-mode.

	* ediff-mult.el (ediff-meta-buffer-brief-message)
	(ediff-meta-buffer-verbose-message): New variables.
	(ediff-meta-buffer-message): Variable deleted.
	(ediff-verbose-help-enabled): New variable.
	(ediff-toggle-verbose-help-meta-buffer): New function.
	(ediff-redraw-directory-group-buffer): Made aware of short/verbose
	message options

	* ediff-ptch.el (ediff-context-diff-label-regexp): Better regexp.
	(ediff-fixup-patch-map): Improve heuristic.

2007-06-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* log-view.el (log-view-file-re, log-view-message-re): Use \(?1:...\).
	(log-view-font-lock-keywords): Simplify.
	(log-view-current-file, log-view-current-tag): Simplify.

2007-06-12  Sam Steingold  <sds@gnu.org>

	* vc-arch.el (vc-arch-command): Also try "baz" and "bzr".

2007-06-12  Juanma Barranquero  <lekktu@gmail.com>

	* desktop.el (desktop-load-locked-desktop): New option.
	(desktop-read): Use it.
	(desktop-truncate, desktop-outvar, desktop-restore-file-buffer):
	Use `when'.

2007-06-12  Davis Herring  <herring@lanl.gov>

	* desktop.el (desktop-save-mode-off): New function.
	(desktop-base-lock-name, desktop-not-loaded-hook): New variables.
	(desktop-full-lock-name, desktop-file-modtime, desktop-owner)
	(desktop-claim-lock, desktop-release-lock): New functions.
	(desktop-kill): Tell `desktop-save' that this is the last save.
	Release the lock afterwards.
	(desktop-buffer-info): New function.
	(desktop-save): Use it.	 Run `desktop-save-hook' where the doc
	says to.  Detect conflicts, and manage the lock.
	(desktop-read): Detect conflicts.  Manage the lock.

2007-06-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emulation/tpu-mapper.el (tpu-emacs-map-key): Use new keymap names.

	* emulation/tpu-edt.el (tpu-gold-map): Rename from GOLD-map.
	(tpu-lucid-emacs-p): Remove.  Use (featurep 'xemacs) instead.
	(CSI-map, GOLD-CSI-map, GOLD-SS3-map, SS3-map):	Delete vars.
	(tpu-gold-map, tpu-global-map): Add all the SS3 and CSI bindings, using
	keysyms rather than byte sequences.
	(tpu-copy-keyfile): Don't force the user to use tpu-mapper.el.

2007-06-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/sh-script.el (sh-font-lock-backslash-quote)
	(sh-font-lock-flush-syntax-ppss-cache): New functions.
	(sh-font-lock-syntactic-keywords): Use them to distinguish the
	different possible cases for \'.

	* complete.el (PC-bindings): Don't bind things already bound in the
	parent keymap.

	* textmodes/bibtex-style.el: New file.

2007-06-11  Riccardo Murri  <riccardo.murri@gmail.com>

	* vc-bzr.el: New file.

2007-06-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-svn.el (vc-svn-program): New var.
	(vc-svn-command): Use it.

2007-06-11  Juanma Barranquero  <lekktu@gmail.com>

	* server.el (server-switch-buffer): Remove redundant check.

2007-06-10  Martin Rudalics  <rudalics@gmx.at>

	* emacs-lisp/bytecomp.el (byte-compile-find-cl-functions):
	Match against file-name-nondirectory.
	Fix text on user customization variables.
	Reported by Johan Bockg,Ae(Brd <bojohan@dd.chalmers.se>.

2007-06-09  Alfred M. Szmidt  <ams@gnu.org>  (tiny change)

	* mail/rmail.el (rmail-movemail-variant-in-use): Fix doc typo.

2007-06-09  Davis Herring  <herring@lanl.gov>

	* desktop.el (desktop-minor-mode-table): Doc fix.

2007-06-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/css-mode.el (css-navigation-syntax-table):
	Use set-char-table-range so it also works in the unicode branch.

2007-06-08  Nick Roberts  <nickrob@snap.net.nz>

	* help-mode.el (help-xref-forward-stack)
	(help-xref-stack-forward-item, help-forward-label): New variables.
	(help-forward): New button type.
	(help-setup-xref): Initialise help-xref-forward-stack.
	(help-make-xrefs): Add forward button, if appropriate.
	(help-xref-go-back): Push item on forward stack.
	(help-xref-go-forward, help-go-forward): New functions.

2007-06-07  Chong Yidong  <cyd@stupidchicken.com>

	* dired.el (dired-mode-map): Remove spurious separator.

2007-06-07  Juanma Barranquero  <lekktu@gmail.com>

	* progmodes/ebrowse.el (ebrowse-draw-file-member-info): Doc fix.

	* progmodes/mixal-mode.el (mixal-operation-codes-alist):
	* progmodes/idlwave.el (idlwave-one-key-select): Fix typo in docstring.

2007-06-07  Carsten Dominik  <dominik@science.uva.nl>

	* textmodes/org.el: Version number fixed.

2007-06-07  Glenn Morris  <rgm@gnu.org>

	* version.el (emacs-copyright): New constant.
	* startup.el (fancy-splash-tail): Use emacs-copyright.
	* calc/calc-help.el (calc-full-help): Use emacs-copyright.

	* emacs-lisp/bytecomp.el (byte-compile-warnings): Add new option
	`make-local'.
	(byte-compile-warnings-safe-p): Add `make-local'.
	(byte-compile-make-variable-buffer-local):
	Allow byte-compile-warnings to suppress this warning.

	* tutorial.el (tutorial--describe-nonstandard-key): Adjust for new
	format of "menu" description.
	(tutorial--find-changed-keys): Describe the specific menu a
	command is in.

	* dframe.el (dframe-frame-parameter, dframe-mouse-event-p):
	Rewrite compatibility functions to silence byte-compiler.

2007-06-07  Alfred M. Szmidt  <ams@gnu.org>  (tiny change)

	* mail/rmailsum.el (rmail-summary-save-buffer): New command.
	(rmail-summary-mode-map): Add rmail-summary-save-buffer.

2007-06-07  Eric M. Ludlam  <eric@siege-engine.com>

	* emacs-lisp/checkdoc.el (checkdoc-ispell-lisp-words): Remove "iff".

2007-06-07  Juanma Barranquero  <lekktu@gmail.com>

	* progmodes/ebrowse.el (ebrowse-member-table):
	* textmodes/org.el (org-export-ascii-bullets, org-batch-agenda)
	(org-batch-agenda-csv): Fix typos in docstrings.

2007-06-06  Juanma Barranquero  <lekktu@gmail.com>

	* international/mule-cmds.el (toggle-enable-multibyte-characters)
	(sort-coding-systems, search-unencodable-char): Doc fixes.
	(coding-system-change-eol-conversion, set-default-coding-systems)
	(prefer-coding-system, find-multibyte-characters, princ-list)
	(leim-list-entry-regexp, set-input-method, locale-language-names)
	(input-method-exit-on-first-char, exit-language-environment-hook)
	(locale-charset-language-names): Fix typos in docstrings.

2007-06-06  Juanma Barranquero  <lekktu@gmail.com>

	* pgg.el (pgg-sign-region, pgg-sign):
	* ses.el (ses-call-printer):
	* calendar/icalendar.el (icalendar--diarytime-to-isotime):
	* textmodes/org.el (org-cycle): Fix typos in docstrings.

2007-06-06  Carsten Dominik  <dominik@science.uva.nl>

	* textmodes/org.el
	(org-export-region-as-html, org-replace-region-by-html)
	(org-number-to-letters, org-table-fedit-finish)
	(org-normalize-color, org-table-fedit-ref-right)
	(org-date-to-gregorian, org-table-fedit-move)
	(org-table-convert-refs-to-rc, org-calendar-holiday)
	(org-table-fedit-toggle-ref-type, org-write-agenda)
	(org-colgroup-info-to-vline-list, org-agenda-todo-previousset)
	(org-defkey, org-encode-for-stdout)
	(org-indent-line-function, org-export-as-html-to-buffer)
	(org-store-agenda-views, org-update-mode-line)
	(org-find-if, org-delete-all)
	(org-table-fedit-convert-buffer, org-emphasize)
	(org-uniquify, org-table-fedit-lisp-indent)
	(org-table-fedit-scroll, org-get-todo-sequence-head)
	(org-table-fedit-scroll-down, org-table-fedit-line-down)
	(org-table-fedit-ref-left, org-agenda-export-csv-mapper)
	(org-table-fedit-toggle-coordinates, org-dvipng-color)
	(org-table-fedit-line-up, org-table-fedit-ref-down)
	(org-table-formula-from-user, org-mode-flyspell-verify)
	(org-cycle-show-empty-lines, org-ctrl-c-ret)
	(org-table-formula-to-user, org-diary-to-ical-string)
	(orgtbl-export, org-table-fedit-post-command)
	(org-closed-in-range, org-shiftcontrolright)
	(org-table-convert-refs-to-an, org-table-hline-and-move)
	(org-table-formula-less-p, org-format-table-ascii)
	(org-agenda-get-sexps, org-shift-refpart)
	(org-diary-sexp-entry, org-time-string-to-absolute)
	(org-table-show-reference, org-letters-to-number)
	(org-fix-agenda-info, org-table-fedit-ref-up)
	(org-table-fedit-shift-reference, org-table-fedit-abort)
	(org-closest-date, org-shiftcontrolleft)
	(org-at-heading-or-item-p, org-rematch-and-replace)
	(org-agenda-todo-nextset, org-export-grab-title-from-buffer):
	New functions.
	(org-table-edit-scroll-down, org-finish-edit-formulas)
	(org-table-edit-next-field, org-abort-edit-formulas)
	(org-font-lock-level, org-export-find-first-heading-line)
	(org-table-edit-line-down, org-table-edit-backward-field)
	(org-edit-formula-lisp-indent, org-table-edit-move)
	(org-check-log-option, org-this-word)
	(org-table-edit-line-up, org-table-edit-formulas-post-command)
	(org-agenda-file-to-end, org-expand-file-name)
	(org-fake-empty-table-line, org-table-edit-scroll)
	(org-toggle-log-option, org-show-reference): Function removed.
	(org-inhibit-invisibility, org-table-formula-make-cmp-string):
	New defsubsts.
	(org-unmodified, org-batch-store-agenda-views)
	(org-batch-agenda-csv): New macro.
	(org-agenda-export): New customization group.
	(org-agenda-skip-deadline-if-done, org-agenda-remove-tags)
	(org-highest-priority, org-agenda-exporter-settings)
	(org-log-done-with-time, org-replace-disputed-keys)
	(org-format-latex-header, org-export-table-header-tags)
	(org-cycle-separator-lines, org-export-table-data-tags)
	(org-icalendar-include-sexps)
	(org-empty-line-terminates-plain-lists)
	(org-log-repeat, org-special-ctrl-a)
	(org-table-use-standard-references, org-disputed-keys)
	(org-export-skip-text-before-1st-heading, org-agenda-with-colors)
	(org-agenda-export-html-style): New option.
	(org-allow-auto-repeat,  org-agenda-remove-tags-when-in-prefix)
	(org-CUA-compatible): Option removed.
	(org-agenda-structure,  org-sexp-date): New face.
	(org-todo-keywords-for-agenda, org-not-done-keywords)
	(org-planning-or-clock-line-re, org-agenda-name)
	(org-table-colgroup-info, org-todo-sets)
	(constants-unit-system, org-clock-mode-line-entry)
	(org-mode-line-timer, org-table-current-begin-pos)
	(org-todo-keywords-1, org-mode-line-string)
	(org-table-clean-did-remove-column, org-table-fedit-map)
	(org-clock-heading, org-table-buffer-is-an)
	(org-agenda-info, org-done-keywords)
	(org-done-keywords-for-agenda, org-todo-heads)
	(org-todo-kwd-alist, org-clock-start-time): New variable.
	(org-todo-kwd-priority-p, org-edit-formulas-map)
	(org-repeat-re, org-todo-kwd-max-priority)
	(org-version, org-done-string)
	(org-table-clean-did-remove-column-1, org-disputed-keys):
	Remove Variables.
	(org-table-translate-regexp, org-repeat-re, org-version): New consts.
	(org-ts-lengths): Constant removed.
	(org-follow-gnus-link): Don't ask how many articles to read.
	(org-export-find-first-export-line): Rename from
	`org-export-find-first-heading'.
	Use `org-export-skip-text-before-1st-heading'.
	(org-table-fedit-post-command): Rename from
	`org-table-edit-formulas-post-command'.
	(org-table-fedit-finish): Rename from `org-finish-edit-formulas'.
	(org-table-fedit-abort): Rename from `org-abort-edit-formulas'.
	(org-table-fedit-lisp-indent): Rename from
	`org-edit-formula-lisp-indent'.
	(org-table-show-reference): Rename from `org-show-reference'.
	(org-table-store-formulas): Use `org-table-formula-less-p'.
	(org-table-edit-formulas): Position cursor to current field equation.
	(org-update-checkbox-count, org-hide-archived-subtrees)
	(org-timestamp-up-day, org-timestamp-down-day)
	(org-shiftmetaleft, org-shiftmetaright, org-shiftmetaup)
	(org-shiftmetadown, org-metaleft, org-metaright, org-metaup)
	(org-metadown, org-shiftup, org-shiftdown, org-shiftright)
	(org-shiftleft, org-ctrl-c-ctrl-c, org-context):
	Let `org-on-heading-p' also check for invisible heading.
	(org-read-date): Match am/pm times.
	(org-eval-in-calendar): Fix default date in prompt.

2007-06-05  Chong Yidong  <cyd@stupidchicken.com>

	* files.el (auto-mode-alist): Separate "ChangeLog.1" and
	"ChangeLog.a" entries, giving the latter lower priority.

2007-06-05  Juanma Barranquero  <lekktu@gmail.com>

	* faces.el (face-id): If the argument is a face alias,
	return the ID of the target face.

2007-06-05  Michael Albinus  <michael.albinus@gmx.de>

	* net/socks.el (top): Remove unnecessary copyright line.

2007-06-04  Chong Yidong  <cyd@stupidchicken.com>

	* longlines.el (longlines-auto-wrap): Handle argument correctly.

2007-06-04  Michael Albinus  <michael.albinus@gmx.de>

	* net/socks.el: New file, taken from w3 repository.
	(top): Update Copyright.  Don't load cl.el.
	(all): Replace `case' by `cond', `string-to-int' by
	`string-to-number', and `process-kill-without-query' by
	`set-process-query-on-exit-flag'.
	(socks-char-int): Remove defalias and all occurencies.

2007-06-04  Juanma Barranquero  <lekktu@gmail.com>

	* progmodes/compile.el (compilation-find-file, compilation-handle-exit):
	Fix typos in docstrings.
	(compilation-search-path, compilation-buffer-name-function): Doc fixes.
	(compilation-finish-function): Fix typo in obsolescence declaration.

2007-06-03  Sam Steingold  <sds@gnu.org>

	* progmodes/compile.el: Add TIMESTAMP to the LOC data structure, to
	handle unending automatic recompilation of changed files (`omake -P').
	(compilation-loop): VISITED is now 5th CDR.
	(compilation-next-error-function): Set TIMESTAMP.

2007-06-03  Sam Steingold  <sds@gnu.org>

	* files.el (kill-buffer-ask): New function.
	(kill-some-buffers): Use it.
	(kill-matching-buffers): New user command.

2007-06-01  David Kastrup  <dak@gnu.org>

	* dired.el (dired-recursive-deletes, dired-recursive-copies):
	Change default to `top'.

2007-05-31  Richard Stallman  <rms@gnu.org>

	* dired.el (dired-do-flagged-delete, dired-do-delete): Doc fix.

2007-05-31  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/css-mode.el: New file.

2007-05-30  Michael Olson  <mwolson@gnu.org>

	* emacs-lisp/tq.el (tq-queue-pop): Stifle error when a process has
	died and we are trying to send a signal to it.  The program using
	tq.el should periodically check to see whether the process has
	died and react appropriately -- this is not the responsibility of
	tq.el, and is consistent with the rest of the tq.el source code.

2007-05-29  Martin Rudalics  <rudalics@gmx.at>

	* textmodes/table.el (table--point-entered-cell-function)
	(table--point-left-cell-function):
	Bind `inhibit-point-motion-hooks' to t.

2007-05-29  Nikolaj Schumacher  <n_schumacher@web.de>  (tiny change)

	* emacs-lisp/rx.el (rx): Doc fix.

2007-05-28  Juanma Barranquero  <lekktu@gmail.com>

	* progmodes/idlwave.el (idlwave-routines): Fix typo in docstring.

2007-05-28  Michael Albinus  <michael.albinus@gmx.de>

	Sync with Tramp 2.0.56.

	* net/tramp.el:
	* net/tramp-ftp.el:
	* net/tramp-smb.el:
	* net/tramp-util.el:
	* net/tramp-vc.el:
	Don't load cl.el, because that pollutes the namespace.  Replace cl
	macros by their implementations where necessary.  Requested by
	Richard Stallman <rms@gnu.org>.

	* net/tramp.el (top): Make `set-buffer-multibyte' an alias if it
	doesn't exist.
	(with-parsed-tramp-file-name): Protect debug spec during compilation.
	(tramp-handle-insert-directory): Check (featurep 'ls-lisp).
	(tramp-file-name-p, tramp-file-name-multi-method)
	(tramp-file-name-method, tramp-file-name-user)
	(tramp-file-name-host, tramp-file-name-localname): New defuns,
	replacing defstruct `tramp-file-name'.
	(tramp-handle-file-remote-p, tramp-completion-dissect-file-name1)
	(tramp-dissect-file-name, tramp-dissect-multi-file-name):
	Apply `vector' instead of `make-tramp-file-name'.
	(tramp-handle-make-auto-save-file-name):
	Apply `tramp-temporary-file-directory' for compatibility reasons.
	(tramp-completion-mode): Use `natnump' instead of `wholenump'
	because of XEmacs.
	(tramp-completion-mode): `last-input-event' is nil when XEmacs is
	started.

2007-05-28  Chong Yidong  <cyd@stupidchicken.com>

	* textmodes/sgml-mode.el (sgml-point-entered): Use condition-case.

2007-05-27  Tetsurou Okazaki  <okazaki@be.to>  (tiny change)

	* log-edit.el (log-edit-changelog-paragraph): Return point-max
	as the end of the ChangeLog paragraph when it ends without a line
	termination.

2007-05-27  Ryan Yeske  <rcyeske@gmail.com>

	* net/webjump.el (webjump-sample-sites):
	Add simple Wikipedia query.

2007-05-25  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/derived.el (define-derived-mode): Remove bogus
	compatibiity code.

	* emacs-lisp/copyright.el (copyright-names-regexp): New var.
	(copyright-update-year): Use it.

	* edmacro.el (edmacro-format-keys): Use current-active-maps.

	* ediff-init.el (ediff-defvar-local, ediff-with-current-buffer):
	Add indentation and debugging info.  Fix up comment convention.

	* cus-dep.el (custom-make-dependencies): Simplify.

	* composite.el (compose-region, decompose-region):
	Use inhibit-read-only and restore-buffer-modified-p.

	* xt-mouse.el (xterm-mouse-truncate-wrap): New function.
	(xterm-mouse-event): Use it.

2007-05-25  Juanma Barranquero  <lekktu@gmail.com>

	* bs.el (bs-cycle-previous): Don't modify the cycle list until
	`switch-to-buffer' has returned succesfully.
	(bs-cycle-next): Ditto.  Also, don't bury the buffer when the
	window is dedicated (it could iconify the frame).

2007-05-25  Miles Bader  <miles@fencepost.gnu.org>

	* vc-hooks.el (vc-find-root): Fix file attribute test.

2007-05-24  Richard Stallman  <rms@gnu.org>

	* textmodes/flyspell.el (flyspell-correct-word-before-point):
	Don't let opoint be nil.
	(flyspell-emacs-popup): Explicit error if no dialogs.

2007-05-24  Chong Yidong  <cyd@stupidchicken.com>

	* image-mode.el (image-forward-hscroll, image-backward-hscroll)
	(image-next-line, image-previous-line, image-scroll-up)
	(image-scroll-down, image-bol, image-eol, image-bob, image-eob):
	New functions.
	(image-mode-map): Remap motion commands.
	(image-mode-text-map): New keymap for viewing images as text.
	(image-mode): Use image-mode-map.
	(image-toggle-display): Toggle auto-hscroll-mode and mode keymaps.

2007-05-24  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/fill.el (canonically-space-region): Make the second arg
	a marker if it's not already the case.

2007-05-23  Eli Zaretskii  <eliz@gnu.org>

	* tar-mode.el (tar-header-block-summarize, tar-summarize-buffer)
	(tar-get-descriptor): Handle type 55, an extended pax header.

2007-05-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* autoinsert.el (auto-insert-alist): Quote elisp sample code so as not
	to confuse outline-minor-mode.

2007-05-23  Eli Zaretskii  <eliz@gnu.org>

	* tar-mode.el (tar-file-name-handler): New function.
	(tar-extract): Bind file-name-handler-alist to it to force
	find-buffer-file-type-coding-system behave as if the file being
	extracted existed.  Use last-coding-system-used to force
	buffer-file-coding-system to what decode-coding-region actually
	used to decode the file.

2007-05-23  Nikolaj Schumacher  <n_schumacher@web.de>  (tiny change)

	* progmodes/compile.el (compilation-handle-exit):
	`compilation-finish-function' may change the current buffer.

2007-05-22  Richard Stallman  <rms@gnu.org>

	* files.el (set-auto-mode): Doc fix.

2007-05-22  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* help-fns.el (find-source-lisp-file): New function.
	(describe-function-1): Use find-source-lisp-file to find source
	file in compile tree.

2007-05-22  Eli Zaretskii  <eliz@gnu.org>

	* dos-w32.el (find-buffer-file-type-coding-system): Doc fix.

2007-05-22  Juanma Barranquero  <lekktu@gmail.com>

	* emacs-lisp/easy-mmode.el (define-minor-mode)
	(easy-mmode-define-navigation): Fix typos in docstrings.

2007-05-22  Glenn Morris  <rgm@gnu.org>

	* files.el (auto-mode-alist): Open `.asd' files in lisp-mode.

2007-05-22  Katsumi Yamaoka  <yamaoka@jpl.org>  (tiny change)

	* mail/mail-extr.el (mail-extract-address-components):
	Recognize non-ASCII characters except for NBSP as words.

2007-05-21  Trent Buck  <trentbuck@gmail.com>  (tiny change)

	* net/rcirc.el (rcirc-fill-column): Allow `window-width'.
	(rcirc-print): Handle `window-width'.
	(rcirc-buffer-maximum-lines): Doc fix.

2007-05-21  Chong Yidong  <cyd@stupidchicken.com>

	* image-mode.el (image-toggle-display): Don't clear image cache.
	Only use filename in image spec if the file is readable.
	Call image-refresh.

	* image.el (image-type-from-file-name, image-type): Simplify.
	(image-type-auto-detected-p): Don't scan auto-mode-alist.

	* files.el (magic-mode-alist): Remove image-type-auto-detected-p.
	(magic-fallback-mode-alist): Add image-type-auto-detected-p.

2007-05-20  Nick Roberts  <nickrob@snap.net.nz>

	* t-mouse.el (t-mouse-mode): Reset t-mouse-mode to nil if there
	is an error.

	* term/linux.el (terminal-init-linux): Don't signal an error
	if gpm isn't running.

2007-05-20  Nick Roberts  <nickrob@snap.net.nz>

	* t-mouse.el: Reduce to a minor-mode macro call.
	(t-mouse-mode): Remove the lighter.

	* term/linux.el (terminal-init-linux): Enable t-mouse by default.

2007-05-19  Dan Nicolaescu  <dann@ics.uci.edu>

	* files.el (auto-mode-alist): Change the regexp so that
	ChangeLog.unicode and ChangeLog.multi-tty use change-log-mode.

2007-06-02  Chong Yidong  <cyd@stupidchicken.com>

	* Version 22.1 released.

2007-05-19  Chong Yidong  <cyd@stupidchicken.com>

	* paren.el (show-paren-function): Undo 2007-04-19 and 2007-04-20
	changes.

2007-05-19  Kevin Ryde  <user42@zip.com.au>

	* info.el (Info-fontify-node): Fontify https as well as http and ftp.

2007-05-18  Thien-Thi Nguyen  <ttn@gnuvola.org>

	* textmodes/sgml-mode.el: Revert last change.

2007-05-18  Richard Stallman  <rms@gnu.org>

	* simple.el (push-mark): Doc fix.

2007-05-18  Rob Riepel  <riepel@Stanford.EDU>

	* emulation/tpu-edt.el (CSI-map, SS3-map): Move from global-map to
	tpu-global-map.
	(tpu-original-global-map): Variable deleted.
	(tpu-control-keys-map): New keymap variable.
	(tpu-set-control-keys): Use tpu-reset-control-keys rather than
	setting keymapping directly.
	(tpu-reset-control-keys): Use tpu-control-keys-map instead of
	tpu-global-map.
	(tpu-edt-on): Activate the tpu-global-map.
	(tpu-edt-off): Deactivate the tpu-global-map.

2007-05-18  Ryan Yeske  <rcyeske@gmail.com>

	* textmodes/ispell.el (ispell-get-word): Return markers
	for start and end positions.
	(ispell-word): Assume END is a marker.

2007-05-17  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* printing.el: Group together all XEmacs/Emacs definitions.
	(pr-version): New version 6.9.
	(pr-global-menubar, pr-menu-char-height, pr-menu-char-width): New funs.
	(pr-menu-char-height, pr-menu-char-width): Fix initialization code.
	(pr-menu-bind): Fix code.
	(pr-e-frame-char-height, pr-e-frame-char-width)
	(pr-e-mouse-pixel-position, pr-x-add-submenu, pr-x-event-function)
	(pr-x-event-object, pr-x-find-menu-item, pr-x-font-height)
	(pr-x-font-width, pr-x-get-popup-menu-response, pr-x-make-event)
	(pr-x-misc-user-event-p, pr-x-relabel-menu-item, pr-x-event-x-pixel)
	(pr-x-event-y-pixel): Aliases eliminated.
	(pr-xemacs-global-menubar): Macro moved.
	(current-menubar, current-mouse-event, zmacs-region-stays)
	(deactivate-mark, pr-menu-position, pr-menu-state, pr-ps-name-old)
	(pr-txt-name-old, pr-ps-utility-old, pr-even-or-odd-old, pr-temp-menu):
	Vars moved.
	(pr-region-active-p, pr-menu-position, pr-menu-lookup, pr-menu-lock)
	(pr-update-mode-line, pr-do-update-menus, pr-menu-alist)
	(pr-relabel-menu-item, pr-menu-set-ps-title, pr-menu-set-txt-title)
	(pr-menu-set-utility-title, pr-even-or-odd-pages)
	(pr-f-set-keymap-parents, pr-f-set-keymap-name, pr-f-read-string)
	(pr-keep-region-active, pr-menu-get-item, pr-menu-set-item-name): Funs
	moved.

2007-05-17  Christian Plate  <cplate@web.de>  (tiny change)

	* textmodes/sgml-mode.el (sgml-tag):
	Fix bug: Call sgml-transformation-function.

2007-05-17  Martin Rudalics  <rudalics@gmx.at>

	* hilit-chg.el (highlight-changes-rotate-faces): Don't set
	modified flag of buffer.  Use `inhibit-modification-hooks'.

2007-05-16  Richard Stallman  <rms@gnu.org>

	* buff-menu.el (Buffer-menu-sort-column): Doc fix.

2007-05-16  Stefan Monnier  <monnier@iro.umontreal.ca>

	* files.el (magic-mode-alist, magic-fallback-mode-alist):
	Move the *ml, Postscript, and XmCD entries to the fallback part.

	* files.el (magic-fallback-mode-alist):
	Rename from file-start-mode-alist.

2007-05-16  Nikolaj Schumacher  <n_schumacher@web.de>  (tiny change)

	* progmodes/compile.el (compilation-handle-exit): Quote first
	argument of `run-hook-with-args'.

2007-05-16  Juanma Barranquero  <lekktu@gmail.com>

	* buff-menu.el (Buffer-menu-sort-column):
	* dabbrev.el (dabbrev-upcase-means-case-search):
	* dired.el (dired-recursive-deletes, dired-recursive-copies):
	* info.el (Info-current-subfile):
	* ls-lisp.el (ls-lisp-verbosity):
	* msb.el (msb-menu-cond):
	* pcvs.el (cvs-dired-use-hook):
	* simple.el (set-mark-command-repeat-pop):
	* time.el (display-time-24hr-format, display-time-mail-file):
	Doc fixes.

	* tutorial.el (get-lang-string, tutorial--find-changed-keys):
	* printing.el (pr-ps-fast-fire): Fix typos in docstrings.

	* view.el (view-inhibit-help-message): Fix typo in docstring.
	(view-scroll-auto-exit, view-try-extend-at-buffer-end): Doc fixes.

2007-05-16  Martin Rudalics  <rudalics@gmx.at>

	* textmodes/ispell.el (ispell-start-process): Defend against bad
	default-directory.

2007-05-14  Eli Zaretskii  <eliz@gnu.org>

	* mail/rmail.el (rmail-convert-to-babyl-format): Check
	content-transfer-encoding _last_, because it's its position that
	we need as value of base64-header-field-end.

2007-05-14  Juanma Barranquero  <lekktu@gmail.com>

	* files.el (mode-require-final-newline, require-final-newline)
	(enable-local-variables, enable-local-eval): Doc fixes.

2007-05-13  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-print.el: Use default color when foreground or background color
	are unspecified.  Reported by Leo <sdl.web@gmail.com>.
	(ps-print-version): New version 6.7.4.
	(ps-rgb-color): New argument.  Use default color when color is
	unspecified.
	(ps-begin-job): Fix code.

2007-05-12  Chong Yidong  <cyd@stupidchicken.com>

	* longlines.el (longlines-mode): Make longlines-auto-wrap
	buffer-local.  Add hooks unconditionally.
	(longlines-auto-wrap): Toggle wrapping.
	(longlines-after-change-function)
	(longlines-post-command-function): Check longlines-auto-wrap.

2007-05-12  Nick Roberts  <nickrob@snap.net.nz>

	* xt-mouse.el (xterm-mouse-debug-buffer): New variable.
	(xterm-mouse-translate): Use it.

2007-05-10  Richard Stallman  <rms@gnu.org>

	* international/iso-cvt.el (iso-cvt-read-only): Ignore arguments.
	(iso-cvt-write-only): Likewise.

	* emacs-lisp/easy-mmode.el (define-minor-mode):
	Fix generated doc string.

	* startup.el (fancy-splash-text): Add URL of guided tour.
	Adjust horizontal and vertical whitespace.

	* progmodes/compile.el (compilation-handle-exit):
	Use run-hook-with-args to run compilation-finish-functions.

	* files.el (file-start-mode-alist): New variable.
	(magic-mode-regexp-match-limit): Doc fix.
	(set-auto-mode): Handle file-start-mode-alist.
	A little cleanup of structure.

	* dabbrev.el (dabbrev-eliminate-newlines):
	Renamed from dabbrev--eliminate-newlines.  All uses changed.

2007-05-10  Micha,Ak(Bl Cadilhac  <michael@cadilhac.name>

	* man.el (Man-next-section): Don't consider the last line of the page
	as being part of any section.

2007-05-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/sgml-mode.el (sgml-value): Fix handling of attributes which
	can take any number of values.

2007-05-09  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/tex-mode.el (tex-font-lock-keywords-2): Add citet and citep
	to the list of citation commands.

2007-05-09  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-hooks.el (vc-find-root): Stop searching when the user changes.

2007-05-09  Edward O'Connor  <hober0@gmail.com>  (tiny change)

	* progmodes/python.el (python-font-lock-keywords)
	(python-open-block-statement-p, python-mode): Add support for the new
	"with" keyword.

2007-05-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* diff-mode.el (diff-apply-hunk, diff-test-hunk): Don't do by default
	the exact opposite of diff-goto-source.

	* emacs-lisp/advice.el (ad-special-forms): Remove.
	(ad-special-form-p): Use subr-arity.

	* newcomment.el (comment-search-forward): Make sure we search forward.
	(comment-enter-backward): Try and distinguish the non-matching case at
	EOB from the non-matching case with a missing comment-end-skip for
	a 2-char comment ender.
	(comment-choose-indent): New function extracted from comment-indent.
	Improve the alignment algorithm.
	(comment-indent): Use it.

	* textmodes/sgml-mode.el (sgml-lexical-context): Add handling of
	XML style Processing Instructions.
	(sgml-parse-tag-backward): Handle XML-style PIs.  Also ensure progress.
	(sgml-calculate-indent): Handle `pi' context.

	* vc.el: Ensure that update-changelog issues an error when used with
	a backend that does not implement it.
	(vc-update-changelog-rcs2log): Rename from vc-default-update-changelog.
	Remove `backend' argument.  Use expand-file-name.
	(vc-cvs-update-changelog, vc-rcs-update-changelog): New aliases.

	* progmodes/python.el (python-end-of-block): Revert last change.
	(python-end-of-statement): Make sure we move *forward*.

2007-05-08  Richard Stallman  <rms@gnu.org>

	* mail/mailabbrev.el (sendmail-pre-abbrev-expand-hook):
	Don't include non-self-insert commands in the exception for `-'.

2007-05-08  David Reitter  <david.reitter@gmail.com>

	* progmodes/python.el (python-guess-indent): Check non-nullness
	before comparing indent against the 2..8 interval.

2007-05-07  YAMAMOTO Mitsuharu  <mituharu@math.s.chiba-u.ac.jp>

	* term/mac-win.el (mac-ts-unicode-for-key-event): Check if text is
	available.

2007-05-06  Richard Stallman  <rms@gnu.org>

	* emacs-lisp/eldoc.el (turn-on-eldoc-mode): Doc fix.

2007-05-05  Stefan Monnier  <monnier@iro.umontreal.ca>

	* diff.el (diff): Use buffer-local vars diff-old-file and diff-new-file
	rather than storing their value in the revert-buffer function.

2007-05-04  Nick Roberts  <nickrob@snap.net.nz>

	* t-mouse.el (t-mouse-mode): Do nothing on a graphical display
	when disabling t-mouse-mode.

2007-05-01  Davis Herring  <herring@lanl.gov>

	* calendar/timeclock.el: Update version number.
	(timeclock-modeline-display): Mention timeclock-use-display-time
	in explanatory message.
	(timeclock-in): Fix non-interactive workday specifications.
	(timeclock-log): Don't kill the log buffer if it already existed.
	Suppress warnings when finding the log.  Don't check for a nil
	project twice.  Run hooks after killing the buffer (if applicable).
	(timeclock-geometric-mean): Rename to `timeclock-mean' (it never
	was geometric).  All uses changed.
	(timeclock-generate-report): Support prefix argument.

2007-05-03  Ryan Yeske  <rcyeske@gmail.com>

	* net/rcirc.el (rcirc-timeout-seconds): Increase to prevent unwanted
	disconnections.

2007-05-01  Romain Francoise  <romain@orebokech.com>

	* dired-x.el: Revert 2007-04-06 change.

2007-04-29  Stephen Berman  <Stephen.Berman@gmx.net>

	* find-dired.el (find-dired-filter): Propertize all text down to eob.

2007-04-29  Richard Stallman  <rms@gnu.org>

	* international/mule.el (auto-coding-alist): Add pdf => no-conversion.

2007-04-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/cc-mode.el (c-before-change): Use point-min rather
	than 1.

2007-04-28  Richard Stallman  <rms@gnu.org>

	* progmodes/sh-script.el (sh-mode): Recognize .profile as sh style.

2007-04-28  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gud.el (gud-menu-map): Pdb can't handle SIGINT so
	don't put stop on toolbar.

2007-04-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-hooks.el (vc-ignore-dir-regexp): Add /.../ for the DFS filesystem.

2007-04-28  Eli Zaretskii  <eliz@gnu.org>

	* makefile.w32-in ($(lisp)/mh-e/mh-loaddefs.el): Use ./mh-e
	instead of $(lisp)/mh-e.

2007-04-28  Glenn Morris  <rgm@gnu.org>

	* image-dired.el (image-dired-cmd-create-thumbnail-options)
	(image-dired-cmd-create-temp-image-options): Replace option
	+profile "*" with -strip.

2007-04-27  Chong Yidong  <cyd@stupidchicken.com>

	* textmodes/flyspell.el (flyspell-auto-correct-previous-word):
	Use window-start and window-end.

2007-04-27  Andreas Schwab  <schwab@suse.de>

	* emacs-lisp/sregex.el (sregexq): Fix doc string quoting.

2007-04-27  Eli Zaretskii  <eliz@gnu.org>

	* textmodes/fill.el (fill-paragraph): Doc fix.

2007-04-26  Luc Teirlinck  <teirllm@dms.auburn.edu>

	* locate.el (locate-in-alternate-database): Doc fix.

2007-04-26  Glenn Morris  <rgm@gnu.org>

	* button.el (button): Use underline if supported, else fall back
	to color.

	* version.el (emacs-version): Increase to 22.1.50.

2007-04-25  Richard Stallman  <rms@gnu.org>

	* hi-lock.el (hi-lock-file-patterns-policy): Default to `ask'.

2007-04-25  J.D. Smith  <jdsmith@as.arizona.edu>

	* progmodes/idlwave.el (idlwave-beginning-of-subprogram)
	(idlwave-end-of-subprogram): Take optional NOMARK arg to prevent
	pushing mark.
	(idlwave-current-routine): Don't push mark.

2007-04-25  Mathias Dahl  <mathias.dahl@gmail.com>

	* image-dired.el (image-dired-display-image): Derive image-type from
	filename rather than assuming jpeg, in case no resizing was needed.

2007-04-25  Johan Bockg,Ae(Brd  <bojohan@dd.chalmers.se>

	* custom.el (defface): Doc fix.

See ChangeLog.12 for earlier changes.

;; Local Variables:
;; coding: iso-2022-7bit
;; add-log-time-zone-rule: t
;; End:

    Copyright (C) 2007 Free Software Foundation, Inc.

  This file is part of GNU Emacs.

  GNU Emacs is free software; you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation; either version 2, or (at your option)
  any later version.

  GNU Emacs is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.

  You should have received a copy of the GNU General Public License
  along with GNU Emacs; see the file COPYING.  If not, write to the
  Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor,
  Boston, MA 02110-1301, USA.

;; arch-tag: 1e8aa93a-fc6c-4ac3-9b10-1f445e1840af
