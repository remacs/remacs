2005-08-05  Kenichi Handa  <handa@m17n.org>

	* international/code-pages.el: Add autoload cookies for all coding
	systems.

2005-08-04  Luc Teirlinck  <teirllm@auburn.edu>

	* cus-start.el (all): Put undo.c where it alphabetically belongs.

2005-08-04  Juri Linkov  <juri@jurta.org>

	* progmodes/compile.el (compilation-mode-map):
	* progmodes/grep.el (grep-mode-map):
	Bind TAB to `compilation-next-error' and [backtab] to
	`compilation-previous-error'.

	* progmodes/grep.el (grep-regexp-alist): Replace complex regexp
	matching line numbers, column numbers and their ranges with regexp
	matching only line numbers.
	(grep-context-face): New face variable.
	(grep-mode-font-lock-keywords): Use it.

	* faces.el (read-face-name): Delete duplicate faces.

2005-08-02  Juanma Barranquero  <lekktu@gmail.com>

	* thumbs.el (thumbs-find-image): Don't make variables
	automatically buffer local.
	(thumbs-current-tmp-filename, thumbs-current-image-filename)
	(thumbs-image-num): Make automatically buffer local.
	(thumbs-show-thumbs-list): Use `make-local-variable', not
	`make-variable-buffer-local'.
	(thumbs-insert-image): Make `thumbs-current-image-size'
	buffer-local.

	* play/doctor.el (doctor-type-symbol): "?\ " -> "?\s".
	(**mad**, *debug*, *print-space*, *print-upcase*, abuselst)
	(abusewords, account, afraidof, arerelated, areyou, bak, beclst)
	(bother, bye, canyou, chatlst, continue, deathlst, describe)
	(drnk, drugs, eliza-flag, elizalst, famlst, feared, fears)
	(feelings-about, foullst, found, hello, history, howareyoulst)
	(howdyflag, huhlst, ibelieve, improve, inter, isee, isrelated)
	(lincount, longhuhlst, lover, machlst, mathlst, maybe, moods)
	(neglst, obj, object, owner, please, problems, qlist)
	(random-adjective, relation, remlst, repetitive-shortness)
	(replist, rms-flag, schoollst, sent, sexlst, shortbeclst)
	(shortlst, something, sportslst, stallmanlst, states, subj)
	(suicide-flag, sure, things, thlst, toklst, typos, verb, want)
	(whatwhen, whereoutp, whysay, whywant, zippy-flag, zippylst):
	Defvar at compile time.

	* progmodes/ada-mode.el (ada-mode): Use `make-local-variable',
	not `make-variable-buffer-local'.

2005-08-02  Kim F. Storm  <storm@cua.dk>

	* emulation/cua-rect.el (cua--highlight-rectangle): Only show
	rectangle overlay in selected window.

2005-08-01  Luc Teirlinck  <teirllm@auburn.edu>

	* cus-start.el (all): Put `indicate-empty-lines' in fringe group
	instead of display group.  Make `indicate-buffer-boundaries'
	customizable through Custom.

2005-08-01  Juanma Barranquero  <lekktu@gmail.com>

	* progmodes/gdb-ui.el (gdb-frame-address, gdb-var-changed)
	(gdb-output-sink, gdba, gdb-cpp-define-alist-program)
	(gdb-set-gud-minor-mode, gdb-exited, gdb-setup-windows)
	(gdb-put-string): Fix typos in docstrings.

2005-08-01  Nick Roberts  <nickrob@snap.net.nz>

	Update copyright notices of files in progmodes directory for
 	release of Emacs 22.1.

	* progmodes/gdb-ui.el (gdb-enable-debug-log): Add autoload cookie.

	* progmodes/gud.el (gud-tooltip-mode): Add autoload cookie.  Don't
	barf if the GUD buffer has been killed.

2005-08-01  Kim F. Storm  <storm@cua.dk>

	* textmodes/table.el (table-yank-handler): Change defcustom to defvar.

2005-07-29  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/bytecomp.el (byte-compile-make-variable-buffer-local)
	(byte-compile-form-make-variable-buffer-local): New functions to warn
	about misuses of make-variable-buffer-local where make-local-variable
	was meant.

2005-07-29  Juanma Barranquero  <lekktu@gmail.com>

	* bs.el (bs-attributes-list): Doc fix.
	(bs): Update url-link.

	* desktop.el (desktop-save-buffer): Fix typos in docstring.
	(desktop-load-default): Simplify.

	* ibuffer.el (ibuffer-columnize-and-insert-list)
	(ibuffer-mouse-toggle-mark, ibuffer-count-marked-lines)
	(ibuffer-unmark-all, ibuffer-toggle-marks)
	(ibuffer-unmark-forward, ibuffer-unmark-backward)
	(ibuffer-compile-make-format-form, ibuffer-format-column)
	(ibuffer-current-buffers-with-marks)
	(ibuffer-update-title-and-summary): "?\ " -> "?\s".
	(ibuffer): Doc fix.
	(ibuffer-mode): Fix typo in docstring.
	(ibuffer-hooks, ibuffer-mode-hooks): Make obsolete and declare
	with `define-obsolete-variable-alias'.
	(ibuffer-elide-long-columns): Mark as obsolete.  Doc fix.

2005-07-29  Kenichi Handa  <handa@m17n.org>

	* international/mule-cmds.el (select-message-coding-system):
	Be sure to use LF for end-of-line.  If no coding system is decided,
	return iso-8859-1-unix.

2005-07-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* net/ange-ftp.el (ange-ftp-gateway-fatal-msgs)
	(ange-ftp-pending-error-line): New vars.
	(ange-ftp-process-handle-line, ange-ftp-process-filter): Use them
	to handle the non-fatal no-route-to-host messages.
	(internal-ange-ftp-mode): Make the no-match regexp more efficient.

2005-07-28  Juanma Barranquero  <lekktu@gmail.com>

	* isearch.el (isearch-mode-map, isearch-other-meta-char)
	(isearch-quote-char, isearch-printing-char)
	(isearch-text-char-description): "?\ " -> "?\s".
	(isearch-lazy-highlight-cleanup)
	(isearch-lazy-highlight-initial-delay)
	(isearch-lazy-highlight-interval)
	(isearch-lazy-highlight-max-at-a-time)
	(isearch-lazy-highlight-face, isearch-lazy-highlight-cleanup):
	Declare with define-obsolete-*-alias macros.
	(isearch-forward): Fix typo in docstring.
	(search-invisible, search-ring-yank-pointer)
	(regexp-search-ring-yank-pointer): Doc fixes.

	* recentf.el (recentf-menu-append-commands-p): Declare with
	`define-obsolete-variable-alias'.
	(recentf-max-saved-items, recentf-menu-filter)
	(recentf-arrange-by-rule-subfilter): Doc fixes.
	(recentf-menu-append-commands-flag)
	(recentf-initialize-file-name-history, recentf-expand-file-name)
	(recentf-clear-data): Fix typos in docstrings.

2005-07-28  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el: Smarten comments.
	(gdb-info-breakpoints-custom): Use nowarn when finding file.

2005-07-27  Dan Nicolaescu  <dann@ics.uci.edu>

	* term/apollo.el (terminal-init-apollo): New function containing
	all former top level forms in the file.
	* term/bobcat.el (terminal-init-bobcat):
	* term/cygwin.el (terminal-init-cygwin):
	* term/iris-ansi.el (terminal-init-iris-ansi):
	* term/linux.el (terminal-init-linux):
	* term/news.el (terminal-init-news):
	* term/rxvt.el (terminal-init-rxvt):
	* term/sun.el (terminal-init-sun):
	* term/tvi970.el (terminal-init-tvi970):
	* term/vt100.el (terminal-init-vt100):
	* term/vt102.el (terminal-init-vt102):
	* term/vt125.el (terminal-init-vt125):
	* term/vt200.el (terminal-init-vt200):
	* term/vt201.el (terminal-init-vt201):
	* term/vt220.el (terminal-init-vt220):
	* term/vt240.el (terminal-init-vt240):
	* term/vt300.el (terminal-init-vt300):
	* term/vt320.el (terminal-init-vt320):
	* term/vt400.el (terminal-init-vt400):
	* term/vt420.el (terminal-init-vt420):
	* term/wyse50.el (terminal-init-wyse50):
	* term/xterm.el (terminal-init-xterm): Likewise.

	* term/README: Describe the terminal-init-* functionality.

	* startup.el (command-line): After loading the terminal initialization
	file call the corresponding terminal initialization function.

2005-07-27  Kenichi Handa  <handa@m17n.org>

	* ps-bdf.el (bdf-read-font-info): Ignore glyphs whose ENCODING is
	negative.

	* ps-mule.el (ps-mule-bitmap-prologue): Fix arguments to setcharwidth.
	(ps-mule-composition-prologue): Fix for the case that
	RelativeCompose is false.

2005-07-26  Stefan Monnier  <monnier@iro.umontreal.ca>

	* smerge-mode.el (smerge-ediff): Use insert-buffer-substring.

	* descr-text.el (describe-char): Handle the case where the list of
	chars is displayed in a separate frame.
	Be a bit more discriminating when looking for the char.

2005-07-26  Juanma Barranquero  <lekktu@gmail.com>

	* bookmark.el (bookmark-automatically-show-annotations)
	(bookmark-read-annotation-text-func): Doc fixes.
	(bookmark-save): Improve argument/docstring consistency.
	(bookmark-get-bookmark, bookmark-get-bookmark-record)
	(bookmark-alist-from-buffer)
	(bookmark-upgrade-file-format-from-0)
	(bookmark-grok-file-format-version)
	(bookmark-maybe-upgrade-file-format, bookmark-kill-line)
	(bookmark-read-annotation-mode)
	(bookmark-insert-current-bookmark, bookmark-jump)
	(bookmark-exit-hook): Fix typos in docstrings.
	(bookmark-exit-hooks): Define as obsolete alias.
	(bookmark-exit-hook-internal): Run `bookmark-exit-hook',
	not `bookmark-exit-hooks'.  Fix docstring.
	(bookmark-bmenu-select): "?\ " -> "?\s".

2005-07-25  Ari Roponen <arjuropo@cc.jyu.fi>  (tiny change)

	* startup.el (command-line): Fix typo.

2005-07-24  Richard M. Stallman  <rms@gnu.org>

	* tooltip.el (tooltip-mode): Test emacs-basic-display,
	not emacs-quick-startup.

2005-07-24  Juanma Barranquero  <lekktu@gmail.com>

	* emacs-lisp/re-builder.el (reb-with-current-window): Delete.
	(reb-next-match, reb-show-subexp): Use `with-selected-window'
	instead of `reb-with-current-window'.
	(reb-prev-match): Likewise.  Also, don't move left if the search
	was unsuccessful.
	(reb-initialize-buffer): New function.
	(re-builder, reb-change-syntax): Use it.

	* man.el (Man-goto-page): Make second argument NOERROR optional.

2005-07-23  Richard M. Stallman  <rms@gnu.org>

	* man.el (Man-bgproc-sentinel): Check here for failure to find
	any man page in the output, and report the error here.
	(Man-arguments): Make it permanent local.
	(Man-goto-page): New arg NOERROR.  Never kill the current buffer.
	(Man-mode): Pass t for NOERROR.

	* progmodes/grep.el (grep-error-face): Use font-lock-keyword-face.
	(grep-mode-font-lock-keywords):
	Don't use compilation-...-face for messages that are not file names.

	* progmodes/compile.el (compilation-mode-font-lock-keywords):
	Don't use compilation-...-face for messages that are not file names.

2005-07-22  Juri Linkov  <juri@jurta.org>

	* startup.el (normal-splash-screen): Update menu name.

	* tempo.el (tempo-insert-template): Fix 2005-07-16 change.

2005-07-22  Dan Nicolaescu  <dann@ics.uci.edu>

	* term/xterm.el: Load term/rxvt if the terminal is actually an
	rxvt terminal.
	(xterm-rxvt-set-background-mode): Remove, not used anymore.

	* term/rxvt.el (function-key-map): Use substitute-key-definition
	to bind {C,S,C-S}-{f1-f10}. Add a few missing key bindings.

	* term/cygwin.el: New file.

2005-07-22  Kim F. Storm  <storm@cua.dk>

	* image-file.el (insert-image-file, image-file-yank-handler):
	Fix last change to maintain a (unique) yank-handler on yanked images.

2005-07-22  Eduardo Mu,Aq(Boz  <emufer@terra.es>  (tiny change)

	* dired.el (dired-move-to-filename-regexp): Recognize the B suffix
	of the file size (as in "177B" for 177 bytes).  This happens with
	"ls -lh" on FreeBSD.

2005-07-22  Juanma Barranquero  <lekktu@gmail.com>

	* hilit-chg.el (highlight-changes-global-initial-state)
	(highlight-compare-buffers, hilit-chg-turn-on-maybe)
	(hilit-chg-fixup, highlight-changes-mode):
	Fix typos in docstrings.
	(highlight-changes-global-modes, highlight-changes-rotate-faces):
	Doc fixes.

2005-07-21  Luc Teirlinck  <teirllm@auburn.edu>

	* emacs-lisp/easy-mmode.el (define-minor-mode): Never call the
	mode function using `eval-after-load'.

2005-07-21  Kim F. Storm  <storm@cua.dk>

	* mail/emacsbug.el (report-emacs-bug): Request that backtraces are
	included when reporting an emacs crash, and tell about the DEBUG file.

	* image-file.el (insert-image-file): Add yank-handler.
	(image-file-yank-handler): Yank handler to make unique copies of
	images when they are yanked into a buffer next to each other.

2005-07-21  Juanma Barranquero  <lekktu@gmail.com>

	* comint.el (comint-use-prompt-regexp, comint-send-input)
	(comint-source-default, comint-extract-string)
	(comint-get-source, comint-word, comint-completion)
	(comint-source, comint-prompt-read-only, comint-update-fence):
	Fix typos in docstrings.
	(comint-use-prompt-regexp-instead-of-fields, comint-kill-output):
	Declare with define-obsolete-*-alias macros.
	(comint-previous-matching-input-from-input)
	(comint-next-matching-input-from-input)
	(comint-previous-matching-input, comint-next-matching-input)
	(comint-forward-matching-input):
	Improve argument/docstring consistency.

	* desktop.el (desktop-clear-preserve-buffers-regexp):
	Also preserve the *server* buffer.

	* simple.el (clone-indirect-buffer): Doc fix.
	(fixup-whitespace, just-one-space)
	(backward-delete-char-untabify, lambda): "?\ " -> "?\s".
	(next-error, next-error-highlight)
	(next-error-highlight-no-select, next-error-last-buffer)
	(next-error-buffer-p, next-error-find-buffer, next-error)
	(previous-error, next-error-no-select, previous-error-no-select)
	(open-line, split-line, minibuffer-prompt-width, kill-new)
	(binary-overwrite-mode): Fix typos in docstrings.
	(set-fill-column): Fix typo in message.

	* skeleton.el (skeleton-proxy-new): Doc fix.

	* strokes.el (strokes-load-hook): Doc fix.
	(strokes-grid-resolution, strokes-get-grid-position)
	(strokes-renormalize-to-grid, strokes-read-stroke)
	(strokes-read-complex-stroke, strokes-file, strokes-last-stroke)
	(strokes-global-map): Fix typos in docstrings.
	(strokes-help): Doc fix.  Fix help message and pass it through
	`substitute-command-keys'.

	* tempo.el (tempo-insert-prompt, tempo-interactive)
	(tempo-show-completion-buffer, tempo-tags, tempo-match-finder)
	(tempo-insert-string-functions, tempo-local-tags)
	(tempo-define-template, tempo-insert-template)
	(tempo-insert-prompt-compat, tempo-is-user-element)
	(tempo-insert-mark, tempo-find-match-string, tempo-complete-tag):
	Fix typos in docstrings.

	* vcursor.el (vcursor-other-window, vcursor-bind-keys)
	(vcursor-key-bindings, vcursor-use-vcursor-map)
	(vcursor-find-window, vcursor-scroll-down)
	(vcursor-disable, vcursor-beginning-of-buffer)
	(vcursor-end-of-buffer): Fix typos in docstrings.
	(vcursor-relative-move, vcursor-get-char-count):
	Improve argument/docstring consistency.

	* version.el: "?\ " -> "?\s".

	* wid-edit.el (widget-default-create, widget-after-change)
	(widget-default-format-handler, widget-checklist-add-item)
	(widget-radio-add-item, widget-choose, widget-specify-secret)
	(widget-field-value-create, widget-field-value-get)
	(widget-editable-list-format-handler)
	(widget-editable-list-entry-create, widget-group-value-create)
	(widget-documentation-link-add)
	(widget-documentation-string-value-create): "?\ " -> "?\s".
	(widget-convert-text): Doc fix.
	(widget-narrow-to-field, widget-field-find)
	(widget-url-link-action, widget-emacs-library-link-action)
	(widget-color-notify): Fix typos in docstrings.

	* w32-fns.el (w32-shell-name): Use `bound-and-true-p'.
	(x-select-text, set-w32-system-coding-system)
	(w32-add-charset-info): Fix typos in docstrings.

	* emulation/cua-base.el (cua-mode, cua-enable-register-prefix)
	(cua-enable-cua-keys, cua-use-hyper-key)
	(cua-virtual-rectangle-edges): Fix typos in docstrings.
	(cua--M/H-key, cua--init-keymaps): "?\ " -> "?\s".

	* net/tramp.el (tramp-handle-load): Fix typo in error message.

	* emacs-lisp/re-builder.el (regexp-builder): Declare with
	`defalias' instead of faking it.

	* eshell/em-ls.el (eshell-ls-decorated-name): Doc fix.
	(eshell-ls-missing, eshell-ls-dired-initial-args)
	(eshell-ls-use-in-dired): Fix typos in docstrings.

2005-07-20  Kim F. Storm  <storm@cua.dk>

	* emulation/cua-base.el (cua-mode): Improve doc string.

2005-07-20  Juanma Barranquero  <lekktu@gmail.com>

	* abbrev.el (expand-region-abbrevs): Doc fix.
	(inverse-add-mode-abbrev, inverse-add-global-abbrev):
	Improve argument/docstring consistency.

	* arc-mode.el (archive-get-descr, archive-alternate-display):
	Doc fixes.
	(archive-l-e): Improve argument/docstring consistency.
	(archive-tmpdir, archive-unixdate, archive-unixtime)
	(archive-chmod-entry): Fix typos in docstrings.
	(archive-unflag, archive-unflag-backwards)
	(archive-unmark-all-files): "?\ " -> "?\s".

	* buff-menu.el (Buffer-menu-unmark): Doc fix.
	(Buffer-menu-not-modified, Buffer-menu-execute)
	(Buffer-menu-toggle-read-only, Buffer-menu-buffer+size)
	(list-buffers-noselect, Buffer-menu-select): "?\ " -> "?\s".

	* composite.el (compose-string, encode-composition-rule)
	(compose-last-chars): Fix typos in docstrings.

	* desktop.el (desktop-enable, desktop-basefilename):
	Declare with `define-obsolete-variable-alias'.
	(desktop-internal-v2s): Don't quote keywords.
	(desktop-clear): "?\ " -> "?\s".

	* dired.el (dired-align-file, dired-flag-backup-files)
	(dired-change-marks, dired-unmark-all-files): "?\ " -> "?\s".
	(dired-listing-switches, dired-ls-F-marks-symlinks)
	(dired-dwim-target, dired-load-hook, dired-mode-hook)
	(dired-directory, dired-faces, dired, dired-revert)
	(dired-mode, dired-summary, dired-view-file)
	(dired-copy-filename-as-kill, dired-delete-file)
	(dired-no-confirm, dired-unmark-all-marks)
	(dired-sort-by-date-regexp, dired-sort-by-name-regexp)
	(dired-sort-inhibit, dired-sort-other): Fix typos in docstrings.
	(dired-undo, dired-get-file-for-visit, dired-sort-toggle-or-edit):
	Fix typos in message strings.

	* dired-x.el (virtual-dired): Declare with `defalias'.
	(dired-mark-unmarked-files, dired-local-variables-file)
	(dired-omit-here-always): Doc fix.
	(dired-omit-mode, dired-find-subdir)
	(dired-enable-local-variables, dired-clean-up-buffers-too)
	(dired-extra-startup, dired-mark-extension, dired-jump)
	(dired-jump-other-window, dired-omit-localp, dired-virtual-mode)
	(dired-smart-shell-command, dired-guess-shell-alist-user)
	(dired-man, dired-initial-position, dired-x-hands-off-my-keys)
	(dired-x-bind-find-file, dired-x-submit-report):
	Fix typos in docstrings.
	(dired-mark-unmarked-files): "?\ " -> "?\s".

	* dirtrack.el (dirtrack-list): Fix typos in docstring.

	* faces.el (describe-face): "?\ " -> "?\s".
	(read-all-face-attributes, read-face-font, modify-face)
	(face-attr-construct, italic): Fix typos in docstrings.
	(frame-update-face-colors): Declare with
	`define-obsolete-function-alias'.

	* files.el (find-file-noselect, recode-file-name): Doc fixes.
	(insert-directory, kill-some-buffers): "?\ " -> "?\s".
	(magic-mode-alist, buffer-file-numbers-unique)
	(write-file-functions, get-free-disk-space):
	Fix typos in docstrings.
	(find-file-not-found-hooks, find-file-hooks, write-file-hooks)
	(write-contents-hooks, write-file-hooks):
	Declare with `define-obsolete-variable-alias'.

	* forms-d2.el (arch-rj): Fix typo in docstrings.
	(arch-tocol): Likewise.  "?\ " -> "?\s".

	* frame.el (set-frame-font, cursor-in-non-selected-windows):
	Fix typo in docstring.
	(set-screen-width, set-screen-height): Delete redundant info in
	doctrings.
	(new-frame, screen-height, screen-width): Declare with
	`define-obsolete-function-alias'.
	(delete-frame-hook, blink-cursor): Declare with
	`define-obsolete-variable-alias'.

	* paths.el (prune-directory-list): Fix typos in docstring.

	* pcvs-util.el (cvs-flags-query, cvs-strings->string)
	(cvs-prefix-get): Fix typos in docstrings.

	* ps-print.el (ps-extend-face-list, ps-extend-face)
	(ps-print-background-image): Fix typos in docstrings.
	(ps-default-fg, ps-default-bg): Doc fixes.

	* s-region.el (s-region-bind): Doc fix.
	(s-region-move-p1, s-region-move-p2): Fix typos in docstrings.

	* textmodes/org.el (org-table-formula-substitute-names)
	(org-table-get-vertical-vector): Doc fixes.
	(org-table-recalculate): Remove unused argument to `message'.

2005-07-19  Carsten Dominik  <dominik@science.uva.nl>

	* textmodes/org.el (org-table-column-names)
	(org-table-column-name-regexp)
	(org-table-named-field-locations): New variables.
	(org-archive-subtree): Protect `this-command' when calling
	`org-copy-subtree' and `org-cut-subtree', to avoid appending to
	the kill buffer.
	(org-complete): Remove fixed-formula completion.
	(org-edit-formulas-map): New variable.
	(org-table-edit-formulas): New command.
	(org-finish-edit-formulas, org-abort-edit-formulas)
	(org-show-variable, org-table-get-vertical-vector): New functions.
	(org-table-maybe-eval-formula): Handle `:=' fields.
	(org-table-get-stored-formulas, org-table-store-formulas)
	(org-table-get-formula, org-table-modify-formulas)
	(org-table-replace-in-formulas): Handle named field formulas.
	(org-table-get-specials): Store locations of named fields.

2005-07-19  Juri Linkov  <juri@jurta.org>

	* progmodes/grep.el (grep-regexp-alist)
	(grep-mode-font-lock-keywords, grep-process-setup):
	Use default GNU grep match color "01;31m" instead of "01;41m".
	(grep-regexp-alist, grep-mode-font-lock-keywords):
	Use `\\[[0-9]*m' instead of `\\[00m'.
	(grep-regexp-alist): Move `\\(?:\033\\[K\\)?' from sgr_end to
	sgr_start where its handling is more important.  Use the real
	length of sgr_start instead of constant 8.
	(grep-mode-font-lock-keywords): Don't delete `\\(?:\033\\[K\\)?'
	specially.  Delete all remaining escape sequences.
	(grep-process-setup): Set "GREP_COLORS" for GNU grep 2.5.1-cvs.
	(grep-regexp-alist): Make hyperlink only for binary file name
	instead of the whole line.
	(grep-mode-map): Bind `backtab' to `compilation-previous-file'.
	(grep-mode): Add autoload.

	* emacs-lisp/find-func.el (find-function-regexp):
	Add `define-compilation-mode'.

2005-07-19  Juri Linkov  <juri@jurta.org>

	* compare-w.el (compare-ignore-whitespace, compare-windows-sync)
	(compare-windows-sync-string-size, compare-windows-recenter)
	(compare-windows-highlight, compare-windows): Add version 22.1.
	(compare-windows) <defface>: Inherit from lazy-highlight instead
	of duplicating its default value.

	* cus-edit.el (custom-mode-map): Bind `C-c C-c' to `Custom-set'.
	(Custom-mode-menu): Use `info' instead of `Info-goto-node'.

	* descr-text.el (describe-char): Create link buttons for `charset'
	and `code point'.  Add the current input method name with a link
	button to `to input' field.  Print face names of display table
	characters in `The display table entry is displayed by' section
	instead of printing face-id in the `display' field.
	Guess hardcoded faces and create a link button for them.
	Skip empty fields when calculating max-width.
	Treat `widget-create' specially while inserting strings from the
	collected field list.
	(describe-char-after): Made obsolete in version 22.1, not 21.5.

	* diff-mode.el (diff-file-header): Change foreground color from
	yellow to green on light backgrounds.
	(diff-context): Inherit from `shadow' only for color/grayscale
	with more than 88 colors.
	(diff-indicator-removed, diff-indicator-added)
	(diff-indicator-changed): New faces.
	(diff-font-lock-keywords): Use new faces.  Regroup rules.
	Add "^---$" for `normal' diff format.  Fontify `#' lines with
	font-lock-comment-delimiter-face and font-lock-comment-face.
	Add `#' to ^[^...] in the rule for `diff-context-face'.

	* faces.el (mode-line-highlight): Replace RoyalBlue4 with
	a button-like box.  Inherit from `highlight' on low colors.
	(shadow): Use shades of gray only for color/grayscale with
	more than 88 colors.  Use green for light backgrounds with
	8 colors, and yellow for dark backgrounds with 8 colors.

	* font-lock.el (font-lock-regexp-grouping-backslash):
	Don't inherit from escape-glyph (use bold for all cases).

	* info.el (info-xref-visited): Use light foreground color `violet'
	for dark backgrounds instead of dark color `magenta3'.
	(info-title-1): Use `yellow' color for dark backgrounds.

	* isearch.el (isearch): Use not-too-dark magenta3 instead of
	too-light magenta2.

	* replace.el (match): Use slightly more light RoyalBlue3 instead
	of dark RoyalBlue4.

	* wid-edit.el (widget-inactive): Inherit from `shadow'.

2005-07-19  Juanma Barranquero  <lekktu@gmail.com>

	* novice.el (disabled-command-hook): Declare it with
	`define-obsolete-variable-alias'.

	* desktop.el (desktop-enable, desktop-buffer-modes-to-save)
	(desktop-buffer-misc-functions, desktop-buffer-handlers)
	(desktop-load-default): Add release to obsolescence info.
	(desktop-globals-to-clear, desktop-buffer-mode-handlers)
	(desktop-append-buffer-args, desktop-read):
	Fix typos in docstrings.
	(desktop-kill): Fix typo in message.
	(desktop-save): Doc fix.

2005-07-19  Michael Kifer  <kifer@cs.stonybrook.edu>

	* viper-cmd.el (viper-escape-to-state): Bug fix.
	(viper-envelop-ESC-key): Change the definition of fast
	keysequence so it'll work with keyboard macros.

	* ediff.el (ediff-patch-buffer): Change the docstring.

2005-07-19  Kenichi Handa  <handa@m17n.org>

	* international/mule-cmds.el (select-safe-coding-system): Try to
	use an auto-coding (if any) before anything else.  If the found
	auto-coding is invalid, show a warning message.

	* international/mule.el (find-auto-coding): New function created
	by modifying the body of set-auto-coding.
	(set-auto-coding): Use find-auto-coding to find a coding.

2005-07-18  Richard M. Stallman  <rms@gnu.org>

	* allout.el (allout-isearch-expose): Use isearch-mode-end-hook-quit,
	not isearch-mode-end-hook-error.
	(allout-before-change-protect): Fix error message.

2005-07-18  Juri Linkov  <juri@jurta.org>

	* allout.el (allout-mode):
	* calculator.el (calculator-copy):
	* custom.el (custom-known-themes):
	* dired.el (dired-desktop-buffer-misc-data)
	(dired-restore-desktop-buffer):
	* dired-x.el (dired-omit-marker-char):
	* files.el (basic-save-buffer):
	* font-core.el (font-lock-mode):
	* calendar/calendar.el (calendar-goto-hebrew-date)
	(calendar-goto-coptic-date, calendar-goto-ethiopic-date)
	(calendar-goto-persian-date):
	* language/ethio-util.el (ethio-sera-to-fidel-region):
	* textmodes/picture.el (picture-mode):
	Delete duplicate duplicate words.

2005-07-18  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-mode-map): Remove key bindings for regexp
	chars * ? } |.
	(isearch-fallback): Don't call `isearch-process-search-char'.
	(isearch-*-char, isearch-}-char, isearch-|-char): Remove functions.
	(isearch-process-search-char): Call `isearch-fallback' for regexp
	chars * ? } |.
	(isearch-return-char): Make obsolete with `make-obsolete' instead
	of simply documenting it as obsolete in the docstring.
	(isearch-fallback): Refill docstring.

	* international/isearch-x.el
	(isearch-process-search-multibyte-characters): Remove unneeded `concat'.
	Add intermediate values to `junk-hist' instead of `minibuffer-history'.
	Test the length of `str'.

2005-07-18  Juanma Barranquero  <lekktu@gmail.com>

	* allout.el (allout-resolve-xref): Fix typos in error strings.
	(allout-before-change-protect): Remove unneeded `concat'.

	* array.el (array-mode, array-reconfigure-rows)
	(untabify-backward): Fix typos in docstrings.
	(array-reconfigure-rows): Use `insert-buffer-substring', not
	`insert-buffer'.

	* calendar/icalendar.el (icalendar--get-unfolded-buffer):
	* progmodes/ada-mode.el (ada-make-body):
	Use `insert-buffer-substring' and `goto-char', not `insert-buffer'.

	* dired.el (dired-log):
	* tar-mode.el (tar-subfile-save-buffer):
	* play/zone.el (zone-pgm-stress-destress):
	Use `insert-buffer-substring', not `insert-buffer'.

2005-07-17  Simon Josefsson  <jas@extundo.com>

	* mail/smtpmail.el (smtpmail-auth-supported): Prefer PLAIN over LOGIN.

2005-07-16  Jose E. Marchesi  <jemarch@gnu.org>

	* lisp/mail/smtpmail.el (smtpmail-auth-supported):
	Add plain auth method.
	(smtpmail-try-auth-methods): Add AUTH PLAIN dialog.

2005-07-17  Kim F. Storm  <storm@cua.dk>

	* ido.el (dired-other-window): Add ido property.

2005-07-16  Juanma Barranquero  <lekktu@gmail.com>

	* emacs-lisp/bytecomp.el (byte-compile-maybe-guarded):
	Fix typo in docstring.
	(byte-compile-interactive-only-functions): Add `insert-buffer' and
	`insert-file-literally'.

	* emacs-lisp/edebug.el (def-edebug-form-spec): Add obsolescence
	info and delete redundant message.  Doc fix.
	(edebug-install-custom-print-funcs, edebug-reset-print-funcs)
	(edebug-uninstall-custom-print-funcs): Define as obsolete aliases.

2005-07-16  Richard M. Stallman  <rms@gnu.org>

	* emacs-lisp/bytecomp.el (byte-compile-and-recursion): New function.
	(byte-compile-and): Use byte-compile-and-recursion.
	(byte-compile-or-recursion): New function.
	(byte-compile-or): Use that.
	(byte-compile-if): Guard the else-clause too.
	(byte-compile-maybe-guarded): Handle (not (featurep 'emacs)).

	* isearch.el (isearch-mode-end-hook-quit): New variable.
	(isearch-done): Bind it.
	(isearch-mode-end-hook): Doc fix.

	* allout.el (allout-isearch-did-quit): Variable deleted.
	(allout-real-isearch-abort): Function name no longer used.
	(allout-mode): Do allout-enwrap-isearch whenever feature is wanted.
	(allout-isearch-rectification): isearch-mode always exists.
	Don't set allout-isearch-did-quit.
	(allout-isearch-expose): Check isearch-mode-end-hook-error, not
	allout-isearch-did-quit.
	(allout-enwrap-isearch): Just add the hook.
	(allout-isearch-abort): Function deleted.
	(allout-pre-command-business): Avoid warning.

	* progmodes/pascal.el (pascal-outline-map): Use fboundp, not boundp.
	Correctly avoid warnings.
	(pascal-outline): Likewise.

	* progmodes/f90.el (f90-abbrev-start): Avoid warning.

	* progmodes/asm-mode.el (asm-comment): Use with-no-warnings.

	* play/tetris.el (tetris-mode): Avoid warning.

	* play/snake.el (snake-mode): Avoid warning.

	* play/gamegrid.el (gamegrid-shared-game-dir): Add defvar.
	(gamegrid-set-display-table): Avoid warning.
	(gamegrid-set-timer): Likewise.
	(gamegrid-make-mono-tty-face): Use set-face-inverse-video-p.
	(gamegrid-add-score-with-update-game-score-1): Take FILE
	as argument.
	(gamegrid-add-score-with-update-game-score): Pass that argument.
	Rename have-shared-game-dir to gamegrid-shared-game-dir.

	* net/eudc-hotlist.el (eudc-hotlist-mode): Avoid warnings.

	* net/eudc-bob.el (eudc-jump-to-event): Avoid warning.
	(eudc-bob-display-jpeg, eudc-bob-can-display-inline-images): Likewise.

	* mail/uce.el (uce-reply-to-uce): Replace beginning-of-buffer
	and insert-file.

	* mail/supercite.el (sc-no-blank-line-or-header): Avoid warning.
	(sc-ask): Avoid warnings.

	* eshell/em-hist.el (eshell-rebind-keys-alist): Add defvar.
	(eshell-hist-initialize): Use that var the natural way.

	* emulation/viper-init.el (viper-activate-input-method): Avoid warning.

	* emacs-lisp/re-builder.el (reb-cook-regexp):
	Avoid warning calling lre-compile-string.
	(reb-color-display-p): Avoid warning.

	* calculator.el (calculator-last-input): Guard uses
	of event-key and key-press-event-p.
	(event-key, key-press-event-p): Delete definitions.

	* emacs-lisp/find-gc.el (find-gc-unsafe-list)
	(find-gc-source-directory, find-gc-subrs-callers)
	(find-gc-noreturn-list, find-gc-source-files)
	(find-gc-subrs-called): Vars renamed and defvar'd.

	* emacs-lisp/checkdoc.el (checkdoc-make-overlay)
	(checkdoc-overlay-put, checkdoc-delete-overlay)
	(checkdoc-overlay-start, checkdoc-overlay-end)
	(checkdoc-mode-line-update, checkdoc-char=):
	Define such that compiler knows they are defined.
	(checkdoc-call-eval-buffer): Delete.  Use eval-buffer directly.
	(checkdoc-read-event): Delete.  Use read-event directly.

	* whitespace.el (whitespace-make-overlay)
	(whitespace-overlay-put, whitespace-delete-overlay)
	(whitespace-overlay-start, whitespace-overlay-end):
	Define such that compiler knows they are defined.
	(whitespace): Move conditional inside.

	* tempo.el (tempo-insert-template): Suppress warning.

	* ediff-diff.el (longlines-mode): Add defvar.

2005-07-16  Gary Howell  <g1howell-list@yahoo.com>  (tiny change)

	* server.el: Bind "C-x #" in a way that works even if C-x is
	redefined to a command key, not a prefix key.

2005-07-16  Johan Bockgard  <bojohan@users.sourceforge.net>  (tiny change)

	* emacs-lisp/cl-macs.el (cl-make-type-test): Defer evaluation of
	cl-make-type-test till execution time.

2005-07-16  Markus Rost  <rost@math.uni-bielefeld.de>

	* dired-x.el (dired-do-relsymlink-regexp): Add missing optional
	arg ARG and use it.

2005-07-16  Johan Bockgard  <bojohan@users.sourceforge.net>  (tiny change)

	* emacs-lisp/cl-macs.el (cl-make-type-test): Add `atom' type.

2005-07-15  Luc Teirlinck  <teirllm@auburn.edu>

	* emacs-lisp/easy-mmode.el (define-minor-mode): Avoid constructing
	a defcustom with two :set or :type keywords.

2005-07-15  Richard M. Stallman  <rms@gnu.org>

	* emacs-lisp/lisp-mode.el (emacs-lisp-mode-syntax-table):
	Don't give ^M comment-end syntax.

2005-07-16  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-var-update, gdb-var-update-handler):
	Don't consider gdbmi (gdb-mi.el has its own update functions).
	(gdb-var-delete): Make it work for gdbmi as well.
	(gdb-speedbar-expand-node): Move var-update here for gdbmi.

	* progmodes/gud.el (etags, sdb): Only require etags when needed.
	(gud-speedbar-menu-items): Correct logic for enabling items.

2005-07-15  Kim F. Storm  <storm@cua.dk>

	* ido.el: Fix commentary.
	(ido-define-mode-map): Move ido-next-work-file to C-M-o.
	Use with-no-warnings around ffap-guesser.
	(ido-file-internal, ido-read-file-name, ido-read-directory-name):
	Let bind minibuffer-completing-file-name to t.

2005-07-15  Juanma Barranquero  <lekktu@gmail.com>

	* startup.el (site-run-file, keyboard-type): Doc fixes.
	(command-line): Check for "--basic-display" argument; also for
	"--quick", not "--bare-bones" (which was renamed).
	(fancy-splash-text): Add missing item "Getting New Versions".
	(normal-splash-screen): Fix typos and improve consistency with
	`fancy-splash-text'.  Update copyright year.

	* hexl.el (hexl-mode-map): Recognize also `ehelp-command' as a
	valid binding for `help-char'.

	* emacs-lisp/derived.el (derived-mode-hook-name): Doc fix.

2005-07-14  Dan Nicolaescu  <dann@ics.uci.edu>

	* term.el (term-mode): Disable cua-mode for term buffers.

2005-07-14  Juanma Barranquero  <lekktu@gmail.com>

	* add-log.el (add-log-mailing-address, change-log-merge):
	Doc fixes.
	(change-log-get-method-definition): Fix typo in docstring.

2005-07-14  Kim F. Storm  <storm@cua.dk>

	* emulation/cua-base.el:
	(cua--pre-command-handler-1, cua--pre-command-handler)
	(cua--post-command-handler-1, cua--post-command-handler):
	Split in two.  Check (buffer local) value of cua-mode.
	(cua-selection-mode): New command.

2005-07-13  Luc Teirlinck  <teirllm@auburn.edu>

	* custom.el (custom-initialize-safe-set)
	(custom-initialize-safe-default): Doc fixes.

	* frame.el (blink-cursor-mode): Use `custom-initialize-safe-default'
	and simplify :init-value again.

	* tooltip.el (tooltip-mode): Use `custom-initialize-safe-default'
	and simplify :init-value again.  Delete autoload.

	* startup.el (command-line): Use `custom-reevaluate-setting' again
	for tooltip-mode.

	* emacs-lisp/easy-mmode.el (define-minor-mode): Avoid constructing
	a defcustom with two :initialize keywords.

2005-07-13  Juanma Barranquero  <lekktu@gmail.com>

	* allout.el (my-mark-marker, allout-isearch-prior-pos)
	(allout-unprotected, allout-undo-aggregation, allout-snug-back)
	(allout-post-command-business, allout-flag-region)
	(isearch-reenable-font-lock, allout-yank)
	(allout-insert-latex-header, allout-insert-latex-trailer)
	(allout-latex-verbatim-quote-curr-line, allout-latexify-exposed)
	(allout-latex-verb-quote): Fix typos in docstrings.
	(allout-enwrap-isearch, regexp-sans-escapes): Doc fixes.
	(allout-unprotected, allout-prefix-data):
	Improve argument/docstring consistency.
	(allout-chart-subtree): Fix argument spec.
	(allout-open-topic): Rename `use_sib_bullet' argument to
	`use-sib-bullet'.  Doc fix.

	* whitespace.el (whitespace-check-buffer-leading)
	(whitespace-check-buffer-trailing)
	(whitespace-check-buffer-indent)
	(whitespace-check-buffer-spacetab)
	(whitespace-check-buffer-ateol, whitespace-highlighted-space)
	(whitespace-check-leading-whitespace)
	(whitespace-check-trailing-whitespace)
	(whitespace-check-spacetab-whitespace)
	(whitespace-check-indent-whitespace)
	(whitespace-check-ateol-whitespace, whitespace-abort-on-error)
	(whitespace-modes): Fix typos in docstrings.
	(defgroup, defcustom): Doc fixes.

	* winner.el (winner-mode, winner-boring-buffers)
	(winner-pending-undo-ring): Doc fixes.
	(winner-ring): Remove unneeded `progn'.
	(winner-equal): `defsubst' it.
	(winner-redo): Fix message.

2005-07-13  Kim F. Storm  <storm@cua.dk>

	* simple.el (line-move-1): Always use vertical-motion to
	do the last (or only) line move to ensure some movement.
	Undo 2005-06-23 change--don't check for overlays.

2005-07-13  YAMAMOTO Mitsuharu  <mituharu@math.s.chiba-u.ac.jp>

	* term/mac-win.el (ccl-encode-mac-roman-font)
	(ccl-encode-mac-centraleurroman-font)
	(ccl-encode-mac-cyrillic-font, ccl-encode-mac-symbol-font):
	(ccl-encode-mac-dingbats-font): Remove check for ASCII.
	Change charset-id boundary of dimension to ?\xef.
	(mac-char-fontspec-list): New constant.
	(fontset-add-mac-fonts): Use it.  Accept non-string `base-family'
	argument.  Nil uses itself as family in font-spec.  Previous
	behavior for nil is now provided by non-nil non-string argument.
	All callers changed.  Add font-specs for Mac fonts to
	"fontset-default" unless iso8859-1 fonts are installed.

2005-07-13  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/sh-script.el (sh-get-indent-info): Only indent
	a continuation line if the \ is preceded by SPC or TAB.
	(sh-get-indent-info): Simplify.
	(sh-mark-init, sh-learn-buffer-indent, sh-add-completer):
	Use with-current-buffer.

	* font-lock.el (font-lock-fontify-keywords-region): Avoid inf-loops
	when the matched text is empty.

2005-07-12  Luc Teirlinck  <teirllm@auburn.edu>

	* startup.el (command-line): Revert to previous handling of
	tooltip-mode.  Explain in comment why the complexity is needed.

	* tooltip.el (tooltip-mode): Revert to previous implementation of
	its defcustom.

	* frame.el (blink-cursor-mode): Revert to previous implementation
	of its defcustom.  Update comment.

2005-07-12  Lars Hansen  <larsh@soem.dk>

	* desktop.el: Update e-mail address.

2005-07-12  YAMAMOTO Mitsuharu  <mituharu@math.s.chiba-u.ac.jp>

	* term/mac-win.el (mac-services-mail-selection)
	(mac-services-mail-to): New functions.
	(mac-application-menu-map): Bind them.

2005-07-12  wulei <milton@wulei.net>  (tiny change)

	* progmodes/gdb-ui.el: Add note about buffering with Windows.

2005-07-11  Luc Teirlinck  <teirllm@auburn.edu>

	* custom.el (custom-reevaluate-setting): Doc fix.

2005-07-11  Jay Belanger  <belanger@truman.edu>

	* calc/calc.el (calc-embedded-announce-formula-alist)
	(calc-embedded-open-close-plain-alist)
	(calc-embedded-open-close-mode-alist): Add checks for additional
	major modes (due to Robert J. Chassell <bob@rattlesnake.com>).

2005-07-11  Juanma Barranquero  <lekktu@gmail.com>

	* custom.el (custom-enable-theme): Don't add theme to
	`custom-enabled-themes' with `push' because there is no
	setf-method for `delq'.

2005-07-11  Richard M. Stallman  <rms@gnu.org>

	* custom.el (custom-declare-variable): Doc fix.

	* dired-aux.el (dired-compare-directories): Remove "." and ".."
	from the alists.

	* emacs-lisp/edebug.el (edebug-slow-after, edebug-slow-before):
	Do nothing if edebug-active.

	* emacs-lisp/edebug.el (edebug-enter): Don't with-timeout-suspend here.
	(edebug-display): Do it here instead.

2005-07-10  Richard M. Stallman  <rms@gnu.org>

	* cus-face.el (custom-theme-set-faces): Make it work.
	(custom-reset-faces): Doc fix.
	(custom-theme-reset-internal-face, custom-theme-face-value):
	Functions deleted.

	* custom.el (custom-push-theme): Maintain list of the settings
	of a given theme in its theme-settings property.
	Maintain position of old settings in the theme-value
	or theme-face property.
	(custom-enabled-themes): New variable.
	(custom-theme-enabled-p): New function.
	(provide-theme): Update custom-enabled-themes.
	Disable and reenable the `user' theme.
	(require-theme): Doc fix.
	(custom-do-theme-reset, custom-remove-theme): Functions deleted.
	(custom-theme-value, custom-theme-variable-value): Likewise.
	(custom-theme-reset-internal): Likewise.
	(custom-theme-load-themes): Fix bugs and use custom-disable-theme.
	(custom-enable-theme, custom-disable-theme): New functions.
	(custom-variable-theme-value, custom-face-theme-value): Likewise.
	(custom-theme-recalc-variable, custom-theme-recalc-face): Likewise.
	(custom-theme-reset-variables): Simplify.
	(deftheme, custom-declare-theme, custom-make-theme-feature):
	Definitions moved.

2005-07-10  Chong Yidong  <cyd@stupidchicken.com>

	* longlines.el (longlines-show-region)
	(longlines-unshow-hard-newlines): Recognize hard newlines by
	non-nil hard property, instead of t.

2005-07-10  Michael Kifer  <kifer@cs.stonybrook.edu>

	* viper-cmd.el (viper--key-maps): New variable.
	(viper-normalize-minor-mode-map-alist): Use viper--key-maps and
	emulation-mode-map-alists.
	(viper-envelop-ESC-key): Use viper-subseq.
	(viper-search-forward/backward/next): Disable debug-on-error.

	* viper-keym.el (viper-toggle-key, viper-quoted-insert-key)
	(viper-ESC-key): New defcustoms.

	* viper-macs.el (ex-map-read-args): Use viper-subseq.

	* viper-util.el (viper-key-to-emacs-key): Use viper-subseq.
	(viper-subseq): Copy of subseq from cl.el.

	* viper.el (viper-go-away, viper-set-hooks): Use
	emulation-mode-map-alists, advise self-insert-command, add-minor-mode.

	* viper-mous.el (viper-current-frame-saved): Use defvar.

	* viper-init.el: Get rid of -face in face names.

	* ediff-diff.el (ediff-extract-diffs, ediff-extract-diffs3):
	Make it work with longlines mode

	* ediff-mult.el (ediff-meta-mode-hook): New variable.

	* ediff-ptch.el (ediff-file-name-sans-prefix): Quote regexp.

	* ediff-init: Get rid of -face in face names.

2005-07-10  Richard M. Stallman  <rms@gnu.org>

	* emacs-lisp/edebug.el (edebug-enter): Call with-timeout-suspend
	and with-timeout-unsuspend.

	* emacs-lisp/debug.el (debug): Call with-timeout-suspend
	and with-timeout-unsuspend.

	* emacs-lisp/timer.el (with-timeout-timers): New variable.
	(with-timeout): Bind that variable to record timers.
	(with-timeout-suspend, with-timeout-unsuspend): New functions.

	* emacs-lisp/debug.el (debug-help-follow): New function.
	(debugger-mode-map): Use that instead of help-follow.
	(debugger-setup-buffer): Use eval-buffer-list
	to handle eval-buffer frames.

2005-07-10  N. Raghavendra  <raghu@mri.ernet.in>  (tiny change)

	* timezone.el (timezone-parse-date): Change first regexp
	so it will not mistakenly match dates with no time zone.

2005-07-10  Jeff Dwork  <jeff.dwork@amd.com>  (tiny change)

	* facemenu.el (facemenu-read-color): Do case-insensitive matching.

2005-07-10  Luc Teirlinck  <teirllm@auburn.edu>

	* custom.el (custom-initialize-safe-set)
	(custom-initialize-safe-default): New functions.

	* frame.el (blink-cursor-mode): Use `custom-initialize-safe-default'
	and simplify :init-value.

	* tooltip.el (tooltip-mode): Use `custom-initialize-safe-default'
	and simplify :init-value.  Delete obsolete comment.

	* startup.el (command-line): Use `custom-reevaluate-setting' to
	handle `tooltip-mode'.  Delete obsolete comment.

	* files.el (set-visited-file-name): Avoid calling
	`file-name-nondirectory' with a nil argument.

2005-07-09  Richard M. Stallman  <rms@gnu.org>

	* emacs-lisp/debug.el (debugger-setup-buffer): When eval-buffer
	was called with nil for the buffer, handle the read position right.
	Handle read position for eval-region, too.

2005-07-09  Juri Linkov  <juri@jurta.org>

	* fringe.el (fringe-mode): Add period in docstring.
	(fringe-query-style): Build prompt depending on `all-frames' arg.

	* dired.el (dired-marker-char): Avoid quotations for `do' and `mark'
	to not create links to unrelated functions in the Help buffer.

	* progmodes/compile.el (compilation-mode-hook, compilation-mode):
	Doc fix.

	* simple.el (next-error-hook): New variable.
	(next-error): Use it.  Doc fix.

	* textmodes/ispell.el (ispell-command-loop): Add current
	dictionary name and program name to mode-line-format.
	(ispell-region, ispell-process-line): Add current dictionary name
	and program name to messages.

2005-07-08  Jay Belanger  <belanger@truman.edu>

	* calc/calc.el (calc-embedded-announce-formula-alist)
	(calc-embedded-open-close-formula-alist)
	(calc-embedded-open-close-word-alist)
	(calc-embedded-open-close-plain-alist)
	(calc-embedded-open-close-new-formula-alist)
	(calc-embedded-open-close-mode-alist)
	(calc-embedded-new-buffer-hook, calc-embedded-new-formula-hook)
	(calc-embedded-mode-hook): New variables.

	* calc/calc-embed.el (calc-embedded-firsttime)
	(calc-embedded-firsttime-buf, calc-embedded-firsttime-formula):
	New variables.
	(calc-do-embedded): Use calc-embedded-firsttime,
	calc-embedded-firsttime-buf and calc-embedded-firsttime-formula to
	determine whether or not to run hooks.
	(calc-embedded-make-info) Set calc-embedded-firsttime-buf and
	calc-embedded-firsttime-formula appropriately.
	Set calc-embedded delimiter variables according to mode.

2005-07-08  Richard M. Stallman  <rms@gnu.org>

	* emacs-lisp/checkdoc.el (checkdoc-proper-noun-list):
	Check for "emacs", etc., as entire symbol, not just as word.
	(checkdoc-file-comments-engine): Use regexp-quote on FN.

	* files.el (set-visited-file-name): Report the error
	for "empty filename" earlier.
	(kill-some-buffers): Ignore buffers already dead.

	* fringe.el (fringe-mode): Doc fix.

	* emacs-lisp/bytecomp.el (byte-compile-maybe-guarded):
	Check for (featurep 'xemacs) and turn off warnings in what it guards.
	Use unwind-protect to ensure byte-compile-unresolved-functions
	is updated.

	* whitespace.el (whitespace-buffer-leading-cleanup):
	Simplify w/ skip-chars-forward.
	(whitespace-buffer-trailing-cleanup): Simplify w/ skip-chars-backward.

	* mail/rmail.el (rmail-only-expunge): Fix paren error.
	Unconditionally try to leave point at the same old place.

2005-07-08  Ralf Angeli  <angeli@iwi.uni-sb.de>  (tiny change)

	* comint.el (comint-postoutput-scroll-to-bottom)
	(comint-show-maximum-output): Take scroll-margin into consideration.

2005-07-08  Kim F. Storm  <storm@cua.dk>

	* ido.el (ido-use-filename-at-point): New choice `guess'.
	(ido-file-internal): Try ffap-guesser if selected.

	* ido.el (ido-before-fallback-functions): New hook.
	(ido-buffer-internal, ido-file-internal, ido-read-buffer)
	(ido-read-file-name): Run it.

2005-07-07  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/hideif.el (hide-ifdef-use-define-alist): Pass a list of
	strings rather than a list of symbols to the completion function.

2005-07-07  Jay Belanger  <belanger@truman.edu>

	* calc/calc-units.el (math-apply-units): Change the places in
	which units are simplified.

2005-07-07  Luc Teirlinck  <teirllm@auburn.edu>

	* cus-edit.el (customize-option, customize-option-other-window):
	Make them handle aliases.

	* custom.el (custom-variable-p): Make it recursively follow
	aliases.  Mention that in the docstring.

2005-07-07  Richard M. Stallman  <rms@gnu.org>

	* cus-start.el (exec-path): Use `directory' instead of `file'.
	Fix tag for nil.

2005-07-07  Juanma Barranquero  <lekktu@gmail.com>

	* replace.el (occur-rename-buffer): Use `generate-new-buffer' also
	when called non-interactively.  Doc fix.

2005-07-07  Lute Kamstra  <lute@gnu.org>

	* elide-head.el (elide-head-headers-to-hide): Recognize the FSF's
	new address as well.

2005-07-07  Kenichi Handa  <handa@m17n.org>

	* international/mule.el (make-coding-system):
	Describe `ascii-incompatible' property in the docstring.
	(set-file-name-coding-system): Signal an error if coding-system is
	ascii-incompatible.
	(set-keyboard-coding-system): Likewise.

	* international/mule-cmds.el (set-default-coding-systems):
	Don't set default-file-name-coding-system and
	default-keyboard-coding-system if coding-system is ASCII-incompatible.

	* international/utf-16.el: Declare that all UTF-16-based coding
	systems are ASCII-incompatible.

2005-07-07  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gud.el: Require font-lock for displaying errors.
	Used by gdb-ui.el.

2005-07-07  Juanma Barranquero  <lekktu@gmail.com>

	* hi-lock.el (hi-lock-find-patterns): Protect also against invalid
	values for the pattern lists which are `read'able but not
	`append'able (like symbols).

2005-07-06  Richard M. Stallman  <rms@gnu.org>

	* progmodes/flymake.el (flymake-float-time): Instead of
	with-no-warnings, test for xemacs.
	(flymake-replace-regexp-in-string): Test fboundp of replace-in-string
	to avoid warning.

2005-07-06  Juanma Barranquero  <lekktu@gmail.com>

	* w32-vars.el (w32-fixed-font-alist): Fix typo in `defcustom' tag.

2005-07-05  Lute Kamstra  <lute@gnu.org>

	* battery.el: Add support for Darwin (with much debugging help
	from Samuel Lauber <sam124@operamail.com>).
	(battery-status-function, battery-echo-area-format)
	(battery-mode-line-format): Add support for pmset on Darwin.
	(battery-load-low, battery-load-critical): New user options.
	(battery-pmset): New function.

2005-07-05  Lute Kamstra  <lute@gnu.org>

	Update FSF's address in GPL notices.

	* textmodes/page-ext.el: Update FSF's address.

2005-07-04  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/lisp-mode.el (lisp-mode-variables): Prevent adaptive
	filling from using prefix when filling a single-line docstring.

	* progmodes/flymake.el: Remove useless eval-when-compile.

	* arc-mode.el (archive-lzh-ogm): Reorder save excursion/restriction.

2005-07-04  Richard M. Stallman  <rms@gnu.org>

	* textmodes/org.el (org-file-apps-defaults-gnu):
	Rename from org-file-apps-defaults-linux.
	(org-default-apps): Don't test system-type for `linux'.
	(org-file-apps): Doc fix.

2005-07-04  David Ponce  <david@dponce.com>

	* tree-widget.el: Improve header Commentary section.
	(tree-widget) [defgroup]
	(tree-widget-image-enable, tree-widget-themes-directory)
	(tree-widget-theme, tree-widget-image-properties-emacs)
	(tree-widget-image-properties-xemacs, tree-widget-create-image)
	(tree-widget-image-formats, tree-widget-control)
	(tree-widget-empty-control, tree-widget-leaf-control
	(tree-widget-guide, tree-widget-end-guide, tree-widget-no-guide)
	(tree-widget-handle, tree-widget-no-handle, tree-widget-p)
	(tree-widget-keep, tree-widget-after-toggle-functions)
	(tree-widget-open-node, tree-widget-close-node): Doc fix.
	(tree-widget-open-control, tree-widget-close-control): Fix doc and
	:help-echo message.
	(tree-widget-set-theme): Doc fix.  Use `string-equal'.
	(tree-widget-image-properties): Doc fix.  Clearer implementation.
	(tree-widget--cursors): New constant.
	(tree-widget-lookup-image): New function split from
	`tree-widget-find-image'.  Clearer implementation.
	(tree-widget-find-image): Use it.
	(tree-widget-button-keymap): Use `set-keymap-parent'.
	(tree-widget) [define-widget]: Use `widget-children-value-delete'.
	Define the sub-widgets here.
	(tree-widget-node): Check that :node is not a tree-widget.
	(tree-widget-get-super, tree-widget-open-control)
	(tree-widget-close-control, tree-widget-empty-control)
	(tree-widget-leaf-control, tree-widget-guide)
	(tree-widget-end-guide, tree-widget-no-guide, tree-widget-handle)
	(tree-widget-no-handle, tree-widget-value-delete)
	(tree-widget-map): Remove.
	(tree-widget-children-value-save): Doc fix.  Simplified.
	(tree-widget-value-create): Update according to previous changes.

2005-07-04  Carsten Dominik  <dominik@science.uva.nl>

	* textmodes/org.el: Leading space replaced by TABS.
	(org-recalc-marks, org-table-rotate-recalc-marks)
	(org-table-get-specials): Treat "^" and "_" marks.
	(org-table-justify-field-maybe): Optional argument NEW.
	(org-table-eval-formula): Parsing of the format simplified.
	New modes C,I.  Honor the %= parameter in the current table.
	Avoid unnecessary re-align by using the NEW argument to
	`org-table-justify-field-maybe'.
	(org-calc-default-modes): Default for date-format mimicks org-mode.
	(org-agenda, org-timeline): Quote argument in org-agenda-redo-command.

2005-07-03  Luc Teirlinck  <teirllm@auburn.edu>

	* cus-face.el (custom-theme-set-faces): Make it handle face
	aliases whose alias declarations are pre- or autoloaded.

2005-07-04  Juri Linkov  <juri@jurta.org>

	* faces.el (read-face-name): Put the code for getting a face name
	from the buffer before adding the faces from the `face' property.
	Use `completing-read-multiple' instead of `completing-read'.
	Require `crm'.  Add default value and post-process the returned
	list of faces.

	* emacs-lisp/crm.el (crm-find-current-element)
	(crm-minibuffer-complete-and-exit): Handle minibuffer prompt.

	* emacs-lisp/lisp-mode.el (eval-defun-1):
	* emacs-lisp/edebug.el (edebug-eval-defun):
	Remove unnecessary quotes.

2005-07-04  Juanma Barranquero  <lekktu@gmail.com>

	* progmodes/prolog.el (prolog-eof-string): Doc fixes.
	(prolog-indent-level): Fix typo in docstring.

	* info.el (Info-history, Info-history-forward)
	(Info-history-list, Info-speedbar-fetch-file-nodes): Doc fixes.

	* add-log.el (add-change-log-entry):
	* comint.el (comint-dynamic-list-input-ring)
	(comint-dynamic-list-completions):
	* dabbrev.el (dabbrev-expand):
	* delim-col.el (delimit-columns-rectangle-line):
	* diff-mode.el (diff-context->unified, diff-reverse-direction)
	(diff-unified->context):
	* ediff-init.el (ediff-abbrev-jobname):
	* ediff-mult.el (ediff-replace-session-status-in-meta-buffer)
	(ediff-replace-session-activity-marker-in-meta-buffer):
	* info.el (Info-summary):
	* lpr.el (printify-region):
	* printing.el (pr-create-interface):
	* ps-print.el (ps-print-quote):
	* ses.el (ses-column-widths, ses-print-cell)
	(ses-adjust-print-width, ses-center):
	* shell.el (shell-file-name-quote-list):
	* strokes.el (strokes-read-stroke, strokes-read-complex-stroke)
	(strokes-fill-current-buffer-with-whitespace)
	(strokes-xpm-for-stroke, strokes-list-strokes)
	(strokes-xpm-char-bit-p, strokes-xpm-for-compressed-string):
	* term.el (term-dynamic-list-input-ring)
	(term-dynamic-list-completions):
	* calc/calc.el (math-format-stack-value):
	* emacs-lisp/edebug.el (edebug-display-freq-count):
	* progmodes/delphi.el (delphi-indent-line, delphi-fill-comment)
	(delphi-new-comment-line):
	* progmodes/ebnf2ps.el (ebnf-eps-filename, ebnf-trim-right):
	* progmodes/executable.el (executable-set-magic):
	* progmodes/python.el (inferior-python-mode):
	* progmodes/scheme.el (scheme-mode-syntax-table):
	* progmodes/sh-script.el (sh-maybe-here-document):
	* progmodes/sql.el (sql-copy-column):
	* progmodes/tcl.el (tcl-comment-indent, tcl-quote):
	* textmodes/bibtex.el (bibtex-mode):
	* textmodes/sgml-mode.el (html-imenu-index, sgml-attributes)
	(sgml-auto-attributes):
	* textmodes/table.el (table-insert, table-shorten-cell)
	(table--generate-source-scan-lines, table-delete-row)
	(*table--cell-delete-char, table--spacify-frame)
	(table--horizontally-shift-above-and-below)
	(table--cell-insert-char, table--cell-blank-str)
	(table--fill-region-strictly):
	* textmodes/tex-mode.el (tex-insert-quote, latex-find-indent):
	* textmodes/texinfo.el (texinfo-insert-quote): "?\ " -> "?\s".

	* add-log.el (change-log):
	* apropos.el (apropos):
	* comint.el (comint-completion, comint-source):
	* dabbrev.el (dabbrev):
	* delim-col.el (columns):
	* diff-mode.el (diff-mode):
	* ediff.el (ediff):
	* ediff-diff.el (ediff-diff):
	* ediff-init.el (ediff-highlighting, ediff-merge, ediff-hook):
	* ediff-mult.el (ediff-mult):
	* ediff-ptch.el (ediff-ptch):
	* ediff-wind.el (ediff-window):
	* facemenu.el (facemenu):
	* indent.el (indent):
	* info.el (info):
	* jka-cmpr-hook.el (compression, jka-compr):
	* lpr.el (lpr):
	* outline.el (outlines):
	* pcmpl-cvs.el (pcmpl-cvs):
	* pcmpl-rpm.el (pcmpl-rpm):
	* printing.el (printing):
	* ps-print.el (postscript, ps-print, ps-print-horizontal)
	(ps-print-vertical, ps-print-headers, ps-print-font)
	(ps-print-color, ps-print-face, ps-print-n-up, ps-print-zebra)
	(ps-print-background, ps-print-printer, ps-print-page)
	(ps-print-miscellany):
	* ses.el (ses):
	* shell.el (shell, shell-directories, shell-faces):
	* startup.el (initialization):
	* strokes.el (strokes):
	* term.el (term):
	* uniquify.el (uniquify):
	* w32-vars.el (w32):
	* calc/calc.el (calc):
	* emacs-lisp/bytecomp.el (bytecomp):
	* emacs-lisp/cl-indent.el (lisp-indent):
	* emacs-lisp/edebug.el (edebug):
	* emacs-lisp/elp.el (elp):
	* emacs-lisp/testcover.el (testcover):
	* emacs-lisp/trace.el (trace):
	* emulation/viper-ex.el (viper-ex):
	* emulation/viper-mous.el (viper-mouse):
	* mail/mailalias.el (mailalias):
	* mail/supercite.el (supercite, supercite-frames)
	(supercite-attr, supercite-cite, supercite-hooks):
	* net/rcompile.el (remote-compile):
	* net/rlogin.el (rlogin):
	* obsolete/ooutline.el (outlines):
	* progmodes/delphi.el (delphi):
	* progmodes/ebnf2ps.el (postscript, ebnf2ps, ebnf-special)
	(ebnf-except, ebnf-repeat, ebnf-terminal, ebnf-non-terminal)
	(ebnf-production, ebnf-shape, ebnf-displacement, ebnf-syntactic)
	(ebnf-optimization):
	* progmodes/etags.el (etags):
	* progmodes/executable.el (executable):
	* progmodes/idlwave.el (idlwave):
	* progmodes/pascal.el (pascal):
	* progmodes/prolog.el (prolog):
	* progmodes/python.el (python):
	* progmodes/scheme.el (scheme):
	* progmodes/sh-script.el (sh, sh-script):
	* progmodes/sql.el (SQL):
	* progmodes/tcl.el (tcl):
	* textmodes/bibtex.el (bibtex, bibtex-autokey):
	* textmodes/enriched.el (enriched):
	* textmodes/makeinfo.el (makeinfo):
	* textmodes/sgml-mode.el (sgml):
	* textmodes/table.el (table-hooks):
	* textmodes/tex-mode.el (tex-file, tex-run, tex-view):
	* textmodes/texinfo.el (texinfo):
	* textmodes/two-column.el (two-column):
	Finish `defgroup' description with period.

	* emacs-lisp/cl-indent.el (lisp-indent-maximum-backtracking):
	* eshell/esh-var.el (eshell-var):
	* progmodes/vhdl-mode.el (vhdl-testbench):
	* textmodes/org.el (org): Fix typos in docstrings.

	* emacs-lisp/timer.el (with-timeout): Improve argument/docstring
	consistency.

	* progmodes/flymake.el (flymake-find-file): Remove.
	(flymake-float-time): Use `with-no-warnings'.
	(flymake-check-start-time, flymake-check-was-interrupted)
	(flymake-err-info, flymake-is-running, flymake-last-change-time)
	(flymake-new-err-info): `defvar' at compile time.

2005-07-03  Juanma Barranquero  <lekktu@gmail.com>

	* replace.el (occur-hook): Doc fix.
	(occur-1): Don't call `occur-hook' if there are no matches.

2005-07-03  Richard M. Stallman  <rms@gnu.org>

	* emulation/tpu-edt.el (tpu-original-global-map): Don't copy
	global-map, save the same map.
	(global-map): Don't alter it at top level.
	(tpu-edt-on): Save global map in tpu-original-global-map, then copy.
	Then alter it here instead.
	(tpu-edt-off): Set global-map to the saved one.

	* emulation/tpu-edt.el (tpu-emacs19-p): Var deleted.
	All references simplified.
	(tpu-lucid-emacs-p): Rename from tpu-lucid-emacs19-p.  Uses changed.
	(zmacs-regions): Add defvar.
	(repeat-complex-command-map): Everything about that deleted.

	* textmodes/artist.el (artist-key-is-drawing)
	(artist-key-endpoint1, artist-key-poly-point-list)
	(artist-key-shape, artist-key-draw-how, artist-popup-menu-table)
	(artist-key-compl-table, artist-rb-save-data)
	(artist-arrow-point-1, artist-arrow-point-2): Move defvars up.
	Don't put them in eval-when-compile.
	(artist-set-arrow-points-for-poly): Use `last', not `artist-last'.

	* progmodes/ebrowse.el (ebrowse-revert-tree-buffer-from-file):
	Use with-no-warnings.

	* net/browse-url.el (dos-windows-version): Add defvar.

	* mail/supercite.el (filladapt-prefix-table): Add defvar.

	* mail/rmailsum.el (rmail-summary-redo): Add defvar.
	(rmail-summary-mode-map, rmail-summary-overlay): Defvars moved up.
	(rmail-new-summary-line-count): Rename from new-summary-line-count.
	Add defvar.
	(rmail-summary-beginning-of-message): Use with-no-warnings.
	(rmail-summary-first-message, rmail-summary-last-message): Likewise.

	* emulation/vip.el (vip-replace-string, ex-map, ex-read):
	Use with-no-warnings.

	* emulation/vi.el (vi-mark-region): Use c-mark-function.
	(c-mark-function): Add point-moving-unit property.
	(vi-goto-line): Use with-no-warnings.

	* emulation/edt.el (edt-last-copied-word): Add defvar.
	(zmacs-region-stays): Likewise.
	(edt-mark-section-wisely): Use c-mark-function for C.
	Use makr-defun for Fortran.
	(time-string): defvar deleted.
	(edt-display-the-time): Don't set time-string.

	* emacs-lisp/macroexp.el (macroexp-accumulate): Rename arg to var+list.

	* emacs-lisp/bytecomp.el (byte-compile-nogroup-warn):
	Don't warn when name is not constant
	or for defining the group `emacs'.

	* tooltip.el (gud-tooltip-mode): Add defvar.

	* startup.el (default-frame-background-mode): Add defvar.

	* smerge-mode.el (smerge-mode): Add duplicate defvar near top.

	* info.el (tool-bar-map): Add defvar.

	* dired.el (dnd-protocol-alist): Add defvar.

	* dired-aux.el (dired-query): Display question with answer, when
	the user answers.

	* custom.el (custom-add-option): Doc fix.

	* bookmark.el (Info-current-node, Info-suffix-list): Add defvars.

2005-07-03  Eli Zaretskii  <eliz@gnu.org>

	* font-lock.el (font-lock-regexp-grouping-construct): Fix the
	bogus name from the last change.

2005-07-02  Luc Teirlinck  <teirllm@auburn.edu>

	* custom.el (custom-declare-variable): Fix typos in comment.
	(custom-known-themes): Doc fix.
	(custom-theme-directory): New defcustom.
	(require-theme): Make it check `custom-theme-directory'.

	* cus-theme.el (custom-new-theme-mode): New function.
	(custom-theme-name, custom-theme-variables, custom-theme-faces)
	(custom-theme-description): Add compiler defvars.
	(customize-create-theme): Add doc to the "*New Custom Theme*"
	buffer.  Use `custom-new-theme-mode'.
	(custom-theme-write): Put the created buffer in emacs-lisp-mode
	and save it to the `custom-theme-directory'.  Make this the
	default directory of the buffer.

2005-07-02  David Hunter  <hunterd_42@comcast.net>  (tiny change)

	* progmodes/flymake.el (flymake-mode, flymake-mode-off):
	Fix unbalanced parentheses.

2005-07-02  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/flymake.el (flymake-mode-on, flymake-mode-off): Move body
	into flymake-mode and delegate to flymake-mode.

	* find-file.el (ff-which-function-are-we-in): Clean up.

2005-07-02  Juanma Barranquero  <lekktu@gmail.com>

	* replace.el (occur-rename-buffer): Fix docstring.

	* emulation/edt.el (*EDT-keys*, edt-default-global-map)
	(edt-last-copied-word, edt-learn-macro-count)
	(edt-orig-page-delimiter, edt-orig-transient-mark-mode)
	(edt-rect-start-point, edt-user-global-map, rect-start-point)
	(time-string, zmacs-region-stays):
	* emulation/edt-mapper.el (edt-save-function-key-map)
	(EDT-key-name): `defvar' to silence the byte-compiler.

2005-07-02  Martin Rudalics  <rudalics@gmx.at>  (tiny change)

	* font-lock.el (font-lock-regexp-grouping-backslash): Rename from
	font-lock-regexp-backslash.  Doc fix.
	(font-lock-regexp-backslash-grouping-construct): Rename from
	font-lock-regexp-backslash-construct.  Doc fix.
	(lisp-font-lock-keywords-2): Fix highlighting of Elisp regexp
	grouping constructs.

2005-07-02  Eli Zaretskii  <eliz@gnu.org>

	* makefile.w32-in (bootstrap): Remove the $(EMACS) binary after
	updating all the prerequisites.

2005-07-01  Juanma Barranquero  <lekktu@gmail.com>

	* textmodes/org.el (org-agenda-start-on-weekday)
	(org-calendar-to-agenda-key, org-agenda-sorting-strategy)
	(org-agenda-use-time-grid, org-archive-location)
	(org-allow-space-in-links, org-usenet-links-prefer-google)
	(org-enable-table-editor, org-export-default-language)
	(org-export-html-show-new-buffer, org-fill-paragraph)
	(org-cycle, org-goto-ret, org-goto-left, org-goto-right)
	(org-goto-quit, org-occur, org-eval-in-calendar)
	(org-agenda-cleanup-fancy-diary, org-agenda-no-heading-message)
	(org-agenda-diary-entry, org-remember-help)
	(org-table-convert-region, org-at-table-p)
	(org-table-move-row-down, org-table-move-row-up)
	(org-table-copy-region, org-table-toggle-vline-visibility)
	(org-table-get-stored-formulas, org-table-get-specials)
	(org-recalc-commands, org-table-eval-formula)
	(org-table-formula-substitute-names, orgtbl-make-binding)
	(org-format-org-table-html, org-format-table-table-html)
	(org-format-table-table-html-using-table-generate-source)
	(org-customize): Fix typos in docstrings.
	(org-level-2, org-at-timestamp-p, org-agenda-day-view)
	(org-agenda-toggle-diary, org-agenda-toggle-time-grid)
	(org-back-to-heading): Doc fixes.
	(org-agenda-toggle-time-grid, org-cmp-category, org-cmp-time)
	(org-agenda-change-all-lines, org-get-header):
	Improve argument/docstring consistency.
	(orgtbl-error): Fix error message.

	* progmodes/flymake.el (flymake-find-possible-master-files)
	(flymake-master-file-compare, flymake-get-line-err-count)
	(flymake-highlight-line, flymake-gui-warnings-enabled):
	Fix typos in docstrings.
	(flymake-parse-line, flymake-get-project-include-dirs-function)
	(flymake-get-prev-err-line-no, flymake-goto-prev-error):
	Doc fixes.
	(flymake-get-project-include-dirs-function)
	(flymake-make-err-menu-data):
	Improve argument/docstring consistency.

2005-07-01  Lute Kamstra  <lute@gnu.org>

	* battery.el (battery-linux-proc-apm): Fix typo in docstring.
	Catch errors with ignore-errors.  Use temporary buffer.
	(battery-linux-proc-acpi): Fix typo in docstring.  Document `%r'.

	* facemenu.el (facemenu-unlisted-faces): Delete foreground and
	background color faces.
	(facemenu-set-foreground, facemenu-set-background):
	Use facemenu-set-face-from-menu.
	(facemenu-set-face-from-menu): Treat face names that start with
	"fg:" or "bg:" as special.
	(facemenu-add-new-color): Don't create faces.  Simplify.

2005-06-30  Richard M. Stallman  <rms@gnu.org>

	* emacs-lisp/crm.el (crm-do-completion): Handle minibuffer prompt.
	(crm-find-current-element): Likewise.

2005-06-30  Johan Bockg,Ae(Brd  <bojohan@users.sourceforge.net>

	* help-fns.el (help-do-arg-highlight): Regexp-quote argument names.

2005-06-30  Stefan Monnier  <monnier@iro.umontreal.ca>

	* arc-mode.el (archive-extract): Make it work as a mouse binding.
	(archive-mouse-extract): Make it an obsolete alias.
	(archive-mode-map): Don't use archive-mouse-extract any more.
	(archive-mode, archive-extract): write-contents-hooks ->
	write-contents-functions.
	(archive-arc-rename-entry, archive-lzh-rename-entry): Remove unused
	first arg.
	(archive-rename-entry): Update the call.
	(archive-zip-summarize): Remove unused var `method'.
	(archive-lzh-summarize): Remove unused var `creator'.

	* emacs-lisp/debug.el (debug): Quieten Drew Adams by killing the
	dedicated frame upon exit.

	* arc-mode.el: Bind inhibit-read-only rather than buffer-read-only.
	(archive-zip-extract, archive-zip-expunge)
	(archive-zip-update, archive-zip-update-case): Use executable-find.
	(archive-resummarize, archive-flag-deleted, archive-unmark-all-files):
	Use restore-buffer-modified-p.
	(archive-extract, archive-add-new-member, archive-write-file-member):
	Use with-current-buffer.
	(archive-lzh-ogm, archive-zip-chmod-entry): Use dolist.

2005-06-30  Andreas Schwab  <schwab@suse.de>

	* progmodes/gud.el (gud-filter): Remove unneeded progn.

2005-06-30  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* progmodes/sh-script.el (sh-get-kw): `&' also separates words.

2005-06-30  Juri Linkov  <juri@jurta.org>

	* faces.el (vertical-border): Inherit from mode-line-inactive
	only on tty.

2005-06-30  Juanma Barranquero  <lekktu@gmail.com>

	* help-fns.el (help-do-arg-highlight): Highlight also -ARG (for
	example, -NLINES in the `occur' docstring).

	* replace.el (occur-1): When no matches are found, do not set the
	`buffer-read-only' and modified flags for the occur buffer,
	because it is deleted.

	* emulation/cua-base.el (cua-check-pending-input)
	(cua-repeat-replace-region, cua-mode, cua-debug)
	(cua-auto-tabify-rectangles, cua-inhibit-cua-keys):
	Fix typos in docstrings.

	* emulation/cua-gmrk.el (cua-toggle-global-mark)
	(cua-cut-region-to-global-mark)
	(cua--cut-rectangle-to-global-mark):
	Remove period from end of messages.

	* emulation/cua-rect.el (cua-do-rectangle-padding):
	Remove period from end of messages.
	(cua--rectangle-seq-format): Fix typo in docstring.
	(cua-sequence-rectangle, cua-fill-char-rectangle):
	Improve argument/docstring consistency.

2005-06-29  Juri Linkov  <juri@jurta.org>

	* faces.el (default-frame-background-mode): New internal variable.
	(frame-set-background-mode): Use it.

	* startup.el (normal-top-level): Set default-frame-background-mode
	instead of frame-background-mode.  Before setting it, test for its
	nil value.  Remove tests for frame-background-mode and frame
	parameter `reverse'.  Add test for "unspecified-fg".

	* term/xterm.el (xterm-rxvt-set-background-mode):
	* term/rxvt.el (rxvt-set-background-mode):
	Set default-frame-background-mode instead of frame-background-mode.

2005-06-29  Juanma Barranquero  <lekktu@gmail.com>

	* simple.el (set-variable): Warn about obsolete user variables.

	* imenu.el (imenu--completion-buffer):
	* mouse.el (mouse-buffer-menu-alist):
	* msb.el (msb-invisible-buffer-p):
	* calendar/diary-lib.el (diary-header-line-format):
	* emacs-lisp/pp.el (pp-buffer):
	* progmodes/cperl-mode.el (cperl-do-auto-fill):
	* textmodes/picture.el (picture-replace-match):
	Change space constants followed by a sexp to "?\s ".

	* play/decipher.el (decipher-loop-with-breaks):
	* textmodes/texinfo.el (texinfo-insert-@item): Change space
	constants "protected" from end of line by a comment to "?\s".

2005-06-29  Stefan Monnier  <monnier@iro.umontreal.ca>

	* font-lock.el (save-buffer-state): Use `declare'.

	* progmodes/cperl-mode.el (cperl-find-pods-heres): Don't gratuitously
	reset the syntax-table to cperl-mode-syntax-table.
	(cperl-mode): Make _ into word-syntax during font-locking so "print" in
	"foo_print_bar" is not matched as a reserved keyword.

2005-06-29  Carsten Dominik  <dominik@science.uva.nl>

	* textmodes/org.el (orgtbl-setup): New function, for delayed
	setup for the orgtbl commands.
	(org-calc-default-modes): New option.
	(orgtbl-make-binding): Use `defun' to get better help display.
	(org-diary): Call `org-compile-prefix-format'.
	(org-table-formula-substitute-names): New function.
	(org-agenda-day-view, org-agenda-week-view): New commands.
	(org-agenda-toggle-week-view): Command removed.
	(org-tbl-menu): Split off from org-org-menu.
	(org-mode): Move removal of outline-mode menus to here.
	(org-table-formula-debug): New option.
	(org-table-insert-row): Keep first field if just "#" or "*".
	(org-mode): Paragraph regexps fixed.
	(org-table-recalculate-regexp): New constant.
	(org-table-justify-field-maybe): Avoid replace if not necessary.
	(org-copy-special, org-cut-special): Use `call-interactively'.
	(org-table-copy-region): Take region from `interactive' call.
	(org-trim): Return string even if no match.
	(org-formula): New face.
	(org-set-font-lock-defaults): No longer highlight "FIXME".
	But highlight formula-related fields in table.
	(org-table-p): Use regexp, not fontification.
	(org-table-align): Handle white space at end of line.
	(org-table-formula-evaluate-inline): New option.
	(org-mode): Auto-wrapping in comment lines turned off.
	(org-table-copy-down): Evaluate only in copied field, not in
	destination.
	(org-table-current-formula): Variable removed.
	(org-table-store-formulas, org-table-get-stored-formulas)
	(org-table-modify-formulas, org-table-replace-in-formulas)
	(org-table-maybe-eval-formula): New functions.
	(org-table-get-formula): Modify to use stored formulas.
	(org-table-insert-column, org-table-delete-column)
	(org-table-move-column): Call `org-table-modify-formulas'.
	(org-complete): Add completion for keyword formulas.
	(orgtbl-mode): Pull orgtbl-mode-map to start of
	minor-mode-map-alist.

2005-06-29  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/python.el (python-check): Require `compile' before
	modifying its variables.

	* newcomment.el (comment-indent-default): Don't get fooled by an early
	end of buffer.

2005-06-28  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-print.el (ps-print-version): Fix version number.

2005-06-28  Luc Teirlinck  <teirllm@auburn.edu>

	* textmodes/ispell.el (ispell-word): Remove stray parenthesis.

2005-06-28  Richard M. Stallman  <rms@gnu.org>

	* textmodes/flyspell.el (flyspell-use-local-map): Variable deleted.
	(flyspell-local-mouse-map): Declaration deleted.
	(flyspell-mouse-map): Bind only mouse-2.
	(flyspell-mode-map): Don't test flyspell-use-local-map.
	(flyspell-overlay-keymap-property-name): Var deleted.
	(flyspell-mode-on): Don't make local bindings for
	flyspell-mouse-map and flyspell-mode-map.
	(make-flyspell-overlay): Unconditionally put on `keymap' text prop.

	* textmodes/ispell.el (ispell-word): Do not ignore short words.

	* progmodes/compile.el (compilation-next-error-function):
	Don't switch buffers; operate on the current buffer.

	* facemenu.el (facemenu-add-face): Warn when font-lock is active.

	* comint.el (comint-password-prompt-regexp): Accept ", try again".

	* bindings.el (global-map): Bind insertchar and its variants.

2005-06-27  Richard M. Stallman  <rms@gnu.org>

	* textmodes/artist.el (artist-text-overwrite)
	(artist-figlet-get-extra-args, artist-text-see-thru): Use read-string.

2005-06-27  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-print.el: It was not working the page selection for printing.
	Reported by Sebastian Tennant <sebyte@smolny.plus.com>.
	(ps-print-version): New version 6.6.7.
	(ps-end-sheet): New fun.
	(ps-header-sheet, ps-end-job): Call it.

2005-06-27  Luc Teirlinck  <teirllm@auburn.edu>

	* subr.el (add-to-list, add-to-ordered-list): Doc fixes.

2005-06-27  Lute Kamstra  <lute@gnu.org>

	* facemenu.el (facemenu-unlisted-faces): Add foreground and
	background color faces.
	(facemenu-get-face): Delete function.
	(facemenu-set-face-from-menu): Don't call facemenu-get-face.
	(facemenu-add-new-color): Make second argument mandatory.
	Create the appropriate face and return it.  Simplify.
	(facemenu-set-foreground, facemenu-set-background): Don't check if
	color is defined.  Use return value of facemenu-add-new-color.

2005-06-26  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gud.el (gud-filter): Add missing argument to
	with-selected-window.

2005-06-26  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/easy-mmode.el (define-minor-mode): Don't automatically add
	a :require to the defcustom.

	* emacs-lisp/autoload.el (make-autoload): Add the :setter for
	defcustoms corresponding to minor modes.

2005-06-26  David Ponce  <david@dponce.com>

	* recentf.el: Require tree-widget instead of wid-edit.
	(recentf-filename-handler): Fix widget :type.
	(recentf-cancel-dialog, recentf-open-more-files)
	(recentf-open-files-action): Doc fix.
	(recentf-dialog-goto-first): New function.
	(recentf-dialog-mode-map): Set parent keymap first.
	(recentf-dialog-mode): Define with define-derived-mode.
	Don't display continuation lines in dialogs.
	(recentf-edit-list): Rename from recentf-edit-selected-items.
	(recentf-edit-list-select): Rename from recentf-edit-list-action.
	Simplify.
	(recentf-edit-list-validate): New function.
	(recentf-edit-list): Update accordingly.
	(recentf-open-files-item-shift): Remove.
	(recentf-open-files-item): Convert menu elements into tree and
	link widgets.  Don't create the widgets.
	(recentf-open-files): Update accordingly.
	(recentf-save-list): Untabify.

2005-06-25  Luc Teirlinck  <teirllm@auburn.edu>

	* replace.el (keep-lines-read-args): Add INTERACTIVE arg.
	(keep-lines): Add INTERACTIVE arg.  Never delete lines only
	partially contained in the active region.  Do not take active
	region into account when called from Lisp, unless INTERACTIVE arg
	is non-nil.  Use `forward-line' instead of `beginning-of-line' to
	avoid trouble with fields.  Make marker point nowhere when no
	longer used.  Always return nil.  Doc fix.
	(flush-lines): Add INTERACTIVE arg.  Do not take active region
	into account when called from Lisp, unless INTERACTIVE arg is
	non-nil.  Use `forward-line' instead of `beginning-of-line' to
	avoid trouble with fields.  Make marker point nowhere when no
	longer used.  Always return nil.  Doc fix.
	(how-many): Add INTERACTIVE arg.  Make RSTART and REND args
	interchangeable.  Do not take active region into account when
	called from Lisp, unless INTERACTIVE arg is non-nil.  Do not print
	message in echo area when called from Lisp, unless INTERACTIVE arg
	is non-nil.  Avoid saying "1 occurrences".  Do not use markers.
	Return the number of matches.  Doc fix.
	(occur): Doc fix.
	(perform-replace): Make comment follow double space convention for
	the sake of `outline-minor-mode'.

	* faces.el (facep): Doc fix.

2005-06-25  Richard M. Stallman  <rms@gnu.org>

	* facemenu.el (facemenu-enable-faces-p): New function.
	(facemenu-background-menu, facemenu-foreground-menu)
	(facemenu-face-menu): Add menu-enable property.

	* jka-compr.el (jka-compr-insert-file-contents):
	Special handling if cannot find the uncompression program.

	* cus-face.el (custom-face-attributes): Add autoload.

	* emacs-lisp/lisp-mode.el (lisp-mode-variables):
	Bind comment-indent-function locally.

	* window.el (save-selected-window): Use save-current-buffer.

	* subr.el (with-selected-window): Use save-current-buffer.

	* progmodes/gud.el (gud-filter): Simplify using with-selected-window
	and with-current-buffer.

2005-06-24  Richard M. Stallman  <rms@gnu.org>

	* simple.el (line-move-1): Fix previous change.

2005-06-24  Juanma Barranquero  <lekktu@gmail.com>

	* replace.el (occur-1): Set `buffer-read-only' and the
	buffer-modified flag before running `occur-hook' to protect
	against unintentional buffer switches that can lead to data loss.

2005-06-24  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gud.el (gud-tooltip-print-command): Indent properly.
	(gud-gdb-marker-filter): Use font-lock-warning-face for any
	initial error.

	* progmodes/gdb-ui.el (gdb-send): Remove warning face from errors
	after fresh input.
	(gdb-var-create-handler): Put name of expression in quotes.

2005-06-23  Luc Teirlinck  <teirllm@auburn.edu>

	* emacs-lisp/ring.el (ring-elements): Make it return a list of the
	elements of RING in order, and without bogus nil elements.

2005-06-23  Richard M. Stallman  <rms@gnu.org>

	* simple.el (set-variable): Args renamed; doc fix.
	(line-move-1): When there are overlays around, use vertical-motion.

	* faces.el (escape-glyph): Use brown against light background.
	(nobreak-space): Rename from no-break-space.
	Fix previous change.

	* dired-aux.el (dired-do-copy): Fix arg prompt.

	* mail/sendmail.el (mail-setup-with-from): Fix custom type.

2005-06-23  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* mail/emacsbug.el (report-emacs-bug): Use "X server distributor"
	rather than "Distributor".

2005-06-23  Lute Kamstra  <lute@gnu.org>

	* emacs-lisp/debug.el (debugger-special-form-p): New defun.
	(debug-on-entry): Use it.  New interactive declaration that uses
	function-called-at-point.

2005-06-23  Kim F. Storm  <storm@cua.dk>

	* subr.el (save-match-data): Add comment about using evaporate arg
	to set-match-data.

2005-06-22  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* cus-edit.el (customize-face)
	(customize-face-other-window): Handle face aliases.

	* faces.el (face-documentation, set-face-attribute)
	(face-spec-set): Handle face aliases.

2005-06-22  Juanma Barranquero  <lekktu@gmail.com>

	* help-mode.el (help-make-xrefs): If a symbol representing a face
	name is not followed by the word "face", it could still be a
	function or variable name, so don't bypass other checks.

2005-06-22  Juri Linkov  <juri@jurta.org>

	* ps-print.el (ps-face-foreground-name, ps-face-background-name):
	Replace aliased functions with calls where second arg `inherit' is t.

2005-06-22  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-error): New variable.
	(gdb-error): New function.
	(gdb-annotation-rules): Act on error-begin and error annotations.
	(gdb-concat-output): Use font-lock-warning-face for errors.

2005-06-22  Miles Bader  <miles@gnu.org>

	* bindings.el (propertized-buffer-identification): Use renamed
	`Buffer-menu-buffer' face.

	* faces.el (vertical-border): Rename from `vertical-divider'.
	(escape-glyph): Change dark-background color back to `cyan'.

2005-06-21  Juri Linkov  <juri@jurta.org>

	* faces.el (face-user-default-spec): Try getting `customized-face'
	prior to `saved-face'.
	(frame-background-mode): Refill docstring.

	* emacs-lisp/lisp-mode.el (eval-defun-1):
	* emacs-lisp/edebug.el (edebug-eval-defun):
	Set `saved-face' temporarily to nil before calling form.
	Set `customized-face' to the new spec after that.

2005-06-21  Juanma Barranquero  <lekktu@gmail.com>

	* subr.el (1value, lambda, key-substitution-in-progress):
	Doc fixes.

	* autoinsert.el (auto-insert-alist):
	* ses.el (ses-call-printer):
	* subr.el (noreturn):
	* emacs-lisp/lisp.el (check-parens):
	* emacs-lisp/byte-opt.el (byte-optimize-pure-func):
	* net/browse-url.el (browse-url-mosaic):
	* progmodes/cc-defs.el (c-safe-scan-lists):
	* progmodes/ebnf-abn.el (ebnf-abn-lex):
	* progmodes/ebnf-bnf.el (ebnf-bnf-lex):
	* progmodes/ebnf-dtd.el (ebnf-dtd-lex):
	* progmodes/ebnf-ebx.el (ebnf-ebx-lex):
	* progmodes/ebnf-iso.el (ebnf-iso-lex):
	* progmodes/ebnf-yac.el (ebnf-yac-lex): Fix spellings.

2005-06-21  Reiner Steib  <Reiner.Steib@gmx.de>

	* pcvs-defs.el (cvs-menu): Add cvs-mode-mark and cvs-mode-unmark.

2005-06-21  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* calendar/appt.el (appt-make-list): Activate the package, if
	not already active (for backwards compatibility).

2005-06-20  Kim F. Storm  <storm@cua.dk>

	* subr.el (add-to-ordered-list): Test membership with eq.  Simplify.

2005-06-20  Miles Bader  <miles@gnu.org>

	* faces.el (vertical-divider): New face.

2005-06-20  Juanma Barranquero  <lekktu@gmail.com>

	* simple.el (kill-whole-line): Doc fix.
	(next-error-buffer-p, next-error-find-buffer)
	(clone-indirect-buffer): Fix typos in docstrings.
	(comment-line-break-function): Doc fix: don't say variable
	is automatically buffer-local (it isn't).

2005-06-19  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-ftp.el (top):
	* net/tramp-smb.el (top):
	* net/tramp-util.el (top):
	* net/tramp-uu.el (top):
	* net/tramp-vc.el (top):
	* net/tramp.el (top): Revert copyright years back to original
	ones.  Tramp has a life outside GNU Emacs.

2005-06-19  Nick Roberts  <nickrob@snap.net.nz>

	* tooltip.el (tooltip-use-echo-area): Don't make it obsolete.

2005-06-18  Juri Linkov  <juri@jurta.org>

	* progmodes/grep.el (grep-regexp-alist): Use backreference at the
	end of first regexp to limit the match to the position between
	line number and source line with same separator character as used
	between file name and line number.  In the second regexp limit
	mouse-face area to file name and line number by adding new group
	for them and referring it in HYPERLINK arg.
	(grep-regexp-alist, grep-mode-font-lock-keywords): Use shy group.
	(grep-mode): Set font-lock-lines-before to 0 to not refontify the
	previous line where grep markers may be already removed.

2005-06-18  Peter Kleiweg  <p.c.j.kleiweg@rug.nl>

	* progmodes/ps-mode.el: Update version and maintainer's email address.

2005-06-18  Steve Youngs  <steve@xemacs.org>

	* net/browse-url.el (browse-url-browser-function)
	(browse-url-default-browser): Add firefox.
	(browse-url-firefox-program, browse-url-firefox-arguments)
	(browse-url-firefox-startup-arguments)
	(browse-url-firefox-new-window-is-tab): New defcustoms.
	(browse-url-firefox, browse-url-firefox-sentinel): New functions.

2005-06-17  Richard M. Stallman  <rms@gnu.org>

	* startup.el (command-line): Warn if specified user name has
	no home directory.

	* term.el (term-get-old-input, term-input-filter, term-input-sender)
	(term-mode-hook, term-exec-hook, term-escape-char): Doc fixes.

	* longlines.el (longlines-mode, longlines-show-hard-newlines):
	Doc fixes.

	* faces.el (underline): Try bold if terminal doesn't support underline.

	* mail/sendmail.el (mail-setup-with-from): New variable.
	(mail-insert-from-field): New function.
	(sendmail-send-it): Call it.
	(mail-setup): Optionally call it here.

	* term/linux.el: Call tty-no-underline.

2005-06-17  Luc Teirlinck  <teirllm@auburn.edu>

	* emacs-lisp/edebug.el (edebug-goto-here): Doc fix.

2005-06-17  Miles Bader  <miles@gnu.org>

	* ediff-init.el (ediff-current-diff-A, ediff-current-diff-B)
	(ediff-current-diff-C, ediff-current-diff-Ancestor)
	(ediff-fine-diff-A, ediff-fine-diff-B, ediff-fine-diff-C)
	(ediff-fine-diff-Ancestor, ediff-even-diff-A, ediff-even-diff-B)
	(ediff-even-diff-C, ediff-even-diff-Ancestor, ediff-odd-diff-A)
	(ediff-odd-diff-B, ediff-odd-diff-C, ediff-odd-diff-Ancestor):
	Remove "-face" suffix from face names.
	(ediff-current-diff-face-A, ediff-current-diff-face-B)
	(ediff-current-diff-face-C, ediff-current-diff-face-Ancestor)
	(ediff-fine-diff-face-A, ediff-fine-diff-face-B)
	(ediff-fine-diff-face-C, ediff-fine-diff-face-Ancestor)
	(ediff-even-diff-face-A, ediff-even-diff-face-B)
	(ediff-even-diff-face-C, ediff-even-diff-face-Ancestor)
	(ediff-odd-diff-face-A, ediff-odd-diff-face-B)
	(ediff-odd-diff-face-C, ediff-odd-diff-face-Ancestor):
	New backward-compatibility aliases for renamed faces.
	(ediff-current-diff-face-A, ediff-current-diff-face-B)
	(ediff-current-diff-face-C, ediff-current-diff-face-Ancestor)
	(ediff-fine-diff-face-A, ediff-fine-diff-face-B)
	(ediff-fine-diff-face-C, ediff-fine-diff-face-Ancestor)
	(ediff-even-diff-face-A, ediff-even-diff-face-B)
	(ediff-even-diff-face-C, ediff-even-diff-face-Ancestor)
	(ediff-odd-diff-face-A, ediff-odd-diff-face-B)
	(ediff-odd-diff-face-C, ediff-odd-diff-face-Ancestor):
	Use renamed ediff faces.

	* eshell/esh-test.el (eshell-test-ok, eshell-test-failed):
	Remove "-face" suffix from face names.
	(eshell-test-ok-face, eshell-test-failed-face):
	New backward-compatibility aliases for renamed faces.
	(eshell-run-test): Use renamed eshell-test faces.

	* eshell/em-prompt.el (eshell-prompt):
	Remove "-face" suffix from face name.
	(eshell-prompt-face): New backward-compatibility alias for renamed face.
	(eshell-emit-prompt): Use renamed eshell-prompt face.

	* eshell/em-ls.el (eshell-ls-directory, eshell-ls-symlink)
	(eshell-ls-executable, eshell-ls-readonly, eshell-ls-unreadable)
	(eshell-ls-special, eshell-ls-missing, eshell-ls-archive)
	(eshell-ls-backup, eshell-ls-product, eshell-ls-clutter):
	Remove "-face" suffix from face names.
	(eshell-ls-directory-face, eshell-ls-symlink-face)
	(eshell-ls-executable-face, eshell-ls-readonly-face)
	(eshell-ls-unreadable-face, eshell-ls-special-face)
	(eshell-ls-missing-face, eshell-ls-archive-face)
	(eshell-ls-backup-face, eshell-ls-product-face)
	(eshell-ls-clutter-face):
	New backward-compatibility aliases for renamed faces.
	(eshell-ls-decorated-name): Use renamed eshell-ls faces.

	* progmodes/cc-fonts.el (c-nonbreakable-space-face):
	Remove "-face" suffix from face name.
	(c-cpp-matchers): Use the variable `c-nonbreakable-space-face'
	instead of literal face.

2005-06-17  Juanma Barranquero  <lekktu@gmail.com>

	* emacs-lisp/warnings.el (display-warning, lwarn)
	(warning-minimum-log-level): Doc fixes.
	(warning-minimum-level, warning-minimum-log-level):
	Add :debug to :type choices.

	* progmodes/ada-mode.el (ada-format-paramlist)
	(ada-get-indent-case, ada-check-matching-start)
	(ada-check-defun-name, ada-goto-matching-decl-start)
	(ada-goto-matching-start, ada-goto-matching-end, ada-tab)
	(ada-untab, ada-move-to-start, ada-fill-comment-paragraph)
	(ada-make-subprogram-body): Follow error conventions.
	(ada-case-exception-file, ada-indent-comment-as-code)
	(ada-indent-handle-comment-special, ada-indent-renames)
	(ada-indent-return, ada-search-directories-internal)
	(ada-tab-policy, ada-case-exception-substring)
	(ada-other-file-alist, ada-matching-start-re)
	(ada-matching-decl-start-re, ada-contextual-menu-last-point)
	(ada-imenu-generic-expression, ada-compile-goto-error)
	(ada-in-comment-p, ada-in-string-p, ada-in-string-or-comment-p)
	(ada-popup-menu, ada-add-extensions, ada-mode)
	(ada-region-selected, ada-create-case-exception)
	(ada-create-case-exception-substring, ada-after-keyword-p)
	(ada-activate-keys-for-case, ada-adjust-case-region)
	(ada-adjust-case-buffer, ada-format-paramlist)
	(ada-scan-paramlist, ada-insert-paramlist)
	(ada-indent-newline-indent)
	(ada-indent-newline-indent-conditional)
	(ada-justified-indent-current, ada-goto-previous-word)
	(ada-indent-current, ada-get-indent-open-paren)
	(ada-get-indent-paramlist, ada-get-indent-end)
	(ada-get-indent-case, ada-get-indent-when, ada-get-indent-if)
	(ada-get-indent-block-start, ada-get-indent-subprog)
	(ada-get-indent-noindent, ada-get-indent-label)
	(ada-get-indent-loop, ada-get-indent-type, ada-goto-stmt-start)
	(ada-search-prev-end-stmt, ada-goto-next-non-ws)
	(ada-goto-stmt-end, ada-goto-next-word)
	(ada-check-matching-start, ada-check-defun-name)
	(ada-goto-matching-decl-start, ada-goto-matching-start)
	(ada-goto-matching-end, ada-search-ignore-string-comment)
	(ada-in-decl-p, ada-looking-at-semi-or)
	(ada-looking-at-semi-private, ada-in-paramlist-p)
	(ada-in-open-paren-p, ada-tab, ada-indent-current-function)
	(ada-untab-hard, ada-move-to-start, ada-move-to-end)
	(ada-next-procedure, ada-previous-procedure, ada-next-package)
	(ada-previous-package, ada-create-menu)
	(ada-fill-comment-paragraph-justify)
	(ada-fill-comment-paragraph-postfix, ada-fill-comment-paragraph)
	(ada-other-file-name, ada-last-which-function-line)
	(ada-last-which-function-subprog, ada-which-function)
	(ada-get-body-name, ada-outline-level, ada-narrow-to-defun)
	(ada-gen-treat-proc, ada-check-emacs-version)
	(ada-continuation-indent, ada-align-region-separate):
	Fix typos in docstrings.
	(ada-adjust-case, ada-adjust-case-interactive): Doc fixes.

2005-06-16  Lute Kamstra  <lute@gnu.org>

	* simple.el (fundamental-mode): Run after-change-major-mode-hook
	conditionally.

2005-06-16  Juanma Barranquero  <lekktu@gmail.com>

	* comint.el (comint-replace-by-expanded-filename)
	(comint-prompt-regexp, comint-delimiter-argument-list)
	(comint-preinput-scroll-to-bottom):
	* info.el (Info-hide-cookies-node):
	* ls-lisp.el (ls-lisp-classify):
	* find-file.el (ff-search-directories, ff-special-constructs)
	(ff-find-other-file):
	* font-lock.el (font-lock-keywords):
	* shell.el (shell-prompt-pattern)
	(shell-dynamic-complete-functions, shell-mode)
	(shell-delimiter-argument-list):
	* term.el (term-replace-by-expanded-filename)
	(term-prompt-regexp, term-delimiter-argument-list):
	* woman.el (woman-ignore, woman0-if):
	* emacs-lisp/derived.el (derived-mode-init-mode-variables):
	* emacs-lisp/elint.el (elint-init-env):
	* emacs-lisp/regexp-opt.el (regexp-opt-depth):
	* eshell/esh-mode.el (eshell-preinput-scroll-to-bottom):
	* language/ethio-util.el (ethio-tilde-escape)
	(ethio-use-three-dot-question):
	* net/zone-mode.el (zone-mode-load-time-setup):
	* progmodes/cc-align.el (c-lineup-argcont):
	* progmodes/cc-awk.el (c-awk-beginning-of-defun):
	* progmodes/cperl-mode.el (cperl-set-style-back):
	* progmodes/inf-lisp.el (inferior-lisp-prompt):
	* progmodes/vhdl-mode.el (vhdl-beginning-of-libunit):
	Fix spellings in docstrings.

	* textmodes/sgml-mode.el (sgml-calculate-indent, html-tag-help):
	* progmodes/modula2.el (m2-for): Fix spellings.

	* menu-bar.el (menu-bar-games-menu): Fix typo in menu help string.

	* simple.el (undo-more): Don't use `format' on `error' arguments.
	Improve argument/docstring consistency.
	(pending-undo-list): Doc fix.

	* smerge-mode.el (smerge-ensure-match):
	* emulation/vip.el (vip-ex):
	* net/zone-mode.el (zone-mode-update-serial):
	* progmodes/idlwave.el (idlwave-complete):
	* progmodes/vhdl-mode.el (vhdl-visit-file)
	(vhdl-compose-wire-components):
	Don't use `format' on `error' arguments.

	* tooltip.el (tooltip-start-delayed-tip, tooltip-timeout)
	(tooltip-use-echo-area, tooltip-process-prompt-regexp)
	(tooltip-help-tips): Fix typos in docstrings.

2005-06-16  David Ponce  <david@dponce.com>

	* tree-widget.el (tree-widget-value-create): Simplify last change.

2005-06-15  Matt Hodges  <MPHodges@member.fsf.org>

	* ido.el (ido-incomplete-regexp): New variable.
	(ido-set-matches-1): Handle invalid-regexp error and set
	ido-incomplete-regexp.
	(ido-incomplete-regexp): New face.
	(ido-completions): Use it.
	(ido-complete, ido-exit-minibuffer, ido-completions):
	Handle incomplete regexps.
	(ido-completions): Add check for complete match when entering a regexp.

2005-06-15  Stefan Monnier  <monnier@iro.umontreal.ca>

	* subr.el (add-to-ordered-list): Use a weak hash-table to avoid leaks.

2005-06-15  Roland Winkler  <Roland.Winkler@physik.uni-erlangen.de>

	* textmodes/bibtex.el (bibtex-Preamble): Enclose BibTeX preamble
	by field delimiters.

2005-06-15  David Ponce  <david@dponce.com>

	* tree-widget.el: eval-and-compile inlined functions so they will
	be available at run-time too.
	(tree-widget-super-format-handler)
	(tree-widget-format-handler): Remove.
	(tree-widget-value-create): Handle the :indent property.

2005-06-15  Miles Bader  <miles@gnu.org>

	* progmodes/which-func.el (which-func): Only inherit
	`font-lock-function-name-face' when that makes sense against the
	default mode-line face, otherwise set the face color explicitly.

	* progmodes/cperl-mode.el (cperl-init-faces): Use literal cperl
	faces instead of (non-existent) variables.

2005-06-14  Stefan Monnier  <monnier@iro.umontreal.ca>

	* iswitchb.el (iswitchb-to-end): Replace mapcar with dolist.
	(iswitchb-get-matched-buffers): Likewise.  Simplify.

2005-06-14  Miles Bader  <miles@gnu.org>

	* progmodes/ld-script.el (ld-script-location-counter):
	Remove "-face" suffix from face name.
	(ld-script-location-counter-face):
	New backward-compatibility alias for renamed face.
	(ld-script-location-counter-face): Use renamed face.

	* progmodes/cperl-mode.el (cperl-nonoverridable, cperl-array)
	(cperl-hash): Remove "-face" suffix from face names.
	(cperl-nonoverridable-face, cperl-array-face, cperl-hash-face):
	New backward-compatibility aliases for renamed faces.
	(cperl-find-pods-heres, cperl-init-faces, cperl-ps-print-init)
	(cperl-ps-print-face-properties): Use renamed cperl-mode faces.

	* progmodes/which-func.el (which-func): Remove "-face" suffix from face
	name.
	(which-func-face): New backward-compatibility alias for renamed face.
	(which-func-format): Use renamed which-func face.

	* progmodes/vhdl-mode.el (vhdl-prompt, vhdl-attribute, vhdl-enumvalue)
	(vhdl-function, vhdl-directive, vhdl-reserved-word)
	(vhdl-translate-off): Remove "-face" suffix and "font-lock-" from face
	names.
	(vhdl-speedbar-entity, vhdl-speedbar-architecture)
	(vhdl-speedbar-configuration, vhdl-speedbar-package)
	(vhdl-speedbar-library, vhdl-speedbar-instantiation)
	(vhdl-speedbar-subprogram, vhdl-speedbar-entity-selected)
	(vhdl-speedbar-architecture-selected)
	(vhdl-speedbar-configuration-selected)
	(vhdl-speedbar-package-selected)
	(vhdl-speedbar-instantiation-selected): Remove "-face" suffix from face
	names.
	(vhdl-font-lock-keywords-2, vhdl-font-lock-keywords-5):
	Use renamed faces.
	(vhdl-prompt-face, vhdl-attribute-face, vhdl-enumvalue-face)
	(vhdl-function-face, vhdl-directive-face, vhdl-reserved-words-face)
	(vhdl-translate-off-face): Variables renamed to remove "font-lock-".
	Use renamed faces.
	(syntax-alist): Don't use "font-lock-" or "-face" in generated face
	names.
	(vhdl-font-lock-init, vhdl-ps-print-settings): Use renamed faces.
	(vhdl-speedbar-insert-hierarchy, vhdl-speedbar-expand-entity)
	(vhdl-speedbar-expand-package, vhdl-speedbar-update-current-unit)
	(vhdl-speedbar-make-inst-line, vhdl-speedbar-make-pack-line)
	(vhdl-speedbar-make-subpack-line, vhdl-speedbar-make-subprogram-line)
	(vhdl-speedbar-item-info, vhdl-speedbar-check-unit): Use renamed faces.

	* progmodes/sh-script.el (sh-heredoc): Remove "-face" suffix from
	face name.
	(sh-heredoc-face): New backward-compatibility alias for renamed face.
	(sh-heredoc-face): Use renamed sh-heredoc face.

	* progmodes/idlw-help.el (idlwave-help-link):
	Remove "-face" suffix from face name.
	(idlwave-help-link-face):
	New backward-compatibility alias for renamed face.
	(idlwave-highlight-linked-completions): Use renamed idlwave-help faces.

	* progmodes/idlw-shell.el (idlwave-shell-bp-face)
	(idlwave-shell-disabled-bp): Remove "-face" suffix from face names.
	(idlwave-shell-bp-face, idlwave-shell-disabled-bp):
	New backward-compatibility aliases for renamed faces.
	(idlwave-shell-disabled-breakpoint-face)
	(idlwave-shell-breakpoint-face): Use renamed idlwave-shell faces.

	* progmodes/flymake.el (flymake-errline, flymake-warnline):
	Remove "-face" suffix from face names.
	(flymake-errline-face, flymake-warnline-face):
	New backward-compatibility aliases for renamed faces.
	(flymake-highlight-line): Use renamed flymake faces.

	* progmodes/ebrowse.el (ebrowse-tree-mark, ebrowse-root-class)
	(ebrowse-file-name, ebrowse-default, ebrowse-member-attribute)
	(ebrowse-member-class, ebrowse-progress):
	Remove "-face" suffix from face names.
	(ebrowse-tree-mark-face, ebrowse-root-class-face)
	(ebrowse-file-name-face, ebrowse-default-face)
	(ebrowse-member-attribute-face, ebrowse-member-class-face)
	(ebrowse-progress-face):
	New backward-compatibility aliases for renamed faces.
	(ebrowse-show-progress, ebrowse-show-file-name-at-point)
	(ebrowse-set-mark-props, ebrowse-draw-tree-fn)
	(ebrowse-draw-member-buffer-class-line, ebrowse-draw-member-long-fn)
	(ebrowse-draw-member-short-fn): Use renamed ebrowse faces.

	* progmodes/antlr-mode.el (antlr-default, antlr-keyword, antlr-syntax)
	(antlr-ruledef, antlr-tokendef, antlr-ruleref, antlr-tokenref)
	(antlr-literal): Remove "-face" suffix and "font-lock-" from face names.
	(antlr-font-lock-default-face, antlr-font-lock-keyword-face)
	(antlr-font-lock-syntax-face, antlr-font-lock-ruledef-face)
	(antlr-font-lock-tokendef-face, antlr-font-lock-ruleref-face)
	(antlr-font-lock-tokenref-face, antlr-font-lock-literal-face):
	New backward-compatibility aliases for renamed faces.
	(antlr-default-face, antlr-keyword-face, antlr-syntax-face)
	(antlr-ruledef-face, antlr-tokendef-face, antlr-ruleref-face)
	(antlr-tokenref-face, antlr-literal-face): Variables renamed to remove
	"font-lock-".  Use renamed antlr-mode faces.
	(antlr-font-lock-additional-keywords): Use renamed faces.
	Replace literal face-names with face variable references.

	* buff-menu.el (Buffer-menu-buffer): Remove "-face" suffix from
	face name.
	(Buffer-menu-buffer-face): New backward-compatibility alias for
	renamed face.
	(list-buffers-noselect): Use renamed Buffer-menu-buffer face.

2005-06-15  Daniel Pfeiffer  <occitan@esperanto.org>

	* progmodes/make-mode.el (makefile-space, makefile-makepp-perl):
	Eliminate "-face" suffix.
	(makefile-targets): Inherit from font-lock-function-name-face and
	eliminate "-face" suffix.
	(makefile-shell): Remove attributes and eliminate "-face" suffix.
	(makefile-*-font-lock-keywords): Append makefile-targets in rule
	actions, instead of prepending, to make it less visible.
	(makefile-previous-dependency, makefile-match-dependency):
	Don't match a target on a continuation line.

	* files.el (auto-mode-alist): Put Makefile in gmake mode.

2005-06-15  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (menu): Re-order menu items.
	(gdb-tooltip-print): Respect tooltip-use-echo-area.

	* progmodes/gud.el (tooltip-use-echo-area): Remove alias.
	Define in tooltip.el.
	(gud-tooltip-process-output): Respect tooltip-use-echo-area.
	(gud-tooltip-tips): Respect tooltip-use-echo-area and
	gud-tooltip-echo-area.

	* tooltip.el (tooltip-use-echo-area): Restore from gud.el for
	backward compatibility and make obsolete.
	(tooltip-help-tips): Use tooltip-use-echo-area.
	(tooltip-show-help-function): Rename to...
	(tooltip-show-help): ...this, because it is a function.
	(tooltip-mode, tooltip-help-message): Call tooltip-show-help.

2005-06-14  Luc Teirlinck  <teirllm@auburn.edu>

	* emacs-lisp/edebug.el (edebug-all-defs, edebug-initial-mode)
	(edebug-print-length, edebug-print-level, edebug-print-circle)
	(edebug-modify-breakpoint, edebug-eval-last-sexp)
	(edebug-eval-print-last-sexp): Doc fixes.

2005-06-14  Kim F. Storm  <storm@cua.dk>

	* ido.el (ido-mode): Make a new keymap every time we enable ido,
	as the coverage buffer/file/both may change.

2005-06-14  Lute Kamstra  <lute@gnu.org>

	* net/ange-ftp.el (internal-ange-ftp-mode): Use delay-mode-hooks
	and run-mode-hooks.  Simplify.

	* mail/rmailedit.el (rmail-edit-mode):
	* progmodes/octave-inf.el (inferior-octave-mode):
	* progmodes/sql.el (sql-interactive-mode): Use delay-mode-hooks.

	* recentf.el (recentf-dialog-mode): Use kill-all-local-variables
	and run-mode-hooks.
	(recentf-edit-list, recentf-open-files): Don't call
	kill-all-local-variables directly.

	* emacs-lisp/debug.el (debug-on-entry): Fix docstring.

2005-06-14  Juanma Barranquero  <lekktu@gmail.com>

	* emacs-lisp/byte-run.el (make-obsolete)
	(define-obsolete-function-alias): Rename arguments FUNCTION and
	NEW to OBSOLETE-NAME and CURRENT-NAME respectively.
	(make-obsolete-variable, define-obsolete-variable-alias):
	Rename arguments VARIABLE and NEW to OBSOLETE-NAME and CURRENT-NAME
	respectively.

	* isearchb.el (isearchb-activate):
	* pcvs.el (cvs-mode):
	* ses.el (ses-load):
	* vc-arch.el (vc-arch-checkin, vc-arch-diff):
	* net/tramp.el (tramp-find-file-exists-command)
	(tramp-find-shell):
	* progmodes/ada-mode.el (ada-create-case-exception)
	(ada-create-case-exception-substring, ada-make-subprogram-body):
	* progmodes/idlw-shell.el (idlwave-shell-move-to-bp):
	* progmodes/idlwave.el (idlwave-complete-class-structure-tag-help):
	* progmodes/vhdl-mode.el (vhdl-speedbar-place-component):
	* textmodes/org.el (org-promote, org-evaluate-time-range)
	(org-agenda-next-date-line, org-agenda-previous-date-line)
	(org-agenda-error, org-open-at-point, org-table-move-row)
	(org-format-table-table-html-using-table-generate-source)
	(org-shiftcursor-error, org-ctrl-c-ctrl-c):
	* textmodes/reftex.el (reftex-access-scan-info):
	* textmodes/reftex-toc.el (reftex-toc-dframe-p)
	(reftex-toc-promote-prepare): Follow error conventions.

	* diff-mode.el (diff-mode): Fix typo in docstring.

	* forms.el (forms--intuit-from-file): Fix reference to
	`forms-number-of-fields' in error message.
	(forms-print): Fix quoting in error message.

	* forms.el (forms-mode):
	* emulation/vi.el (vi-goto-insert-state):
	* progmodes/flymake.el (flymake-new-err-info)
	(flymake-start-syntax-check-for-current-buffer)
	(flymake-simple-cleanup):
	* eshell/esh-var.el (eshell/export):
	* progmodes/gud.el (xdb):
	* textmodes/flyspell.el (flyspell-incorrect-hook)
	(flyspell-maybe-correct-transposition)
	(flyspell-maybe-correct-doubling): Fix quoting in docstring.

2005-06-13  Luc Teirlinck  <teirllm@auburn.edu>

	* emacs-lisp/debug.el (cancel-debug-on-entry): Mention default in
	minibuffer prompt.

2005-06-13  Kim F. Storm  <storm@cua.dk>

	* subr.el (add-to-ordered-list): New defun.

	* emulation/cua-base.el (cua-mode): Use add-to-ordered-list to
	add cua--keymap-alist to emulation-mode-map-alists.

2005-06-13  Stefan Monnier  <monnier@iro.umontreal.ca>

	* subr.el (complete-in-turn): New macro.
	(dynamic-completion-table, lazy-completion-table): Add debug info.

	* faces.el (read-face-name): Use complete-in-turn complete non-aliases
	in preference to face aliases.

	* textmodes/fill.el (fill-match-adaptive-prefix): New function.
	(fill-context-prefix): Use it to avoid guessing absurdly long prefixes.
	Remove unused vars `start' and `firstline'.
	(fill-nobreak-p): Fix line-move-invisible -> line-move-invisible-p.
	(justify-current-line, fill-individual-paragraphs): Remove unused vars.

2005-06-13  Eli Zaretskii  <eliz@gnu.org>

	* cus-start.el (all): Don't complain about missing GTK-related
	variables, unless either `gtk' is boundp or this isn't a
	`windows-nt' build.

2005-06-13  Lute Kamstra  <lute@gnu.org>

	* abbrev.el (edit-abbrevs-mode): Use kill-all-local-variables and
	run-mode-hooks.

	* ediff-mult.el (ediff-meta-mode):
	* ediff-util.el (ediff-mode): Use run-mode-hooks.

	* ledit.el (ledit-mode): Use delay-mode-hooks.

	* woman.el (woman-mode-line-format): Delete constant.
	(woman-mode-map): Initialize it properly.
	(woman-mode): Set mode-class property to special.
	Use delay-mode-hooks and run-mode-hooks.  Use the right keymap.
	Set major-mode and mode-name.  Don't set mode-line-format directly.
	(Man-getpage-in-background): Don't reference woman-mode-line-format.

	* emacs-lisp/debug.el (cancel-debug-on-entry): Make the empty
	string argument obsolete.

2005-06-13  Carsten Dominik  <dominik@science.uva.nl>

	* textmodes/org.el (org-CUA-compatible): New option.
	(org-disputed-keys): New variable.
	(org-key): New function.
	(orgtbl-make-binding): Add docstring to the created function.
	(org-mode): Set paragraph start/separate regexps.
	(orgtbl-mode): Don't start `orgtbl-mode' in `org-mode' buffers.
	(org-archive-location, org-archive-mark-done)
	(org-archive-stamp-time): New options.
	(org-archive-subtree): New command.
	(org-fill-paragraph): New function.
	(org-mode): Set `fill-paragraph-function' to `org-fill-paragraph'.
	(org-fake-empty-table-line): Function removed.
	(org-format-org-table-html): Do not create empty table lines at
	separator lines.  Improved table header treatment.
	(org-link-format): New option.
	(org-make-link): New function.
	(org-insert-link, org-store-link): Use org-make-link.
	(org-open-file): Quote file name for shell command, to allow
	spaces in file names.
	(org-link-regexp): Fix bug with mailto link.
	(org-link-maybe-angles-regexp, org-protected-link-regexp):
	New constants.
	(org-export-as-html): Deal with the optional angles around a link.
	Better treatment of file: links.
	(org-open-at-point): Replace @{ and @} with < and >.
	(org-run-mode-hooks): Function removed.
	(org-agenda-mode): No longer use `org-run-mode-hooks'.

2005-06-13  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-registers-mode): Let gdbmi use
	MI command -data-list-register-values.
	(gdb-post-prompt): Indent properly.

2005-06-13  Juanma Barranquero  <lekktu@gmail.com>

	* hilit-chg.el (highlight-changes-colors): Rename from
	`highlight-changes-colours'.
	(highlight-changes-colours): Keep as obsolete alias.
	(highlight-changes-face-list): Doc fix.
	(hilit-chg-make-list): Use `highlight-changes-colors'.

2005-06-12  Mark A. Hershberger  <mah@everybody.org>

	* progmodes/cperl-mode.el (cperl-mode): Remove stray paren in
	defun-prompt-regexp.

2005-06-12  Eli Zaretskii  <eliz@gnu.org>

	* loadup.el: Don't say we are dumping under 2 names on windows-nt
	and cygwin.

	* makefile.w32-in (bootstrap-clean-CMD, bootstrap-clean-SH):
	Don't use an old loaddefs.el, as in Makefile.in.

2005-06-12  Lute Kamstra  <lute@gnu.org>

	* Makefile.in (bootstrap-prepare): Don't use an old loaddefs.el.

	* man.el (Man-mode-map): Initialize it properly.
	(Man-mode): Set mode-class property to special.

	* calendar/calendar.el (calendar-mode): Use run-mode-hooks.

2005-06-11  Luc Teirlinck  <teirllm@auburn.edu>

	* menu-bar.el (menu-bar-make-toggle): Remove stray backslash.
	A newline is needed in the docstring there.

	* emacs-lisp/debug.el (debug-on-entry, cancel-debug-on-entry):
	Doc fixes.

2005-06-11  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* printing.el: Doc fix.  The menubar is no more changed when printing
	is loaded, it only changes when pr-menu-bind or pr-update-menus is
	called.  Now, the menubar changing will work in Emacs 20, 21 and 22.
	(pr-version): New version number (6.8.4).
	(pr-menu-bind): New command.
	(pr-update-menus): Docstring and code fix.
	(pr-menu-print-item): Now is a global var in Emacs and XEmacs.
	Docstring fix.
	(pr-txt-printer-alist, pr-ps-printer-alist, pr-gv-command)
	(pr-gs-command, pr-gs-switches, pr-ps-utility-alist): Docstring fix.

2005-06-11  Thien-Thi Nguyen  <ttn@gnu.org>

	* emacs-lisp/ewoc.el: Doc fixes for public funcs:
	"Returns" to "return", document useful return values, etc.

2005-06-11  Alan Mackenzie  <acm@muc.de>

	* fill.el (fill-context-prefix): Try `adaptive-fill-function'
	BEFORE `adaptive-fill-regexp' when determining a fill prefix.
	(adaptive-file-function): Minor amendment to doc-string.

2005-06-11  Frederik Fouvry  <fouvry@CoLi.Uni-SB.DE>

	* thumbs.el (thumbs-per-line, thumbs-thumbsdir-max-size)
	(thumbs-relief, thumbs-margin, thumbs-image-resizing-step):
	Fix :type--it is `integer', not `string'.

	* faces.el (modeline-highlight): Rename from (the erroneous)
	`modeline-higilight'.

2005-06-11  Lute Kamstra  <lute@gnu.org>

	* emacs-lisp/edebug.el (edebug-eval-mode-map): Don't copy
	lisp-interaction-mode-map but make it the parent.
	(edebug-eval-mode): Use define-derived-mode.

2005-06-11  Andreas Schwab  <schwab@suse.de>

	* bindings.el: Add binding of `ESC functionkey' for every
	`M-functionkey'.
	* hexl.el (hexl-mode-map): Likewise.

2005-06-10  Michael Hotchin  <michael@hotchin.net>  (tiny change)

	* progmodes/compile.el (compilation-error-regexp-alist-alist)
	[msft]: update regexp for newer msft compilers.

2005-06-10  Mark A. Hershberger  <mah@everybody.org>

	* xml.el (start-chars, xml-parse-dtd): Add the ability to skip
	ATTLIST portions of included DTDs.
	(xml-parse-dtd): Eliminate use of inefficient match-data.

2005-06-10  Miles Bader  <miles@gnu.org>

	* play/mpuz.el (mpuz-unsolved, mpuz-solved, mpuz-trivial)
	(mpuz-text): Remove "-face" suffix from face names.
	(mpuz-unsolved-face, mpuz-solved-face, mpuz-trivial-face)
	(mpuz-text-face): New backward-compatibility aliases for renamed faces.
	(mpuz-create-buffer, mpuz-paint-digit): Use renamed mpuz faces.

	* play/gomoku.el (gomoku-O, gomoku-X):
	Remove "-face" suffix from face names.
	(gomoku-font-lock-O-face, gomoku-font-lock-X-face):
	New backward-compatibility aliases for renamed faces.
	(gomoku-font-lock-keywords): Use renamed gomoku faces.

2005-06-10  Juanma Barranquero  <lekktu@gmail.com>

	* thumbs.el: Fixes for changes of 2005-06-09.
	(thumbs-thumbsdir): Force `thumbs-thumbsdir' to be interpretable
	as a directory.
	(thumbs-thumbname): Remove directory separator from format string;
	`thumbs-thumbsdir' now returns a valid directory name.
	(thumbs-temp-dir): New defsubst.
	(thumbs-temp-file, thumbs-resize-image, thumbs-modify-image):
	Use it.

	* cus-edit.el (minibuffer):
	* files.el (make-backup-file-name-function):
	* filesets.el (filesets-external-viewers):
	* hilit-chg.el (highlight-changes-colours)
	(highlight-changes-face-list, highlight-changes-rotate-faces):
	* ielm.el (ielm-dynamic-return, inferior-emacs-lisp-mode):
	* kmacro.el (kmacro-call-macro):
	* log-edit.el (log-edit-changelog-full-paragraphs):
	* mouse.el (mouse-1-click-follows-link):
	* skeleton.el (skeleton-autowrap):
	* subr.el (insert-for-yank-1):
	* tempo.el (tempo-insert-region):
	* terminal.el (terminal-emulator):
	* time.el (display-time-mail-face):
	* vc.el (vc-annotate):
	* vcursor.el (vcursor-copy-line):
	* woman.el (woman-bold-headings, woman-ignore)
	(woman-default-faces, woman-monochrome-faces):
	* calendar/todo-mode.el (todo-insert-threshold):
	* emulation/pc-select.el (pc-select-selection-keys-only)
	(pc-selection-mode):
	* emulation/vip.el (vip-find-char-forward):
	* emulation/viper-cmd.el (viper-find-char-forward):
	* international/mule-cmds.el (select-safe-coding-system-accept-default-p)
	(input-method-exit-on-invalid-key):
	* international/mule-diag.el (describe-coding-system):
	* international/ucs-tables.el (unify-8859-on-encoding-mode):
	* net/browse-url.el (browse-url-xterm-program):
	* obsolete/lazy-lock.el (lazy-lock-mode):
	* progmodes/cperl-mode.el (cperl-info-on-command-no-prompt)
	(cperl-mode):
	* progmodes/cpp.el (cpp-face-light-name-list)
	(cpp-face-dark-name-list):
	* progmodes/delphi.el (delphi-newline-always-indents):
	Fix spellings in docstrings.

	* ido.el (ido-mode, ido-file-extensions-order)
	(ido-default-file-method, ido-default-buffer-method)
	(ido-max-prospects, ido-slow-ftp-hosts, ido-setup-hook)
	(ido-decorations, ido-read-file-name-as-directory-commands)
	(ido-read-file-name-non-ido, ido-work-directory-list)
	(ido-ignore-item-temp-list, ido-current-directory)
	(ido-magic-forward-char, ido-enter-find-file)
	(ido-enter-switch-buffer, ido-visit-buffer, ido-switch-buffer)
	(ido-find-file, ido-read-buffer): Fix typos in docstrings.

2005-06-10  Lute Kamstra  <lute@gnu.org>

	* play/dunnet.el (dun-mode): Use define-derived-mode.
	(dungeon-mode-map): Rename to dun-mode-map.  Keep old name as an
	obsolete alias.

	* play/doctor.el (doctor-mode-map): Remove defvar.
	(doctor-mode): Use define-derived-mode.

	* mail/mspools.el (mspools-mode):
	* net/eudc-hotlist.el (eudc-hotlist-mode):
	* play/blackbox.el (blackbox-mode): Use run-mode-hooks.

2005-06-10  Miles Bader  <miles@gnu.org>

	* textmodes/flyspell.el (flyspell-incorrect, flyspell-duplicate):
	Remove "-face" suffix from face names.
	(flyspell-incorrect-face, flyspell-duplicate-face):
	New backward-compatibility aliases for renamed faces.
	(flyspell-mode-on, make-flyspell-overlay)
	(flyspell-highlight-incorrect-region)
	(flyspell-highlight-duplicate-region)
	(flyspell-display-next-corrections)
	(flyspell-auto-correct-previous-word): Use renamed flyspell faces.

	* textmodes/texinfo.el (texinfo-heading): Remove "-face" suffix
	from face name.
	(texinfo-heading-face): New backward-compatibility alias for
	renamed face.
	(texinfo-heading-face): Use renamed texinfo-heading face.

	* textmodes/tex-mode.el (tex-math, tex-verbatim): Remove "-face"
	suffix from face names.
	(tex-math-face, tex-verbatim-face):
	New backward-compatibility aliases for renamed faces.
	(tex-math-face, tex-verbatim-face): Use renamed tex-mode faces.
	(tex-insert-quote): Use `tex-verbatim-face' variable instead of
	literal face name.

	* textmodes/table.el (table-cell): Remove "-face" suffix from face
	name.
	(table-cell-face): New backward-compatibility alias for renamed face.
	(table--put-cell-face-property, table--update-cell-face):
	Use renamed table-cell face.

	* textmodes/sgml-mode.el (sgml-namespace): Remove "-face" suffix
	from face name.
	(sgml-namespace-face): New backward-compatibility alias for
	renamed face.
	(sgml-namespace-face): Use renamed sgml-namespace face.

	* textmodes/org.el (org-level-1, org-level-2, org-level-3)
	(org-level-4, org-level-5, org-level-6, org-level-7)
	(org-level-8, org-warning, org-headline-done)
	(org-deadline-announce, org-scheduled-today)
	(org-scheduled-previously, org-link, org-done, org-table)
	(org-time-grid): Remove "-face" suffix from face names.
	(org-level-1-face, org-level-2-face, org-level-3-face)
	(org-level-4-face, org-level-5-face, org-level-6-face)
	(org-level-7-face, org-level-8-face, org-warning-face)
	(org-headline-done-face, org-deadline-announce-face)
	(org-scheduled-today-face, org-scheduled-previously-face)
	(org-link-face, org-done-face, org-table-face)
	(org-time-grid-face):
	New backward-compatibility aliases for renamed faces.
	(org-level-faces, org-set-font-lock-defaults, org-timeline)
	(org-agenda, org-agenda-get-todos, org-agenda-get-deadlines)
	(org-agenda-get-timestamps, org-agenda-get-scheduled)
	(org-agenda-add-time-grid-maybe, org-table-p): Use renamed org faces.

	* emulation/viper-init.el (viper-search, viper-replace-overlay)
	(viper-minibuffer-emacs, viper-minibuffer-insert)
	(viper-minibuffer-vi): Remove "-face" suffix from face names.
	(viper-search-face, viper-replace-overlay-face)
	(viper-minibuffer-emacs-face, viper-minibuffer-insert-face)
	(viper-minibuffer-vi-face):
	New backward-compatibility aliases for renamed faces.
	(viper-search-face, viper-replace-overlay-face)
	(viper-minibuffer-emacs-face, viper-minibuffer-insert-face)
	(viper-minibuffer-vi-face): Use renamed viper faces.

	* emacs-lisp/testcover.el (testcover-nohits, testcover-1value):
	Remove "-face" suffix from face names.
	(testcover-nohits-face, testcover-1value-face):
	New backward-compatibility aliases for renamed faces.
	(testcover-mark): Use renamed testcover faces.

	* calendar/diary-lib.el (diary-button): Remove "-face" suffix from
	face name.
	(diary-button-face): New backward-compatibility alias for renamed face.
	(diary-entry): Use renamed diary-button face.

	* calendar/calendar.el (diary, calendar-today, holiday)
	(mark-visible-calendar-date): Remove "-face" suffix from face names.
	(diary-face, calendar-today-face, holiday-face):
	New backward-compatibility aliases for renamed faces.
	(eval-after-load "facemenu", diary-entry-marker)
	(calendar-today-marker, calendar-holiday-marker, diary-face):
	Use renamed calendar faces.

	* compare-w.el (compare-windows): Remove "-face" suffix from face name.
	(compare-windows-face): New backward-compatibility alias for
	renamed face.
	(compare-windows-highlight): Use renamed compare-windows face.

	* strokes.el (strokes-char): Remove "-face" suffix from face name.
	(strokes-char-face): New backward-compatibility alias for renamed face.
	(strokes-encode-buffer): Use renamed strokes-char face.

	* pcvs-info.el (cvs-header, cvs-filename, cvs-unknown)
	(cvs-handled, cvs-need-action, cvs-marked, cvs-msg):
	Remove "-face" suffix from face names.
	(cvs-header-face, cvs-filename-face, cvs-unknown-face)
	(cvs-handled-face, cvs-need-action-face, cvs-marked-face)
	(cvs-msg-face): New backward-compatibility aliases for renamed faces.
	(cvs-fi-up-to-date-face, cvs-fi-unknown-face, cvs-fileinfo-pp):
	Use renamed pcvs faces.
	* pcvs.el (cvs-mode-find-file): Use renamed pcvs faces.
	* pcvs-defs.el (cvs-mode-map): Likewise.
	* cvs-status.el (cvs-status-font-lock-keywords): Likewise.

	* info.el (info-title-1, info-title-2, info-title-3)
	(info-title-4): Remove "-face" suffix from and downcase face names.
	(Info-title-1-face, Info-title-2-face, Info-title-3-face)
	(Info-title-4-face):
	New backward-compatibility aliases for renamed faces.
	(Info-fontify-node): Use renamed info faces.

	* hilit-chg.el (highlight-changes, highlight-changes-delete):
	Remove "-face" suffix from face names.
	(highlight-changes-face, highlight-changes-delete-face):
	New backward-compatibility aliases for renamed faces.
	(hilit-chg-cust-fix-changes-face-list, hilit-chg-make-ov)
	(hilit-chg-make-list): Use renamed highlight-changes faces.

	* generic-x.el (show-tabs-tab, show-tabs-space):
	Remove "-face" suffix from face names.
	(show-tabs-tab-face, show-tabs-space-face):
	New backward-compatibility aliases for renamed faces.
	(show-tabs-generic-mode-font-lock-defaults-1)
	(show-tabs-generic-mode-font-lock-defaults-2):
	Use renamed show-tabs faces.

	* smerge-mode.el (smerge-mine, smerge-other, smerge-base)
	(smerge-markers): Remove "-face" suffix from face names.
	(smerge-mine-face, smerge-other-face, smerge-base-face)
	(smerge-markers-face):
	New backward-compatibility aliases for renamed faces.
	(smerge-mine-face, smerge-other-face, smerge-base-face)
	(smerge-markers-face): Use renamed smerge faces.

	* log-view.el (log-view-file, log-view-message):
	Remove "-face" suffix from face names.
	(log-view-file-face, log-view-message-face):
	New backward-compatibility aliases for renamed faces.
	(log-view-file-face, log-view-message-face): Use renamed log-view faces.

	* paren.el (show-paren-match, show-paren-mismatch):
	Remove "-face" suffix from face names.
	(show-paren-match-face, show-paren-mismatch-face):
	New backward-compatibility aliases for renamed faces.
	(show-paren-function): Use renamed show-paren faces.

	* ruler-mode.el (ruler-mode-default, ruler-mode-pad)
	(ruler-mode-margins, ruler-mode-fringes)
	(ruler-mode-column-number, ruler-mode-fill-column)
	(ruler-mode-comment-column, ruler-mode-goal-column)
	(ruler-mode-tab-stop, ruler-mode-current-column):
	Remove "-face" suffix from face names.
	(ruler-mode-default-face, ruler-mode-pad-face)
	(ruler-mode-margins-face, ruler-mode-fringes-face)
	(ruler-mode-column-number-face, ruler-mode-fill-column-face)
	(ruler-mode-comment-column-face, ruler-mode-goal-column-face)
	(ruler-mode-tab-stop-face, ruler-mode-current-column-face):
	New backward-compatibility aliases for renamed faces.
	(ruler-mode-pad, ruler-mode-margins, ruler-mode-fringes)
	(ruler-mode-column-number, ruler-mode-fill-column)
	(ruler-mode-comment-column, ruler-mode-goal-column)
	(ruler-mode-tab-stop, ruler-mode-current-column)
	(ruler-mode-mouse-grab-any-column, ruler-mode-ruler): Use renamed faces.

	* whitespace.el (whitespace-highlight): Remove "-face" suffix from
	face name.
	(whitespace-highlight-the-space): Use renamed face.
	(whitespace-highlight-face): New backward-compatibility alias for
	renamed face.

	* woman.el (woman-italic, woman-bold, woman-unknown)
	(woman-addition, woman-symbol-face):
	Remove "-face" suffix from face names.
	(woman-italic-face, woman-bold-face, woman-unknown-face)
	(woman-addition-face):
	New backward-compatibility aliases for renamed faces.
	(woman-default-faces, woman-monochrome-faces, woman-man-buffer)
	(woman-decode-region, woman-replace-match)
	(woman-display-extended-fonts, woman-special-characters)
	(woman-font-alist, woman-change-fonts, woman2-TH, woman2-SH):
	Use renamed woman faces.

	* longlines.el (longlines-visible-face): Face removed.

	* diff-mode.el (diff-header, diff-file-header, diff-index)
	(diff-hunk-header, diff-removed, diff-added, diff-changed)
	(diff-function, diff-context, diff-nonexistent): Remove "-face"
	suffix from face names.
	(diff-header-face, diff-file-header-face, diff-index-face)
	(diff-hunk-header-face, diff-removed-face, diff-added-face)
	(diff-changed-face, diff-function-face, diff-context-face)
	(diff-nonexistent-face): New backward-compatibility aliases for
	renamed faces.
	(diff-header-face, diff-file-header-face)
	(diff-index, diff-index-face, diff-hunk-header)
	(diff-hunk-header-face, diff-removed, diff-removed-face)
	(diff-added, diff-added-face, diff-changed-face, diff-function)
	(diff-function-face, diff-context-face, diff-nonexistent)
	(diff-nonexistent-face): Use renamed diff-mode faces.

	* progmodes/compile.el (compilation-warning-face)
	(compilation-info-face): Remove "-face" suffix from face names.
	(compilation-warning-face, compilation-info-face):
	New backward-compatibility aliases for renamed faces.
	(compilation-warning-face, compilation-info-face):
	Use renamed compilation faces.

	* add-log.el (change-log-date, change-log-name)
	(change-log-email, change-log-file, change-log-list)
	(change-log-conditionals, change-log-function)
	(change-log-acknowledgement): Remove "-face" suffix from face names.
	(change-log-date-face, change-log-name-face)
	(change-log-email-face, change-log-file-face)
	(change-log-list-face, change-log-conditionals-face)
	(change-log-function-face, change-log-acknowledgement-face):
	New backward-compatibility aliases for renamed faces.
	(change-log-font-lock-keywords): Use renamed change-log faces.

	* cus-edit.el (custom-invalid, custom-rogue, custom-modified)
	(custom-set, custom-changed, custom-saved, custom-button)
	(custom-button-pressed, custom-documentation, custom-state)
	(custom-comment, custom-comment-tag, custom-variable-tag)
	(custom-variable-button, custom-face-tag, custom-group-tag-1)
	(custom-group-tag): Remove "-face" suffix from face names.
	(custom-magic-alist, custom-magic-value-create)
	(custom-group-sample-face-get, custom-mode): Use renamed custom faces.
	(custom-invalid-face, custom-rogue-face, custom-modified-face)
	(custom-set-face, custom-changed-face, custom-saved-face)
	(custom-button-face, custom-button-pressed-face)
	(custom-documentation-face, custom-state-face)
	(custom-comment-face, custom-comment-tag-face)
	(custom-variable-tag-face, custom-variable-button-face)
	(custom-face-tag-face, custom-group-tag-face-1)
	(custom-group-tag-face):
	New backward-compatibility aliases for renamed faces.

	* wid-edit.el (widget-documentation, widget-button)
	(widget-field, widget-single-line-field, widget-inactive)
	(widget-button-pressed): "-face" suffix removed from face names.
	(widget-documentation-face, widget-button-face)
	(widget-field-face, widget-single-line-field-face)
	(widget-inactive-face, widget-button-pressed-face):
	New backward-compatibility aliases for renamed faces.
	(widget-documentation-face, widget-button-face)
	(widget-button-pressed-face, widget-specify-field)
	(widget-specify-inactive): Use renamed widget faces.

2005-06-10  Kenichi Handa  <handa@m17n.org>

	* term/x-win.el (x-clipboard-yank): Remove condition-case
	wrapping.

2005-06-11  Kenichi Handa  <handa@m17n.org>

	* add-log.el (change-log-font-lock-keywords): Make the regexp for
	date lines stricter.

2005-06-10  Zhang Wei  <id.brep@gmail.com>  (tiny change)

	* term/x-win.el (x-clipboard-yank): Use x-selection-value instead
	of x-get-selection.

2005-06-10  Juanma Barranquero  <lekktu@gmail.com>

	* comint.el (comint-mode, comint-snapshot-last-prompt):
	* frame.el (frame-current-scroll-bars):
	* term.el (term-mode, term-check-proc, term-input-sender)
	(term-simple-send, term-extract-string, term-word)
	(term-match-partial-filename):
	* window.el (window-current-scroll-bars):
	* emulation/cua-base.el (cua-normal-cursor-color)
	(cua-read-only-cursor-color, cua-overwrite-cursor-color)
	(cua-global-mark-cursor-color):
	* mail/undigest.el (rmail-forward-separator-regex):
	Fix typos in docstrings.

	* comint.el (comint-check-proc, make-comint-in-buffer)
	(comint-source-default): Doc fixes.

	* term.el (term-send-string): Improve argument/docstring
	consistency.

2005-06-09  Luc Teirlinck  <teirllm@auburn.edu>

	* comint.el (comint-send-input): Bind `inhibit-read-only' around
	call to `delete-region'.
	(comint-mode-hook): Do not enable Font Lock by default.

2005-06-09  Lute Kamstra  <lute@gnu.org>

	* textmodes/ispell.el (ispell-menu-map-needed): flyspell-mode
	could be void.

2005-06-09  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/debug.el (debugger-will-be-back): New var.
	(debug): Use it.
	(debugger-step-through, debugger-continue, debugger-jump)
	(debugger-return-value): Set it when needed.
	(debugger-make-xrefs, debugger-frame, debugger-frame-clear):
	Use inhibit-read-only.

2005-06-09  Juanma Barranquero  <lekktu@gmail.com>

	* window.el (shrink-window-if-larger-than-buffer)
	(window-size-fixed): Fix typo in docstring.

	* thumbs.el: Don't set `auto-image-file-mode'.  Do not create the
	thumbnails directory on loading.
	(thumbs-conversion-program): Use `eq' to check the system type,
	not `equal'.
	(thumbs-temp-dir): Initialize to `temporary-file-directory',
	not "/tmp".  Fix docstring.
	(thumbs-thumbsdir): New function to return the thumbnails
	directory, creating it if needed.
	(thumbs-cleanup-thumbsdir, thumbs-thumbname): Use it.
	(thumbs-temp-file): Delete variable and make it into a function.
	(thumbs-resize-image, thumbs-modify-image): Use it.
	(thumbs-kill-buffer): Simplify.
	(thumbs-gensym): Defalias or duplicate CL `gensym'.
	(thumbs-resize-image, thumbs-resize-interactive): Fix typos in
	docstrings.

2005-06-09  Kim F. Storm  <storm@cua.dk>

	* subr.el (save-match-data): Add RESEAT arg `evaporate' to
	set-match-data to free markers in match-data.

	* replace.el (replace-match-data): Pass RESEAT arg `t' to
	match-data to unchain markers in match-data.

2005-06-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/debug.el (debug): Don't iconify if we know we'll re-enter
	the debugger immediately anyway.  Undo the 2005-06-06 change, rendered
	unnecessary now.

2005-06-08  Richard M. Stallman  <rms@gnu.org>

	* emacs-lisp/easy-mmode.el (define-minor-mode): If BODY is empty,
	give the variable a doc string that doesn't say don't set it directly.

	* textmodes/ispell.el (ispell-check-version):
	Use match-string-no-properties.
	(ispell-region,	ispell-buffer-local-parsing, ispell-buffer-local-dict)
	(ispell-buffer-local-words): Likewise.

	* progmodes/make-mode.el (makefile-shell-face): Make this a no-op
	except on terminals with enough colors to really display it.
	(makefile-dependency-regex): Delete spurious `bb'.

	* faces.el (escape-glyph): Use blue once again in last case.
	(no-break-space): Redefine so that it isn't invisible on a tty.

2005-06-08  Kim F. Storm  <storm@cua.dk>

	* ido.el (ido-read-file-name): Fallback to read-file-name on C-f
	also when reading directory name.

2005-06-08  Lute Kamstra  <lute@gnu.org>

	* textmodes/flyspell.el (flyspell-mode): Use define-minor-mode.
	(flyspell-mode-line-string): Remove autoload cookie.
	(flyspell-mode): Remove defvar.

2005-06-07  Lute Kamstra  <lute@gnu.org>

	* textmodes/org.el (org-run-mode-hooks): New function.
	(org-agenda-mode): Use it.

2005-06-07  David McCabe  <davemccabe@gmail.com>  (tiny change)

	* emacs-lisp/lisp-mode.el (defstruct): Set `doc-string-elt' property.

2005-06-06  Stefan Monnier  <monnier@iro.umontreal.ca>

	* international/iso-cvt.el (iso-sgml2iso-trans-tab): Add NBSP.

2005-06-06  Luc Teirlinck  <teirllm@auburn.edu>

	* font-lock.el (font-lock-add-keywords): Doc fix.

2005-06-06  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/tex-mode.el (tex-guess-mode): Add RequirePackage.
	(tex-compile-default): In the absence of any history, use the order in
	tex-compile-alist to choose the preferred command.
	(tex-compile-commands): Reorder a bit.

	* textmodes/flyspell.el (flyspell-auto-correct-binding)
	(flyspell-incorrect-face, flyspell-duplicate-face):
	Use (X)Emacs-agnostic code.
	(flyspell-mode-map): Don't overwrite at each load.  Remove code
	redundant with the subsequent add-minor-mode.  Merge Emacs and
	XEmacs code.
	(flyspell-word): Minor simplification.
	(flyspell-math-tex-command-p): Quieten the byte-compiler.
	(flyspell-external-point-words): Remove unused vars `size' and `start'.
	(flyspell-do-correct): Rename from flyspell-xemacs-correct.
	Merge the corresponding Emacs code.
	(flyspell-correct-word, flyspell-xemacs-popup): Use flyspell-do-correct.

	* emacs-lisp/debug.el (debug): Don't bury the buffer unless it's in
	a dedicated window.

	* international/latexenc.el (latexenc-find-file-coding-system):
	Undo part of last patch, to turn off a compiler warning.

2005-06-06  Juri Linkov  <juri@jurta.org>

	* tmm.el (tmm-inactive, tmm-remove-inactive-mouse-face):
	Rename `tmm-inactive-face' to `tmm-inactive'.

2005-06-06  Matt Hodges  <MPHodges@member.fsf.org>

	* iswitchb.el: Rename faces.

2005-06-06  Kim F. Storm  <storm@cua.dk>

	* emulation/cua-base.el (cua-rectangle, cua-rectangle-noselect)
	(cua-global-mark): Remove -face suffix from face names.

	* emulation/cua-gmrk.el (cua--init-global-mark):
	Remove cua-global-mark face setup.

2005-06-06  Richard M. Stallman  <rms@gnu.org>

	* progmodes/make-mode.el (makefile-dependency-regex): Handle whitespace
	just like other allowed characters.
	(makefile-match-dependency): Exclude leading and training whitespace
	from the range of regexp subexp 1.
	(makefile-macroassign-regex): Don't try to match the body,
	just the name of the macro being defined.

	* info.el (Info-read-node-name-2): New function.
	(Info-read-node-name-1): Use that.
	Add a completion-base-size-function property.

	* simple.el (completion-setup-function): Look for
	completion-base-size-function property of
	minibuffer-completion-table.

	* files.el (locate-file-completion): Doc fix.

	* printing.el: Don't call pr-update-menus; user must do that.

	* emacs-lisp/debug.el (debugger-window): New variable.
	(debug): Use debugger-window if it is set and still alive.
	Record debugger-window for next entry.

	* mail/supercite.el (sc-mail-glom-frame): Mark as risky.

2005-06-06  Matthias F,Av(Brste  <slashdevslashnull@gmx.net>

	* files.el (hack-local-variables-confirm): New arg FLAG-TO-CHECK.
	(hack-one-local-variable, hack-local-variables)
	(hack-local-variables-prop-line): Pass that arg.

2005-06-06  Kim F. Storm  <storm@cua.dk>

	* ido.el (ido-first-match, ido-only-match, ido-subdir)
	(ido-indicator): Remove -face suffix from face names.

2005-06-06  Juri Linkov  <juri@jurta.org>

	* font-lock.el (font-lock-regexp-backslash)
	(font-lock-regexp-backslash-construct): New faces.
	(lisp-font-lock-keywords-2): Use new faces.  Match `?:' only
	after `('.  Add `while-no-input' to control structures.

	* faces.el (no-break-space, shadow): New faces.
	(escape-glyph): Use less loud colors pink2 and red4.

	* diff-mode.el (diff-context-face)
	* dired.el (dired-ignored)
	* rfn-eshadow.el (file-name-shadow)
	* tmm.el (tmm-inactive-face): Inherit from `shadow' face.

	* info.el (Info-title-1-face): Use green instead of yellow because
	bold yellow is not readable on light backgrounds.

	* progmodes/compile.el (compilation-start): Move `erase-buffer' up
	before selecting the desired mode to not spend time fontifying
	old contents.

2005-06-06  Juanma Barranquero  <lekktu@gmail.com>

	* thumbs.el (thumbs-thumbsdir-max-size, thumbs-image-resizing-step)
	(thumbs-thumbsdir-auto-clean): Fix typos in docstrings.

	* ps-print.el (ps-default-fg, ps-default-bg):
	Fix typos in docstrings.

	* isearchb.el (isearchb): Don't pass a spurious second argument to
	`iswitchb-completions'.

2005-06-05  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-info-locals-handler): Use window point
	to preserve point.
	(gdb-find-file-hook): Add doc string.

	* progmodes/gud.el (gdb, gud-menu-map): Add command to evaluate
	C dereferenced pointer expression.
	(gud-tool-bar-map): Put it on the tool bar.  Re-order icons.

	* toolbar/gud-pstar.xpm, toolbar/gud-pstar.pbm: New files.

	* toolbar/gud-break.xpm, toolbar/gud-cont.xpm, toolbar/gud-down.xpm
	* toolbar/gud-finish.xpm, toolbar/gud-ni.xpm, toolbar/gud-n.xpm
	* toolbar/gud-print.xpm, toolbar/gud-remove.xpm, toolbar/gud-run.xpm
	* toolbar/gud-si.xpm, toolbar/gud-s.xpm, toolbar/gud-until.xpm
	* toolbar/gud-up.xpm, toolbar/gud-watch.xpm:
	Make background transparent.

2005-06-04  Luc Teirlinck  <teirllm@auburn.edu>

	* font-lock.el (font-lock-add-keywords): Doc fix.  Comment change.
	(font-lock-remove-keywords): Doc fix.
	(font-lock-mode-major-mode): Compiler defvar.
	(font-lock-set-defaults): Use `font-lock-mode-major-mode'.

	* font-core.el (font-lock-mode-major-mode): Compiler defvar.
	(font-lock-mode): Update `font-lock-mode-major-mode'.
	(font-lock-set-defaults): Compiler defvar.
	(font-lock-default-function): Take `font-lock-mode-major-mode'
	into account.

	* emacs-lisp/easy-mmode.el (define-global-minor-mode): Make it
	keep track of which major mode it enabled the minor mode for.
	Use find-file-hook again.  Update docstring.

	* simple.el (eval-expression-print-level)
	(eval-expression-print-length, eval-expression-debug-on-error):
	Doc fixes.

2005-06-04  Matt Hodges  <MPHodges@member.fsf.org>

	* iswitchb.el (iswitchb-single-match-face)
	(iswitchb-current-match-face, iswitchb-virtual-matches-face)
	(iswitchb-invalid-regexp-face): New faces.
	(iswitchb-completions): Use them.
	(iswitchb-use-faces): Rename from iswitchb-use-fonts, which is
	now marked as an obsolete alias.
	(iswitchb-read-buffer): Remove check for bound font variables.
	(iswitchb-invalid-regexp): New free variable.
	(iswitchb-get-matched-buffers): Catch invalid-regexp errors and
	set iswitchb-invalid-regexp.
	(iswitchb, iswitchb-complete, iswitchb-completions): Deal with
	invalid regexps.
	(iswitchb-completions): Add check for complete match when entering
	a regexp.
	(iswitchb-completions): Remove require-match argument.
	(iswitchb-exhibit): Fix caller.
	(iswitchb-common-match-inserted): New variable.
	(iswitchb-complete, iswitchb-completion-help): Use it.

2005-06-04  David Reitter  <david.reitter@gmail.com>  (tiny change)

	* url-http.el (url-http-chunked-encoding-after-change-function):
	Use `url-http-debug' instead of `message'.

2005-06-04  Thierry Emery  <thierry.emery@free.fr>  (tiny change)

	* url-http.el (url-http-parse-headers): Pass redirected URL as a
	callback argument.

2005-06-04  Kim F. Storm  <storm@cua.dk>

	* simple.el (line-move): Only call sit-for when moving backwards.

	* ido.el (ido-make-merged-file-list-1): New defun split from
	ido-make-merged-file-list.
	(ido-make-merged-file-list): Bind throw-on-input around call to
	ido-make-merged-file-list-1.  Return input-pending-p if
	interrupted by more input available.
	(ido-read-internal): Handle input-pending-p return value from
	ido-make-merged-file-list.

2005-06-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/flyspell.el (flyspell-check-word-p): Simplify silly
	compatibility code.

	* international/latexenc.el (latexenc-find-file-coding-system):
	Don't inherit the EOL part of the coding-system from the
	tex-main buffer.  Fit within 80 columns.

2005-06-03  Matt Hodges  <MPHodges@member.fsf.org>

	* tmm.el (tmm-inactive-face): New face.
	(tmm-remove-inactive-mouse-face): New function.
	(tmm-prompt, tmm-add-one-shortcut)
	(tmm-add-prompt, tmm-get-keymap): Make active menu items visible
	but not selectable.

2005-06-03  Juanma Barranquero  <lekktu@gmail.com>

	* faces.el (face-equal): Improve argument/docstring consistency.

2005-06-03  Daniel Pfeiffer  <occitan@esperanto.org>

	* progmodes/make-mode.el (makefile-targets-face)
	(makefile-shell-face, makefile-makepp-perl-face): Add :version.
	(makefile-bsdmake-dependency-regex)
	(makefile-makepp-rule-action-regex)
	(makefile-bsdmake-rule-action-regex): New constants.
	(makefile-makepp-mode, makefile-bsdmake-mode): Use them.

	* progmodes/compile.el (compilation-error-regexp-alist-alist):
	Allow (...) within `...' for makepp messages.

2005-06-03  Michael Kifer  <kifer@cs.stonybrook.edu>

	* ediff-diff.el (ediff-same-contents): Eliminate CL-type functions.

	* ediff-mult.el (ediff-intersect-directories): Make sure that ".." and
	"." files are deleted from all file lists before comparison.

	* viper-keym.el (viper-toggle-key, viper-quoted-insert-key)
	(viper-ESC-key): Made them customizable.

	* viper.el (viper-non-hook-settings): Fix the names of defadvices.

2005-06-01  Luc Teirlinck  <teirllm@auburn.edu>

	* autorevert.el (auto-revert-buffers): Use save-match-data.

2005-06-01  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/easymenu.el (easy-menu-return-item): Quick fix to find
	menu items with a nil command binding.

2005-06-01  Juanma Barranquero  <lekktu@gmail.com>

	* emacs-lisp/cl-macs.el (defsetf):
	Improve argument/docstring consistency.

	* faces.el (list-faces-display): Improve the formatting by
	computing the maximum length required for any face-name (reworked
	patch of 1999-01-11, accidentally deleted on 1999-07-21).
	(internal-find-face): Remove redundant info in docstring.

2005-06-01  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-set-gud-minor-mode-1)
	(gdb-info-breakpoints-custom, gdb-delete-breakpoint)
	(gdb-goto-breakpoint, gdb-source-info, gdb-get-location)
	(gdb-assembler-custom): Improve regexps.
	(def-gdb-auto-update-handler): Use window point to preserve point.

2005-05-31  Stefan Monnier  <monnier@iro.umontreal.ca>

	* thumbs.el (thumbs-mode): Fix misuse of make-variable-buffer-local.

2005-05-31  Jay Belanger  <belanger@truman.edu>

	* calc/calc-embed.el (calc-embedded-word): Change argument passed
	to calc-embedded.
	(calc-embedded-make-info): Have plain prefix argument select
	entire line.

2005-05-31  Juanma Barranquero  <lekktu@gmail.com>

	* faces.el (list-faces-display): Signal error if passed a regexp
	that matches no face name.

	* simple.el (filter-buffer-substring): Fix typo in docstring.

2005-05-31  Richard M. Stallman  <rms@gnu.org>

	* progmodes/vhdl-mode.el (vhdl-fill-region): Test ARG, not INTERACTIVE.
	(vhdl-emacs-21): Doc fix.
	(vhdl-mode): Unconditionally set comment-padding.
	(vhdl-fixup-whitespace-region): Insert spaces only where
	there are none.
	(vhdl-statistics-buffer): Make the Emacs 21 behavior universal.

2005-05-30  John Wiegley  <johnw@newartisans.com>

	* eshell/em-cmpl.el, eshell/em-dirs.el, eshell/em-glob.el
	* eshell/em-unix.el, eshell/esh-ext.el, eshell/esh-io.el
	* eshell/esh-util.el, eshell/esh-var.el: Change all uses of
	`directory-sep-char' to ?/, and all uses of `string-to-int' to
	`string-to-number'.

2005-05-30  Jay Belanger  <belanger@truman.edu>

	* calc/calc.el (calc-bug-address): Fix docstring.
	(calc-window-hook, calc-trail-window-hook): New variables.
	(calc-trail-display): Restore use of calc-trail-window-hook.
	(calc): Restore use of calc-window-hook.

2005-05-31  Masatake YAMATO  <jet@gyve.org>

	* emacs-lisp/find-func.el (find-function-noselect): Handle subroutines.

	* help-fns.el (help-C-file-name): Add autoload mark for
	`find-function-noselect'.

2005-05-30  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/tex-mode.el (tex-compile-commands, tex-compile)
	(tex-start-tex): Undo all but the last part of the 2005-05-28 change.

2005-05-30  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* calendar/diary-lib.el (mark-included-diary-files): Only kill
	included diary buffer if it was not already being visited.
	Reported by Stephen Berman <Stephen.Berman@gmx.net>.

	* calendar/icalendar.el (top-level): Do not require 'appt.

	* mail/supercite.el (sc-select-attribution): Only use a list
	element from sc-attrib-selection-list if it returns a string.
	Reported by Davide G. M. Salvetti <salve@debian.org>.

2005-05-30  Juanma Barranquero  <lekktu@gmail.com>

	* thumbs.el (thumbs-thumbname): The resulting thumbname now
	includes a hash value to improve its uniqueness, and has a ".jpg"
	extension.  Also, it is now a valid filename on all systems.
	(thumbs-make-thumb): Use `let', not `let*'.
	(thumbs-show-thumbs-list): Check for JPEG availability.

2005-05-30  Richard M. Stallman  <rms@gnu.org>

	* filesets.el (filesets-menu-ensure-use-cached):
	Prevent warning when emacs-version>= is undefined.

	* printing.el (pr-interactive-n-up): Use string-to-number.

	* emulation/tpu-mapper.el: Use eval-buffer, not eval-current-buffer.

	* emacs-lisp/bytecomp.el (byte-compile-nogroup-warn):
	Warn only when name to be defined is quoted.

2005-05-30  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-toggle-breakpoint):
	Make regexp more robust.
	(gdb-display-assembler-buffer, gdb-frame-assembler-buffer):
	Force regeneration of disassembly.

2005-05-29  Jay Belanger  <belanger@truman.edu>

	* calc/calc.el (calc-user-invocation): Check if
	calc-invocation-macro is non-nil.

2005-05-29  Juri Linkov  <juri@jurta.org>

	* add-log.el (change-log-font-lock-keywords):
	Add `+' to e-mail regexp to accept mail address with keywords.

	* man.el (Man-name-regexp): Add `:' to accept qualified names.

2005-05-29  Luc Teirlinck  <teirllm@auburn.edu>

	* progmodes/inf-lisp.el (inferior-lisp-mode): Use delay-mode-hooks.

	* ielm.el (inferior-emacs-lisp-mode): Ditto.

2005-05-29  Richard M. Stallman  <rms@gnu.org>

	* textmodes/flyspell.el (flyspell-auto-correct-previous-word):
	Undo the change that moves to end of the current word.

2005-05-29  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-memory-set-repeat-count):
	Throw error when count <= 0 to ensure input is a number.
	(gdb-read-memory-custom): Pick up address from buffer.
	(gdb-memory-mode): Allow user to increment and decrement
	memory address from header line.

2005-05-29  Richard M. Stallman  <rms@gnu.org>

	* flyspell.el (flyspell-version): Function deleted.
	(flyspell-auto-correct-previous-hook): Doc fix.

	* jit-lock.el (jit-lock-function, jit-lock-after-change):
	Do nothing if memory is full.

	* font-lock.el (font-lock-fontify-syntactically-region):
	Pass t for GREEDY to looking-back.

	* saveplace.el (save-place-alist-to-file): Write the file
	using write-region.

	* subr.el (looking-back): New argument GREEDY.

	* progmodes/compile.el (compilation-start): Set the mode
	before inserting the initial text.

	* progmodes/which-func.el (which-func-update-1): Turn the mode
	off in case of error by setting which-func-mode.

2005-05-29  Peter Heslin  <p.j.heslin@durham.ac.uk>  (tiny change)

	* flyspell.el (flyspell-auto-correct-previous-word):
	Narrow down to what's on the screen, and recenter overlays
	at the end of the next word.

2005-05-29  Manuel Serrano  <Manuel.Serrano@sophia.inria.fr>

	* flyspell.el (flyspell-emacs, flyspell-use-local-map): Vars moved up.
	(flyspell-default-delayed-commands): Add backward-delete-char-untabify.
	(flyspell-abbrev-p): Default to nil.
	(flyspell-use-global-abbrev-table-p): Doc fix.
	(flyspell-large-region): Allow nil as value.
	(flyspell-use-meta-tab, flyspell-auto-correct-binding): New variables.

	(mail-mode-flyspell-verify): More robust handling
	of `mail-header-separator'.  More efficient signature detection.
	Allow for regexp metacharacters in message-header-separator.
	Adding `To' not to be checked in mail-mode-flyspell-verify.

	(flyspell-prog-mode): Run flyspell-prog-mode-hook.
	(flyspell-mouse-map): Bind M-TAB only if flyspell-use-meta-tab.
	Bind flyspell-auto-correct-binding.
	Bind C-. and C-, .
	(flyspell-mode-map): Likewise.
	(flyspell-mode): Doc fix.
	(flyspell-accept-buffer-local-defs): Preserve current buffer.
	(flyspell-mode-on): Bind flyspell-mouse-map and flyspell-mode-map.
	(flyspell-word-cache-result): New var, always local.
	(flyspell-check-pre-word-p): Doc fix.
	(flyspell-check-changed-word-p): Handle spc like newline.
	(flyspell-post-command-hook): Set flyspell-word-cache-result.
	(flyspell-word-search-backward, flyspell-word-search-forward):
	New functions.
	(flyspell-word): Return t if nothing to check.
	When parsing TeX code, check for after } or \.
	Use flyspell-word-search-backward to find previous word.
	Return nil if duplicated word.
	For word already checked, return same value as last time.
	Set flyspell-word-cache-result after checking.
	Don't clobber the return value.
	(flyspell-get-word): Major rewrite.
	(flyspell-external-point-words): New locals pword, pcount.
	Fix size used in progress message.
	Find the proper corresponding word in flyspell-large-region-buffer.
	(flyspell-region): Check for flyspell-large-region = nil.
	(flyspell-highlight-incorrect-region): Clean up overlays in region.
	(flyspell-auto-correct-word): Check that WORD is a cons.
	(flyspell-correct-word): Likewise.

2005-05-29  Daniel Pfeiffer  <occitan@esperanto.org>

	* progmodes/make-mode.el (makefile-rule-action-regex)
	(makefile-macroassign-regex, makefile-makepp-mode)
	(makefile-bsdmake-mode): Continuation lines may be empty.
	Reported by Joshua Varner.
	(makefile-makepp-font-lock-keywords): Add $(stem).

2005-05-28  Karl Berry  <karl@gnu.org>

	* textmodes/tex-mode.el: Now that tex-send-command calls
	shell-quote-argument (2005-03-31 change), remove all calls to
	shell-quote-argument; they all end up invoking tex-send-command.
	The double quoting loses on filenames with non-safe characters,
	such as "@".  Reported by Frederik Fouvry.

2005-05-29  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-assembler-custom): Be more careful
	about preserving point.

2005-05-27  Jay Belanger  <belanger@truman.edu>

	* calc/calc-misc.el (calc-info-goto-node): Use info instead of
	Info-goto-node.

	* calc/calc-embed.el (calc-embed-arg): New variable.
	(calc-do-embedded-activate, calc-embedded-activate-formula)
	(calc-embedded-edit, calc-do-embedded-activate): Replace undeclared
	variable by new variable.
	(calc-embedded-make-info): Replace undeclared variable by new
	variable.  When selecting region with positive prefix
	argument, use end of previous line instead of beginning of line.

	* calc/calc-aent.el (calc-arg-values): Declare it.

	* calc/calc-ext.el (calc-help-map, calc-alg-map, calc-alg-esc-map):
	Declare them.

	* calc/calc-stuff.el (math-decls-cache-tag): Declare it.

	* calc/calc.el (calc-alg-map): Declare it.

	* calc/calcalg2.el (math-decls-cache, math-decls-all): Declare them.

2005-05-28  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-all-registers): New variable.
	(gdb-registers-buffer, toggle-gdb-all-registers):
	Toggle display of floating point registers.
	(gdb-registers-mode-map): Bind SPC to toggle-gdb-all-registers.

	* progmodes/gud.el (gud-goto-info): Use info.  Don't use require.
	(toggle-gud-tooltip-dereference):
	Rename from gud-toggle-tooltip-dereference.

2005-05-27  Stefan Monnier  <monnier@iro.umontreal.ca>

	* info.el (Info-goto-node): Revert autoload addition (2004-06-12).

2005-05-27  Jay Belanger  <belanger@truman.edu>

	* calc/calc-prog.el (calc-kbd-report): Remove.
	(calc-kbd-query): Rewrite.

2005-05-27  Juanma Barranquero  <lekktu@gmail.com>

	* image.el (image-library-alist): Move to image.c.
	(image-type-available-p): Doc fix.

2005-05-27  Lute Kamstra  <lute@gnu.org>

	* calc/calc.el (calc):
	* outline.el (outline-1, outline-2, outline-3, outline-4)
	(outline-5, outline-6, outline-7, outline-8):
	* textmodes/dns-mode.el (dns-mode):
	* textmodes/sgml-mode.el (sgml-namespace-face):
	* textmodes/tex-mode.el (superscript, subscript, tex-math-face)
	(tex-verbatim-face, tex-use-reftex):
	* textmodes/texinfo.el (texinfo-heading-face):
	Specify customization group.

	* longlines.el: Don't require easy-mmode.
	(longlines-visible-face): Specify customization group.

2005-05-27  Kenichi Handa  <handa@m17n.org>

	* language/cyrillic.el: Add cyrillic-iso8859-5 characters in the
	encoding table of windows-1251.

	* international/ucs-tables.el (ucs-set-table-for-input):
	If translation-table-for-input of a coding system is a symbol, get
	its translation-table property.

	* international/code-pages.el: Don't register a coding system into
	non-iso-charset-alist more than once.
	(cp-make-coding-system): Likewise.

2005-05-26  John Wiegley  <johnw@newartisans.com>

	* eshell/esh-cmd.el (eshell-eval-command): If the return value of
	`eshell-resume-eval' is wrapped in a list, it indicates that the
	command was run asynchronously.  In that case, unwrap the value
	before checking the delimiter value.

	* eshell/em-cmpl.el (eshell-complete-parse-arguments): If the
	character before a space at the end of a line is \, assume the space
	is part of the last argument rather than a final argument separator.

	* eshell/esh-io.el (eshell-get-target): If `eshell-buffer-shorthand'
	is in use, and the target is `t' or `nil' (which are the most common
	values), don't assume that the symbol target is a buffer.

2005-05-26  Luc Teirlinck  <teirllm@auburn.edu>

	* calendar/calendar.el (calendar-mode-line-format):
	Use mode-line-highlight as mouse-face.

	* time.el (display-time-string-forms, display-time-update):
	Use mode-line-highlight as mouse-face.

2005-05-26  Jay Belanger  <belanger@truman.edu>

	* calc/calc.el (calc-language-alist): Remove extra defvar.

2005-05-26  Lute Kamstra  <lute@gnu.org>

	* arc-mode.el (archive-mode):
	* bookmark.el (bookmark-read-annotation-mode)
	(bookmark-edit-annotation-mode, bookmark-bmenu-mode):
	* bs.el (bs-mode):
	* calc/calc-yank.el (calc-edit-mode):
	* calc/calc.el (calc-mode, calc-trail-mode):
	* calculator.el (calculator-mode):
	* chistory.el (command-history-mode):
	* comint.el:
	* cus-edit.el (custom-mode):
	* descr-text.el (describe-text-mode):
	* ebuff-menu.el (Electric-buffer-menu-mode):
	* ediff-util.el (ediff-mode):
	* emacs-lisp/re-builder.el (reb-mode):
	* emulation/vi.el (vi-mode-setup):
	* emulation/ws-mode.el (wordstar-mode):
	* eshell/esh-mode.el (eshell-mode):
	* forms.el (forms-mode):
	* help-mode.el (help-mode):
	* hexl.el (hexl-mode):
	* ibuffer.el (ibuffer-mode):
	* ielm.el (inferior-emacs-lisp-mode):
	* info.el (Info-mode, Info-edit-mode):
	* international/swedish.el:
	* ledit.el (ledit-from-lisp-mode):
	* locate.el (locate-mode):
	* mail/rmail.el (rmail-mode):
	* mail/rmailedit.el (rmail-edit-mode):
	* mail/rmailsum.el (rmail-summary-mode):
	* mail/supercite.el (sc-electric-mode):
	* net/eudc.el (eudc-mode):
	* net/quickurl.el (quickurl-list-mode):
	* net/snmp-mode.el (snmp-mode, snmpv2-mode):
	* obsolete/ooutline.el (outline-mode):
	* obsolete/options.el (Edit-options-mode):
	* obsolete/rnews.el (news-mode):
	* obsolete/rnewspost.el (news-reply-mode):
	* play/5x5.el (5x5-mode):
	* play/decipher.el (decipher-mode, decipher-stats-mode):
	* play/gomoku.el (gomoku-mode):
	* play/snake.el (snake-mode):
	* play/solitaire.el (solitaire-mode):
	* play/tetris.el (tetris-mode):
	* progmodes/ada-mode.el (ada-mode):
	* progmodes/antlr-mode.el (antlr-mode):
	* progmodes/autoconf.el (autoconf-mode):
	* progmodes/dcl-mode.el (dcl-mode):
	* progmodes/delphi.el (delphi-mode):
	* progmodes/ebrowse.el (ebrowse-tree-mode)
	(ebrowse-electric-list-mode, ebrowse-member-mode)
	(ebrowse-electric-position-mode):
	* progmodes/f90.el (f90-mode):
	* progmodes/fortran.el (fortran-mode):
	* progmodes/icon.el (icon-mode):
	* progmodes/idlw-help.el (idlwave-help-mode):
	* progmodes/idlw-shell.el (idlwave-shell-mode):
	* progmodes/idlwave.el (idlwave-mode):
	* progmodes/inf-lisp.el (inferior-lisp-mode):
	* progmodes/m4-mode.el (m4-mode):
	* progmodes/meta-mode.el (metafont-mode, metapost-mode):
	* progmodes/modula2.el (modula-2-mode):
	* progmodes/octave-inf.el (inferior-octave-mode):
	* progmodes/octave-mod.el (octave-mode):
	* progmodes/pascal.el (pascal-mode):
	* progmodes/sh-script.el (sh-mode):
	* progmodes/sql.el (sql-mode, sql-interactive-mode):
	* progmodes/vhdl-mode.el (vhdl-mode):
	* progmodes/xscheme.el (scheme-interaction-mode):
	* replace.el (occur-mode):
	* ses.el (ses-mode):
	* simple.el (completion-list-mode):
	* skeleton.el:
	* speedbar.el (speedbar-mode):
	* term.el (term-mode):
	* terminal.el (terminal-edit-mode):
	* textmodes/reftex-index.el (reftex-index-mode)
	(reftex-index-phrases-mode):
	* textmodes/reftex-sel.el (reftex-select-label-mode)
	(reftex-select-bib-mode):
	* textmodes/reftex-toc.el (reftex-toc-mode):
	* wdired.el (wdired-change-to-wdired-mode):
	* wid-browse.el (widget-browse-mode):
	Use run-mode-hooks.

	* array.el (array-mode):
	* calendar/todo-mode.el (todo-mode):
	* man.el (Man-mode):
	* play/landmark.el (lm-mode):
	* play/mpuz.el (mpuz-mode):
	Use kill-all-local-variables and run-mode-hooks.

	* subr.el (delay-mode-hooks): Specify indentation.

2005-05-26  Mark A. Hershberger  <mah@everybody.org>

	* xml.el (xml-substitute-special): Don't die for undefined xml entities.

2005-05-26  Jay Belanger  <belanger@truman.edu>

	* calc/calc-prog.el (calc-user-define-edit): Don't find substring
	of nil.

2005-05-27  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-frame-address):
	Rename from gdb-current-address.
	(gdb-previous-frame-address): Rename from gdb-previous-address.
	(gdb-selected-frame): Rename from gdb-current-frame.
	(gdb-get-selected-frame): Rename from gdb-get-current-frame.
	(gdb-frame-number): Rename from gdb-current-stack-level.
	(gdb-ann3): Match new mode-name for disassembly buffer.
	Extend initialization of variables.
	(gdb-post-prompt): Update disassembly from gdb-frame-handler.
	(gdb-memory-mode): Use mouse-face in header line.
	(gdb-assembler-buffer-name): Call it disassembly and give frame
	in mode line.
	(gdb-source-spec-regexp, gdb-assembler-custom)
	(gdb-invalidate-assembler, gdb-frame-handler):
	Make robust to leading zeroes in address format.

2005-05-26  Carsten Dominik  <dominik@science.uva.nl>

	* textmodes/org.el (org-mode): Use `define-derived-mode' to
	define `org-mode'.
	(org-agenda-mode): Use `run-mode-hooks' instead of `run-hooks'.

2005-05-26  Stefan Monnier  <monnier@iro.umontreal.ca>

	* log-edit.el (log-edit-changelog-entries): Distinguish between
	filenames like xfns.c and fns.c.

2005-05-25  Luc Teirlinck  <teirllm@auburn.edu>

	* buff-menu.el (Buffer-menu-revert-function): Improve handling of
	point after reverting.
	(Buffer-menu-make-sort-button): Handle the case where
	`Buffer-menu-use-header-line' is nil.

2005-05-25  Thien-Thi Nguyen  <ttn@gnu.org>

	* vms-patch.el (vms-magic-right-square-brace, vms-magic-colon):
	New funcs.  In minibuffer-local-completion-map bind `]', `/'
	and `:' to them.

2005-05-25  Stefan Monnier  <monnier@iro.umontreal.ca>

	* startup.el (normal-top-level): Allow modification of load-path while
	we're iterating over it.

2005-05-25  Juanma Barranquero  <lekktu@gmail.com>

	* thumbs.el (thumbs-thumbsdir-max-size, thumbs-temp-file)
	(thumbs-cleanup-thumbsdir, thumbs-call-convert)
	(thumbs-resize-interactive, thumbs-insert-image)
	(thumbs-insert-thumb, thumbs-dired-show-marked)
	(thumbs-find-image-at-point, thumbs-delete-images)
	(thumbs-rename-images, thumbs-next-image, thumbs-dired-setroot)
	(thumbs-increment-image-size, thumbs-decrement-image-size):
	Fix typos in docstrings.

2005-05-24  Andre Spiegel  <spiegel@gnu.org>

	* progmodes/cperl-mode.el (cperl-vc-header-alist): Obsolete.
	(cperl-vc-rcs-header, cperl-vc-sccs-header): New user options.
	(cperl-mode): Use them.

2005-05-24  Juanma Barranquero  <lekktu@gmail.com>

	* window.el (quit-window, shrink-window-if-larger-than-buffer):
	Doc fixes.

2005-05-24  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-inferior-io-mode-map):
	Bind C-d to gdb-inferior-io-eof.

	* dired.el (dired-dnd-popup-notice): Use message-box.

2005-05-23  Masatake YAMATO  <jet@gyve.org>

	* bindings.el (mode-line-major-mode-keymap):
	Bind [mode-line down-mouse-1] to `mouse-major-mode-menu'.

	* faces.el (mode-line-highlight): New face.

	* ruler-mode.el (ruler-mode-ruler): Use mode-line-highlight
	as mouse-face.

	* bindings.el (top-level, help-echo, mode-line-modified)
	(mode-line-mule-info, mode-line-eol-desc): Use mode-line-highlight
	as mouse-face.

2005-05-23  Juanma Barranquero  <lekktu@gmail.com>

	* progmodes/cc-engine.el (c-guess-basic-syntax):
	Remove spurious call to `zerop'.

	* emacs-lisp/cl.el (acons, pairlis): Add docstring.

2005-05-23  Martin Stjernholm  <bug-cc-mode@gnu.org>

	CC Mode update to 5.30.10:

	* cc-fonts.el (c-font-lock-declarators): Fix bug where the point
	could go past the limit in decoration level 2, thereby causing
	errors during interactive fontification.

	* cc-mode.el (c-make-inherited-keymap): Fix cc-bytecomp bug when
	the file is evaluated interactively.

	* cc-engine.el (c-guess-basic-syntax): Handle operator
	declarations somewhat better in C++.

	* cc-styles.el, cc-mode.el (c-run-mode-hooks): New helper macro to
	make use of `run-mode-hooks' which has been added in Emacs 21.1.
	(c-mode, c++-mode, objc-mode, java-mode, idl-mode, pike-mode)
	(awk-mode): Use it.
	(make-local-hook): Suppress warning about obsoleteness.

	* cc-engine.el, cc-align.el, cc-cmds.el
	(c-append-backslashes-forward, c-delete-backslashes-forward)
	(c-find-decl-spots, c-semi&comma-no-newlines-before-nonblanks):
	Compensate for return value from `forward-line' when it has moved
	but not to a different line due to eob.

	* cc-engine.el (c-guess-basic-syntax): Fix anchoring in
	`objc-method-intro' and `objc-method-args-cont'.

2005-05-23  Alan Mackenzie  <bug-cc-mode@gnu.org>

	CC Mode update to 5.30.10:

	* cc-mode.el, cc-engine.el, cc-align.el: Change the FSF's address
	in the copyright statement.  Incidentally, change "along with GNU
	Emacs" to "along with this program" where it occurs.

	* cc-mode.el: Add a fourth parameter `t' to the awk-mode autoload,
	so that it is interactive, hence can be found by M-x awk-mode
	whilst cc-mode is yet to be loaded.  Reported by Glenn Morris
	<gmorris+emacs@ast.cam.ac.uk>.

	* cc-awk.el: Add character classes (e.g. "[:alpha:]") into AWK
	Mode's regexps.

2005-05-23  Kevin Ryde  <user42@zip.com.au>

	* cc-align.el (c-lineup-argcont): Ignore conses for {} pairs from
	c-parse-state, to avoid a lisp error (on bad code).

2005-05-23  Lute Kamstra  <lute@gnu.org>

	* subr.el (font-lock-defaults): Remove defvar as it's already
	defined in font-core.el.

	* font-lock.el (font-lock-beginning-of-syntax-function): Fix docstring.

2005-05-23  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-info-locals-handler): Make regexps
	more general and work when GDB variable "print pretty" is on,
	as with Emacs, for example.

2005-05-22  Luc Teirlinck  <teirllm@auburn.edu>

	* font-core.el: Update comment.

	* emacs-lisp/easy-mmode.el (define-global-minor-mode):
	Use `after-change-major-mode-hook' instead of `find-file-hook'.

	* buff-menu.el (Buffer-menu-mode): Use `run-mode-hooks'.

2005-05-22  Eli Zaretskii  <eliz@gnu.org>

	* simple.el (yank, yank-pop): Mention `yank-excluded-properties'
	and `yank-handler' in the doc strings.

2005-05-22  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/cl.el (eql): Remove.  It's a builtin already.

2005-05-22  Richard M. Stallman  <rms@gnu.org>

	* help.el (describe-key): Move print-help-return-message call
	out of conditional.

	* progmodes/etags.el (list-tags): Use with-no-warnings.

	* mail/smtpmail.el (smtpmail-open-stream): Use with-no-warnings.
	(smtpmail-send-queued-mail): Avoid beginning-of-buffer.
	(starttls-extra-args, starttls-extra-arguments): Add defvars.

	* mail/mailalias.el (mail-get-names): Avoid beginning-of-buffer.

	* language/viet-util.el (viet-viscii-nonascii-translation-table):
	Add defvar.

	* emulation/viper-ex.el (viper-ex-work-buf, viper-ex-print-buf):
	Use defvar, not defconst.

	* hexl.el (hexl-follow-line): Use with-no-warnings.

	* emulation/tpu-extras.el: Use write-file-functions instead of
	write-file-hooks.

	* dired.el (dired-font-lock-keywords): Fontify files with junk
	extensions even if marked by -F.

2005-05-22  Juanma Barranquero  <lekktu@gmail.com>

	* emacs-lisp/cl.el (pushnew, cl-macroexpand, floatp-safe, plusp)
	(minusp, oddp, evenp, mapcar*, list*, copy-list, adjoin, subst):
	* emacs-lisp/cl-extra.el (coerce, map, maplist, cl-mapc, mapl)
	(mapcan, mapcon, some, every, notany, notevery, signum, isqrt)
	(concatenate, list-length, get*, getf, cl-remprop):
	* emacs-lisp/cl-macs.el (function*, case, ecase, typecase)
	(etypecase, progv, lexical-let, lexical-let*)
	(multiple-value-bind, multiple-value-setq, shiftf):
	Improve argument/docstring consistency.

	* subr.el (focus-frame, unfocus-frame):
	Revert deletion on 2005-05-01.

2005-05-22  Andre Spiegel  <spiegel@gnu.org>

	* vc-cvs.el (vc-cvs-checkout-model): Handle the case where FILE
	doesn't exist.

	* vc.el (vc-trunk-p): Add autoload cookie.  The function is used in
	vc-rcs.el when vc-mistrust-permissions is t, which is not the default.

2005-05-22  Nick Roberts  <nickrob@snap.net.nz>

	* emacs-lisp/bytecomp.el: Remove make-obsolete-variable for
	already deleted variables: auto-fill-hook, blink-paren-hook,
	lisp-indent-hook, inhibit-local-variables, unread-command-event,
	suspend-hooks, comment-indent-hook, meta-flag,
	before-change-function, after-change-function,
	font-lock-doc-string-face.

2005-05-21  Luc Teirlinck  <teirllm@auburn.edu>

	* emacs-lisp/derived.el (define-derived-mode): Doc fix.

2005-05-21  Eli Zaretskii  <eliz@gnu.org>

	* mail/rmail.el (rmail-reply): Filter the list in reply-to through
	rmail-dont-reply-to.

2005-05-21  Frederik Fouvry  <fouvry@CoLi.Uni-SB.DE>

	* mail/sendmail.el (mail-send): Use [[:space:]] instead of a
	literal blank when splitting new-header-values.

2005-05-21  Matt Hodges  <MPHodges@member.fsf.org>

	* calendar/cal-menu.el (cal-menu-update): Add separator as a
	string so that tmm doesn't create a completion entry for it.

	* textmodes/table.el (table-disable-menu): Ditto.

2005-05-21  Richard M. Stallman  <rms@gnu.org>

	* progmodes/idlwave.el (idlwave-doc-header): Use insert-file-contents.

	* progmodes/flymake.el (flymake-makehash): Use with-no-warnings.

	* net/rcompile.el (remote-compile): Use compilation-start.

	* tmm.el (tmm-shortcut): Avoid using beginning-of-buffer.

2005-05-21  Daniel Pfeiffer  <occitan@esperanto.org>

	* files.el (auto-mode-alist): Check GNUmakefile before makefile.
	Default to makefile-bsdmake-mode on BSD systems.

	* imenu.el (imenu-generic-expression, imenu--generic-function'):
	REGEXP may also be a search function now.  The part of doc-string
	for describing the structure was 95% identical to that of
	`imenu--generic-function'.  Unify it there.

	* progmodes/make-mode.el (makefile-imenu-generic-expression):
	Use function to find dependencies, because regexp alone is so complex,
	it easily goes into an endless loop.
	(makefile-makepp-mode): Also add submenu for Perl functions
	defined in the makefile.
	(makefile-bsdmake-mode): Special imenu-generic-expression no
	longer needed, due to function call.
	(makefile-match-dependency): Take BOUND into account when checking
	if we're through.

2005-05-20  Jay Belanger  <belanger@truman.edu>

	* calc/calc-units.el (calc-invalidate-units-table):
	Use inhibit-read-only.
	(math-build-units-table-buffer): Use view-mode.

2005-05-20  David Kastrup  <dak@gnu.org>

	* emacs-lisp/easymenu.el (easy-menu-add): Correct docstring since
	easy-menu-add is not a nop on Emacs; and clarify when to call it.

2005-05-20  Lute Kamstra  <lute@gnu.org>

	* diff-mode.el (diff-header-face, diff-file-header-face)
	(diff-index-face, diff-hunk-header-face, diff-removed-face)
	(diff-added-face, diff-changed-face, diff-function-face)
	(diff-context-face, diff-nonexistent-face): Put them in the
	diff-mode customization group.

2005-05-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/vhdl-mode.el (vhdl-font-lock-match-item): Simplify regexp.

	* progmodes/sh-script.el (sh-mode, sh-get-word): Minor regexp fixes.

	* font-lock.el (lisp-font-lock-keywords-2): Don't error.
	Minor regexp-optimization.

2005-05-20  Carsten Dominik  <dominik@science.uva.nl>

	* textmodes/org.el (org-agenda-toggle-time-grid): New command.
	(org-agenda-use-time-grid, org-agenda-time-grid): New options.
	(org-agenda-add-time-grid-maybe): New function.
	(org-agenda): Call `org-agenda-add-time-grid-maybe'.
	(org-table-create): `dotimes' instead of `mapcar'.
	(org-xor): Simplify implementation.
	(org-agenda): `inhibit-redisplay' turned on.
	(org-agenda-change-all-lines): Use `org-format-agenda-item' to get
	a consistent line after a state change.
	(org-agenda-remove-times-when-in-prefix): New option.
	(org-prefix-has-time): New variable.
	(org-parse-time-string): Optional argument NODEFAULT.
	(org-format-agenda-item): Parse items for time-of-day
	specifications and move these into the prefix if possible.
	(org-agenda-priority): Get current heading, not previous heading
	during agenda remote editing.

2005-05-20  Juanma Barranquero  <lekktu@gmail.com>

	* emacs-lisp/cl-seq.el (reduce, fill, replace, remove*)
	(remove-if, remove-if-not, delete*, delete-if, delete-if-not)
	(remove-duplicates, delete-duplicates, substitute)
	(substitute-if, substitute-if-not, nsubstitute, nsubstitute-if)
	(nsubstitute-if-not, find, find-if, find-if-not, position)
	(position-if, position-if-not, count, count-if, count-if-not)
	(mismatch, search, sort*, stable-sort, merge, member*)
	(member-if, member-if-not, assoc*, assoc-if, assoc-if-not)
	(rassoc*, rassoc-if, rassoc-if-not, union, nunion)
	(intersection, nintersection, set-difference, nset-difference)
	(set-exclusive-or, nset-exclusive-or, subsetp, subst-if)
	(subst-if-not, nsubst, nsubst-if, nsubst-if-not, sublis)
	(nsublis, tree-equal): Improve argument/docstring consistency.

	* subr.el (send-string, send-region):
	Remove obsolescence declaration.
	(window-dot, set-window-dot, read-input, show-buffer)
	(eval-current-buffer, string-to-int):
	Add release number to obsolescence declarations.

2005-05-19  Kim F. Storm  <storm@cua.dk>

	* ido.el (ido-magic-forward-char): Enter ido-find-file at end of input.
	(ido-magic-backward-char): Enter ido-switch-buffer at start of input.

2005-05-20  Matt Hodges  <MPHodges@member.fsf.org>

	* faces.el (list-faces-display): Make back button respect optional
	regexp arg.

2005-05-19  Juanma Barranquero  <lekktu@gmail.com>

	* calculator.el (calculator-radix-grouping-mode)
	(calculator-radix-grouping-digits, calculator-displayer)
	(calculator-radix-grouping-separator, calculator-copy-displayer):
	* dabbrev.el (dabbrev-search-these-buffers-only):
	* diff-mode.el (diff-jump-to-old-file, diff-update-on-the-fly)
	(diff-advance-after-apply-hunk, diff-mode-hook)
	(diff-minor-mode-prefix):
	* imenu.el (imenu-use-popup-menu):
	* jit-lock.el (jit-lock-context-time):
	* newcomment.el (comment-fill-column, comment-column)
	(comment-style, comment-padding, comment-multi-line)
	(comment-empty-lines, comment-auto-fill-only-comments):
	* reveal.el (reveal-around-mark):
	* uniquify.el (uniquify-buffer-name-style)
	(uniquify-after-kill-buffer-p)
	(uniquify-ask-about-buffer-names-p, uniquify-ignore-buffers-re)
	(uniquify-min-dir-content, uniquify-separator)
	(uniquify-trailing-separator-p, uniquify-strip-common-suffix):
	* w32-vars.el (w32-fixed-font-alist):
	* emacs-lisp/testcover.el (testcover-potentially-1value-functions):
	* obsolete/rsz-mini.el (resize-minibuffer-frame-max-height):
	* progmodes/antlr-mode.el (antlr-font-lock-maximum-decoration):
	* progmodes/perl-mode.el (perl-indent-level)
	(perl-continued-statement-offset, perl-continued-brace-offset)
	(perl-brace-offset, perl-brace-imaginary-offset)
	(perl-label-offset, perl-indent-continued-arguments)
	(perl-tab-always-indent, perl-tab-to-comment, perl-nochange):
	* progmodes/tcl.el (tcl-indent-level)
	(tcl-continued-indent-level, tcl-auto-newline)
	(tcl-tab-always-indent, tcl-electric-hash-style)
	(tcl-help-directory-list, tcl-use-smart-word-finder)
	(tcl-application, tcl-command-switches, tcl-prompt-regexp)
	(inferior-tcl-source-command):
	* textmodes/fill.el (enable-kinsoku):
	* textmodes/reftex-vars.el (reftex-index-phrases-wrap-long-lines):
	* textmodes/table.el (table-yank-handler):
	Specify missing group (and type, if simple) in defcustom.

2005-05-19  Luc Teirlinck  <teirllm@auburn.edu>

	* progmodes/compile.el (compilation-finish-function): Fix defvar.

2005-05-19  Richard M. Stallman  <rms@gnu.org>

	* progmodes/make-mode.el (makefile-mode): Use run-mode-hooks.

	* subr.el (event-basic-type): Don't get an error.
	(left-fringe-p): Function deleted.

	* buff-menu.el (Buffer-menu-buffer-face): In group Buffer-menu.
	(list-buffers-noselect): Set `font-lock-face' property, not `face'.

	* dired-aux.el (dired-copy-file-recursive): Handle symlinks
	in recursive copy.

	* frame.el (show-trailing-whitespace): In group `whitespace-faces'.

	* emacs-lisp/byte-run.el (eval-when-compile): Doc fix.

	* emacs-lisp/bytecomp.el (byte-compile-file-form-custom-declare-variable):
	Call byte-compile-nogroup-warn if appropriate.

	* progmodes/compile.el (compilation-finish-function): Mark obsolete.
	(compilation-set-window): Don't call left-fringe-p; do it directly.

2005-05-19  Jay Belanger  <belanger@truman.edu>

	* calc/calc-graph.el (calc-graph-format-data): Make sure
	var-PlotRejects is bound before trying to check its value.

2005-05-19  Carsten Dominik  <dominik@science.uva.nl>

	* textmodes/reftex.el (reftex-isearch-minor-mode): Move the
	definition of this variable from reftex-global.el to reftex.el,
	because it is needed in the menu.

2005-05-19  Lute Kamstra  <lute@gnu.org>

	* emacs-lisp/copyright.el (copyright-fix-years): Make sure all
	years are fixed.  Don't insert a space after a dash.

2005-05-19  Kim F. Storm  <storm@cua.dk>

	* emulation/crisp.el (crisp-home, crisp-end): Put CUA property.

2005-05-19  Daniel Pfeiffer  <occitan@esperanto.org>

	* font-lock.el (lisp-font-lock-keywords-2): Do \\) only in
	strings, because (eq ... ?\\) is fairly frequent.

	* progmodes/make-mode.el (makefile-add-this-line-targets):
	Simplify and integrate into `makefile-pickup-targets'.
	(makefile-add-this-line-macro): Simplify and integrate into
	`makefile-pickup-macros.
	(makefile-pickup-filenames-as-targets): Simplify.
	(makefile-previous-dependency, makefile-match-dependency):
	Don't stumble over `::'.

2005-05-19  Nick Roberts  <nickrob@snap.net.nz>

	* subr.el (post-command-idle-hook, post-command-idle-delay):
	Remove obsoletion of post-command-idle-hook and
	post-command-idle-delay.

	* faces.el (list-faces-display): Provide button when describe-face
	is called to take user back to the list of faces.

	* help-fns.el (describe-variable): Remove hyperlinks in a
	variable's value as these are quite frequently inappropriate.

	* follow.el (follow-submit-feedback, follow-mode):
	Remove references to post-command-idle-hook.

2005-05-18  Daniel Pfeiffer  <occitan@esperanto.org>

	* progmodes/make-mode.el (makefile-previous-dependency)
	(makefile-match-dependency): Check for := (and in bsd mode also
	!=) to give a better result, even when font-lock is not on.

2005-05-18  Jay Belanger  <belanger@truman.edu>

	* calc/calc-help.el (calc-s-prefix-help):
	Add `calc-copy-special-constant' to help string.

2005-05-18  Luc Teirlinck  <teirllm@auburn.edu>

	* emacs-lisp/eldoc.el (eldoc-mode): Doc fix.

2005-05-18  Jay Belanger  <belanger@truman.edu>

	* calc/calc-poly.el (math-factor-poly-coefs): Make sure the terms
	in linear factors are in proper order.

2005-05-18  Carsten Dominik  <dominik@science.uva.nl>

	* textmodes/reftex-vars.el (reftex-cite-format-builtin):
	Support for jurabib.

	* textmodes/reftex.el (featurep): Define aliases for overlay
	commands, for XEmacs compatibility, and use these aliases in
	overlay initializations.
	(reftex-highlight): Use `reftex-move-overlay'.
	(reftex-unhighlight): Use `reftex-delete-overlay'.
	(reftex-uniq): Function removed.  Use `reftex-uniquify' instead.
	(reftex-access-search-path): Use `reftex-uniquify' instead of
	`reftex-uniq'

	* textmodes/reftex-sel.el (reftex-select-unmark):
	Overlay `before-string' property modification enables for Emacs as well.
	(reftex-select-item): Use `reftex-delete-overlay'.
	(reftex-select-mark): Use `reftex-make-overlay' and
	`reftex-overlay-put'.
	(reftex-select-unmark): Use `reftex-delete-overlay' and
	`reftex-overlay-put'.

2005-05-18  Lute Kamstra  <lute@gnu.org>

	* emacs-lisp/lisp.el (check-parens): Fix docstring.

2005-05-18  Juanma Barranquero  <lekktu@gmail.com>

	* add-log.el (add-change-log-entry):
	* array.el (array-make-template, array-reconfigure-rows)
	(array-init-max-row, array-init-max-column)
	(array-init-columns-per-line, array-init-field-width):
	* replace.el (replace-match-maybe-edit, perform-replace):
	* textmodes/spell.el (spell-region):
	Replace `read-input' by `read-string'.

	* forms.el (forms-mode):
	* finder.el (finder-compile-keywords):
	* shadowfile.el (shadow-read-files):
	Replace `eval-current-buffer' by `eval-buffer'.

	* terminal.el (te-pass-through):
	* net/ange-ftp.el (ange-ftp-process-filter, ange-ftp-gwp-filter)
	(ange-ftp-raw-send-cmd):
	* net/telnet.el (telnet-interrupt-subjob, telnet-c-z)
	(send-process-next-char, telnet-initial-filter, telnet):
	Replace `send-string' by `process-send-string'.

	* progmodes/prolog.el (inferior-prolog-mode): Doc fix.
	(prolog-consult-region): Replace `send-string' by
	`process-send-string'; replace `send-region' by `process-send-region'.

	* progmodes/delphi.el (delphi-log-msg):
	Replace `set-window-dot' by `set-window-point'.

	* subr.el (window-dot, set-window-dot, read-input, send-string)
	(send-region, show-buffer, eval-current-buffer):
	Make really obsolete, as the comment says.

2005-05-17  Kim F. Storm  <storm@cua.dk>

	* emulation/cua-base.el (cua-use-hyper-key): Doc fix.
	(cua--init-keymaps): Bind C-return instead of S-return to set
	rectangle mark.

	* emulation/cua-rect.el (cua--init-rectangles): Bind C-return
	instead of S-return to toggle/clear rectangle mark.

2005-05-17  Daniel Pfeiffer  <occitan@esperanto.org>

	* progmodes/make-mode.el (makefile-dependency-skip): New variable.
	(makefile-macroassign-regex, makefile-make-font-lock-keywords):
	Also fontify plain strings assigned to variables, mostly so that a
	colon has a face and is thus not taken as a dependency separator.
	(makefile-previous-dependency): Inline the new matcher, because it
	is too complex to work in both directions.
	(makefile-match-dependency): Eliminate `backward' arg (see above).
	Completely reimplemented so as to not sometimes go into an endless
	loop.  It should also be more efficient, because first it only
	searches for `:', instead of applying the very complex regexp.
	(makefile-mode): Cancel `font-lock-support-mode', because blocks
	to be fontified in one piece can be too long for JIT.
	Makefiles are never *that* big.

2005-05-17  Reiner Steib  <Reiner.Steib@gmx.de>

	* dired.el (dired-mode): Simplify.

2005-05-17  Lute Kamstra  <lute@gnu.org>

	* emacs-lisp/easy-mmode.el (define-minor-mode): Don't generate a
	defcustom for the mode hook variable.

	* emacs-lisp/authors.el (authors): Do parse the ChangeLogs of the
	Emacs Lisp Reference Manual.

2005-05-17  Juanma Barranquero  <lekktu@gmail.com>

	* emacs-lisp/cl.el (eql, floatp-safe, plusp, minusp, oddp)
	(evenp, list*):
	* emacs-lisp/cl-macs.el (macrolet, symbol-macrolet):
	* emacs-lisp/cl-seq.el (subsetp, tree-equal): Doc fixes.

	* net/tramp-smb.el (tramp-smb-open-connection):
	Pass `tramp-chunksize' as fifth (required) argument.

2005-05-16  Daniel Pfeiffer  <occitan@esperanto.org>

	* font-lock.el (lisp-font-lock-keywords-1):
	Set `font-lock-negation-char-face' for [^...] char group.
	(lisp-font-lock-keywords-2): Highlight regexp's \\( \\| \\).

	* progmodes/make-mode.el (makefile-dependency-regex): Turn it into
	a var, and refine it to mask one more level of nested vars.
	(makefile-rule-action-regex): Turn it into a var, and refine it so
	it recognizes backslashed continuation lines as belonging to the
	same command.
	(makefile-macroassign-regex): Refine it so it recognizes
	backslashed continuation lines as belonging to the same command.
	(makefile-var-use-regex): Don't look at the next char, because it
	might be the same one to be skipped by the initial [^$], leading
	to an overlooked variable use.
	(makefile-make-font-lock-keywords): Remove two parameters, which
	are now variables that some of the modes set locally.
	Handle dependency and rule action matching through functions, because
	regexps alone match too often.  Dependency matching now comes
	last, so it can check, whether a colon already matched something else.
	(makefile-mode): Inform that font-lock improves makefile parsing
	capabilities.
	(makefile-match-dependency, makefile-match-action): New functions.

2005-05-16  Juanma Barranquero  <lekktu@gmail.com>

	* emacs-lisp/cl-extra.el (equalp): Doc fix.

	* align.el (align-regexp):
	* ansi-color.el (ansi-color-get-face):
	* array.el (array-reconfigure-rows, array-init-max-row)
	(array-init-max-column, array-init-columns-per-line)
	(array-init-field-width):
	* dired-aux.el (dired-trample-file-versions):
	* dired-x.el (dired-mark-sexp):
	* ediff-diff.el (ediff-extract-diffs, ediff-get-diff3-group):
	* edmacro.el (edmacro-finish-edit, edmacro-parse-keys):
	* emerge.el (emerge-extract-diffs, emerge-get-diff3-group):
	* faces.el (face-read-integer):
	* files.el (backup-extract-version, insert-directory):
	* hexl.el (hexl-insert-decimal-char):
	* server.el (server-process-filter):
	* shell.el (shell-extract-num):
	* startup.el (command-line-1):
	* term.el (term-command-hook):
	* time-stamp.el (time-stamp, time-stamp-string-preprocess)
	(time-stamp-do-number):
	* time.el (display-time-update):
	* timezone.el (timezone-parse-date, timezone-zone-to-minute)
	(timezone-fix-time):
	* vms-patch.el (vms-suspend-resume-hook):
	* calendar/appt.el (appt-convert-time):
	* calendar/cal-bahai.el (mark-bahai-diary-entries):
	* calendar/cal-hebrew.el (mark-hebrew-diary-entries):
	* calendar/cal-islam.el (mark-islamic-diary-entries):
	* calendar/calendar.el (calendar-cursor-to-date)
	(calendar-star-date):
	* calendar/diary-lib.el (diary-attrtype-convert)
	(mark-diary-entries, diary-entry-time):
	* calendar/solar.el (solar-get-number):
	* emacs-lisp/lisp-mnt.el (lm-last-modified-date):
	* emacs-lisp/re-builder.el (reb-display-subexp):
	* emulation/edt.el (edt-set-scroll-margins):
	* emulation/tpu-extras.el (tpu-set-scroll-margins):
	* emulation/vip.el (vip-get-ex-token, vip-get-ex-buffer)
	(vip-get-ex-count):
	* emulation/viper-ex.el (viper-get-ex-token)
	(viper-get-ex-buffer, viper-get-ex-count, ex-next):
	* international/fontset.el (fontset-plain-name):
	* mail/feedmail.el (feedmail-look-at-queue-directory):
	* mail/mailalias.el (mail-get-names):
	* mail/rmail.el (rmail-convert-to-babyl-format):
	* mail/rmailsum.el (rmail-make-basic-summary-line)
	(rmail-summary-next-same-subject, rmail-summary-rmail-update)
	(rmail-summary-goto-msg):
	* mail/smtpmail.el (smtpmail-read-response):
	* net/ange-ftp.el (ange-ftp-guess-hash-mark-size)
	(ange-ftp-vms-add-file-entry):
	* play/gametree.el (gametree-looking-at-ply)
	(gametree-current-branch-score):
	* progmodes/ada-xref.el (ada-prj-find-prj-file)
	(ada-xref-find-in-modified-ali, ada-find-in-src-path):
	* progmodes/cperl-mode.el (condition-case):
	* progmodes/ebrowse.el (ebrowse-set-tree-indentation)
	(ebrowse-set-member-buffer-column-width)
	(ebrowse-select-1st-to-9nth):
	* progmodes/etags.el (etags-snarf-tag):
	* progmodes/flymake.el (flymake-parse-line):
	* progmodes/idlw-shell.el (idlwave-shell-parse-line)
	(idlwave-shell-filter-bp, idlwave-shell-goto-next-error)
	(idlwave-shell-menu-def):
	* progmodes/ps-mode.el (ps-run-goto-error):
	* progmodes/vhdl-mode.el (vhdl-read-offset, vhdl-load-cache)
	(vhdl-speedbar-contract-level):
	* term/mac-win.el (x-handle-numeric-switch):
	* term/sun-mouse.el (sun-get-frame-data):
	* term/w32-win.el (x-handle-numeric-switch):
	* term/x-win.el (x-handle-numeric-switch):
	* textmodes/ispell.el (ispell-parse-output):
	* textmodes/nroff-mode.el (nroff-outline-level):
	* textmodes/reftex-cite.el (reftex-bib-sort-year)
	(reftex-bib-sort-year-reverse, reftex-format-citation):
	* textmodes/reftex-parse.el (reftex-init-section-numbers)
	(reftex-section-number):
	* textmodes/texinfmt.el (texinfo-paragraphindent):
	Replace `string-to-int' by `string-to-number'.

	* international/latexenc.el: Add page marker to force the "Local
	Variables:" string out of the last page.

2005-05-16  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gud.el (gud-tooltip-mode): Add gud prefix to
	tooltip-change-major-mode.
	(gud-tooltip-print-command): Remove case where gud-minor-mode
	is gdb ("--fullname").
	(gud-tooltip-tips): Turn GUD tooltips off for this case and
	explain to user.

2005-05-16  Jay Belanger  <belanger@truman.edu>

	* calc/calc-store.el (calc-copy-special-constant): New function.

	* calc/calc-ext.el (calc-init-extensions): Add binding for
	`calc-copy-special-constant'.

	* calc/calc-prog.el (calc-edit-format-macro-buffer): Add a case
	for the `calc-copy-special-constant' command.

2005-05-16  Nick Roberts  <nickrob@snap.net.nz>

	* subr.el (left-fringe-p): New function.

	* progmodes/compile.el (compilation-setup): Set local value of
	overlay-arrow-string to "" always.
	(compilation-set-window): Left fringe then don't scroll.
	No left fringe then no arrow and scroll message to top.
	(compilation-context-lines): Adjust doc string accordingly.

2005-05-16  Kim F. Storm  <storm@cua.dk>

	* ido.el (ido-magic-forward-char, ido-magic-backward-char)
	(ido-magic-delete-char): New commands for C-f, C-b, C-d.
	(ido-wide-find-dir-or-delete-dir): New command for M-d.
	(ido-define-mode-map): Bind them.  Add C-x prefix to fallback commands.
	(ido-read-file-name): Handle commands with ido property value
	equal to find-file as reading a file name, to allow C-d to enter dired.
	(ibuffer-find-file): Add ido property with value find-file.

2005-05-15  Kim F. Storm  <storm@cua.dk>

	* subr.el (open-network-stream-nowait): Remove.
	(open-network-stream-server): Remove.

2005-05-15  Richard M. Stallman  <rms@gnu.org>

	* faces.el (describe-face): Output a definition link button.

	* help-mode.el (help-face-def): New button type.

	* emacs-lisp/copyright.el (copyright-fix-years):
	Match properly if the first year is 2-digit.
	Don't mess up the whitespace after the years by filling.

	* dired-aux.el (dired-mark-confirm):
	Pass t to dired-get-marked-files for DISTINGUISH-ONE-MARKED.

	* dired.el (dired-map-over-marks): New arg DISTINGUISH-ONE-MARKED.
	(dired-get-marked-files): New arg DISTINGUISH-ONE-MARKED.
	(dired-mark-pop-up): Handle FILES = (t FILE) specially.

	* emacs-lisp/lisp-mode.el (lisp-mode-variables):
	Set font-lock-comment-start-skip.

	* font-lock.el (font-lock-comment-start-skip): New variable.
	(font-lock-comment-end-skip): New variable.
	(font-lock-fontify-syntactically-region): Use them if non-nil.

2005-05-15  Jay Belanger  <belanger@truman.edu>

	* calc/calc-store.el (calc-store-value): Return a string rather
	than display it as a message.
	Use calc-var-name for variable name.
	(calc-store-into): Add the result of calc-store-value to message.
	(calc-copy-variable): Add a message.
	(calc-store-exchange): Improve error messages.
	(calc-store-binary, calc-store-map): Don't reset the values of
	special constants.

2005-05-14  Luc Teirlinck  <teirllm@auburn.edu>

	* emacs-lisp/derived.el (define-derived-mode): Add link to Elisp
	manual to docstring.

	* files.el (hack-local-variables-confirm): Add STRING argument.
	Make the function handle non file visiting buffers correctly.
	(hack-local-variables-prop-line, hack-local-variables)
	(hack-one-local-variable): Use STRING arg of
	`hack-local-variables-confirm'.

2005-05-14  Michael Albinus  <michael.albinus@gmx.de>

	Sync with Tramp 2.0.49.

	* tramp.el (tramp-handle-dired-call-process)
	(tramp-handle-insert-directory):`insert-buffer' cannot be used
	because the contents of the Tramp buffer is changed before
	insertion (`expand-file' and alike).
	(tramp-handle-insert-directory): If `localname' has an empty
	nondirectory name, it must not be quoted.
	(tramp-pre-connection): Add parameter CHUNKSIZE.  Make local
	variable `tramp-chunksize'.  Change callees.
	(tramp-open-connection-setup-interactive-shell): Check remote host
	for buggy `send-process-string' implementation.
	Set `tramp-chunksize' if found.  Reported by Michael Kifer
	<kifer@cs.sunysb.edu> (and a lot of other people all the years).
	(tramp-handle-shell-command): `insert-buffer' cannot be used
	because the contents of the Tramp buffer is changed before
	insertion (`expand-file' and alike).  Reported by Fr,Ai(Bd,Ai(Bric Bothamy
	<frederic.bothamy@free.fr>.
	(tramp-set-auto-save): Actions should be done for Tramp file name
	handler only.  Ange-FTP has its own auto-save mechanism.
	Reported by Richard G. Bielawski <Richard.G.Bielawski@wellsfargo.com>.
	(tramp-set-auto-save-file-modes): Set file modes of
	`buffer-auto-save-file-name' to ?\600 as fallback solution.
	Reported by Ferenc Wagner <wferi@tba.elte.hu>.
	(tramp-bug): Remove obsolete variable.
	(tramp-append-tramp-buffers): Rewrite partly.  More suitable check
	for presence of `mml-mode'.  Make it running for older Emacsen as well.

2005-05-14  John Paul Wallington  <jpw@pobox.com>

	* ibuf-ext.el (define-ibuffer-filter filename):
	If `dired-directory' is a list, use its car.

2005-05-14  Daniel Brockman  <daniel@brockman.se>  (tiny change)

	* ibuffer.el (define-ibuffer-column filename):
	If `dired-directory' is a list, use its car.

2005-05-14  Richard M. Stallman  <rms@gnu.org>

	* subr.el (symbol-file): Doc fix.

	* emacs-lisp/bytecomp.el (byte-compile-nogroup-warn): New function.
	(byte-compile-form): Call byte-compile-nogroup-warn.
	(byte-compile-warning-types): Doc fix.

	* eshell/esh-mode.el (eshell-find-tag): Use with-no-warnings.

	* progmodes/cc-engine.el (c-literal-faces):
	Add font-lock-comment-delimiter-face.

	* net/net-utils.el (dig): Use with-no-warnings.

	* mail/supercite.el (sc-cite-frame-alist, sc-uncite-frame-alist)
	(sc-recite-frame-alist, sc-default-cite-frame)
	(sc-default-uncite-frame, sc-default-recite-frame)
	(sc-attrib-selection-list, sc-rewrite-header-list):
	Mark as risky-local-variable.

	* international/ogonek.el (ogonek-jak, ogonek-how):
	Don't use beginning-of-buffer.

	* emacs-lisp/eldoc.el (eldoc-documentation-function): Add autoload.

	* calendar/solar.el (solar-data-list): Move definition up.

	* dnd.el (dnd-protocol-alist): Add autoload.

	* progmodes/sh-script.el: Many doc usage fixes.
	(sh-indent-after-do): Change default to match common styles.

2005-05-13  Luc Teirlinck  <teirllm@auburn.edu>

	* files.el (interpreter-mode-alist)
	(auto-mode-interpreter-regexp): Doc fixes.

2005-05-13  Matt Hodges  <MPHodges@member.fsf.org>

	* tmm.el (tmm-get-keymap): Include only active menus and menu items.

	* emacs-lisp/easymenu.el (easy-menu-define): Doc fixes.

2005-05-13  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* dired.el (dired-mode): make-variable-buffer-local =>
	make-local-variable.

2005-05-13  YAMAMOTO Mitsuharu  <mituharu@math.s.chiba-u.ac.jp>

	* term/mac-win.el (mac-select-convert-to-string): Try coding
	systems in mac-script-code-coding-systems if specified one cannot
	encode string for `com.apple.traditional-mac-plain-text'.

2005-05-13  Daniel Pfeiffer  <occitan@esperanto.org>

	* progmodes/make-mode.el (makefile-targets-face)
	(makefile-shell-face, makefile-makepp-perl-face): New faces.
	(makefile-dependency-regex): Fix it to not make the colon in
	$(var:a=b) special.
	(makefile-rule-action-regex): New regexp for highlighting embedded
	Shell strings.
	(makefile-macroassign-regex): Handle != for highlighting as
	embedded Shell strings.
	(makefile-var-use-regex): New const.
	(makefile-statements, makefile-automake-statements)
	(makefile-gmake-statements, makefile-makepp-statements)
	(makefile-bsdmake-statements): New consts.
	(makefile-make-font-lock-keywords): New function.
	(makefile-automake-font-lock-keywords)
	(makefile-gmake-font-lock-keywords)
	(makefile-makepp-font-lock-keywords)
	(makefile-bsdmake-font-lock-keywords): New consts.
	(makefile-mode-map): Add switchers between the various submodes.
	(makefile-mode): Document the availability of the variants.
	(makefile-automake-mode, makefile-gmake-mode)
	(makefile-makepp-mode, makefile-bsdmake-mode): New derived modes.

	* files.el (auto-mode-alist, interpreter-mode-alist): Set up the
	new variants of makefile-mode.

2005-05-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* font-lock.el (font-lock-comment-delimiter-face): Fix up
	the inheritance.

2005-05-12  Luc Teirlinck  <teirllm@auburn.edu>

	* progmodes/inf-lisp.el (inferior-lisp-mode-hook)
	(inferior-lisp-load-hook): Convert defcustoms back to defvars.

	* files.el (normal-mode): Extend the scope of the
	`enable-local-variables' binding to include the `set-auto-mode' call.
	(magic-mode-alist): Doc fix.

2005-05-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* font-lock.el (font-lock-comment-delimiter-face): Inherit from
	font-lock-comment-face rather than copying its setting.

2005-05-12  Andreas Schwab  <schwab@suse.de>

	* eshell/esh-mode.el (eshell-send-input): Doc fix.

2005-05-12  Lute Kamstra  <lute@gnu.org>

	* emacs-lisp/generic.el (define-generic-mode): Don't generate a
	defcustom for the mode hook variable.  Delete the last argument.
	* generic-x.el: Fix callers of define-generic-mode.
	(generic-x-modes): Delete group.
	(show-tabs-tab-face, show-tabs-space-face): Put them in the
	generic-x customization group.

2005-05-12  Kim F. Storm  <storm@cua.dk>

	* font-lock.el (font-lock-negation-char-face): Default to "off".

	* progmodes/cc-fonts.el (c-basic-matchers-before): Don't apply
	font-lock-negation-char-face to ! in !=.

2005-05-12  Masatake YAMATO  <jet@gyve.org>

	* add-log.el (find-change-log): Fix typos in the docstring
	of function.

2005-05-11  Arne J,Ax(Brgensen  <arne@arnested.dk>

	* international/latexenc.el (latexenc-find-file-coding-system):
	Avoid `re-search-forward' when looking for input encoding because
	of speed and safety.  Better regular expressions for recognizing
	input encoding.  Limit a search for TeX-master/tex-main-file to
	the local variable section.

2005-05-11  Dan Nicolaescu  <dann@ics.uci.edu>

	* progmodes/sh-script.el (sh-mode-default-syntax-table): Set the
	syntax of $ to "'" (quote).

2005-05-11  Reiner Steib  <Reiner.Steib@gmx.de>

	* dnd.el (dnd-protocol-alist): Improve custom type.

	* dired.el (dired-dnd-protocol-alist): New variable.
	(dired-mode): Use `dired-dnd-protocol-alist'.  Move call of
	`dired-mode-hook' to the end.

2005-05-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* font-lock.el (font-lock-fontify-syntactically-region): Don't use
	comment-end if comment-start-skip is not set.
	Obey the font-lock-comment-delimiter-face variables.

2005-05-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* files.el (executable-find): Move from executable.el.  Use locate-file.
	* progmodes/executable.el (executable-find): Move to files.el.

	* font-lock.el (font-lock-fontify-keywords-region): Use a marker
	when trying to ensure forward progress.

2005-05-11  Chong Yidong  <cyd@stupidchicken.com>

	* mouse-sel.el (mouse-sel-follow-link-p): New function.
	(mouse-select, mouse-select-internal, mouse-extend-internal):
	Use it to implement mouse-1-click-follows-link functionality.

2005-05-11  Richard M. Stallman  <rms@gnu.org>

	* font-lock.el (font-lock-fontify-syntactically-region):
	Use font-lock-comment-delimiter-face for comment delimiters.

2005-05-10  Jay Belanger  <belanger@truman.edu>

	* calc/calc-help.el (calc-m-prefix-help): Add mention of
	preserving embedded modes.

2005-05-10  Richard M. Stallman  <rms@gnu.org>

	* progmodes/sh-script.el (sh-indent-for-do): Default to 0.

	* progmodes/ada-mode.el (ada-adjust-case-skeleton):
	Move from ada-stmt.el.
	(ada-mode): Add ada-adjust-case-skeleton to skeleton-end-hook.

	* progmodes/ada-stmt.el (ada-adjust-case-skeleton):
	Move to ada-mode.el.
	(ada-stmt-mode-hook): Delete; do the work in ada-mode.

	* cus-edit.el (custom-file): Call file-chase-links.

	* files.el (read-directory-name): Fix previous change.
	(hack-local-variables-confirm): New function.
	(hack-local-variables-prop-line, hack-local-variables)
	(hack-one-local-variable): Use it.

2005-05-10  Lute Kamstra  <lute@gnu.org>

	* font-lock.el (font-lock-keywords-alist)
	(font-lock-removed-keywords-alist): Clarify docstrings.

2005-05-10  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-macro-info): New variable.
	(gdb-source-info): Check for preprocessor info.
	(gdb-tooltip-print-1): New function.  Don't print tooltip if it is
	a macro for a function.
	(gdb-info-breakpoints-custom): Try to find file again if not already
	found (user might have used GDB dir command).
	(gdb-get-location): Update gdb-location-alist correctly for change
	to gdb-info-breakpoints-custom.

	* progmodes/gud.el (gud-tooltip-mode): Require tooltip to be safe.
	(gud-tooltip-print-command): Add gdbmi case.
	(gud-tooltip-tips): Call gdb-tooltip-print-1 first if there is
	preprocessor info.

2005-05-09  Reiner Steib  <Reiner.Steib@gmx.de>

	* startup.el (fancy-splash-insert): Fix typo in doc string.

2005-05-09  Juanma Barranquero  <lekktu@gmail.com>

	* obsolete/float.el (string-to-float):
	* obsolete/hilit19.el (hilit-add-pattern):
	* obsolete/rnews.el (news-parse-range, news-select-message)
	(news-get-pruned-list-of-files): Replace `string-to-int' by
	`string-to-number'.

	* obsolete/uncompress.el: Set `find-file-not-found-functions', not
	`find-file-not-found-hooks'; use `add-hook'.
	(uncompress-while-visiting): Set `write-file-functions', not
	`write-file-hooks'; use `add-hook'.

2005-05-09  Kim F. Storm  <storm@cua.dk>

	* emulation/cua-base.el (cua-copy-region, cua-cut-region)
	(cua-paste): Handle clipboard action.
	(cua--init-keymaps): Remap clipboard-kill-region and
	clipboard-kill-ring-save.

2005-05-08  Eli Zaretskii  <eliz@gnu.org>

	* emacs-lisp/easy-mmode.el (easy-mmode-pretty-mode-name):
	Improve commentary.

	* simple.el (next-error-overlay-arrow-position): Revert the change
	made on 2005-04-30.

2005-05-07  Jay Belanger  <belanger@truman.edu>

	* calc/calcsel2.el (calc-commute-left, calc-commute-right)
	(calc-sel-unpack, calc-sel-isolate): Rename variable `reselect' to
	`calc-sel-reselect'.

	* calc/calc-mode.el (calc-save-modes): Reset the modes list if
	Calc is in embedded mode.

2005-05-07  Eli Zaretskii  <eliz@gnu.org>

	* progmodes/compile.el (compilation-setup):
	Set overlay-arrow-string to an empty string on text terminals.

	* textmodes/ispell.el (ispell-program-name): Try looking for
	"aspell" along exec-path, and if found, use it as the default
	speller program.

2005-05-07  Jirka Kosek  <jirka@kosek.cz>  (tiny change)

	* international/mule.el (sgml-xml-auto-coding-function):
	Recognize encoding='FOO' in single quotes as well as in double quotes.

2005-05-07  Johan Bockg,Ae(Brd  <bojohan@dd.chalmers.se>

	* emacs-lisp/cl-macs.el (cl-transform-lambda): Recognize `declare'
	as well as `interactive', so that defmacro* would recognize
	`declare' forms.

2005-05-07  Eli Zaretskii  <eliz@gnu.org>

	* emacs-lisp/easy-mmode.el (easy-mmode-pretty-mode-name):
	Explain more about the LIGHTER arg's usage in the doc string.
	Add commentary to clarify what the code does.  Fix the regexp that
	strips whitespace from LIGHTER.  Quote LIGHTER before using it,
	since it could have characters special to regular expressions.

2005-05-07  Matt Hodges  <MPHodges@member.fsf.org>  (tiny change)

	* replace.el (occur-1): Bind inhibit-read-only so that
	erase-buffer doesn't barf on read-only text properties (likewise
	for add-text-properties in occur-engine).  Mark buffer as unmodified.
	(occur-engine): Don't set buffer-read-only here.

2005-05-06  Stefan Monnier  <monnier@iro.umontreal.ca>

	* pcvs.el (cvs-mode-commit, cvs-mode-edit-log): Don't fiddle with
	list-buffers-directory.  This caused the *cvs-commit* buffer to be
	sometimes mistakenly reused as a *cvs* buffer.

2005-05-07  Nick Roberts  <nickrob@snap.net.nz>

	* tooltip.el: Move code for GUD tooltips into gud.el.
	(require): CL no longer needed to compile case.
	(tooltip-mode): Do not toggle functions for GUD tooltips.
	(tooltip-gud-tips-p): Remove.  Replace with minor mode
	gud-tooltip-mode in gud.el.
	(tooltip-gud-modes, tooltip-gud-display, tooltip-gud-echo-area)
	(tooltip-gud-toggle-dereference): Rename in gud.el by replacing
	tooltip-gud prefix with gud-tooltip and obsolete.
	(tooltip-change-major-mode, tooltip-activate-mouse-motions-if-enabled)
	(tooltip-mouse-motions-active, tooltip-activate-mouse-motions)
	(tooltip-mouse-motion): Mouse movement functions/variable.
	Rename in gud.el by adding gud prefix.
	(tooltip-gud-original-filter, tooltip-gud-dereference)
	(tooltip-gud-event, tooltip-toggle-gud-tips)
	(tooltip-gud-process-output, tooltip-gud-print-command)
	(tooltip-gud-tips): GUD tooltip functions/variables.  Rename in
	gud.el by replacing tooltip-gud prefix with gud-tooltip.
	(gdb-tooltip-print): Move to gdb-ui.el.

	* progmodes/gud.el: Move code for GUD tooltips from tooltip.el.
	(require): CL needed to compile case.
	(gud-tooltip-mode): Use to toggle GUD tooltips instead of
	tooltip-gud-tips-p.  Make it a minor-mode.
	(gud-find-file): Only prepare GUD tooltips if gud-tooltip-mode is t.
	(gud-menu-map): GUD tooltips use gud-tooltip-mode now.
	(gud-tooltip-modes, gud-tooltip-display, gud-tooltip-echo-area)
	(gud-tooltip-change-major-mode)
	(gud-tooltip-activate-mouse-motions-if-enabled)
	(gud-tooltip-mouse-motions-active, gud-tooltip-activate-mouse-motions)
	(gud-tooltip-mouse-motion, gud-tooltip-toggle-dereference)
	(gud-tooltip-original-filter, gud-tooltip-dereference)
	(gud-tooltip-event, tooltip-toggle-gud-tips)
	(gud-tooltip-process-output, gud-tooltip-print-command)
	(gud-tooltip-tips): Move from tooltip.el.

	* progmodes/gdb-ui.el (gdb-tooltip-print): Move from tooltip.el.
	(gdb-cpp-define-alist-flags): Doc fix.
	(gdb-set-gud-minor-mode-1): Only prepare GUD tooltips if
	gud-tooltip-mode is t.

2005-05-06  Stefan Monnier  <monnier@iro.umontreal.ca>

	* net/goto-addr.el (goto-address-fontify): Make sure the overlays
	evaporate if their text is deleted.
	(goto-address-at-point): Make it work as a mouse binding as well.
	(goto-address-at-mouse): Obsolete it.  Update users.

2005-05-06  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* calendar/appt.el (top-level): No longer activate on load.

2005-05-06  Juanma Barranquero  <lekktu@gmail.com>

	* calendar/cal-bahai.el (mark-bahai-diary-entries):
	* net/webjump.el (webjump):
	* progmodes/idlw-help.el (idlwave-do-context-help1)
	(idlwave-highlight-linked-completions):
	* textmodes/po.el (po-find-file-coding-system-guts):
	Replace `assoc-ignore-case' by `assoc-string'.

2005-05-06  Eli Zaretskii  <eliz@gnu.org>

	* files.el (locate-file): Doc fix.

	* progmodes/gdb-ui.el (gdb-cpp-define-alist-program): Doc fix.
	Remove the redundant test for ms-dos.

	* progmodes/cmacexp.el (c-macro-preprocessor): Use locate-file to
	look for the preprocessor with exec-suffixes.  If not found in
	standard places, look in exec-path.  Remove most of the tests that
	used system-type.

	* loadup.el: Load jka-cmpr-hook instead of jka-comp-hook.

	* jka-compr.el (jka-compr-uninstall): Add autoload cookie.

	* jka-cmpr-hook.el: Renamed from jka-comp-hook.el, to avoid
	file-name clash with jka-compr.el on 8+3 filesystems.

2005-05-06  YAMAMOTO Mitsuharu  <mituharu@math.s.chiba-u.ac.jp>

	* term/mac-win.el: Don't define or bind scroll bar functions if
	x-toolkit-scroll-bars is t.
	(x-select-text, x-get-selection-value):
	Clear x-last-selected-text-clipboard if x-select-enable-clipboard is nil.
	(PRIMARY): Put mac-scrap-name property.
	(mac-select-convert-to-file-url): New function.
	(public.file-url): New selection target type.  Add to
	selection-converter-alist.
	(x-get-selection, x-selection-value): Handle it.
	(x-cut-buffer-or-selection-value): New alias.

2005-05-05  Roland Winkler  <Roland.Winkler@physik.uni-erlangen.de>

	* textmodes/bibtex.el (bibtex-summary): Use current BibTeX
	entry to avoid calling bibtex-find-entry with arg global
	being t.  Remove arg key.
	(bibtex-summary-function, bibtex-complete-crossref-cleanup)
	(bibtex-copy-summary-as-kill): Change accordingly.

2005-05-05  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/org.el (org-get-entries-from-diary): Remove unused vars.
	(org-agenda-date-later): Use with-current-buffer.

2005-05-05  Luc Teirlinck  <teirllm@auburn.edu>

	* emacs-lisp/byte-run.el (define-obsolete-function-alias)
	(define-obsolete-variable-alias): Doc Fixes.

2005-05-06  Kim F. Storm  <storm@cua.dk>

	* simple.el (line-move-1): Fix 2005-04-26 change.  Must still use
	vertical-motion when selective-display is active.

	* ido.el (ido-setup-hook): New hook.
	(ido-define-mode-map-hook): Remove hook; use ido-setup-hook instead.
	(ido-input-stack): New var.
	(ido-define-mode-map): Bind M-b to ido-push-dir.  Move old
	ido-next-work-file binding to M-O.
	Bind M-f to ido-wide-find-file-or-pop-dir.
	(ido-define-mode-map): Don't run ido-define-mode-map-hook.
	(ido-read-internal): Run ido-setup-hook.
	Catch quit in read-file-name and read-string to cancel edit.
	Handle new push, pop, and pop-all exit codes (for M-b/M-f).
	Automatically pop-all when completing a directory name (RET).
	(ido-file-internal): Add with-no-warnings around ffap and dired code.
	(ido-exit-minibuffer): Use exit-minibuffer instead of throw.
	(ido-wide-find-file, ido-wide-find-dir): Catch quit to cancel find.
	(ido-push-dir, ido-pop-dir, ido-wide-find-file-or-pop-dir):
	New functions for M-b/M-f to move among the directory components.
	(ido-make-merged-file-list): Catch quit to cancel merge.
	(ido-make-dir-list): Delete "." when ido-input-stack is non-empty.
	(ido-completion-help): No warnings for ido-completion-buffer-full.

2005-05-05  Daniel Pfeiffer  <occitan@esperanto.org>

	* font-lock.el (font-lock-negation-char-face): New face and variable.
	* progmodes/cc-fonts.el (c-cpp-matchers): Use it.
	* progmodes/sh-script.el (sh-font-lock-keywords): Use it.
	* progmodes/cperl-mode.el (cperl-init-faces): Use it.
	* progmodes/make-mode.el (makefile-font-lock-keywords): Use it.

2005-05-05  Juanma Barranquero  <lekktu@gmail.com>

	* emacs-lisp/byte-run.el (define-obsolete-function-alias):
	Fix typo in docstring.

	* progmodes/ebrowse.el (ebrowse-install-1-to-9-keys)
	(ebrowse-print-statistics-line)
	(ebrowse-electric-position-mode-hook): Fix typo in docstring.

	* term/w32-win.el (image-library-alist): Add additional name for
	Xpm library.

2005-05-05  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/cmacexp.el (c-macro-preprocessor): Update for BSD and
	use gcc instead of cpp.

	* progmodes/gdb-ui.el (gdb-cpp-define-alist-flags): New variable.
	(gdb-create-define-alist): Use it.
	(gdb-cpp-define-alist-program): Update for MS-DOS.

2005-05-04  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/cmacexp.el (c-macro-preprocessor): Update for Mac OS X.

2005-05-04  Richard M. Stallman  <rms@gnu.org>

	* help.el (describe-key): No error when UNTRANSLATED is nil.

	* simple.el (line-move-1): Fix previous change to signal errors
	appropriately.

2005-05-03  Ulf Jasper  <ulf.jasper@web.de>

	* calendar/icalendar.el (icalendar-version): Now at 0.12.
	(icalendar-duration-correction): Remove.
	(icalendar--get-event-properties): Split result at commas.
	(icalendar--decode-isoduration): New optional argument
	DURATION-CORRECTION.
	(icalendar--convert-ordinary-to-ical, icalendar--convert-sexp-to-ical)
	(icalendar--convert-yearly-to-ical, icalendar--convert-weekly-to-ical)
	(icalendar--convert-block-to-ical, icalendar--convert-float-to-ical)
	(icalendar--convert-date-to-ical, icalendar--convert-cyclic-to-ical)
	(icalendar--convert-anniversary-to-ical): New functions, extracted
	from icalendar-export-region, with bug fixes.
	(icalendar-export-region): Use the above functions.
	(icalendar-import-buffer): Check before saving diary file.
	(icalendar--convert-recurring-to-diary)
	(icalendar--convert-non-recurring-all-day-to-diary)
	(icalendar--convert-non-recurring-not-all-day-to-diary): New functions,
	extracted from icalendar--convert-ical-to-diary, with bug fixes.
	(icalendar--convert-ical-to-diary): Use the above functions.

2005-05-03  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/cc-mode.el (cc-define-alist, cc-create-define-alist):
	Remove these recent additions.
	(c-mode): Restore to before 2005-04-28.

	* progmodes/cc-vars.el (cc-define-list-program): Remove this
	recent addition.

	* progmodes/gdb-ui.el (gdb-cpp-define-alist-program)
	(gdb-define-alist): New variables.
	(gdb-create-define-alist): New function.
	(gdb-set-gud-minor-mode-1): Handle gdb-define-alist.
	(gdb-source, gdb-memory-set-repeat-count): Replace string-to-int
	with string-to-number.
	(gdb-reset): Kill gdb-define-alist.  Move assignments outside loop.

	* progmodes/gud.el: Replace string-to-int with string-to-number.
	(gud-find-file): Handle gdb-define-alist.

	* tooltip.el (tooltip-gud-tips): Use gdb-define-alist.

2005-05-02  Jay Belanger  <belanger@truman.edu>

	* calc/calc-aent.el (math-read-token):
	* calc/calc-bin.el (calc-word-size):
	* calc/calc-ext.el (calc-read-number-fancy):
	* calc/calc-forms.el (calc-time, calc-date-notation, math-this-year)
	(math-parse-date, math-parse-standard-date, calcFunc-tzone):
	* calc/calc-frac.el (calc-over-notation):
	* calc/calc-graph.el (calc-graph-plot, calc-graph-set-styles)
	(calc-graph-num-points, calc-graph-init):
	* calc/calc-prog.el (calc-read-parse-table-part)
	(calc-edit-macro-repeats):
	* calc/calc-yank.el (calc-do-grab-rectangle):
	* calc/calc.el (calcDigit-key, math-read-number, math-read-bignum):
	Replace `string-to-int' by `string-to-number'.

2005-05-02  Kim F. Storm  <storm@cua.dk>

	* kmacro.el: Use executing-kbd-macro-index variable.

2005-05-02  Thien-Thi Nguyen  <ttn@gnu.org>

	* net/rlogin.el (rlogin-parse-words): Delete func.
	(rlogin): Use split-string, not rlogin-parse-words.
	Also, if there are option-like elements in the parsed args,
	take the host to be the first arg immediately following them.
	Suggested by Michael Mauger.

2005-05-01  Luc Teirlinck  <teirllm@auburn.edu>

	* subr.el (executing-macro): Use `define-obsolete-variable-alias'.

2005-05-02  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/cc-mode.el (cc-create-define-alist): Use a shell.
	(cc-mode-cpp-program): Rename to cc-define-list-program and
	move to cc-vars.el.

	* progmodes/cc-vars.el (cc-define-list-program):
	Change to "gcc -E -dM -".  Make customizable.

2005-05-02  Kim F. Storm  <storm@cua.dk>

	* emulation/cua-base.el: Fix check for CUA-mode if no init file.

2005-05-02  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/cc-mode.el (cc-mode-cpp-program): Change to "gcc -E".

	* international/mule-util.el (truncate-string): Remove alias and
	obsolete declaration.

	* international/mule-cmds.el (update-iso-coding-systems):
	Remove alias and obsolete declaration.

	* international/mule.el (coding-system-parent): Remove alias and
	obsolete declaration.

	* subr.el (define-function, sref): Remove aliases and obsolete
	declarations.
	(chars-in-region): Remove obsolete declaration.

2005-05-01  Richard M. Stallman  <rms@gnu.org>

	* info.el (Info-mode): Set widen-automatically to nil, locally.

	* simple.el (widen-automatically): New variable.
	(pop-global-mark): Obey widen-automatically.

2005-05-01  Dan Nicolaescu  <dann@ics.uci.edu>

	* term/xterm.el (function-key-map): Call substitute-key-definition
	before the keymap size is increased by a lot of define-key calls.

2005-05-01  Richard M. Stallman  <rms@gnu.org>

	* subr.el (add-to-invisibility-spec, remove-from-invisibility-spec):
	Rename ARG to ELEMENT.  Doc fix.

2005-05-01  Nick Roberts  <nickrob@snap.net.nz>

	* allout.el (allout-exposure): Remove macro and obsolete declaration.
	Remove references to allout-exposure/change to allout-new-exposure.

	* emacs-lisp/bytecomp.el (dot, dot-min, dot-max): Don't create
	bytecode symbols.

	* subr.el (dot, dot-marker, dot-min, dot-max, buffer-flush-undo)
	(compiled-function-p, focus-frame, unfocus-frame):
	Remove aliases and obsolete declarations.
	Back out inadvertent changes from previous commit.

2005-05-01  Luc Teirlinck  <teirllm@auburn.edu>

	* files.el (require-final-newline): Make Custom tags consistent
	with mode-require-final-newline.
	(mode-require-final-newline): Doc fix.

2005-05-01  Stefan Monnier <monnier@iro.umontreal.ca>

	* international/latexenc.el (latexenc-find-file-coding-system):
	Fix regular expressions.

2005-05-01  David Kastrup <dak@gnu.org>

	* international/latexenc.el (latexenc-find-file-coding-system):
	Fix regular expressions.

2005-05-01  Nick Roberts  <nickrob@snap.net.nz>

	* subr.el (string-to-int): Make obsolete.

2005-04-30  Richard M. Stallman  <rms@gnu.org>

	* simple.el (next-error-overlay-arrow-position): Turn off, for ttys.

	* loadup.el: load jka-comp-hook.

	* jka-compr.el: Many functions and vars moved to jka-comp-hook.el.
	(jka-compr-handler): Add autoload.  `put' calls moved
	to jka-comp-hook.el.
	(compression, jka-compr): defgroups moved to jka-comp-hook.el.
	(jka-compr-inhibit): Autoload.

	* jka-comp-hook.el: New file.
	Enable the mode by default.

	* files.el (backup-buffer-copy): Use copy-file instead
	of write-region, and put back the 'excl.

2005-04-30  Chong Yidong  <cyd@stupidchicken.com>

	* progmodes/flymake.el (flymake-split-string)
	(flymake-split-string, flymake-log, flymake-pid-to-names)
	(flymake-reg-names, flymake-get-source-buffer-name)
	(flymake-unreg-names, flymake-add-line-err-info)
	(flymake-add-err-info): Clarify docstrings.
	(flymake-popup-menu, flymake-make-emacs-menu)
	(flymake-make-xemacs-menu): Add docstrings.
	(flymake-get-buffer-*, flymake-set-buffer-*): Functions deleted.
	Set variables directly throughout.

2005-04-30  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/cc-mode.el (cc-create-define-alist): Check that file
	exists.  Initialize cc-define-alist.
	(c-mode): Add cc-create-define-alist locally to after-save-hook.
	If there is no file (Macroexpansion) don't create an alist.

2005-04-29  Sam Steingold  <sds@gnu.org>

	* progmodes/cc-mode.el (cc-mode-cpp-program): New user variable.
	(cc-create-define-alist): Use it instead of the hard-coded string.

2005-04-29  Stefan Monnier  <monnier@iro.umontreal.ca>

	* international/mule-conf.el (file-coding-system-alist): Fix regexp
	for latexenc.

2005-04-29  Lute Kamstra  <lute@gnu.org>

	* emacs-lisp/generic.el: Improve commentary section.
	(define-generic-mode): Improve docstring.

2005-04-29  Carsten Dominik  <dominik@science.uva.nl>

	* textmodes/org.el (many places): Change to quiet the byte compiler.
	(org-prefix-format-compiled): New variable.
	(org-compile-prefix-format): New function.
	(org-timeline, org-agenda, org-diary): Call org-compile-prefix-format.
	(org-agenda-prefix-format,org-timeline-prefix-format): New options.
	(org-agenda-get-scheduled): Check if file is opened in `org-mode'.
	(org-get-entries-from-diary): Use `org-get-time-of-day' for
	consistency with entries from `org-mode' files.
	(org-get-time-of-day): Fix bug with partial matches early in a line.
	(org-non-link-chars): New constant.
	(org-link-regexp): Respect `org-non-link-chars'.
	(org-agenda-day-view): Remove command.
	(org-agenda-toggle-week-view): Rename from `org-agenda-week-view'.
	(org-follow-bbdb-link, org-store-link): Search also company field.
	(org-highlight-overlay): New variable.
	(org-highlight, org-unhighlight): New functions.
	(org-agenda-mode): Add pre-command-hook to remove highlight.
	(org-evaluate-time-range): Behavior depends upon whether time stamp
	contains a time or not.
	(org-show-subtree, org-show-entry): New functions.
	(org-agenda-cleanup-fancy-diary): Remove empty lines.

2005-04-28  Luc Teirlinck  <teirllm@auburn.edu>

	* comint.el (comint-output-filter-functions): Add autoload cookie.

2005-04-28  Kim F. Storm  <storm@cua.dk>

	* ido.el (ido-everywhere): Fix last change.

2005-04-28  Arne J,Ax(Brgensen  <arne@arnested.dk>

	* international/latexenc.el: New file.
	* international/mule-conf.el (file-coding-system-alist): For .tex,
	.ltx, .dtx and .drv extensions, use `latexenc-find-file-coding-system'.

2005-04-28  Lute Kamstra  <lute@gnu.org>

	* font-lock.el (font-lock-add-keywords)
	(font-lock-remove-keywords): Clarify docstring.
	(font-lock-keywords-alist, font-lock-removed-keywords-alist):
	Don't start docstrings with a `*'.
	(font-lock-update-removed-keyword-alist): Give it a docstring.

	* generic-x.el: Update commentary section.
	Only require font-lock when compiling.
	Define all modes conditionally.
	Place all generic modes in the generic-x-modes customization group.
	(generic-x-modes): New customization group.
	(generic-default-modes, generic-mswindows-modes)
	(generic-unix-modes, generic-other-modes): New constants.
	(generic-define-mswindows-modes, generic-define-unix-modes):
	Update docstrings.  Make them obsolete.
	(generic-extras-enable-list): New default value.  Update docstring.
	Improve :type.  Change :set function.
	(bat-generic-mode-syntax-table, rul-generic-mode-syntax-table):
	Fix docstring.

	* emacs-lisp/generic.el (generic-mode-internal):
	Simplify font-lock-defaults.
	(define-generic-mode): Fix docstring.

2005-04-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/grep.el (grep-mode-font-lock-keywords): Use the
	font-lock-face property to highlight matches.

2005-04-28  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/cc-mode.el (cc-create-define-alist): New function.
	(cc-define-alist): New variable.
	(c-mode): Make it local and initialize it.

	* progmodes/gdb-ui.el (gdb-active-process): New variable.
	(gdb-exited): New function.
	(gdb-annotation-rules): Use it.
	(gdb-starting): Set gdb-active-process to t.
	(gdb-stopping): Amend doc string.
	(gdb-reset): Set gdb-active-process to nil.

	* tooltip.el (tooltip-gud-tips): Show the associated #define
	directives when a C program under GDB is not executing.

2005-04-27  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/cperl-mode.el (cperl-mode): Don't precompile the
	font-lock-fontify-syntactic-keywords.

	* font-lock.el (font-lock-default-fontify-region): Don't force
	parse-sexp-lookup-properties to nil.

2005-04-27  Alexander Klimov  <alserkli@inbox.ru>  (tiny change)

	* man.el (man-mode-syntax-table): Set up `:' to have
	word-constituent syntax.

2005-04-27  Lute Kamstra  <lute@gnu.org>

	* novice.el (disable-command): Don't add spurious newlines to the
	init file.  Reported by Dan Jacobson <jidanni@jidanni.org>.

2005-04-26  Jay Belanger  <belanger@truman.edu>

	* calc/calc-yank.el (calc-edit-finish): Make sure there is more
	than one window before deleting window.

2005-04-26  Luc Teirlinck  <teirllm@auburn.edu>

	* shell.el (shell-prompt-pattern): Doc fix.
	(shell-mode): Set paragraph-separate buffer locally to "\\'".

	* comint.el (comint-prompt-regexp, comint-get-old-input)
	(comint-use-prompt-regexp)
	(comint-use-prompt-regexp-instead-of-fields)
	(comint-replace-by-expanded-history, comint-send-input)
	(comint-output-filter, comint-get-old-input-default)
	(comint-line-beginning-position, comint-bol, comint-show-output)
	(comint-backward-matching-input, comint-forward-matching-input)
	(comint-next-prompt, comint-previous-prompt):
	Rename `comint-use-prompt-regexp-instead-of-fields' to
	`comint-use-prompt-regexp'.  Keep old name as alias and declare
	obsolete.
	(comint-use-prompt-regexp): Shorten first line of doc string.

	* ielm.el (inferior-emacs-lisp-mode): Adapt to above name change.
	Set paragraph-separate buffer locally to "\\'".

	* hippie-exp.el (try-expand-line, try-expand-line-all-buffers):
	Adapt to above name change.

	* net/net-utils.el (nslookup-prompt-regexp, ftp-prompt-regexp)
	(smbclient-prompt-regexp): Ditto.

	* progmodes/inf-lisp.el (inferior-lisp-prompt): Ditto.

2005-04-27  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-location-alist): Rename from
	gdb-location-list.
	Break lines that are over 80 characters wide.

2005-04-26  Stefan Monnier  <monnier@iro.umontreal.ca>

	* pcvs-info.el (cvs-fileinfo->full-path, cvs-display-full-path):
	New fun and var, to preserve compatibility.

	* pcvs.el, pcvs-info.el: Rename "full-path" -> "full-name".

2005-04-26  Dominique de Waleffe  <ddw@missioncriticalit.com>  (tiny change)

	* pcvs-info.el (cvs-fileinfo->backup-file): Don't pass the full file
	name to file-newer-than-file-p.

2005-04-26  Richard M. Stallman  <rms@gnu.org>

	* simple.el (line-move-1): Avoid using vertical-motion in easy cases.

	* progmodes/python.el (python-mode):
	Use new name eldoc-documentation-function.

	* hexl.el (hexl-mode): Use new name eldoc-documentation-function.

	* emacs-lisp/eldoc.el (eldoc-mode): Doc fix.
	(eldoc-documentation-function):
	Rename from eldoc-print-current-symbol-info-function.  Calls changed.

2005-04-26  Nick Roberts  <nickrob@snap.net.nz>

	* emacs-lisp/byte-run.el (define-obsolete-function-alias): New macro.

2005-04-25  Dan Nicolaescu  <dann@ics.uci.edu>

	* term/xterm.el (function-key-map): Fix strings for
	{C,S,A,C-S}-f[1-4].  Use substitute-key-definition to bind
	{C,S,A,C-S}-{f1-f12}.

2005-04-26  Kenichi Handa  <handa@m17n.org>

	* international/mule-cmds.el (select-safe-coding-system):
	Fix previous change.

2005-04-26  Lute Kamstra  <lute@gnu.org>

	* emacs-lisp/easy-mmode.el (define-minor-mode): Fix docstring.

	* font-lock.el (font-lock-fontify-region-function): Fix docstring.
	(font-lock-comment-delimiter-face): Ditto.

	* calc/calc.el (calc-trail-mode): Don't set font-lock-defaults.

2005-04-25  Jay Belanger  <belanger@truman.edu>

	* calc/calc-help.el (calc-view-news): Let-bind inhibit-read-only
	to t while inserting information; use help-mode.

2005-04-25  Dan Nicolaescu  <dann@ics.uci.edu>

	* term.el (ansi-term-color-vector): Use the xterm colors.
	(term-raw-map): Don't add mappings for \eO and \e[.  Map deletechar.

2005-04-25  Lute Kamstra  <lute@gnu.org>

	* font-core.el (font-lock-defaults): Fix docstring.

	* font-lock.el (font-lock-syntactic-face-function): Fix docstring.

2005-04-25  Kenichi Handa  <handa@m17n.org>

	* international/mule-cmds.el (select-safe-coding-system):
	Don't check consistency with coding: spec, etc if raw-text or
	no-conversion was found to be safe.

2005-04-24  Richard M. Stallman  <rms@gnu.org>

	* mail/sendmail.el (mail-font-lock-keywords): Match any number of
	citation markers at start of each line.

	* mail/rmail.el (rmail-font-lock-keywords): Match any number of
	citation markers at start of each line.

	* font-lock.el (font-lock-comment-delimiter-face): Doc fix.

	* files.el (mode-require-final-newline): Fix previous change.
	(require-final-newline): Fix type label.

2005-04-24  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* progmodes/f90.el (f90-calculate-indent): Fix treatment of first
	statement in buffer (broken by 2004-11-24 change).

2005-04-24  Kim F. Storm  <storm@cua.dk>

	* ido.el (ido-everywhere): Save and restore old read-buffer-function
	and read-file-name-function values.  Don't overwrite existing
	non-nil values if ido-mode is enabled without ido-everywhere.

2005-04-24  Luc Teirlinck  <teirllm@auburn.edu>

	* files.el (mode-require-final-newline): Minor doc fix.

2005-04-24  Eli Zaretskii  <eliz@gnu.org>

	* subr.el (syntax-after): Doc fix.
	(syntax-class): If argument is nil, return nil.  Mask off upper 16
	bits, not 8 bits.

	* files.el (mode-require-final-newline): Doc fix.
	(backup-buffer-copy): Fix last change.

2005-04-24  YAMAMOTO Mitsuharu  <mituharu@math.s.chiba-u.ac.jp>

	* term/mac-win.el: Require select.  Set selection-coding-system to
	mac-system-coding-system.  Call menu-bar-enable-clipboard.
	(x-last-selected-text-clipboard, x-last-selected-text-primary)
	(x-select-enable-clipboard): New variables.
	(x-select-text, x-get-selection, x-selection-value)
	(x-get-selection-value, mac-select-convert-to-string)
	(mac-services-open-file, mac-services-open-selection)
	(mac-services-insert-text): New functions.
	(CLIPBOARD, FIND): Put mac-scrap-name property.
	(com.apple.traditional-mac-plain-text, public.utf16-plain-text)
	(public.tiff): Put mac-ostype property.
	(selection-converter-alist): Add entries for them.
	(mac-application-menu-map): New keymap.
	(interprogram-cut-function, interprogram-paste-function): Set to
	x-select-text and x-get-selection-value, respectively.
	(split-window-keep-point): Set to t.

2005-04-23  Richard M. Stallman  <rms@gnu.org>

	* files.el (read-directory-name): Always pass non-nil
	DEFAULT-FILENAME arg to read-file-name.
	(backup-buffer-copy, basic-save-buffer-2): Take care against
	writing thru an unexpected existing symlink.
	(revert-buffer): In indirect buffer, revert the base buffer.
	(magic-mode-alist): Doc fix.
	(buffer-stale-function): Doc fix.
	(minibuffer-with-setup-hook): Avoid warning.
	(mode-require-final-newline): Doc and custom fix.

	* follow.el (follow-end-of-buffer): Use with-no-warnings.

	* font-lock.el (font-lock-comment-face): On terminals with few colors,
	use the default appearance.
	(font-lock-comment-delimiter-face): New face, new variable.

	* imenu.el (imenu--generic-function): The official position of a
	definition is the start of the line that BEG is in.

	* midnight.el (midnight-timer): Move defvar up.

	* mouse.el (mouse-drag-region-1): Delete some debugging code.

	* saveplace.el (save-place-to-alist): Use with-no-warnings.

	* startup.el (command-line): Use with-no-warnings.

	* window.el (window-size-fixed): New defvar.

	* emacs-lisp/easymenu.el (easy-menu-do-define): Use defalias, not fset.

	* mail/rmail.el (rmail-font-lock-keywords):
	Use font-lock-comment-delimiter-face.

	* mail/sendmail.el (mail-font-lock-keywords):
	Use font-lock-comment-delimiter-face.

	* progmodes/compile.el (next-error-highlight-timer): New defvar.

2005-04-23  SAITO Takuya  <tabmore@rivo.mediatti.net>  (tiny change)

	* progmodes/compile.el (compilation-mode-font-lock-keywords):
	Specify t for LAXMATCH when matching directories.
	Save match data around compilation-compat-error-properties form.

2005-04-23  David Kastrup  <dak@gnu.org>

	* textmodes/tex-mode.el (TeX-mode, plain-TeX-mode, LaTeX-mode):
	Mention that the autoloaded aliases should be kept for AUCTeX.

2005-04-23  Andreas Schwab  <schwab@suse.de>

	* isearch.el (isearch-forward): Doc fix.

2005-04-23  Eli Zaretskii  <eliz@gnu.org>

	* jit-lock.el (jit-lock-stealth-time): Change default value to 16.
	(jit-lock-stealth-nice): Change default value to 0.5.

2005-04-23  Eric Hanchrow  <offby1@blarg.net>  (tiny change)

	* abbrev.el (write-abbrev-file): Write table entries in
	alphabetical order by table name.

2005-04-22  Kim F. Storm  <storm@cua.dk>

	* ido.el (ido-read-internal): Fix `list' completion.

2005-04-22  Kenichi Handa  <handa@m17n.org>

	* recentf.el (recentf-save-file-coding-system): New variable.
	(recentf-save-list): Encode the file by
	recentf-save-file-coding-system and add coding: tag.

2005-04-22  Nick Roberts  <nickrob@snap.net.nz>

	* emacs-lisp/byte-run.el (define-obsolete-variable-alias): New macro.

2005-04-21  Lute Kamstra  <lute@gnu.org>

	* loadhist.el (unload-feature): Don't remove a function from hooks
	if it is about to be restored to an autoload .  Remove functions
	that will become unbound from auto-mode-alist.  Simplify the code.

	* subr.el (assq-delete-all): New implementation that is linear,
	not quadratic.  Suggested by David Kastrup <dak@gnu.org>.
	(rassq-delete-all): New function.

	* menu-bar.el (menu-bar-options-save, menu-bar-showhide-menu):
	Add size-indication-mode.

2005-04-21  Kenichi Handa  <handa@m17n.org>

	* international/mule-cmds.el: Add autoload for widget-value in
	eval-when-compile.

2005-04-21  Nick Roberts  <nickrob@snap.net.nz>

	* menu-bar.el (menu-bar-options-save, menu-bar-showhide-menu):
	Add tooltip-mode.

	* bindings.el (mode-line-mode-menu): Remove tooltip-mode.

2005-04-20  Luc Teirlinck  <teirllm@auburn.edu>

	* progmodes/inf-lisp.el (inferior-lisp): New defgroup.
	(inferior-lisp-filter-regexp, inferior-lisp-program)
	(inferior-lisp-load-command, inferior-lisp-prompt)
	(inferior-lisp-mode-hook, lisp-source-modes)
	(inferior-lisp-load-hook): defvar->defcustom.
	(inferior-lisp-program, inferior-lisp-prompt)
	(inferior-lisp-load-hook): Doc fixes.
	(inferior-lisp-install-letter-bindings): Small change in
	introductory comment.

2005-04-20  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc.el (vc-annotate-color-map): Change some colors so that text
	using them as foreground is readable on both white and black
	backgrounds.

2005-04-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* international/mule-conf.el (translation-table-for-input):
	Remove redundant declaration.

2005-04-20  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gud.el (gud-menu-map): Add tooltip-toggle-gud-tips.

	* tooltip.el (tooltip-gud-tips-p): Expand documentation.
	(tooltip-toggle-gud-tips): New function.

2005-04-20  YAMAMOTO Mitsuharu  <mituharu@math.s.chiba-u.ac.jp>

	* term/mac-win.el (mac-symbol-encoder): Fix mappings of left and
	right angle brackets.

2005-04-20  Nick Roberts  <nickrob@snap.net.nz>

	* tooltip.el (tooltip-use-echo-area): Replace as alias and deprecate.

2005-04-19  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/flymake.el (flymake-get-absolute-file-name-basedir):
	Remove.  Update callers to use expand-file-name instead.

	* subr.el (syntax-class): New function.

	* simple.el (blink-matching-open): Use it.

	* paren.el (show-paren-function): Use it to recognize parens that are
	also used in 2-char comment markers.

2005-04-19  Lute Kamstra  <lute@gnu.org>

	* loadhist.el (unload-feature): Update for new format of
	load-history.  Simplify the code.

2005-04-19  YAMAMOTO Mitsuharu  <mituharu@math.s.chiba-u.ac.jp>

	* term/mac-win.el: Add coding: tag and set it to iso-2022-7bit.
	(mac-add-charset-info): New function.  Initialize variable
	mac-charset-info-alist using it.
	(mac-centraleurroman, mac-cyrillic): Do not use UCS in table data
	for translation.
	(mac-symbol-encoder, mac-dingbats-encoder): New translation table.
	(mac-font-encoder-list): Add entries for mac-symbol and mac-dingbats.
	(ccl-encode-mac-symbol-font, ccl-encode-mac-dingbats-font):
	New CCL programs.

2005-04-19  Kim F. Storm  <storm@cua.dk>

	* simple.el (next-buffer, prev-buffer, next-error)
	(scroll-other-window, keyboard-quit, keyboard-escape-quit)
	(clone-indirect-buffer-other-window): Move bindings to bindings.el.

	* bindings.el (next-buffer, prev-buffer, next-error)
	(scroll-other-window, keyboard-quit, keyboard-escape-quit)
	(clone-indirect-buffer-other-window): Move bindings from simple.el.
	(next-buffer, prev-buffer): Add C-x C-right and C-x C-left bindings.
	(next-error, previous-error): Add M-g M-n/n and M-g M-p/p bindings.

2005-04-18  Stefan Monnier  <monnier@iro.umontreal.ca>

	* isearch.el (isearch-edit-string): Make the search-ring available for
	minibuffer history commands.
	(minibuffer-local-isearch-map): Remove bindings for M-p	and M-n,
	the default history commands now work just as well.
	(isearch-ring-retreat-edit, isearch-ring-advance-edit): Remove.

2005-04-18  Kim F. Storm  <storm@cua.dk>

	* emulation/cua-base.el (cua--pre-command-handler): Add more
	elaborate check for shift modifier on non-window systems.

2005-04-18  Lars Hansen  <larsh@math.ku.dk>

	* desktop.el: Make "--no-desktop" turn off `desktop-save-mode'.

2005-04-18  Kim F. Storm  <storm@cua.dk>

	* tooltip.el (tooltip-show): Change second arg to USE-ECHO-AREA
	and make it optional.  Don't test tooltip-gud-echo-area here.
	(tooltip-gud-process-output, gdb-tooltip-print):
	Pass tooltip-gud-echo-area to tooltip-show.
	(tooltip-help-tips): Remove second optional arg to tooltip-show.

2005-04-18  YAMAMOTO Mitsuharu  <mituharu@math.s.chiba-u.ac.jp>

	* tooltip.el (tooltip-mode): `emacs-quick-startup' and
	`display-graphic-p' may not be bound yet.

2005-04-17  Luc Teirlinck  <teirllm@auburn.edu>

	* startup.el (command-line): No longer enable Xterm Mouse mode by
	default in terminals compatible with xterm.

	* xt-mouse.el (xterm-mouse-mode): Set init value back to nil.

2005-04-18  Nick Roberts  <nickrob@snap.net.nz>

	* tooltip.el (tooltip-gud-echo-area): Rename from
	tooltip-use-echo-area.
	(tooltip-show, tooltip-gud-process-output, gdb-tooltip-print)
	(tooltip-help-tips): Allow GUD tooltips to be displayed in echo
	area independently of where help tooltips are displayed.

2005-04-17  David Kastrup  <dak@gnu.org>

	* cus-theme.el (custom-theme-write-variables): Quote variables
	where necessary.

2005-04-17  Richard M. Stallman  <rms@gnu.org>

	* simple.el (yank-excluded-properties): Add follow-link to value.

	* jka-compr.el (jka-compr-compression-info-list): Fix custom type.

	* startup.el (fancy-splash-max-time): Just 30 seconds.
	(fancy-splash-delay): Just 7.
	(fancy-splash-screens): No time limit other than fancy-splash-max-time.

	* loadhist.el (unload-feature): Update for new format of load-history.
	Simplify the code.

	* mail/rmail.el (rmail-ignored-headers): Ignore more headers
	(rmail-font-lock-keywords): Don't fontify the text of a citation.

	* mail/sendmail.el (mail-font-lock-keywords):
	Don't fontify subject text.
	Don't fontify the text of a citation.

2005-04-17  Mark H. Weaver  <mhw@netris.org>  (tiny change)

	* comint.el (comint-output-filter): Run comint-output-filter-functions
	with point where the user had it.

2005-04-16  Stefan Monnier  <monnier@iro.umontreal.ca>

	* international/ucs-tables.el (ucs-set-table-for-input):
	Disable when using unify-on-decoding.

2005-04-16  Dan Nicolaescu  <dann@ics.uci.edu>

	* emulation/cua-base.el (cua-global-mark-face): Add special case
	for displays supporting a high number of colors.

2005-04-16  Matt Hodges  <MPHodges@member.fsf.org>  (tiny change)

	* repeat.el (repeat): Invoke pre-command-hook and post-command-hook.

2005-04-16  Chong Yidong  <cyd@stupidchicken.com>

	* filesets.el (filesets-add-buffer): If user supplies a name of a
	non-existing fileset, create a new fileset.

2005-04-16  Carsten Dominik  <dominik@science.uva.nl>

	* textmodes/org.el (org-up-heading-all): Fix bug with
	`outline-up-heading-all'.

2005-04-16  Andreas Schwab  <schwab@suse.de>

	* files.el (auto-mode-alist): Handle /etc/sysconfig/*,
	/etc/permissions.d/* and /etc/aliases.d/*.

2005-04-16  Kenichi Handa  <handa@m17n.org>

	* international/code-pages.el (cp-make-coding-system):
	Set `translation-table-for-input' property value to the symbol
	ucs-mule-to-mule-unicode, not to that value.
	(pt154): Escape guillemet by `\'.

2005-04-15  Luc Teirlinck  <teirllm@auburn.edu>

	* loadup.el: Load tooltip if x-show-tip is fboundp.

	* startup.el (command-line): Add comment.

	* tooltip.el (tooltip-mode): Specify correct standard value for
	Custom in init-value.

2005-04-15  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gud.el (gud-goto-info): Use existing Info buffer, if
	possible.

2005-04-15  Carsten Dominik  <dominik@science.uva.nl>

	* textmodes/org.el (org-agenda-date-prompt): Rename from
	`org-agenda-date-today'.
	(org-evaluate-time-range): Insert at point instead of directly
	after time range.
	(org-first-headline-recenter, org-subtree-end-visible-p)
	(org-optimize-window-after-visibility-change): New functions
	(org-agenda-post-command-hook): Don't allow point at end of line,
	to make sure it always hits the text properties.
	(org-agenda-next-date-line, org-agenda-previous-date-line):
	New commands.
	(org-set-regexps-and-options): Category may contain white space.
	(org-agenda-get-deadlines, org-agenda-get-scheduled):
	Improve marker positions.
	(org-agenda-new-marker): Argument POS made optional.
	(org-agenda-get-timestamps): Deadlines which are done are listed
	in org-done-face now.
	(org-agenda-get-todos, org-agenda-get-timestamps)
	(org-agenda-get-deadlines, org-agenda-get-scheduled):
	Set `undone-face' and `done-face' properties.
	(org-last-todo-state-is-todo): New variable.
	(org-todo): Set `org-last-todo-state-is-todo'.
	(org-agenda-todo): Change face according to
	`org-last-todo-state-is-todo'.  And change other lines referring to
	the same entry.
	(org-calendar-goto-agenda): New command.
	(org-calendar-to-agenda-key): New option.
	(org-startup-folded): New allowed value `content'.
	(org-set-regexps-and-options): Accept new value `content' for
	`org-startup-folded'.
	(org-get-current-options): Handle new value `content' for
	`org-startup-folded'.
	(org-insert-todo-heading): New command.
	(org-mode): Insert first line "*-* mode: org-mode -*-" when called
	interactively in empty file and option
	`org-insert-mode-line-in-empty-file' has been set.
	(org-agenda-todo,org-agenda-priority): Modify to use
	`org-agenda-change-all-lines'.
	(org-warning-face): Change color on dark background

2005-04-14  YAMAMOTO Mitsuharu  <mituharu@math.s.chiba-u.ac.jp>

	* international/mule-cmds.el (set-locale-environment): On Mac OS,
	use preferences AppleLocale and AppleLanguages, and variable
	mac-system-locale for default locale.  On Mac OS Classic, use
	mac-system-coding-system for default coding systems.

	* term/mac-win.el: Don't set file-name-coding-system.
	Decode variables system-name, emacs-build-system, user-login-name, and
	user-full-name by mac-system-coding-system on Mac OS Classic.
	(mac-system-coding-system): New variable.

2005-04-13  Luc Teirlinck  <teirllm@auburn.edu>

	* startup.el (command-line): Handle `xterm-mouse-mode' before
	reading init file.

	* xt-mouse.el (xterm-mouse-mode): Adapt to above change.

2005-04-13  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* progmodes/sh-script.el (sh-here-document-word): Make it a
	defcustom.  Doc fix.
	(sh-add): Bash uses $(( )) for arithmetic.
	(sh-while-getopts) <sh>: Set OPTIND back to 1 at end.
	(sh-maybe-here-document): Remove quotes and leading whitespace
	from heredoc word when closing.  Indent heredoc with tabs if word
	starts with "-".

2005-04-13  Richard M. Stallman  <rms@gnu.org>

	* simple.el (undo): Fix previous change.

	* custom.el (defface): Doc fix.

2005-04-13  Lute Kamstra  <lute@gnu.org>

	* Makefile.in (DONTCOMPILE): Remove list.
	(compile, compile-always): Don't use DONTCOMPILE.
	(update-authors): Load the library in which batch-update-authors
	is defined.
	* makefile.w32-in (DONTCOMPILE): Remove list.
	(compile, compile-always): Fix comments.
	(update-authors): Load the library in which batch-update-authors
	is defined.

	* generic-x.el (generic-mode-ini-file-find-file-hook):
	Rename to ini-generic-mode-find-file-hook.
	Keep generic-mode-ini-file-find-file-hook as an alias.
	(ini-generic-mode-find-file-hook): Rename from
	generic-mode-ini-file-find-file-hook.  Fix docstring.
	(ini-generic-mode): Docstring change.
	(bat-generic-mode-run-as-comint): Silence the byte compiler.

	* help.el (describe-key-briefly): UNTRANSLATED can be nil when
	called from lisp.

	* generic.el: Move to the emacs-lisp subdir.

2005-04-12  Dan Nicolaescu  <dann@ics.uci.edu>

	* term/xterm.el (function-key-map): Add mappings for A-, C-, S-
	and C-S- function and cursor motion keys.

2005-04-12  Luc Teirlinck  <teirllm@auburn.edu>

	* startup.el (command-line): Enable Xterm Mouse mode by default.
	* xt-mouse.el (xterm-mouse-mode): Provide correct standard value
	for Custom.  No longer show "Mouse" in mode line when enabled.
	Doc fix.

2005-04-12  Kim F. Storm  <storm@cua.dk>

	* emulation/cua-base.el (cua-rectangle-face)
	(cua-rectangle-noselect-face): Define face attributes here.

	* emulation/cua-rect.el (cua--init-rectangles): Remove face setup.

2005-04-12  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* startup.el (command-line): Turn off blinking cursor if
	cursorBlink in resources is off or false.

2005-04-12  YAMAMOTO Mitsuharu  <mituharu@math.s.chiba-u.ac.jp>

	* term/mac-win.el (dnd): Require dnd.
	(mac-drag-n-drop): Call dnd-handle-one-url.
	(kTextEncodingMacRoman, kTextEncodingISOLatin1)
	(kTextEncodingISOLatin2): Remove constants.
	(mac-script-code-coding-systems): New constant.
	(mac-handle-language-change): New function.
	(special-event-map): Bind it to `language-change' event.
	(mac-centraleurroman, mac-cyrillic): New coding systems.
	(mac-font-encoder-list, ccl-encode-mac-centraleurroman-font)
	(ccl-encode-mac-cyrillic-font): Rename mac-centraleurroman-encoder
	and mac-cyrillic-encoder to encode-mac-centraleurroman and
	encode-mac-cyrillic, respectively.

2005-04-12  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gud.el, progmodes/gdb-ui.el (gdb-assembler-mode):
	Don't set overlay-arrow-string to "=>" as this is done
	globally in C now.

2005-04-12  Lute Kamstra  <lute@gnu.org>

	* generic-x.el (rc-generic-mode, rul-generic-mode):
	Fix auto-mode-alist entries.
	(etc-fstab-generic-mode): Tweak fontification.

	* generic.el (generic-make-keywords-list): Fix docstring.
	(generic-mode-internal): Simplify generic-font-lock-keywords.

2005-04-11  Rajesh Vaidheeswarran  <rv@gnu.org>

	* whitespace.el (whitespace-buffer-leading)
	(whitespace-buffer-trailing): Revert the incorrect test inversion.
	However, fix the highlight area for the leading and
	trailing whitespaces to show space.

2005-04-11  Rajesh Vaidheeswarran  <rv@gnu.org>

	* whitespace.el (whitespace-version): Bump to 3.5

	(whitespace-buffer-leading, whitespace-buffer-trailing):
	Invert sense of the test to highlight the whitespace.

2005-04-12  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gud.el (gud-display-line): GUD uses its own
	overlay arrow now so don't set overlay-arrow-string.
	(gud-pdb-command-name): Revert back to "pdb" (2004-04-26).

2005-04-11  Dan Nicolaescu  <dann@ics.uci.edu>

	* term.el (term-ansi-current-bold, term-ansi-current-underline)
	(term-ansi-current-reverse, term-ansi-current-invisible)
	(term-ansi-face-already-done): Change to boolean.
	(term-reset-terminal, term-handle-colors-array): Handle the above
	vars accordingly.
	(term-buffer-vertical-motion): Rename from buffer-vertical-motion.
	(term-emulate-terminal): Use the new name.

	* faces.el (secondary-selection): Use yellow1, not yellow.
	(trailing-whitespace): Use red1, not red.

2005-04-11  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* dired.el (dired-mode): Use dnd-* instead of x-dnd-*
	(dired-dnd-handle-local-file): Call dnd-get-local-file-name.
	(dired-dnd-handle-file): Call dnd-get-local-file-uri

	* cus-edit.el (dnd): New group.

	* term/w32-win.el (dnd): Require dnd
	(w32-drag-n-drop): Call dnd-handle-one-url.

	* x-dnd.el: Require dnd.
	(x-dnd-handle-uri-list, x-dnd-handle-file-name):
	Call dnd-handle-one-url.
	(x-dnd-types-alist, x-dnd-insert-utf8-text)
	(x-dnd-insert-utf16-text, x-dnd-insert-ctext): Change x-dnd-insert-text
	to dnd-insert-text.
	(x-dnd-protocol-alist, x-dnd-open-file-other-window)
	(x-dnd-handle-one-url, x-dnd-get-local-file-uri)
	(x-dnd-get-local-file-name, x-dnd-open-local-file)
	(x-dnd-open-file, x-dnd-insert-text): Move to dnd.el (without x-).

	* dnd.el (dnd-protocol-alist): New file with generic DND functions.

2005-04-11  JUAN-LEON Lahoz Garcia  <juanleon1@gmail.com>

	* wdired.el: Doc fixes.
	(wdired-confirm-overwrite): Rename from wdired-is-ok-overwrite.
	(wdired-use-dired-vertical-movement): Rename from
	wdired-always-move-to-filename-beginning.
	(wdired-mode-map): Use `ignore' instead of `wdired-newline'.
	(wdired-change-to-wdired-mode): Change mode name.
	(wdired-newline): Delete.

2005-04-11  Richard M. Stallman  <rms@gnu.org>

	* whitespace.el (whitespace-highlight-the-space):
	Don't call whitespace-unhighlight-the-space here.

	* simple.el (undo): Record t in undo-equiv-table
	for the redo record made by an undo-in-region.

2005-04-12  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-display-inferior-io-buffer)
	(gdb-frame-inferior-io-buffer): New Functions to control
	display of separate IO buffer.
	(menu): Add them to menu-bar.
	(gdb-display-buffer): Check for buffer another frame.
	Protect GUD buffer.
	(gdb-setup-windows): Create IO buffer if not already there.
	(gdb-memory-mode): Remove purecopy noops.

2005-04-11  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* progmodes/f90.el (f90-electric-insert): Add optional prefix arg,
	and pass to self-insert-command.

2005-04-11  Lute Kamstra  <lute@gnu.org>

	* generic.el: Commentary section cleanup.
	(generic): Delete.
	(generic-use-find-file-hook, generic-lines-to-scan)
	(generic-find-file-regexp, generic-ignore-files-regexp)
	(default-generic-mode, generic-mode-find-file-hook)
	(generic-mode-ini-file-find-file-hook): Move to generic-x.el.
	* generic-x.el (generic-x): Docstring fix.  Put it in the data group.
	(generic-use-find-file-hook, generic-lines-to-scan)
	(generic-find-file-regexp, generic-ignore-files-regexp)
	(default-generic-mode, generic-mode-find-file-hook)
	(generic-mode-ini-file-find-file-hook): Move from generic.el.

2005-04-10  Karl Fogel  <kfogel@red-bean.com>

	* bookmark.el (bookmark-write-file): Catch errors writing file.
	This is the same change as saveplace.el at 2005-04-10T23:32:00Z!rms@gnu.org.

2005-04-10  Richard M. Stallman  <rms@gnu.org>

	* startup.el (fancy-splash-tail): Update copyright year.
	(command-line): Split part of -Q into -D.
	(emacs-basic-display): New defvar.
	(fancy-splash-text): Correct name of menu item.

	* saveplace.el (save-place-alist-to-file): Catch errors writing file.

	* info.el (Info-fontify-node): Handle fontification of multiple * Menu
	lines in one node.

	* comint.el (comint-send-input): New arg ARTIFICIAL.
	Callers in this file changed.

	* abbrev.el (define-abbrevs): Read system abbrevs properly.

	* emacs-lisp/map-ynp.el (map-y-or-n-p): Clarify RET/q in help message.

2005-04-10  Chong Yidong  <cyd@stupidchicken.com>

	* url/url-ldap.el (url-ldap): Add docstring.  Fix call to
	`ldap-search-internal'.

2005-04-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* files.el (set-auto-mode-1): Use line-end-position.

	* international/latin-1.el:
	* international/latin-2.el:
	* international/latin-3.el:
	* international/latin-4.el:
	* international/latin-5.el:
	* international/latin-8.el:
	* international/latin-9.el: Give punctuation syntax to NBSP.

	* textmodes/bibtex.el (bibtex-autokey-titleword-ignore)
	(bibtex-reference-key, bibtex-autokey-demangle-name, bibtex-mode):
	Use char-classes to accept non-ascii letters, accepted in some recent
	bibtex implementations.

2005-04-10  Luc Teirlinck  <teirllm@auburn.edu>

	* custom.el (custom-set-minor-mode): Any non-nil value for the
	variable should enable the mode when set through Custom.

2005-04-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/vhdl-mode.el (vhdl-mode-map-init): Don't override default
	TAB binding so tab-always-indent is obeyed.
	(vhdl-minibuffer-local-map): Move initialization into declaration.
	(vhdl-mode-abbrev-table-init): Mark the abbrevs as `system'.
	(vhdl-run-when-idle, vhdl-create-mode-menu, vhdl-character-to-event)
	(vhdl-hooked-abbrev): Avoid test for XEmacs.
	(vhdl-current-line): Use line-beginning-position.
	(vhdl-doc-variable, vhdl-doc-mode): Call help-setup-xref before
	with-output-to-temp-buffer, so the current position can be recorded.

2005-04-10  Masatake YAMATO  <jet@gyve.org>

	* progmodes/compile.el (compilation-error-regexp-alist-alist):
	Add regexp for gcov.

2005-04-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* calendar/time-date.el (time-to-seconds, seconds-to-time)
	(days-to-time, time-subtract, time-add): Don't use the #xhhhh
	syntax which Emacs 20 doesn't support.

2005-04-09  Richard M. Stallman  <rms@gnu.org>

	* help.el (describe-key-briefly, describe-key):
	Replace strings as event types with "(any string)".

2005-04-09  Stefan Monnier  <monnier@iro.umontreal.ca>

	* arc-mode.el (archive-mode-map): Move initialization into
	the declaration.  Override *all* bindings of `undo'.
	(archive-lemacs): Remove, use (featurep 'xemacs) instead.

2005-04-09  Jay Belanger  <belanger@truman.edu>

	* calc/calc-units.el (math-standard-units): Redefine Watt hour as W*hr.

2005-04-09  Dan Nicolaescu  <dann@ics.uci.edu>

	* term/xterm.el (xterm-rgb-convert-to-16bit): Simplify.
	(xterm-register-default-colors): Update color values computation
	to match xterm-200.

2005-04-09  Kenichi Handa  <handa@m17n.org>

	* international/code-pages.el (iso-latin-7): Fix the map.

2005-04-08  Luc Teirlinck  <teirllm@auburn.edu>

	* emacs-lisp/lisp.el (defun-prompt-regexp)
	(parens-require-spaces, buffer-end, end-of-defun)
	(insert-parentheses): Doc fixes.

2005-04-08  Kim F. Storm  <storm@cua.dk>

	* comint.el (comint-highlight-prompt): Fix face spec.
	* hi-lock.el (hi-green): Likewise.

2005-04-08  Dan Nicolaescu  <dann@ics.uci.edu>

	* cus-edit.el (custom-modified-face):
	* comint.el (comint-highlight-input): Fix previous changes.
	* term.el (term-handle-ansi-escape): Add a comment.

2005-04-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* whitespace.el (whitespace-highlight-the-space): Put the same overlay
	in the buffer and in whitespace-highlighted-space.
	(whitespace-unhighlight-the-space): Simplify.
	(whitespace-buffer): Simplify.

2005-04-08  Dan Nicolaescu  <dann@ics.uci.edu>

	* textmodes/table.el (table-cell-face): Add special case for
	displays supporting a high number of colors.
	* progmodes/vhdl-mode.el (vhdl-font-lock-prompt-face)
	(vhdl-font-lock-reserved-words-face)
	(vhdl-speedbar-architecture-face)
	(vhdl-speedbar-instantiation-face)
	(vhdl-speedbar-architecture-selected-face)
	(vhdl-speedbar-instantiation-selected-face): Likewise.
	* progmodes/sh-script.el (sh-heredoc-face): Likewise.
	* progmodes/idlw-help.el (idlwave-help-link-face): Likewise.
	* progmodes/ebrowse.el (ebrowse-tree-mark-face)
	(ebrowse-root-class-face, ebrowse-member-attribute-face)
	(ebrowse-progress-face): Likewise.
	* progmodes/compile.el (compilation-info-face): Likewise.
	* progmodes/cc-fonts.el (c-invalid-face): Likewise.
	* emacs-lisp/re-builder.el (reb-match-3): Likewise.
	* calendar/calendar.el (diary-face): Likewise.
	* woman.el (woman-italic-face, woman-bold-face)
	(woman-unknown-face): Likewise.
	* wid-edit.el (widget-button-pressed-face): Likewise.
	* whitespace.el (whitespace-highlight-face): Likewise.
	* smerge-mode.el (smerge-mine-face, smerge-base-face): Likewise.
	* pcvs-info.el (cvs-marked-face): Likewise.
	* info.el (info-xref): Likewise.
	* ido.el (ido-subdir-face, ido-indicator-face): Likewise.
	* hilit-chg.el (highlight-changes-face)
	(highlight-changes-delete-face): Likewise.
	* hi-lock.el (hi-yellow, hi-green, hi-blue-b, hi-green-b)
	(hi-red-b): Likewise.
	* generic-x.el (show-tabs-tab-face, show-tabs-space-face): Likewise.
	* font-lock.el (font-lock-keyword-face)
	(font-lock-function-name-face, font-lock-warning-face): Likewise.
	* cus-edit.el (custom-invalid-face, custom-modified-face)
	(custom-set-face, custom-changed-face, custom-variable-tag-face)
	(custom-group-tag-face-1, custom-group-tag-face): Likewise.
	* comint.el (comint-highlight-prompt): Likewise.

2005-04-08  Lute Kamstra  <lute@gnu.org>

	* font-lock.el (font-lock-keywords): Docstring fixes.

2005-04-08  Kenichi Handa  <handa@m17n.org>

	* ps-mule.el (ps-mule-show-warning): If the number of unprintable
	chars are more than a limit, print " and more..." at the tail.

2005-04-08  Kim F. Storm  <storm@cua.dk>

	* emacs-lisp/authors.el (authors-aliases): Update list.
	(authors-ignored-files): New list.
	(authors-fixed-entries): Fix typo.
	(authors-renamed-files-alist): Update list.
	(authors-add): Check authors-ignored-files.

2005-04-08  Carsten Dominik  <dominik@science.uva.nl>

	* calendar/diary-lib.el (add-to-diary-list): MARKER argument made
	optional, to ensure backward compatibility.

2005-04-08  Stephen Eglen  <stephen@gnu.org>

	* textmodes/flyspell.el (flyspell-large-region): Doc fix.

2005-04-08  Kim F. Storm  <storm@cua.dk>

	* buff-menu.el (Buffer-menu-mode-map): Map follow-link to mouse-face.

	* mouse.el (mouse-on-link-p): Doc fix.

2005-04-07  Luc Teirlinck  <teirllm@auburn.edu>

	* ielm.el (ielm-prompt-read-only): Doc fix.

	* comint.el (comint-prompt-read-only): Doc fix.

2005-04-07  Benjamin Rutt  <brutt@bloomington.in.us>

	* ffap.el (ffap-pass-wildcards-to-dired): New user option to
	ensure dired always handles wildcards passed to ffap.
	(find-file-at-point): Use it.
	(ffap-dired-wildcards): Doc fix.

2005-04-07  Juri Linkov  <juri@jurta.org>

	* simple.el (next-error-overlay-arrow-position): New defvar.
	Put "=>" on its property `overlay-arrow-string'.  Add it to
	`overlay-arrow-variable-list'.

	* progmodes/compile.el (compilation-setup):
	Set `next-error-overlay-arrow-position' to nil.  Also set it to
	nil in the local hook `kill-buffer-hook'.  Make local variable
	`overlay-arrow-string' and set it to "=>".
	(compilation-goto-locus): Set BOL position to
	`next-error-overlay-arrow-position' instead of
	`overlay-arrow-position'.

	* info.el (Info-mode): Add `Info-kill-buffer' to `kill-buffer-hook'
	locally instead of adding it to the global hook.
	(Info-kill-buffer): Move up.

2005-04-06  Dan Nicolaescu  <dann@ics.uci.edu>

	* term/xterm.el (xterm-standard-colors): Update color values from
	xterm-200.

2005-04-06  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/tex-mode.el (tex-font-lock-keywords-2): Add \bfseries.

	* fast-lock.el:
	* lazy-lock.el: Move them to the obsolete subdir.

2005-04-06  JUAN-LEON Lahoz Garcia  <juanleon1@gmail.com>

	* wdired.el (wdired-advise-functions, wdired-add-skip-in-replace)
	(wdired-add-replace-advice): Remove.
	(wdired-change-to-wdired-mode): Use query-replace-skip-read-only.

2005-04-06  Kim F. Storm  <storm@cua.dk>

	* startup.el (command-line): Add --bare-bones alias for -Q.

2005-04-06  YAMAMOTO Mitsuharu  <mituharu@math.s.chiba-u.ac.jp>

	* term/mac-win.el: Use create-fontset-from-mac-roman-font to
	create the startup fontset if a font specification ends with
	`mac-roman'.

2005-04-06  Lute Kamstra  <lute@gnu.org>

	* add-log.el (change-log-font-lock-keywords): Complete 2005-04-03
	change.

	* emacs-lisp/copyright.el (copyright-update-year): Replace the
	right subexpression.  Suggested by Jay Bingham <jay.bingham@hp.com>.

2005-04-05  Lute Kamstra  <lute@gnu.org>

	* generic.el (generic-mode-internal): Fix 2005-03-31 change.
	(define-generic-mode): Ditto.  Fix debug declaration.

	* generic-x.el (show-tabs-tab-face, show-tabs-space-face):
	Put them in the generic-x group.

	* calendar/timeclock.el (timeclock): Doc fix.

	* generic.el (define-generic-mode): Don't use custom-current-group.
	Document default :group value.
	* emacs-lisp/easy-mmode.el (define-minor-mode): Ditto.
	(define-global-minor-mode): Don't use custom-current-group.

2005-04-05  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* startup.el (command-line-1): Display startup-echo-area-message
	when fancy splash screen is in use.

	* progmodes/sh-script.el (sh-builtins) <bash>: Add `caller'.
	(sh-escaped-newline): New face.
	(sh-font-lock-keywords) <shell>: Improve regexp for escaped
	newline, and use sh-escaped-newline face.

	* progmodes/tcl.el (tcl-escaped-newline): New face.
	(tcl-builtin-list): New variable.
	(tcl-set-font-lock-keywords): Add builtins, variables, and escaped
	newlines.  Fix keywords subexpression number.

2005-04-05  Carsten Dominik  <dominik@science.uva.nl>

	* textmodes/org.el (org-diary-default-entry): Fix call to
	`add-to-diary-entry'.

2005-04-05  Kim F. Storm  <storm@cua.dk>

	* ediff-init.el: Use (featurep 'xemacs).

2005-04-05  David Ponce  <david@dponce.com>

	* cus-edit.el (face): Derive from symbol widget.  Display sample
	of the current face on the fly.
	(widget-face-sample-face-get, widget-face-notify): New functions.
	(widget-face-value-create): Remove.

	* wid-edit.el (widget-field-end): Temporarily remove field
	narrowing before to call `get-char-property'.

2005-04-04  Jay Belanger  <belanger@truman.edu>

	* calc/calc-aent.el (math-read-replacement-list): Add subscripts.
	(math-read-subscripts): New variable.
	(math-read-preprocess-string): Process subscripts.

2005-04-04  Luc Teirlinck  <teirllm@auburn.edu>

	* comint.el (comint-prompt-read-only): Doc fix.

	* dired.el (dired-copy-filename-as-kill): Make `-' arg behave like
	`-1'.  Doc fix.

2005-04-04  Carsten Dominik  <dominik@science.uva.nl>

	* textmodes/org.el (org-insert-mode-line-in-empty-file):
	Change default value to nil.

2005-04-04  Lute Kamstra  <lute@gnu.org>

	* autorevert.el (auto-revert-mode): Specify :group.
	* battery.el (display-battery-mode): Specify :group.
	* diff-mode.el (diff-minor-mode): Specify :group.
	* font-core.el (font-lock-mode): Specify :group.
	* hl-line.el (hl-line-mode): Specify :group.
	* iimage.el (iimage): New customization group.
	(iimage-mode): Specify :group.
	* longlines.el (longlines-mode): Specify :group.
	* master.el: Don't require easy-mmode.
	(master): New customization group.
	(master-mode): Specify :group.
	* msb.el (msb-mode): Specify :group.
	* reveal.el (reveal-mode): Specify :group.
	* simple.el (next-error-follow-minor-mode): Specify :group.
	* smerge-mode.el (smerge-mode): Specify :group.
	* emacs-lisp/eldoc.el (eldoc-mode): Specify :group.
	* emulation/cua-base.el (cua-mode): Specify :group.
	* international/encoded-kb.el (encoded-kbd-mode): Specify :group.
	* language/thai-util.el (thai-auto-composition-mode)
	(thai-word-mode): Specify :group.
	* mail/supercite.el (sc-minor-mode): Specify :group.
	* progmodes/cwarn.el (cwarn-mode): Specify :group.
	* progmodes/flymake.el (flymake-mode): Specify :group.
	* progmodes/glasses.el (glasses-mode): Specify :group.
	* progmodes/hideif.el (hide-ifdef-mode): Specify :group.
	* textmodes/enriched.el (enriched-mode): Specify :group.
	* textmodes/refill.el (refill-mode): Specify :group.

	* add-log.el (change-log-font-lock-keywords): Names in
	parenthesized lists can contain spaces.

2005-04-04  Thien-Thi Nguyen  <ttn@gnu.org>

	* startup.el (fancy-splash-text): Shorten default text of
	"Emacs Tutorial" line.  Also, if the current language env
	indicates an available tutorial file other than TUTORIAL,
	extract its title and append it to the line in parentheses.
	(fancy-splash-insert): If arg is a thunk, funcall it.

2005-04-04  Jay Belanger  <belanger@truman.edu>

	* calc.el (calc-language-alist): Add tags to customization type.

2005-04-03  Luc Teirlinck  <teirllm@auburn.edu>

	* xt-mouse.el (xterm-mouse-mode): Add explicit Custom group, mouse.
	Doc fix.

2005-04-03  Marcelo Toledo  <marcelo@gnu.org>

	* add-log.el (change-log-font-lock-keywords): The manual
	describing a Change Log entry, says: (...) "Aside from these
	header lines, every line in the change log starts with a space or
	a tab.".  The font-lock was not highlighting lines started with
	spaces, added support for it.

2005-04-03  Roland Winkler  <Roland.Winkler@physik.uni-erlangen.de>

	* textmodes/bibtex.el (bibtex-url): Use format to generate the url.
	(bibtex-generate-url-list): Update docstring accordingly.  Put the
	complex example in the docstring.
	(bibtex-font-lock-url): Use pop.

2005-04-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/tcl.el (tcl-set-font-lock-keywords): Use new \_< ops.

	* pcvs.el (cvs-checkout): Prompt for cvsroot as well.

2005-04-03  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* filesets.el (filesets-set-default): Doc fix.

2005-04-03  Lute Kamstra  <lute@gnu.org>

	* generic.el (define-generic-mode): Add argument to specify
	keywords for defcustom.
	(default-generic-mode): Specify :group.

	* generic-x.el: Specify :group for all generic modes.

	* desktop.el (desktop-no-desktop-file-hook)
	(desktop-after-read-hook): Doc fix.

2005-04-02  Luc Teirlinck  <teirllm@auburn.edu>

	* simple.el (visible-mode): Use explicit :group keyword.
	This changes the group of `visible-mode-hook' from paren-blinking
	to editing-basics.

2005-04-02  Sergey Poznyakoff  <gray@Mirddin.farlep.net>  (tiny change)

	* mail/rmail.el (rmail-parse-url): Bugfix.  Parse traditional
	mailbox specifications as well as URLs.
	(rmail-insert-inbox-text): Remove unused conditional branches.

2005-04-01  Jay Belanger  <belanger@truman.edu>

	* calc/calc-graph.el (calc-gnuplot-name, calc-gnuplot-plot-command)
	(calc-gnuplot-print-command): Move definitions to calc.el.

	* calc/calc-embed.el (calc-embedded-announce-formula)
	(calc-embedded-open-formula, calc-embedded-close-formula)
	(calc-embedded-open-word, calc-embedded-close-word)
	(calc-embedded-open-plain, calc-embedded-close-plain)
	(calc-embedded-open-new-formula, calc-embedded-close-new-formula)
	(calc-embedded-open-mode, calc-embedded-close-mode):
	Move definitions to calc.el.

	* calc/calc.el (calc-settings-file, calc-language-alist):
	Make customizable.
	(calc-embedded-announce-formula, calc-embedded-open-formula)
	(calc-embedded-close-formula, calc-embedded-open-word)
	(calc-embedded-close-word, calc-embedded-open-plain)
	(calc-embedded-close-plain, calc-embedded-open-new-formula)
	(calc-embedded-close-new-formula, calc-embedded-open-mode)
	(calc-embedded-close-mode, calc-gnuplot-name)
	(calc-gnuplot-plot-command, calc-gnuplot-print-command): Move here
	from other files and make customizable.

2005-04-01  Stefan Monnier  <monnier@iro.umontreal.ca>

	* pcvs.el (cvs-temp-buffer, cvs-mode-kill-process, cvs-buffer-check):
	Use buffer-live-p.
	(cvs-mode-run): Don't call cvs-update-header here.
	(cvs-run-process): Call cvs-update-header.
	Use process properties for cvs-postprocess and cvs-buffer so that
	the sentinel can behave better if the temp buffer is killed.
	Use a pipe rather than a tty, to better handle unexpected prompts.
	(cvs-sentinel): Rewrite.  Call cvs-update-header.

2005-04-01  Andre Spiegel  <spiegel@gnu.org>

	* vc-hooks.el (vc-workfile-unchanged-p): Disable mtime check when
	we go via Tramp or Ange-FTP.  Suggested by Kai Grossjohann.

2005-03-31  Stefan Monnier  <monnier@iro.umontreal.ca>

	* generic.el (define-generic-mode): Add indentation rule.

2005-03-31  Luc Teirlinck  <teirllm@auburn.edu>

	* files.el (mode-require-final-newline): Make Custom correctly
	report a nil value and allow to set it to nil via Custom.
	Doc fix.

2005-04-01  Kenichi Handa  <handa@m17n.org>

	* international/characters.el: Enable the correct case setting for
	dotless-i and dotted-I.

2005-04-01  Kim F. Storm  <storm@cua.dk>

	* ido.el (ido-file-internal): Fall back to non-ido command if
	initial directory is on slow ftp (or tramp) host.

2005-03-31  Richard M. Stallman  <rms@gnu.org>

	* emacs-lisp/autoload.el (make-autoload):
	Handle define-global-minor-mode.

	* emacs-lisp/easy-mmode.el (define-global-minor-mode):
	Rename from easy-mmode-define-global-mode.
	(easy-mmode-define-global-mode): Alias for define-global-minor-mode.

	* progmodes/scheme.el (scheme-mode-syntax-table):
	Update syntax of | and # for two-character comment syntax.

2005-03-31  Lute Kamstra  <lute@gnu.org>

	* emacs-lisp/easy-mmode.el (easy-mmode-define-global-mode)
	(define-minor-mode): Call custom-current-group at load-time.

	* generic.el (define-generic-mode): Add debug declaration.
	Add defcustom for the mode hook.
	(generic-mode-internal): Use run-mode-hooks.

2005-03-31  Kim F. Storm  <storm@cua.dk>

	* mouse.el (mouse-1-click-follows-link): Increase to 450 ms.
	(mouse-fixup-help-message): New defun called by show_help_echo
	to fixup mouse-2 prefix in help messages when applicable.

	* tooltip.el (tooltip-show-help-function): Don't fixup message here.

2005-03-31  Kenichi Handa  <handa@m17n.org>

	* language/thai-word.el (thai-find-word-ends): Pay attention to
	the case that we reach the end of buffer.

	* textmodes/fill.el (fill-text-properties-at): New function.
	(fill-newline): Use fill-text-properties-at instead of
	text-properties-at.

2005-03-31  Olive Lin  <olive.lin@versateladsl.be>  (tiny change)

	* textmodes/tex-mode.el (tex-start-tex) Use shell-quote-argument,
	not comint-quote-filename.

2005-03-31  Thien-Thi Nguyen  <ttn@gnu.org>

	* help-fns.el (help-with-tutorial): Revert last change.

2005-03-31  Kim F. Storm  <storm@cua.dk>

	* emulation/cua-base.el (cua-scroll-down): Add CUA property.

2005-03-30  Paul Eggert  <eggert@cs.ucla.edu>

	* calendar/cal-china.el: Update reference to "Calendrical
	Calculations" book; there's a new edition.
	* calendar/cal-coptic.el: Likewise.
	* calendar/cal-french.el: Likewise.
	* calendar/cal-hebrew.el: Likewise.
	* calendar/cal-islam.el: Likewise.
	* calendar/cal-iso.el: Likewise.
	* calendar/cal-julian.el: Likewise.
	* calendar/cal-mayan.el: Likewise.
	* calendar/cal-persia.el: Likewise.
	* calendar/calendar.el: Likewise.
	* calendar/holidays.el: Likewise.
	* calendar/lunar.el: Likewise.
	* calendar/solar.el: Likewise.

	* calendar/calendar.el (calendar-day-abbrev-array): Remove trailing
	white space from doc string.

2005-03-30  Jay Belanger  <belanger@truman.edu>

	* calc/calc-help.el (calc-full-help): Remove email address.

2005-03-30  Thien-Thi Nguyen  <ttn@gnu.org>

	* help-fns.el (help-with-tutorial): Delete title line.

2005-03-30  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* calendar/cal-x.el (calendar-one-frame-setup)
	(calendar-only-one-frame-setup, calendar-two-frame-setup): Use t
	rather than 'symbol for set-window-dedicated-p.

	* calendar/appt.el (appt-buffer-name): Make it a constant.
	(appt-add): Doc fix.

	* filesets.el (filesets-menu-path, filesets-menu-before)
	(filesets-menu-in-menu): Doc fix.  Now valid in GNU Emacs.
	(filesets-menu-cache-file): Use directory ~/.emacs.d.
	(filesets-add-submenu): Delete and use add-submenu instead.

2005-03-30  Carsten Dominik  <dominik@science.uva.nl>

	* org.el (org-agenda-phases-of-moon, org-agenda-sunrise-sunset)
	(org-agenda-convert-date, org-agenda-goto-calendar): New commands.
	(org-diary-default-entry): New function.
	(org-get-entries-from-diary): Better parsing of diary entries.
	(org-agenda-check-no-diary): New function.
	("diary-lib"): Advice to function `add-to-diary-list', to allow
	linking to diary entries.
	(org-agenda-execute-calendar-command): New function.
	(org-agenda): Improve visible section in window.
	Use `org-fit-agenda-window'.
	(org-fit-agenda-window): New option.
	(org-move-subtree-down): Better handling of empty lines
	at end of subtree.
	(org-cycle): Numeric prefix is interpreted now as show-subtree N
	levels up.
	(org-fontify-done-headline): New option.
	(org-headline-done-face): New face.
	(org-set-font-lock-defaults): Use `org-headline-done-face'.
	(org-table-copy-down): Rename from `org-table-copy-from-above'.
	When current field is non-empty, it is copied to next row.
	(org-table-copy-from-above): Fix bug which made it
	impossible to copy fields containing only a single non-white character.

2005-03-30  Kim F. Storm  <storm@cua.dk>

	* kmacro.el (kmacro-end-macro): Isearch may store this command
	into the macro -- so ignore it when executing keyboard macro.

2005-03-30  Nick Roberts  <nickrob@snap.net.nz>

	* tooltip.el (tooltip-gud-display): Use gud-overlay-arrow-position.

2005-03-29  Kenichi Handa  <handa@m17n.org>

	* language/thai.el ("Thai"): Set setup-function and exit-function
	for Thai language environment.

	* language/thai-util.el: Require thai-word.
	(thai-word-mode-map): New variable.
	(thai-word-mode): New minor mode.
	(setup-thai-language-environment-internal): New function.
	(exit-thai-language-environment-internal): New function.

	* language/thai-word.el (thai-word-table): Declare it by defvar,
	use dolist to initialize it.
	(thai-kill-word, thai-backward-kill-word, thai-transpose-words)
	(thai-fill-find-break-point): New functions.

2005-03-29  Richard M. Stallman  <rms@gnu.org>

	* simple.el (idle-update-delay): Move definition up.
	(set-mark): Doc fix.

2005-03-29  Chong Yidong  <cyd@stupidchicken.com>

	* longlines.el: New file.

	* simple.el (buffer-substring-filters): New variable.
	(filter-buffer-substring): New function.
	(kill-region, copy-region-as-kill): Use it.

	* register.el (copy-to-register, append-to-register)
	(prepend-to-register): Use filter-buffer-substring.

2005-03-30  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gud.el (gdb): (Re)-initialize gud-filter-pending-text.
	(gud-filter-pending-text): Move in front of gdb.
	(gud-overlay-arrow-position): New variable.
	(gud-sentinel, gud-display-line): Use it in place of
	overlay-arrow-position.

2005-03-29  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* progmodes/fortran.el (fortran-if-indent): Doc fix.
	(fortran-font-lock-keywords-2): Add "where", "elsewhere".
	(fortran-font-lock-keywords-4): New variable.
	(fortran-blocks-re, fortran-end-block-re)
	(fortran-start-block-re): New constants, for hideshow.
	(hs-special-modes-alist): Add a Fortran entry.
	(fortran-mode-map): Bind fortran-end-of-block,
	fortran-beginning-of-block to \M-\C-n, \M-\C-p.
	(fortran-mode): Doc fix.  Add fortran-font-lock-keywords-4.
	(fortran-looking-at-if-then, fortran-end-of-block)
	(fortran-beginning-of-block): New functions, for hideshow.

	* progmodes/f90.el (f90-end-block-re, f90-start-block-re):
	Doc fix.  Tweak regexp.
	(f90-beginning-of-block): Push mark first.

2005-03-29  Jay Belanger  <belanger@truman.edu>

	* calc/calc.el: Update copyright date.
	(calc-version): Increase to 2.1.
	(calc-version-date): Remove.

	* calc/calc-help.el: Update copyright date.
	(calc-full-help): Remove reference to calc-version-date.
	Update copyright date.

2005-03-29  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc.el (vc-do-command): Use a pipe for async processes, so password
	prompts don't show up at places where the user can't reply.

2005-03-29  Olive Lin  <olive.lin@versateladsl.be>  (tiny change)

	* textmodes/tex-mode.el (tex-send-command): shell-quote-argument
	on the file name we pass to the inferior shell.

2005-03-29  Stephan Stahl  <stahl@eos.franken.de>  (tiny change)

	* progmodes/which-func.el (which-function): Be robust in the face of an
	imenu--make-index-alist failure.

2005-03-29  Stefan Monnier  <monnier@iro.umontreal.ca>

	* reveal.el (reveal-mode-map): Don't override C-a and C-e.

	* progmodes/python.el (python-preoutput-filter): Fix last change.

2005-03-29  Lute Kamstra  <lute@gnu.org>

	* emacs-lisp/debug.el (debug-on-entry): Handle autoloaded
	functions and compiled macros.
	(debug-convert-byte-code): Handle macros too.
	(debug-on-entry-1): Don't signal an error when trying to clear a
	function that is not set to debug on entry.

2005-03-29  Jay Belanger  <belanger@truman.edu>

	* calc/calc-lang.el: Add functions to math-function-table
	properties of tex and math.

2005-03-29  Kenichi Handa  <handa@m17n.org>

	* ps-mule.el (ps-mule-plot-string): Translate characters by
	ps-print-translation-table.
	(ps-mule-begin-job): Call find-charset-region/string with
	ps-print-translation-table.
	(ps-mule-printable-p): Return t if CHARSET is ascii or latin-iso8859-1.

	* ps-print.el (ps-print-translation-table): New variable.
	(ps-plot-region): Translate characters by ps-print-translation-table.

2005-03-29  Juri Linkov  <juri@jurta.org>

	* simple.el (next-error-highlight-timer): New variable.

	* progmodes/compile.el (compilation-goto-locus):
	Use `next-error-highlight-timer' instead of `sit-for'.

2005-03-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* mail/supercite.el (sc-mail-field): Use assoc-string.
	(sc-get-address): Simplify regexps.

	* files.el (minibuffer-with-setup-hook): New macro.
	(find-file-read-args): Use it to avoid let-binding
	minibuffer-with-setup-hook (which breaks turning on/off
	file-name-shadow-mode while in the prompt).

	* complete.el (PC-read-include-file-name-internal): Use test-completion.

2005-03-28  Luc Teirlinck  <teirllm@auburn.edu>

	* font-lock.el: Bind `font-lock-fontify-block' to M-o M-o.

2005-03-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* window.el (window-buffer-height): Use count-screen-lines.

	* progmodes/python.el (python-preoutput-leftover): New var.
	(python-preoutput-filter): Use it.
	(python-send-receive): Loop until all the result has been received.

2005-03-28  Juri Linkov  <juri@jurta.org>

	* dired.el (dired-mode-map): Add ellipsis to "Compare directories".

	* menu-bar.el (menu-bar-file-menu): Remove ellipsis from
	"Recover Crashed Session".
	(menu-bar-search-menu): Add ellipsis to "Search tagged files".
	(menu-bar-replace-menu): Add ellipsis to "Replace in tagged files".
	(menu-bar-goto-menu): Add ellipsis to "Set Tags File Name".
	(menu-bar-goto-menu): Add ellipsis to "Tags Apropos".
	(menu-bar-options-menu): Add ellipsis to "Set Font/Fontset".
	(menu-bar-manuals-menu): Add ellipsis to "Find Command in Manual".
	(menu-bar-manuals-menu): Add ellipsis to "Find Key in Manual".
	(menu-bar-help-menu): Remove ellipsis from "Find Emacs Packages".

	* ediff-hook.el (menu-bar-ediff-misc-menu, ediff-misc-menu):
	Remove ellipsis from "Ediff Manual", "Customize Ediff", "List
	Ediff Sessions", "Toggle use of separate control buffer frame",
	"Use separate frame for Ediff control buffer".

	* bookmark.el (menu-bar-bookmark-map): Add ellipsis to "Jump to
	Bookmark", "Set Bookmark", "Insert Contents", "Insert Location",
	"Rename Bookmark", "Delete Bookmark".

	* info.el (Info-mode-menu): Remove ellipsis from "Index".
	Add ellipsis to "Lookup a String", "Lookup a string in all indices".
	Add `:active Info-index-alternatives' to "Next Matching Item".

	* wdired.el (wdired-change-to-wdired-mode):
	Mention `wdired-abort-changes' key in the initial message.

	* international/mule.el (auto-coding-alist): Associate non-ascii
	image filename extensions with `no-conversion'.

2005-03-27  Stefan Monnier  <monnier@iro.umontreal.ca>

	* international/iso-acc.el:
	* obsolete/iso-acc.el: Move iso-acc to the obsolete subdir.

2005-03-26  Luc Teirlinck  <teirllm@auburn.edu>

	* textmodes/sgml-mode.el (html-mode): Doc update.

	* autorevert.el (auto-revert-check-vc-info): Minor doc fix.

2005-03-26  Dan Nicolaescu  <dann@ics.uci.edu>

	* term.el (term-move-columns): Fix face after extending a line.
	(term-insert-spaces): Likewise.
	(term-reset-terminal): Fix off by one error.

2005-03-26  Eli Zaretskii  <eliz@gnu.org>

	* international/mule.el (auto-coding-alist): Add .xpi files.

	* files.el (auto-mode-alist): Add .xpi files.

2005-03-26  Jure Cuhalev  <gandalf@owca.info>  (tiny change)

	* textmodes/ispell.el (ispell-dictionary-alist-6): Add slovenian.

2005-03-26  Eli Zaretskii  <eliz@gnu.org>

	* term/bobcat.el: Don't use keyswap.el, since it is now obsolete.

2005-03-26  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* calendar/cal-menu.el (top level): Delete local C-down-mouse-3
	binding.  Suggested by Stephan Stahl <stahl@eos.franken.de>.

	* calendar/cal-move.el (calendar-beginning-of-year): Move the
	cursor to Jan 1 when needed.
	(calendar-end-of-year): Fix -/+ typo.
	Reported by Chong Yidong <cyd@stupidchicken.com>.

2005-03-26  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/flymake.el (flymake-mode): Add autoload cookie.

	* emacs-lisp/debug.el (debugger-record-expression): Add a missing
	format to `message'.  Inspired by Deepak Goel <deego@gnufans.org>.

2005-03-25  Richard M. Stallman  <rms@gnu.org>

	* filesets.el (filesets-init): Add autoload.

	* mail/mailalias.el (mail-directory): Doc fix.

2005-03-25  Frederik Fouvry  <fouvry@CoLi.Uni-SB.DE>

	* mail/mailalias.el (mail-directory-process): Do nothing if
	mail-directory-process is an atom.
	(mail-get-names): Ignore mail-directory-names if it is an atom.
	(mail-directory-process defvar): Doc fix.
	(mail-names): Doc fix.

2005-03-25  Johan Bockg,Ae(Brd  <bojohan+mail@dd.chalmers.se>  (tiny change)

	* textmodes/flyspell.el (mail-mode-flyspell-verify): Fix regexp syntax.

2005-03-26  Kenichi Handa  <handa@m17n.org>

	* international/mule-util.el (detect-coding-with-priority):
	Call update-coding-systems-internal before detect-coding-region.

2005-03-26  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-breakpoints-mode-map)
	(gdb-frames-mode-map): Add follow-link property.

2005-03-25  Jay Belanger  <belanger@truman.edu>

	* calc/calcalg2.el (calc-solve-for): Use "Variable(s)" to prompt
	for variables.

2005-03-25  Juri Linkov  <juri@jurta.org>

	* image-mode.el: Optimize image filename extension regexps in
	autoload cookies.  Associate .x[bp]m with `image-mode-maybe'
	in `auto-mode-alist'.
	(image-mode): Add `image-toggle-display-text' to local hook
	`change-major-mode-hook'.  Display the image as an image by
	default.  Set `cursor-type' and `truncate-lines' if the image
	is already displayed.  Take into account the current mode (image
	or text) in message.
	(image-minor-mode): New minor mode.
	(image-mode-maybe, image-toggle-display-text): New functions.
	(image-toggle-display): Use called-interactively-p.
	Let-bind `inhibit-read-only' to t.

	* image-mode.el (image-minor-mode): Set `cursor-type' and
	`truncate-lines' if the image is already displayed.  Add turning
	image-minor-mode off to `change-major-mode-hook'.  Add message.
	Call `image-toggle-display-text' after turning image-minor-mode off.

2005-03-25  Stefan Monnier  <monnier@iro.umontreal.ca>

	* international/mule-cmds.el (set-locale-environment): For Mac OS X's
	Terminal.app, use utf-8.
	(set-display-table-and-terminal-coding-system): Add coding-system arg.
	(set-locale-environment): Use it.

	* term/xterm.el: Undo last change, better done in mule-cmds.el.

	* emacs-lisp/rx.el (rx-constituents): Add symbol-start and symbol-end.

	* progmodes/python.el (python-close-block-statement-p)
	(python-outdent-p, python-current-defun): Use symbol-end.

2005-03-25  Karl Chen  <quarl@cs.berkeley.edu>  (tiny change)

	* files.el (save-some-buffers): Doc fix.

2005-03-25  Werner Lemberg  <wl@gnu.org>

	* complete.el, thumbs.el: Replace `legal' with `valid'.
	* calendar/calendar.el: Replace `legal' with `valid'.
	* emacs-lisp/advice.el: Replace `legal' with `valid'.
	* mail/supercite.el: Replace `legal' with `valid'.
	* progmodes/cperl-mode.el, progmodes/idlw-shell.el
	* progmodes/idlwave.el, progmodes/vhdl-mode.el:
	Replace `legal' with `valid'.
	* textmodes/reftex-vars.el, textmodes/reftex.el:
	Replace `legal' with `valid'.

2005-03-25  Werner Lemberg  <wl@gnu.org>

	* calc/calc-forms.el, calc/calc-sel: Replace `illegal' with `invalid'.
	* midnight.el, vc-cvs.el: Replace `illegal' with `invalid'.
	* emacs-lisp/cl-macs.el: Replace `illegal' with `invalid'.
	* emulation/vip.el: Replace `illegal' with `invalid'.
	* eshell/esh-io.el, eshell/esh-var.el: Replace `illegal' with `invalid'.
	* mail/supercite.el: Replace `illegal' with `invalid'.
	* progmodes/ebnf-abn.el, progmodes/ebnf-bnf.el
	* progmodes/ebnf-ebx.el, progmodes/ebnf-dtd.el, progmodes/ebnf-iso.el
	* progmodes/ebnf-yac.el, progmodes/ebnf2ps.el, progmodes/idlwave.el
	* progmodes/sh-script.el, progmodes/xscheme.el:
	Replace `illegal' with `invalid'.
	* textmodes/refbib.el, textmodes/refer.el, textmodes/reftex-cite.el
	* textmodes/reftex-index.el, textmodes/reftex-parse.el
	* textmodes/reftex-ref.el, textmodes/reftex-vars.el
	* textmodes/reftex.el, textmodes/org.el:
	Replace `illegal' with `invalid'.

2005-03-24  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/flymake.el (flymake-get-file-name-mode-and-masks)
	(flymake-find-buildfile, flymake-find-possible-master-files)
	(flymake-check-include, flymake-parse-line): Replace loops over the
	length of lists, by loops over lists, to remove silly O(n,A2(B) behavior.

	* progmodes/flymake.el (flymake-ensure-ends-with-slash): Remove.
	Substitute file-name-as-directory in the rest of the file.
	(flymake-get-common-file-prefix): Rewrite, using compare-strings.
	(flymake-replace-region): Remove unused arg `buffer'.
	(flymake-check-patch-master-file-buffer): Update calls to it.
	(flymake-add-err-info): Remove unused var `count'.
	(flymake-mode): Use define-minor-mode.

	* progmodes/flymake.el: Use with-current-buffer.
	(flymake-float-time, flymake-get-temp-dir, flymake-line-end-position)
	flymake-replace-regexp-in-string, flymake-line-beginning-position)
	(flymake-popup-menu, flymake-current-row, flymake-selected-frame):
	Avoid testing for `xemacs'.
	(flymake-nop): Move.
	(flymake-region-has-flymake-overlays): Return the computed value.
	(flymake-reformat-err-line-patterns-from-compile-el): Use dolist.
	Remove unused var `endline'.
	(flymake-get-line-count): Remove unused function.
	(flymake-display-err-menu-for-current-line): Unused var move-mouse-pos.

	* emulation/vi.el:
	* generic.el:
	* hilit-chg.el (global-highlight-changes):
	* hi-lock.el (hi-lock-mode):
	* follow.el: find-file-hooks -> find-file-hook.

	* comint.el (comint-insert-input): Obey mouse-yank-at-point.

2005-03-24  Juri Linkov  <juri@jurta.org>

	* dired.el (dired-mode-map): Add menu item "Compare directories"
	for dired-compare-directories.

	* dired-aux.el (dired-compare-directories): Add autoload cookie.
	Doc fix.  Replace `read-file-name' with `read-directory-name'.

2005-03-24  Stefan Monnier  <monnier@iro.umontreal.ca>

	* term/xterm.el: If running in Terminal.app set coding-system to utf-8.

2005-03-24  Jay Belanger  <belanger@truman.edu>

	* calc/calc-embed.el (calc-embedded-mode-change): Save all
	relevant mode settings in calc-embedded-original-modes when modes
	are permanently changed.

2005-03-24  Stefan Monnier  <monnier@iro.umontreal.ca>

	* autoinsert.el: find-file-hooks -> find-file-hook.

2005-03-24  Lute Kamstra  <lute@gnu.org>

	* generic.el (generic-font-lock-defaults): Make it obsolete.
	(generic-font-lock-keywords): New variable to replace
	generic-font-lock-defaults.
	(generic-mode-set-font-lock): Delete it.
	(generic-mode-internal): Don't call generic-mode-set-font-lock.
	(generic-bracket-support): Add docstring.

	* generic-x.el: Rename generic-font-lock-defaults to
	generic-font-lock-keywords throughout.
	(mailagent-rules-setup-function): Delete it.
	(mailagent-rules-generic-mode): Use anonymous function instead.
	(show-tabs-generic-mode-font-lock-defaults-1)
	(show-tabs-generic-mode-font-lock-defaults-2): Make them constants.
	Quote faces.
	(show-tabs-tab-face, show-tabs-space-face): Specify background,
	not foreground.

	* emacs-lisp/lisp-mode.el (lisp-imenu-generic-expression):
	Recognize define-generic-mode.

2005-03-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* icomplete.el (icomplete-simple-completing-p): Don't turn on icomplete
	if there's no completion table.

2005-03-23  Miles Bader  <miles@gnu.org>

	* progmodes/gdb-ui.el (breakpoint-enabled, breakpoint-disabled):
	Remove tty-specific variants, as they're no longer needed.

2005-03-23  Lute Kamstra  <lute@gnu.org>

	* generic-x.el: Code cleanup: make args constant whenever possible.
	(installshield-statement-keyword-list)
	(installshield-system-functions-list)
	(installshield-system-variables-list, installshield-types-list)
	(installshield-funarg-constants-list): Make them constants.

	* generic.el (generic-make-keywords-list): Add autoload cookie.

	* calendar/time-date.el: Add comment on time value formats.
	Don't require parse-time.
	(with-decoded-time-value): New macro.
	(encode-time-value): New function.
	(time-to-seconds, time-less-p, time-subtract, time-add): Use them.
	(days-to-time): Return a valid time value when arg is huge.
	(time-since): Use time-subtract.
	(time-to-number-of-days): Use time-to-seconds.

2005-03-23  David Ponce  <david@dponce.com>

	* recentf.el: (recentf-keep): New option.
	(recentf-menu-action): Default to `find-file'.
	(recentf-keep-non-readable-files-flag)
	(recentf-keep-non-readable-files-p)
	(recentf-file-readable-p, recentf-find-file)
	(recentf-cleanup-remote): Remove.
	(recentf-include-p): More robust.
	(recentf-keep-p): New function.
	(recentf-remove-if-non-kept): Rename from
	`recentf-remove-if-non-readable'.  Use `recentf-keep-p'.
	All callers updated.
	(recentf-menu-items-for-commands): Fix help string.
	(recentf-track-closed-file): Update.  Doc fix.
	(recentf-cleanup): Update.  Count removed files.  Doc fix.

2005-03-23  Kim F. Storm  <storm@cua.dk>

	* progmodes/gdb-ui.el (breakpoint-enabled, breakpoint-disabled):
	Don't inherit from fringe face (now happens automatically).

2005-03-22  Kim F. Storm  <storm@cua.dk>

	* tooltip.el (tooltip-show-help-function): Ignore negative mouse
	position values.

2005-03-22  Stefan Monnier  <monnier@iro.umontreal.ca>

	* menu-bar.el (showhide-date-time): Remove.
	(menu-bar-showhide-menu): Use menu-bar-make-mm-toggle.
	(menu-bar-make-mm-toggle): Simplify.

2005-03-22  JUAN-LEON Lahoz Garcia  <juanleon1@gmail.com>

	* progmodes/perl-mode.el (perl-font-lock-keywords-2):
	Accept qualified variable and function names.

2005-03-22  Thien-Thi Nguyen  <ttn@gnu.org>

	* bindings.el (completion-ignored-extensions):
	Remove ".lis" for `vax-vms'.

2005-03-22  Andreas Schwab  <schwab@suse.de>

	* generic-x.el: Revert last change.
	* ldefs-boot.el: Update.

2005-03-22  Jay Belanger  <belanger@truman.edu>

	* calc/calc-embed (calc-embedded-original-modes): New variable.
	(calc-embedded-save-original-modes)
	(calc-embedded-restore-original-modes): New functions.
	(calc-do-embedded): Save original modes when entering embedded mode
	and restore when leaving embedded mode.
	(calc-embedded-modes-change): Change the value of
	calc-embedded-original-modes to reflect permanent changes.

2005-03-22  Lute Kamstra  <lute@gnu.org>

	* generic-x.el: Require generic again.

2005-03-22  Miles Bader  <miles@gnu.org>

	* progmodes/gdb-ui.el (breakpoint-enabled, breakpoint-disabled):
	Tweak details to look good on both ttys and bitmap displays, light
	or dark background, etc.

2005-03-21  Kim F. Storm  <storm@cua.dk>

	* tooltip.el (tooltip-show-help-function): Check car and cdr of
	mouse position.

2005-03-21  Stefan Monnier  <monnier@iro.umontreal.ca>

	* icomplete.el: Don't forcibly turn on the mode upon load.
	(icomplete-mode): Use define-minor-mode.
	(icomplete-eoinput): Default to nil.
	(icomplete-minibuffer-setup): Remove autoload.
	(icomplete-tidy): Simplify.
	(icomplete-exhibit): Use buffer-undo-list to determine if we're still
	in the initial state or if the user has modified the field.
	Fix handling of icomplete-max-delay-chars.
	Remove code that handles the oddball case where
	minibuffer-completion-table is an integer.
	Wrap icomplete-completions in while-no-input in case building
	completions takes more time than expected.
	(icomplete-completions): Simplify.

2005-03-21  Richard M. Stallman  <rms@gnu.org>

	* jka-compr.el (jka-compr-really-do-compress):
	Make variable buffer-local.

	* image-mode.el: Handle .xpm files too.
	(image-toggle-display): Preserve modification flag.

	* help.el (where-is): Don't mention aliases with no key bindings.

2005-03-21  Lute Kamstra  <lute@gnu.org>

	* generic.el: Fix commentary section.  Don't require cl for compilation.
	(generic-mode-list): Add autoload cookie.
	(generic-use-find-file-hook, generic-lines-to-scan)
	(generic-find-file-regexp, generic-ignore-files-regexp)
	(generic-mode, generic-mode-find-file-hook)
	(generic-mode-ini-file-find-file-hook): Fix docstrings.
	(define-generic-mode): Make it a defmacro.  Fix docstring.
	(generic-mode-internal): Code cleanup.  Add autoload cookie.
	(generic-mode-set-comments): Code cleanup.
	* generic-x.el: Don't prevent compilation.  Don't require generic.
	Follow coding conventions.  Minor code cleanup.
	(etc-fstab-generic-mode): Add some keywords.
	* font-lock.el (lisp-font-lock-keywords-1): Font lock a call to
	define-generic-mode like a function declaration.

2005-03-21  Jay Belanger  <belanger@truman.edu>

	* calc/calc-embed.el (calc-do-embedded): Put data on stack before
	changing modes.

2005-03-21  Sam Steingold  <sds@gnu.org>

	* add-log.el (add-log-current-defun): Support more C DEFUN forms.

2005-03-21  Thien-Thi Nguyen  <ttn@gnu.org>

	* progmodes/dcl-mode.el (dcl-font-lock-keywords):
	Add underscore to "f$ lexicals" regexp.

2005-03-20  Juri Linkov  <juri@jurta.org>

	* subr.el (progress-reporter-do-update): When `min-value' is equal
	to `max-value', set `percentage' to 0 and prevent division by zero.

2005-03-20  Michael Albinus  <michael.albinus@gmx.de>

	Sync with Tramp 2.0.48.

	* tramp.el (all): Change all addresses to .gnu.org.
	(tramp-append-tramp-buffers): New defun.
	(tramp-bug): Apply `tramp-append-tramp-buffers' as post-hook.
	Catch `dont-send' signal.
	(tramp-set-auto-save-file-modes): Set always permissions, because
	there might be an old auto-saved file belonging to another
	original file.  This could be a security threat.  Reported by
	Kjetil Kjernsmo <kjetil@kjernsmo.net>.
	Check for Emacs 21.3.50 removed.

	* tramp-smb.el (all): Remove debug construct for
	`with-parsed-tramp-file-name'.
	(tramp-smb-prompt): Prompt can contain spaces inside directory names.
	(tramp-smb-handle-delete-directory, tramp-smb-handle-delete-file):
	No error message if DIRECTORY or FILENAME doesn't exist.
	(tramp-smb-open-connection): Check existence of
	`tramp-smb-program'.

2005-03-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/perl-mode.el (perl-font-lock-syntactic-face-function):
	Properly handle the case where the `m' or `s' command's argument is not
	yet terminated.
	(perl-indent-new-calculate): New function.
	(perl-indent-line): Use it.

2005-03-20  Miles Bader  <miles@gnu.org>

	* progmodes/gdb-ui.el (gdb-put-breakpoint-icon): Use breakpoint faces
	in text-mode too.  Change to new face names.
	(breakpoint-enabled): Rename from `breakpoint-enabled-bitmap-face'.
	Add `:weight bold' attribute.
	(breakpoint-disabled): Rename from `breakpoint-disabled-bitmap-face'.

2005-03-19  Juri Linkov  <juri@jurta.org>

	* files.el (auto-mode-alist): Add comment.  Optimize jar/ear/war.

	* international/mule.el (auto-coding-alist): Sync with
	`auto-mode-alist' by adding upper case archive file extensions
	and adding ear/war to jar extension.

2005-03-19  David Casperson  <casper@unbc.ca>  (tiny change)

	* textmodes/tex-mode.el (tex-view): If tex-shell process is not
	running, restart it.

2005-03-19  Yoichi NAKAYAMA  <yoichi@geiin.org>  (tiny changes)

	* finder.el (finder-current-item): Throw an error on an empty line.

	* man.el (Man-follow-manual-reference): If current-word returns
	nil, use "".

2005-03-19  Matt Hodges  <MPHodges@member.fsf.org>

	* simple.el (goto-line): Doc fix.

2005-03-19  Aaron Hawley  <Aaron.Hawley@uvm.edu>  (tiny change)

	* files.el (save-buffer): Doc fix.

2005-03-19  Michael R. Mauger  <mmaug@yahoo.com>

	* recentf.el (recentf-cleanup-remote): New variable.
	(recentf-cleanup): Use it to conditionally check availability of
	remote files.

2005-03-19  Joe Edmonds  <joe-bugs-debian-org@elem.com>  (tiny change)

	* emacs-lisp/lisp-mode.el (lisp-mode-variables): Recognize `@' in
	function names.

2005-03-19  Eli Zaretskii  <eliz@gnu.org>

	* language/thai-word.el: New file.

2005-03-19  JUAN-LEON Lahoz Garcia  <juanleon1@gmail.com>

	* files.el (backup-buffer): If the file's directory is not
	writable, use copy instead of move to backup the file.

2005-03-19  Eli Zaretskii  <eliz@gnu.org>

	* obsolete/keyswap.el: Moved to obsolete/ from term/.

2005-03-19  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-print.el (ps-generate-string-list, ps-generate-header-line):
	Use functionp instead of symbolp and fboundp.  Reported by Drkm
	<darkman_spam@yahoo.fr>.
	(ps-print-version): New version 6.6.6.

2005-03-18  Tak Ota  <Takaaki.Ota@am.sony.com>

	* textmodes/table.el (table--line-column-position): New idiom.
	(table--row-column-insertion-point-p): New function to test
	validity of row and column insertion operation at a location.
	(table-global-menu, table-cell-menu): Use above functions for
	deterministic test operation.
	(table--editable-cell-p): Behave in deterministic fashion.

2005-03-18  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-lazy-highlight-new-loop):
	Make arguments beg and end optional.
	(isearch-update): Remove optional arguments nil from
	isearch-lazy-highlight-new-loop.
	(isearch-lazy-highlight-search): Let-bind case-fold-search to
	isearch-lazy-highlight-case-fold-search instead of
	isearch-case-fold-search, and let-bind isearch-regexp to
	isearch-lazy-highlight-regexp.
	Use isearch-lazy-highlight-last-string instead of isearch-string.

	* replace.el (perform-replace): Remove bindings of global
	variables isearch-string, isearch-regexp, isearch-case-fold-search.
	Add three new arguments to `replace-highlight'.
	(replace-highlight): Add arguments string, regexp, case-fold.
	Let-bind isearch-string, isearch-regexp, isearch-case-fold-search
	to allow isearch-lazy-highlight-new-loop to use these values
	to set corresponding isearch-lazy-highlight-* internal
	variables whose values lazy highlighting will use regardless of
	changes to global variables isearch-string, isearch-regexp,
	isearch-case-fold-search during lazy highlighting loop.
	(replace-dehighlight): Rename `isearch-lazy-highlight-cleanup'
	to `lazy-highlight-cleanup'.

	* textmodes/ispell.el (ispell-lazy-highlight): New defcustom.
	(ispell-highlight-face): Set default face to `isearch' when
	lazy highlighting is enabled.
	(ispell-highlight-spelling-error-overlay): Set `ispell-overlay'
	priority to 1.  Add lazy highlighting.
	(ispell-highlight-spelling-error-xemacs): Remove obsolete arg
	from `isearch-dehighlight'.

2005-03-18  David Ponce  <david@dponce.com>

	* files.el (hack-local-variables): Do a case-insensitive search
	for End.

2005-03-18  Juri Linkov  <juri@jurta.org>

	* isearch.el (lazy-highlight-cleanup) <command>: Rename from
	`isearch-lazy-highlight-cleanup', add alias to old name and
	declare obsolete.  Add release numbers to other obsolete vars.
	(isearch-done, isearch-lazy-highlight-new-loop):
	Rename `isearch-lazy-highlight-cleanup' to `lazy-highlight-cleanup'.
	(lazy-highlight-cleanup) <variable>: Doc fix.
	(isearch-lazy-highlight-update): Rename obsolete
	`isearch-lazy-highlight-face' to `lazy-highlight-face'.

2005-03-18  Kenichi Handa  <handa@m17n.org>

	* language/thai-util.el: Fix categorization of Thai characters in
	thai-category-table.
	(thai-composition-pattern): Adjust it for the above change.
	(thai-self-insert-command, thai-compose-syllable): New functions.
	(thai-compose-region): Use thai-compose-syllable.
	(thai-compose-string): Likewise.
	(thai-composition-function): Likewise.
	(thai-auto-composition): New function.
	(thai-auto-composition-mode): New minor mode.

	* language/thai.el: Fix patterns to be registered in
	composition-function-table.

	* international/quail.el (quail-input-method): Locally bind
	inhibit-modification-hooks to t.

2005-03-17  Richard M. Stallman  <rms@gnu.org>

	* progmodes/perl-mode.el (perl-mode-hook): Defvar it.
	(perl-mode): Use run-mode-hooks.

	* mail/rmail.el (rmail-movemail-program, rmail-pop-password)
	(rmail-pop-password-required, rmail-remote-password): Doc fixes.
	(rmail-preserve-inbox, rmail-probe, rmail-autodetect): Doc fix.

	* mail/sendmail.el (sendmail-send-it): Reenable the code
	to compute resend-to-address and use it.

	* tar-mode.el (tar-mode): Turn off undo unconditionally.

	* image-mode.el: New file.

	* image.el (insert-sliced-image): Add autoload cookie.

	* font-lock.el (font-lock-lines-before): New user option.
	(font-lock-after-change-function): Obey it.

	* bindings.el (esc-map): Make M-g a prefix.
	Bind M-g g and M-g M-g to goto-line.

	* faces.el (face-id): Doc fix.

2005-03-17  Frederik Fouvry  <fouvry@CoLi.Uni-SB.DE>

	* mail/rmail.el (rmail-unknown-mail-followup-to): New function.
	(rmail-show-message): Use rmail-unknown-mail-followup-to.
	(rmail-reply): Recognize Mail-Followup-To and Mail-Reply-To headers.

	* mail/sendmail.el (mail-yank-ignored-headers)
	(mail-font-lock-keywords, mail-mode-fill-paragraph):
	Add Mail-Followup-To and Mail-Reply-To headers.
	(mail-citation-hook): Add autoload cookie.
	(mail-mode): Doc fix.
	(mail-mode-map): Bind mail-mail-followup-to and mail-mail-reply-to.
	(mail-send): Compute Mail-Followup-To and Mail-Reply-To headers.
	(mail-mode-fill-paragraph): Handle those headers.
	(mail-mailing-lists): New variable.
	(mail-mail-reply-to, mail-mail-followup-to): New functions.

2005-03-17  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-fallback): Check for `(car previous)'
	before calling `isearch-other-end-state'.

2005-03-17  Kim F. Storm  <storm@cua.dk>

	* simple.el (move-beginning-of-line): Move to beginning of buffer
	line, as well as beginning of screen line.

2005-03-16  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* calendar/diary-lib.el (mark-diary-entries): Use new optional
	argument REDRAW rather than calendar-redrawing variable.
	* calendar/calendar.el (calendar-redrawing): Delete.
	(redraw-calendar): Do not bind calendar-redrawing.

2005-03-16  Matt Hodges  <MPHodges@member.fsf.org>

	* calendar/diary-lib.el (diary-redraw-calendar): Preserve point in
	diary-file buffer.

2005-03-16  Stefan Monnier  <monnier@iro.umontreal.ca>

	* help.el (describe-mode): Allow a :minor-mode-function property to
	specify a different minor mode toggle function than the variable.
	* simple.el (auto-fill-function):
	* subr.el (add-minor-mode): Use it.

2005-03-16  Kenichi Handa  <handa@m17n.org>

	* language/ethio-util.el (sera-being-called-by-w3): New variable.
	(ethio-sera-to-fidel-ethio): Check also sera-being-called-by-w3.
	(ethio-fidel-to-sera-buffer): Likewise.

2005-03-16  Juri Linkov  <juri@jurta.org>

	* emacs-lisp/find-func.el (find-function-regexp):
	Add defun-emitting macro `menu-bar-make-toggle'.

	* isearch.el: Put `isearch-scroll' property to
	`split-window-horizontally'.

	* info.el: Update error messages for `debug-ignored-errors'.
	(Info-isearch-search): Doc fix.
	(Info-find-node): Move up code to go into info buffer before
	recording the node to the history.
	(Info-fontify-node): Fontify titles only if the next line
	has two or more `*', `=', `-', `.'.
	Display "go to this node" for empty (match-string 3).

2005-03-16  YAMAMOTO Mitsuharu  <mituharu@math.s.chiba-u.ac.jp>

	* term/mac-win.el: Add mouse pointer shape constants.

2005-03-15  Kim F. Storm  <storm@cua.dk>

	* simple.el (move-beginning-of-line): Use vertical-motion.

2005-03-15  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-error): New variable.
	(isearch-invalid-regexp, isearch-within-brackets): Remove.
	(isearch-error-state): Rename from `isearch-invalid-regexp-state'.
	(isearch-within-brackets-state): Remove.
	(isearch-case-fold-search-state, isearch-pop-fun-state):
	Decrease frame index.
	(isearch-mode, isearch-top-state, isearch-push-state)
	(isearch-edit-string, isearch-abort, isearch-search-and-update)
	(isearch-fallback, isearch-message-prefix, isearch-message-suffix)
	(isearch-search, isearch-lazy-highlight-new-loop):
	Replace `isearch-invalid-regexp' with `isearch-error'.
	Remove `isearch-within-brackets'.
	(isearch-search): Add `search-failed' handler to `condition-case'.
	(isearch-lazy-highlight-search): Add `condition-case' to catch
	errors and allow `isearch-lazy-highlight-update' to try
	highlighting from the beginning of the window.
	(isearch-repeat): Move up code to set isearch-wrapped to t
	before calling isearch-wrap-function.

	* info.el (Info-isearch-initial-node): New internal variable.
	(Info-search): Signal an error in isearch mode when search leaves
	the initial node.  Signal an error when `bound' is non-nil and
	nothing was found in the current subfile.
	(Info-isearch-search): Remove `condition-case'.
	(Info-isearch-wrap): Don't wrap when search failed during leaving
	the initial node.  If `Info-isearch-search' is nil, wrap around
	the current node.
	(Info-isearch-start): New fun.
	(Info-mode): Add buffer-local hook `Info-isearch-start' to
	`isearch-mode-hook'.

2005-03-15  YAMAMOTO Mitsuharu  <mituharu@math.s.chiba-u.ac.jp>

	* simple.el (normal-erase-is-backspace): Set default to t if
	running on Mac.

	* term/mac-win.el (function-key-map): Sync with x-win.el.

2005-03-15  Kenichi Handa  <handa@m17n.org>

	* international/mule-cmds.el (locale-language-names): Modify the
	format of elements and add more entries.
	(locale-preferred-coding-systems): Add more entries.
	(set-locale-environment): Adjust for the change of
	locale-language-names.

2005-03-14  Stefan Monnier  <monnier@iro.umontreal.ca>

	* pcvs.el (smerge-ediff): Remove bogus autoload.

2005-03-14  Lute Kamstra  <lute@gnu.org>

	* emacs-lisp/debug.el (debugger-make-xrefs): Docstring fix.
	Ignore a `*' at the beginning of a line.

	* subr.el (macro-declaration-function): Move to emacs-lisp/byte-run.el.
	* emacs-lisp/byte-run.el (macro-declaration-function): Move from
	subr.el.
	(dont-compile, eval-when-compile, eval-and-compile): Use declare
	to specify indentation.

	* generic.el (define-generic-mode): Let generic-mode-list be a
	list of strings; test membership with equal.

2005-03-14  Kim F. Storm  <storm@cua.dk>

	* simple.el (next-line, previous-line): Add optional try-vscroll
	arg to recognize interactive use.  Pass it on to line-move.
	(line-move): Don't perform auto-window-vscroll when defining or
	executing keyboard macro to ensure consistent behavior.

2005-03-13  Stefan Monnier  <monnier@iro.umontreal.ca>

	* pcvs-util.el (cvs-string->strings): Strip trailing whitespace.

2005-03-13  Lute Kamstra  <lute@gnu.org>

	* emacs-lisp/debug.el (debug): Set debug-on-exit before calling
	debugger-setup-buffer so that backtrace marks the frames set to
	debug-on-exit and we don't have to do it manually.  Set an extra
	debug-on-exit for macro's.
	(debugger-setup-buffer): Don't mark the top frame manually.

2005-03-12  Lute Kamstra  <lute@gnu.org>

	* emacs-lisp/byte-run.el: Replace lisp-indent-hook with
	lisp-indent-function throughout.
	(with-no-warnings): Set lisp-indent-function property.

2005-03-12  Thien-Thi Nguyen  <ttn@gnu.org>

	* progmodes/dcl-mode.el (dcl-mode-syntax-table):
	Add entry for backslash.

2005-03-12  Juri Linkov  <juri@jurta.org>

	* info.el (Info-search): Four fixes for backward search.

2005-03-11  Jay Belanger  <belanger@truman.edu>

	* calc/calc.el (calc-language-alist): New variable.
	* calc/calc-embed.el (calc-embedded-language-alist): Remove.
	(calc-embedded-find-modes): Use calc-language-alist instead of
	calc-embedded-language-alist.

2005-03-11  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* calendar/calendar.el (calendar-redrawing): New internal
	variable.
	(redraw-calendar): Remove bogus save-excursion from previous
	change.  Bind calendar-redrawing to t for mark-diary-entries.
	* calendar/diary-lib.el (mark-diary-entries): No need to redraw
	calendar if that is why we were called.

2005-03-11  Kenichi Handa  <handa@m17n.org>

	* international/mule.el (make-coding-system): Set property
	coding-system-define-form to nil.
	(define-coding-system-alias): Likewise.

2005-03-11  Kenichi Handa  <handa@m17n.org>

	These changes are suggested by Dave Love <fx@gnu.org>.

	* textmodes/fill.el: Change encoding to iso-2022-7bit and add
	coding: tag.
	(adaptive-fill-regexp): Add more bullets.
	(fill-french-nobreak-p): Add Latin-1 and Latin-9 guillemets in
	regexps.

2005-03-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* help.el (describe-mode): Properly handle non-trivial lighters.
	Don't ignore minor modes that are not listed in minor-mode-list.

	* tooltip.el (tooltip-mode): Don't complain that you can't turn the
	feature ON when the user requests to turn it OFF.

2005-03-10  Lute Kamstra  <lute@gnu.org>

	* emacs-lisp/debug.el (debug-entry-code): Delete it.
	(implement-debug-on-entry): New function to replace debug-entry-code.
	(debug-on-entry-1): Use implement-debug-on-entry.  Delete the
	second argument as the 2005-03-07 change makes it obsolete.
	(debug-on-entry, cancel-debug-on-entry): Update call to
	debug-on-entry-1.
	(debug, debugger-setup-buffer): Comment update.
	(debugger-frame-number): Update to work with implement-debug-on-entry.

2005-03-10  Jay Belanger  <belanger@truman.edu>

	* calc/calc-embed.el (math-ms-args): Declare it.
	(calc-embedded-eval-expr, calc-embedded-eval-get-var): Use variable
	math-ms-args.
	(calc-embedded-subst): Use math-multi-subst-rec to substitute
	variables.

2005-03-10  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-var-create-handler, gdb-get-location):
	Use message-box.

	* tooltip.el (tooltip-mode): Use define-minor-mode and simplify.
	(tooltip-activate-mouse-motions-if-enabled): Use dolist.
	(tooltip-gud-tips): Simplify.
	(tooltip-gud-tips-p): Remove superfluous :set.
	(tooltip-gud-modes): Add fortran-mode.
	(gdb-tooltip-print): Remove newline for tooltip-use-echo-area.

	* bindings.el (mode-line-mode-menu): Add tooltip-mode to mode-line.

2005-03-09  Kim F. Storm  <storm@cua.dk>

	* play/animate.el (animate-place-char): Use forward-line instead
	of next-line to improve performance.

2005-03-09  Simon Josefsson  <jas@extundo.com>

	* net/browse-url.el (browse-url-default-browser): Doc fix.

2005-03-09  Miles Bader  <miles@gnu.org>

	* emacs-lisp/bytecomp.el (byte-compile-variable-ref)
	(byte-compile-obsolete): Change " since VER" to " (as of Emacs VER)".

2005-03-09  Kenichi Handa  <handa@m17n.org>

	* international/latin-1.el: Set case and syntax for 255 only if
	set-case-syntax-set-multibyte is nil.

	* textmodes/ispell.el (ispell-insert-word): New function.
	(ispell-word): Use ispell-insert-word to insert a new word.
	(ispell-process-line): Likewise.
	(ispell-complete-word): Likewise.

2005-03-09  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* calendar/calendar.el (redraw-calendar): Preserve point.
	Reported by Matt Hodges <MPHodges@member.fsf.org>.
	(calendar-week-start-day): Move after definition of
	redraw-calendar.  Delete buffer test, since redraw-calendar has
	that now.

	* calendar/diary-lib.el (mark-diary-entries): Only call
	redraw-calendar in the first of any recursive calls.
	Reported by Alan Shutko <ats@acm.org>.

2005-03-08  Juri Linkov  <juri@jurta.org>

	* textmodes/sgml-mode.el (sgml-tag, html-tag-alist)
	(html-horizontal-rule, html-line, html-image, html-checkboxes)
	(html-radio-buttons): Add a space before the trailing `/>' where
	sgml-xml-mode is non-nil.
	(sgml-delete-tag): Check if the tag ends with `/>' to not delete
	the subsequent tag of the empty XML tag.
	(html-href-anchor): Don't set initial input to "http:".
	(html-image): Ask for the image URL and set point inside alt="".
	(html-name-anchor): Duplicate the name in the `id' attribute when
	sgml-xml-mode is non-nil.
	(html-paragraph): Remove \n before <p>.
	(html-checkboxes, html-radio-buttons): Insert `checked="checked"'
	instead of `checked' when sgml-xml-mode is non-nil.

	* facemenu.el (list-colors-print): Print #RRGGBB in default face.
	Remove 1 space before #RRGGBB to not truncate it on terminal
	windows w/o fringes.  Remove 1 space between bg and fg examples
	to get more space.
	(list-colors-duplicates): Replace `and' with `if' for `boundp' to
	avoid byte-compile warnings.

	* image-file.el (image-file-handler): Put `safe-magic' property to
	`image-file-handler'.

	* info.el (Info-isearch-search): Emulate word search in
	isearching through multiple Info nodes with Info-search.
	(Info-isearch-wrap): Allow isearch-word.

2005-03-08  Lute Kamstra  <lute@gnu.org>

	* emacs-lisp/debug.el (debugger-step-through): Make sure that
	stepping into the debugger's code is not possible.
	(debugger-jumping-flag): Docstring update.

2005-03-08  Jay Belanger  <belanger@truman.edu>

	* calc/calc-embed.el (calc-do-embedded): Reset mode line when
	embedded mode begins.
	(calc-embedded-language-alist): New variable.
	(calc-embedded-find-modes): Use calc-embedded-language-alist to
	set default language mode.

2005-03-08  Kenichi Handa  <handa@m17n.org>

	* international/ccl.el (define-ccl-program): Fix docstring about
	extra 256 bytes assured for the output buffer.

	* international/utf-16.el (ccl-encode-mule-utf-16le-with-signature):
	Fix BUFFER_MAGNIFICATION to 2.
	(ccl-encode-mule-utf-16be-with-signature): Likewise.

2005-03-07  Karl Chen  <quarl@cs.berkeley.edu>

	* align.el (align-rules-list): Added an alignment rule for CSS
	declarations (applies to css-mode and html-mode buffers).

2005-03-07  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/debug.el (debug-on-entry-1): Fix handling of macros.

2005-03-07  Kim F. Storm  <storm@cua.dk>

	* simple.el (move-beginning-of-line): New command.

	* bindings.el (global-map): Bind C-a to move-beginning-of-line.

	* reveal.el (reveal-mode-map): Bind C-a to beginning-of-line.

	* emulation/cua-base.el: Put CUA move property on move-end-of-line
	and move-beginning-of-line.

	* apropos.el (apropos-print): Omit command from M-x ... RET.

2005-03-07  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-var-create-handler): Handle just MI case.
	(gdb-send, gdb-send-item): Log items sent from gdb-send too.

2005-03-06  Richard M. Stallman  <rms@gnu.org>

	* bindings.el (esc-map): Bind M-g to goto-line.

	* facemenu.el (global-map): Bind M-o, not M-g.

2005-03-06  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* menu-bar.el (menu-bar-file-menu): Add the same :enable to
	"Open Directory" as for "Open File".

2005-03-06  Chong Yidong  <cyd@stupidchicken.com>

	* simple.el (activate-mark-hook, deactivate-mark-hook): Add defvars.
	(push-mark-command): Run activate-mark-hook.

2005-03-06  Richard M. Stallman  <rms@gnu.org>

	* help-mode.el (help-mode-finish): Don't alter the element
	in view-return-to-alist if there already is one.

	* jit-lock.el (jit-lock-stealth-fontify): When calling sit-for,
	make sure the current buffer is the expected one.

	* novice.el (disabled-command-function): Output in *Disabled Command*.
	Explicitly ignore non-keyboard events, and explicitly handle C-g.

	* textmodes/flyspell.el (flyspell-large-region):
	Pass args differently for aspell.

	* files.el (mode-require-final-newline): Doc fix.

2005-03-03  Stephan Stahl  <stahl@eos.franken.de>  (tiny change)

	* progmodes/which-func.el (which-function):
	Specify NOERROR when calling imenu--make-index-alist.

2005-03-05  Stefan Monnier  <monnier@iro.umontreal.ca>

	* simple.el (normal-erase-is-backspace): Define default value.

	* custom.el (custom-theme-set-variables): Remove unused var `immediate'.
	(custom-reevaluate-setting): Simple function to handle
	variables that are defined before their default value can really
	be computed.

	* startup.el (command-line): Use it for temporary-file-directory,
	small-emporary-file-directory, auto-save-file-name-transforms,
	blink-cursor-mode, and normal-erase-is-backspace.

	* font-lock.el (font-lock-fontify-keywords-region): Ensure forward
	progress, even with buggy anchored keywords.

2005-03-05  Luc Teirlinck  <teirllm@auburn.edu>

	* simple.el (goto-line): Remove unbalanced final parenthesis.

2005-03-05  Richard M. Stallman  <rms@gnu.org>

	* simple.el (goto-line): Use a number at point as the default.
	With C-u as arg, switch buffers.

2005-03-05  Juri Linkov  <juri@jurta.org>

	* frame.el (blink-cursor-mode): Replace `emacs-quick-startup'
	with `no-blinking-cursor'.

	* startup.el (no-blinking-cursor): New defvar.
	(command-line): Add `--no-blinking-cursor' to longopts.
	Set `no-blinking-cursor' to t for command line arguments
	-Q, -nbc, --no-blinking-cursor.  Replace `emacs-quick-startup'
	with `no-blinking-cursor' in the condition for calling
	`blink-cursor-mode'.

2005-03-04  Luc Teirlinck  <teirllm@auburn.edu>

	* menu-bar.el (menu-bar-make-mm-toggle): Doc fix.
	(menu-bar-options-save): Add blink-cursor-mode.
	(menu-bar-options-menu): Add blink-cursor-mode.

2005-03-04  Ulf Jasper  <ulf.jasper@web.de>

	* calendar/icalendar.el (icalendar-version): Increase to 0.11.
	(icalendar-export-file, icalendar-export-region)
	(icalendar-import-file, icalendar-import-buffer): Add autoload cookies.
	(icalendar--convert-ical-to-diary): Fix problem with DURATION.

2005-03-04  Lute Kamstra  <lute@gnu.org>

	* emacs-lisp/debug.el (debugger-step-after-exit): Make it a defvar.
	(debug-function-list): Ditto.

2005-03-04  Robert J. Chassell  <bob@rattlesnake.com>

	* textmodes/texinfmt.el (texinfo-append-refill):
	Redefine the types of line to which @refill
	is not appended by replacing a search for `@refill\\|@bye' with
	`@refill\\|^[ \t]*@'.  The intent is to solve both the `@end
	itemize@refill' bug and the unfilled long lines bug.
	(texinfmt-version): Update number and date.

2005-03-04  Reiner Steib  <Reiner.Steib@gmx.de>

	* international/code-pages.el (windows-1250, windows-125[2-8])
	(iso-8859-10, -13, -16, georgian-ps): Add autoload cookies.

2005-03-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	* frame.el (blink-cursor-mode): `emacs-quick-startup' may not be
	bound yet.

2005-03-02  Romain Francoise  <romain@orebokech.com>

	* ibuf-ext.el (ibuffer-filter-disable): Move back to the current
	buffer after removing limits.
	(ibuffer-pop-filter): Ditto.
	Update copyright.

2005-03-02  Miles Bader  <miles@gnu.org>

	* button.el (make-text-button): If the user doesn't specify a
	type, use the default.  Rewrite to use `add-text-properties' and
	plist functions.

2005-03-01  Lute Kamstra  <lute@gnu.org>

	* emacs-lisp/debug.el (inhibit-debug-on-entry): Add docstring.
	(debugger-jumping-flag): New var.
	(debug-entry-code): Use it.
	(debugger-jump): Use debugger-jumping-flag and add
	debugger-reenable to post-command-hook.
	(debugger-reenable): Use debugger-jumping-flag and remove itself
	from post-command-hook.
	(debug, debug-on-entry, cancel-debug-on-entry): Remove call to
	debugger-reenable.

2005-03-01  Robert J. Chassell  <bob@rattlesnake.com>

	* textmodes/texinfmt.el (texinfo-no-refill-regexp): Comment out
	inclusion of "itemize\\|", which may be unnecessary, is certainly
	inelegant, and stops refilling in itemize lists when formatting
	Japanese Texinfo files to Info.
	Update copyright to 2005.

2005-03-01  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-get-location): Use a warning instead
	of an error if GDB can't find the source file.

2005-03-01  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* calendar/calendar.el (redraw-calendar): Work from any buffer,
	not just the calendar.

	* calendar/diary-lib.el (mark-diary-entries): Remove any old marks
	first.
	(diary-redraw-calendar): New function.
	(make-diary-entry): Add diary-redraw-calendar to local
	write-contents-functions.  Turn off selective display before
	inserting in diary.

2005-03-01  Kim F. Storm  <storm@cua.dk>

	* emacs-lisp/copyright.el (copyright-fix-years): New command.

2005-03-01  Lute Kamstra  <lute@gnu.org>

	* emacs-lisp/debug.el (debug-on-entry-1): Reimplement to make sure
	that debug-entry-code can be safely removed from a function while
	this code is being evaluated.  Revert the 2005-02-27 change as the
	new implementation no longer requires it.  Make sure that a
	function body containing just a string is not mistaken for a docstring.
	(debug): Skip one more frame in case of debug on entry.
	(debugger-setup-buffer): Delete one more frame line in case of
	debug on entry.
	(debugger-frame-number): Update to use the new text introduced by
	the 1999-11-03 change.  Skip one more frame in case of debug on entry.

2005-02-28  Kim F. Storm  <storm@cua.dk>

	* double.el (double-translate-key): Call force-window-update after
	read-event to avoid crash in redisplay.

2005-02-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/debug.el (inhibit-debug-on-entry): New var.
	(debug): Use it.  Move the inhibit-trace earlier.
	(debug-entry-code): New const.
	(debug-on-entry-1): Use it.

2005-02-28  Chong Yidong  <cyd@stupidchicken.com>

	* international/utf-16.el (ccl-encode-mule-utf-16le):
	Fix BUFFER_MAGNIFICATION to 2.
	(ccl-encode-mule-utf-16be): Likewise.

2005-02-28  Kenichi Handa  <handa@m17n.org>

	* international/utf-16.el (ccl-encode-mule-utf-16le-with-signature):
	Fix BUFFER_MAGNIFICATION to 4.
	(ccl-encode-mule-utf-16be-with-signature): Likewise.

2005-02-28  Nick Roberts  <nickrob@snap.net.nz>

	* speedbar.el (speedbar-update-flag): Doc fix.
	(speedbar-show-info-under-mouse): Give set-mouse-position the right
	argument.

2005-02-27  Stefan Monnier  <monnier@iro.umontreal.ca>

	* reveal.el (reveal-post-command): Don't try to reveal overlays which
	have a non-nil `invisible' property but are actually visible.

	* progmodes/perl-mode.el (perl-imenu-generic-expression): Add entries
	for perldoc sections.
	(perl-outline-regexp, perl-outline-level): New var and function.
	(perl-mode): Use them.

2005-02-27  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* calendar/diary-lib.el (diary-remind): Discard any mark portion
	from diary-entry.  Reported by Andrew Kemp <ajwk@pell.uklinux.net>.

2005-02-27  Luc Teirlinck  <teirllm@auburn.edu>

	* cus-edit.el: Comment change.
	(custom-buffer-create-internal): Slightly reword text at top of
	Custom buffers.  Mention there that saving an option edits the
	init file.  Add link to Emacs manual node on `custom-file'.
	(custom-magic-alist): Rewrite individual State messages to use
	capitalized keywords.  Doc fix.

2005-02-27  Matt Hodges  <MPHodges@member.fsf.org>

	* calendar/calendar.el (calendar-buffer): Move above
	calendar-week-start-day.
	(calendar-week-start-day): Doc fix.  Add :set function.
	(calendar-minimum-window-height): New variable.
	(generate-calendar-window): Only resize window if selected-window
	is displaying the calendar buffer.  Use new variable
	calendar-minimum-window-height.
	(generate-calendar): Reword error message.
	(calendar-mode-map): Bind DEL to scroll-other-window-down.

2005-02-27  Andreas Schwab  <schwab@suse.de>

	* vc.el (vc-do-command): Don't run command asynchronously when
	operating in a remote directory.

	* net/tramp.el (tramp-file-name-for-operation): Fix misapplied
	change from sync with Tramp 2.0.47.

2005-02-27  Richard M. Stallman  <rms@gnu.org>

	* textmodes/ispell.el (ispell-change-dictionary): Doc fix.

	* textmodes/flyspell.el (flyspell-mode-on):
	Call ispell-change-dictionary only if necessary.

	* emacs-lisp/re-builder.el (regexp-builder): New function.

	* register.el (describe-register-1): Explicitly handle
	yank-excluded-properties = t.

	* cus-edit.el (custom-buffer-create-internal): Improve progress msgs.
	(custom-magic-alist): Change the status descriptions again.
	(face widget-type): Total rewrite based on `restricted-sexp'
	to eliminate the confusing double hiding levels.

	* emacs-lisp/debug.el (debug-on-entry-1):
	If function body is empty, add nil as body form.

2005-02-26  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/trace.el (inhibit-trace): New var.
	(trace-make-advice): Use it.

	* emacs-lisp/debug.el (debug): Put back the inhibit-trace.

2005-02-26  Kim F. Storm  <storm@cua.dk>

	* mouse.el (mouse-1-click-in-non-selected-windows): New defcustom.
	(mouse-on-link-p, mouse-drag-region-1): Use it.

2005-02-25  Lute Kamstra  <lute@gnu.org>

	* replace.el (query-replace-read-from): Fix 2005-02-19 change.

2005-02-24  Luc Teirlinck  <teirllm@auburn.edu>

	* frame.el (blink-cursor-mode): Add :group keyword.

2005-02-24  Ulf Jasper  <ulf.jasper@web.de>

	* calendar/icalendar.el (icalendar--decode-isodatetime):
	New optional argument DAY-SHIFT.
	(icalendar-export-region): Fix coding-system-for-write.
	(icalendar--convert-ical-to-diary): Shift end-day of all-day
	events by one.

2005-02-24  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/tex-mode.el (tex-font-lock-keywords-3): #n is atomic.

2005-02-24  Kim F. Storm  <storm@cua.dk>

	* international/iso-acc.el (iso-accents-compose): Fix crash
	during redisplay.  Call force-window-update after read-event
	and delete-region to signal that window is not accurate.

2005-02-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/debug.el (debug): Hide the buffer if it's not killed.
	Remove unused and inexistent var `inhibit-trace'.
	(debugger-mode): Use run-mode-hooks.
	(debugger-list-functions): Add buttons; setup xref stack.

2005-02-23  Richard M. Stallman  <rms@gnu.org>

	* calendar/appt.el (appt-time-msg-list): 3rd elt of each
	appointment says it was explicitly made.
	(appt-add): Set the 3rd element.
	(appt-make-list): Preserve explicit appointments.

	* subr.el (find-tag-default): Catch errors in forward-sexp.

2005-02-23  Juri Linkov  <juri@jurta.org>

	* info.el (Info-isearch-search): New defcustom.
	(Info-isearch-search): Call the default isearch function
	when Info-isearch-search is nil.
	(Info-isearch-wrap): Use variable Info-isearch-search.

2005-02-22  Luc Teirlinck  <teirllm@auburn.edu>

	* cus-edit.el: Comment change.

2005-02-22  Kim F. Storm  <storm@cua.dk>

	* progmodes/hideif.el (hide-ifdef-use-define-alist):
	Use completing-read.  Suggested by Juan-Leon Lahoz Garcia.

2005-02-22  Simon Josefsson  <jas@extundo.com>

	* net/browse-url.el (browse-url-netscape-new-window-is-tab):
	New variable.
	(browse-url-netscape): Use it.  Suggested by "Johann 'Myrkraverk'
	Oskarsson" <myrkraverk@users.sourceforget.net>.

2005-02-22  Kim F. Storm  <storm@cua.dk>

	* mouse.el (mouse-on-link-p): If arg POS is a mouse event,
	check that window of that event is the selected window.
	(mouse-drag-region-1): Compare mouse event window to selected
	window before setting point.

	* tooltip.el (tooltip-show-help-function): Pass event to
	mouse-on-link-p so it can check selected window.

2005-02-22  Kenichi Handa  <handa@m17n.org>

	* ps-mule.el (ps-mule-header-string-charsets): Delete it.
	(ps-mule-show-warning): New function.
	(ps-mule-begin-job): Use ps-mule-show-warning if unprintable
	characters are found.

	* ps-print.el (ps-header-footer-string): Return a list of header
	and footer strings.

2005-02-21  Wolfgang Jenkner  <wjenkner@inode.at>  (tiny change)

	* pcvs.el (cvs-retrieve-revision): Fix thinko.

2005-02-21  Stefan Monnier  <monnier@iro.umontreal.ca>

	* frame.el (blink-cursor-mode): Use define-minor-mode.

	* term/mac-win.el (function-key-map): Use char-names more consistently.
	(file-name-coding-system): Only set it for MacOS-9.  The other case is
	already handled in mule-cmds.el (where it also works when mac-win.el
	is not used).

2005-02-21  Kenichi Handa  <handa@m17n.org>

	* international/mule.el (ctext-pre-write-conversion): Always use
	" *code-converting-work*" buffer for work.

	* textmodes/ispell.el (ispell-dictionary-alist): Fix docstring.

2005-02-20  Thien-Thi Nguyen  <ttn@gnu.org>

	* progmodes/scheme.el (scheme-font-lock-keywords-2): Handle named-let.

2005-02-20  Jonathan Yavner  <jyavner@member.fsf.org>

	* ses.el (undo-more): Restore defadvice, but only the part that
	allows changes outside the restricted area of the buffer.

2005-02-20  Kim F. Storm  <storm@cua.dk>

	* simple.el (line-move): Add fourth optional arg try-vscroll which
	must be set to perform auto-window-vscroll.
	When moving backwards and doing auto-window-vscroll, automatically
	vscroll to the last part of lines which are taller than the window.
	(next-line, previous-line): Set try-vscroll arg on line-move.

2005-02-19  Dan Nicolaescu  <dann@ics.uci.edu>

	* replace.el (query-replace, query-replace-regexp)
	(replace-string, replace-regexp): When operating on region, make
	the minibuffer prompt say so.

	* isearch.el (isearch-forward): Document isearch-query-replace and
	isearch-query-replace-regexp keybindings.

2005-02-19  Jay Belanger  <belanger@truman.edu>

	* calc/calc-aent.el (math-read-token): Add local variable.

	* calc/calc-prog.el (calc-user-define-edit): Add local variable.
	(calc-edit-top): Move declaration to earlier in file.
	(calc-edit-macro-repeats): Add local variables.

	* calc/calcalg2.el: Add differentiation rule for calcFunc-coth.
	Adjust differentiation rules for calcFunc-tan, calcFunc-cot,
	calcFunc-tanh.
	Adjust integration rule for calcFunc-tan.

2005-02-19  Michael Kifer  <kifer@cs.stonybrook.edu>

	* viper-cmd.el (viper-prefix-commands): Make into a defconst.
	(viper-exec-buffer-search): Use regexp-quote to quote buffer string.
	(viper-minibuffer-setup-sentinel): Make some variables buffer-local.
	(viper-skip-separators): Bug fix.
	(viper-set-searchstyle-toggling-macros): Allow to unset macros in a
	particular major mode.
	(viper-del-backward-char-in-replace): Don't put deleted char on the
	kill ring.

	* viper-ex.el (viper-color-display-p): New function.
	(viper-has-face-support-p): Use viper-color-display-p.

	* viper-keym.el (viper-gnus-modifier-map): New keymap.

	* viper-macs.el (viper-unrecord-kbd-macro): Bug fix.

	* viper-util.el (viper-glob-unix-files): Fix shell status check.
	(viper-file-remote-p): Make equivalent to file-remote-p.

	* viper.el (viper-major-mode-modifier-list):
	Use viper-gnus-modifier-map.

2005-02-19  David Kastrup  <dak@gnu.org>

	* subr.el (subregexp-context-p): Fix garbled doc string by adding
	quoting.

2005-02-19  Jay Belanger  <belanger@truman.edu>

	* calc/calc-math.el (calc-arctan, calc-tanh, calc-arctanh):
	Remove extra definitions.
	(calc-coth): New function.
	(calcFunc-cot): Fix `let'.

2005-02-19  Eli Zaretskii  <eliz@gnu.org>

	* faces.el (escape-glyph, minibuffer-prompt): Add commentary for
	the reasons we use "type pc" in these faces.

	* button.el (button): Ditto.

2005-02-19  Michael Mauger  <mmaug@yahoo.com>

	* replace.el (query-replace-read-from): Set the value of
	query-replace-from-history-variable to handle the case of an empty
	string entered to accept the suggested default.

	* net/tramp.el (tramp-file-name-for-operation):
	Use dired-call-process instead of dired-call-process-command.

2005-02-19  Jay Belanger  <belanger@truman.edu>

	* calc/calc-arith.el (math-trig-inverses, math-div-trig)
	(math-div-non-trig): New variables.
	(math-combine-prod-trig, math-div-new-trig, math-div-new-non-trig)
	(math-div-isolate-trig, math-div-isolate-trig-term): New functions.
	(math-combine-prod, math-div-symb-fancy): Add simplifications for
	trig expressions.

2005-02-19  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-var-update-handler)
	(gdb-speedbar-timer-fn): Ensure speedbar updates with new values
	for watch expressions,
	(gdb-var-create-handler): Don't set speedbar-update-flag.
	(gdb-post-prompt): Simplify test for speedbar.

2005-02-19  Michael Kifer  <kifer@cs.stonybrook.edu>

	* ediff.el (ediff-set-diff-overlays-in-one-buffer)
	(ediff-set-fine-overlays-in-one-buffer,ediff-goto-word): Make sure
	we use the syntax table of the correct buffer.
	(ediff-same-file-contents,ediff-same-contents): Enhancements thanks to
	Felix Gatzemeier.

	* ediff-init.el (ediff-hide-face): Check for definedness of functions.
	(ediff-file-remote-p): Make synonymous with file-remote-p.
	In all deffaces ediff-*-face-*, use min-colors.

	* ediff-mult.el (ediff-meta-mark-equal-files): Make use of
	ediff-recurse-to-subdirectories.
	(ediff-mark-if-equal): Check that the arguments are strings, use
	ediff-same-contents (after to Felix Gatzemeier).

	* ediff.el (ediff-merge-on-startup): Don't set buffer-modified-p to
	nil.

2005-02-18  Stefan Monnier  <monnier@iro.umontreal.ca>

	* log-view.el (log-view-message-re): Fix up Subversion regexp.

2005-02-18  David Kastrup  <dak@gnu.org>

	* progmodes/meta-mode.el (meta-mark-active): Fix condition to just
	use `mark-active' when defined.

2005-02-18  Kenichi Handa  <handa@m17n.org>

	* ps-print.el (ps-font-info-database): New entry
	ZapfChancery-MediumItalic with correct font name.  Fix font name
	of the entry Zapf-Chancery-MediumItalic.

2005-02-16  Luc Teirlinck  <teirllm@auburn.edu>

	* autorevert.el (auto-revert-stop-on-user-input): Further doc fix.

2005-02-16  Kim F. Storm  <storm@cua.dk>

	* ido.el (ido-fallback-command): Pass user input to fallback command.

2005-02-16  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-set-gud-minor-mode-existing-buffers)
	(gdb-find-file-hook): Add server prefix.

2005-02-16  Richard M. Stallman  <rms@gnu.org>

	* replace.el (perform-replace): Pass new args to replace-highlight.
	(replace-highlight): Take region args,
	and pass them to isearch-lazy-highlight-new-loop.

	* novice.el (disabled-command-hook): Autoload the defalias
	and the make-obsolete-variable call.

	* menu-bar.el (menu-bar-select-frame): FRAME defaults to selected.

	* isearch.el (isearch-lazy-highlight-start-limit)
	(isearch-lazy-highlight-end-limit): New variables limit
	the region for highlighting.
	(isearch-lazy-highlight-new-loop): New args BEG and END.
	(isearch-lazy-highlight-search): Use the new vars.
	(isearch-lazy-highlight-update): Likewise.

	* dired.el (dired-build-subdir-alist): Bind buffer-undo-list to t.

	* cus-start.el (all): Use default-boundp.

2005-02-15  David Casperson  <casper@unbc.ca>  (tiny change)

	* menu-bar.el (menu-bar-select-frame): Handle current frame.

2005-02-15  Luc Teirlinck  <teirllm@auburn.edu>

	* autorevert.el (auto-revert-stop-on-user-input)
	(auto-revert-verbose): Doc fixes.

2005-02-15  Benjamin Riefenstahl  <Benjamin.Riefenstahl@epost.de>

	* international/mule-cmds.el (set-locale-environment): Remove call
	to set-selection-coding-system on Windows.

2005-02-15  Jay Belanger  <belanger@truman.edu>

	* calc/calc-alg.el: Add simplification rules for calcFunc-sec,
	calcFunc-csc, calcFunc-cot, calcFunc-sech, calcFunc-csch, and
	calcFunc-coth.
	(math-simplify-sqrt): Add simplifications.

	* calc/calc-arith.el (math-real-if-arg-functions): Add functions
	to list.

	* calc/calc-ext.el: Add functions to autoloads.

	* calc/calc-math.el (calc-sec, calc-csc, calc-cot, calc-sech)
	(calc-csch, calc-coth, calcFunc-sec, calcFunc-csc, calcFunc-cot)
	(calcFunc-sech, calcFunc-csch, calcFunc-coth, math-sec-raw)
	(math-csc-raw, math-cot-raw): New functions.

	* calc/calc-rules.el (calc-DistribRules, calc-NegateRules): Add	rules.

	* calc/calc-undo.el (calc-handle-undo): Remove prefix from
	the variable name in a message.

	* calc/calc-units.el: Add simplification rules for calcFunc-sec,
	calcFunc-csc, calcFunc-cot.

	* calc/calcalg2.el: Add derivative and integration rules for
	calcFunc-sec, calcFunc-csc, calcFunc-cot, calcFunc-sech,
	calcFunc-csch, calcFunc-coth.
	(math-do-integral-methods): Add to checks for when to use
	substitutions.

	* calc/calccomp.el (math-eqn-special-funcs): Add functions to list.

2005-02-15  Lute Kamstra  <lute@gnu.org>

	* emacs-lisp/lisp-mode.el (lisp-mode-variables):
	Add ;;;###autoload to `outline-regexp'.  Suggested by Stefan Monnier
	<monnier@iro.umontreal.ca>
	(lisp-outline-level): Improve efficiency.  Suggested by David
	Kastrup <dak@gnu.org>.

2005-02-15  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-find-file-unhook): New variable.
	(gdb-set-gud-minor-mode, gdb-set-gud-minor-mode-1)
	(gdb-set-gud-minor-mode-existing-buffers): New functions.
	(gdb-find-file-hook): New hook.  Add it to find-file-hook.
	(gdb-info-breakpoints-custom, gdb-source-info): Simplify.

2005-02-14  Luc Teirlinck  <teirllm@auburn.edu>

	* cus-start.el (all): Comment change.

2005-02-14  Lute Kamstra  <lute@gnu.org>

	* cus-start.el (all): Check if symbol is void.

2005-02-14  Carsten Dominik  <dominik@science.uva.nl>

	* textmodes/reftex-cite.el (reftex-do-citation): Cleanup single
	optional argument to \cite.

2005-02-14  Richard M. Stallman  <rms@gnu.org>

	* cus-edit.el (custom-buffer-create-internal): Update help message.
	(custom-magic-alist): Update help messages.

	* cus-start.el (all): Allow a var to specify a standard value.

2005-02-12  Luc Teirlinck  <teirllm@auburn.edu>

	* custom.el (custom-theme-set-variables): Handle variable aliases.

	* frame.el (blink-cursor-timer): Doc fix.
	(blink-cursor): Make it an alias for `blink-cursor-mode' and
	declare obsolete.
	(blink-cursor-mode): Define with defcustom and use correct
	standard expression in that defcustom.
	* startup.el (command-line): Adapt to above changes in frame.el.

2005-02-11  Lute Kamstra  <lute@gnu.org>

	* apropos.el (apropos-score-doc): Prevent division by zero.

2005-02-11  Ulf Jasper  <ulf.jasper@web.de>

	* calendar/icalendar.el (icalendar--get-event-property): Doc fix.
	(icalendar--get-event-property-attributes)
	(icalendar--get-event-properties)
	(icalendar--datetime-to-diary-date): New functions.
	(icalendar--split-value): Doc fix.
	(icalendar--datetime-to-noneuropean-date)
	(icalendar--datetime-to-european-date): New optional argument
	SEPARATOR.  Return result as a string instead of a list.
	(icalendar--get-weekday-number): Check if ABBREVWEEKDAY is nil.
	(icalendar--convert-string-for-export): Rename arg S to STRING.
	(icalendar-export-region): Doc fix.  Change name of error buffer.
	Save output buffer.
	(icalendar-import-file): Add blank at end of prompt.
	(icalendar-import-buffer): Doc fix.  Do not switch to error
	buffer.  Indicate status in return value.
	(icalendar--convert-ical-to-diary): Doc fix.  Change name of error
	buffer.  Save output buffer.  Handle exception from recurrence
	rules (EXDATE, EXRULE).  Handle start- and end-date of recurring
	events.  Fix problems with weekly all-day events.

2005-02-10  Richard M. Stallman  <rms@gnu.org>

	* simple.el (eval-expression-print-format):
	Avoid warning about edebug-active.

	* help.el (help-for-help-internal): Rename from help-for-help.
	(help-for-help): Define with defalias.

	* font-core.el (font-lock-default-function): Use with-no-warnings.

	* cus-edit.el (custom-buffer-create-internal): Improve help-echo.

	* custom.el (defface): Doc fix.

2005-02-10  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-ann3): Re-instate GDB command "set
	width 0" to prevent word wrapping problems.

2005-02-09  Kim F. Storm  <storm@cua.dk>

	* ido.el (ido-file-extensions-order): New defcustom.
	(ido-file-extension-lessp, ido-file-extension-aux)
	(ido-file-extension-order): New advanced file ordering.
	(ido-file-lessp): New simple file ordering.
	(ido-sort-list): Remove.
	(ido-make-file-list): Use ido-file-lessp or ido-file-extension-lessp.
	(ido-make-dir-list, ido-completion-help): Use ido-file-lessp.

2005-02-08  Dan Nicolaescu  <dann@ics.uci.edu>

	* progmodes/grep.el (grep-regexp-alist): Match an optional ^[[K
	that some versions of grep produce.
	(grep-mode-font-lock-keywords): Likewise.

2005-02-09  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-location-list): New variable.
	(gdb-cdir): Delete.
	(gdb-info-breakpoints-custom, gdb-goto-breakpoint)
	(gdb-source-info): Treat case when source file is in another
	directory properly.
	(gdb-get-location): New function.

2005-02-07  Jay Belanger  <belanger@truman.edu>

	* calc/calc-prog.el (calc-write-parse-table-part)
	(calc-fix-token-name): Fix a check for language type.

	* calc/calccomp.el (math-compose-expr): Fix a check for language type.

2005-02-07  Andre Spiegel  <spiegel@gnu.org>

	* vc-hooks.el (vc-make-version-backup): Ignore file-errors such
	as directory not writable.

2005-02-07  Kim F. Storm  <storm@cua.dk>

	* emulation/cua-base.el (cua-max-undo, cua-undo): Remove.
	(cua--standard-movement-commands): Remove list.
	Instead, set CUA property value to move for movement commands.
	(cua-movement-commands): Remove.  Users must set CUA prop instead.
	(cua--pre-command-handler): Check CUA property.
	(cua--init-keymaps): Don't remap undo commands.
	(cua-mode): Don't call cua--rectangle-on-off.

	* emulation/cua-rect.el (cua--undo-list, cua--tidy-undo-counter)
	(cua--rect-undo, cua--tidy-undo-lists, cua--rectangle-on-off): Remove.
	(cua--rect-undo-set-point): New var.
	(cua--rectangle-undo-boundary): Setup undo apply entry.
	(cua--rect-undo-handler): New function for rectangle undo.
	(cua--rect-start-position, cua--rect-end-position): Add.
	(cua--rectangle-post-command): Call cua--rectangle-set-corners
	for restored rectangle.  Set point if cua--rect-undo-set-point.

2005-02-06  Jay Belanger  <belanger@truman.edu>

	* calc/calc-lang.el (calc-tex-language): Display more information
	in messages.

	* calc/calccomp.el (math-compose-expr): Allow multiline matrices
	in TeX mode.

2005-02-06  Richard M. Stallman  <rms@gnu.org>

	* emacs-lisp/lisp.el (buffer-end): Doc fix.

2005-02-05  Arne_J,Ax(Brgensen  <arne@arnested.dk>  (tiny change)

	* net/ldap.el (ldap-search-internal): Support attributes with
	optional descriptions separated by a semi-colon, as in
	"userCertificate;binary".

2005-02-05  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* x-dnd.el (x-dnd-handle-xdnd): Handle the case where the flags
	isn't a cons (i.e. the version is 0).

2005-02-05  Eli Zaretskii  <eliz@gnu.org>

	* help.el (help-for-help): Doc fix.

2005-02-05  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el: Update copyright.  Put GDB-Frames before
	GDB-Windows on the menu-bar as this works better.

2005-02-04  Jay Belanger  <belanger@truman.edu>

	* calc/calc-embed.el (calc-embedded-update): Don't put in
	unnecessary newlines.  Adjust the end of formula marker.

	* calc/calc-lang.el (math-latex-parse-frac): Don't use arguments.
	(math-latex-parse-two-args): New function.

2005-02-03  Lute Kamstra  <lute@gnu.org>

	* help-fns.el (help-with-tutorial): Make sure that users cannot
	remove the entire text of the tutorial by means of `undo'.

2005-02-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/ispell.el (ispell-internal-change-dictionary): Fix problem
	in recent changes, where the ispell process was repeatedly
	killed & restarted.

	* international/mule-cmds.el (set-locale-environment): Set file-name
	coding system to utf-8 on Darwin systems.
	(set-default-coding-systems): Don't set default-file-name-coding-system
	on Darwin systems.

2005-02-03  Richard M. Stallman  <rms@gnu.org>

	* hi-lock.el (hi-lock-mode): Turning on Hi-Lock turns on Font-Lock.

2005-02-03  Matt Hodges  <MPHodges@member.fsf.org>

	* faces.el (list-faces-display): Add optional argument.

2005-02-02  Stefan Monnier  <monnier@iro.umontreal.ca>

	* font-core.el (font-lock-default-function): Handle the rare case where
	only font-lock-keywords is set.

2005-02-02  Kenichi Handa  <handa@m17n.org>

	* international/characters.el: Cancel previous change for
	I-WITH-DOT-ABOVE and DOTLESS-i.

	* international/latin-5.el: Cancel previous change.

2005-02-02  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gud.el: Correction to syntax in gud-menu-map.

2005-02-02  Kenichi Handa  <handa@m17n.org>

	* international/latin-5.el (tbl): Setup cases of I-WITH-DOT-ABOVE,
	DOTLESS-i.

	* international/characters.el: Setup cases of GREEK-FINAL-SIGMA,
	Y-WITH-DIAERESIS, I-WITH-DOT-ABOVE, DOTLESS-i.

	* case-table.el (get-upcase-table): New function.
	(copy-case-table): Copy upcaes table too if non-nil.
	(set-case-syntax-delims): Maintain upcase table too.
	(set-case-syntax-pair): Likewise.
	(set-upcase-syntax, set-downcase-syntax): New functions.
	(set-case-syntax): Maintain upcase table too.

2005-02-02  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-goto-info): Delete.

	* progmodes/gud.el (gud-goto-info): New function.
	(gud-tool-bar-map): Use correct icon.

2005-02-01  Thien-Thi Nguyen  <ttn@gnu.org>

	* emacs-lisp/lisp-mode.el (lisp-indent-function): Fix bug:
	When delegating, order args in the funcall correctly.

2005-02-01  Thien-Thi Nguyen  <ttn@gnu.org>

	* emacs-lisp/lisp-mode.el (lisp-indent-function): Doc fix.

2005-02-01  Carsten Dominik  <dominik@science.uva.nl>

	* textmodes/reftex.el (reftex-access-scan-info): Error out in a
	buffer not visiting a file.

2005-01-31  Jay Belanger  <belanger@truman.edu>

	* calc/calc-embed.el (calc-embedded-find-bounds): Set the formula
	bound on the line with the formula.

2005-01-31  Kim F. Storm  <storm@cua.dk>

	* ses.el (ses-create-cell-variable-range)
	(ses-destroy-cell-variable-range, ses-reset-header-string)
	(ses-set-with-undo, ses-unset-with-undo, ses-aset-with-undo)
	(ses-insert-row): Fix format of apply undo entries.

2005-01-31  Jay Belanger  <belanger@truman.edu>

	* calc/calc-aent.el (math-read-token): Separate the TeX and LaTeX
	parts.

	* calc/calc-embed.el (calc-embedded-open-formula)
	(calc-embedded-close-formula): Ignore matrix environments.

	* calc/calc-ext.el (math-read-big-expr): Make LaTeX the default
	TeX mode.

	* calc/calc-lang.el (math-function-table, math-oper-table)
	(math-variable-table): Adjust the LaTeX portions.

	* calc/calc.el (math-tex-ignore-words): Remove LaTeX portion.
	(math-latex-ignore-words): New constant.

2005-01-31  Richard M. Stallman  <rms@gnu.org>

	* textmodes/ispell.el (ispell-local-dictionary-overridden): New var.
	(ispell-local-dictionary): Doc fix.
	(ispell-dictionary-alist): Don't include ispell-local-dictionary-alist.
	Don't reinitialize at run time.  Don't defcustom.
	All uses changed to append ispell-local-dictionary-alist,
	or check it first.
	(ispell-current-dictionary): New variable for dictionary in use.
	(ispell-dictionary): Now used only for global default.
	(ispell-start-process): Set ispell-current-dictionary,
	not ispell-dictionary.
	(ispell-change-dictionary): Use this only for setting
	user preferences.
	(ispell-internal-change-dictionary): New function
	to change the current dictionary in use.
	(ispell-region, ispell-process-line, ispell-buffer-local-dict):
	Use ispell-current-dictionary.
	Handle ispell-local-dictionary-overridden.
	(ispell-buffer-local-dict): Call ispell-internal-change-dictionary.

2005-01-31  Jay Belanger  <belanger@truman.edu>

	* calc/calc-aent.el (math-read-token): Add support for LaTeX.

	* calc/calc-ext.el: Add calc-latex-language to autoloads.
	(calc-mode-map): Add calc-latex-language.

	* calc/calc-lang.el (calc-latex-language, math-latex-parse-frac)
	(math-latex-print-frac): New functions.
	(math-oper-table, math-function-table, math-variable-table)
	(math-complex-format, math-input-filter): Add latex properties.
	(calc-set-language): Set math-expr-special-function-mapping.

	* calc/calc-prog.el (calc-edit-user-syntax, calc-fix-token-name)
	(calc-write-parse-table-part): Add LaTeX support.

	* calc/calc.el (calc-language): Adjust docstring.
	(calc-set-mode-line): Add LaTeX support.
	(math-expr-special-function-mapping): New variable.
	(math-tex-ignore-words): Add to list.

	* calc/calccomp.el (math-compose-expr, math-compose-rows):
	Add LaTeX support.
	(math-compose-expr): Add support for special functions.

	* calc/calc-help.el (calc-d-prefix-help): Add LaTeX.

2005-01-31  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-memory-address)
	(gdb-memory-repeat-count, gdb-memory-format, gdb-memory-unit)
	(gdb-memory-mode-map, gdb-memory-format-keymap)
	(gdb-memory-format-menu, gdb-memory-unit-keymap)
	(gdb-memory-unit-menu): New variables for a buffer
	that lets the user examine program memory.
	(gdb-memory-set-address, gdb-memory-set-repeat-count)
	(gdb-memory-format-binary, gdb-memory-format-octal)
	(gdb-memory-format-unsigned, gdb-memory-format-signed)
	(gdb-memory-format-hexadecimal, gdb-memory-format-menu)
	(gdb-memory-format-menu-1, gdb-memory-unit-giant)
	(gdb-memory-unit-word, gdb-memory-unit-halfword)
	(gdb-memory-unit-byte, gdb-memory-unit-menu)
	(gdb-memory-unit-menu-1, gdb-make-header-line-mouse-map)
	(gdb-memory-mode, gdb-memory-buffer-name)
	(gdb-display-memory-buffer, gdb-frame-memory-buffer):
	New functions for above buffer.

2005-01-30  Richard M. Stallman  <rms@gnu.org>

	* cus-edit.el (custom-bury-buffer): Function deleted.
	(custom-buffer-done-function): Option deleted.
	(custom-buffer-done-kill): New (replacement option.
	(Custom-buffer-done): Call quit-window.
	(custom-buffer-create-internal): Update for above changes.

2005-01-29  Luc Teirlinck  <teirllm@auburn.edu>

	* simple.el (undo-ask-before-discard): New var.
	(undo-outer-limit-truncate): Implement it.
	(undo-extra-outer-limit): Doc update.

2005-01-29  Richard M. Stallman  <rms@gnu.org>

	* ses.el (undo-more): Delete defadvice.
	(ses-begin-change): Doc fix.

	* dired.el (dired-mode-map): Remap `undo' and `advertised-undo'
	instead of rebinding C-x u and C-_.

	* files.el (normal-backup-enable-predicate): Return nil for files
	in /tmp, regardless of temporary-file-directory.

	* man.el (Man-getpage-in-background): Disable undo in Man buffer.

	* rect.el (delete-rectangle-line, delete-extract-rectangle-line)
	(open-rectangle, delete-whitespace-rectangle-line)
	(clear-rectangle-line): If FILL, pass t instead of FILL
	for move-to-column's 2nd arg.

	* simple.el (undo): Fix the test for continuing a series of undos.
	(undo-more): Set pending-undo-list to t when we reach end.
	(pending-undo-list): Move up defvar.

	* wid-edit.el (widget-button-click):
	Shorten the range of the track-mouse binding.

	* comint.el (comint-insert-input): Undo previous changes;
	use last-input-event in interactive spec.

2005-01-29  Eli Zaretskii  <eliz@gnu.org>

	* progmodes/compile.el (compilation-start): Bind buffer-read-only
	to nil before invoking call-process.  Reset buffer's modified flag
	after fontifying it in the no-async branch.

	* wid-edit.el (widget-specify-button): If mouse pointer shape
	cannot be changed, use mouse face instead.

2005-01-29  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-info-breakpoints-custom)
	(gdb-goto-breakpoint): Make breakpoint handling work on template
	functions in C++.  Reported by Martin Reed <mjreed@essex.ac.uk>
	(gdb-assembler-custom): Update to recognize breakpoint information
	added on 2005-01-19.

2005-01-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/scheme.el (scheme-mode-variables): Set comment-add.
	(dsssl-mode): Use define-derived-mode.
	(scheme-mode-initialize): Remove.
	(scheme-mode): Use run-mode-hooks.

	* cus-edit.el (customize-group-other-window)
	(custom-buffer-create-other-window): Don't override special-display-*.
	(custom-mode-map): Make it dense.

	* emacs-lisp/lisp-mode.el (eval-defun-1): Make sure `defvar' always
	sets the default value.

2005-01-28  Eli Zaretskii  <eliz@gnu.org>

	* descr-text.el: Add more keywords.

2005-01-27  Stefan Monnier  <monnier@iro.umontreal.ca>

	* speedbar.el: Avoid unnecessary use of locate-library.

	* international/mule-cmds.el (standard-display-european-internal):
	Don't fiddle with latin-1 non-break space any more since it's now
	special cased in the C code.
	Don't "do&undo" setting for 160 (especially, don't undo incorrectly).

2005-01-26  Luc Teirlinck  <teirllm@auburn.edu>

	* cus-start.el (all): Add `undo-outer-limit'.

2005-01-25  Roland Winkler  <Roland.Winkler@physik.uni-erlangen.de>

	* textmodes/bibtex.el (bibtex-format-entry):
	Use `bibtex-empty-field-re' only on the text of fields, not on entire
	field lines.
	(bibtex-autofill-entry): Use `bibtex-empty-field-re' on a string,
	not on part of a buffer.

2005-01-25  Lute Kamstra  <lute@gnu.org>

	* textmodes/bibtex.el (bibtex-empty-field-re): Don't match
	nonempty field text strings like "{letters\\macro{}more letters}".
	Clarify docstring.
	(bibtex-sort-entry-class, bibtex-autokey-titleword-ignore)
	(bibtex-entry-offset, bibtex-parse-association)
	(bibtex-parse-field-name): Fix typos in docstrings.
	(bibtex-field-list, bibtex-find-crossref): Fix typos in error messages.

2005-01-24  Carsten Dominik  <dominik@science.uva.nl>

	* textmodes/reftex-global.el (reftex-isearch-push-state-function)
	(reftex-isearch-pop-state-function, reftex-isearch-isearch-search)
	(reftex-isearch-switch-to-next-file, reftex-isearch-turn-off)
	(reftex-isearch-turn-on, reftex-isearch-minor-mode): New functions.

	* textmodes/reftex.el (reftex-mode-menu): Add entry for reftex
	isearch minor mode.

2005-01-24  Luc Teirlinck  <teirllm@auburn.edu>

	* help-at-pt.el (help-at-pt-display-when-idle): Add autoload cookie.

2005-01-24  Lute Kamstra  <lute@gnu.org>

	* textmodes/ispell.el (ispell-dictionary-alist-4): Rewrite the
	CASECHARS and NOT-CASECHARS regular expressions of the
	"nederlands" and "nederlands8" dictionaries to prevent a "Range
	striding over charsets" error.

2005-01-24  Jay Belanger  <belanger@truman.edu>

	* calc/calc-store.el (calc-declare-variable): Use calc-var-name to
	display variable name.

2005-01-24  Kenichi Handa  <handa@m17n.org>

	* international/encoded-kb.el (encoded-kbd-iso2022-single-shift):
	Fix setting of the element of encoded-kbd-iso2022-invocations.

2005-01-24  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-goto-breakpoint, gdb-frames-select)
	(gdb-threads-select): Change to also accept mouse events.
	(gdb-mouse-goto-breakpoint, gdb-frames-mouse-select)
	(gdb-threads-mouse-select): Delete.

2005-01-23  Luc Teirlinck  <teirllm@auburn.edu>

	* files.el (insert-directory): Take care of empty directory,
	listed without -a switch.

2005-01-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/refill.el (refill-post-command-function):
	Add `indent-new-comment-line' and `reindent-then-newline-and-indent'
	to the list of functions that we should be careful not to undo.
	(refill-late-fill-paragraph-function): Remove.
	(refill-saved-state): New var.
	(refill-mode): Use it to save fill-paragraph-function.
	Save also the value of auto-fill-function.

	* term/w32-win.el: Simplify code.

2005-01-23  Kim F. Storm  <storm@cua.dk>

	* simple.el (line-move): Adapt to new return value from
	pos-visible-in-window-p.

	* simple.el (line-move): Fix last change.  Check partial
	visibility at point rather than at window-start.

2005-01-22  Jason Rumney  <jasonr@gnu.org>

	* term/w32-win.el (xw-defined-colors): Remove debug-message.

2005-01-22  David Kastrup  <dak@gnu.org>

	* progmodes/grep.el: Add alias `find-grep' for `grep-find'.

2005-01-22  Eli Zaretskii  <eliz@gnu.org>

	* type-break.el (type-break-mode): Add a test for
	type-break-file-name being non-nil.

2005-01-22  Toby Allsopp  <Toby.Allsopp@navman.com>  (tiny change)

	* net/eudc.el (top level): Call (message "") via progn, so that
	eudc-options-file is loaded.

2005-01-22  Kim F. Storm  <storm@cua.dk>

	* simple.el (line-move-1): Rename from line-move.
	(line-move): New function that adjusts vscroll for partially
	visible rows, and calls line-move-1 otherwise.

2005-01-21  Ren,Ai(B Kyllingstad  <listmailxemacs@kyllingstad.com>

	* pcomplete.el: define pcomplete-read-event instead of read-event,
	since it's not a complete read-event implementation

2005-01-20  Jay Belanger  <belanger@truman.edu>

	* calc/calc-ext.el (calc-fancy-prefix-other-key): Set prefix arg
	for called function.

2005-01-20  Steven Tamm  <steventamm@mac.com>

	* term/mac-win.el (process-connection-type): Remove.
	Controlled now by s/darwin.h:PTY_ITERATION.

2005-01-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* window.el (handle-select-window): Don't switch window when we're
	in the minibuffer.

2005-01-10  Paul Pogonyshev  <pogonyshev@gmx.net>

	* subr.el (dotimes-with-progress-reporter): New macro.

	* ses.el (ses-dotimes-msg): Remove macro.
	Use `dotimes-with-progress-reporter' instead.

2005-01-19  Steven Tamm  <steventamm@mac.com>

	* term/mac-win.el (process-connection-type): Use new
	operating-system-release variable to use ptys on Darwin 7 (OS X
	10.3) when using carbon build.

2005-01-19  Jay Belanger  <belanger@truman.edu>

	* calc/calc-ext.el (calc-fancy-prefix-other-key): Don't clear
	flags if the last command was a tab or M-tab.

	* calc/calc-prog.el (calc-user-define-edit): Put original formula
	in formula editing buffer.

2005-01-19  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-put-breakpoint-icon): Add help-echo for
	breakpoint image symbol in margin.

2005-01-19  Jay Belanger  <belanger@truman.edu>

	* calc/calc-prog.el (calc-execute-kbd-macro):
	Ignore calc-keep-arg-flag.

2005-01-19  Kenichi Handa  <handa@m17n.org>

	* textmodes/ispell.el (ispell-looking-at): New function.
	(ispell-process-line): Use ispell-looking-at to compare the ispell
	output and the buffer contents.

2005-01-18  Jay Belanger  <belanger@truman.edu>

	* calc/calc.el (calc-display-raw): Fix docstring.

2005-01-18  Stefan Monnier  <monnier@iro.umontreal.ca>

	* simple.el (blink-matching-open): Strip extra info from syntax.

	* progmodes/sh-script.el (sh-here-doc-open-re): Don't allow | or other
	funny chars in the end-of-here-doc marker.

2005-01-19  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-put-string): Copy/create strings so
	that enable/disabled state of breakpoints is shown correctly in
	fringe and on ttys.
	(gdb-put-breakpoint-icon, gdb-info-breakpoints-custom):
	Add breakpoint information as text properties.
	(gdb-mouse-toggle-breakpoint):
	Rename to gdb-mouse-set-clear-breakpoint.
	(gdb-mouse-toggle-breakpoint): New function.  Enable/disable
	breakpoints in the margin.
	(gdb-remove-strings): Simplify.

2005-01-17  Jay Belanger  <belanger@truman.edu>

	* calc/calc-yank.el (calc-edit-mode): Inhibit read-only when
	erasing buffer.

2005-01-17  Richard M. Stallman  <rms@gnu.org>

	* progmodes/grep.el (grep-find): Copy from `grep' the condition
	for calling grep-compute-defaults.

	* play/decipher.el (decipher-mode): Don't call decipher-read-alphabet
	if buffer is empty.

	* emacs-lisp/lisp.el (backward-kill-sexp, kill-sexp): Doc fixes.

2005-01-17  Stefan Monnier  <monnier@iro.umontreal.ca>

	* hilit-chg.el (highlight-changes-mode): Don't autoload.

	* bindings.el (mode-line-mode-menu): Use bound-and-true-p for all the
	non-preloaded variables.

2005-01-17  Steven Tamm  <steventamm@mac.com>

	* textmodes/tex-mode.el (tex-start-shell): Adding -i to the
	tex-shell cause to force interactivity when using pipes.

2005-01-17  Kim F. Storm  <storm@cua.dk>

	* simple.el (just-one-space): Make arg optional.

2005-01-17  Nick Roberts  <nickrob@snap.net.nz>

	* xt-mouse.el (xterm-mouse-event): Set new optional fourth arg in
	posn-at-x-y to t to access left-margin.

2005-01-16  Michael Albinus  <michael.albinus@gmx.de>

	Sync with Tramp 2.0.47.

	* tramp.el (tramp-operation-not-permitted-regexp) New defcustom,
	catching keep-date problems in cp/scp operations.
	(tramp-handle-copy-file): Don't call `set-file-modes'
	unconditionally.  Specialized functions should know better what is
	necessary.  This improves performance a little bit, and the
	functions could catch errors with `cp -p' and `scp -p'.
	(tramp-do-copy-or-rename-file-via-buffer)
	(tramp-do-copy-or-rename-file-out-of-band): Call `set-file-modes'
	when appropriate.
	(tramp-do-copy-or-rename-file-directly): Mask `cp -p' error.
	Call `set-file-modes' when appropriate.
	(tramp-action-out-of-band): Mask `scp -p' error.  Reported by Isak
	Johnsson <isak@hypergene.com>
	(tramp-get-buffer, tramp-get-debug-buffer): Discard the undo list
	of both Tramp buffer and debug buffer.  Reported by Joakim Verona
	<joakim@verona.se>
	(tramp-file-name-for-operation): Mark `shell-command' as magic for
	Emacs only.

	* tramp-util.el (tramp-minor-mode): New minor mode.  Add it to
	`find-file-hooks' and `dired-mode-hook'.
	(tramp-minor-mode-map): Respective map.  Add remapping for
	`compile' and `recompile'.
	(tramp-remap-command, tramp-recompile): New defuns.
	(tramp-compile): Enable `tramp-minor-mode' and `compilation-mode'
	in buffer "*Compilation*".  Call the commands asynchronously.

	* tramp-vc.el (tramp-vc-do-command, tramp-vc-do-command-new)
	(tramp-vc-simple-command): Call `tramp-handle-shell-command' but
	`shell-command', because it isn't magic in XEmacs.  Reported by
	Adrian Aichner <adrian@xemacs.org>.

	* tramp-smb.el (tramp-smb-file-name-handler-alist): Add entry for
	`substitute-in-file-name.
	(tramp-smb-handle-substitute-in-file-name): New defun.
	(tramp-smb-advice-PC-do-completion): Delete advice.

2005-01-16  Kai Grossjohann  <kgrossjo@eu.uu.net>

	* tramp.el (tramp-wait-for-output): Fix typo in echo processing.
	Fix error in deleting region.

2005-01-15  Richard M. Stallman  <rms@gnu.org>

	* emacs-lisp/lisp-mnt.el (lm-with-file): Use Lisp mode in temp buffer.
	In non-temp buffer, switch syntax table temporarily.

	* emacs-lisp/lisp-mode.el (indent-pp-sexp): Doc fix.

	* replace.el (occur-accumulate-lines, occur-engine): Avoid warnings.

	* tar-mode.el (tar-extract): Bind buffer-undo-list to t.

	* imenu.el (imenu--split-menu): Copy menulist before sorting.
	(imenu--generic-function): Use START, not BEG, as pos of definition.

	* simple.el (just-one-space): Argument specifies number of spaces.

	* simple.el (eval-expression-print-format): Avoid warning
	about edebug-active.

2005-01-15  James R. Van Zandt  <jrvz@comcast.net>  (Tiny change)

	* progmodes/sh-script.el: Code copied from make-mode.el
	with small changes,
	(sh-mode-map): Bind C-c C-\.
	(sh-backslash-column, sh-backslash-align): New variables.
	(sh-backslash-region, sh-append-backslash): New functions.

2005-01-15  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* mail/rmail.el: Updated to work with movemail from GNU Mailutils
	(rmail-pop-password, rmail-pop-password-required): Move to
	rmail-obsolete group.
	(rmail-set-pop-password): Rename to rmail-set-remote-password.
	All callers updated.
	(rmail-get-pop-password): Rename to rmail-get-remote-password.
	Take an argument specifying whether it is POP or IMAP mailbox we
	are using.  All callers updated.
	(rmail-pop-password-error): Rename to
	rmail-remote-password-error.  Added mailutils-specific error message.
	(rmail-movemail-search-path)
	(rmail-movemail-variant-in-use): New variables.
	(rmail-remote-password, rmail-remote-password-required):
	New customization variables.
	(rmail-probe,rmail-autodetect, rmail-movemail-variant-p): New funs.
	(rmail-parse-url): New function.
	(rmail-get-new-mail, rmail-insert-inbox-text): Update for use
	with GNU mailutils movemail.

2005-01-15  Kevin Ryde  <user42@zip.com.au>

	* info-look.el (c-mode/symbol): Add ^` to prefix, and change
	suffix to space, $ or '$, to correctly position point when going
	to @table style constants like DBL_MAX.

2005-01-15  Jorgen Schaefer  <forcer@forcix.cx>  (tiny change)

	* type-break.el (type-break-mode, type-break-file-time)
	(type-break-file-keystroke-count, type-break-choose-file):
	Don't store data in or load data from the file if type-break-file-name
	is nil.
	(type-break-file-name): Doc update as per the above.

2005-01-15  Stephen Eglen  <S.J.Eglen@damtp.cam.ac.uk>  (tiny change)

	* woman.el (woman-dired-define-key-maybe): If KEY is undefined,
	lookup-key might return nil; handle that.

2005-01-15  Alan Mackenzie  <acm@muc.de>

	* ebrowse.el (ebrowse-class-in-tree): Return the tail of the tree
	rather than the element found, thus enabling the tree to be setcar'd.

2005-01-14  Carsten Dominik  <dominik@science.uva.nl>

	* textmodes/org.el (org-show-following-heading): New option.
	(org-show-hierarchy-above): Use `org-show-following-heading'.
	(org-cycle): Documentation fix.

	* textmodes/org.el (orgtbl-optimized): New option
	(orgtbl-mode): New command, a minor mode.
	(orgtbl-mode-map): New variable.
	(turn-on-orgtbl, orgtbl-mode, orgtbl-make-binding)
	(orgtbl-error, orgtbl-self-insert-command)
	(orgtbl-delete-backward-char, orgtbl-delete-char): New functions.

	* textmodes/org.el (org-mode): `org-table-may-need-update' is now
	a local variable in each org-mode buffer.

	* textmodes/org.el (org-set-regexps-and-options): Rename from
	`org-set-regexps'.  Added checking for STARTUP keyword.
	(org-get-current-options): Add STARTUP options.
	(org-table-insert-row): Make mode intelligent about when
	realignment is needed.
	(org-self-insert-command, org-delete-backward-char, org-delete-char):
	New commands.
	(org-enable-table-editor): New default value `optimized'.
	(org-table-blank-field): Support blanking regions if active.

2005-01-14  Carsten Dominik  <dominik@science.uva.nl>

	* textmodes/reftex-cite.el (reftex-bib-sort-year): Catch the case
	if the year is not given.

	* textmodes/reftex-ref.el (reftex-replace-prefix-escapes):
	Add new escapes %m and %M, fixed bug with %F by adding
	save-match-data.
	(reftex-reference): Remove ?. from list of spaces.
	(reftex-label-info): Add automatic label prefix recognition.

	* textmodes/reftex-index.el (reftex-index-next-phrase):
	Add slave parameter to call of `reftex-index-this-phrase'.
	(reftex-index-this-phrase): New optional argument.
	(reftex-index-region-phrases): Add slave parameter to call of
	`reftex-index-this-phrase'.
	(reftex-display-index): New argument redo.
	(reftex-index-rescan): Add 'redo to arguments of
	`reftex-display-index'.
	(reftex-index-Rescan, reftex-index-revert)
	(reftex-index-switch-index-tag): Add 'redo to arguments of
	`reftex-display-index'.
	(reftex-index-make-phrase-regexp): Fix bug with case-sensitive
	indexing.  Fix bug with matching is there is a quote before or
	after the word.

	* textmodes/reftex-cite.el (reftex-all-used-citation-keys):
	Fix bug when collecting citation keys in lines with comments.
	(reftex-citation): Prefix argument no longer rescans the document,
	but forces prompting for optional arguments of cite macros.
	(reftex-do-citation): Prompting for optional arguments implemented.

	* textmodes/reftex-vars.el (reftex-cite-format-builtin):
	Add optional arguments to most cite commands.
	(reftex-cite-cleanup-optional-args): New option
	(reftex-cite-prompt-optional-args): New option.
	(reftex-trust-label-prefix): New option.

	* textmodes/reftex-toc.el (reftex-toc-find-section):
	Add push-mark before changing the position in the buffer.

	* textmodes/reftex.el (reftex-prefix-to-typekey-alist): New variable.
	(reftex-compile-variables): Compute reftex-prefix-to-typekey-alist.

2005-01-14  Nick Roberts  <nickrob@snap.net.nz>

	* xt-mouse.el (xterm-mouse-event): Compute window co-ordinates
	more carefully.

2005-01-13  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/sgml-mode.el (sgml-fill-nobreak): New fun.
	(sgml-mode): Use it.
	(sgml-get-context): Better keep track of implicitly closed tags.

2005-01-13  Kenichi Handa  <handa@m17n.org>

	* textmodes/ispell.el: These changes are to fix misalignment error
	caused by equivalent characters of different Emacs charsets.
	(ispell-unified-chars-table): New variable.
	(ispell-get-decoded-string): New function.
	(ispell-get-casechars, ispell-get-not-casechars)
	(ispell-get-otherchars): Call ispell-get-decoded-string.

2005-01-12  Johan Bockg,Ae(Brd  <bojohan@users.sourceforge.net>

	* custom.el (custom-declare-variable): Just put symbol instead
	of (defvar . symbol) in `current-load-list'.

2005-01-12  Reiner Steib  <Reiner.Steib@gmx.de>

	* emacs-lisp/elint.el: Fixed typo in Commentary section.

2005-01-12  Jay Belanger  <belanger@truman.edu>

	* calc/calc-help.el (calc-describe-key): Use temporary info buffer
	to create a Calc summary.

2005-01-12  Kim F. Storm  <storm@cua.dk>

	* mouse.el (mouse-on-link-p): Change functionality and doc
	string to comply with latest description in lisp ref.

2005-01-12  Nick Roberts  <nickrob@snap.net.nz>

	* xt-mouse.el (xterm-mouse-translate, xterm-mouse-event):
	Enable mouse clicks on mode-line, header-line and margin.
	(event-type): Give mouse event symbols an 'event-kind property
	with value 'mouse-click.

2005-01-12  Juri Linkov  <juri@jurta.org>

	* facemenu.el (list-colors-display): Add new arg buffer-name.
	Use it.  Fix docstring.  Replace code for identifying duplicate
	colors by the name with call to `list-colors-duplicates' which
	identifies duplicate colors by the value unless the color
	is one of special Windows colors.  Set truncate-lines to t.
	Print sorted duplicate color names on each line.  Indent to 22
	\(the longest color name in rgb.txt) instead of 20.  Optimize.
	(list-colors-duplicates): New function.
	(facemenu-color-name-equal): Delete function.

	* facemenu.el (list-colors-print): New function created from code
	in list-colors-display.  Print #RRGGBB at the window right edge.
	(list-colors-display): When temp-buffer-show-function is not
	defined, call list-colors-print from temp-buffer-show-hook
	to get the right value of window-width in list-colors-print
	after the buffer is displayed.

	* simple.el (pop-mark): Move deactivate-mark out of conditional
	part to deactivate the active mark regardless of the state of the
	mark ring.

	* desktop.el (desktop-save): Add `mode: emacs-lisp' to the local
	variables line in desktop files.

2005-01-12  Juri Linkov  <juri@jurta.org>

	* isearch.el (search-highlight, isearch, isearch-lazy-highlight):
	Bring together isearch highlight related options.
	(lazy-highlight): Replace group `replace' by `matching'.
	(lazy-highlight-cleanup, lazy-highlight-initial-delay)
	(lazy-highlight-interval, lazy-highlight-max-at-a-time)
	(lazy-highlight): Add aliases to old names isearch-lazy-highlight-...
	and declare them obsolete.
	(lazy-highlight-face): Rename from isearch-lazy-highlight-face.
	(isearch-faces): Remove defgroup.
	(isearch-overlay, isearch-highlight, isearch-dehighlight):
	Move isearch highlighting code closer to lazy highlighting code.

	* replace.el (query-replace-lazy-highlight): Add lazy-highlight group.
	(query-replace-highlight, query-replace-lazy-highlight)
	(query-replace): Move definitions to the beginning of the file.

2005-01-11  Juri Linkov  <juri@jurta.org>

	* toolbar/back_arrow.xpm, toolbar/back_arrow.pbm
	* toolbar/lc-back_arrow.xpm, toolbar/lc-fwd_arrow.xpm
	* toolbar/fwd_arrow.xpm, toolbar/fwd_arrow.pbm: New icons.

	* info.el (Info-history-forward): New variable.
	(Info-select-node): Reset Info-history-forward to nil.
	(Info-last): Turn into defalias.
	(Info-history-back): Rename from Info-last.
	Add current node to Info-history-forward.
	(Info-history-forward): New fun.
	(Info-mode-map): Replace Info-last by Info-history-back.
	Bind Info-history-forward to "r".
	(Info-mode-menu): Replace Info-last by Info-history-back.
	Fix menu item text.  Add menu item for Info-history-forward.
	(info-tool-bar-map): Replace Info-last by Info-history-back.
	Replace its icon "undo" by "back_arrow".  Add icon "fwd_arrow"
	for Info-history-forward.
	(Info-mode): Replace Info-last by Info-history-back in docstring.
	Add local variable Info-history-forward.
	(Info-goto-emacs-command-node): Replace Info-last by Info-history-back.

2005-01-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* mouse.el (mouse-drag-mode-line-1, mouse-drag-vertical-line)
	(mouse-drag-region, mouse-drag-region-1, mouse-drag-secondary):
	Ignore select-window events rather than fiddle with
	mouse-autoselect-window.

2005-01-11  Matthew Mundell  <matt@mundell.ukfsn.org>

	* type-break.el (type-break-mode): Fix previous change.

2005-01-10  Jay Belanger  <belanger@truman.edu>

	* calc/calc-ext.el (calc-reset): Reset when inside embedded
	calculator; only reset when point is inside a calculator.
	Don't adjust the window height if the window takes up the whole height
	of the frame.

2005-01-10  Thien-Thi Nguyen  <ttn@gnu.org>

	* ebuff-menu.el (Electric-buffer-menu-mode):
	Preserve value of buffer-local var header-line-format.

2005-01-09  Jay Belanger  <belanger@truman.edu>

	* calc/calc.el (calc-mode-var-list-restore-saved-values):
	Make sure settings file exists before accessing it.

	* calc/calc-embed.el (calc-embedded-subst):
	Replace math-multi-subst-rec, which is only supposed to be called
	by math-multi-subst, by math-multi-subst.

2005-01-09  Andre Spiegel  <spiegel@gnu.org>

	* vc.el (vc-allow-async-revert): New user option.
	(vc-disable-async-diff): New internal variable.
	(vc-revert-buffer): Use them to disable asynchronous diff.

	* vc-cvs.el, vc-arch.el, vc-svn.el, vc-mcvs.el (vc-cvs-diff)
	(vc-arch-diff, vc-svn-diff, vc-mcvs-diff): Don't diff
	asynchronously if vc-disable-async-diff is t.

2005-01-09  Jay Belanger  <belanger@truman.edu>

	* calc/calc.el (defcalcmodevar): New macro.
	(calc-mode-var-list-restore-default-values)
	(calc-mode-var-list-restore-saved-values): New functions.
	(calc-mode-var-list): Use defcalcmodevar to define it.
	(calc-always-load-extensions, calc-line-numbering)
	(calc-line-breaking, calc-display-just, calc-display-origin)
	(calc-number-radix, calc-leading-zeros, calc-group-digits)
	(calc-group-char, calc-point-char, calc-frac-format)
	(calc-prefer-frac, calc-hms-format, calc-date-format)
	(calc-float-format, calc-full-float-format, calc-complex-format)
	(calc-complex-mode, calc-infinite-mode, calc-display-strings)
	(calc-matrix-just, calc-break-vectors, calc-full-vectors)
	(calc-full-trail-vectors, calc-vector-commas, calc-vector-brackets)
	(calc-matrix-brackets, calc-language, calc-language-option)
	(calc-left-label, calc-right-label, calc-word-size)
	(calc-previous-modulo, calc-simplify-mode, calc-auto-recompute)
	(calc-display-raw, calc-internal-prec, calc-angle-mode)
	(calc-algebraic-mode, calc-incomplete-algebraic-mode)
	(calc-symbolic-mode, calc-matrix-mode, calc-shift-prefix)
	(calc-window-height, calc-display-trail, calc-show-selections)
	(calc-use-selections, calc-assoc-selections)
	(calc-display-working-message, calc-auto-why, calc-timing)
	(calc-mode-save-mode, calc-standard-date-formats, calc-autorange-units)
	(calc-was-keypad-mode, calc-full-mode, calc-user-parse-tables)
	(calc-gnuplot-default-device, calc-gnuplot-default-output)
	(calc-gnuplot-print-device, calc-gnuplot-print-output)
	(calc-gnuplot-geometry, calc-graph-default-resolution)
	(calc-graph-default-resolution-3d, calc-invocation-macro)
	(calc-show-banner): Use defcalcmodevar to declare them and set
	their default values.

	* calc/calc-ext.el (calc-reset): Restore saved values of variables
	instead of default values (but restore default values if there is
	an argument of 0).

2005-01-09  David Kastrup  <dak@gnu.org>

	* desktop.el (desktop-restore-eager): Fix typo in type.

2005-01-08  Richard M. Stallman  <rms@gnu.org>

	* cus-edit.el (customize): Delete :link.

2005-01-08  Jay Belanger  <belanger@truman.edu>

	* calc/calc.el (calc-mode): Remove the extension from the
	`calc-settings-file' file name when loading it.

2005-01-08  Kim F. Storm  <storm@cua.dk>

	* info.el (Info-mode-map, Info-next-link-keymap)
	(Info-prev-link-keymap, Info-up-link-keymap):
	Map follow-link to mouse-face.
	(Info-fontify-node): Add "mouse-2: " prefix to tooltip.

2005-01-08  Jay Belanger  <belanger@truman.edu>

	* calc/calc.el (calc-settings-file): Change default value.
	Suggested by cgw in a comment in calc-mode.el.

	* calc/calc-mode.el (calc-settings-file-name):
	Compare calc-settings-file to user-init-file instead of ~/.emacs.
	Replace ~/.emacs in a prompt by calc-settings-file.

2005-01-07  Lars Hansen  <larsh@math.ku.dk>

	* desktop.el (desktop-restore-eager, desktop-lazy-verbose)
	(desktop-lazy-idle-delay): New customizable variables.
	(desktop-buffer-args-list): New variable.
	(desktop-append-buffer-args): New function.
	(desktop-save): Call desktop-append-buffer-args for some buffers.
	(desktop-lazy-create-buffer): New function.
	(desktop-idle-create-buffers): New function.
	(desktop-read): Add message about buffers to restore lazily.
	(desktop-lazy-abort): New command.
	(desktop-clear): Call desktop-lazy-abort.
	(desktop-lazy-complete): New command.

2005-01-06  Richard M. Stallman  <rms@gnu.org>

	* emacs-lisp/find-func.el (find-face-definition):
	Rename from find-face.

2005-01-06  Kim F. Storm  <storm@cua.dk>

	* simple.el (completion-list-mode-map): Map follow-link to mouse-face.

	* man.el (Man-xref-man-page, Man-xref-header-file)
	(Man-xref-normal-file): Add follow-link property.

2005-01-06  Jay Belanger  <belanger@truman.edu>

	* calc/calc-units.el: Make sure the proper macro definitions are
	available when compiling.

2005-01-06  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-lazy-highlight-update):
	Rename `isearch-lazy-highlight-interval' to `lazy-highlight-interval'.

2005-01-06  Miles Bader  <miles@gnu.org>

	* isearch.el (lazy-highlight): Rename from `lazy-highlight-face'.
	(isearch-lazy-highlight-face): Use new name.

2005-01-05  Stefan Monnier  <monnier@iro.umontreal.ca>

	* uniquify.el (uniquify-rationalize-file-buffer-names):
	Re-add an interactive spec.
	(uniquify-rationalize-file-buffer-names): Fix corner case when renaming
	to the same name.

	* isearch.el (isearch-dehighlight): Remove unused arg `totally'.
	(isearch-update, isearch-done): Adjust calls accordingly.

2005-01-05  Richard M. Stallman  <rms@gnu.org>

	* custom.el (custom-set-variables, custom-theme-set-variables):
	Clarify documentation.

	* emacs-lisp/find-func.el (find-variable)
	(find-variable-other-window, find-variable-other-frame):
	Fix the TYPE args to find-function-read and find-function-do-it.
	(find-function): Doc fix.
	(find-function-at-point): Replace function-at-point alias.

2005-01-04  Richard M. Stallman  <rms@gnu.org>

	* cus-face.el (custom-declare-face):
	Record defface in current-load-list.

	* help-fns.el (variable-at-point): New arg ANY-SYMBOL.

	* emacs-lisp/find-func.el: Doc fixes.
	(find-face-regexp): New variable.
	(find-function-regexp-alist): New variable.
	(find-function-C-source): Third arg is now TYPE.
	(find-function-search-for-symbol): Handle general TYPE.
	(find-function-read, find-function-do-it): Handle general TYPE.
	(find-definition-noselect, find-face): New functions.
	(function-at-point): Alias deleted.

2005-01-04  Stefan Monnier  <monnier@iro.umontreal.ca>

	* battery.el (display-battery-mode): Rename from display-battery.
	Handle the case where it gets turned off.

2005-01-04  Richard M. Stallman  <rms@gnu.org>

	* cus-edit.el (customize): Make :link point to user doc.

	* man.el (Man-fontify-manpage): Turn off undo generation.

	* add-log.el (change-log-font-lock-keywords): Don't match just "From".

2005-01-04  Andreas Schwab  <schwab@suse.de>

	* files.el (insert-directory): Only look for error lines in
	inserted text.  Don't move too far after processing --dired markers.

2005-01-04  Richard M. Stallman  <rms@gnu.org>

	* mail/mailabbrev.el (sendmail-pre-abbrev-expand-hook):
	Don't expand if the character is @, period, dash, etc.
	(define-mail-abbrev): Quote names that contain problem characters.

2005-01-04  Thien-Thi Nguyen  <ttn@gnu.org>

	* progmodes/hideshow.el: No longer require `cl'; `dolist' is standard.

2005-01-03  Richard M. Stallman  <rms@gnu.org>

	* replace.el (replace-dehighlight): Use lazy-highlight-cleanup.
	(query-replace-highlight, query-replace-lazy-highlight)
	(query-replace): Definitions moved up.  Doc fix.

2005-01-03  Richard M. Stallman  <rms@gnu.org>

	* isearch.el (lazy-highlight): Group renamed from isearch-lazy-...
	(lazy-highlight-cleanup, lazy-highlight-initial-delay)
	(lazy-highlight-interval, lazy-highlight-max-at-a-time)
	(lazy-highlight-face): Rename from isearch-lazy-...
	Change all references to them.

2005-01-03  Luc Teirlinck  <teirllm@auburn.edu>

	* cus-edit.el (custom-file): Doc fix for defcustom.
	(custom-file): The function no longer sets the variable
	`custom-file' to its return value.

	* startup.el (command-line): No longer load `custom-file'.

2005-01-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/find-func.el (find-variable-regexp): Avoid defface.

	* progmodes/perl-mode.el (perl-nochange, perl-calculate-indent):
	Don't confuse module-prefixed identifiers for labels.
	Reported by Juan-Leon Lahoz Garcia <juanleon1@gmail.com>.

2005-01-02  Richard M. Stallman  <rms@gnu.org>

	* files.el (basic-save-buffer-1): Fix previous change.

	* loadhist.el (file-loadhist-lookup): New function.
	(file-provides, file-requires): Use it.

	* electric.el (Electric-pop-up-window): Use fit-window-to-buffer
	instead of calculating the right size.

2005-01-02  Karl Chen  <quarl@cs.berkeley.edu>  (tiny change)

	* vc-svn.el (vc-svn-diff): Stay local if possible.

2005-01-02  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-arch.el (vc-arch-workfile-version): Handle the empty-branch case.

	* files.el (hack-local-variables): Fix last change.

2005-01-02  Jay Belanger  <belanger@truman.edu>

	* calc/calc-yank.el (calc-edit-top): New variable.
	(calc-edit-mode): Set calc-edit-top to be the beginning of the edited
	object.  Change header properties.
	(calc-edit-finish, calc-edit-finish-stack-object)
	(calc-edit-show-buffer): Use calc-edit-top to find the beginning of the
	edited object.
	* calc/calc-sel.el (calc-finish-selection-edit): Use calc-edit-top
	for the beginning of the edited object.
	* calc/calc-embed.el (calc-embedded-finish-edit): Use calc-edit-top
	for the beginning of the edited object.
	* calc/calc-prog.el (calc-edit-macro-finish-edit)
	(calc-finish-formula-edit, calc-macro-repeats)
	(calc-edit-macro-adjust-buffer, calc-edit-format-macro-buffer)
	(calc-edit-macro-pre-finish-edit): Use calc-edit-top for the
	beginning of the edited object.
	(calc-user-define-edit): Change the header for editing macros.
	Remove unnecessary variable.

2005-01-01  Jay Belanger  <belanger@truman.edu>

	* calc/calc-yank.el (calc-edit-mode): Change default header.
	(calc-edit-finish, calc-show-edit-buffer): Adjust to handle new header.
	* calc/calc-store.el (calc-edit-variable): Change title to match new
	header.
	* calc/calc-prog.el (calc-edit-user-syntax): Change title in edit
	mode to match new header.
	(calc-user-define-edit): Change titles to include names of commands.
	(calc-finish-formula-edit): Adjust to handle new header.
	(calc-finish-macro-edit): Remove.
	(calc-edit-macro-repeats, calc-edit-macro-adjust-buffer)
	(calc-edit-macro-command, calc-edit-macro-command-type)
	(calc-edit-macro-combine-alg-ent, calc-edit-macro-combine-ext-command)
	(calc-edit-macro-combine-var-name, calc-edit-macro-combine-digits)
	(calc-edit-format-macro-buffer, calc-edit-macro-pre-finish-edit)
	(calc-edit-macro-finish-edit): New functions.
	(calc-user-define-edit): Use new functions to edit named calc macros.

2005-01-01  Stefan  <monnier@iro.umontreal.ca>

	* files.el (hack-local-variables): Cleanup prefix/suffix matching.

	* ses.el (copy-region-as-kill): Deactivate mark.

2005-01-01  Richard M. Stallman  <rms@gnu.org>

	* replace.el (occur-1): If the output buffer is also an input,
	don't kill it, rename it.

	* faces.el (set-face-background, set-face-foreground): Doc fix.

	* cus-face.el (custom-face-attributes): Fix :help-echo strings
	for :foreground and :background.

	* dired.el (dired-view-command-alist): Variable deleted.
	(dired-view-file, dired-mouse-find-file-other-window):
	Delete the code to use it.

2005-01-01  Kim F. Storm  <storm@cua.dk>

	* image.el (insert-sliced-image): Use t for line-height property.

2004-12-31  Jay Belanger  <belanger@truman.edu>

	* calc/calc-store.el (calcVar-digit, calcVar-oper): Remove the need
	for "var-" at the beginning of the minibuffer.

2004-12-31  Richard M. Stallman  <rms@gnu.org>

	* faces.el (read-face-name):
	Don't treat an attribute spec as a list of faces.

	* simple.el (undo): Use undo-equiv-table to detect
	unexpected changes since previous undo.
	(undo-list-saved): Variable deleted.
	(buffer-disable-undo): Don't alter undo-list-saved.

	* files.el (require-final-newline): Allow `visit' and `visit-save'.
	(mode-require-final-newline): New option.
	(after-find-file): Handle require-final-newline with new values.
	(basic-save-buffer): Handle new values of require-final-newline.

	* progmodes/sh-script.el (sh-require-final-newline):
	Alist value now controls whether to use mode-require-final-newline.
	(sh-set-shell): Implement that new meaning.

	* progmodes/cc-vars.el (c-require-final-newline): Fix custom type, doc.
	* progmodes/cc-mode.el (c-common-init): Use mode-require-final-newline.
	* progmodes/antlr-mode.el (antlr-mode): Use mode-require-final-newline.
	Delete old-Emacs compatibility code.
	(antlr-c-common-init): Function deleted.

	* net/snmp-mode.el (snmp-common-mode): Use mode-require-final-newline.
	* progmodes/vhdl-mode.el (vhdl-mode): Use mode-require-final-newline.
	* progmodes/simula.el (simula-mode): Use mode-require-final-newline.
	* progmodes/python.el (python-mode): Use mode-require-final-newline.
	* progmodes/perl-mode.el (perl-mode): Use mode-require-final-newline.
	* progmodes/modula2.el (modula-2-mode): Use mode-require-final-newline.
	* progmodes/mixal-mode.el (mixal-mode): Use mode-require-final-newline.
	* progmodes/idlwave.el (idlwave-mode): Use mode-require-final-newline.
	* progmodes/icon.el (icon-mode): Use mode-require-final-newline.
	* progmodes/fortran.el (fortran-mode): Use mode-require-final-newline.
	* progmodes/f90.el (f90-mode): Use mode-require-final-newline.
	* progmodes/cperl-mode.el (cperl-mode): Use mode-require-final-newline.
	* progmodes/cfengine.el (cfengine-mode): Use mode-require-final-newline.
	* progmodes/ada-mode.el (ada-mode): Use mode-require-final-newline.
	* textmodes/text-mode.el (text-mode): Use mode-require-final-newline.
	* textmodes/texinfo.el (texinfo-mode): Use mode-require-final-newline.

2004-12-31  Jay Belanger  <belanger@truman.edu>

	* calc/calc-graph.el (calc-graph-show-dumb): Mention C-cC-c as the
	way to return to Calc.

	* calc/calc-yank.el (calc-edit-mode): Mention C-cC-c as the way to
	finish, C-xk as the way to cancel the edit.  Add cancel routine to
	kill-buffer-hook.

	* calc/calc.el (calc-same-interface, calc-quit): Remove obsolete
	MacEdit code.

	* calc/calc-prog.el: Remove obsolete MacEdit code.
	(calc-macro-edit-algebraic, calc-macro-edit-variable)
	(calc-macro-edit-variable-2, calc-macro-edit-quick-digit): Remove.

2004-12-31  Kenichi Handa  <handa@m17n.org>

	* international/mule.el	(buffer-file-coding-system-explicit):
	Rename for explicit-buffer-file-coding-system.
	(after-insert-file-set-coding): Adjust for the above change.

	* files.el (revert-buffer): Change explicit-buffer-file-coding-system
	to buffer-file-coding-system-explicit.
	(basic-save-buffer-1): Likewise.

2004-12-30  Richard M. Stallman  <rms@gnu.org>

	* textmodes/artist.el (artist-butlast-fn): Var deleted.
	(artist-butlast, artist-last): Functions deleted.
	(artist-ellipse-mirror-quadrant): Call last and butlast directly.
	(artist-compute-key-compl-table): Call remq directly.
	(artist-remove-nulls): Function deleted.
	(artist-vaporize-lines, artist-flood-fill): Use push and pop directly.
	(artist-push, artist-pop): Macro deleted.

2004-12-30  Andreas Leue  <al@sphenon.de>

	* textmodes/artist.el (artist-version): 1.2.6
	(artist-prev-next-op-alist): New variable.
	(artist-select-next-op-in-list): New function.
	(artist-select-prev-op-in-list): New function.
	(artist-make-prev-next-op-alist): New function.
	(artist-is-in-op-list-p): New function.
	(artist-get-first-non-nil-op): New function.
	(artist-get-last-non-nil-op): New function.
	(artist-mode-init): Call artist-get-last-non-nil-op to initialize
	artist-prev-next-op-alist.
	(artist-mode-map): Add binding for C-mouse-4 and C-mouse-5 to
	change drawing operation.

2004-12-30  Luc Teirlinck  <teirllm@auburn.edu>

	* autorevert.el (auto-revert-tail-handler): Put in undo boundaries.

2004-12-31  Masatake YAMATO  <jet@gyve.org>

	* server.el (server-process-filter): Suppress `error', too.

2004-12-30  Jay Belanger  <belanger@truman.edu>

	* calc/calc-store.el (calc-copy-variable): Fix mistyped variable name.
	Change the way a variable is displayed in a message.

	* calc/calc-prog.el (calc-user-define-edit, calc-finish-macro-edit)
	(calc-user-define-permanent, calc-execute-kbd-macro):
	Replace old function MacEdit-parse-keys with edmacro-parse-keys.

2004-12-30  Kenichi Handa  <handa@m17n.org>

	* files.el (basic-save-buffer-1):
	Set explicit-buffer-file-coding-system to last-coding-system-used.
	(revert-buffer): Pay attention to
	explicit-buffer-file-coding-system (not buffer-file-coding-system)
	on bind coding-system-for-read.

	* international/mule.el (explicit-buffer-file-coding-system):
	New buffer local variable.
	(after-insert-file-set-coding): Set it to coding-system-for-read.

2004-12-29  Luc Teirlinck  <teirllm@auburn.edu>

	* autorevert.el (auto-revert-tail-mode): Doc fix for defvar.

2004-12-29  Sanghyuk Suh  <han9kin@mac.com>

	* term/mac-win.el (mac-drag-n-drop): Handle drag-n-drop events
	that include line numbers.

2004-12-29  Milan Zamazal  <pdm@zamazal.org>

	* files.el (hack-local-variables): If no PREFIX, set it to "^".
	Redundant variable PREFIXLEN removed.

2004-12-28  Matt Hodges  <MPHodges@member.fsf.org>

	* eshell/em-hist.el (eshell-previous-matching-input):
	Start the deletion from the end of the output.

2004-12-29  YAMAMOTO Mitsuharu  <mituharu@math.s.chiba-u.ac.jp>

	* term/mac-win.el: Require x-dnd.
	(mac-drag-n-drop): Sync with W32 version.  Use x-dnd.el functions.

2004-12-29  David Kastrup  <dak@gnu.org>

	* international/mule.el (decode-coding-inserted-region):
	Don't barf if `buffer-undo-list' is already set to `t'.

2004-12-29  Jay Belanger  <belanger@truman.edu>

	* calc/calc-prog.el (calc-user-define-formula): Put default values
	for function names in prompts.
	(calc-user-define-permanent, calc-user-define-composition)
	(calc-user-define-formula): Remove the need for "calcFunc-" in the
	default input for algebraic functions.

2004-12-29  Thien-Thi Nguyen  <ttn@gnu.org>

	* vc-rcs.el (vc-rcs-annotate-command):
	Fix omission bug: Call `vc-setup-buffer'.

2004-12-29  Kenichi Handa  <handa@m17n.org>

	* international/mule.el (recode-region): New function.

2004-12-28  Richard M. Stallman  <rms@gnu.org>

	* simple.el (undo-extra-outer-limit): New variable.
	(undo-outer-limit-truncate): Test and set it.

	* emacs-lisp/lisp.el (mark-sexp, mark-defun): New arg ALLOW-EXTEND
	enables the feature to extend the existing region.

	* simple.el (mark-word): New arg ALLOW-EXTEND
	enables the feature to extend the existing region.

	* textmodes/paragraphs.el (mark-paragraph): New arg ALLOW-EXTEND
	enables the feature to extend the existing region.

	* startup.el (site-run-file): Don't allow setting it with Custom.

	* simple.el (buffer-disable-undo): Fix previous change.

2004-12-27  Masatake YAMATO  <jet@gyve.org>

	* hexl.el (hexlify-buffer): Remove fontification here.
	Use font lock mechanism instead.
	(hexl-font-lock-keywords): New font lock kewords.
	(hexl-mode-old-font-lock-keywords): New variable.
	(hexl-mode): Store the old font lock keywords.
	(hexl-mode-exit): Restore the old font lock keywords.

2004-12-27  Richard M. Stallman  <rms@gnu.org>

	* simple.el (undo): Fix previous change.

2004-12-27  YAMAMOTO Mitsuharu  <mituharu@math.s.chiba-u.ac.jp>

	* term/mac-win.el: Sync with x-win.el.  Rearrange the contents.
	Call mac-clear-font-name-table if invoked on Mac OS 8/9.
	Call x-open-connection on Mac OS X.

2004-12-27  Richard M. Stallman  <rms@gnu.org>

	* files.el (buffer-save-without-query): New var (buffer-local).
	(save-some-buffers): Save those buffers first, w/o asking.

	* files.el (insert-directory-ls-version): New variable.
	(insert-directory): When ls returns an error, test the version
	number to decide what the return code means.
	With --dired output format, detect and distinguish lines
	that are really error messages.
	(insert-directory-adj-pos): New function.

	* bookmark.el (bookmark-jump): Nice error if BOOKMARK is nil.

	* battery.el (battery-mode-line-format): Remove initial spaces.

	* uniquify.el (uniquify-rationalize-file-buffer-names):
	Delete interactive spec.

	* type-break.el (type-break-mode): Set buffer-save-without-query.
	Remove code that tried to set save-some-buffers-always.
	(type-break-file-keystroke-count): Bind deactivate-mark.

	* mouse.el (mouse-drag-region): Bind mouse-autoselect-window.

	* simple.el (next-error-buffer-p): New arg AVOID-CURRENT.
	Test that the buffer is live, and maybe reject current buffer too.
	Clarify.
	(next-error-find-buffer): Rewrite for clarity.

	* loadup.el: Don't use buffer-disable-undo; do it directly.

	* help-fns.el (describe-function-1): Call symbol-file with `defun'.
	(describe-variable): Call symbol-file with `defvar'.

	* subr.el (messages-buffer-max-lines): Alias for message-log-max.
	(symbol-file): Rewritten to handle new load-history format.
	Now takes an arg TYPE to specify looking for a particular
	type of definition only.

	* emacs-lisp/debug.el (debugger-make-xrefs):
	Call symbol-file with `defun'.

	* emacs-lisp/find-func.el (find-function-noselect):
	Call symbol-file with `defun'.
	(find-variable-noselect): Call symbol-file with `defvar'.

	* eshell/esh-cmd.el (eshell-find-alias-function):
	Call symbol-file with `defun'.

	* eshell/esh-test.el (eshell-test-goto-func):
	Call symbol-file with `defun'.

	* mail/rmail.el (rmail-resend):
	Let MAIL-ALIAS-FILE arg override mail-personal-alias-file.

	* net/goto-addr.el (goto-address-mail-regexp): Allow = in username.

	* progmodes/compile.el (compilation-find-buffer): Rename arg.

	* textmodes/texinfmt.el (texinfo-format-buffer-1):
	Call buffer-disable-undo.

	* simple.el (undo-list-saved): New variable (buffer-local).
	(undo): Set and test it.
	(buffer-disable-undo): Move here from buffer.c.
	Clear out undo-list-saved.

	* international/mule.el (decode-coding-inserted-region):
	Set buffer-undo-list in a correct and optimal way.

	* progmodes/cperl-mode.el (cperl-find-bad-style): Use with-no-warnings.
	(cperl-font-lock-unfontify-region-function): No need to save and
	restore info, since font-lock.el does it for us.

	* ansi-color.el (save-buffer-state): Definition deleted.
	(ansi-color-unfontify-region): Don't use save-buffer-state.

2004-12-27  Dave Love  <fx@gnu.org>

	* wid-edit.el (function): Use restricted-sexp as parent.

2004-12-27  Kevin Ryde  <user42@zip.com.au>

	* simple.el (next-matching-history-element): Use same
	`interactive' form as previous-matching-history-element.

	* ffap.el (ffap-string-at-point-mode-alist): Add "*" to url chars,
	it can appear unencoded and has been seen from yahoo.

2004-12-27  Sergey Poznyakoff  <gray@Mirddin.farlep.net>  (tiny change)

	* mail/smtpmail.el (smtpmail-try-auth-methods): Send AUTH CRAM-MD5
	in upper case.  Reported by Wojciech Polak <polak@gnu.org>.

2004-12-27  Kenichi Handa  <handa@m17n.org>

	* international/utf-8.el (utf-translate-cjk-load-tables):
	Bind coding-system-for-read to nil while loading subst-*.

2004-12-26  Jay Belanger  <belanger@truman.edu>

	* calc/calc-store.el (calc-read-var-name): Remove "var-" from
	default input.

2004-12-26  Luc Teirlinck  <teirllm@auburn.edu>

	* buff-menu.el (Buffer-menu-revert-function): Clear out undo info
	before reverting and disable undo recording while reverting.

2004-12-26  Thien-Thi Nguyen  <ttn@gnu.org>

	* progmodes/hideshow.el (hs-set-up-overlay): New user var.
	(hs-make-overlay): New function.
	(hs-isearch-show-temporary): Handle `display' overlay prop specially.
	(hs-flag-region): Delete function.
	(hs-hide-comment-region): No longer use `hs-flag-region'.
	Instead, use `hs-discard-overlays' and `hs-make-overlay'.
	(hs-hide-block-at-point): Likewise.
	(hs-hide-level-recursive): Use `hs-discard-overlays'.
	(hs-hide-all, hs-show-all): Likewise.
	(hs-show-block): Likewise.
	Also, use overlay prop `hs-b-offset', not `hs-ofs'.

2004-12-24  Thien-Thi Nguyen  <ttn@gnu.org>

	* progmodes/hideshow.el: Require `cl' when compiling.
	Remove XEmacs and Emacs 19 compatibility.
	Use `dolist' and `add-to-list' for load-time actions.
	(hs-discard-overlays): Use `dolist'.
	(hs-show-block): Likewise.

2004-12-23  Dan Nicolaescu  <dann@ics.uci.edu>

	* faces.el (mode-line, mode-line-inactive): Use min-colors.

2004-12-23  Thien-Thi Nguyen  <ttn@gnu.org>

	* progmodes/hideshow.el (hs-inside-comment-p): Fix omission bug:
	When extending backwards, move outside the current comment first.

2004-12-22  Kenichi Handa  <handa@m17n.org>

	* international/quail.el (quail-start-translation): Fix prompt
	string for the case if input-method-use-echo-area being non-nil.
	(quail-start-conversion): Likewise.
	(quail-show-guidance): Don't show guidance if
	input-method-use-echo-area is non-nil.

2004-12-21  Richard M. Stallman  <rms@gnu.org>

	* textmodes/ispell.el (ispell-help): Bind resize-mini-windows.

2004-12-21  Markus Rost  <rost@ias.edu>

	* calendar/diary-lib.el (mark-diary-entries):
	Set mark-diary-entries-in-calendar only after checking for diary-file.

2004-12-21  Richard M. Stallman  <rms@gnu.org>

	* faces.el (escape-glyph): Use blue against light foreground.

	* simple.el (undo-outer-limit-truncate): New function.
	(undo-outer-limit-function): Use undo-outer-limit-truncate.

2004-12-21  Eli Barzilay  <eli@barzilay.org>

	* calculator.el (calculator-radix-grouping-mode)
	(calculator-radix-grouping-digits)
	(calculator-radix-grouping-separator):
	New defcustoms for the new radix grouping mode functionality.
	(calculator-mode-hook): Now used in electric mode too,
	(calculator): Call it.
	(calculator-mode-map): Some new keys.
	(calculator-message): New function.  Some new calls.
	(calculator-op, calculator-set-register): Use it.
	(calculator-string-to-number): New function, mostly moved and
	updated code from calculator-curnum-value.
	(calculator-curnum-value): Use it.
	(calculator-paste): Use it, and update grabbing the current-kill.
	(calculator-rotate-displayer)
	(calculator-rotate-displayer-back): Toggle digit grouping when
	in radix mode, use calculator-message.
	(calculator-displayer-prev, calculator-displayer-next):
	Change digit group size when in radix mode.
	(calculator-number-to-string): Rename from
	calculator-num-to-string.  Now deals with digit grouping in
	radix mode.
	(calculator-update-display, calculator-put-value): Use the new name.
	(calculator-fact): Return a floating point number.
	(calculator-mode): Doc fix.

2004-12-20  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* calendar/calendar.el (view-other-diary-entries): Add autoload.
	* calendar/diary-lib.el (view-other-diary-entries):
	Use current-prefix-arg in interactive spec.

2004-12-19  Jay Belanger  <belanger@truman.edu>

	* calc/calc-aent.el (calcAlg-blank-matching-open):
	Temporarily adjust the syntax of both delimiters of half-open intervals.

2004-12-19  Kim F. Storm  <storm@cua.dk>

	* mouse.el (mouse-1-click-follows-link): Doc fix.

2004-12-18  YAMAMOTO Mitsuharu  <mituharu@math.s.chiba-u.ac.jp>

	* term/mac-win.el (encoding-vector, mac-font-encoder-list)
	(ccl-encode-mac-centraleurroman-font): Use centraleurroman
	instead of centraleuropean as the name

2004-12-17  Michael Albinus  <michael.albinus@gmx.de>

	Sync with Tramp 2.0.46.

	* net/tramp.el (tramp-maybe-send-perl-script): Change order of
	parameters wrt Tramp convention.
	(tramp-handle-file-attributes-with-perl)
	(tramp-handle-directory-files-and-attributes): Apply it.
	(tramp-do-copy-or-rename-file-out-of-band): Check for existence of
	`copy-program'.  Reported by Zack Weinberg
	<zack@codesourcery.com>.
	(top): Set `edebug-form-spec' property directly rather than
	calling `def-edebug-spec'.

	* net/tramp-smb.el (tramp-smb-advice-PC-do-completion): Make the
	advice less fragile.  Surround temporary redefinition of
	`substitute-in-file-name' with `unwind-protect'.  Suggested by
	Matt Hodges <MPHodges@member.fsf.org>.

2004-12-17  Juri Linkov  <juri@jurta.org>

	* replace.el (occur-accumulate-lines, occur-engine):
	Make forcing deferred font-lock fontification jit-specific.

2004-12-17  Kim F. Storm  <storm@cua.dk>

	* mouse.el (mouse-1-click-follows-link): New defcustom.
	(mouse-on-link-p): New function.
	(mouse-drag-region-1): Implement mouse-1-click-follows-link
	functionality.  Map a mouse-1 click event into a mouse-2 (or
	other) event when position is inside a link.

	* tooltip.el (tooltip-show-help-function): Replace "mouse-2"
	prefix in tooltip text with "mouse-1" when this is a link
	recognized by mouse-1-click-follows-link functionality.

	* help.el (describe-key): Report effective and original binding
	for mouse-1 when clicked on a link.
	(describe-mode): Add follow-link property to "minor-mode" button.

	* help-fns.el (describe-variable): Add follow-link property to
	"below" button.

	* help-mode.el (help-xref): Add follow-link property.

	* apropos.el (apropos-symbol, apropos-function, apropos-macro)
	(apropos-command, apropos-variable, apropos-face, apropos-group)
	(apropos-widget, apropos-plist): Add follow-link property.

	* pcvs-defs.el (cvs-mode-map): Map follow-link to a function which
	checks if position is in a filename, rather than some other
	clickable item.  Function looks for cvs-filename-face at position.

	* wid-edit.el (widget-specify-field, widget-specify-button):
	Map a :follow-link keyword into a follow-link property.
	(link): Add :follow-link keyword, map to RET binding.

	* dired.el (dired-mode-map): Map follow-link to mouse-face.

	* progmodes/compile.el (compilation-minor-mode-map)
	(compilation-button-map, compilation-mode-map): Likewise.

2004-12-17  Thien-Thi Nguyen  <ttn@gnu.org>

	* play/zone.el (zone): Init `line-spacing' from orig buffer.
	(zone-replace-char): Take `count' and `del-count'
	instead of `direction'.  Update callers.  When `del-count' is
	non-nil, delete that many characters, otherwise `count' characters
	backwards.  Insert the newly-replaced string `count' times.
	(zone-fret): Handle chars w/ width greater than one.
	(zone-fall-through-ws): No longer take window width `ww'.
	Update callers.  Add handling for `char-width' greater than one.
	(zone-pgm-drip): Update var holding window-end position every cycle.

2004-12-17  Andre Spiegel  <spiegel@gnu.org>

	* vc.el (vc-default-update-changelog): Use insert-file-contents,
	rather than insert-file.

2004-12-16  Jay Belanger  <belanger@truman.edu>

	* calc/calc-comb.el (var-RandSeed): Don't initially bind it.
	(math-init-random-base, math-random-digit): Check to see if
	var-RandSeed is bound.
	(math-random-last): Declare it.
	(math-random-digit): Don't make math-random-last local.

2004-12-16  Thien-Thi Nguyen  <ttn@gnu.org>

	* play/zone.el (zone): Fix omission bug: Use a self-disabling
	one-shot thunk for uniform (error, quit, normal) recovery.
	Reported by John Paul Wallington.
	(zone-pgm-random-life): Fix bug:
	Recognize empty initial field by lack of "@" chars.

2004-12-16  Juri Linkov  <juri@jurta.org>

	* help.el (function-called-at-point):
	* help-fns.el (variable-at-point): As a last resort try stripping
	non-word prefixes and suffixes.

	* descr-text.el (describe-property-list): Don't treat syntax-table
	specially.  Use describe-text-sexp which inserts [show] button
	for large objects and handles printing errors.  Sort properties
	by names in alphabetical order instead of by value sizes.
	Add `mouse-face' to list of properties for `describe-face' widget.
	(describe-char): Mask out face-id from 19 bits of character.
	Print face-id separately.

	* replace.el (occur-accumulate-lines, occur-engine):
	Fontify unfontified matching lines in the source buffer
	before copying them.
	(occur-engine): Don't put mouse-face on context lines.
	(occur-next-error): Set point to line beginning/end
	before searching for prev/next property to skip multiple
	matches on a line (not supported by occur engine).
	Remove redundant prefix-numeric-value.

2004-12-15  Juri Linkov  <juri@jurta.org>

	* replace.el (match): New face.
	(list-matching-lines-face): Change default from `bold' to `match'.

	* progmodes/grep.el (grep-match-face): New defvar.
	(grep-mode-font-lock-keywords): Use grep-match-face instead of
	compilation-column-face to highlight grep matches.

	* apropos.el (apropos-match-face): Change default from
	`secondary-selection' to `match'.

	* info-look.el (info-lookup-highlight-face): Change default from
	`highlight' to `match'.

2004-12-15  Daniel Pfeiffer  <occitan@esperanto.org>

	* progmodes/executable.el (executable-interpret): Eliminate
	obsolete compile-internal, and switch to comint for interaction.

2004-12-15  J.D. Smith  <jdsmith@as.arizona.edu>

	* progmodes/idlwave.el (idlwave-skip-multi-commands): Don't match
	`&&' when skipping multiple statements on a line.

2004-12-15  Thien-Thi Nguyen  <ttn@gnu.org>

	* play/zone.el (zone): Set `truncate-lines'.
	Also, init `tab-width' with value from original buffer.
	(zone-shift-up): Rewrite for speed.
	(zone-shift-down, zone-shift-left, zone-shift-right): Likewise.
	(zone-pgm-jitter): Remove redundant entries from ops vector.
	(zone-exploding-remove): Reduce iteration count.
	(zone-cpos): Convert to defsubst.
	(zone-replace-char): New defsubst.
	(zone-park/sit-for): Likewise.
	(zone-fret): Take window-start arg.
	Update callers.  Use `zone-park/sit-for'.
	(zone-fill-out-screen): Rewrite.
	(zone-fall-through-ws): Likewise.  Update callers.
	(zone-pgm-drip): Use `zone-replace-char'.
	Move var inits before while-loop.  Use `zone-park/sit-for'.
	(zone-pgm-random-life): Handle empty initial field.
	Use `zone-replace-char' and `zone-park/sit-for'.

2004-12-15  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-update): Test isearch-lazy-highlight
	before calling isearch-lazy-highlight-new-loop.
	(isearch-lazy-highlight-new-loop):
	Don't test isearch-lazy-highlight.

	* replace.el (perform-replace): Add isearch-case-fold-search.
	Use delimited-flag for isearch-regexp.
	Reset isearch-lazy-highlight-last-string to force lazy
	highlighting when called from isearch mode.
	(query-replace-highlight): Revert defcustom type to boolean.
	(query-replace-lazy-highlight): New defcustom.
	(query-replace): New face.
	(perform-replace, replace-highlight, replace-dehighlight):
	Test query-replace-lazy-highlight instead of special value
	`isearch' of query-replace-highlight.
	(replace-dehighlight): Don't call isearch-dehighlight.
	(replace-highlight): Don't call isearch-highlight.
	Use face `query-replace' unconditionally.

2004-12-14  Kim F. Storm  <storm@cua.dk>

	* simple.el (inhibit-mark-movement): Remove defvar.
	(beginning-of-buffer, end-of-buffer): Don't use it.

	* emacs-lisp/lisp.el (beginning-of-defun, end-of-defun):
	Don't use inhibit-mark-movement.

	* emulation/cua-base.el (cua--preserve-mark-commands): Remove.
	(cua--undo-push-mark): Remove.
	(cua--pre-command-handler, cua--post-command-handler):
	Don't fiddle with inhibit-mark-movement.

2004-12-14  Juri Linkov  <juri@jurta.org>

	* buff-menu.el (list-buffers-noselect): Collect internal info
	for every buffer in BUFFER-LIST arg too.
	(Buffer-menu-switch-other-window): Bind pop-up-windows to t.
	(Buffer-menu-switch-other-window, Buffer-menu-2-window):
	Bind same-window-buffer-names and same-window-regexps to nil.

2004-12-13  Juri Linkov  <juri@jurta.org>

	* simple.el (next-error-buffer-p, next-error-find-buffer): Doc fix.

	* mail/supercite.el (sc-cite-frame-alist): Doc fix.
	(sc-cite-region, sc-uncite-region, sc-recite-region):
	Fix previous change to handle not alist as a symbol, but
	a citation frame as a symbol that represents a variable name.

2004-12-13  Richard M. Stallman  <rms@gnu.org>

	* filecache.el (file-cache-add-directory-using-find):
	Only set up file-cache-find-command-posix-flag if we will use it.

	* bindings.el (mode-line-buffer-identification-keymap):
	Don't cancel the mode-line's usual down-mouse-1 binding.

	* cus-edit.el (custom-face-selected): Handle `default' specs.
	(custom-face-edit): Increase extra-offset.
	(custom-display): Handle `default' specs.

	* xml.el (xml-name-re, xml-entity-value-re): Add defvars.

	* emacs-lisp/elint.el (elint-standard-variables)
	(elint-unknown-builtin-args): Move definitions up.

	* net/browse-url.el (browse-url-url-at-point): Add autoload.

	* info.el (info-xref-visited): Use `default' instead of t.
	(Info-try-follow-nearest-node): Don't explicitly load browse-url.

	* faces.el (header-line, mode-line-inactive, tool-bar):
	Use `default' instead of t for setting the defaults.
	(face-spec-choose): Separate `t' from `default'.

	* subr.el (while-no-input): New macro.

2004-12-13  Frederik Fouvry  <fouvry@CoLi.Uni-SB.DE>  (tiny change)

	* filecache.el (file-cache-add-directory-using-find):
	Only test file-cache-find-command-posix-flag on some systems.

2004-12-13  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-svn.el (vc-svn-repository-hostname): Adjust to new format.
	Reported by Ville Skytt,Ad(B <scop@xemacs.org>.
	(vc-svn-annotate-current-time, vc-svn-annotate-time-of-rev)
	(vc-svn-annotate-time, vc-svn-annotate-extract-revision-at-line)
	(vc-svn-annotate-command, vc-svn-annotate-re): Support for svn annotate.

2004-12-12  Juri Linkov  <juri@jurta.org>

	* files.el (find-file-other-window, find-file-other-frame):
	Add the first buffer to the returned value to return the complete
	list of all visited buffers.
	(find-file-read-only, find-file-read-only-other-window)
	(find-file-read-only-other-frame): Use nil for `mustmatch' arg of
	`find-file-read-args'.  Signal an error about non-existent file
	only if file name doesn't contain wildcards.  Toggle read-only in
	all visited buffers.
	(find-alternate-file, find-alternate-file-other-window):
	Add optional arg `wildcards'.  Doc fix.  Set `wildcards' to t when
	called interactively.  Pass arg `wildcards' to other functions.
	(find-file-noselect): Doc fix.

	* ffap.el (ffap-dired-wildcards): Set default to "[*?][^/]*\\'".
	Doc fix.
	(ffap-directory-finder): New variable.
	(ffap-string-at-point-mode-alist): Add * and ? to `file'.
	(ffap-file-at-point): Add /* to immediately rejected names.
	Return absolute file names matching ffap-dired-wildcards.
	(ffap-read-file-or-url): Set default value for `completing-read'
	to `buffer-file-name'.
	(find-file-at-point): When filename matches ffap-dired-wildcards,
	call ffap-file-finder with t arg `wildcards', instead of dired.
	(ffap-other-window, ffap-other-frame): Return visited buffers.
	(ffap-read-only, ffap-read-only-other-window)
	(ffap-read-only-other-frame, ffap-alternate-file): New commands.
	(dired-at-point): Call ffap-directory-finder instead of dired.
	(ffap-dired-other-window, ffap-dired-other-frame)
	(ffap-list-directory): New commands.
	(ffap-bindings): New keybindings for new commands.

2004-12-12  Juri Linkov  <juri@jurta.org>

	* simple.el (beginning-of-buffer, end-of-buffer):
	* emacs-lisp/lisp.el (beginning-of-defun, end-of-defun):
	Do not push mark when mark is active in transient-mark-mode.

	* simple.el (mark-word):
	* emacs-lisp/lisp.el (mark-sexp, mark-defun):
	* textmodes/paragraphs.el (mark-paragraph):
	Extend the region when mark is active in transient-mark-mode,
	regardless of the last command.  Doc fix.

	* simple.el (mark-word): Preserve direction when repeating.
	Make arg optional.  Interactive "p" -> "P".
	(transient-mark-mode, inhibit-mark-movement): Doc fix.

	* emacs-lisp/lisp.el (mark-sexp): Reverse the condition for
	preserving direction, to mark forward instead of backward when mark
	is equal to point (e.g. when C-SPC C-M-SPC is typed in t-m-m).

2004-12-12  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-edit-string): Set 7th arg of
	`read-from-minibuffer' to `t' to inherit the current input
	method (whose name is indicated by [IM] in the minibuffer prompt)
	from the current buffer to the minibuffer.
	(isearch-lazy-highlight-update): Put body to `with-local-quit'
	to allow C-g quitting for lazy highlighting looping inside the
	search with nested repetition operators.  Add overlay to the list
	before setting its face and other properties to avoid the case of
	code quitting after placing the new overlay but before it's
	recorded on the list.  Select the window where isearch was
	activated, to highlight matches in the right window when isearch
	switches the current window to the minibuffer.

	* international/isearch-x.el
	(isearch-process-search-multibyte-characters):
	Use `isearch-message' as initial input for `read-string' instead
	of adding it to the minibuffer prompt.  After reading a string
	remove the initial value of `isearch-message' from the string.

	* replace.el (replace-match-maybe-edit): Doc fix.
	(perform-replace): Don't call `replace-highlight' when automatic
	replacement is requested in literal mode, since it is intended
	only to highlight words during entering a new replacement string
	for \? in non-literal mode.

	* replace.el (query-replace-highlight): Add new value `isearch'
	that allows query replacement to use isearch highlighting.
	Change type from `boolean' to `choice'.  Doc fix.
	(replace-highlight, replace-dehighlight, perform-replace):
	Use isearch highlighting if query-replace-highlight eq `isearch'.

2004-12-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/checkdoc.el (checkdoc-continue, checkdoc-comments)
	(checkdoc-message-text, checkdoc-defun): Fix format messages for `error'.

	* textmodes/tex-mode.el (latex-backward-sexp-1): Handle the special
	case of \end{verbatim}.

2004-12-11  Dan Nicolaescu  <dann@ics.uci.edu>

	* term.el (term-termcap-format): Synchronize with terminfo.
	(term-emulate-terminal): Handle reset.
	(term-reset-terminal): New function.

2004-12-11  Thien-Thi Nguyen  <ttn@gnu.org>

	* play/zone.el (zone-programs): Add `zone-pgm-random-life'.
	(zone-fill-out-screen): New func.
	(zone-pgm-drip): Use `zone-fill-out-screen'.
	Also, no longer go to point-min on every cycle.
	(zone-pgm-paragraph-spaz): Allow spazzing for texinfo-mode.
	(zone-pgm-random-life-wait): New user var.
	(zone-pgm-random-life): New func.

2004-12-10  Thien-Thi Nguyen  <ttn@gnu.org>

	* files.el (auto-mode-alist): Map .com to DCL mode.

2004-12-09  Richard M. Stallman  <rms@gnu.org>

	* isearch.el (isearch-mode-map): Treat S-SPC like SPC.

2004-12-09  Nick Roberts  <nickrob@snap.net.nz>

	* xt-mouse.el (xterm-mouse-event): Correct cursor position in a
	buffer with a display margin.

2004-12-08  Jay Belanger  <belanger@truman.edu>

	* calc/calc-keypd.el (calc-keypad-mode): Unbind unused mouse events.
	(calc-keypad-left-click): Set buffer to calc-keymap-buffer.

2004-12-08  Richard M. Stallman  <rms@gnu.org>

	* faces.el: Delete code to set display table.
	(escape-glyph): Redefine to be less loud.  (Copy minibuffer-prompt.)

2004-12-08  Jay Belanger  <belanger@truman.edu>

	* calc/calc.el: Add math-read-preprocess-string to autoloads.

	* calc/calc-ext.el (math-read-replacement-list)
	(math-read-superscripts, math-read-preprocess-string): Move to
	calc-aent.el.

	* calc/calc-aent.el (math-read-replacement-list)
	(math-read-superscripts, math-read-preprocess-string): Move from
	calc-ext.el.

2004-12-07  Stefan Monnier  <monnier@iro.umontreal.ca>

	* isearch.el (isearch-quote-char): Fix up typo in last change.

2004-12-07  Luc Teirlinck  <teirllm@auburn.edu>

	* mouse.el (mouse-set-font): Handle the case where the command was
	not invoked using the mouse.

	* edmacro.el: `edit-kbd-macro' is now bound to `C-x C-k e'.
	(edmacro-finish-edit): Further update for keyboard macros that are
	lambda forms.
	(edmacro-sanitize-for-string): Correctly remove Meta modifier.

2004-12-07  Stefan Monnier  <monnier@iro.umontreal.ca>

	* font-lock.el (font-lock-unfontify-region): Save buffer state.
	(font-lock-default-unfontify-region): Don't save buffer state any more.

2004-12-07  Jay Belanger  <belanger@truman.edu>

	* calc/calc-help.el (calc-describe-key):
	Set calc-summary-indentation even when Calc Summary buffer exists.

2004-12-07  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* calendar/holidays.el (holiday-easter-etc): Make arguments
	optional for backwards compatibility.  Doc fix.
	Remove un-necessary local vars mandatory, output-list.
	(holiday-advent): Make arguments optional for backwards
	compatibility.  Doc fix.

2004-12-06  Stefan Monnier  <monnier@iro.umontreal.ca>

	* paren.el (show-paren-function): Fix last change (2004-12-02).

	* international/mule-util.el (char-displayable-p): Return nil for
	unibyte mode.

	* subr.el (subregexp-context-p): New function.

	* isearch.el (isearch-quote-char): Use it.

	* emacs-lisp/regexp-opt.el (regexp-opt-depth): Use it.
	(regexp-opt-not-groupie*-re): Remove.
	(regexp-opt): Properly handle inputs with duplicate entries.

2004-12-06  Richard M. Stallman  <rms@gnu.org>

	* info-look.el (info-lookup-maybe-add-help cfengine-mode): Regexp typo.

	* cus-edit.el (custom-file): Doc fix.

	* textmodes/org.el: New file.

2004-12-06  Kenichi Handa  <handa@m17n.org>

	* ldefs-boot.el: Update international/mule-util.el section.

2004-12-05  Sam Steingold  <sds@gnu.org>

	* net/tramp.el (tramp-handle-file-accessible-directory-p):
	Fix `tramp-time-diff' comparison logic.

2004-12-05  Paul Pogonyshev  <pogonyshev@gmx.net>

	* progmodes/which-func.el (which-function):
	Use `run-hook-with-args-until-success' instead of a custom loop.
	Fixes bug with local hooks.

2004-12-05  Roland Winkler  <Roland.Winkler@physik.uni-erlangen.de>

	* textmodes/bibtex.el (bibtex-font-lock-url-regexp):
	Use delete-dups when calculating the initial value.
	(bibtex-autokey-get-title): Use <=.
	(bibtex-goto-line): New function.
	(bibtex-reposition-window): Use line numbers instead of point
	positions.  Use window-body-height.
	(bibtex-find-crossref): Use bibtex-reposition-window.
	(bibtex-find-entry): Use bibtex-reposition-window.  Always return
	position of entry if key is found or nil if not found.

2004-12-05  Richard M. Stallman  <rms@gnu.org>

	* cus-edit.el (custom-file): Doc fix.

	* progmodes/sh-script.el (sh-indent-for-then): Change default.

2004-12-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	* simple.el (blink-matching-open):
	* textmodes/tex-mode.el (tex-validate-region):
	Obey syntax-table text properties.

2004-12-02  Per Abrahamsen  <abraham@dina.kvl.dk>

	* wid-edit.el (widget-specify-field): Add `real-field' property to
	boundary.
	(widget-field-at): Use it.

2004-12-02  Richard M. Stallman  <rms@gnu.org>

	* progmodes/cc-mode.el (awk-mode autoload):
	Supply t meaning interactive function.

	* isearch.el (search-whitespace-regexp): Remove the group.  Doc fix.
	(isearch-mode-map): No special definition for space.
	(isearch-whitespace-chars): Command deleted.
	(isearch-forward-regexp): Doc fix.
	(isearch-quote-char): When a space is not inside brackets,
	use `[ ]' instead of just space.
	(isearch-lazy-highlight-search): Bind search-spaces-regexp.

	* imenu.el (imenu--generic-function): Delete code to exclude
	matches in comments.

	* man.el (Man-reverse-face): Change default to `highlight'.

	* replace.el (occur-1): Specify t for KEEP-PROPS to occur-engine.
	(occur-engine): Use `face' prop rather than `font-lock-face'
	when specifying use of `match-face'.
	(occur-accumulate-lines): Change arg from NO-PROPS to KEEP-PROPS.

	* emacs-lisp/elint.el (elint-standard-variables): Update list.

	* add-log.el (add-log-current-defun): Handle the case where point
	is in the header part of a DEFUN construct.

2004-12-02  Dave Love  <fx@gnu.org>

	* progmodes/python.el (python-font-lock-syntactic-keywords):
	Fix previous change.

2004-12-02  Richard G Bielawski  <Richard.G.Bielawski@wellsfargo.com>  (tiny change)

	* paren.el (show-paren-function): Check for matching chars
	specified by text props.

2004-12-02  Jay Belanger  <belanger@truman.edu>

	* calc/calc.el (calc-read-key-sequence): Leave the old message visible
	when reading a new key sequence.

2004-12-02  Kim F. Storm  <storm@cua.dk>

	* faces.el (escape-glyph): Rename from glyph.
	(standard-display-table): Set it here.  Add escape-glyph face to
	extra slot characters.

	* disp-table.el: Undo 2004-12-01 change.  Display table is now
	setup in faces.el.

2004-12-02  Mark A. Hershberger  <mah@everybody.org>

	* xml.el (xml-parse-dtd): Don't show validity messages when
	xml-validating-parser is nil.
	(xml-substitute-special): Fix validity error messages to
	actually show the unexpandable entity.  Added validity error if &
	isn't followed by an entity.
	(xml-parse-tag): Concatenate any string following the a
	<![CDATA[]]> section to the parsed CDATA.
	(xml-parse-dtd): Skip parameter entity declarations and use of
	parameter entities.

2004-12-01  Luc Teirlinck  <teirllm@auburn.edu>

	* kmacro.el (kmacro-default-counter-format): New var.
	(kmacro-set-format): Use it.  Delete `(printf format)' from prompt.
	(kmacro-display): Remove `nil' from `and' form.  Delete call to
	`format' inside `message'.
	(kmacro-start-macro): Use `kmacro-default-counter-format'.

2004-12-01  Stefan Monnier  <monnier@iro.umontreal.ca>

	* pcvs.el (cvs-header-msg): New function.
	(cvs-update-header): Use it.  Change calling convention.
	Correctly handle the case of having simultaneous active processes.
	(cvs-sentinel): Don't call cvs-update-header any more.
	(cvs-mode-run): Update call and add cvs-update-header to postproc.

2004-12-01  Jay Belanger  <belanger@truman.edu>

	* calc/calc-ext.el (calc-inverse, calc-hyperbolic):
	Change message.

2004-12-01  Juri Linkov  <juri@jurta.org>

	* progmodes/prolog.el (prolog-mode-variables):
	Fix imenu-generic-expression.

2004-12-01  Daniel Pfeiffer  <occitan@esperanto.org>

	* faces.el (glyph): New face.

	* disp-table.el: Add an autoloaded table, that doesn't require
	this library, with glyph face.

	* textmodes/conf-mode.el (conf-ppd-mode-syntax-table): New var.
	(conf-ppd-mode): New conf-mode wrapper for printer descriptions.
	(conf-quote-normal): Allow normalizing only ' or ".
	(conf-mode): Regexp-quote constructed comment-start and don't
	match section {} where "name" contains braces.

	* files.el (auto-mode-alist): Add conf-ppd-mode, inittab and acpid
	files.

2004-12-01  Kenichi Handa  <handa@m17n.org>

	* term/x-win.el (x-last-selected-text-cut-encoded): New variable.
	(x-select-text): Don't treat eight-bit-control/graphic chars
	specially.  Store the encoded text in the X cut buffer.
	(x-cut-buffer-or-selection-value): Compare the X cut buffer text
	with x-last-selected-text-cut-encoded.

2004-11-30  Stefan Monnier  <monnier@iro.umontreal.ca>

	* man.el (Man-fontify-manpage): Improve handling of ANSI escapes.

2004-11-30  Markus Rost  <rost@ias.edu>

	* textmodes/tex-mode.el (tex-main-file): Add a compatibility with
	AUCTeX.

2004-11-30  Jay Belanger  <belanger@truman.edu>

	* calc/calc-arith.el (math-possible-signs): Made stronger checks
	on signs of intervals.
	(math-pow-of-zero): Strengthen checks for positive and negative
	exponents.

	* calc/calc-aent.el, calc/calc-alg.el, calc/calc-arith.el
	* calc/calc-bin.el, calc/calc-comb.el, calc/calc-cplx.el
	* calc/calc-embed.el, calc/calc-fin.el, calc/calc-forms.el
	* calc/calc-frac.el, calc/calc-funcs.el, calc/calc-graph.el
	* calc/calc-help.el, calc/calc-incom.el, calc/calc-keypd.el
	* calc/calc-lang.el, calc/calc-map.el, calc/calc-math.el
	* calc/calc-misc.el, calc/calc-mode.el, calc/calc-mtx.el
	* calc/calc-poly.el, calc/calc-prog.el, calc/calc-rewr.el
	* calc/calc-rules.el, calc/calc-sel.el, calc/calc-stat.el
	* calc/calc-store.el, calc/calc-stuff.el, calc/calc-trail.el
	* calc/calc-undo.el, calc/calc-units.el, calc/calc-vec.el
	* calc/calc-yank.el, calc/calcalg2.el, calc/calcalg3.el
	* calc/calccomp.el, calc/calcsel2.el: Replace dummy autoloaded functions
	with provide statements.

	* calc/calc-alg.el (math-defsimplify): Move from calc-ext.el.

	* calc/calc-embed.el (calc-do-embedded-activate): Remove from autoloads.

	* calc/calc-ext.el: Remove dummy autoloading functions from autoloads.
	(calc-load-everything, math-defsimplify): Replace dummy autoloading
	functions by require statements.
	(math-defsimplify): Move to calc-alg.el, add to autoloads.

	* calc/calc-graph.el (calc-gnuplot-name, calc-gnuplot-plot-command)
	(calc-gnuplot-print): Give them values.

	* calc/calc.el: Remove calc-Need-calc-aent and calc-Need-calc-misc from
	autoloads.
	Add calc-do-embedded-activate to autoloads.
	(calc-gnuplot-name, calc-gnuplot-plot-command)
	(calc-gnuplot-print-command): Move them to calc-graph.el.

2004-11-30  YAMAMOTO Mitsuharu  <mituharu@math.s.chiba-u.ac.jp>

	* term/mac-win.el (ccl-encode-mac-roman-font)
	(ccl-encode-mac-cyrillic-font)
	(ccl-encode-mac-centraleuropean-font, encoder-list)
	(fontset-add-mac-fonts, create-fontset-from-mac-roman-font):
	Support Cyrillic, CentralEuropean, and Dingbat font display

2004-11-30  Andre Spiegel  <spiegel@gnu.org>

	* vc-hooks.el (vc-recompute-state): Move here from vc.el.

	* vc-cvs.el (vc-cvs-state): Handle the case where vc-state is
	still nil.

2004-11-29  Luc Teirlinck  <teirllm@auburn.edu>

	* emulation/tpu-edt.el (tpu-help-keypad-map, tpu-help-text)
	(tpu-word-separator-list, tpu-skip-chars): defconst->defvar.

2004-11-29  Jay Belanger  <belanger@truman.edu>

	* calc/calc-arith.el (math-pow-of-zero): Take into account different
	cases of the base and exponent.

2004-11-26  Teodor Zlatanov  <tzz@lifelogs.com>

	* simple.el (next-error-buffer-p): Allow for inclusive and
	exclusive tests for finding a buffer.
	(next-error-find-buffer): Pass the exclusive and inclusive tests
	to next-error-buffer-p.

	* replace.el (occur-next-error): Switch to the Occur buffer when
	appropriate, use the exclusive filter to next-error-find-buffer to
	do it.  Use the absolute value of the motion amount.

2004-11-29  Kenichi Handa  <handa@m17n.org>

	* startup.el (command-line): Decode all default-directory by
	locale-coding-system.

2004-11-29  Jay Belanger  <belanger@truman.edu>

	* calc/calc-aent.el: Remove unnecessary eval-when-compile.
	(calc-do-quick-calc, calc-do-calc-eval, calc-alg-entry)
	(math-read-expr-level, calc-check-user-syntax, math-read-factor):
	Replace calls to calc-extensions by appropriate require, replace
	calc-extensions-loaded by appropriate featurep.

	* calc/calc-ext.el: Move require to end of file.
	Remove redundant loading of calc.el.
	(calc-extensions-loaded): Remove unnecessary variable.
	(calc-extensions): Remove unnecessary function.
	(calc-load-everything): Replace calc-need-macros by appropriate require.

	* calc/calc-macs.el: Move provide to end of file.
	(calc-need-macros): Remove unnecessary function.

	* calc/calc-misc.el (calc-do-handle-whys, calc-last-args-stub)
	(calc-missing-key, calc-shift-Y-prefix-help, math-concat)
	(math-trunc, math-floor, calcFunc-inv, math-mod, math-pow):
	Replace calc-extensions by appropriate require.
	(calc-power): Replace calc-extensions-loaded by appropriate featurep.

	* calc/calc-prog.el (calc-user-define-formula, calc-do-defmath):
	Replace calc-need-macros by appropriate require.

	* calc/calc.el: Move require to end of file.
	(calc-info-filename, calc-autoload-directory, calc-extensions-loaded):
	Remove unnecessary variable.
	(calc-do-dispatch, calc-mode, calc-check-defines, calc-create-buffer)
	(calc, calc-keypad, full-calc-keypad, calc-do, calc-normalize)
	(calc-binary-op, calc-unary-op, calcDigit-start, calcDigit-key)
	(math-normalize, math-add, math-mul, math-div, math-format-stack-value)
	(math-stack-value-offset, math-format-value, math-format-flat-expr)
	(math-format-number, math-format-bignum, math-read-number)
	(calc-grab-region, calc-grab-rectangle, calc-grab-sum-down)
	(calc-grab-sum-across, calc-embedded, defmath): Replace calc-extensions
	by appropriate require.
	(calc-check-defines): Replace calc-need-macros by appropriate require.

2004-11-29  Kim F. Storm  <storm@cua.dk>

	* macros.el (insert-kbd-macro): Handle kmacro functions.

2004-11-28  Juri Linkov  <juri@jurta.org>

	* compare-w.el (compare-windows-highlight): Attach each overlay
	to its window to properly highlight differences while comparing
	two windows of the same buffer.  Fix arguments.
	(compare-windows-sync-default-function): Fix arguments of
	`compare-windows-highlight'.

	* emacs-lisp/edebug.el (edebug-set-global-break-condition):
	Use `read-expression-history'.  Set initial contents only if
	`edebug-global-break-condition' is non-nil.  Set histpos to 1
	if initial contents is equal to the last history element.
	(edebug-set-conditional-breakpoint): Instead of temporarily
	prepending the current condition to the history, set initial
	contents to the current condition.  Set histpos to 1 if initial
	contents is equal to the last history element.

	* info.el (Info-search-whitespace-regexp): Remove shy group.
	(Info-search): Forward line if search is on the header line.
	Use search-whitespace-regexp in two other places.

2004-11-27  Luc Teirlinck  <teirllm@auburn.edu>

	* fringe.el (fringe-indicators): Add fake defvar to avoid compiler
	warning.  Delay real definition, which uses
	`set-fringe-indicators-1' till after the definition of that function.

2004-11-28  Kim F. Storm  <storm@cua.dk>

	* fringe.el (fringe): New defgroup.
	(fringe-mode): Move to fringe group.
	(fringe-indicators): New defcustom.
	(set-fringe-indicators-1): New defun.

	* menu-bar.el (menu-bar-options-save): Add fringe-indicators.
	(menu-bar-showhide-fringe-ind-menu): New keymap.
	(menu-bar-showhide-fringe-ind-empty)
	(menu-bar-showhide-fringe-ind-mixed)
	(menu-bar-showhide-fringe-ind-box)
	(menu-bar-showhide-fringe-ind-right)
	(menu-bar-showhide-fringe-ind-left)
	(menu-bar-showhide-fringe-ind-none): New defuns.
	(menu-bar-showhide-fringe-menu): Add "Indicators" sub-menu.

2004-11-27  Richard M. Stallman  <rms@gnu.org>

	* comint.el (comint-read-noecho): Add trivial compatibility definition.

	* generic.el (define-generic-mode): Doc fix.

	* menu-bar.el (menu-bar-options-save): For the options
	that are toggled with menu-bar-make-mm-toggle, don't check
	for customized-value prop.

2004-11-27  Eli Zaretskii  <eliz@gnu.org>

	* mail/supercite.el (sc-cite-region): Handle the case where
	sc-cite-frame-alist is a symbol.
	(sc-uncite-region): Handle the case where sc-uncite-frame-alist is
	a symbol.
	(sc-recite-region): Handle the case where sc-recite-frame-alist is
	a symbol.

2004-11-27  Arne J,Ax(Brgensen  <arne@arnested.dk>  (tiny change)

	* wid-edit.el (widget-narrow-to-field): New function.
	(widget-complete): Use it.

2004-11-27  Jay Belanger  <belanger@truman.edu>

	* calc/calc-aent.el (calc-eval-error): Declare and initialize the
	variable.
	(calc-eval-error): Don't check if the variable calc-eval-error is bound.
	(calc-buffer, calc-digit-value, math-expr-data): Declare them.
	(math-alg-inequalities): Move declaration to earlier in the file.

	* calc/calc-ext.el (calc-command-flags, calc-gnuplot-buffer)
	(calc-gnuplot-input, math-normalize-a, math-integral-cache):
	Declare them.

	* calc/calc-lang.el (math-expr-data, math-expr-token)
	(math-exp-old-pos): Declare them.

	* calc/calc-vec.el (math-exp-pos, math-exp-str, math-exp-old-pos)
	(math-exp-token, math-exp-keep-spaces, math-expr-data):	Declare them.

2004-11-27  Kim F. Storm  <storm@cua.dk>

	* progmodes/flymake.el: Use (featurep 'xemacs).
	(flymake-makehash): Change to defsubst.  Use fboundp.
	(flymake-time-to-float): Remove.
	(flymake-float-time): Merge code from flymake-time-to-float here.
	(flymake-replace-regexp-in-string): Change to defsubst.
	(flymake-split-string-remove-empty-edges):
	Rename to flymake-split-string.
	(flymake-split-string): Remove previous defalias.
	(flymake-get-temp-dir): Change to defsubst.
	(flymake-make-xemacs-menu, flymake-xemacs-window-edges):
	Define for xemacs only.
	(flymake-master-file-count-limit): Change into compiler defvar only.
	(flymake-find-possible-master-files): Let-bind it dynamically while
	sorting files using flymake-master-file-compare.

2004-11-26  Stefan Monnier  <monnier@iro.umontreal.ca>

	* font-lock.el (font-lock-compile-keywords): Don't complain if the end
	of defun-prompt-regexp matches inside a comment/string but the
	beginning is correctly outside everything.

	* progmodes/tcl.el (tcl-omit-ws-regexp): Avoid the case where { or [
	appears within a string or a comment.

	* emacs-lisp/cl-macs.el (cl-parse-loop-clause, labels): Use gensym
	rather than make-symbol for symbols which are used in
	a symbol-macrolet or equivalent.

2004-11-26  Jay Belanger  <belanger@truman.edu>

	* calc-misc.el (calc-last-why-command): Declare it.

	* calc-vec.el (math-grade-vec): New variable.
	(calcFunc-grade, calcFunc-rgrade, math-grade-beforep):
	Replace variable grade-vec by declared variable.
	(math-rb-close): New variable.
	(math-read-brackets, math-read-vector): Replace variable close by
	declared variable.

	* calc/calc-yank.el (calc-original-buffer, calc-return-buffer)
	(calc-one-window, calc-edit-handler, calc-restore-trail)
	(calc-allow-ret): Declare them.

	* calc/calc-stuff.el (calc-flush-caches): Remove unnecessary variables.
	(math-lud-cache, math-log2-cache, math-radix-digits-cache)
	(math-radix-float-cache-tag, math-random-cache)
	(math-max-digits-cache, math-integral-cache, math-units-table)
	(math-format-date-cache, math-holidays-cache-tag): Declare them.
	(math-moc-func): New variable.
	(math-map-over-constants, math-map-over-constants-rec):
	Replace variable func by declared variable.

	* calc/calc-store.el (calc-given-value, calc-store-opers):
	Declare them.
	(calc-var-name-map): Move declaration to earlier in the file.
	(calc-pv-pos): New variable.
	(calc-permanent-variable, calc-insert-permanent-variable):
	Replace variable pos by declared variable.

	* calc/calc-mtx.el (calc-det-lu): New variable.
	(math-det-raw, math-det-step): Replace variable lu by declared variable.

	* calc/calc-map.el (math-ms-temp, math-ms-args): New variables.
	(math-multi-subst, math-multi-subst-rec): Replace variables temp
	and arg by declared variables.
	(calcFunc-reducer): Fix incorrect variable.
	(math-inner-mul-func, math-inner-add-func): New variables.
	(calcFunc-inner, math-inner-mats): Replace variables mul-func
	and add-func by declared variables.

	* calc/calc-incom.el (calc-prev-char, calc-prev-prev-char)
	(calc-digit-value): Declare them.

	* calc/calc-help.el (Info-history): Declare it.
	(calc-describe-key): Make calc-summary-indentation a local variable.
	(calc-help-long-names): Move declaration to earlier in file.

	* calc/calc-embed.el (calc-original-buffer): Declare it.
	(calc-embed-outer-top, calc-embed-outer-bot, calc-embed-top)
	(calc-embed-bot): New variables.
	(calc-do-embedded, calc-embedded-mark-formula)
	(calc-embedded-find-bounds, calc-embedded-duplicate)
	(calc-embedded-new-formula, calc-embedded-make-info):
	Replace vars outer-top, outer-bot, bot and top by declared variables.
	(calc-embed-prev-modes): New variable.
	(calc-embedded-set-modes, calc-embedded-update): Replace variable
	prev-modes with declared variable.
	(calc-embed-vars-used): New variable.
	(calc-embedded-make-info, calc-embedded-evaluate-expr)
	(calc-embedded-update, calc-embedded-find-vars): Replace variable
	vars-used by declared variable.

	* calc/calc-bin.el (math-format-radix-float): Make pos a local variable.
	(math-format-radix-float): Remove unnecessary setq.
	(math-radix-float-cache): Declare it.

	* calc/calcsel2.el (calc-keep-selection): Declare it.

	* calc/calc-maint.el: Remove file.

2004-11-26  Roland Winkler  <Roland.Winkler@physik.uni-erlangen.de>

	* textmodes/bibtex.el (bibtex-sort-entry-class)
	(bibtex-comment-start): Use defcustom.
	(bibtex-entry-field-alist): Use nil if initial content of the
	field is undefined.  Fix docstring.
	(bibtex-parse-keys-timeout, bibtex-autokey-additional-names)
	(bibtex-generate-autokey, bibtex-parse-buffers-stealthily)
	(bibtex-mode, bibtex-field-list, bibtex-entry-updat)
	(bibtex-autofill-entry, bibtex-entry-index, bibtex-next-field):
	Fix docstring.
	(bibtex-autokey-title-terminators): Use only one regexp.
	(bibtex-string-maybe-empty-head): New variable.
	(bibtex-remove-delimiters-string): New function.
	(bibtex-text-in-field-bounds, bibtex-text-in-string):
	Use bibtex-remove-delimiters-string.
	(bibtex-progress-message, bibtex-field-left-delimiter)
	(bibtex-field-right-delimiter, bibtex-entry-left-delimiter)
	(bibtex-entry-right-delimiter, bibtex-search-entry): Use eq.
	(bibtex-insert-kill): Rename from `bibtex-insert-current-kill'.
	Simplify.
	(bibtex-format-entry): Use save-excursion for inherited booktitle.
	Use eq and bibtex-remove-delimiters-string.  For end markers use
	insertion type so that marker stays after inserted text.
	(bibtex-autokey-get-names): Return empty string if name is missing.
	(bibtex-autokey-demangle-name): Call bibtex-autokey-abbrev before
	calling bibtex-autokey-name-case-convert.
	(bibtex-autokey-demangle-title):
	Call bibtex-autokey-titleword-case-convert.  Remove call to
	bibtex-autokey-titleword-case-convert from bibtex-autokey-get-title.
	(bibtex-global-key-alist, bibtex-read-string-key): New functions.
	(bibtex-read-key): New optional arg global.
	(bibtex-files-expand): New optional arg force.
	(bibtex-complete-string-cleanup): Expansion of abbrev can be absent.
	(bibtex-complete-crossref-cleanup): Rename from
	bibtex-complete-key-cleanup.  Simplify code.
	(bibtex-copy-summary-as-kill): Remove arg key.  Use looking-at.
	Operate on current entry.
	(bibtex-button): Add docstring.
	(bibtex-entry): Simplify.
	(bibtex-make-field): Replace optional arg called-by-yank with more
	specific args move and interactive.
	(bibtex-end-of-entry): Use forward-sexp.
	(bibtex-find-entry-globally): Remove.
	(bibtex-find-crossref): Allow for crossref key located in other buffer.
	Bound to C-c C-x.
	(bibtex-find-entry): New optional args global and display.
	(bibtex-find-text): Fix docstring.  Remove arg as-if-interactive.
	(bibtex-validate): Use arg force of bibtex-files-expand.
	(bibtex-clean-entry): Bugfix, clean string entries properly.
	Always keep point at beginning of entry.
	(bibtex-complete): Bugfix.  Handle string entries properly.
	Call cleanup functions only if needed.
	(bibtex-String): Use bibtex-read-string-key.
	(bibtex-url): Use bibtex-remove-delimiters-string.  Do not alter
	case of replacement text.

2004-11-26  Lars Hansen  <larsh@math.ku.dk>

	* tramp.el (tramp-handle-directory-files-and-attributes): New function.
	(tramp-perl-directory-files-and-attributes): New constant.
	(tramp-file-name-handler-alist): Delete file-directory-files, add
	directory-files-and-attributes.
	(tramp-perl-file-attributes): Surround uid and gid by double
	quotes.  Change parameter id-format from nonnumeric.
	(tramp-convert-file-attributes): New function.
	(tramp-handle-file-attributes): Use it.
	(tramp-maybe-send-perl-script): New function.
	(tramp-handle-file-attributes-with-perl): Use it.  Don't convert
	file mode.  Change parameter id-format from nonnumeric.
	(tramp-handle-file-attributes-with-ls): Change parameter id-format
	from nonnumeric.
	(tramp-post-connection): Don't send tramp-perl-file-attributes
	script.  Reset connection property "perl-scripts".
	(tramp-handle-insert-directory): Run real handler when ls-lisp is
	in use.

2004-11-26  Lars Hansen  <larsh@math.ku.dk>

	* desktop.el (desktop-read): Replace mapcar with mapc.
	(desktop-create-buffer): Replace mapcar with mapc.
	Remove redundant piece of code.

2004-11-27  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gud.el (gud-display-line): Use display-buffer
	for GDB-UI as for GUD.

	* progmodes/gdb-ui.el (gdb-view-source, gdb-selected-view):
	Delete variables.
	(gdb-ann3): Don't make GUD buffer dedicated.
	(gdb-goto-breakpoint, gdb-display-buffer): Don't always dedicate.
	(gdb-display-source-buffer): Delete function.
	(gdb-view-source-function, gdb-view-assembler): Delete functions.
	(menu): Delete menu bindings for viewing source/assembler.
	(gdb-setup-windows, gdb-restore-windows):
	Don't dedicate GUD.  No assembler now.
	(gdb-reset): No need to undedicate source buffers now.
	(gdb-source-info): No assembler now.

2004-11-26  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-frame-parameters): Match height and
	width to those for special frames.
	(gdb-frame-breakpoints-buffer): Use gdb-frame-parameters.
	Use display-buffer.
	(gdb-frame-stack-buffer, gdb-frame-threads-buffer)
	(gdb-frame-registers-buffer, gdb-frame-locals-buffer)
	(gdb-frame-assembler-buffer): Rework like
	gdb-frame-breakpoints-buffer.

2004-11-25  Richard M. Stallman  <rms@gnu.org>

	* progmodes/flymake.el: Reindent.
	(flymake-split-string):	Turn into defalias.
	(flymake-fix-file-name): Rename from flymake-fix-path-name.
	(flymake-ensure-ends-with-slash): Rename arg to FILENAME.
	(flymake-get-common-file-prefix): Rename from ...path...  Doc fix.
	(flymake-build-relative-filename): Rename from ...path.
	Fix error message.

2004-11-25  Cheng Gao  <chenggao@gmail.com>

	* progmodes/flymake.el: Much whitespace and capitalization change.
	Move `provide' to end.  Require `compile' only when compiling.

2004-11-24  Jay Belanger  <belanger@truman.edu>

	* calc/calc-alg.el: Added comment.
	(math-polynomial-base): Replace variable mpb-top-expr by
	math-poly-base-top-expr.

	* calc/calc-poly.el (math-poly-base-top-expr): New variable.
	(math-polynomial-p1): Replace variable mpb-top-expr by declared
	variable.
	(math-poly-base-total-base): New variable.
	(math-total-polynomial-base, math-polynomial-p1): Replace variable
	mpb-total-base by declared variable.
	(math-factored-vars, math-to-list): Declare it.
	(math-fact-expr): New variable.
	(calcFunc-factors, calcFunc-factor, math-factor-expr)
	(math-factor-expr-try, math-factor-expr-part): Replace variable
	expr by declared variable.
	(math-fet-x): New variable.
	(math-factor-expr-try, math-factor-poly-coefs): Replace variable x
	by declared variable.
	(math-factor-poly-coefs): Make temp a local variable.

	* calc/calc-units.el (calc-convert-units): Make units a local
	variable.
	(calc-num-units, calc-den-units): New variables.
	(calc-explain-units, calc-explain-units-rec): Replace variables
	num-units and den-units by declared variables.
	(math-cu-unit-list): New variable.
	(math-build-units-table, math-compare-unit-names)
	(math-convert-units, math-convert-units-rec): Replace variable
	unit-list by declared variable.
	(math-fbu-base, math-fbu-entry): New variables.
	(math-find-base-units, math-find-base-units-rec): Replace variables
	base and entry by declared variables.
	(math-which-standard): New variable.
	(math-to-standard-units, math-to-standard-rec): Replace variable
	which-standard by declared variable.
	(math-fcu-u): New variable.
	(math-find-compatible-unit, math-find-compatible-unit-rec):
	Replace variable u by declared variable.
	(math-cu-new-units, math-cu-pure): New variables.
	(math-convert-units, math-convert-units-rec): Replace variables
	new-units and pure by declared variables.
	(math-try-cancel-units): New variable.
	(math-simplify-units-quotient): Replace variable try-cancel-units by
	declared variable.

2004-11-24  Richard M. Stallman  <rms@gnu.org>

	* textmodes/ispell.el (ispell-check-version):
	If default-directory is nonexistent, use home dir.

	* progmodes/grep.el (grep-regexp-alist):
	Don't match parens around line numbers.

	* progmodes/cperl-mode.el (cperl-indent-region)
	(cperl-imenu--create-perl-index, cperl-xsub-scan):
	Don't print progress messages.

	* progmodes/compile.el (compilation-mode-map):
	Don't inherit from compilation-minor-mode-map;
	copy its bindings instead.  But the menu bar Compile
	entry now does inherit from compilation-menu-map.

	* emacs-lisp/byte-opt.el (byte-optimize-form-code-walker):
	Use with-no-warnings around compiler-macroexpand.

	* imenu.el: Don't always require newcomment.
	(imenu--generic-function): Call comment-normalize-vars
	if we have a comment syntax.
	Exit the loop if REGEXP matches the null string.
	Test comment-start as well as comment-start-skip
	when deciding whether to check for comments.

	* tooltip.el (tooltip-mode): Doc fix.

	* term.el (term-escape-char, term-mode): Doc fixes.

2004-11-24  Dave Love  <fx@gnu.org>

	* progmodes/python.el (python-font-lock-syntactic-keywords):
	Check for escapes in the regexp.
	(python-quote-syntax): Don't do it here.

2004-11-24  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-breakpoints-mode-map)
	(gdb-frames-mode-map, gdb-threads-mode-map)
	(gdb-registers-mode-map, gdb-locals-mode-map)
	(gdb-assembler-mode-map): Bind "q" to kill-this-buffer.
	(gdb-set-window-buffer): Rename from dedicated-switch-to-buffer.

	Suggested by Stefan Monnier <monnier@iro.umontreal.ca>:
	(dedicated-switch-to-buffer): Rework.
	(gdb-var-evaluate-expression-handler, gdb-put-string):
	Remove unused variable bindings.
	(gdb-setup-windows, gdb-display-buffer):
	Simplify.  Use pop-to-buffer.
	(gdb-view-source-function): Simplify.
	(gdb-frame-breakpoints-buffer):
	Use pop-to-buffer, special-display-regexps.

2004-11-24  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* progmodes/f90.el (f90-smart-end)
	(f90-previous-statement, f90-beginning-of-block): Doc fix.
	(f90-calculate-indent): Handle un-named PROGRAM blocks.
	(f90-end-of-block): Doc fix.  Make check of outermost block
	conditional on value of `f90-smart-end'.
	(f90-block-match): Hack to deal with un-named PROGRAM blocks.
	Handle case where END-BLOCK is nil.
	(f90-match-end): Handle un-named PROGRAM blocks.
	(f90-backslash-not-special): New function.

2004-11-24  Jay Belanger  <belanger@truman.edu>

	* calc/calc.el (calc-embedded-active): Removed unnecessary
	declaration.
	(calc-show-banner): Removed redundant declaration.

	* calc/calc-graph.el (calc-gnuplot-default-device)
	(calc-gnuplot-default-output, calc-gnuplot-print-device)
	(calc-gnuplot-print-output, calc-gnuplot-geometry)
	(calc-graph-default-resolution, calc-graph-default-resolution-3d):
	Remove redundant initial values.

	* calc/calc-arith.el (math-scalar-functions)
	(math-nonscalar-functions, math-scalar-if-args-functions)
	(math-real-functions, math-positive-functions)
	(math-nonnegative-functions, math-real-scalar-functions)
	(math-real-if-arg-functions, math-integer-functions)
	(math-num-integer-functions, math-rounding-functions)
	(math-float-rounding-functions, math-integer-if-args-functions)
	(math-super-types): Move declarations to earlier in file.
	(math-unit-prefixes): Declared it.
	(math-floor-prec, math-trunc-prec): New variables.
	(math-trunc-fancy): Replace variable prec by declared variable.
	(math-floor-fancy): Replace variable prec by declared variable.
	(math-com-bterms): New variable.
	(math-commutative-equal, math-commutative-collect):
	Replace variable bterms by declared variable.

	* calc/calc-misc.el (math-trunc): Replace variable prec by
	math-trunc-prec.
	(math-floor): Replace variable prec by math-floor-prec.

	* calc/calc-forms.el (math-fd-date, math-fd-dt, math-fd-year)
	(math-fd-month, math-fd-day, math-fd-weekday, math-fd-hour)
	(math-fd-minute, math-fd-second, math-fd-bc-flag): New variables.
	(math-format-date, math-format-date-part): Replace variables
	date, dt, year, month, day, weekday, hour, minute, second and
	bc-flag by declared variables.
	(math-pd-str): New variable.
	(math-parse-date, math-parse-date-word, math-parse-standard-date):
	Replace variable str by declared variable.
	(math-daylight-savings-hook, math-tzone-names): Move definitions
	to earlier in the file.
	(var-TimeZone, math-exp-str, math-exp-pos): Declare them.
	(math-sh-year): New variable.
	(math-setup-add-holidays, math-setup-holidays)
	(math-setup-year-holidays): Replace variable `year' by declared
	variable.

	* calc/calc-math.el (math-nrf-n, math-nrf-nf, math-nrf-nfm1):
	New variables.
	(math-nth-root-float, math-nth-root-float-iter): Replace variables
	n, nf and nfm1 by declared variables.
	(math-nri-n): New variable.
	(math-nth-root-integer, math-nth-root-int-iter): Replace variable
	n by declared variable.
	(calcFunc-log): Removed misplaced condition.

2004-11-24  Stefan Monnier  <monnier@iro.umontreal.ca>

	* generic.el (generic-mode-set-comments): Accept an empty comment-end.

2004-11-24  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (dedicated-switch-to-buffer): New function.
	(gdb-ann3, gdb-setup-windows, gdb-restore-windows):
	Dedicate gdb-related windows.
	(gdb-display-buffer): Dedicate gdb-related windows.
	Don't grab other frames.
	(gdb-reset): Remove dedicated property after debugging.

2004-11-24  Jay Belanger  <belanger@truman.edu>

	* calc/calc-sel.el: Add comment.

	* calc/calc.el (math-stack-value-offset): Replace variables c,
	wid and off with math-svo-c, math-svo-wid and math-svo-off.

	* calc/calccomp.el (math-comp-sel-tag): Declare it.
	(math-svo-c, math-svo-wid, math-svo-off): New variables.
	(math-stack-value-offset-fancy): Replace variables c, wid and off
	by declared variables.
	(math-comp-just, math-comp-comma-spc): New variables.
	(math-compose-expr, math-compose-matrix): Replace variables `just'
	and comma-spc by declared variable.
	(math-comp-vector-prec): New variable.
	(math-compose-expr, math-compose-matrix, math-compose-rows):
	Replace variable vector-prec by declared variable.
	(math-comp-left-bracket, math-comp-right-bracket)
	(math-comp-comma): New variables.
	(math-compose-expr, math-compose-rows): Replace variables
	left-bracket, right-bracket and comma by declared variables.
	(math-comp-full-width): New variable.
	(math-comp-to-string-flat, math-comp-to-string-flat-term):
	Replace variable full-width by declared variable.
	(math-comp-highlight, math-comp-word, math-comp-level)
	(math-comp-margin, math-comp-pos, math-comp-buf, math-comp-base)
	(math-comp-hgt, math-comp-tag, math-comp-hpos, math-comp-vpos):
	New variables.
	(math-comp-to-string-flat, math-comp-to-string-flat-term)
	(math-comp-sel-flat-term): Replace variables comp-highlight,
	comp-word, comp-level, comp-margin, comp-pos and comp-buf by
	declared variables.
	(math-comp-simplify, math-comp-simplify-term)
	(math-comp-add-string, math-comp-add-string-sel):
	Replace	variables comp-highlight, comp-buf, comp-base,
	comp-height, comp-tag, comp-hpos and comp-vpos by declared variables.

2004-11-23  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* cus-start.el (all): Add x-use-old-gtk-file-dialog.

	* mail/emacsbug.el (report-emacs-bug): Catch error that x-server-vendor
	and x-server-version may throw.

2004-11-23  Kim F. Storm  <storm@cua.dk>

	* subr.el (substitute-key-definition-key): Optimize.
	Don't call indirect-function for nil defn (always signals error).

	* ido.el (ido-read-internal): Fix require-match check when
	ido-directory-too-big is set.

2004-11-23  Jay Belanger  <belanger@truman.edu>

	* calc/calc-ext.el (math-read-replacement-list)
	(math-read-superscripts): New variables.
	(math-read-preprocess-string): New function.
	(math-read-expr): Filter input through math-read-preprocess-string.

	* calc/calc-aent.el (math-read-exprs): Filter input through
	math-read-preprocess-string.

2004-11-23  Daniel Pfeiffer  <occitan@esperanto.org>

	* progmodes/compile.el (compilation-start): In cd command use
	substitute-env-vars -- not quite shell compatible but better than
	nothing.
	(compilation-error-regexp-alist-alist): Simplify ftnchek to only
	handle the newer versions messages, which are more parseable.

2004-11-22  Stefan Monnier  <monnier@iro.umontreal.ca>

	* reveal.el (reveal-mode-map): New var.
	(reveal-mode): Use it.

2004-11-23  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-flush-pending-output): New variable.
	(gdb-send-item, gdb-resync, gud-gdba-marker-filter): Use it.

2004-11-22  Stefan Monnier  <monnier@iro.umontreal.ca>

	* buff-menu.el (list-buffers-noselect): Re-add the leading space in the
	header-line when needed.
	Use fixed-pitch only in the header-line.
	Build the underline automatically.  Use emdash if available.

2004-11-22  Richard M. Stallman  <rms@gnu.org>

	* dired.el (dired-recursive-copies): Move from dired-aux.el.
	* dired-aux.el (dired-recursive-copies): Move to dired.el.

2004-11-22  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-resync): New function.
	(gdb-pre-prompt, gdb-prompt, gdb-starting, gdb-stopping)
	(gdb-frame-begin, gdb-stopped, gdb-post-prompt):
	Use it to fail more gracefully.
	(gdb-variables): Delete variable.
	Re-order variables to reduce byte-compiler warnings.

2004-11-22  Stefan Monnier  <monnier@iro.umontreal.ca>

	* descr-text.el (describe-char):
	* paren.el (show-paren-function):
	* subr.el (syntax-after): Undo last change.

	* progmodes/python.el (run-python): Don't hard code *Python*.
	Don't modify global process-environment.
	(python-send-region, python-load-file): Don't assume that
	python-buffer == (process-buffer (python-proc)).
	(python-switch-to-python): Simplify.

	* dired.el (dired-align-file): Don't assume line starts with spaces.

2004-11-21  Jay Belanger  <belanger@truman.edu>

	* calc/calc-ext.el (math-read-big-expr, math-read-big-bigp):
	Replace variable `lines' by math-read-big-lines.
	(math-read-big-expr): Replace variables the-baseline, the-h2
	and err-msg by math-read-big-baseline, math-read-big-h2 and
	math-read-err-msg.
	(math-read-big-bigp): Replace variable h2 with math-rb-h2.

	* calc/calc-lang.el (math-read-big-rec): Fix typo.
	(math-read-big-balance): Replace unbound variable by value.
	(math-read-big-lines): New variable.
	(math-read-big-rec, math-read-big-char, math-read-big-emptyp)
	(math-read-big-error, math-read-big-balance): Replace variable
	`lines' by declared variable.
	(math-read-big-baseline, math-read-big-h2): New variables.
	(math-read-big-rec): Replace variables the-baseline and the-h2
	by declared variables.
	(math-rb-h1, math-rb-h2, math-rb-v1, math-rb-v2): New variables.
	(math-read-big-rec, math-read-big-char, math-read-big-emptyp)
	(math-read-big-balance): Replace variables h1, h2, v1 and v2 by
	declared variables.
	(math-read-big-err-msg): New variable.
	(math-read-big-error): Replace variable err-msg by declared variable.

2004-11-21  Stefan Monnier  <monnier@iro.umontreal.ca>

	* ses.el: Add coding cookie.
	Fix up docstrings, follow new commenting conventions.
	(ses-header-line-menu): Fix missing variable rename for header-row.
	(ses-cell-size): Remove.
	(ses-make-cell): New function.
	(ses-cell, ses-insert-row, ses-insert-column): Use it.
	(ses-calculate-cell): Remove unused var `symbol'.
	(ses-narrowed-p): New function.
	(ses-goto-data, undo-more, ses-reconstruct-all): Use it.
	(ses-initial-file-trailer): Change ;;; to ;; for local vars.
	(ses-load, ses-reconstruct-all): Adjust string search accordingly.
	(ses-setup): Use restore-buffer-modified-p.
	(ses-cleanup): Remove unused var `end'.
	(ses-header-string-left-offset): Remove.
	(ses-create-header-string): Adjust to new behavior of `align-to'.
	Truncate excessively large fields to preserve alignment.
	(ses-reconstruct-all): Remove unused var `refs'.
	(ses-read-cell-printer): Remove unused var `prompt'.
	(ses-delete-row): Remove unused var `pos'.
	(ses-delete-column): Remove unused var `new'.

2004-11-21  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-print.el: Insert :version tag into all defgroup and defcustom.
	Use (featurep 'xemacs) instead of (eq ps-print-emacs-type 'xemacs).
	Eliminate eval-and-compile usage.
	(ps-insert-file): Use insert-file-contents instead of insert-file.
	(ps-setup): Code fix.

	* printing.el (pr-setup, lpr-setup): Code fix.

2004-11-21  Jay Belanger  <belanger@truman.edu>

	* calc/calc-prog.el (math-integral-cache-state, calc-lang)
	(calc-original-buffer): Declare them.
	(calc-user-formula-alist): New variable.
	(calc-user-define-formula, calc-fix-user-formula)
	(calc-user-define-composition, calc-finish-formula-edit):
	Replace variable `alist' by declared variable.
	(var-q0, var-q1, var-q2, var-q3, var-q4, var-q5, var-q6)
	(var-q7, var-q7, var-q8, var-q9): Declare them.
	(calc-kbd-push): Don't check to see if var-q0 through var-q9
	are bound.
	(calcFunc-typeof): Replace undeclared variable by expression.
	(math-exp-env): New variable.
	(math-define-body, math-define-exp): Replace exp-env by declared var.
	(math-define-exp): Replace misplaced variable by expression.

	* calc/calcalg3.el (calc-curve-nvars, calc-curve-varnames)
	(calc-curve-model, calc-curve-coefnames): New variables.
	(calc-curve-fit, calc-get-fit-variables): Replace variables nvars,
	varnames, model and coefnames by declared variables.
	(math-root-widen): New variable.
	(math-search-root, math-find-root): Replace variable root-widen by
	declared variable.
	(var-DUMMY): Declare it.
	(math-root-vars, math-min-vars): Move the declarations to earlier in
	the file.
	(math-brent-min): Make d a local variable.
	(math-find-minimum): Replace non-existent variable.
	(math-ninteg-romberg): Remove unnecessary variable.
	(math-ninteg-temp): New variable.
	(math-ninteg-romberg, math-ninteg-midpoint): Replace variable
	integ-temp by declared variable.
	(math-fit-first-var, math-fit-first-coef, math-fit-new-coefs):
	New variables.
	(math-general-fit): Replace variables first-var, first-coef and
	new-coefs by declared variables.
	(calcFunc-fitvar): Replace variable first-var by declared variable.
	(calcFunc-fitparam): Replace variable first-coef by declared variable.
	(calcFunc-fitdummy): Replace variable new-coefs by declared variable.
	(math-all-vars-vars, math-all-vars-found): New variables.
	(math-all-vars-in, math-all-vars-rec): Replace variables vars and
	found by declared variable math-all-vars-vars.

2004-11-20  Luc Teirlinck  <teirllm@auburn.edu>

	* emacs-lisp/cust-print.el (custom-printers): Use `defvar' instead
	of `defconst'.

2004-11-20  Richard M. Stallman  <rms@gnu.org>

	* isearch.el (isearch-mode-map): Don't bind SPC.
	(isearch-whitespace-chars): Function deleted.
	(isearch-search): Bind search-spaces-regexp.
	(isearch-lazy-highlight-search): Likewise.
	(search-whitespace-regexp): Doc fix.
	(isearch-forward-regexp): Doc fix.

	* emacs-lisp/bytecomp.el (byte-compile-form):
	Move the calls to byte-compile-set-symbol-position,
	to avoid having two for the same symbol occurrence.

	* comint.el (comint-input-ring-size): Increase to 150.

	* hexl.el (hexl-mode-old-hl-line-mode, hexl-mode-old-ruler-mode):
	New variables.
	(hexl-mode): Set those variables, record ruler-mode and hl-line-mode.
	(hexl-mode-exit): Restore status of ruler-mode and hl-line-mode.

	* imenu.el (imenu--generic-function):
	Ensure we keep moving backward even if BEG isn't further back.

	* replace.el (query-replace-read-to, query-replace-read-from):
	Specify t for KEEP-ALL in read-from-minibuffer.

	* progmodes/python.el (python-switch-to-python):
	If Python isn't running, start it.
	Don't alter debug-ignored-errors.

	* progmodes/cperl-mode.el (cperl-indent-region):
	Don't mind imenu-scanning-message.

	* bindings.el (global-map): Bind C-e to move-end-of-line.

	* simple.el (line-move-finish): New arg FORWARD.
	Ignore invisible newlines, not intangible ones.
	Conditions for acceptable stopping positions depend on FORWARD.
	(line-move): Pass FORWARD arg to line-move-finish.

	* buff-menu.el (list-buffers-noselect): Eliminate space at the start
	of HEADER.  Compensate for this change in the code to add display
	properties.  Don't make the first line intangible.

	* info.el (Info-search): Fix previous change.

2004-11-20  Thien-Thi Nguyen  <ttn@gnu.org>

	* Makefile.in (recompile): Revert 2004-11-19 change.
	(compile): Likewise.

2004-11-19  Luc Teirlinck  <teirllm@auburn.edu>

	* Makefile.in (compile): Set `max-specpdl-size' before compiling.

2004-11-19  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* progmodes/ebnf2ps.el: Fix typos.  Insert :version tag into all
	defgroup and defcustom.  Eliminate eval-and-compile usage.

	* progmodes/ebnf-otz.el: Fix typos.

2004-11-19  Jay Belanger  <belanger@truman.edu>

	* calc/calc-yank.el (calc-edit-disp-trail): New variable.
	(calc-edit-finish, calc-finish-stack-edit): Replace variable
	disp-trail by declared variable.

	* calc/calc-sel.el (calc-edit-disp-trail): Declare it.
	(calc-finish-selection-edit): Replace variable disp-trail by
	declared variable.
	(calc-selection-cache-entry): Move declaration to earlier in the file.
	(calc-selection-cache-num, calc-selection-cache-comp)
	(calc-selection-cache-offset, calc-selection-true-num)
	(calc-final-point-line, calc-final-point-column)
	(calc-original-buffer): Declare them.
	(calc-fnp-op, calc-fnp-num): New variables.
	(calc-find-nth-part, calc-find-nth-part-rec)
	(calc-select-previous): Replace op and num by declared variables.
	(calc-rsf-old, calc-rsf-new): New variables.
	(calc-replace-sub-formula, calc-replace-sub-formula-rec):
	Replace variables old and new by declared variables.
	(calc-sel-reselect): New variable.
	(calc-auto-selection, calc-enter-selection, calc-edit-selection)
	(calc-sel-evaluate, calc-sel-expand-formula, calc-sel-expand-formula)
	(calc-sel-mult-both-sides, calc-sel-add-both-sides): Replace variable
	reselect with declared variable.

	* calc/calc-rewr.el (math-regs, math-num-regs, math-prog-last)
	(math-bound-vars, math-conds, math-copy-neg, math-rhs)
	(math-pattern, math-remembering, math-aliased-vars, math-mt-many)
	(math-import-list, math-rewrite-phase): Declare them.
	(math-rewrite): Use let* to declare variables.
	(calc-rewrite-selection): Make rules a local variable.
	(calc-rewr-sel): New variable.
	(calc-rewrite-selection, calc-locate-selection-marker)
	(calc-rewrite): Use the declared variable calc-rewr-sel instead
	of sel.
	(math-rewrite-whole-expr): New variable.
	(math-rewrite, math-rewrite-phase): Replace variable expr by
	declared variable.
	(math-rewrite-heads-heads, math-rewrite-heads-skips)
	(math-rewrite-heads-blanks ): New variables.
	(math-rewrite-heads, math-rewrite-heads-rec): Replace variables
	heads, skips and blanks by declared variables.
	(math-rwcomp-subst-old, math-rwcomp-subst-new)
	(math-rwcomp-subst-old-func, math-rwcomp-subst-new-func):
	New variables.
	(math-rwcomp-substitute, math-rwcomp-subst-rec): Replace variables
	old, new, old-func and new-func by declared variables.
	(math-rwcomp-assoc-args, math-rwcomp-addsub-args):
	Remove unnecessary variable.
	(math-apply-rw-regs): New variable.
	(math-apply-rewrites, math-rwapply-replace-regs)
	(math-rwapply-reg-looks-negp): Replace variable regs by declared var.
	(math-apply-rw-ruleset): New variable.
	(math-apply-rewrites, math-rwapply-remember): Replace variable
	ruleset by declared variable.

2004-11-19  Richard M. Stallman  <rms@gnu.org>

	* info.el (Info-search): Use search-whitespace-regexp.

2004-11-19  Thien-Thi Nguyen  <ttn@gnu.org>

	* vc-rcs.el (vc-rcs-parse): New function.
	(vc-rcs-annotate-command): Likewise.
	(vc-rcs-annotate-current-time): Likewise.
	(vc-rcs-annotate-time): Likewise.
	(vc-rcs-annotate-extract-revision-at-line): Likewise.

2004-11-19  Thien-Thi Nguyen  <ttn@gnu.org>

	* Makefile.in (recompile): Set `max-specpdl-size' before compiling.

2004-11-18  Jay Belanger  <belanger@truman.edu>

	* calc/calc-alg.el (math-simplify-divisor): Remove unnecessary vars.

2004-11-17  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* printing.el: Eliminate use of interactive-p and eval-and-compile.
	Use of (featurep 'xemacs) instead of (eq ps-print-emacs-type 'xemacs).
	Use make-temp-file to generate PostScript files in any situation.
	(pr-ps-temp-file): Now specify a prefix to generate temporary files.
	(pr-interactive-p): Eliminate var.
	(pr-save-interactive): Eliminate macro.
	(pr-interface, pr-ps-directory-preview)
	(pr-ps-directory-using-ghostscript, pr-ps-directory-print)
	(pr-ps-directory-ps-print, pr-ps-buffer-preview)
	(pr-ps-buffer-using-ghostscript, pr-ps-buffer-print)
	(pr-ps-buffer-ps-print, pr-ps-region-preview)
	(pr-ps-region-using-ghostscript, pr-ps-region-print)
	(pr-ps-region-ps-print, pr-ps-mode-preview)
	(pr-ps-mode-using-ghostscript, pr-ps-mode-print, pr-ps-mode-ps-print)
	(pr-printify-directory, pr-txt-directory, pr-despool-preview)
	(pr-despool-using-ghostscript, pr-despool-print, pr-despool-ps-print)
	(pr-ps-file-up-preview, pr-ps-file-using-ghostscript)
	(pr-ps-file-up-ps-print, pr-toggle-file-duplex, pr-toggle-file-tumble)
	(pr-toggle-file-landscape, pr-toggle-ghostscript, pr-toggle-faces)
	(pr-toggle-spool, pr-toggle-duplex, pr-toggle-tumble)
	(pr-toggle-landscape, pr-toggle-upside-down, pr-toggle-line)
	(pr-toggle-zebra, pr-toggle-header, pr-toggle-header-frame)
	(pr-toggle-lock, pr-toggle-region, pr-toggle-mode, pr-ps-name)
	(pr-txt-name, pr-ps-utility, pr-ps-fast-fire, pr-txt-fast-fire)
	(pr-update-menus, pr-interface-ps-prin, pr-interface-preview):
	Eliminate pr-save-interactive usage.
	(pr-menu-lock, pr-ps-utility-args, pr-set-outfilename):
	Eliminate pr-interactive-p usage.
	(pr-toggle-file-duplex-menu, pr-toggle-file-tumble-menu)
	(pr-toggle-file-landscape-menu, pr-toggle-ghostscript-menu)
	(pr-toggle-faces-menu, pr-toggle-spool-menu, pr-toggle-duplex-menu)
	(pr-toggle-tumble-menu, pr-toggle-landscape-menu)
	(pr-toggle-upside-down-menu, pr-toggle-line-menu, pr-toggle-zebra-menu)
	(pr-toggle-header-menu, pr-toggle-header-frame-menu)
	(pr-toggle-lock-menu, pr-toggle-region-menu, pr-toggle-mode-menu):
	New funs.
	(pr-ps-file): Use make-temp-file to generate a temporary file.

2004-11-17  Jay Belanger  <belanger@truman.edu>

	* calc/calc-alg.el (calc-poly-div): Make calc-poly-div-remainder
	a local variable.
	(math-eval-rules-cache, math-eval-rules-cache-other): Declare them.
	(math-top-only): New variable.
	(math-simplify, math-simplify-step): Replace variable top-only by
	declared variable math-top-only.
	(math-simplify-expr): Declare it.
	Replace argument expr in all calls of math-defsimplify by
	math-simplify-expr.
	(math-simplify-plus, math-simplify-times, math-simplify-divide)
	(math-simplify-divisor, math-simplify-one-divisor)
	(math-simplify-mod, math-simplify-ineq, math-simplify-sqrt)
	(math-simplify-pow): Replace variable expr by declared variable
	math-simplify-expr.
	(math-simplify-divisor): Remove local variables temp and op.
	(math-simplify-one-divisor): Make temp and op local variables.
	(math-simplify-divisor-nover, math-simplify-divisor-dover):
	New variables.
	(math-simplify-divisor, math-simplify-one-divisor):
	Replace variables nover and dover by declared variables.
	(math-expr-subst-new, math-expr-subst-old): New variables.
	(math-expr-subst, math-expr-subst-rec): Replace variables new
	and old by declared variables.
	(math-is-poly-degree, math-is-poly-loose): New variables.
	(math-is-polynomial, math-is-poly-rec): Replace variables degree
	and loose by declared variables.
	(math-poly-base-const-ok, math-poly-base-pred): New variables.
	(math-polynomial-base, math-polynomial-base-rec):
	Replace variables const-ok and mpb-pred by declared variables.

	* calc/calc-poly.el (calc-poly-div-remainder): Declare it.

	* calc/calc-ext.el (math-defsimplify): Change the argument in
	the created function to math-simplify-expr.

	* calc/calc-units.el (math-simplify-expr): Declare it.
	Replace argument expr in all calls of math-defsimplify by
	math-simplify-expr.
	(math-simplify-units-prod): Replace variable expr by declared
	variable math-simplify-expr.

2004-11-17  Stefan Monnier  <monnier@iro.umontreal.ca>

	* buff-menu.el (list-buffers-noselect): Massage to fit in 80 columns.
	Replace mapcar->dolist, format->string.

2004-11-17  Miles Bader  <miles@gnu.org>

	* progmodes/idlw-shell.el, progmodes/idlw-toolbar.el
	* progmodes/idlwave.el: Remove RCS keywords.

2004-11-17  J.D. Smith  <jdsmith@as.arizona.edu>

	* progmodes/idlwave.el, progmodes/idlw-toolbar.el
	* progmodes/idlw-shell.el, progmodes/idlw-rinfo.el:
	Update to IDLWAVE version 5.5.  Too many changes to list them here.
	* progmodes/idlw-help.el: New file.

2004-11-16  Richard M. Stallman  <rms@gnu.org>

	* international/iso-cvt.el (iso-tex2iso-trans-tab):
	Discard spaces after \i according to TeX rules.

	* international/mule.el (set-buffer-file-coding-system):
	New arg NOMODIFY.
	(after-insert-file-set-coding): Pass that new arg.
	Prevent set-buffer-multibyte from trying to lock the file.

	* buff-menu.el (list-buffers-noselect): New arg BUFFER-LIST.

	* saveplace.el (save-place): Doc fix.

	* dabbrev.el (dabbrev-expand): When handling SPC M-/,
	temporarily widen before finding the following word to copy.

	* emacs-lisp/lucid.el (map-keymap): Definition deleted.
	(cl-map-keymap): Definition deleted.

	* subr.el (map-keymap-internal): New function.

2004-11-16  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/flyspell.el (flyspell-mouse-map): Pop the menu
	when pressing rather than when releasing mouse-2.  Simplify.

2004-11-15  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/compile.el (compilation-setup): Don't set buffer-read-only.
	(compilation-mode): Set it here instead.

	* emacs-lisp/cl-compat.el (pair-with-newsyms): Use make-symbol.

	* emacs-lisp/cl-macs.el: Use make-symbol rather than gensym.
	(loop, cl-parse-loop-clause, defsetf): Use backquote.

2004-11-14  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/compile.el (compilation-internal-error-properties):
	Fix up a transposition-typo.  Check end-col before using it.

2004-11-14  Frederic Han  <han@math.jussieu.fr>  (tiny change)

	* international/iso-cvt.el (iso-tex2iso-trans-tab):
	Discard whitespace after macro \i when converting it.

2004-11-16  Juri Linkov  <juri@jurta.org>

	* emacs-lisp/find-func.el (find-function-regexp):
	Optimize `define-minor-mode'.  Add `defun-cvs-mode'.
	Add `deffoo'.  Add `f' to [^cgv] to exclude `defface'.
	Remove invalid `\W' from [^cgv\W].  Doc fix.
	(find-function-search-for-symbol): Replace "\\>" with "\\_>".

2004-11-15  Luc Teirlinck  <teirllm@auburn.edu>

	* play/life.el: Maintainer is now FSF.
	(life-patterns, life-neighbor-deltas, life-window-start)
	(life-current-generation, life-generation-string): Use defvar
	instead of defconst.

2004-11-15  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/compile.el (compilation-move-to-column): New fun.
	(compilation-internal-error-properties)
	(compilation-next-error-function): Use it to make sure we don't go past
	the end of line.

2004-11-15  John Paul Wallington  <jpw@gnu.org>

	* autoinsert.el (auto-insert-alist): Insert the user's name in
	copyright notice, rather than Free Software Foundation, for the
	Emacs Lisp header case too.

2004-11-15  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* printing.el (pr-ps-file-print, pr-toggle-duplex): Fix typos.
	Reported by Glenn Morris <gmorris+emacs@ast.cam.ac.uk>.
	(pr-switches-string): If SWITCHES is nil, return nil.  Otherwise,
	return the list of string in a string.
	(pr-call-process): Message if calling process returns an error, that
	is, the exit status is different of zero.

2004-11-15  Jay Belanger  <belanger@truman.edu>

	* calc/calcalg2.el (math-integrate-by-parts): Remove unused
	variable var-thing.
	(math-integ-depth, math-integ-level, math-integral-limit)
	(math-enable-subst, math-any-substs, math-integ-msg)
	(math-prev-parts-v, math-good-parts, math-max-integral-limit)
	(math-int-threshold, math-int-factors, math-double-roots)
	(math-solve-simplifying, var-IntegLimit, math-solve-sign)
	(var-GenCount): Declare these variables.
	(calcFunc-integ): Don't check if var-IntegLimit is bound.
	(math-integral-cache, math-integral-cache-state):
	Move declarations to earlier in the file.
	(math-deriv-var, math-deriv-total, math-deriv-symb)
	(math-cur-record, math-has-rules, math-t1, math-t2, math-t3)
	(math-so-far, math-integ-expr, math-expr-parts, calc-low)
	(calc-high, math-solve-var, math-solve-full, math-solve-vars)
	(math-try-solve-sign, math-solve-b, math-solve-system-vv)
	(math-solve-res): New variables
	(math-derivative, calcFunc-deriv, calcFunc-tderiv)
	(math-integral, math-replace-integral-parts)
	(math-integrate-by-parts, calc-dump-integral-cache)
	(math-try-integral, math-do-integral, math-do-integral)
	(math-do-integral-methods, math-try-solve-for)
	(math-try-solve-prod, math-solve-poly-funny-powers)
	(math-solve-crunch-poly, math-decompose-poly)
	(math-solve-find-root-term, math-find-root-in-prod)
	(math-integ-try-linear-substitutions)
	(math-integ-try-substitutions, math-expr-rational-in)
	(math-expr-rational-in-rec, calcFunc-table, math-scan-for-limits)
	(math-solve-prod, math-solve-quartic, math-poly-all-roots)
	(math-solve-for, math-solve-system, math-solve-system-rec)
	(math-solve-get-sign, math-solve-get-int)
	(math-solve-system-subst): Replace undeclared variables with newly
	declared variables.

2004-11-14  Stefan Monnier  <monnier@iro.umontreal.ca>

	* winner.el (winner-active-region, winner-edges, winner-window-list):
	Define at toplevel.
	(winner-mode-map): Move init inside declaration.

2004-11-14  Luc Teirlinck  <teirllm@auburn.edu>

	* files.el (convert-standard-filename): Doc fix.

2004-11-14  Daniel Pfeiffer  <occitan@esperanto.org>

	* files.el (auto-mode-alist): Handle .gtkrc, and under /etc
	passwd, group, shadow, default/* and pam.d/*.

2004-11-14  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* printing.el (pr-menu-spec): Adjust menu specification.

2004-11-13  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* printing.el: Doc fix.  Insert :version tag into all defcustom.
	Handle interactive-p as is recommended in Emacs Lisp Reference.
	Set the file permission bits for newly created files.
	Reported by Glenn Morris <gmorris+emacs@ast.cam.ac.uk>.
	The printing menu specification (in `pr-menu-spec') was merged.
	Suggested by Stefan Monnier <monnier@iro.umontreal.ca>.
	(pr-version): New version number (6.8.3).
	(pr-file-modes): New option.
	(pr-interactive-p): New var.
	(pr-save-interactive, pr-save-file-modes): New macros.
	(pr-setup): Code fix.
	(pr-menu-spec): Menu specification merged.
	(pr-call-process, pr-text2ps): Set file permission bits.
	(pr-despool-print): Set file permission bits.  Handle interactive-p as
	is recommended.
	(pr-interface, pr-ps-directory-preview)
	(pr-ps-directory-using-ghostscript, pr-ps-directory-print)
	(pr-ps-directory-ps-print, pr-ps-buffer-preview)
	(pr-ps-buffer-using-ghostscript, pr-ps-buffer-print)
	(pr-ps-buffer-ps-print, pr-ps-region-preview)
	(pr-ps-region-using-ghostscript, pr-ps-region-print)
	(pr-ps-region-ps-print, pr-ps-mode-preview)
	(pr-ps-mode-using-ghostscript, pr-ps-mode-print, pr-ps-mode-ps-print)
	(pr-printify-directory, pr-txt-directory, pr-despool-preview)
	(pr-despool-using-ghostscript, pr-despool-ps-print)
	(pr-ps-file-up-preview, pr-ps-file-using-ghostscript)
	(pr-ps-file-up-ps-print, pr-toggle-file-duplex, pr-toggle-file-tumble)
	(pr-toggle-file-landscape, pr-toggle-ghostscript, pr-toggle-faces)
	(pr-toggle-spool, pr-toggle-duplex, pr-toggle-tumble)
	(pr-toggle-landscape, pr-toggle-upside-down, pr-toggle-line)
	(pr-toggle-zebra, pr-toggle-header, pr-toggle-header-frame)
	(pr-toggle-lock, pr-toggle-region, pr-toggle-mode, pr-ps-name)
	(pr-txt-name, pr-ps-utility, pr-ps-fast-fire, pr-txt-fast-fire)
	(pr-menu-lock, pr-update-menus, pr-ps-utility-args)
	(pr-set-outfilename, pr-interface-ps-print, pr-interface-preview):
	Handle interactive-p as is recommended.

2004-11-13  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/byte-opt.el (byte-optimize-inline-handler): Simplify.
	(byte-decompile-bytecode-1): Remove unused vars `tag' and `retcount'.

	* font-lock.el (font-lock-fontify-syntactically-region): Fix last fix
	so it doesn't forget to highlight the beginning of the region either.

2004-11-13  Daniel Pfeiffer  <occitan@esperanto.org>

	* progmodes/cc-mode.el (c-basic-common-initc-font-lock-init)
	(c-font-lock-init): Eliminate obsolete make-local-hook.
	(c-mode, c++-mode, objc-mode, java-mode, idl-mode, pike-mode)
	(awk-mode): Use run-mode-hooks.

	* progmodes/cperl-mode.el (cperl-mode): Use run-mode-hooks.

2004-11-13  Kim F. Storm  <storm@cua.dk>

	* mouse.el (mouse-drag-copy-region): Add :version.
	(mouse-drag-mode-line-1): Let bind mouse-autoselect-window to nil
	while dragging mode line, so mode line can be dragged downwards.
	(mouse-drag-region-1): Let bind make-cursor-line-fully-visible
	while pressing mouse button so window doesn't scroll until we
	release the mouse if clicking on partially visible line.

2004-11-12  Jay Belanger  <belanger@truman.edu>

	* calc/calc-graph.el (calc-dumb-map): Declare it.
	(calc-graph-show-dumb): Check if calc-dumb-map is non-nil rather
	than unbound.
	(calc-graph-name): Made `end' a local variable.
	(calc-graph-lookup): Made `varname' a local variable.
	(var-DUMMY, var-DUMMY2, var-PlotRejects, calc-gnuplot-trail-mark):
	Declare them.
	(calc-graph-format-data): Don't check if var-PlotRejects is bound.
	(calc-graph-plot, calc-graph-compute-3d): Remove references to
	the unused variable y3vec.
	(calc-graph-show-dumb): Remove reference to unused variable found-pt.
	(calc-graph-kill-hook, calc-graph-plot): Remove reference to
	calc-graph-prev-kill-hook.
	(calc-graph-yvalue, calc-graph-yvec, calc-graph-numsteps)
	(calc-graph-numsteps3, calc-graph-xvalue, calc-graph-xvec)
	(calc-graph-xname, calc-graph-yname, calc-graph-xstep)
	(calc-graph-ycache, calc-graph-ycacheptr, calc-graph-refine)
	(calc-graph-keep-file, calc-graph-xval, calc-graph-xlow)
	(calc-graph-xhigh, calc-graph-yval, calc-graph-yp, calc-graph-xp)
	(calc-graph-zp, calc-graph-yvector, calc-graph-resolution)
	(calc-graph-y3value, calc-graph-y3name)
	(calc-graph-y3step, calc-graph-y3step, calc-graph-zval)
	(calc-graph-stepcount, calc-graph-is-splot)
	(calc-graph-surprise-splot, calc-graph-blank)
	(calc-graph-non-blank, calc-graph-curve-num): New variables.
	(calc-graph-plot, calc-graph-compute-2d, calc-graph-refine-2d)
	(calc-graph-recompute-2d, calc-graph-compute-3d)
	(calc-graph-format-data): Replace undeclared variables with the
	above newly declared variables.

2004-11-12  Diane Murray  <dsm@muenster.de>  (tiny change)

	* mail/rmail.el (rmail-get-new-mail): Use the renamed variables
	`rsf-beep' and `rsf-sleep-after-message'.

	* mail/rmail-spam-filter.el (rmail-spam-filter): Only check white
	list if `message-sender' is non-nil.

2004-11-12  Kevin Rodgers  <ihs_4664@yahoo.com>  (tiny change)

	* desktop.el (desktop-create-buffer, desktop-save): Avoid some
	consing by using mapc instead of mapcar.

2004-11-12  Nick Roberts  <nickrob@snap.net.nz>

	* tooltip.el (require): Explain why CL is needed.

2004-11-11  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* printing.el: Insert :version into defgroup (printing).  All reference
	to Files option in menubar were changed to File.
	(pr-version): New version number (6.8.2).
	(pr-get-symbol): Call easy-menu-intern.
	(pr-region-active-p): Now is a fun (it was defsubst).  To avoid
	compilation gripes.

2004-11-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/byte-opt.el (byte-compile-inline-expand): Understand the
	new byte-compile-function-environment binding to t.

	* font-lock.el (font-lock-fontify-syntactically-region):
	Don't forget to highlight the last char when we hit `end'.

	* mwheel.el (mouse-wheel-progressive-speed): Fix typo in name.
	(mwheel-scroll): Adjust accordingly.

	* cvs-status.el: Reduce spurious warnings.
	(cvs-status-checkout): Remove.
	(cvs-status-mode-map): Use cvs-mode-checkout instead.

	* pcvs.el (cvs-mode-checkout): New command.

	* international/iso-cvt.el (iso-cvt-define-menu): Fix typo.

	* tooltip.el: Require CL.

	* emacs-lisp/bytecomp.el: Use push.
	(byte-compile-file-form-defalias): Rename from byte-compile-defalias.
	(defalias): Remove the `byte-compile' property and add
	a `byte-hunk-handler'.

2004-11-11  Juri Linkov  <juri@jurta.org>

	* info.el (Info-search): Save match data for isearch.
	Skip Tag Table node.

	* descr-text.el (describe-char): Replace syntax-after with code
	from its previous version.

	* files.el (magic-mode-alist): Use optimization for SGML mode too.
	(set-auto-mode): Doc fix.  Remove unused variable `xml'.

	* international/mule.el (sgml-html-meta-auto-coding-function):
	Remove > after <html to allow HTML attributes.

2004-11-11  Jay Belanger  <belanger@truman.edu>

	* calc/calc-comb.el (math-prime-factors-finished): Declare it as
	a variable.
	(calcFunc-dfac): Replace unbound max by n.
	(math-stirling-local-cache): New variable.
	(math-stirling-number, math-stirling-1, math-stirling-2):
	Replace the variable `cache' by the declared variable
	math-stirling-local-cache.
	(var-RandSeed): Declare it as a variable.
	(math-init-random-base, math-random-digit): Don't check to see if
	var-RandSeed is bound.
	(math-random-cache, math-gaussian-cache, calc-verbose-nextprime):
	Declare them instead of just setting them.
	(math-init-random-base): Made i a local variable.
	(math-random-digit): Made math-random-last a local variable.
	(math-prime-test-cache): Move declaration to before it is used.
	(math-prime-test-cache-k, math-prime-test-cache-q)
	(math-prime-test-cache-nm1, math-prime-factors-finished):
	Declare them as variables.

2004-11-11  Jay Belanger  <belanger@truman.edu>

	* calc/calc-ext.el (math-defcache): Use defvar for the new
	variables it creates.

2004-11-11  Lars Hansen  <larsh@math.ku.dk>

	* desktop.el (desktop-buffer-mode-handlers, desktop-after-read-hook)
	(desktop-clear-preserve-buffers-regexp, desktop-file-name-format)
	(desktop-globals-to-clear, desktop-no-desktop-file-hook, desktop-path)
	(desktop-save): Add :version.

2004-11-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* printing.el (pr-get-symbol): Don't downcase.

2004-11-10  Jay Belanger  <belanger@truman.edu>

	* calc/calc-aent.el (calc-do-quick-calc): Use kill-new to append
	string to kill-ring.

	* calc/calc-aent.el (calc-alg-exp, math-toks)
	(math-exp-pos,math-exp-old-pos, math-exp-token)
	(math-exp-keep-spaces, math-exp-str): New variables.
	(calc-do-alg-entry, calcAlg-equals, calcAlg-edit)
	(calcAlg-enter): Use declared variable calc-alg-exp.
	(math-build-parse-table, math-find-user-token): Use declared
	variable math-toks.
	(math-read-exprs, math-read-token, calc-check-user-syntax)
	(calc-match-user-syntax, match-factor-after, math-read-factor):
	Use declared variables math-exp-pos math-exp-old-pos.
	(math-read-exprs, math-read-token, math-read-expr-level)
	(calc-check-user-syntax, calc-match-user-syntax)
	(match-factor-after, math-read-factor): Use declared variable
	math-exp-token.
	(math-read-exprs, math-read-expr-list, math-read-token)
	(math-read-factor): Use declared variable math-exp-keep-spaces.
	(math-read-exprs, math-read-token): Use declared variable
	math-exp-str.
	(calc-match-user-syntax): Make m a local variable.

	* calc/calc-ext.el (math-read-expr): Use declared variables
	math-exp-pos, math-exp-old-pos, math-exp-str, math-exp-token,
	math-exp-keep-spaces.

	* calc/calc-forms.el (math-read-angle-bracket): Use declared
	variables math-exp-pos, math-exp-str.

	* calc/calc-lang.el (math-parse-tex-sum): Use declared variable
	math-exp-old-pos.
	(math-parse-fortran-vector, math-parse-fortran-vector-end)
	(math-parse-eqn-prime): Use declared variable math-exp-token.

	* calc/calc-vec.el (math-read-brackets, math-check-for-commas):
	Use declared variable math-exp-pos.
	(math-check-for-commas): Use declared variable math-exp-str.
	(math-read-brackets): Use declared variables math-exp-old-pos,
	math-exp-keep-spaces.
	(math-read-brackets, math-read-vector, math-read-matrix):
	Use declared variable math-exp-token.

2004-11-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/easymenu.el (easy-menu-define-key): Understand the case
	where the keymap is a symbol.
	(easy-menu-add-item): Use keymap-prompt.  Simplify.

	* files.el (magic-mode-alist): Reduce backtracking in the HTML regexp.

	* textmodes/sgml-mode.el (sgml-tag-text-p): New fun.
	(sgml-parse-tag-backward): Use it to skip spurious < or >.

2004-11-10  Thien-Thi Nguyen  <ttn@gnu.org>

	* ebuff-menu.el: Doc fixes throughout.
	(electric-buffer-menu-mode-hook): New defvar.

2004-11-10  Nick Roberts  <nickrob@snap.net.nz>

	* tooltip.el: Don't require cl, comint, gud, gdb-ui for compilation.
	The resulting compiler warnings appear to be harmless.

2004-11-10  Daniel Pfeiffer  <occitan@esperanto.org>

	* textmodes/conf-mode.el: New file.

	* files.el (auto-mode-alist, magic-mode-alist): Use it.

2004-11-09  Stefan Monnier  <monnier@iro.umontreal.ca>

	* international/iso-cvt.el (iso-cvt-define-menu): Clean up namespace.

2004-11-09  Jay Belanger  <belanger@truman.edu>

	* calc/calc-ext.el (calc-init-extensions): Remove old code.

	* calc/calc-ext.el (math-expr-data, math-mt-many, math-mt-func)
	(calc-z-prefix-buf, calc-z-prefix-msgs): New variables.
	(calc-z-prefix-help, calc-user-function-list): Use declared
	variables calc-z-prefix-buf, calc-z-prefix-msgs.
	(math-map-tree, math-map-tree-rec): Use declared variables
	math-mt-many, math-mt-func.
	(math-read-expression, math-read-string): Use declared variable
	math-expr-data.

	* calc/calc-ext.el (math-normalize-nonstandard): Use declared
	variable math-normalize-a.

	* calc/calc.el (math-normalize-a): New variable.
	(math-normalize): Use declared variable math-normalize-a.

	* calc/calc-poly.el (math-expand-form): Use declared variable
	math-mt-many.

	* calc/calc-rewr.el (math-rewrite, math-rewrite-phase):
	Use declared variable math-mt-many.
	(math-rewrite): Use declared variable math-mt-func.

	* calc/calc-vec.el (math-read-brackets, math-read-vector)
	(math-read-matrix): Use declared variable math-expr-data.

	* calc/calc-lang.el (math-parse-fortran-vector)
	(math-parse-fortran-vector-end, math-parse-tex-sum)
	(math-parse-eqn-matrix, math-parse-eqn-prime)
	(math-read-math-subscr): Use declared variable math-expr-data.

	* calc/calc-aent.el (math-read-exprs, math-read-expr-list)
	(math-read-expr-level, math-read-token, calc-check-user-syntax)
	(calc-match-user-syntax, math-read-if, math-factor-after)
	(math-read-factor): Use declared variable math-expr-data.

2004-11-09  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* calendar/diary-lib.el (diary-from-outlook)
	(diary-from-outlook-gnus, diary-from-outlook-rmail): Do not use
	interactive-p; but rather new optional argument NOCONFIRM.

2004-11-09  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/easymenu.el (easy-menu-intern): Revert to no-downcasing.
	(easy-menu-name-match): Revert correspondingly.

2004-11-09  Richard M. Stallman  <rms@gnu.org>

	* emacs-lisp/bytecomp.el (byte-compile-defalias):
	Turn off warnings for the new function even if definition not constant.
	If the definition isn't a quoted symbol, record (FUNCTION . t).
	(byte-compile-function-environment): Now allow (FUNCTION . t) as elt.
	(byte-compile-callargs-warn): Handle (FUNCTION . t).
	(display-call-tree, byte-compile-arglist-warn):
	Handle t returned by byte-compile-fdefinition.

2004-11-09  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* Makefile.in (maintainer-clean): Depend on distclean.

	* help-fns.el (help-C-file-name): File name must be in build-files
	to be returned.

2004-11-09  Jay Belanger  <belanger@truman.edu>

	* calc/calc.el (calc-mode-hook, calc-trail-mode-hook)
	(calc-start-hook, calc-end-hook, calc-load-hook): New variables.

	* calc/calc.el (calc, calc-trail-display, calc-mode):
	Remove obsolete sections.

	* calc/calc.el (calc-x-paste-text): Remove.

	* calc/calc-ext.el (calc-init-extensions): Bind calc-yank to
	mouse-2.

2004-11-09  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-current-stack-level): New variable.
	(gdb-info-frames-custom, gdb-frame-handler): Use it to find
	current frame (in case of recursive calls).
	(gdb-show-changed-values): Add :version keyword.

2004-11-09  Kenichi Handa  <handa@m17n.org>

	* international/mule-cmds.el: Change coding: tag back to
	iso-2022-7bit.

2004-11-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* international/mule-cmds.el: Change coding-system to utf-8.
	(select-safe-coding-system-interactively):
	New function extracted from select-safe-coding-system.
	(select-safe-coding-system): Use it.

2004-11-08  Richard M. Stallman  <rms@gnu.org>

	* subr.el (syntax-after): Doc fix.

	* paren.el (show-paren-function): Change calls to syntax-after
	for new way of returning the value.

	* menu-bar.el (menu-bar-file-menu): Make this the real name
	and menu-bar-files-menu the alias.  Use the former.
	(global-map): Use `file', not `files', as the symbol.

	* info.el (Info-revert-find-node): Don't use beginning-of-buffer.

	* filesets.el (filesets-spawn-external-viewer, filesets-run-cmd):
	Don't use beginning-of-buffer.
	(filesets-cmd-show-result): Use with-no-warnings.

2004-11-08  Juri Linkov  <juri@jurta.org>

	* progmodes/compile.el (compile): Don't overwrite last command in
	minibuffer history with default command if they are not equal.

2004-11-08  Jay Belanger  <belanger@truman.edu>

	* calc/calcalg2.el (math-do-integral-methods): Try linear then
	non-linear substitutions.

2004-11-08  Jay Belanger  <belanger@truman.edu>

	* calc/calcalg2.el (math-linear-subst-tried): New variable.
	(math-do-integral): Set `math-linear-subst-tried' to nil.
	(math-do-integral-methods): Use `math-linear-subst-tried' to
	determine what type of substitution to try.
	(math-integ-try-linear-substituion):
	Set `math-linear-subst-tried' to t.

2004-11-08  Kim F. Storm  <storm@cua.dk>

	* Makefile.in (bootstrap-clean): New target for 'make bootstrap'.

2004-11-07  Juri Linkov  <juri@jurta.org>

	* info-look.el (info-lookup): Allow reusing in the current buffer
	not only *info* buffer, but all (even renamed) Info buffers
	by checking for major-mode instead of *info* buffer name.
	(c-mode, autoconf-mode, emacs-lisp-mode, scheme-mode)
	(octave-mode, maxima-mode) <doc-spec>:
	Allow long dashes generated by Texinfo 4.7 before definitions.
	(texinfo-mode) <doc-spec>: Add space to suffix to find command
	definitions with argument separated by space.

2004-11-06  Richard M. Stallman  <rms@gnu.org>

	* simple.el (next-error group, face): Move before first use.
	(next-error-highlight, next-error-highlight-no-select): Likewise.

	* simple.el (line-move-invisible-p): Rename from line-move-invisible.
	(line-move): New args NOERROR and TO-END.
	Return t if succeed in moving specified number of lines.
	(move-end-of-line): New function.

	* simple.el (beginning-of-buffer-other-window): Use with-no-warnings.
	(end-of-buffer-other-window): Likewise.

	* simple.el (line-move-ignore-invisible): Default to t.

	* subr.el (syntax-after): Return the syntax letter, not the raw code.

	* emacs-lisp/elp.el (elp-results): Delete wasteful beginning-of-buffer.

	* international/iso-cvt.el (iso-cvt-define-menu):
	Rename menu-bar-files-menu to menu-bar-file-menu.

	* net/browse-url.el (browse-url-gnome-moz-program)
	(browse-url-gnome-moz-arguments): Move up before first use.

	* net/tramp.el (tramp group): Add :version.

	* progmodes/ada-xref.el (ada-gdb-application):
	Use goto-char instead of beginning-of-buffer.

	* progmodes/cperl-mode.el (cperl-info-on-command):
	Use goto-char instead of beginning-of-buffer.

	* progmodes/idlw-shell.el (idlwave-shell-examine-map):
	Move up before first use.
	(idlwave-shell-temp-pro-file): Likewise.
	(idlwave-shell-temp-rinfo-save-file): Likewise.
	(idlwave-shell-temp-file): Minor doc fix.

	* textmodes/flyspell.el (flyspell-external-point-words):
	Use goto-char instead of beginning-of-buffer.

2004-11-06  Kai Grossjohann  <kai.grossjohann@gmx.net>

	* net/tramp.el (tramp-coding-commands): Additionally try "uudecode -o
	/dev/stdout" before trying "uudecode -o -".  Suggested by Han Boetes.
	(tramp-uudecode): Mention `uudecode -o /dev/stdout'.

2004-11-06  David Ponce  <david@dponce.com>

	* recentf.el (recentf-menu-path): Use menu item name.

2004-11-06  Eli Zaretskii  <eliz@gnu.org>

	* progmodes/gdb-ui.el: Don't call define-fringe-bitmap if the
	display doesn't support images.

2004-11-06  Andreas Schwab  <schwab@suse.de>

	* tempo.el (tempo-match-finder): Doc fix.

	* emacs-lisp/easymenu.el (easy-menu-get-map): Fix last change.

2004-11-06  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/easymenu.el (easy-menu-get-map-look-for-name): Remove.
	(easy-menu-lookup-name): New fun to replace it.
	(easy-menu-get-map): Use it to obey menu item names (rather than just
	keys) when looking up `path'.
	(easy-menu-always-true-p): Rename from easy-menu-always-true.
	(easy-menu-convert-item-1): Adjust to new name.

2004-11-06  Peter Heslin  <pj@heslin.eclipse.co.uk>  (tiny change)

	* outline.el (hide-body): Don't hide lines at the top of the file
	that precede the first header line.

2004-11-06  Paul Pogonyshev  <pogonyshev@gmx.net>

	* align.el (align-areas): Delete whitespace before reindenting, so
	that tabs are never placed after spaces.

2004-11-06  Alan Shutko  <ats@acm.org>

	* macros.el (insert-kbd-macro): Do completions based on macros,
	rather than all commands.

2004-11-06  David Hansen  <david.hansen@gmx.net>  (tiny change)

	* tempo.el (tempo-match-finder): Use [:word:] instead of "^\\b",
	to solve a bug whereby tags with 'b' don't match.

2004-11-05  Juri Linkov  <juri@jurta.org>

	* info.el (Info-search): Don't search in node header lines
	and file headers.

	* emacs-lisp/edebug.el (edebug-next-token-class): Allow all
	symbol-constituent characters after dot, not only digits.

2004-11-04  Daniel Pfeiffer  <occitan@esperanto.org>

	* files.el (set-auto-mode): Don't get error after setting -*-mode-*-.

2004-11-04  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* dired.el (dired-read-dir-and-switches): Call read-directory-name
	if a dialog will be used, read-file-name otherwise.

2004-11-04  Richard M. Stallman  <rms@gnu.org>

	* textmodes/table.el (table group): Add :version.

	* textmodes/ispell.el (ispell-word):
	Don't alter args; set them only thru `interactive' spec.

	* textmodes/flyspell.el (flyspell-word):
	Don't alter FOLLOWING; set it only thru `interactive' spec.

	* progmodes/f90.el (f90-end-of-block): Don't use interactive-p.

	* net/browse-url.el (browse-url-maybe-new-window):
	Use called-interactively-p.

	* mail/supercite.el (sc-cite-region):
	Don't use interactive-p.  Add arg INTERACTIVE.
	(sc-version): Don't use interactive-p.  Rename arg to MESSAGE.

	* international/mule-cmds.el (set-input-method, toggle-input-method):
	Don't use interactive-p.  Add arg INTERACTIVE.

	* eshell/esh-mode.el (eshell-show-maximum-output):
	Don't use interactive-p.
	(eshell-truncate-buffer): Just message, no error, if buffer is short.

	* mouse.el (mouse-show-mark): Get positions to delete from mark
	and point, not from mouse-drag-overlay.

	* imenu.el (imenu-eager-completion-buffer): Add :version.

	* filesets.el (filesets group): Add :version.

2004-11-03  Daniel Pfeiffer  <occitan@esperanto.org>

	* files.el (xml-based-modes): Delete var.
	(magic-mode-alist): New more general var.
	(set-auto-mode): Use it.

	* buff-menu.el (Buffer-menu-make-sort-button): Preserve point even
	when clicking from another window.

2004-11-03  Thien-Thi Nguyen  <ttn@gnu.org>

	* vc-cvs.el (vc-cvs-local-month-numbers): Delete var.
	(vc-cvs-annotate-time): Incorporate value of deleted var.
	Remove special-case handling of beginning-of-buffer cruft.
	Cache ending position (point) and return value in text property
	`vc-cvs-annotate-time', and consult it on subsequent invocations.

	* vc-cvs.el (vc-cvs-annotate-command):
	Delete extraneous lines from beginning of buffer.
	* vc-mcvs.el (vc-mcvs-annotate-command): Likewise.

	* progmodes/grep.el (grep-default-command): Take empty string
	for tag if all other methods yield nil.  Shell-quote the tag.

	* vc.el (vc-annotate-display-autoscale): Add prefix-arg
	spec in `interactive' form, and mention it in the docstring.
	Also, make sure point is at bol after calling `annotate-time'.

2004-11-02  Richard M. Stallman  <rms@gnu.org>

	* cus-edit.el (customize-group-other-window):
	Select the window that displays the custom buffer.
	(custom-buffer-create-other-window): Likewise.

	* comint.el (comint-insert-input): Fix previous change.

	* emacs-lisp/elp.el (elp-instrument-function):
	Use called-interactively-p.

	* emacs-lisp/easymenu.el (easy-menu-intern):
	Don't downcase; rather, case-flip the first letter of each word.

	* emacs-lisp/easy-mmode.el (define-minor-mode):
	Use called-interactively-p.

	* emacs-lisp/bytecomp.el (byte-compile-warning-types):
	Add interactive-only.
	(byte-compile-warnings): Add interactive-only as option.
	(byte-compile-interactive-only-functions): New variable.
	(byte-compile-form): Warn about calls to functions
	in byte-compile-interactive-only-functions.

	* emacs-lisp/autoload.el (update-file-autoloads):
	Don't use interactive-p; take new arg SAVE-AFTER.

	* emacs-lisp/advice.el (ad-make-advised-definition):
	Use called-interactively-p.

2004-11-02  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* files.el (find-file-existing): New function.

	* menu-bar.el (menu-bar-files-menu): Make "Open File..." call
	find-file-existing.  Add "New File..." that calls find-file.

	* diropen.pbm, diropen.xpm: New files.

	* toolbar/tool-bar.el (tool-bar-setup): Tool bar item dired uses
	icon diropen.  New tool bar item find-file-existing uses icon open.

	* dired.el (dired-read-dir-and-switches): Call read-directory-name
	instead of read-file-name.

2004-11-02  Ulf Jasper  <ulf.jasper@web.de>

	* calendar/icalendar.el (icalendar-version): Increase to 0.08.
	(icalendar--split-value): Change name of work buffer.
	(icalendar--get-weekday-abbrev): Return nil on error.
	(icalendar--date-to-isodate): New function.
	(icalendar-convert-diary-to-ical)
	(icalendar-extract-ical-from-buffer): Use only two args for
	make-obsolete (XEmacs compatibility).
	(icalendar-export-file, icalendar-import-file): Blank at end of prompt.
	(icalendar-export-region): Doc fix.
	If error, return non-nil and write errors to a buffer.
	Use correct weekday for weekly recurring events.
	Check whether date has been parsed for ordinary events.
	Make weekly events start in the year 2000.
	DTEND is non-inclusive, shift end date by one day if
	necessary (not for entries that have date and time).
	Rename local let variables: oops -> found-error, datestring ->
	startdatestring.

2004-11-02  Kim F. Storm  <storm@cua.dk>

	* files.el (set-auto-mode-0): Don't rely on dynamic binding of
	keep-mode-if-same variable.  Add it as optional arg instead.
	(set-auto-mode): Call set-auto-mode-0 with keep-mode-if-same.

	* ehelp.el (electric-help-map): Reorder Q/q and R/r entries so
	substitute-command-keys will select lower-case bindings like those
	used in the static help texts.

	* descr-text.el (describe-text-properties): Don't err if called in
	the *Help* buffer; output to *Help-2* buffer instead.

	* kmacro.el (group kmacro): Add :version.
	(kmacro-keyboard-quit): New function to cleanup on C-g.
	(kmacro-start-macro): Set defining-kbd-macro to append when
	appending to last macro.

	* simple.el (keyboard-quit): Call kmacro-keyboard-quit.

2004-11-02  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-enable-debug-log)
	(gdb-use-inferior-io-buffer, gdb-use-colon-colon-notation)
	(gud-gdba-command-name, gdb-show-main, gdb-many-windows):
	Add :version keyword.

2004-11-02  Pavel Kobiakov  <pk_at_work@yahoo.com>

	* progmodes/flymake.el (flymake-err-line-patterns):
	Use `flymake-reformat-err-line-patterns-from-compile-el' to convert
	`compilation-error-regexp-alist-alist' to internal Flymake format.

	* progmodes/flymake.el: Eliminate byte-compiler warnings.

2004-11-01  Jay Belanger  <belanger@truman.edu>

	* calc/calc-frac.el (calc-over-notation): Replace `completing-read'
	with `interactive "s"'.

2004-11-01  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* mouse.el (mouse-yank-at-click, mouse-yank-secondary):
	Revert change from 2004-10-16.  '*' checks the current buffer, but the
	mouse click may be in another buffer.

2004-11-01  John Paul Wallington  <jpw@gnu.org>

	* files.el (large-file-warning-threshold): Add :version keyword.
	(kill-some-buffers): Doc fix.

	* thumbs.el (group thumbs): Add :version keyword.

	* textmodes/bibtex.el (bibtex-make-field): Fix typo.

2004-11-01  Richard M. Stallman  <rms@gnu.org>

	* textmodes/ispell.el (ispell-word): Don't use interactive-p.

	* textmodes/flyspell.el (flyspell-word): Don't use interactive-p.

	* allout.el (allout group): Add :version.
	(allout-init): Don't use interactive-p.
	(allout-ascend-to-depth, allout-ascend, allout-end-of-level)
	(allout-forward-current-level, allout-backward-current-level):
	Don't use interactive-p.

	* textmodes/bibtex.el (bibtex-make-field): Don't use interactive-p.
	(bibtex-find-text): Likewise.

	* progmodes/vhdl-mode.el (vhdl-fill-region)
	(vhdl-beginning-of-statement): Don't use interactive-p.

	* progmodes/idlwave.el (idlwave-update-routine-info):
	Don't use interactive-p.

	* progmodes/idlw-shell.el (idlwave-shell-send-char):
	Don't use interactive-p.

	* progmodes/cperl-mode.el (cperl-switch-to-doc-buffer):
	Don't use interactive-p.

	* progmodes/ada-xref.el (ada-make-body-gnatstub):
	Don't use interactive-p.

	* play/fortune.el (fortune-to-signature): Don't use interactive-p.
	(fortune-in-buffer): Doc fix.

	* play/5x5.el (5x5-new-game): Set up the buffer even if not interactive.

	* net/eudc.el (eudc-display-records): Use with-output-to-temp-buffer;
	don't select the temporary buffer.
	(eudc-get-email): New optional arg ERROR; don't use interactive-p.
	(eudc-get-phone): Likewise.

2004-11-01  Kim F. Storm  <storm@cua.dk>

	* man.el (Man-xref-normal-file): Fix help-echo.

2004-10-31  Stefan Monnier  <monnier@iro.umontreal.ca>

	* reveal.el (reveal-last-tick): New var.
	(reveal-post-command): Use it to avoid closing overlays when we're
	appending text to them.

2004-10-31  Roland Winkler  <Roland.Winkler@physik.uni-erlangen.de>

	* textmodes/bibtex.el: Require button.
	(bibtex-autokey-transcriptions): Translate TeX `\ ' to space.
	(bibtex-reference-keys): Distinguish between header keys and
	crossref keys.
	(bibtex-beginning-of-field): New function.
	(bibtex-url-map): Remove.
	(bibtex-font-lock-keywords): Use bibtex-font-lock-crossref.
	(bibtex-font-lock-url-regexp): Assume that field names begin at
	the beginning of a line.
	(bibtex-font-lock-url): Simplify.  Do not use bibtex-enclosing-field.
	Remove field delimiters.  Use bibtex-beginning-of-field.
	Bugfix, point can be inside a field with a url.
	(bibtex-font-lock-crossref, bibtex-button-action, bibtex-button):
	New functions.
	(bibtex-mark-active, bibtex-run-with-idle-timer): Remove.
	(bibtex-key-in-head): Simplify.
	(bibtex-current-line): Use bolp.
	(bibtex-parse-keys): Remove unused arg `add'.
	Use bibtex-type-in-head and bibtex-key-in-head.
	(bibtex-parse-entry, bibtex-autofill-entry):
	Use bibtex-type-in-head and bibtex-key-in-head.
	(bibtex-autokey-get-field): Do not alter case of replacement text.
	(bibtex-autokey-get-names): Do all processing of name list.
	(bibtex-autokey-get-year): New function.
	(bibtex-autokey-get-title): Do all processing of title words.
	(bibtex-generate-autokey): Simplify.
	(bibtex-string-files-init): Use default-directory.
	Allow for absolute file names in bibtex-string-files.
	(bibtex-files, bibtex-file-path): New variables.
	(bibtex-files-expand): New function.
	(bibtex-find-entry-globally): New command.
	(bibtex-summary-function): New variable.
	(bibtex-summary): Default value of bibtex-summary-function.
	(bibtex-find-crossref): New optional args pnt and split.
	(bibtex-complete-key-cleanup): Call bibtex-summary-function.
	(bibtex-copy-summary-as-kill): New command bound to C-cC-t.
	(bibtex-validate): Fix docstring.  Check only abbreviated month fields.
	Fix handling of required and alternative fields.
	Identify duplicate keys even if bibtex-maintain-sorted-entries is nil.
	Use cons and display-buffer.
	(bibtex-validate-globally): New command.
	(bibtex-clean-entry): Use bibtex-files-expand.  Do not call
	bibtex-parse-keys and bibtex-parse-strings for updating
	bibtex-reference-keys and bibtex-strings.
	(bibtex-realign): Remove blank lines past the last entry.
	(bibtex-reformat): Use bibtex-entry-format as default.
	(bibtex-choose-completion-string): Remove.
	(bibtex-complete): Do not use bibtex-choose-completion-string.
	(bibtex-url): Simplify.

2004-10-31  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* x-dnd.el (x-dnd-test-function, x-dnd-protocol-alist)
	(x-dnd-types-alist, x-dnd-open-file-other-window)
	(x-dnd-known-types): Add :version.

2004-10-31  John Paul Wallington  <jpw@gnu.org>

	* ibuffer.el (group ibuffer): Add :version keyword.

2004-10-31  Kim F. Storm  <storm@cua.dk>

	* ido.el (group ido): Add :version keyword.
	(ido-mode): Remove :version keyword.

	* emulation/cua-base.el (group cua): Add :version keyword.
	(cua-mode): Remove :version keyword.

2004-10-30  Luc Teirlinck  <teirllm@auburn.edu>

	* autorevert.el (auto-revert-tail-mode-text): Add :version keyword.

	* help-at-pt.el (help-at-pt-timer): Move defvar up to avoid
	compiler warning.
	(help-at-pt-timer-delay): Add :initialize keyword.  Simplify :set
	function.
	(help-at-pt-display-when-idle): Remove autoload.

2004-10-30  Stefan Monnier  <monnier@iro.umontreal.ca>

	* makefile.w32-in (custom-deps, autoloads): Fix *-hooks -> *-hook.

2004-10-30  Juri Linkov  <juri@jurta.org>

	* help.el (function-called-at-point):
	* help-fns.el (variable-at-point): Read -> intern.

2004-10-30  Simon Josefsson  <jas@extundo.com>

	* progmodes/autoconf.el (autoconf-font-lock-keywords):
	Recognize AS_* too.

2004-10-29  Simon Josefsson  <jas@extundo.com>

	* subr.el (read-passwd): Move back from password.el.

	* password.el: Remove, not ready yet.

2004-10-29  Andreas Schwab  <schwab@suse.de>

	* speedbar.el (speedbar-frame-parameters): Improve customize type.

2004-10-29  Sam Steingold  <sds@gnu.org>

	* mouse.el (mouse-show-mark): Replace the last occurrence of
	x-lost-selection-hooks with x-lost-selection-functions.

2004-10-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* mouse.el (mouse-show-mark): Adjust to new name and don't assume
	x-lost-selection-functions is bound.

	* mouse-sel.el (mouse-sel-mode):
	* emacs-lisp/lselect.el: Adjust to new names for
	x-(lost|sent)-selection-functions.

	* subr.el (x-lost-selection-hooks, x-sent-selection-hooks):
	New obsolete aliases of x-lost-selection-functions and
	x-sent-selection-functions.

2004-10-28  Kim F. Storm  <storm@cua.dk>

	* imenu.el (imenu-scanning-message): Remove.
	(imenu-progress-message): Make it a no-op.

2004-10-28  John Paul Wallington  <jpw@gnu.org>

	* files.el (set-auto-mode): Call `throw' correctly.

2004-10-28  Juri Linkov  <juri@jurta.org>

	* info.el (Info-file-list-for-emacs): Add ("Info" . "info")
	to search `Info-...' commands in `info' manual.
	(Info-goto-emacs-command-node, Info-goto-emacs-key-command-node):
	Add 'info-file "emacs" property.
	(Info-find-emacs-command-nodes): Fix index line number regexp.
	Set real line number (instead of fake 0) in first element of the
	returned list.
	(Info-goto-emacs-command-node): Use line number of first element
	to set point in the first found Info node.

	* progmodes/grep.el (grep-regexp-alist): Move match highlighting
	code to `grep-mode-font-lock-keywords'.
	(grep-mode-font-lock-keywords): Delete grep markers instead
	of making them invisible.

2004-10-28  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* mail/emacsbug.el (report-emacs-bug): Insert x-server-vendor
	and x-server-version in bug report.

2004-10-28  Daniel Pfeiffer  <occitan@esperanto.org>

	* files.el (set-auto-mode-0): New function.
	(set-auto-mode): Use it to handle aliased modes and to
	be consistent between C-x C-f and C-x C-w.

2004-10-28  Kenichi Handa  <handa@m17n.org>

	* international/utf-8.el (utf-translate-cjk-charsets):
	Add katakana-jisx0201.

	* international/subst-jis.el: Add data for JISX0201.

2004-10-27  Stefan Monnier  <monnier@iro.umontreal.ca>

	* obsolete/hilit19.el (hilit-mode): New function.
	Move all the toplevel side-effecting stuff into it, so that loading
	hilit19 doesn't mess everything up any more.

2004-10-27  Richard M. Stallman  <rms@gnu.org>

	* add-log.el (add-change-log-entry): Set up mailing address
	and full name later, and don't alter add-log-mailing-address
	or add-log-full-name.

	* elide-head.el (elide-head): Change error to message.
	(elide-head-show): Likewise.

	* apropos.el (apropos-macrop): Doc fix.

	* mouse.el (mouse-show-mark): Do most processing the same
	regardless of transient-mark-mode.

	* shadowfile.el (shadow-copy-files): Use interactive-p
	only to control whether to print a message.

	* tar-mode.el (tar-mode): Use write-contents-functions,
	not write-contents-hooks.

	* eshell/em-unix.el (eshell-du-sum-directory): Don't use
	directory-sep-char.

2004-10-27  Richard M. Stallman  <rms@gnu.org>

	* strokes.el (strokes-unload-hook): Fix previous change.

	* type-break.el (type-break-run-at-time): Always use run-at-time;
	forget the alternatives.
	(type-break-cancel-function-timers): Always use cancel-function-timers;
	forget the alternatives.

	* pcomplete.el (pcomplete-entries): Don't use directory-sep-char.

2004-10-27  Kenichi Handa  <handa@m17n.org>

	* international/subst-jis.el: Use utf-translate-cjk-substitutable-p.

	* international/subst-gb2312.el: Likewise.

	* international/subst-big5.el: Likewise.

	* international/subst-ksc.el: Likewise.

	* international/utf-8.el (utf-translate-cjk-unicode-range-string):
	New variable.
	(utf-translate-cjk-set-unicode-range): New function.
	(utf-translate-cjk-unicode-range): Make it customizable.
	(utf-8-post-read-conversion):
	Use utf-translate-cjk-unicode-range-string.
	(ccl-decode-mule-utf-8): Check utf-subst-table-for-decode for more
	Unicode ranges.

2004-10-26  Daniel Pfeiffer  <occitan@esperanto.org>

	* files.el (auto-mode-alist): Add pod, js, xbm and xpm and group
	trivial variants to shorten the list.
	(xml-based-modes): New var.
	(set-auto-mode): Give interpreter-mode-alist or <?xml or <!DOCTYPE
	declaration higher priority than auto-mode-alist.

	* find-file.el (cc-other-file-alist): Bring it in line with
	cc-mode's auto-mode-alist entries and use \' instead of $.

	* textmodes/sgml-mode.el (sgml-mode): Fix imenu-generic-expression
	and add "Id" and "Name" submenus to it.

	* imenu.el (imenu--generic-function): Skip matches in comments.

2004-10-26  Jay Belanger  <belanger@truman.edu>

	* calc/calc.el (calc,full-calc, calc-quit, calc-keypad)
	(full-calc-keypad, calc-trail-display): Use an extra argument
	instead of `interactive-p'.

	* calc/calc-misc.el (calc-other-window): Use an extra argument
	instead of `interactive-p'.

	* calc/calc-rewr.el (calc-match): Use an extra argument instead of
	`interactive-p'.

2004-10-26  Kim F. Storm  <storm@cua.dk>

	* help.el (describe-key): Describe both down-event and up-event
	for a mouse click.

2004-10-26  Richard M. Stallman  <rms@gnu.org>

	* woman.el (woman): Don't call interactive-p.

	* pcomplete.el (pcomplete): Instead of interactive-p,
	use an arg set non-nil by the interactive spec.

	* menu-bar.el (menu-bar-make-toggle): Instead of interactive-p,
	use an arg set non-nil by the interactive spec.

	* man.el (Man-cleanup-manpage): Instead of interactive-p,
	use an arg set non-nil by the interactive spec.

2004-10-26  Pavel Kobiakov  <pk_at_work@yahoo.com>

	* progmodes/flymake.el (flymake-split-string):
	Use `flymake-split-string-remove-empty-edges' in any case.

2004-10-26  Masatake YAMATO  <jet@gyve.org>

	* progmodes/flymake.el (flymake-err-line-patterns):
	Use `compilation-error-regexp-alist-alist' instead of
	`compilation-error-regexp-alist'.

2004-10-25  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/tex-mode.el (tex-font-lock-keywords-1): Fix up the spurious
	verbatim face on the \ of \end{verbatim}.

2004-10-25  Jay Belanger  <belanger@truman.edu>

	* calc/calc-incom.el (calc-digit-dots): Inhibit read-only before
	erasing minibuffer.

2004-10-25  Simon Josefsson  <jas@extundo.com>

	* subr.el (read-passwd): Move to net/password.el.

	* net/password.el (read-passwd): Add.  Autoload it.

2004-10-25  Kai Grossjohann  <kai.grossjohann@gmx.net>

	* mouse-sel.el (mouse-sel-mode): Specify custom group.

	* simple.el (process-file): Fix logic.

2004-10-24  Luc Teirlinck  <teirllm@auburn.edu>

	* indent.el (set-left-margin, set-right-margin): Delete redundant code.
	(increase-right-margin): Remove erroneous call to `interactive-p'.

2004-10-24  Kim F. Storm  <storm@cua.dk>

	* help.el (describe-mode): Fix 2004-10-13 change.
	Copy pure "Auto Fill" string so it can be propertized later
	without causing a read-only error.

2004-10-24  Luc Teirlinck  <teirllm@auburn.edu>

	* info.el (Info-find-emacs-command-nodes): Adapt to Texinfo-4.7
	style indexes.

2004-10-24  Kai Grossjohann  <kai.grossjohann@gmx.net>

	* simple.el (process-file): Accept nil for INFILE.  Reported by
	Luc Teirlinck.

2004-10-24  Masatake YAMATO  <jet@gyve.org>

	* progmodes/gdb-ui.el (gdb-assembler-font-lock-keywords):
	Handle periods and underscores in a function name.
	Remove the address fontification.

2004-10-24  Masatake YAMATO  <jet@gyve.org>

	* progmodes/asm-mode.el (asm-font-lock-keywords):
	Use font-lock-variable-name-face for registers.

2004-10-24  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-get-create-buffer): Allow modes to run
	kill-all-local-variables.
	(gdb-breakpoints-mode, gdb-frames-mode, gdb-threads-mode)
	(gdb-registers-mode, gdb-locals-mode, gdb-assembler-mode):
	Use kill-all-local-variables and provide mode-hooks.
	(gdb-assembler-font-lock-keywords): New font lock keywords definition.
	(gdb-assembler-mode): Use 'gdb-assembler-font-lock-keywords'.
	Suggested by Masatake YAMATO <jet@gyve.org>.

2004-10-23  Kai Grossjohann  <kai.grossjohann@gmx.net>

	* simple.el (process-file): New function, similar to call-process
	but supports file handlers.
	* vc.el (vc-do-command): Use it, instead of call-process.
	* net/tramp-vc.el (vc-do-command): Do not advise it if
	process-file is fboundp.
	* net/tramp.el (tramp-file-name-handler-alist): Add entry for
	process-file.
	(tramp-handle-process-file): New function.
	(tramp-file-name-for-operation): Support process-file.

2004-10-23  Ulf Jasper  <ulf.jasper@web.de>

	* calendar/icalendar.el (icalendar--weekday-array): New constant.
	(icalendar-weekdayabbrev-table)
	(icalendar-monthnumber-table): Delete.
	(icalendar--get-month-number): Use calendar-month-name-array.
	(icalendar--get-weekday-number): New function.
	(icalendar--get-weekday-abbrev) Use calendar-day-name-array.
	(icalendar-export-region): Handle multi-line entries.
	(icalendar--convert-ical-to-diary): Use calendar-day-name-array.

2004-10-23  John Paul Wallington  <jpw@gnu.org>

	* ibuffer.el (ibuffer-find-file): Remove `interactive-p' call;
	`wildcards' set to t in interactive spec.

	* ibuf-ext.el (ibuffer-jump-to-buffer): Read buffer name in
	interactive spec rather than use `interactive-p'.
	(ibuffer-kill-line): Set arg `interactive-p' in interactive spec
	rather than use function `interactive-p'.

2004-10-22  Kenichi Handa  <handa@m17n.org>

	* international/mule.el (translate-region): Implement it in Lisp
	as a front end of translate-region-internal.

2004-10-21  Jay Belanger  <belanger@truman.edu>

	* calc/calc-aent.el (calc-alg-ent-map, calc-alg-ent-esc-map):
	Declare these variables with defvar.

	* calc/calc-aent.el (calc-do-alg-entry): Since `calc-alg-ent-map'
	is bound, only check to see if it is bound.

2004-10-21  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/tex-mode.el (tex-compilation-parse-errors):
	Don't output messages.

	* calc/calc-help.el (calc-describe-bindings): Fix last change.

2004-10-21  John Paul Wallington  <jpw@gnu.org>

	* calc/calc-graph.el (calc-graph-init):
	Use `set-process-query-on-exit-flag'.

2004-10-21  Daniel Pfeiffer  <occitan@esperanto.org>

	* progmodes/compile.el (compilation-start): Rely on `cd' to get
	dir right and also allow argumentless cd.

2004-10-19  Richard M. Stallman  <rms@gnu.org>

	* textmodes/flyspell.el (flyspell-mode): Doc fix.

	* eshell/em-unix.el (eshell-grep):
	Don't bind compilation-process-setup-function.

	* comint.el (comint-insert-input): Use @ in `interactive'.
	(comint-input-filter-functions): Doc fix.
	(comint-kill-whole-line, comint-get-source): Doc fix.

	* progmodes/compile.el (compilation-setup):
	Don't set buffer-read-only if MINOR is non-nil.

2004-10-19  Jay Belanger  <belanger@truman.edu>

	* calc/calc.el (calc-emacs-type-19, calc-emacs-type-epoch)
	(calc-emacs-type-gnu19): Remove.
	(calc-digit-map, calc-read-key-sequence, calc-read-key):
	Remove check for old emacs versions.

	* calc/calc-ext.el (calc-fancy-prefix): Remove emacs version check.
	(calc-init-extensions): Define `calc-alg-map' and `calc-alg-esc-map'
	for current Emacs.

	* calc/calc-aent.el (calcAlg-previous): Check to see if looking at
	the end of the minibuffer.
	(calc-do-alg-entry): Remove Emacs version check.  Use `copy-keymap' to
	copy `esc-map'.

	* calc/calc-graph.el (calc-graph-plot): Remove emacs version check.

	* calc/calc-mode.el (calc-total-algebraic-mode): Remove error
	call that would be given when the current emacs was used.

2004-10-19  Ulf Jasper  <ulf.jasper@web.de>

	* calendar/icalendar.el: Set coding to utf-8.
	(icalendar-version): Increase to 0.07.
	(icalendar-monthnumber-table): Change March pattern.
	(icalendar-get-all-event-properties)
	(icalendar-set-event-property): Delete.
	(icalendar-all-events): No longer interactive.
	(icalendar-convert-diary-to-ical)
	(icalendar-extract-ical-from-buffer): Make obsolete, and alias to
	their replacements.
	(icalendar-export-file, icalendar-export-region): New functions;
	essentially old `icalendar-convert-diary-to-ical' but appending to
	target rather than overwriting.
	(icalendar-import-file): Append to target file rather than
	overwriting.  Fourth arg deleted.
	(icalendar-import-buffer): New name for old
	`icalendar-extract-ical-from-buffer'.
	(icalendar--convert-string-for-import): New name for
	old `icalendar-convert-for-import'.
	(include-icalendar-files): Delete.
	Prefix for all internal functions changed from `icalendar-'
	to `icalendar--'.

2004-10-19  Richard M. Stallman  <rms@gnu.org>

	* paths.el (news-path): Fix previous change.

2004-10-18  Jay Belanger  <belanger@truman.edu>

	* calc/calc-help.el (calc-describe-bindings):
	Set `buffer-read-only' to nil while working in the keybindings buffer;
	remove some extra information from the keybindings buffer.

2004-10-18  David Ponce  <david@dponce.com>

	* mouse.el (mouse-drag-move-window-top): New function.
	(mouse-drag-mode-line-1): Use it.

2004-10-18  Thien-Thi Nguyen  <ttn@gnu.org>

	* info.el (Info-fontify-node): For multiline refs,
	arrange to unfontify newline and surrounding whitespace.

2004-10-17  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-arch.el (vc-arch-workfile-version): Don't burp if the patch-log
	directory is missing.

2004-10-17  John Paul Wallington  <jpw@gnu.org>

	* ibuffer.el (ibuffer-default-display-maybe-show-predicates):
	New customizable variable; whether to display buffers that match
	`ibuffer-maybe-show-predicates' by default.
	(ibuffer-maybe-show-predicates): Mention it in docstring.
	(ibuffer-display-maybe-show-predicates): New variable.
	(ibuffer-update): Prefix arg now toggles whether buffers that
	match `ibuffer-maybe-show-predicates' should be displayed.
	(ibuffer-mode): Set `ibuffer-display-maybe-show-predicates'
	locally to heed `ibuffer-default-display-maybe-show-predicates'.
	(ibuffer-redisplay-engine): Rename optional second arg to `ignore'.

2004-10-17  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el: Redo sync with Tramp 2.0.45.  Last commit did not
	work correctly.

2004-10-17  Daniel Pfeiffer  <occitan@esperanto.org>

	* buff-menu.el (Buffer-menu-revert-function): Emulate save-excursion.
	(Buffer-menu-beginning): New helper function.
	(Buffer-menu-execute): Use it.
	(Buffer-menu-select): Use it.
	(Buffer-menu-sort): Use it and also keep markers.

2004-10-17  Richard M. Stallman  <rms@gnu.org>

	* paths.el (news-directory): Rename from news-path.  Old name alias.
	(rmail-spool-directory): Use defvar.
	(sendmail-program): Use defcustom.
	(remote-shell-program): Use defcustom.
	(term-file-prefix): Use defvar.
	(abbrev-file-name): Use defvar.

	* term.el: Add maintainer.

	* subr.el (with-local-quit): Return nil if there's a quit.
	(read-passwd): Use with-local-quit.  Doc fix.

	* strokes.el (strokes-list-strokes): Don't try to delete char at eob.
	(strokes-unload-hook): Set as a variable with add-hook.

	* startup.el (fancy-splash-tail, normal-splash-screen):
	Update copyright year.

	* shadowfile.el (shadowfile-unload-hook): Set as variable w/ add-hook.

	* server.el (server-unload-hook): Set as a variable with add-hook.

	* help-at-pt.el (help-at-pt-unload-hook): Use add-hook; no defvar.

	* frame.el (special-display-popup-frame):
	Make the buffer current as its frame is created.

	* delsel.el (delsel-unload-hook): Set as a variable.

	* comint.el (comint-output-filter-functions):
	Add comint-watch-for-password-prompt.
	(comint-read-noecho): Function deleted.
	(send-invisible): Use read-passwd.

	* fringe.el (fringe-mode-initialize): New function.
	(fringe-mode): Use fringe-mode-initialize as :initialize.

2004-10-17  Kim F. Storm  <storm@cua.dk>

	* language/indian.el (indian-script-language-alist): Swap value and doc.
	(indian-font-char-index-table): Doc fix.

2004-10-16  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-hooks.el (vc-find-file-hook): Call vc-backend with absolute name.

2004-10-16  Juri Linkov  <juri@jurta.org>

	* progmodes/compile.el (compilation-start): Move let-binding of
	`process-environment' into `with-current-buffer' body.
	Reported by Matt Hodges <MPHodges@member.fsf.org>.

2004-10-16  Richard M. Stallman  <rms@gnu.org>

	* pcvs-util.el (cvs-bury-buffer):
	Don't call get-buffer-window for effect.

	* outline.el (hide-other): Call outline-up-heading with INVISIBLE-OK=t.

	* newcomment.el (comment-auto-fill-only-comments): Add autoload.

	* msb.el (msb-unload-hook): Set the variable.

	* mouse.el (mouse-yank-at-click, mouse-yank-secondary):
	Use * to err if buffer is readonly.

	* subr.el (looking-back): Return only t or nil.

	* whitespace.el (whitespace-unload-hook): Set the variable.

	* view.el (view-mode-enable): Set view-page-size and
	view-half-page-size to nil.
	(view-set-half-page-size-default): view-half-page-size = nil
	means the default.
	(View-scroll-page-forward): Use view-page-size-default.
	(View-scroll-page-backward): Likewise.
	(view-page-size, view-half-page-size): Doc fixes.

	* emacs-lisp/elp.el (elp-unload-hook): Set the variable.

	* emacs-lisp/cl.el (cl-unload-hook): Don't defvar it, just set it.

	* emacs-lisp/bytecomp.el (byte-compile-eval): Don't process
	"cl" like other files.  Instead, call byte-compile-find-cl-functions.
	(byte-compile-log-1): Bind inhibit-read-only.
	(byte-compile-warning-prefix, byte-compile-log-file): Likewise.
	(byte-compile-log-warning): Likewise.
	(byte-compile-file-form-require): Detect "cl" from the arg value.

	* progmodes/compile.el (compilation-start): Assume compilation-mode
	will make the buffer read-only.
	(compilation-mode): Take arg name-of-mode.
	(compilation-setup): Make buffer read-only.
	(compilation-handle-exit): Bind inhibit-read-only.

	* textmodes/ispell.el (ispell-command-loop): Use with-no-warnings.
	(ispell-message): Likewise.
	(ispell-show-choices): Don't call get-buffer-window uselessly.
	(ispell-init-process): Use set-process-query-on-exit-flag.

2004-10-16  Kim F. Storm  <storm@cua.dk>

	* fringe.el (fringe-bitmaps): Only initialize when defined.

	* pcvs.el (cvs-mode-view-file, cvs-mode-view-file-other-window): Add.
	(cvs-mode-find-file): Add optional `view' arg to enter view mode.

	* pcvs-defs.el (cvs-mode-map): Bind v to cvs-mode-view-file.

2004-10-15  Simon Josefsson  <jas@extundo.com>

	* net/password.el: Add.

2004-10-14  Masatake YAMATO  <jet@gyve.org>

	* progmodes/gud.el (gdb-script-beginning-of-defun): New function.
	(gdb-script-end-of-defun): New function.
	(gdb-script-mode): Use `gdb-script-beginning-of-defun' and
	`gdb-script-end-of-defun' as *-of-defun-function.

2004-10-13  Daniel Pfeiffer  <occitan@esperanto.org>

	* button.el (button-activate): Allow a marker to display as an action.

	* help-fns.el (describe-variable): Use it to make "below" a hyperlink.

	* help.el (describe-mode): Use it to make minor mode list into
	hyperlinks.

2004-10-13  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc.el (vc-annotate-display-select): Fix typo.

	* subr.el (substitute-key-definition-key): New function.
	(substitute-key-definition): Use it with map-keymap.
	(event-modifiers): Use push.
	(mouse-movement-p, with-temp-buffer): Simplify.

2004-10-12  Jay Belanger  <belanger@truman.edu>

	* calc/calc-help.el (calc-help-function-list, calc-help-variable-list):
	New variables.
	(calc-help-index-entries): New function.
	(calc-describe-function): Use `calc-help-function-list' instead of
	obarray for completion.
	(calc-describe-variable): Use `calc-help-variable-list' instead
	of obarray for completion.

2004-10-12  Richard M. Stallman  <rms@gnu.org>

	* info-look.el (info-lookup-file): Add info-file property.
	(info-lookup-symbol): Likewise.

	* info.el (info-xref): Add underlining.
	(info): Add info-file property.
	(Info-find-emacs-command-nodes): Specify case-sensitive search.

2004-10-12  Michael Albinus  <michael.albinus@gmx.de>

	Sync with Tramp 2.0.45.

	* net/tramp.el (top): Apply `def-edebug-spec' only if function is
	defined.  This is not the case for XEmacs without package "edebug".
	(tramp-set-auto-save-file-modes): Set permissions of autosaved
	remote files to the permissions of the original file.  This is not
	the case for Emacs < 21.3.50 and XEmacs < 21.5.  Add function to
	`auto-save-hook'.  Reported by Thomas Prokosch <thomas@nadev.net>.
	(tramp-perl-decode): Fix an error in Perl implementation.
	$pending must be cleared every loop.  Reported by Benjamin Place
	<benjaminplace@sprintmail.com>

	* net/tramp-smb.el (tramp-smb-advice-PC-do-completion):
	Don't activate advice during definition.  This is done later on,
	depending on test result of `substitute-in-file-name'.
	Suggested by Stefan Monnier <monnier@iro.umontreal.ca>.

2004-10-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* pcvs-parse.el (cvs-parse-commit): Fix parsing for new commit message.

	* emacs-lisp/lisp.el (mark-sexp): Preserve direction when repeating.

2004-10-12  David Ponce  <david@dponce.com>

	* recentf.el (recentf-edit-list): Update the menu when the recentf
	list has been modified.

2004-10-12  Simon Josefsson  <jas@extundo.com>

	* net/tls.el (tls-certtool-program): New variable.
	(tls-certificate-information): New function, based on
	ssl-certificate-information.

2004-10-12  Kenichi Handa  <handa@m17n.org>

	* international/mule.el (coding-system-equal): Move from mule-util.el.

	* international/mule-util.el (coding-system-equal): Move to mule.el.

2004-10-12  Kim F. Storm  <storm@cua.dk>

	* kmacro.el (kmacro-insert-counter, kmacro-add-counter): Use and
	reset kmacro-initial-counter-value if set.
	(kmacro-set-counter): Only set kmacro-counter if defining or executing
	macro.  Set kmacro-initial-counter-value otherwise.  Never set both.
	(kmacro-display): Show macro counter if non-zero.

	* subr.el (substitute-key-definition): Mention command remapping
	in doc string.

2004-10-11  Jay Belanger  <belanger@truman.edu>

	* calc/calc-misc.el (calc-info-goto-node): New function.
	(calc-tutorial, calc-info-summary): Go to appropriate Calc info
	node in one step.
	(calc-describe-copying, calc-describe-distribution)
	(calc-describe-thing, calc-describe-no-warranty, calc-describe-key):
	Go to appropriate info node in one step.

2004-10-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* pcvs-defs.el (pcl-cvs-load-hook): Remove unused var.

	* font-lock.el (font-lock-apply-highlight): Fix last change.

2004-10-11  Simon Josefsson  <jas@extundo.com>

	* mail/smtpmail.el (smtpmail-open-stream): Look for
	starttls-gnutls-program instead of starttls-program iff
	starttls-use-gnutls is non-nil.
	(smtpmail-open-stream): Don't overwrite user settings of
	starttls-extra-arguments and starttls-extra-args.

2004-10-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* comint.el (comint-mouse-insert-input): Remove.
	(comint-insert-input): Make it work for mouse bindings.
	(comint-mode-map): Move defs into the declaration.
	(comint-output-filter): Typo.

	* diff-mode.el (diff-current-defun): Fix 2004-06-13's change.

2004-10-10  Kai Grossjohann  <kai.grossjohann@gmx.net>

	* net/ange-ftp.el (ange-ftp-remote-shell): Remove variable.
	(ange-ftp-call-chmod): Reference remote-shell-program instead of
	ange-ftp-remote-shell.

2004-10-10  Andreas Schwab  <schwab@suse.de>

	* emacs-lisp/byte-opt.el (byte-optimize-backward-word): Optimize
	`(backward-word)' to `(forward-word -1)', not `(forward-char -1)'.
	Reported by <sri@asu.edu>.

2004-10-10  Benjamin Rutt  <brutt@bloomington.in.us>

	* vc.el (vc-annotate-mode): Remove variable.
	(vc-annotate-display-select): Only call vc-annotate-mode
	if we're not in that mode already.

2004-10-09  Stefan Monnier  <monnier@iro.umontreal.ca>

	* imenu.el (imenu--completion-buffer): Don't return t for rescan.
	(imenu-choose-buffer-index): Check here for rescan instead.

	* font-lock.el (font-lock-apply-highlight): Explicitly check the case
	where the face expression evals to nil.

	* textmodes/tex-mode.el (tex-font-lock-append-prop): New fun.
	(tex-font-lock-keywords-2): Use it.
	(tex-font-lock-syntactic-keywords): Fix the `verbatim' treatment.

	* emacs-lisp/lisp-mode.el (lisp-fill-paragraph): Fix backslashes.

2004-10-09  Kim F. Storm  <storm@cua.dk>

	* subr.el (progress-reporter-update): Define before first usage.
	(make-progress-reporter): Doc fix.

2004-10-09  Luc Teirlinck  <teirllm@auburn.edu>

	* textmodes/paragraphs.el (sentence-end-double-space)
	(sentence-end-without-period, sentence-end-without-space)
	(sentence-end): Doc fixes.

2004-10-08  Peter Seibel  <peter@javamonkey.com>  (tiny change)

	* emacs-lisp/lisp-mode.el (lisp-fill-paragraph):
	Change paragraph-start regexp so we don't fill code starting with #'(.

2004-10-08  Sebastien Kirche  <seki@seki.fr>  (tiny change)

	* mail/mail-extr.el (mail-extr-ignore-realname-equals-mailbox-name):
	New defcustom.
	(extract-address-components): Use it.

2004-10-08  Paul Pogonyshev  <pogonyshev@gmx.net>

	* subr.el (make-progress-reporter, progress-reporter-update)
	(progress-reporter-force-update, progress-reporter-do-update)
	(progress-reporter-done): New functions.

	* tar-mode.el (tar-summarize-buffer): Use progress reporter.

	* progmodes/etags.el (etags-tags-completion-table): Use progress
	reporter.
	(etags-tags-apropos): Likewise.

2004-10-08  Alan Mackenzie  <acm@muc.de>

	* isearch.el (isearch-yank-line): C-y yanks to next EOL, not end
	of current line.

2004-10-08  Masatake YAMATO  <jet@gyve.org>

	* server.el (server-process-filter): Wrap `process-send-region'
	by `condition-case' to guard the case when the pipe to PROC is closed.

2004-10-07  Mark A. Hershberger  <mah@everybody.org>

	* xml.el (xml-substitute-special): Limit handling of external entities.

2004-10-06  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-ann3): (Re-)initialize gdb-input-queue.

2004-10-06  John Paul Wallington  <jpw@gnu.org>

	* xml.el (xml-parse-dtd): Fix `error' call.

2004-10-05  Mark A. Hershberger  <mah@everybody.org>

	* xml.el (xml-substitute-special): Return a single string instead
	of a list of strings if an entity substitution is made.

2004-10-05  Ulf Jasper  <ulf.jasper@web.de>

	* calendar/icalendar.el: New file.

2004-10-05  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-done): Set mark after running hook.
	Reported by Drew Adams <drew.adams@oracle.com>.

	* info.el (Info-history, Info-toc): Fix Info headers.
	(Info-toc): Narrow buffer before Info-fontify-node.
	(Info-build-toc): Don't check for special Info file names.
	Set main-file to nil if Info-find-file returns a symbol.

2004-10-05  Emilio C. Lopes  <eclig@gmx.net>

	* calendar/calendar.el (calendar-goto-iso-week): Add autoload.
	(calendar-mode-map): Add binding for `calendar-goto-iso-week'.
	* calendar/cal-menu.el (calendar-mode-map): Ditto.

2004-10-05  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* calendar/cal-iso.el (calendar-iso-read-args): New function,
	for old interactive spec from calendar-goto-iso-date.
	(calendar-goto-iso-date): Use it.
	(calendar-goto-iso-week): New function.  Suggested by Emilio
	C. Lopes <eclig@gmx.net>.

2004-10-04  Luc Teirlinck  <teirllm@auburn.edu>

	* textmodes/enriched.el (enriched-mode-map): Give `set-left-margin' and
	`set-right-margin' bindings that follow the minor mode conventions.

2004-10-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/tex-mode.el (tex-dvi-view-command): Use `yap' on w32.
	(tex-font-lock-keywords-1): Add url and nolinkurl for args with `_'.
	(latex-block-args-alist): Add minipage and picture.
	(latex-block-body-alist): Use reftex-label if enabled.
	(latex-insert-block): Don't insert a \n if not necessary.
	(tex-compile-commands): Make sure dvips doesn't send to printer.
	(tex-compile-default): Handle the case where no executable is found.
	(latex-noindent-environments): New var.
	(latex-find-indent): Use it.  Take an empty line as an arg-breaker.
	If tex-indent-allhanging is non-nil, make sure we only align for macros
	at beginning of line.

2004-10-03  Daniel Pfeiffer  <occitan@esperanto.org>

	* newcomment.el (comment-beginning): Doc fix and don't choke on
	unset `comment-end-skip' when at beginning of comment.

2004-10-02  Dan Nicolaescu  <dann@ics.uci.edu>

	* term.el (term-adjust-current-row-cache): Don't allow the current
	row to become negative.
	(term-emulate-terminal): Fix insert mode.  Handle tab insertion at
	the end of the line.  Fix scroll down.  Add comments.
	(term-handle-ansi-escape): Don't exceed terminal width when moving
	right.
	(term-scroll-region): Move the cursor after setting the scroll region.

2004-10-01  Luc Teirlinck  <teirllm@auburn.edu>

	* indent.el (set-left-margin, set-right-margin): Rename `lm' arg
	to `width' for consistency with docstring.  Doc fix.

2004-10-01  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-langs.el: Load cl here since cc-defs doesn't do it.
	This is necessary for derived modes.

2004-09-30  Kim F. Storm  <storm@cua.dk>

	* kmacro.el (kmacro-lambda-form, kmacro-extract-lambda): Add.
	(kmacro-bind-to-key, kmacro-name-last-macro): Use kmacro-lambda-form.

	* edmacro.el: Require kmacro to use the new kmacro-lambda-form and
	kmacro-extract-lambda functions.
	(edit-kbd-macro): Handle kmacro lambda forms.
	Include counter and counter format in edit buffer.
	(edmacro-finish-edit): Get counter and format from edit buffer and
	update kmacro bindings when found.

2004-09-29  Luc Teirlinck  <teirllm@auburn.edu>

	* textmodes/paragraphs.el (forward-paragraph):
	Avoid args-out-of-range error when point winds up at the beginning of
	the buffer and hard newlines are enabled.

	* newcomment.el (comment-multi-line): Doc fix.

2004-09-29  Stefan Monnier  <monnier@iro.umontreal.ca>

	* diff-mode.el (diff-file-header-re): Tighten up regexp a tiny bit.
	(diff-fixup-modifs): Catch unified-diff file-headers.

2004-09-29  Kim F. Storm  <storm@cua.dk>

	* progmodes/gdb-ui.el (breakpoint): Define as fringe bitmap.
	(gdb-mouse-toggle-breakpoint): Fix fringe-bitmaps-at-pos usage.
	(gdb-put-breakpoint-icon): Use breakpoint bitmap.

	* fringe.el (fringe-bitmap-p): New macro.
	(fringe-bitmaps): Add standard fringe bitmaps on load.

2004-09-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* dired.el (dired-view-command-alist): Use more efficient regexps.
	Remove dubious arguments.
	(dired-align-file): New function.
	(dired-insert-directory): Use it.
	(dired-move-to-end-of-filename): Make the " -> " search more specific.
	(dired-buffers-for-dir): Remove unused var `pattern'.

2004-09-28  Matthew Mundell  <matt@mundell.ukfsn.org>

	* calendar/diary-lib.el (list-diary-entries): Save diary buffer
	from diary display excursion.  Store diary buffer's point for
	`simple-diary-display'.
	(simple-diary-display): Set window point and start when
	displaying buffer, to preserve point.

2004-09-27  Luc Teirlinck  <teirllm@auburn.edu>

	* textmodes/enriched.el (enriched-translations): Replace defconst
	with defvar.

2004-09-26  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* printing.el: Doc fix.
	(pr-version): New version number (6.8.1).
	(pr-ps-file-using-ghostscript): Use make-temp-file instead of
	make-temp-name.
	(pr-delete-file): Check if file exists before deleting it.
	Reported by Lennart Borgman <lennart.borgman.073@student.lu.se>.

2004-09-26  Stefan Monnier  <monnier@iro.umontreal.ca>

	* term.el (term-display-table): New variable.
	(term-mode): Use it.
	(term-exec-1): Set the coding system to binary.
	(term-emulate-terminal): Decode the string before inserting it.

2004-09-26  Dan Nicolaescu  <dann@ics.uci.edu>

	* term.el (term-ansi-at-eval-string, term-ansi-default-fg)
	(term-ansi-default-bg, term-ansi-current-temp): Delete unused vars.
	(map): Bind S-prior, S-next and S-insert.
	(term-mode): Set `indent-tabs-mode' to nil.
	(term-paste): New function to be bound to S-insert.
	(term-send-del, term-send-backspace): Change the strings sent.
	(term-termcap-format): Synchronize with etc/e/eterm.ti.
	(term-handle-colors-array): Fix handling of underline and reverse.
	(term-handle-ansi-escape): Do not handle smcup/rmcup.  Add comments.
	(term-erase-in-line): Fix comparison.
	(term-emulate-terminal): Fix line wrap handling.
	(term-start-output-log): Rename from `term-set-output-log'.
	(term-stop-output-log): Rename from `term-stop-photo'.
	(term-switch-to-alternate-sub-buffer): Comment out, unused.

2004-09-25  Stefan Monnier  <monnier@iro.umontreal.ca>

	* dired.el (dired-move-to-filename): Don't output a message if
	raise-error is non-nil.  Fix return position and value.

	* files.el (insert-directory): Obey --dired even with symlinks.

2004-09-25  Lars Hansen  <larsh@math.ku.dk>

	* ls-lisp.el (ls-lisp-format): Mark file names with property
	dired-filename.

2004-09-25  Kim F. Storm  <storm@cua.dk>

	* ido.el (ido-max-directory-size): New defcustom.
	(ido-decorations): Add "too big" element.
	(ido-directory-too-big): New dynamic var.
	(ido-may-cache-directory): Don't cache big directories.
	(ido-directory-too-big-p): New defun.
	(ido-set-current-directory): Update ido-directory-too-big.
	(ido-read-internal): Make empty ido-cur-item if too-big.
	(ido-buffer-internal): Use ido-read-internal directly instead of
	ido-read-buffer.
	(ido-file-internal): Init ido-directory-too-big.
	(ido-complete): <TAB> If ido-directory-too-big is set, clear it,
	and redo completion with full list.
	(ido-toggle-ignore): <C-a> If ido-directory-too-big is set, clear
	it, and show completions.
	(ido-all-completions): Let bind ido-directory-too-big to nil.
	(ido-exhibit): Handle ido-directory-too-big.
	(ido-read-buffer): Handle fallback to read-buffer.
	Init ido-directory-too-big.
	(ido-read-file-name, ido-read-directory-name, ido-completing-read):
	Init ido-directory-too-big.

2004-09-24  Luc Teirlinck  <teirllm@auburn.edu>

	* subr.el (delay-mode-hooks): Doc fix.

2004-09-23  Luc Teirlinck  <teirllm@auburn.edu>

	* textmodes/enriched.el
	(enriched-default-text-properties-local-flag): New variable.
	(enriched-mode): Make sure that enabling and disabling the mode is
	a no-op.  Doc fix.

2004-09-23  H,Ae(Bkon Malmedal  <hmalmedal@yahoo.no>  (tiny change)

	* calendar/holidays.el (holiday-advent): Report on a specified day
	offset from advent, not just advent.
	(holiday-easter-etc): Report on one specified day offset from
	easter, not all easter holidays.  Various Easter holidays moved to
	`christian-holidays' variable in calendar.el.
	* calendar/calendar.el (christian-holidays): Adapt for new
	behavior of `holiday-advent' and `holiday-easter-etc' functions.

2004-09-23  Kim F. Storm  <storm@cua.dk>

	* image.el (insert-sliced-image): Add doc string.

	* ido.el (ido-choice-list): New dynamic var for `list' context.
	(ido-context-switch-command): New dynamic var.
	(ido-define-mode-map): Generalize switch between file/buffer contexts.
	(ido-read-internal): Handle new `list' context.
	Handle insert-buffer and insert-file ido-exit values.
	(ido-buffer-internal): New arg switch-cmd.  Use it to setup
	ido-context-switch-command.  Handle insert-file ido-exit value.
	(ido-read-buffer): Set ido-context-switch-command to 'ignore
	unless it is already bound by caller.
	(ido-file-internal): New arg switch-cmd.  Use it to setup
	ido-context-switch-command.  Handle insert-buffer ido-exit value.
	(ido-enter-insert-buffer, ido-enter-insert-file): New commands
	used for context switching.
	(ido-all-completions): Handle new `list' context.
	(ido-make-choice-list): Return choices for `list' context.
	(ido-find-file-in-dir, ido-display-file, ido-write-file)
	(ido-display-buffer, ido-kill-buffer): Disable context switching.
	(ido-insert-buffer, ido-insert-file): Setup context switching.
	(ido-exhibit): Handle `list' context.
	(ido-read-file-name): Disable context switching.  Handle fallback.
	(ido-read-directory-name): Disable context switching.
	(ido-completing-read): New defun like completing-read.  Setup and
	use new `list' context.

2004-09-20  Jesper Harder  <harder@ifa.au.dk>

	* progmodes/tcl.el (inferior-tcl): Use pop-to-buffer.

2004-09-21  Jay Belanger  <belanger@truman.edu>

	* calc/calc-graph.el (calc-graph-add-curve): Move the call to
	`calc-graph-set-styles' so the gnuplot buffer will appear in a
	separate window.

2004-09-21  Luc Teirlinck  <teirllm@auburn.edu>

	* subr.el (after-change-major-mode-hook): Doc fix.

2004-09-21  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* printing.el: Doc fix.  Add a new tip about the use of gsprint instead
	of ghostscript for monochrome PostScript file in Windows.

2004-09-21  Kenichi Handa  <handa@m17n.org>

	* descr-text.el (describe-char): Checking of quail activation fixed.

2004-09-21  Jay Belanger  <belanger@truman.edu>

	* calc/calc.el (calc-mode-var-list): Remove unnecessary quotes.

2004-09-20  Luc Teirlinck  <teirllm@auburn.edu>

	* subr.el (run-mode-hooks): Run `after-change-major-mode-hook'
	after the mode hooks instead of before.  Doc fix.

2004-09-20  Jason Rumney  <jasonr@gnu.org>

	* startup.el (command-line) [windows-nt]: Try .emacs first, then
	_emacs, but revert to .emacs if neither exists in home directory.

2004-09-20  John Paul Wallington  <jpw@gnu.org>

	* bindings.el (completion-ignored-extensions): Add .dfsl.

2004-09-20  Richard M. Stallman  <rms@gnu.org>

	* bindings.el (scroll-left): Make it disabled.

	* files.el (enable-local-eval): Doc fix.

	* indent.el (move-to-left-margin): Special case for minibuffer.

	* term.el (term-emulate-terminal): Turn off undo for output.
	Use with-current-buffer and save-selected-window.

	* eshell/esh-ext.el (eshell-explicit-command-char): Doc fix.

	* progmodes/make-mode.el (makefile-fill-paragraph):
	Don't insist on spaces when looking for comments.  # is enough.

	* files.el (hack-local-variables): Copy the variables list
	to another buffer, strip prefixes and suffixes there, then read.
	(enable-local-eval): Doc fix.
	(ignored-local-variables): Initialize to nil.
	(risky-local-variable-p): Don't check ignored-local-variables here.
	(hack-one-local-variable): Ignore var if in ignored-local-variables.

2004-09-20  Dan Nicolaescu  <dann@ics.uci.edu>

	* progmodes/sh-script.el (sh-mode-default-syntax-table): Set syntax
	of = to "." (punctuation).

2004-09-19  Stefan Monnier  <monnier@iro.umontreal.ca>

	* subr.el (event-basic-type): Fix mask (extend to 22bits).

2004-09-18  Luc Teirlinck  <teirllm@auburn.edu>

	* textmodes/enriched.el (enriched-rerun-flag): New variable.
	(enriched-before-change-major-mode): New function.
	Add it to `change-major-mode-hook'.
	(enriched-after-change-major-mode): New function.
	Add it to `after-change-major-mode-hook'.
	(enriched-mode): Make it work correctly if called from
	`after-change-major-mode-hook'.
	No longer set `indent-line-function'.

	* simple.el (fundamental-mode): Run `after-change-major-mode-hook'.

	* subr.el (after-change-major-mode-hook): New variable.
	(run-mode-hooks): Implement it.

2004-09-18  Stefan Monnier  <monnier@iro.umontreal.ca>

	* battery.el (battery-linux-proc-apm): Use string-to-number.
	(battery-linux-proc-acpi): Ignore all hidden files in the battery dir.
	Use dolist (and less indentation).  Use erase-buffer.
	Pre-initialize `design-capacity', `warn', and `low'.
	(battery-format): Use replace-regexp-in-string.

2004-09-18  Ralph Schleicher  <rs@nunatak.allgaeu.org>

	* battery.el: Delete superfluous empty lines.
	(battery-linux-proc-acpi): Attempt to gather information from all
	battery subdirectories regardless of their file name.
	(battery-linux-proc-apm): Replace all occurrences of
	battery-hex-to-int-2 with string-to-int (base 16).
	(battery-hex-to-int-2, battery-hex-to-int): Delete functions.
	(battery-hex-map): Delete variable.

2004-09-18  John Paul Wallington  <jpw@gnu.org>

	* calc/calc-units.el (calc-quick-units): Fix overzealous
	s/or/unless/.

2004-09-17  Jay Belanger  <belanger@truman.edu>

	* calc/calc.el (calc-mode-var-list): Fix the value of
	`calc-matrix-brackets'.

2004-09-17  Romain Francoise  <romain@orebokech.com>

	* ibuf-ext.el (define-ibuffer-filter filename):
	Expand dired-directory since buffer-file-name is absolute.

2004-09-17  Dan Nicolaescu  <dann@ics.uci.edu>

	* ediff-init.el (ediff-current-diff-face-A)
	(ediff-current-diff-face-B, ediff-current-diff-face-C)
	(ediff-current-diff-face-Ancestor)
	(ediff-fine-diff-face-A, ediff-fine-diff-face-B)
	(ediff-fine-diff-face-C, ediff-fine-diff-face-Ancestor)
	(ediff-even-diff-face-A, ediff-even-diff-face-B)
	(ediff-even-diff-face-C, ediff-even-diff-face-Ancestor)
	(ediff-odd-diff-face-A, ediff-odd-diff-face-B)
	(ediff-odd-diff-face-C, ediff-odd-diff-face-Ancestor):
	Use min-colors.

	* term.el (term-down): Perform vertical motion if DOWN is negative.
	(term-exec-1): Set both TERMCAP and TERMINFO unconditionally.
	(term-termcap-format): Synchronize with the eterm terminfo entry
	in etc/e/eterm.ti.
	(term-handle-colors-array): If the current foreground or
	background are zero (i.e. unspecified), use the foreground and
	background of the default face for reverse video.
	(term-ansi-at-eval-string, term-ansi-default-fg)
	(term-ansi-default-bg, term-ansi-current-temp): Delete unused variable.
	(term-mem): Delete unused function.
	(term-protocol-version): Increment.
	(term-current-face): Set to default.

2004-09-15  Jay Belanger  <belanger@truman.edu>

	* calc/calc.el (calc-mode-var-list): Define this variable.
	(calc-always-load-extensions, calc-line-numbering)
	(calc-line-breaking, calc-display-just, calc-display-origin)
	(calc-number-radix, calc-leading-zeros, calc-group-digits)
	(calc-group-char, calc-point-char, calc-frac-format)
	(calc-prefer-frac, calc-hms-format, calc-date-format)
	(calc-float-format, calc-full-float-format, calc-complex-format)
	(calc-complex-mode, calc-infinite-mode, calc-display-strings)
	(calc-matrix-just, calc-break-vectors, calc-full-vectors)
	(calc-full-trail-vectors, calc-vector-commas, calc-vector-brackets)
	(calc-matrix-brackets, calc-language, calc-language-option)
	(calc-left-label, calc-right-label, calc-word-size)
	(calc-previous-modulo, calc-simplify-mode, calc-auto-recompute)
	(calc-display-raw, calc-internal-prec, calc-angle-mode)
	(calc-algebraic-mode, calc-incomplete-algebraic-mode)
	(calc-symbolic-mode, calc-matrix-mode, calc-shift-prefix)
	(calc-window-height, calc-display-trail, calc-show-selections)
	(calc-use-selections, calc-assoc-selections)
	(calc-display-working-message, calc-auto-why, calc-timing)
	(calc-mode-save-mode, calc-standard-date-formats)
	(calc-autorange-units, calc-was-keypad-mode, calc-full-mode)
	(calc-user-parse-tables, calc-gnuplot-default-device)
	(calc-gnuplot-default-output, calc-gnuplot-print-device)
	(calc-gnuplot-print-output, calc-gnuplot-geometry)
	(calc-graph-default-resolution, calc-graph-default-resolution-3d)
	(calc-invocation-macro, calc-show-banner): Give these values as
	part of `calc-mode-var-list's initialization after the variables
	are declared with defvar.
	(calc-bug-address): Change email address to send bug reports to.
	Change the maintainer address at the top.
	(calc-mode): Compare `calc-settings-file' to `user-init-file' rather
	than "\\.emacs" to determine if it is the user-init-file.

	* calc/calc-embed.el (calc-embedded-set-modes): Use
	`calc-mode-var-list' correctly.

2004-09-15  Thien-Thi Nguyen  <ttn@gnu.org>

	* vc.el (annotate-time): Document point handling.
	(vc-annotate-display-autoscale): Doc fix.

2004-09-15  Miles Bader  <miles@gnu.org>

	* generic.el (generic-make-keywords-list): Use symbol rather than
	word anchors in regexp.

2004-09-14  Sean O'Rourke  <sorourke@cs.ucsd.edu>

	* ibuf-ext.el (define-ibuffer-filter filename): If buffer has
	no file name consider `dired-directory'.

2004-09-14  Kim F. Storm  <storm@cua.dk>

	* faces.el (cursor): Add face-no-inherit property.  Doc fix.

2004-09-14  Simon Josefsson  <jas@extundo.com>

	* files.el (auto-mode-alist): Map .soa and .zone to dns-mode.

	* textmodes/dns-mode.el: Add.

2004-09-13  Stefan Monnier  <monnier@iro.umontreal.ca>

	* novice.el (disabled-command-hook): Use shorthand for obsolescence.
	(disabled-command-function): Make the ?\  char more obvious.

	* vc-arch.el (vc-arch-root, vc-arch-registered):
	* vc-mcvs.el (vc-mcvs-root, vc-mcvs-registered): Use vc-find-root.

2004-09-13  Hovav Shacham  <hovav@sha1.stanford.edu>

	* windmove.el (windmove-frame-edges): Report coordinates of
	outside edges of frame, not inside edges.
	(windmove-coordinates-of-position): Convert into wrapper to new
	function `windmove-coordinates-of-window-position';
	`compute-motion' always applies to selected window.
	(windmove-coordinates-of-position): Update documentation to refer
	to Emacs 21 Lisp Reference Manual.
	(windmove-find-other-window): Fix off-by-one errors for max x,y.

2004-09-13  Kim F. Storm  <storm@cua.dk>

	* isearch.el (isearch-resume-in-command-history): Rename from
	isearch-resume-enabled and change default to nil.

2004-09-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-hooks.el (vc-ignore-dir-regexp): New var.
	(vc-registered): Use it.
	(vc-find-root): New fun.

	* emacs-lisp/checkdoc.el (checkdoc-this-string-valid-engine):
	Don't tell to use \\{...} when it's already done.

	* textmodes/bibtex.el (bibtex-generate-url-list): Change format.
	Provide a sample complex default.
	(bibtex-url, bibtex-font-lock-url): Adapt to new format.
	(bibtex-entry): Use mapc.

2004-09-12  Kim F. Storm  <storm@cua.dk>

	* kmacro.el (kmacro-step-edit-prompt): Add "%s" format to message.

	* emulation/cua-rect.el (cua--rectangle-operation): Let bind
	inhibit-field-text-motion to t so rectangles work in comint buffers.

	* simple.el (choose-completion-string): Set buffer before running
	choose-completion-string-functions hook so it can be buffer-local.

2004-09-12  Daniel Pfeiffer  <occitan@esperanto.org>

	* progmodes/compile.el (compilation-start): Parse command to see
	if it starts with a cd, and if so perform it for the *compilation*
	buffer.  Change the header to reflect this.

2004-09-11  Kim F. Storm  <storm@cua.dk>

	* ido.el (ido-enable-dot-prefix): Doc fix.
	(ido-enable-dot-prefix): New defcustom.
	(ido-set-matches1): Use it.

2004-09-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/bibtex.el (bibtex-mark-active)
	(bibtex-run-with-idle-timer): Move the `if' inside the defun.

2004-09-10  Roland Winkler  <Roland.Winkler@physik.uni-erlangen.de>

	* textmodes/bibtex.el (bibtex-autokey-titleword-ignore): Regexp is
	used in a case insensitive environment.
	(bibtex-mode-map): Rearrange order of menus.
	(bibtex-quoted-string-re): Obsolete.
	(bibtex-complete-key-cleanup): Variable replaced by new function.
	(bibtex-font-lock-keywords): Use backquotes.
	(bibtex-font-lock-url-regexp): New internal variable.
	(bibtex-name-in-field): New optional arg remove-opt-alt to remove
	"OPT" and "ALT".
	(bibtex-insert-current-kill, bibtex-make-field)
	(bibtex-prepare-new-entry, bibtex-yank-pop, bibtex-String): Use unless.
	(bibtex-parse-field-text): Simplify.
	(bibtex-string=): New helper function.
	(bibtex-member-of-regexp): Merge with bibtex-autokey-get-title.
	(bibtex-map-entries): Use bibtex-string=.
	(bibtex-search-entry): Use not.
	(bibtex-enclosing-field): Fix docstring.
	(bibtex-assoc-regexp): Obsolete.
	(bibtex-format-entry): Use assoc-string and bibtex-string=.
	(bibtex-autokey-get-names): Handle empty name field.
	(bibtex-parse-strings): Use assoc-string and unless.
	(bibtex-complete-string-cleanup): Expansion list is passed as an arg.
	Use assoc-string.
	(bibtex-pop): Simplify.
	(bibtex-mode): Set font-lock-extra-managed-props.
	(bibtex-entry-update): Use assoc-string.
	(bibtex-parse-entry): Remove "OPT" and "ALT" from FIELD.
	(bibtex-autofill-entry): Use bibtex-string=.
	(bibtex-print-help-message): Simplify.
	(bibtex-find-entry): New optional arg START.
	(bibtex-validate): Use bibtex-string= and assoc-string.
	Do not call obsolete function compilation-parse-errors.
	(bibtex-remove-delimiters): Only remove delimiters if present.
	(bibtex-copy-entry-as-kill): Add docstring.
	(bibtex-clean-entry): Use bibtex-string=.  Handle empty keys.
	Detect duplicate keys if bibtex-maintain-sorted-entries is nil.
	(bibtex-complete): Use bibtex-predefined-month-strings,
	bibtex-string=, and new function bibtex-complete-key-cleanup.
	(bibtex-generate-url-list): New variable.
	(bibtex-url): New command bound to C-c C-l and mouse-2.
	(bibtex-url-map): New local keymap for bibtex-url-mouse.
	(bibtex-font-lock-url): New function.

2004-09-09  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/grep.el (grep-mode): Remove unnecessary autoload.

2004-09-09  Kim F. Storm  <storm@cua.dk>

	* kmacro.el (kmacro-bind-to-key): Associate dedicated macro
	counter and format with binding.
	(kmacro-name-last-macro): New defun.  Like name-last-kbd-macro, but
	the declared macro uses own macro counter and format.  Give symbol
	kmacro property.
	(kmacro-keymap): Bind kmacro-name-last-macro to n.
	(kmacro-start-macro, kmacro-end-macro, kmacro-call-macro)
	(kmacro-end-and-call-macro): Doc fix.

2004-09-09  Lars Hansen  <larsh@math.ku.dk>

	* desktop.el (desktop-clear-preserve-buffers):
	Remove make-obsolete-variable.

2004-09-08  Richard M. Stallman  <rms@gnu.org>

	* buff-menu.el (list-buffers-noselect): Call format-mode-line
	with the buffer as argument.

2004-09-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-arch.el (vc-arch-state): Fix parsing for `names' method.

2004-09-08  Juri Linkov  <juri@jurta.org>

	* replace.el (perform-replace): Use `query-replace-descr'.

	* cus-start.el (history-delete-duplicates): Specify customization.

	* diff-mode.el (diff-mode-map):
	* progmodes/compile.el (compilation-mode-map):
	* progmodes/grep.el (grep-mode-map):
	* replace.el (occur-mode-map): Rename `next-error-follow-mode'
	to `next-error-follow-minor-mode'.

2004-09-08  YAMAMOTO Mitsuharu  <mituharu@math.s.chiba-u.ac.jp>

	* isearch.el (isearch-lazy-highlight-update): Take into account
	the case of zero-length match at the search bound.

2004-09-08  Kim F. Storm  <storm@cua.dk>

	* emulation/cua-rect.el (cua--highlight-rectangle): Fix last
	change.  Use zero width overlays when necessary.

2004-09-08  Thien-Thi Nguyen  <ttn@gnu.org>

	* subr.el (split-string): Docfix.

2004-09-08  Thien-Thi Nguyen  <ttn@gnu.org>

	* emacs-lisp/bytecomp.el (byte-compile-generate-call-tree): Doc fix.
	(display-call-tree): Ensure newline after caller/calls blocks.

2004-09-08  Thien-Thi Nguyen  <ttn@gnu.org>

	* startup.el (command-line-1): Make option
	--directory/-L modify `load-path' straight away.

2004-09-08  Thien-Thi Nguyen  <ttn@gnu.org>

	* progmodes/grep.el (grep-mode): Use normal autoload cookie.

2004-09-08  Thien-Thi Nguyen  <ttn@gnu.org>

	* emacs-lisp/autoload.el (make-autoload):
	Handle `define-compilation-mode'.

	* emacs-lisp/lisp-mode.el (define-compilation-mode):
	Specify `doc-string-elt' property.

2004-09-08  Thien-Thi Nguyen  <ttn@gnu.org>

	* bs.el (bs-mode): Doc fix.

2004-09-08  Thien-Thi Nguyen  <ttn@gnu.org>

	* info.el (Info-insert-dir): Fix temp buffer leak bug.

2004-09-08  Thien-Thi Nguyen  <ttn@gnu.org>

	* play/blackbox.el (bb-trace-ray): Avoid double tracing.

2004-09-08  Kenichi Handa  <handa@m17n.org>

	* ps-mule.el: Fix old function calls (ps-mule-chars-in-string ->
	length, ps-mule-string-char -> aref, ps-mule-next-index -> 1+,
	ps-mule-next-point -> 1+).

	* composite.el (encode-composition-rule): Add autoload cookie.

2004-09-07  Luc Teirlinck  <teirllm@auburn.edu>

	* format.el (buffer-auto-save-file-format): Make it permanent local.

2004-09-07  Kim F. Storm  <storm@cua.dk>

	* emacs-lisp/authors.el (authors-aliases): Add more aliases.
	(authors-fixed-entries): Fix typo.
	(authors-canonical-author-name): Compact multiple spaces.
	Ignore trivial names (e.g. only first name).

	* term.el (term-window-width): Only use full window width on
	window system if overflow-newline-into-fringe is enabled.
	(term-mode): Don't disable overflow-newline-into-fringe.

2004-09-07  Stefan Monnier  <monnier@iro.umontreal.ca>

	* term/xterm.el (function-key-map): Add bindings for C- and S- cursor
	motion as seen on my Mac OS X xterms.

	* newcomment.el (uncomment-region-default, comment-region-default):
	New functions extracted from uncomment-region and comment-region.
	(comment-region, comment-region-function, uncomment-region)
	(uncomment-region-function): Use them.

	* pcvs-util.el (cvs-string-prefix-p): Use compare-strings.

	* pcvs-info.el (cvs-states): Allow `ignore' on NEED-UPDATE.
	It's not crucial but can make sense at times.

	* vc-arch.el (vc-arch-workfile-version): Handle the special case before
	the first commit.

	* vc.el (vc-buffer-context, vc-restore-buffer-context):
	Disable obsolete code.

2004-09-07  Juri Linkov  <juri@jurta.org>

	* progmodes/grep.el (grep-highlight-matches): Change default from
	`t' to `auto-detect', and type from `boolean' to `choice'.  Doc fix.
	(grep-compute-defaults): Set `grep-highlight-matches' to `t'
	if grep option `--color' is available, or to `nil' otherwise.
	(grep-process-setup): Call `grep-compute-defaults' if
	`grep-highlight-matches' is not computed.  Set env-vars only
	if `grep-highlight-matches' is `t'.
	(grep-use-null-device): Remove redundant type `boolean' (`choice'
	is already defined).

	* progmodes/compile.el (compilation-start): Use copy of
	`process-environment' created by `copy-sequence' to not
	modify env-vars in the global `process-environment'.

2004-09-06  Eli Zaretskii  <eliz@gnu.org>

	* simple.el (next-error-follow-minor-mode): Fix last change.

2004-09-05  Luc Teirlinck  <teirllm@auburn.edu>

	* textmodes/paragraphs.el (use-hard-newlines): Make it into a
	permanent local.

2004-09-04  Richard M. Stallman  <rms@gnu.org>

	* isearch.el (isearch-lazy-highlight-new-loop): Don't invoke
	highlighting if the search string is empty.

2004-09-04  Luc Teirlinck  <teirllm@auburn.edu>

	* facemenu.el (facemenu-active-faces): Change condition of inner
	`while' loop to also check the first two elements of `face-atts'
	and `mask-atts'.

2004-09-04  John Paul Wallington  <jpw@gnu.org>

	* thumbs.el (thumbs-view-image-mode-map): Fix command name typo.
	(thumbs-view-image-mode): Make buffer read-only.

2004-09-04  Christopher J. Madsen  <cjm@pobox.com>

	* textmodes/ispell.el (ispell-really-aspell): New defvar.
	(ispell-check-version): Set it.
	(ispell-send-replacement): New function.
	(ispell-process-line): Call ispell-send-replacement.

2004-09-04  Matt Hodges  <matt@stchem.bham.ac.uk>  (tiny change)

	* eshell/em-pred.el (eshell-predicate-help-string): Doc fix.
	Support choosing seconds with "s".

2004-09-04  Jari Aalto  <jari.aalto@poboxes.com>

	* terminal.el (te-escape): Show `?' in prompt for help key.

2004-09-04  Emilio C. Lopes  <eclig@gmx.net>

	* emacs-lisp/lisp.el (kill-backward-up-list): New function.

2004-09-04  Dan Nicolaescu  <dann@ics.uci.edu>

	* simple.el (next-error-follow-minor-mode)
	(next-error-follow-mode-post-command-hook): New functions.
	(next-error-follow-last-line): New defvar.

	* diff-mode.el (diff-mode-map): Bind next-error-follow-mode.
	* progmodes/compile.el (compilation-mode-map): Likewise.
	* progmodes/grep.el (grep-mode-map): Likewise.
	* replace.el (occur-mode-map): Likewise.

	* newcomment.el (uncomment-region): Bind comment-use-global-state
	to nil.

2004-09-03  Luc Teirlinck  <teirllm@auburn.edu>

	* autorevert.el (auto-revert-handler): Bind `buffer-read-only'
	locally around the call to `revert-buffer'.

2004-09-03  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-toggle-regexp): Set `isearch-success' and
	`isearch-adjusted' to `t'.
	(isearch-toggle-case-fold): Set `isearch-success' to `t'.
	(isearch-message-prefix): Add "pending" for isearch-adjusted.
	(isearch-other-meta-char): Restore isearch-point unconditionally.
	(isearch-query-replace): Add new arg `regexp-flag' and use it.
	Set point to start of match if region is not active in transient
	mark mode (to include the current match to region boundaries).
	Push the search string to `query-replace-from-history-variable'.
	Add prompt "Query replace regexp" for isearch-regexp.
	Add region beginning/end as last arguments of `perform-replace.'
	(isearch-query-replace-regexp): Replace code by the call to
	`isearch-query-replace' with arg `t'.

2004-09-03  Richard M. Stallman  <rms@gnu.org>

	* startup.el (normal-top-level): Undo previous TERM change.

2004-09-03  Kim F. Storm  <storm@cua.dk>

	* emulation/cua-rect.el (cua--overlay-keymap): New keymap for
	highlight overlays; allow using RET when cursor is over a button.
	(cua--highlight-rectangle): Use it.
	(cua--rectangle-set-corners): Don't move backwards at eol.
	(cua--forward-line): Don't move into void after eob.

	* emulation/cua-rect.el (cua--rectangle-set-corners): Ensure that
	point is set (and displayed) inside rectangle.
	(cua--rectangle-operation): Fix for highlight of empty lines.
	(cua--highlight-rectangle): Fix highlight for tabs.
	Position cursor at left/right edge of rectangle using new `cursor'
	property on overlay strings.
	(cua--indent-rectangle): Don't tabify.
	(cua-rotate-rectangle): Ignore that point has moved.

2004-09-02  YAMAMOTO Mitsuharu  <mituharu@math.s.chiba-u.ac.jp>

	* term/mac-win.el: Add ASCII equivalents for some function keys.
	(mode-line-frame-identification): Sync with x-win.el.

2004-09-02  Juri Linkov  <juri@jurta.org>

	* progmodes/compile.el (compilation-buffer-name): Compare major
	mode with second element of compilation-arguments instead of third
	to reflect latest changes in compilation-arguments structure.
	(recompile): Use global variable `compilation-directory' to get
	recent compilation directory only when `recompile' is invoked NOT
	in the compilation buffer.  Otherwise, use `default-directory' of
	the compilation buffer.
	(compilation-error-properties): Allow to funcall col and end-col.
	(compilation-mode-font-lock-keywords): Check col and end-col by
	`integerp'.
	(compilation-goto-locus): If end-mk is non-nil in transient mark
	mode don't activate the mark (and don't display message in
	push-mark), but highlight overlay between mk and end-mk.

	* progmodes/grep.el (grep-highlight-matches): New defcustom.
	(grep-regexp-alist): Add rule to highlight grep matches.
	(grep-process-setup): Set env-vars GREP_OPTIONS and GREP_COLOR.

	* info.el (Info-fontify-node): Don't compute other-tag
	if Info-hide-note-references=hide.

	* help.el (function-called-at-point):
	* help-fns.el (variable-at-point):
	Try `find-tag-default' when other methods failed.

	* emacs-lisp/lisp.el (beginning-of-defun, end-of-defun):
	Do not push mark if inhibit-mark-movement is non-nil.

	* textmodes/ispell.el (ispell-html-skip-alists):
	Fix backslashes in docstring.

2004-09-01  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-wrap-function)
	(isearch-push-state-function): New defvars.
	(isearch-pop-fun-state): New defsubst.
	(isearch-top-state): Call function saved in `isearch-pop-fun-state'.
	(isearch-push-state): Set the result of calling
	`isearch-push-state-function' to the `isearch-pop-fun-state' field.
	(isearch-cancel): Call function saved in `isearch-pop-fun-state' to
	restore the mode-specific starting point of terminated search.
	(isearch-abort): Call `isearch-cancel' instead of its duplicated code.
	(isearch-repeat): Call `isearch-wrap-function' if defined.
	(isearch-message-prefix): Don't add prefix "over" to the message
	for wrapped search if `isearch-wrap-function' is defined.
	(isearch-search): Call function saved in `isearch-pop-fun-state' to
	restore the mode-specific starting point of failed search.

	* info.el (Info-search-whitespace-regexp): Fix backslashes.
	(Info-search): Add new optional arguments for the sake of isearch.
	Replace whitespace in Info-search-whitespace-regexp literally.
	Add backward search.  Don't call `Info-select-node' if regexp is
	found in the same Info node.  Don't add node to Info-history for
	wrapped isearch.
	(Info-search-backward, Info-isearch-search, Info-isearch-wrap)
	(Info-isearch-push-state, Info-isearch-pop-state): New funs.
	(Info-mode): Set local variables `isearch-search-fun-function',
	`isearch-wrap-function', `isearch-push-state-function',
	`search-whitespace-regexp'.

	* isearch.el: Remove ancient Change Log section.
	(isearch-string, isearch-message-string, isearch-point)
	(isearch-success, isearch-forward-flag, isearch-other-end)
	(isearch-word, isearch-invalid-regexp, isearch-wrapped)
	(isearch-barrier, isearch-within-brackets)
	(isearch-case-fold-search): Add suffix `-state' to state-related
	defsubsts to avoid name clashes with other function names.

	* simple.el (next-error): New defgroup and defface.
	(next-error-highlight, next-error-highlight-no-select):
	New defcustoms.
	(next-error-no-select): Let-bind next-error-highlight to the value
	of next-error-highlight-no-select before calling `next-error'.

	* progmodes/compile.el (compilation-goto-locus):
	Use `next-error' face instead of `region'.  Set 4-th argument of
	`move-overlay' to `current-buffer' to move overlay to different
	source buffers.  Use new variable `next-error-highlight'.

	* simple.el (next-error-find-buffer): Move the rule
	"if current buffer is a next-error capable buffer" after the
	rule "if next-error-last-buffer is set to a live buffer".
	Simplify to test all rules in one `or'.
	(next-error): Doc fix.
	(next-error, previous-error, first-error)
	(next-error-no-select, previous-error-no-select):
	Make arguments optional.

2004-08-31  Luc Teirlinck  <teirllm@auburn.edu>

	* macros.el (apply-macro-to-region-lines): Make it operate on all
	lines that begin in the region, rather than on all complete lines
	in the region.

2004-08-31  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* x-dnd.el (x-dnd-protocol-alist): Document update.
	(x-dnd-known-types): Defcustom it.
	(x-dnd-handle-motif): Print message-atom in error message.

2004-08-30  John Paul Wallington  <jpw@gnu.org>

	* textmodes/tex-mode.el (tex-validate-buffer): Use distinct
	strings rather than programatically constructing message.

2004-08-30  Richard M. Stallman  <rms@gnu.org>

	* emacs-lisp/lisp-mode.el (prin1-char): Don't turn S-a into A.
	Don't return a string that would read as the wrong character code.

2004-08-29  Kim F. Storm  <storm@cua.dk>

	* emulation/cua-base.el (cua-auto-expand-rectangles):
	Remove automatic rectangle padding feature; replace by non-destructive
	virtual rectangle edges feature.
	(cua-virtual-rectangle-edges): New defcustom.
	(cua-auto-tabify-rectangles): New defcustom.
	(cua-paste): If paste into a marked rectangle, insert rectangle at
	current column, even if virtual; also paste exactly as many lines
	as has been marked (ignore additional lines or add empty lines),
	but paste whole source if only one line is marked.
	(cua--update-indications): No longer use overwrite-cursor to
	indicate rectangle padding

	* emulation/cua-rect.el (cua--rectangle-padding): Remove.
	(cua--rectangle-virtual-edges): New defun.
	(cua--rectangle-get-corners): Remove optional PAD arg.
	(cua--rectangle-set-corners): Never do padding.
	(cua--forward-line): Remove optional PAD arg.  Simplify.
	(cua-resize-rectangle-right, cua-resize-rectangle-left)
	(cua-resize-rectangle-down, cua-resize-rectangle-up):
	(cua-resize-rectangle-bot, cua-resize-rectangle-top)
	(cua-resize-rectangle-page-up, cua-resize-rectangle-page-down)
	(cua--rectangle-move): Never do padding.  Simplify.
	(cua--tabify-start): New defun.
	(cua--rectangle-operation): Add tabify arg.  All callers changed.
	(cua--pad-rectangle): Remove.
	(cua--delete-rectangle): Handle delete with virtual edges.
	(cua--extract-rectangle): Add spaces if rectangle has virtual edges.
	(cua--insert-rectangle): Handle insert at virtual column.
	Perform auto-tabify if necessary.
	(cua--activate-rectangle): Remove optional FORCE arg.
	Never do padding.  Simplify.
	(cua--highlight-rectangle): Enhance for virtual edges.
	(cua-toggle-rectangle-padding): Remove command.
	(cua-toggle-rectangle-virtual-edges): New command.
	(cua-sequence-rectangle): Add optional TABIFY arg.  Callers changed.
	(cua--rectangle-post-command): Don't force rectangle padding.
	(cua--init-rectangles): Bind M-p to cua-toggle-rectangle-virtual-edges.

2004-08-28  Luc Teirlinck  <teirllm@auburn.edu>

	* indent.el (edit-tab-stops-buffer): Doc fix.

2004-08-28  Richard M. Stallman  <rms@gnu.org>

	* progmodes/grep.el (grep-default-command): Use find-tag-default.
	(grep-tag-default): Function deleted.

	* subr.el (find-tag-default): Move from etags.el.

	* progmodes/etags.el (find-tag-default): Move to subr.el.

	* emacs-lisp/lisp-mode.el (prin1-char): Put `shift' modifier
	into the basic character if it has an uppercase form.

2004-08-27  Kenichi Handa  <handa@m17n.org>

	* international/utf-8.el (utf-8-post-read-conversion): If the
	buffer is unibyte, temporarily make it multibyte.

2004-08-27  Masatake YAMATO  <jet@gyve.org>

	* calendar/time-date.el (time-to-seconds): Add autoload cookies.

2004-08-25  John Paul Wallington  <jpw@gnu.org>

	* textmodes/tex-mode.el (tex-validate-buffer): Distinguish between
	0, 1, and many mismatches in message.
	(tex-start-shell): Use `set-process-query-on-exit-flag'.

	* ielm.el (ielm-tab, ielm-complete-symbol): Doc fix.
	(inferior-emacs-lisp-mode): Use	`set-process-query-on-exit-flag'.

2004-08-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-svn.el (vc-svn-diff): Treat options from vc-svn-diff-switches and
	vc-diff-switches differently.

2004-08-22  Luc Teirlinck  <teirllm@auburn.edu>

	* speedbar.el (speedbar-file-regexp): Give it a phony defvar
	before and a real defvar after
	`speedbar-supported-extension-expressions'.  This is to silence
	the compiler without breaking bootstrapping.

2004-08-22  Richard M. Stallman  <rms@gnu.org>

	* textmodes/flyspell.el (flyspell-word):
	Use set-process-query-on-exit-flag.
	(flyspell-highlight-duplicate-region): Take POSS as arg.
	(flyspell-word): Pass POSS as arg.

	* progmodes/ada-xref.el: Many doc and style fixes.
	(ada-find-any-references): Use compilation-start.
	(ada-get-ali-file-name): Improve error msg.
	(ada-get-ada-file-name): Likewise.

	* net/ange-ftp.el (ange-ftp-gwp-start, ange-ftp-nslookup-host)
	(ange-ftp-start-process): Use set-process-query-on-exit-flag.

	* mail/mail-extr.el (mail-extr-all-top-level-domains):
	Add forward defvar.

	* whitespace.el (global-whitespace-mode): New alias
	for whitespace-global-mode.

	* speedbar.el (speedbar-file-regexp): Move definition up.
	(speedbar-mode, speedbar-set-mode-line-format):
	Use with-no-warnings.
	(speedbar-emacs-popup-kludge): Delete Emacs 19 alternative.

	* simple.el (shell-command-on-region): New arg DISPLAY-ERROR-BUFFER
	controls whether to display the error buffer.

	* ps-mule.el: Delete compatibility code for old Emacsen.
	(ps-mule-find-wrappoint): Don't use chars-in-region.

	* frame.el (display-mouse-p, display-selections-p):
	Use with-no-warnings.

	* font-lock.el (font-lock-set-defaults): Use with-no-warnings.

2004-08-22  David Kastrup  <dak@gnu.org>

	* textmodes/reftex-auc.el, progmodes/meta-mode.el: Update AUCTeX
	information.

	* speedbar.el, iswitchb.el, ido.el: Update AUCTeX information.

2004-08-22  Andreas Schwab  <schwab@suse.de>

	* cvs-status.el: Require pcvs during byte-compiling for defun-cvs-mode.

2004-08-22  Masatake YAMATO  <jet@gyve.org>

	* cvs-status.el (cvs-status-checkout): New function.
	(cvs-status-mode-map): Add a key definition for `cvs-status-checkout'.

2004-08-21  David Kastrup  <dak@gnu.org>

	* net/ange-ftp.el (ange-ftp-hash-entry-exists-p)
	(ange-ftp-file-entry-p, ange-ftp-file-symlink-p): Since the code
	has been converted to use hashtables, the relation `nil=none' is
	no longer valid, as `nil' is not a hashtable.  This patch tries to
	reduce the number of resulting errors.

2004-08-21  John Paul Wallington  <jpw@gnu.org>

	* subr.el (process-kill-without-query): Made obsolete in
	version	21.4, not 21.5.

	* log-edit.el (vc-comment-ring, vc-comment-ring-index)
	(vc-previous-comment, vc-next-comment)
	(vc-comment-search-reverse, vc-comment-search-forward)
	(vc-comment-to-change-log): Likewise.

	* international/latin1-disp.el (latin1-char-displayable-p): Likewise.

2004-08-21  Peter Seibel  <peter@javamonkey.com>  (tiny patch)

	* emacs-lisp/cl-indent.el (lisp-indent-defmethod):
	Correct indentation of DEFMETHODS with non-standard method
	combinations (e.g., PROGN, MIN, MAX).

2004-08-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* startup.el (normal-top-level-add-subdirs-to-load-path):
	Avoid unnecessarily checking system-type.
	(normal-top-level): Set TERM to "dumb".  Simplify.

	* avoid.el (mouse-avoidance-ignore-p): New fun.
	Also ignore switch-frame, select-window, double, and triple clicks.
	(mouse-avoidance-banish-hook, mouse-avoidance-exile-hook)
	(mouse-avoidance-fancy-hook): Use it.

2004-08-20  Zoran Milojevic  <zoran@sipquest.com>  (tiny change)

	* avoid.el (mouse-avoidance-nudge-mouse)
	(mouse-avoidance-banish-destination): Stay within the current window
	to avoid problems with mouse-autoselect-window.

2004-08-19  Stefan Monnier  <monnier@iro.umontreal.ca>

	* pcvs-parse.el (cvs-parse-table, cvs-parse-commit): Try to adapt to
	the newer format of some messages in cvs-1.12.1.

2004-08-19  Masatake YAMATO  <jet@gyve.org>

	* emacs-lisp/elp.el (elp-results-symname-map): New keymap.
	(elp-results-jump-to-definition-by-mouse)
	(elp-results-jump-to-definition, elp-output-insert-symname): New funs.
	(elp-output-result): Use elp-output-insert-symname.

2004-08-18  Kenichi Handa  <handa@m17n.org>

	* language/cyrillic.el: Register koi8-r in
	ctext-non-standard-encodings-alist.
	("Cyrillic-KOI8"): Add ctext-non-standard-encoding.

2004-08-17  Luc Teirlinck  <teirllm@auburn.edu>

	* emacs-lisp/copyright.el (copyright-update-year): Delete code
	that replaces 20xy with xy.

2004-08-17  John Paul Wallington  <jpw@gnu.org>

	* emacs-lisp/re-builder.el (reb-mode-map): Define within defvar.
	(reb-force-update): Doc fix.

2004-08-16  Richard M. Stallman  <rms@gnu.org>

	* progmodes/which-func.el (which-func-update-1): Doc fix.

	* progmodes/sh-script.el (sh-set-shell): Use sh-mode-abbrev-table.
	(sh-mode-abbrev-table): New variable.

	* progmodes/compile.el (compilation-mode): Doc fix.

	* emacs-lisp/lisp-mode.el (eval-last-sexp):
	Don't cons a new symbol each time.
	(eval-last-sexp-fake-value): New variable.

	* emacs-lisp/copyright.el (copyright-years-regexp): New variable.
	(copyright-update-year): Detect continuation of list of years.

	* term.el (term-default-fg-color, term-default-bg-color)
	(ansi-term-color-vector): Use `unspecified', not nil, as default.

	* imenu.el: Several doc fixes: don't say variables are buffer-local.

2004-08-16  Davis Herring  <herring@lanl.gov>

	* isearch.el (isearch-string, isearch-message-string, isearch-point)
	(isearch-success, isearch-forward-flag, isearch-other-end)
	(isearch-word, isearch-invalid-regexp, isearch-wrapped)
	(isearch-barrier, isearch-within-brackets)
	(isearch-case-fold-search): Fix broken `nth'-like calls to `aref'.

2004-08-16  Kenichi Handa  <handa@m17n.org>

	* ps-mule.el (ps-mule-font-info-database): Fix docstring.

2004-08-15  Kenichi Handa  <handa@m17n.org>

	* term/x-win.el (x-selection-value): If utf8 was successful but
	ctext was not, use utf8 string.

2004-08-14  Davis Herring  <herring@lanl.gov>

	* isearch.el: Remove accidental changes of March 4.  Fix backing
	up when a regexp isearch is made more general.  Use symbolic
	accessor functions for isearch stack frames to make usage clearer.
	(search-whitespace-regexp): Made groups in documentation shy (as
	is the group in the default value).
	(isearch-fallback): New function, addresses problems with regexps
	liberalized by `\|', adds support for liberalization by `\}' (the
	general repetition construct), and incorporates behavior for
	`*'/`?'.
	(isearch-}-char): New command, calls `isearch-fallback' with
	arguments appropriate to a typed `}'.
	(isearch-*-char, isearch-|-char): Now just call `isearch-fallback'
	appropriately.
	(isearch-mode-map): Bind `}' to `isearch-}-char'.
	(isearch-string, isearch-message,string, isearch-point)
	(isearch-success, isearch-forward-flag, isearch-other-end)
	(isearch-word, isearch-invalid-regexp, isearch-wrapped)
	(isearch-barrier, isearch-within-brackets, isearch-case-fold-search):
	New inline functions to read fields of a stack frame.

2004-08-14  Kurt Hornik  <Kurt.Hornik@wu-wien.ac.at>  (tiny change)

	* battery.el (battery-linux-proc-acpi): Look into battery
	directories matching the literal string "CMB", too (required for
	Linux kernel version 2.6.7).

2004-08-14  John Paul Wallington  <jpw@gnu.org>

	* cus-start.el (read-file-name-completion-ignore-case): Add.
	(blink-cursor-alist): Change version to "21.4".

	* emacs-lisp/bytecomp.el (forward-word): Allow 0 args.

2004-08-11  Daniel Pfeiffer  <occitan@esperanto.org>

	* speedbar.el (speedbar-scan-subdirs): New option.
	(speedbar-file-lists): Don't ignore file-name case on Unix and use
	dolist.
	(speedbar-insert-files-at-point): Take an extra argument and use
	it to optionally find out if a subdir is empty.  Also unreadable
	files don't get expand buttons.
	(speedbar-directory): New image (unused pixmap already existed).
	(speedbar-expand-image-button-alist): Use it.

2004-08-11  Martin Stjernholm  <bug-cc-mode@gnu.org>

	CC Mode update to 5.30.9:

	* progmodes/cc-defs.el, progmodes/cc-vars.el (c-emacs-features):
	Move from cc-vars to cc-defs for dependency reasons.  Fix the
	POSIX char class test to check that it works in
	`skip-chars-(forward|backward)' too.

	* progmodes/cc-align.el (c-lineup-arglist): Fix bug when the
	first argument starts with a special brace list.

	* progmodes/cc-engine.el (c-forward-type): Fix promotion bug
	when `c-opt-type-concat-key' is used (i.e. in Pike).

	* progmodes/cc-engine.el (c-looking-at-special-brace-list):
	Fix bug when the inner char pair doesn't have paren syntax,
	i.e. "(<>)".

	* progmodes/cc-align.el (c-lineup-multi-inher): Made it syntactic
	whitespace safe.

	* progmodes/cc-engine.el (c-guess-basic-syntax): Fix anchor
	position for `arglist-intro', `arglist-cont-nonempty' and
	`arglist-close' when there are two arglist open parens on the same
	line and there's nothing in front of the first.

	* progmodes/cc-fonts.el (c-basic-matchers-before): Fix font
	locking of qualified names in Java, which previously could fontify
	common indexing expressions in many cases.  The standard Java
	naming conventions are used to tell them apart.

	* progmodes/cc-align.el (c-lineup-whitesmith-in-block):
	Fix inconsistency wrt opening parens on the first line inside a paren
	block.

	* progmodes/cc-defs.el (c-langs-are-parametric): Must be known at
	compile time for the sake of `c-major-mode-is'.

	(c-mode-is-new-awk-p): Made it a macro to delay expansion of
	`c-major-mode-is' in the event that this is used inside a
	`c-lang-defconst'.

	* progmodes/cc-defs.el (c-major-mode-is): Fix expansion inside
	`c-lang-defconst' so that it works better with fallback languages.

	* progmodes/cc-defs.el (c-add-language): Fix a typo that caused
	it to fail to record the base mode.

	* progmodes/cc-engine.el (c-syntactic-re-search-forward):
	Fix bug so that it doesn't go past the closing paren when PAREN-LEVEL
	is used.  Reorder the syntax checks to get more efficient
	skipping in some situations.

	* progmodes/cc-cmds.el (c-electric-brace): Don't trip up on a line
	continuation which might precede the newly inserted '{'.

	* progmodes/cc-engine.el (c-syntactic-re-search-forward):
	Fix cases where it could loop indefinitely.

	* progmodes/cc-fonts.el (c-font-lock-declarators): Handle array
	size specs correctly.  Only fontify identifiers in front of '('
	with as functions - don't accept any paren char.  Tighten up
	initializer skipping to stop before function and class blocks.

	* progmodes/cc-engine.el (c-beginning-of-decl-1): Fix bug where
	the point could be left directly after an open paren when finding
	the beginning of the first decl in the block.

	* progmodes/cc-engine.el (c-parse-state): Don't use the syntax
	table when filtering out legitimate open parens to be recorded.
	This could cause cache inconsistencies when e.g.
	`c++-template-syntax-table' was temporarily in use.

	* progmodes/cc-engine.el (c-on-identifier)
	(c-simple-skip-symbol-backward): Small fix for handling "-"
	correctly in `skip-chars-backward'.  Affected the operator lfun
	syntax in Pike.

	* progmodes/cc-engine.el (c-invalidate-sws-region-after):
	Fix bug that could cause an error from `after-change-functions' when
	the changed region is at bob.

2004-08-11  Alan Mackenzie  <bug-cc-mode@gnu.org>

	CC Mode update to 5.30.9:

	* progmodes/cc-cmds.el, progmodes/cc-vars.el: Amend doc(-strings)
	to say that <TAB> doesn't insert WS into a CPP line.
	(c-indent-command, c-tab-always-indent): Amend doc strings.

	* progmodes/cc-styles.el, progmodes/cc-engine.el: Add in two
	checks for user errors, thus eliminating cryptic and unhelpful
	Emacs error messages.  (1) Check the arg to `c-set-style' is a
	string.  (2) Check that settings to `c-offsets-alist' are not
	spuriously quoted.

	* progmodes/cc-cmds.el (c-electric-brace): Don't delete a comment
	which precedes the newly inserted `{'.

2004-08-10  Michael Albinus  <michael.albinus@gmx.de>

	Sync with Tramp 2.0.44.

	* net/tramp.el (tramp-post-connection): Quote $1 and $2 of shell
	function "tramp_file_attributes".  Otherwise, file names
	containing spaces are misinterpreted.  Reported by Magnus Henoch
	<mange@freemail.hu>.
	(tramp-handle-file-truename): FILENAME must be expanded first.
	Otherwise, parameters like "/ssh:deego@gnufans.net:~" will return
	obscure results.  Reported by D. Goel <deego@gnufans.org>.
	(tramp-handle-verify-visited-file-modtime): If file does not
	exist, say it is not modified if and only if that agrees with the
	buffer's record.  Check whether a file is visiting the buffer, or
	the buffer has no recorded last modification time.  Return t in
	case the visiting file doesn't exist.  Suggested by Luc Teirlinck
	<teirllm@auburn.edu>.
	(tramp-handle-write-region): Pass modtime explicitly to
	`set-visited-file-modtime', because filename can be different
	from (buffer-file-name) if `file-precious-flag' is set.
	`set-visited-file-modtime' must be called always when `visit' is t
	or a string.  Suggested by Luc Teirlinck <teirllm@auburn.edu>.
	(tramp-handle-set-visited-file-modtime): If `time-list' is not
	nil, don't apply the whole body.  If the file doesn't exists, set
	modtime to '(-1 65535).  Suggested by Luc Teirlinck
	<teirllm@auburn.edu>.

2004-08-09  Luc Teirlinck  <teirllm@auburn.edu>

	* help.el (describe-bindings): Doc fix.

	* subr.el (kbd): Doc fix.

2004-08-08  John Paul Wallington  <jpw@gnu.org>

	* ibuffer.el (define-ibuffer-column size): Use `string-to-number'
	instead of `string-to-int'.
	(define-ibuffer-column mode): Fix indentation.

2004-08-08  Lars Hansen  <larsh@math.ku.dk>

	* wid-edit.el (widget-sexp-validate): Allow whitespace after expression.

2004-08-08  Luc Teirlinck  <teirllm@auburn.edu>

	* subr.el (global-unset-key, local-unset-key): Doc fixes.

	* novice.el (disabled-command-function): New variable renamed from
	`disabled-command-hook'.
	(disabled-command-hook): Keep the _variable_ as alias for
	`disabled-command-function' and make obsolete.
	(disabled-command-function): Function renamed from
	`disabled-command-hook'.  Adapt code to name change of the variable.

2004-08-07  Satyaki Das  <satyaki@theforce.stanford.edu>  (tiny change)

	* simple.el (completion-root-regexp): New defvar.
	(completion-setup-function): Use it instead of a literal string.

2004-08-07  John Paul Wallington  <jpw@gnu.org>

	* emacs-lisp/re-builder.el (reb-re-syntax): Add `rx' syntax.
	(reb-lisp-mode): Require `rx' feature when `re-reb-syntax' is `rx'.
	(reb-lisp-syntax-p, reb-change-syntax): `rx' is a Lisp syntax.
	(reb-cook-regexp): Call `rx-to-string' when `re-reb-syntax' is `rx'.

2004-08-05  Katsumi Yamaoka  <yamaoka@jpl.org>  (tiny change)

	* mail/mail-extr.el (mail-extr-disable-voodoo): New variable.
	(mail-extr-voodoo): Check mail-extr-disable-voodoo.

2004-08-04  Kenichi Handa  <handa@m17n.org>

	* international/encoded-kb.el (encoded-kbd-setup-keymap):
	Fix previous change.

2004-08-03  Kenichi Handa  <handa@m17n.org>

	* international/encoded-kb.el: The following changes are to
	utilize key-translation-map instead of minor mode map.
	(encoded-kbd-iso2022-non-ascii-map): Delete it.
	(encoded-kbd-coding, encoded-kbd-handle-8bit): Delete them.
	(encoded-kbd-last-key): New function.
	(encoded-kbd-iso2022-single-shift): New function.
	(encoded-kbd-iso2022-designation)
	(encoded-kbd-self-insert-iso2022-7bit)
	(encoded-kbd-self-insert-iso2022-8bit)
	(encoded-kbd-self-insert-sjis, encoded-kbd-self-insert-big5)
	(encoded-kbd-self-insert-ccl): Make them suitable for bindings in
	key-translation-map.
	(encoded-kbd-setup-keymap): Setup key-translation-map.
	(saved-key-translation-map): New variable.
	(encoded-kbd-mode): Save/restore key-translation-map.
	Adjust for the change of encoded-kbd-setup-keymap.

2004-08-02  Kim F. Storm  <storm@cua.dk>

	* avoid.el (mouse-avoidance-point-position): Use window-inside-edges
	and call compute-motion with nil for topos and width to get proper
	usable width and height for both window and non-window systems.

	* windmove.el (windmove-coordinates-of-position): Let compute-motion
	calculate usable window width and height.

	* window.el (window-buffer-height): Call compute-motion with nil width.

2004-08-01  David Kastrup  <dak@gnu.org>

	* replace.el (query-replace-read-from):
	Use `query-replace-compile-replacement'.
	(query-replace-compile-replacement): New function.
	(query-replace-read-to): Use `query-replace-compile-replacement'
	for repeating the last command.

2004-08-01  John Paul Wallington  <jpw@gnu.org>

	* printing.el (toplevel, pr-ps-fast-fire, pr-ps-set-utility)
	(pr-ps-set-printer, pr-txt-set-printer, pr-eval-setting-alist)
	(pr-switches): Remove period from end of error messages.

	* help-mode.el (help-go-back): Likewise.

	* abbrev.el (only-global-abbrevs): Doc fix.
	(edit-abbrevs-map): Define within defvar.
	(quietly-read-abbrev-file): Doc fix.

2004-07-31  Luc Teirlinck  <teirllm@auburn.edu>

	* novice.el (enable-command, disable-command): Doc fixes.

	* subr.el (event-modifiers, event-basic-type): Doc fixes.

2004-07-30  Richard M. Stallman  <rms@gnu.org>

	* subr.el (with-local-quit): Doc fix.

2004-07-30  Luc Teirlinck  <teirllm@auburn.edu>

	* international/utf-8.el (utf-translate-cjk-mode): Doc fix.

2004-07-28  Luc Teirlinck  <teirllm@auburn.edu>

	* custom.el (defcustom): Doc fix.

2004-07-28  Masatake YAMATO  <jet@gyve.org>

	* progmodes/etags.el (etags-tags-apropos): Show building progress.

2004-07-26  Stefan Monnier  <monnier@iro.umontreal.ca>

	* imenu.el (imenu-prev-index-position-function)
	(imenu-extract-index-name-function, imenu-name-lookup-function)
	(imenu--index-alist): Docstring redundancy fix.

2004-07-25  Lars Hansen  <larsh@math.ku.dk>

	* wdired.el (wdired-finish-edit): Require dired-aux before locally
	binding dired-backup-overwrite.

2004-07-25  John Paul Wallington  <jpw@gnu.org>

	* subr.el (butlast, event-modifiers, event-basic-type): Doc fixes.

2004-07-24  Luc Teirlinck  <teirllm@auburn.edu>

	* term/tty-colors.el (tty-color-approximate): Doc fix.

	* select.el (x-get-selection, x-set-selection): Doc fixes.

	* frame.el (make-frame): Doc fix.

2004-07-24  Richard M. Stallman  <rms@gnu.org>

	* mail/rmail.el (rmail-mime-charset-pattern):
	Don't include semicolon in the charset value.

	* replace.el (occur-next-error): Call set-window-point.
	(occur-engine): Handle negative NLINES.

2004-07-23  Luc Teirlinck  <teirllm@auburn.edu>

	* frame.el (modify-all-frames-parameters): Minor doc fix.
	(set-frame-configuration): Doc fix.

2004-07-23  Matt Hodges  <matt@stchem.bham.ac.uk>  (tiny change)

	* simple.el (completion-setup-function): Compute the common parts
	and the first difference place correctly when
	partial-completion-mode is on.

2004-07-22  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-print.el: Doc fix.
	(ps-print-version): New version 6.6.5.
	(ps-printing-region): Doc fix.
	(ps-generate-string-list): Comment fix.
	(ps-message-log-max): Code fix.

2004-07-22  Michael Piotrowski  <mxp@dynalabs.de>  (tiny change)

	* ps-print.el (ps-begin-file): Improve the DSC compliance of the
	generated PostScript.

2004-08-17  Reiner Steib  <Reiner.Steib@gmx.de>

	* net/tls.el (tls-process-connection-type): Fix docstring.  (Sync
	with Gnus v5_10 branch.)

2004-08-16  Reiner Steib  <Reiner.Steib@gmx.de>

	* calendar/time-date.el (time-to-number-of-days): New function.
	Imported from Gnus.

2004-07-22  Kim F. Storm  <storm@cua.dk>

	* progmodes/make-mode.el: Fix comments.

2004-07-21  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* printing.el: Doc fix.

2004-07-20  Luc Teirlinck  <teirllm@auburn.edu>

	* frame.el (modify-all-frames-parameters): Minor doc fix.

2004-07-20  Richard M. Stallman  <rms@gnu.org>

	* textmodes/fill.el (fill-nobreak-p): If this break point is
	at the end of the line, don't consider the newline which follows
	as a reason to return t.

2004-07-19  John Paul Wallington  <jpw@gnu.org>

	* dired-aux.el (dired-file-set-difference): Don't use `caddr'.

2004-07-18  Luc Teirlinck  <teirllm@auburn.edu>

	* dired-aux.el (dired-do-kill-lines): Expand docstring.
	Delete irrelevant code.

2004-07-17  Kai Grossjohann  <kai.grossjohann@gmx.net>

	* net/tramp.el (tramp-handle-verify-visited-file-modtime):
	New docstring.  From Luc Teirlinck.

2004-07-17  Luc Teirlinck  <teirllm@auburn.edu>

	* autorevert.el: Describe `Auto Revert Tail Mode' in `Commentary'
	section.
	(auto-revert-handler): Do not check `auto-revert-tail-mode' for
	non-file buffers.  We know it is nil.

2004-07-17  Kai Grossjohann  <kai.grossjohann@gmx.net>

	Sync with Tramp 2.0.43.

	* net/tramp.el (tramp-handle-verify-visited-file-modtime):
	Remove outdated comment.
	(tramp-locked, tramp-locker): New variables for implementing a
	global lock.
	(tramp-sh-file-name-handler): Use them to implement the global lock.

2004-07-13  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (all): Code cleanup.  Change all `tramp-handle-xxx'
	calls to respective `xxx` calls.
	(tramp-process-alive-regexp): Precise doc string.
	(tramp-multi-action-process-alive): New defun.
	(tramp-multi-actions): Use it.
	(tramp-handle-find-backup-file-name): `copy-tree' is available
	since Emacs 22.1 only (XEmacs has it).  Implementation rewritten
	in order to avoid this function.
	(tramp-handle-write-region): Set current buffer.  If connection
	wasn't open, `file-modes' has changed it accidentally.  Reported by
	David Kastrup <dak@gnu.org>.
	(tramp-enter-password, tramp-read-passwd): New arguments USER and
	HOST.
	(tramp-action-password, tramp-multi-action-password): Apply it.
	(tramp-open-connection-rsh): If a port is given, the Tramp buffer
	name must still contain the port number.  Otherwise, we have two
	Tramp buffers, with all the confusion.  Reported by Myron Selby
	<myron@xytech.com> and Rolf Dubitzky
	<Dubitzky@physi.uni-heidelberg.de>.

	* net/tramp-smb.el (tramp-smb-open-connection): Apply USER and
	HOST to `tramp-enter-passwd'.

	* net/tramp-vc.el (all): Code cleanup.  Change all
	`tramp-handle-xxx' calls to respective `xxx` calls.

2004-07-17  Jonathan Yavner  <jyavner@member.fsf.org>

	* emacs-lisp/testcover.el: New category "potentially-1valued" for
	functions that are not erroneous if either 1-valued or
	multi-valued.  Detect functions in this class.
	(testcover-1value-functions, testcover-compose-functions)
	(testcover-progn-functions) Add some additional functions to lists.
	(testcover-mark): Bugfix when marking up the definition for an
	empty function.

2004-07-17  Richard M. Stallman  <rms@gnu.org>

	* replace.el (occur-read-primary-args): Pass default to
	read-from-minibuffer.

	* mail/footnote.el (footnote-section-tag): Use defcustom.

	* font-lock.el (font-lock-add-keywords, font-lock-remove-keywords):
	Compile font-lock-keywords, not KEYWORDS.
	(lisp-font-lock-keywords-2): Add multiple-value-prog1, go.
	Add warn, check-type.  Handle cerror like error.

2004-07-14  Daniel Pfeiffer  <occitan@esperanto.org>

	* progmodes/which-func.el (which-func-keymap): New var.
	(which-func-face): New face.
	(which-func-format): Use them.

2004-07-16  Stephan Stahl  <stahl@eos.franken.de>  (tiny change)

	* buff-menu.el (list-buffers-noselect): Append the buffer's
	process status to its mode name.

2004-07-16  Kim F. Storm  <storm@cua.dk>

	* simple.el (inhibit-mark-movement): New defvar.
	(beginning-of-buffer, end-of-buffer): Do not push mark if
	inhibit-mark-movement is non-nil or C-u prefix is given.

	* emulation/cua-base.el (cua--preserve-mark-commands): New defvar.
	Init to beginning-of-buffer and end-of-buffer.
	(cua--undo-push-mark): New defvar.
	(cua--pre-command-handler): Set inhibit-mark-movement if mark is
	already active and command is in cua--preserve-mark-commands.
	Also fix check for shift modifier on non-window systems.
	(cua--post-command-handler): Clear inhibit-mark-movement if set.

2004-07-14  Luc Teirlinck  <teirllm@auburn.edu>

	* calendar/cal-dst.el (calendar-time-from-absolute): Return a list
	of two integers, instead of a cons.

	* net/tramp.el (tramp-handle-verify-visited-file-modtime):
	`visited-file-modtime' now returns a list of two integers, instead
	of a cons.

	* dired.el (dired-directory-changed-p): Ditto.

	* progmodes/grep.el (grep): Doc fix.

2004-07-14  Daniel Pfeiffer  <occitan@esperanto.org>

	* autorevert.el (auto-revert-tail-mode)
	(auto-revert-tail-mode-text, auto-revert-tail-pos): New vars.
	(auto-revert-mode): Turn off auto-revert-tail-mode, so we're not
	in both at the same time.
	(auto-revert-tail-mode): New command.
	(turn-on-auto-revert-tail-mode, auto-revert-tail-handler): New funs.
	(auto-revert-handler): Revert only either tail or whole file.

	* bindings.el (mode-line-mode-menu): Fix alphabetical ordering and
	add auto-revert-tail-mode.

2004-07-12  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* printing.el: Doc fix.  Change name of some funs.
	(pr-dosify-file-name): New fun.  Replace ps-dosify-path.
	(pr-unixify-file-name): New fun.  Replace ps-unixify-path.
	(pr-standard-file-name): New fun.  Replace pr-standard-path.
	(pr-call-process): Code fix.

2004-07-12  Luc Teirlinck  <teirllm@auburn.edu>

	* subr.el (with-selected-window): Doc fix.

2004-07-11  Luc Teirlinck  <teirllm@auburn.edu>

	* subr.el (get-buffer-window-list): Doc fix.

2004-07-10  Luc Teirlinck  <teirllm@auburn.edu>

	* files.el (switch-to-buffer-other-window): Doc fix.

	* window.el (save-selected-window, one-window-p)
	(split-window-keep-point, split-window-vertically)
	(split-window-horizontally): Doc fixes.

2004-07-10  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* printing.el: Doc fix.  Now it uses call-process instead of
	shell-command for low command execution.
	(pr-version): New version number (6.8).
	(pr-shell-file-name): Option removed.
	(pr-shell-command): Fun removed.
	(pr-call-process): New fun.  Replace pr-shell-command.
	(pr-standard-path, pr-remove-nil-from-list): New funs.
	(zmacs-region-stays, current-mouse-event, current-menubar): New var.
	(pr-ps-file-preview, pr-ps-file-using-ghostscript, pr-ps-file-print)
	(pr-setup, pr-ps-set-printer, pr-txt-set-printer)
	(pr-ps-utility-process, pr-txt-print): Code fix.

2004-07-10  Stephan Stahl  <stahl@eos.franken.de>  (tiny change)

	* ediff-mult.el (ediff-meta-truncate-filenames): Change type to
	boolean.

2004-07-09  Lars Hansen  <larsh@math.ku.dk>

	* wid-edit.el (widget-field-buffer): Doc fix.

2004-07-09  John Paul Wallington  <jpw@gnu.org>

	* emacs-lisp/re-builder.el (reb-update-overlays):
	Distinguish between one and several matches in message.

2004-07-09  Richard M. Stallman  <rms@gnu.org>

	* mouse.el (mouse-set-region-1): If transient-mark-mode
	is `identity', change it to `only'.

	* simple.el (current-word): Doc fix.

2004-07-09  Mark A. Hershberger  <mah@everybody.org>

	* progmodes/cperl-mode.el (cperl-mode): Adapt defun-prompt-regexp
	so that it is more understanding of whitespace.

	* xml.el (xml-maybe-do-ns, xml-parse-tag): Produce elements in the form
	(("ns" . "element") (attr-list) children) instead of
	((:ns . "element") (attr-list) children) in order to reduce the
	number of symbols used.
	(xml-skip-dtd): Change to use xml-parse-dtd but set
	xml-validating-parsing to nil.
	(xml-parse-dtd): Parse entity declarations in DOCTYPEs.
	(xml-substitute-entity): Remove in favor of new entity substitution.
	(xml-substitute-special): Rewrite in to substitute complex
	entities from DOCTYPE declarations.
	(xml-parse-fragment): Parse fragments from entity declarations.
	(xml-parse-region, xml-parse-tag, xml-parse-attlist)
	(xml-parse-dtd, xml-substitute-special): Make validity checks
	conditioned on xml-validating-parser.  Add "Not Well Formed" to
	error messages about well-formedness.

2004-07-08  Steven Tamm  <steventamm@mac.com>

	* term/mac-win.el (mac-scroll-ignore-events, mac-scroll-down)
	(mac-scroll-down-line, mac-scroll-up, mac-scroll-up-line):
	Do not treat double clicks and triple clicks specially in the
	scroll bar (preventing strange repositioning problems)

2004-07-06  Stefan Monnier  <monnier@iro.umontreal.ca>

	* replace.el (query-replace-regexp-eval): Fix last change.

2004-07-05  Stefan Monnier  <monnier@iro.umontreal.ca>

	* replace.el (query-replace-descr): New fun.
	(query-replace-read-from, query-replace-read-args): Default to the
	previous from&to.
	(query-replace-read-to): Quote the `from' string when displaying it.
	(query-replace-regexp-eval): Immediately check read-only status.
	Use query-replace-read-from to get the \n checking.
	Quote the `from' string when displaying it.
	(map-query-replace-regexp, occur-read-primary-args):
	Quote the `from' string when displaying it.

	* isearch.el (isearch-query-replace): Pass the regexp-ness and
	delimited-ness of the search to query-replace.

	* replace.el (query-replace-read-from, query-replace-read-to):
	New funs extracted from query-replace-read-args.
	(query-replace-read-args): Use them.

	* replace.el (query-replace-interactive, query-replace-read-args):
	Remove the `initial' special value.
	(query-replace-regexp-eval, map-query-replace-regexp): Simplify.
	(occur-engine): Remove unused var `matchend'.

	* isearch.el (isearch-query-replace, isearch-query-replace-regexp):
	Use the search string without prompting.

2004-07-05  Kenichi Handa  <handa@m17n.org>

	* international/mule.el (decode-coding-inserted-region):
	Set last-coding-system-used only when coding is nil.

2004-07-03  Eli Zaretskii  <eliz@gnu.org>

	* progmodes/grep.el (grep-compute-defaults, grep-command)
	(grep-program, find-program, grep-find-use-xargs, grep-history)
	(grep-find-history, grep-tag-default, grep-find-command)
	(grep-regexp-alist, grep-process-setup, grep-compute-defaults):
	Add autoload cookies, for unbundled packages that load `compile'
	and expect all grep-related symbols to become defined.

2004-07-03  KOSEKI Yoshinori  <kose@meadowy.org>

	* iimage.el (turn-on-iimage-mode, iimage-mode): Add autoload cookies.
	(iimage-mode-image-search-path): New user option to search the
	image file.
	(iimage-locate-file): New function.  Emacs21.3 or earlier does not
	have locate-file.
	(iimage-mode-buffer): Use it.

2004-07-03  Nick Roberts  <nickrob@gnu.org>

	* progmodes/gdb-ui.el (gdb-goto-breakpoint): String match more
	carefully.
	(gdb-delete-breakpoint, gdb-toggle-breakpoint): Handle gdbmi.

2004-07-03  Juri Linkov  <juri@jurta.org>

	* replace.el (query-replace-read-args): Swallow space after 'foo,
	not after (quote foo).  Match space only immediately after symbol,
	not anywhere in the whole string.

2004-07-02  Richard M. Stallman  <rms@gnu.org>

	* replace.el (query-replace-read-args): Swallow space after
	symbols, not after closeparens.  But avoid error if string ends there.

	* progmodes/python.el (python-beginning-of-statement):
	Exit the loop if backward-up-list gets error.

	* textmodes/enriched.el (enriched-encode): Bind inhibit-read-only.

2004-07-02  Andre Spiegel  <spiegel@gnu.org>

	* vc-rcs.el (vc-rcs-checkout-model): Look at the version headers
	only if vc-consult-headers is non-nil.

2004-07-02  Juri Linkov  <juri@jurta.org>

	* pcvs.el (cvs-mode-diff-repository): New command.

	* pcvs-defs.el (cvs-mode-diff-map): Bind r to cvs-mode-diff-repository.

2004-07-01  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-mode-map): Bind C-M-w to isearch-del-char,
	C-M-y to isearch-yank-char.  Bind M-% to isearch-query-replace,
	C-M-% to isearch-query-replace-regexp.
	(minibuffer-local-isearch-map): Add arrow key bindings.
	Bind C-f to isearch-yank-char-in-minibuffer.
	(isearch-forward): Doc fix.
	(isearch-edit-string): Doc fix.
	(isearch-query-replace, isearch-query-replace-regexp): New funs.
	(isearch-del-char): Add optional arg.  Set isearch-yank-flag to t.
	(isearch-yank-char): Add optional arg.
	(isearch-yank-char-in-minibuffer): New fun.

	* replace.el (query-replace-interactive): Change type from boolean
	to choice.  Add value `initial'.
	(query-replace-read-args): Handle value `initial' of
	query-replace-interactive.

2004-06-29  Kim F. Storm  <storm@cua.dk>

	* progmodes/gdb-ui.el (breakpoint-enabled-bitmap-face)
	(breakpoint-disabled-bitmap-face): Add :group 'gud.

	* progmodes/ada-xref.el (ada-tight-gvd-integration):
	Add :group 'ada.

	* vc-arch.el (vc-arch-mode-line-rewrite): Add :group 'vc.

2004-06-29  Juri Linkov  <juri@jurta.org>

	* replace.el (query-replace-read-args): Swallow a space after
	everything except )]" which in most cases means after a symbol.

	* emacs-lisp/pp.el (pp-buffer): Add autoload.

2004-06-28  Richard M. Stallman  <rms@gnu.org>

	* font-lock.el (font-lock-fontify-syntactic-keywords-region):
	More changes to go with previous change in font-lock.el.

2004-06-26  David Kastrup  <dak@gnu.org>

	* replace.el (perform-replace): Highlight the match even in
	non-query mode if there is potential replace string editing.

2004-06-26  Kai Grossjohann  <kai.grossjohann@gmx.net>

	* net/tramp.el (tramp-handle-file-remote-p): New implementation to
	agree with new return value of `file-remote-p'.
	This syncs with Tramp 2.0.42.

	* net/ange-ftp.el (ange-ftp-file-remote-p): New return value,
	according to new documentation of `file-remote-p'.

	* files.el (file-remote-p): Fix doc to say that return value is
	identification of remote system, if not nil.
	(file-relative-name): Use new return value of `file-remote-p'.

2004-06-26  Nick Roberts  <nickrob@gnu.org>

	* progmodes/gdb-ui.el (gdb-toggle-breakpoint)
	(gdb-goto-breakpoint): Fix breakage.

2004-06-26  Eli Zaretskii  <eliz@gnu.org>

	* man.el (Man-getpage-in-background): Add windows-nt to the list
	of systems where shell-file-name should be used instead of
	literal "sh".

2004-06-25  Sam Steingold  <sds@gnu.org>

	* add-log.el (change-log-font-lock-keywords): Support Common Lisp
	function names `(setf symbol)'.

2004-06-24  Richard M. Stallman  <rms@gnu.org>

	* replace.el (query-replace-read-args): Swallow space after \,SYMBOL.

	* font-lock.el (font-lock-keywords): Change format of compiled values.
	Document it.
	(font-lock-add-keywords): If font-lock-keywords is compiled,
	extract the uncompiled version, modify, then recompile.
	(font-lock-remove-keywords): Likewise.
	(font-lock-fontify-keywords-region): Handle changed format.
	(font-lock-compile-keywords): Handle changed format.
	(font-lock-set-defaults): Compile the keywords explicitly here.

2004-06-24  David Kastrup  <dak@gnu.org>

	* replace.el (query-replace-read-args): Implement `\,' and `\#'
	replacements here.
	(query-replace-regexp): Doc string explaining this and the new
	`\?' replacement.  Remove `\,' and `\#' implementation here, as it
	is better placed in `query-replace-read-args'.
	(replace-regexp): Explain `\,', `\#' and `\?'.
	(replace-match-data): New function for thorough reuse/destruction
	of old match-data.
	(replace-match-maybe-edit): Function for implementing `\?' editing.
	(perform-replace): Fix maintaining of the match stack including
	already matched regions, implement `\?', fix various problems
	with regions while editing and other stuff.
	(replace-highlight): Simplify.

2004-06-24  Daniel Pfeiffer  <occitan@esperanto.org>

	* progmodes/grep.el (grep-error-screen-columns): New variable.
	(grep-regexp-alist): Give it the full functionality of gnu style
	compilation messages with line and column ranges.  Ask me for the
	perl script I'm working on, that uses these.

2004-06-23  Nick Roberts  <nickrob@gnu.org>

	* comint.el (comint-insert-clicked-input, comint-copy-old-input):
	Remove.
	(comint-insert-input, comint-mouse-insert-input): New functions
	based on comint-insert-clicked-input for two bindings but just
	one functionality.

2004-06-23  Luc Teirlinck  <teirllm@auburn.edu>

	* net/goto-addr.el (goto-address-fontify): Fix help-echo text.

2004-06-23  Lars Hansen  <larsh@math.ku.dk>

	* files.el (write-contents-functions): Doc fix.

2004-06-21  Juanma Barranquero  <lektu@terra.es>

	* image.el (image-library-alist): Rewrite docstring in active voice.

2004-06-20  Richard M. Stallman  <rms@gnu.org>

	* mouse.el (mouse-set-region-1): Set transient-mark-mode to `only'.

	* isearch.el (isearch-repeat): Avoid testing old match data.
	(isearch-message): Display trailing space in special font
	when search is failing.
	(isearch-search-fun-function): Doc fix.

	* autorevert.el (global-auto-revert-non-file-buffers): Doc fix.

2004-06-19  Luc Teirlinck  <teirllm@auburn.edu>

	* frame.el (show-trailing-whitespace): Doc fix.

	* cus-edit.el (custom-variable-documentation): New function.
	(custom-variable): Use it.

2004-06-19  Nick Roberts  <nickrob@gnu.org>

	* man.el (Man-getpage-in-background): Revert previous change but
	make cygwin a special case.

2004-06-18  Luc Teirlinck  <teirllm@auburn.edu>

	* autorevert.el (global-auto-revert-non-file-buffers):
	Update docstring.

2004-06-19  Daniel Pfeiffer  <occitan@esperanto.org>

	* progmodes/compile.el (compilation-error-properties): Store one
	more than end-col, if present, so that transient-mark-mode will
	highlight last char too.
	* progmodes/grep.el (grep-regexp-alist): Match columns and column
	ranges, if present.

2004-06-18  Jason Rumney  <jasonr@gnu.org>

	* makefile.w32-in: Double percent signs in for loops.

2004-06-17  David Kastrup  <dak@gnu.org>

	* replace.el (query-replace-read-args): Only warn about use of \n
	and \t when we are doing a regexp replacement and the actual
	escaped character is n or t.
	(query-replace-regexp): Add \, and \# interpretation to
	interactive call and document it.
	(query-replace-regexp-eval, replace-match-string-symbols): Add \#
	as shortkey for replace-count.
	(replace-quote): New function for doubling backslashes.

2004-06-17  Juanma Barranquero  <lektu@terra.es>

	* files.el (parse-colon-path, cd): Mention in docstring that the
	path separator is colon in GNU-like systems.

	* newcomment.el (comment-region-internal): Fix docstring.

	* emacs-lisp/ewoc.el (ewoc-create, ewoc-map, ewoc-locate)
	(ewoc-invalidate, ewoc-collect): Doc fixes.
	(ewoc--create-node, ewoc--delete-node-internal):
	Fix typos in docstring.

2004-06-15  Luc Teirlinck  <teirllm@auburn.edu>

	* files.el (buffer-stale-function): Add hyperlink to emacs-xtra
	manual to docstring.

2004-06-15  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-print.el (ps-time-stamp-iso8601): Comment doc string of defalias.

2004-06-15  Luc Teirlinck  <teirllm@auburn.edu>

	* dired-aux.el (dired-do-redisplay, dired-maybe-insert-subdir):
	Add hyperlink to emacs-xtra manual to docstring.

	* autorevert.el (global-auto-revert-non-file-buffers):
	Add hyperlink to emacs-xtra manual to docstring, as well as an
	info-link.

2004-06-14  Juanma Barranquero  <lektu@terra.es>

	* image.el (image-library-alist): New variable to map image types
	to external libraries.  Initialized to nil, unless system-specific
	configs change it.
	(image-type-available-p): Determine whether an image type is
	available by calling `init-image-library'.

	* term/w32-win.el (image-library-alist): Initialize to a known set
	of probable library names.

2004-06-14  Kenichi Handa  <handa@m17n.org>

	* international/code-pages.el (windows-1256, cp1125): Fix tables
	for several characters.

	* international/utf-8.el (ccl-encode-mule-utf-8): Fix previous change.

2004-06-13  Richard M. Stallman  <rms@gnu.org>

	* textmodes/paragraphs.el (sentence-end): Add 0x5397d as close brace.

	* emulation/pc-select.el: Doc fixes: say "PC Selection mode",
	not "`pc-selection-mode'".

	* emacs-lisp/bytecomp.el: Put `...' around symbols in warning messages.

	* simple.el (previous-matching-history-element): Specify a default.

	* hexl.el (hexl-mode): Catch errors in hexl-goto-address.

	* cus-face.el (custom-declare-face): Simplify code.

	* abbrev.el (abbrev-mode, edit-abbrevs-map): Doc fixes.

2004-06-13  Luc Teirlinck  <teirllm@auburn.edu>

	* files.el (before-save-hook): Add `time-stamp' to the options.

	* time-stamp.el (time-stamp): Recommend adding it to
	`before-save-hook', rather than `write-file-functions'.
	Make a similar change in `Commentary' section.

2004-06-13  Kai Grossjohann  <kai.grossjohann@gmx.net>

	* diff-mode.el (diff-current-defun): If at start of hunk, use
	position of first change.

2004-06-13  Lars Hansen  <larsh@math.ku.dk>

	* dired-x.el (dired-mark-omitted): Bind to "*O".

2004-06-12  Karl Fogel  <kfogel@red-bean.com>

	* bookmark.el (bookmark-bmenu-relocate): New function, as
	suggested by David J. Biesack <David.Biesack@sas.com>.
	(bookmark-bmenu-mode-map): Bind `bookmark-bmenu-relocate' to "R".
	(bookmark-bmenu-mode): Describe binding in doc string.
	(bookmark-set-filename): Save the bookmark list if it's time.

2004-06-13  Kenichi Handa  <handa@m17n.org>

	* international/utf-8.el (ccl-decode-mule-utf-8): Fix previous change.
	(ccl-untranslated-to-ucs): Fix typo.

2004-06-12  Karl Chen  <quarl@hkn.eecs.berkeley.edu>  (tiny change)

	* progmodes/python.el (python-open-block-statement-p):
	Fix indentation after a block opening that contains a comment.

2004-06-12  J,Ai(Br,At(Bme Marant  <jerome@marant.org>  (tiny change)

	* bindings.el (completion-ignored-extensions): Add file extensions
	of Python byte-compiled files.

2004-06-12  Juri Linkov  <juri@jurta.org>

	* info.el (Info-goto-node): Add autoload.
	(Info-toc): Add substring-no-properties on Info file name.
	(Info-mode, info, Info-toc, Info-mode-menu): Doc fix.
	(Info-mode-map): Bind L to Info-history, T to Info-toc.

2004-06-12  Kenichi Handa  <handa@m17n.org>

	* international/mule-cmds.el (set-language-environment):
	Load subst tables if necessary.

	* international/mule.el (decode-char): Load subst tables if necessary.
	(encode-char): Likewise.

	* international/utf-16.el (utf-16-decode-ucs): Handle a surrogate
	pair correctly.  Call ccl-mule-utf-untrans for untranslable chars.
	(utf-16le-decode-loop): Set r5 to -1 before loop.
	(utf-16be-decode-loop): Likewise.
	(ccl-decode-mule-utf-16le): Add EOF processing block.
	(ccl-decode-mule-utf-16be): Likewise.
	(ccl-decode-mule-utf-16le-with-signature): Likewise.
	(ccl-decode-mule-utf-16be-with-signature): Likewise.
	(ccl-decode-mule-utf-16): Likewise.  Set r5 to -1 initially.
	(ccl-mule-utf-16-encode-untrans): New CCL.
	(utf-16-decode-to-ucs): Handle pre-read character.
	(utf-16le-encode-loop): Handle surrogate pair.
	(utf-16be-encode-loop): Likewise.
	(ccl-encode-mule-utf-16le-with-signature): Adjust for the change
	of utf-16le-encode-loop.
	(ccl-encode-mule-utf-16be-with-signature): Adjust for the change
	of utf-16be-encode-loop.
	(mule-utf-16-post-read-conversion):
	Call utf-8-post-read-conversion at first.
	(mule-utf-16[{le|be}], mule-utf-16{le|be}-with-signature):
	Include CJK charsets in safe-charsets if utf-translate-cjk-mode is on.
	Add post-read-conversion and pre-write-conversion.

	* international/utf-8.el (utf-translate-cjk-charsets): New variable.
	(utf-translate-cjk-unicode-range): New variable.
	(utf-translate-cjk-load-tables): New function.
	(utf-lookup-subst-table-for-decode): New function.
	(utf-lookup-subst-table-for-encode): New function.
	(utf-translate-cjk-mode): Init-value changed to t.  Don't load
	tables here.  Update safe-charsets of utf-* coding systems.
	(ccl-mule-utf-untrans): New CCL.
	(ccl-decode-mule-utf-8): Call ccl-mule-utf-untrans.  Use `repeat'
	at end of each branch.
	(ccl-mule-utf-8-encode-untrans): New CCL.
	(ccl-encode-mule-utf-8): Call ccl-mule-utf-8-encode-untrans.
	(ccl-untranslated-to-ucs): Handle 2-byte encoding.  Set r1 to the
	length of encoding.  Don't return r0.
	(utf-8-compose): New arg hash-table.  Handle 2-byte encoding.
	(utf-8-post-read-conversion): Narrow to region properly.
	If utf-translate-cjk-mode is on, load tables if necessary.
	Call utf-8-compose with hash-table arg if necessary.
	Call XXX-compose-region instead of XXX-post-read-conversion.
	(utf-8-pre-write-conversion): New function.
	(mule-utf-8): Include CJK charsets in safe-charsets if
	utf-translate-cjk-mode is on.  Add pre-write-conversion.

	* international/characters.el: Temporarily set
	utf-translate-cjk-mode to nil.

	* language/devan-util.el (devanagari-compose-region):
	Add autoload cookie.

	* international/ccl.el (ccl-dump-call): Fix printing the
	subroutine name.

2004-06-11  Luc Teirlinck  <teirllm@auburn.edu>

	* dired.el (dired-revert): If buffer is marked unmodified before
	reverting, keep it marked unmodified.
	Adapt to new conventions for commenting out code.
	(dired-make-relative): Adapt to new conventions for commenting out code.

2004-06-10  Miles Bader  <miles@gnu.ai.mit.edu>

	* eshell/esh-module.el (eshell-load-defgroups):
	Bind `vc-handled-backends' to nil when opening files.

2004-06-11  Juanma Barranquero  <lektu@terra.es>

	* files.el (parse-colon-path, cd): Doc fixes (refer to
	`path-separator', not colon).

2004-06-10  Juanma Barranquero  <lektu@terra.es>

	* newcomment.el (comment-search-forward)
	(comment-search-backward): Fix typos in docstring.
	(comment-region): Doc fix.

2004-06-10  Luc Teirlinck  <teirllm@auburn.edu>

	* dired.el (dired-insert-old-subdirs): Adapt to fact that the R
	switch is no longer stored in `dired-switches-alist'.

	* dired-aux.el (dired-insert-subdir): Do not store R switch in
	`dired-switches-alist'.

2004-06-10  Kim F. Storm  <storm@cua.dk>

	* pcvs.el (cvs-mode-diff-yesterday): New command.

	* pcvs-defs.el (cvs-mode-diff-map): Bind y to cvs-mode-diff-yesterday.

2004-06-10  Juri Linkov  <juri@jurta.org>

	* emacs-lisp/edebug.el (edebug-eval-defun):
	* emacs-lisp/lisp-mode.el (eval-defun-1): Add `defface'.
	Fix docstring.

	* simple.el (eval-expression-print-format): Don't print additional
	information on the first call to `eval-print-last-sexp'.
	(next-error-find-buffer): Fix punctuation.
	(killing) <defgroup>: Fix punctuation.
	(yank-excluded-properties): Change group from editing to killing.

	* replace.el (perform-replace): Use `limit' to terminate the
	while-loop explicitly.

2004-06-09  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* toolbar/tool-bar.el (tool-bar-add-item, tool-bar-local-item):
	Use lc-*.xpm as prefix instead of *-locol.xpm.

	* toolbar/lc-copy.xpm, toolbar/lc-cut.xpm
	* toolbar/lc-help.xpm, toolbar/lc-home.xpm
	* toolbar/lc-index.xpm, toolbar/lc-jump_to.xpm
	* toolbar/lc-left_arrow.xpm, toolbar/lc-new.xpm
	* toolbar/lc-open.xpm, toolbar/lc-paste.xpm
	* toolbar/lc-preferences.xpm, toolbar/lc-print.xpm
	* toolbar/lc-right_arrow.xpm, toolbar/lc-save.xpm
	* toolbar/lc-saveas.xpm, toolbar/lc-search.xpm
	* toolbar/lc-spell.xpm, toolbar/lc-undo.xpm
	* toolbar/lc-up_arrow.xpm:
	Rename from *-locol.xpm.

2004-06-09  Rajesh Vaidheeswarran  <rv@gnu.org>

	* ffap.el (ffap-string-at-point-mode-alist): Fix the url mode to
	include forms like &<str>; as valid url patterns.

2004-06-08  Luc Teirlinck  <teirllm@auburn.edu>

	* dired.el (dired-diff, dired-backup-diff)
	(dired-clean-directory, dired-do-chmod, dired-do-chgrp)
	(dired-do-chown, dired-do-touch, dired-do-print)
	(dired-do-shell-command, dired-do-kill-lines, dired-do-compress)
	(dired-do-byte-compile, dired-do-load, dired-do-redisplay)
	(dired-create-directory, dired-do-copy, dired-do-symlink)
	(dired-do-hardlink, dired-do-rename, dired-do-rename-regexp)
	(dired-do-copy-regexp, dired-do-hardlink-regexp)
	(dired-do-symlink-regexp, dired-upcase, dired-downcase)
	(dired-maybe-insert-subdir, dired-next-subdir)
	(dired-prev-subdir, dired-goto-subdir, dired-mark-subdir-files)
	(dired-kill-subdir, dired-tree-up, dired-tree-down)
	(dired-hide-subdir, dired-hide-all, dired-show-file-type)
	(dired-run-shell-command, dired-query): Remove redundant,
	or incorrect, autoloads.

	* dired-aux.el (dired-kill-tree): Do not kill DIRNAME, even if it
	does not end in a slash.  Add optional argument KILL-ROOT.
	Update docstring.
	(dired-do-touch, dired-clean-directory, dired-run-shell-command)
	(dired-query): Add autoloads.

2004-06-08  Daniel Pfeiffer  <occitan@esperanto.org>

	* progmodes/compile.el (compilation-set-window-height):
	Rearrange the save-* functions because a buffer can have several current
	point in different windows.
	(compilation-error-regexp-alist-alist): Recognize {standard input}
	GNU messages (for gcc --pipe) and more kinds of Oracle messages.

2004-06-08  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* toolbar/copy-locol.xpm, toolbar/cut-locol.xpm
	* toolbar/help-locol.xpm, toolbar/home-locol.xpm
	* toolbar/index-locol.xpm, toolbar/jump_to-locol.xpm
	* toolbar/left_arrow-locol.xpm, toolbar/new-locol.xpm
	* toolbar/open-locol.xpm, toolbar/paste-locol.xpm
	* toolbar/preferences-locol.xpm, toolbar/print-locol.xpm
	* toolbar/right_arrow-locol.xpm, toolbar/save-locol.xpm
	* toolbar/saveas-locol.xpm, toolbar/search-locol.xpm
	* toolbar/spell-locol.xpm, toolbar/undo-locol.xpm
	* toolbar/up_arrow-locol.xpm:
	New versions of icons that uses fewer colors.

	* toolbar/tool-bar.el (tool-bar-local-item)
	(tool-bar-local-item-from-menu): Try to use icons with fewer colors
	if display-color-cells is 256 or less.

2004-06-08  Kim F. Storm  <storm@cua.dk>

	* wid-edit.el (widget-specify-button): Use hand pointer rather
	than mouse-face as visible mouse-over effect.

2004-06-07  Karl Fogel  <kfogel@red-bean.com>

	* saveplace.el (save-place-alist-to-file): Bind `print-length'
	and `print-level' to nil when writing out `save-place-alist'.
	Thanks to Kai Grossjohann <kai@emptydomain.de> for enlightenment.

2004-06-07  Juanma Barranquero  <lektu@terra.es>

	* completion.el (completion-kill-region): Doc fix.

	* format.el (format-insert-annotations)
	(format-annotate-location): Doc fixes.
	(format-subtract-regions): Make arguments match their use in docstring.

	* simple.el (kill-region): Doc fix.

	* subr.el (insert-buffer-substring-no-properties)
	(insert-buffer-substring-as-yank): Doc fixes.

2004-06-07  Luc Teirlinck  <teirllm@auburn.edu>

	* dired-aux.el (dired-do-redisplay, dired-maybe-insert-subdir):
	Update docstring.
	(dired-reset-subdir-switches): New function.

	* dired.el (dired-undo): Call `dired-build-subdir-alist'.
	Limit scope of `buffer-read-only' binding.

2004-06-06  Emilio C. Lopes  <eclig@gmx.net>

	* eshell/esh-cmd.el (eshell/which): Respect commands quoted with
	eshell-explicit-command-char.

2004-06-06  Juanma Barranquero  <lektu@terra.es>

	* help-fns.el (help-argument-name): Inherit from italic face only
	if the frame supports it.

2004-06-06  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* toolbar/alias.pbm, toolbar/close.pbm, toolbar/copy.pbm
	* toolbar/cut.pbm, toolbar/help.pbm, toolbar/home.pbm
	* toolbar/index.pbm, toolbar/jump_to.pbm, toolbar/left_arrow.pbm
	* toolbar/new.pbm, toolbar/open.pbm, toolbar/paste.pbm
	* toolbar/preferences.pbm, toolbar/print.pbm, toolbar/right_arrow.pbm
	* toolbar/save.pbm, toolbar/saveas.pbm, toolbar/search.pbm
	* toolbar/spell.pbm, toolbar/undo.pbm, toolbar/up_arrow.pbm:
	New conversions from xpm files.

	* toolbar/README: New file.

2004-06-06  Richard M. Stallman  <rms@gnu.org>

	* isearch.el (isearch-mode-map): Undo previous change.

2004-06-05  Juri Linkov  <juri@jurta.org>

	* bindings.el (debug-ignored-errors): Add regexps for history
	related messages.  Remove $ from "No further undo information".
	Move Ediff's messages to ediff.el.

	* ediff.el: Move Ediff's debug-ignored-errors from bindings.el.

	* cus-edit.el (custom-display): Add `min-colors'.

	* custom.el (defface): Add `supports' to docstring.

	* help-fns.el (help-argument-name): Add :group 'help.

2004-06-05  Luc Teirlinck  <teirllm@auburn.edu>

	* find-dired.el (find-ls-subdir-switches): New user option.
	(find-dired): No longer call `abbreviate-file-name' on DIR.
	Set `dired-subdir-switches' buffer-locally.

	* locate.el: Merge the two `Commentary' sections.
	(locate-ls-subdir-switches): New user option.
	(locate): Update for other changes.
	(locate-mode-map): Restore Dired binding for mouse-2.
	Bind `locate-mouse-view-file' to M-mouse-2.
	Bind `l' to `locate-do-redisplay'.
	(locate-main-listing-line-p, locate-do-redisplay): New functions.
	(locate-mouse-view-file, locate-tags, locate-find-directory):
	Print message if used outside main listing.
	(locate-mode): Update docstring.  Make `*Locate*' buffer read-only.
	Various changes to support inserted subdirectories.
	(locate-insert-header): Change header of *Locate* buffer.

	* dired-aux.el (dired-do-redisplay, dired-maybe-insert-subdir):
	Change interactive default switches.
	(dired-rename-subdir-2): Update `dired-switches-alist'.
	(dired-insert-subdir, dired-kill-subdir):
	Handle `dired-switches-alist'.  Do not mark buffer modified.
	(dired-insert-subdir-validate): Handle `dired-subdir-switches'.
	(dired-insert-subdir-doinsert): Omit messages.
	Handle `dired-subdir-switches'.
	(dired-hide-subdir, dired-hide-all): Do not mark buffer modified.

	* dired.el (dired-subdir-switches, dired-switches-alist): New vars.
	(dired-insert-old-subdirs): Do not repeatedly delete and reinsert
	subdirs if -R switch is used for a subdir.
	(dired-mode): Set `dired-switches-alist'.
	(dired-build-subdir-alist): Only print number of directories in
	echo area when invoked interactively.

2004-06-05  Lars Hansen  <larsh@math.ku.dk>

	* dired-x.el (dired-omit-mode): Rename from
	dired-omit-files-p.  Use define-minor-mode to define it.
	(dired-omit-files-p): Add as alias for dired-omit-mode.
	(dired-omit-toggle): Delete.  Replaced by dired-omit-mode and
	dired-mark-omitted.
	(dired-mark-omitted): Add.  Bind to M-O.

2004-06-05  Kenichi Handa  <handa@m17n.org>

	* ps-print.el: Fix typos (kein'ichi -> ken'ichi)

2004-06-05  Juanma Barranquero  <lektu@terra.es>

	* help-fns.el (help-argument-name): Reintroduce face.
	(help-default-arg-highlight): Use it, now that
	`face-differs-from-default-p' can be trusted.

2004-06-05  Matt Hodges  <matt@stchem.bham.ac.uk>  (tiny change)

	* textmodes/table.el: Sentence commands added to Point Motion
	group; kill and backward-kill commands added to Extraction group.

2004-06-04  Mario Lang  <mlang@delysid.org>

	* battery.el (battery-linux-proc-acpi): `mA' was hardcoded, but some
	systems appear to use mW, make the code handle this.  Fix a
	division-by-zero bug while at it, and handle kernels with
	a slightly different layout in /proc/acpi.

2004-06-04  Karl Fogel  <kfogel@red-bean.com>

	* vc-svn.el (vc-svn-checkin): Use `nconc' instead of `list*',
	because the latter is a CL-ism.  This fixes the bug reported by
	Shawn Boyette <mdxi@collapsar.net> in
	http://lists.gnu.org/archive/html/emacs-devel/2004-05/msg00442.html.

2004-06-04  Miles Bader  <miles@gnu.org>

	* faces.el (display-supports-face-attributes-p): Function moved to
	C code.  Previously only the tty-related portion of this function
	was done in C; however the previous attempt to do a halfway-proper
	job for non-tty displays in lisp didn't work properly because of
	funny conditions during Emacs startup.
	(face-differs-from-default-p): Simplify, now that
	display-supports-face-attributes-p works properly on all display
	types.  Remove :stipple from comparison; it doesn't really work
	in emacs anyway.

2004-06-04  Miles Bader  <miles@gnu.org>

	* faces.el (face-differs-from-default-p): Use a different
	implementation, so we can really check whether FACE displays
	differently or not.

2004-06-04  Miles Bader  <miles@gnu.org>

	* faces.el (display-supports-face-attributes-p): Implement a
	`different from default' check for non-tty displays.

2004-06-03  David Kastrup  <dak@gnu.org>

	* woman.el (woman-mapcan): More concise code.
	(woman-topic-all-completions, woman-topic-all-completions-1)
	(woman-topic-all-completions-merge): Replace by a simpler and
	much faster implementation based on O(n log n) sort/merge instead
	of the old O(n^2) behavior.

2004-06-03  Miles Bader  <miles@gnu.org>

	* subr.el (read-number): Use canonical format for default in prompt.

	* minibuf-eldef.el (minibuffer-default-in-prompt-regexps):
	Add regexp for " [...]" style defaults.

2004-06-02  Romain Francoise  <romain@orebokech.com>

	* ibuf-ext.el (ibuffer-jump-to-buffer): Add support for filter
	groups: if the user asks for a hidden buffer, open the
	corresponding filter group to expose it.

	* ibuffer.el (ibuffer-mode-map): Add key binding `M-g' to
	`ibuffer-jump-to-buffer'.
	(ibuffer-jump-offer-only-visible-buffers): New user option.

2004-06-02  Juanma Barranquero  <lektu@terra.es>

	* faces.el (frame-update-faces): Add empty docstring so the one
	for `ignore' doesn't show through.

	* subr.el (process-kill-without-query): Remove spurious "\n" on
	obsolescence string.
	(focus-frame, unfocus-frame): Add obsolescence declaration and
	empty docstring.

	* international/mule.el (register-char-codings): Make alias for
	`ignore'.  Move docstring to obsolescence info and remove redundancy.

2004-06-02  Kim F. Storm  <storm@cua.dk>

	* frame.el (blink-cursor-start): Turn cursor off initially so blink
	starts after blink-cursor-delay rather than 2*blink-cursor-delay.

2004-06-01  Stefan Monnier  <monnier@iro.umontreal.ca>

	* comint.el (comint-replace-by-expanded-history-before-point):
	Obey `start' as the docstring says.
	(comint-send-input, comint-snapshot-last-prompt, comint-output-filter)
	(comint-update-fence): Prevent font-lock from running unnecessarily.
	(comint-dynamic-list-completions): Use with-current-buffer.

2004-06-01  Roland Winkler  <Roland.Winkler@physik.uni-erlangen.de>

	* textmodes/bibtex.el (bibtex-format-entry): Fix regexps.
	(bibtex-parse-strings): Bugfix, use assoc instead of assoc-string.
	(bibtex-entry-update): Handle alternatives and optional fields.
	(bibtex-parse-entry): Bugfix, handle empty key.

2004-05-31  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-arch.el (vc-arch-state): Don't assume the file exists.

2004-05-31  Lars Hansen  <larsh@math.ku.dk>

	* desktop.el (desktop-save): Don't save minor modes without a
	known mode initialization function.

2004-05-30  Luc Teirlinck  <teirllm@auburn.edu>

	* replace.el (query-replace-interactive): Convert defvar -> defcustom.

	* autorevert.el: Update `Commentary' section.

2004-05-30  Juanma Barranquero  <lektu@terra.es>

	* dos-fns.el (convert-standard-filename):
	* files.el (convert-standard-filename):
	* w32-fns.el (convert-standard-filename):
	Rework docstring (wording by Eli Zaretskii and Kai Grossjohann).

2004-05-30  Kai Grossjohann  <kai.grossjohann@gmx.net>

	Sync with Tramp.

	* net/tramp.el (tramp-let-maybe): Reverse args of `get'.
	(tramp-let-maybe): Move to an earlier spot in the file.
	Patch by Andreas Schwab.

2004-05-30  Andreas Schwab  <schwab@suse.de>

	* dired.el (dired-get-filename): Don't use dired-re-dot.

2004-05-30  Richard M. Stallman  <rms@gnu.org>

	* files.el (find-file): Doc fix.

	* font-lock.el (lisp-font-lock-keywords-2): Add multiple-value-bind.

2004-05-30  Nick Roberts  <nickrob@gnu.org>

	* progmodes/gdb-ui.el (gdb-current-frame, gud-watch)
	(gdb-locals-mode, gdb-frame-handler): Display current frame in the
	modeline of the locals buffer.
	(gdb-goto-breakpoint): Handle gdbmi.
	(gdb-get-frame-number): Change for gdbmi.

2004-05-30  Michael Albinus  <michael.albinus@gmx.de>

	* files.el (file-remote-p): Apply file name handler for operation
	`file-remote-p'.  It isn't a property any longer.
	(file-relative-name): `fh' and `fd' get the required value via
	`find-file-name-handler' already.

	* ange-ftp.el (ange-ftp-file-remote-p): New defun.
	(top): Remove setting of `file-remote-p' property for
	`ange-ftp-hook-function'.  Add `ange-ftp' property to `file-remote-p'.

2004-05-29  Michael Albinus  <michael.albinus@gmx.de>

	Version 2.0.41 of Tramp released.

	* tramp.el (tramp-wait-for-regexp, tramp-wait-for-output):
	Throw away if process has died.
	Reported by Luc Teirlinck <teirllm@dms.auburn.edu>.
	(tramp-out-of-band-prompt-regexp): Rename to
	`tramp-process-alive-regexp', because its usage is widen.
	(tramp-actions-copy-out-of-band): Apply it.
	(tramp-actions-before-shell, tramp-multi-actions):
	Add `tramp-action-process-alive' action.
	(tramp-action-process-alive): New defun.
	(tramp-file-name-handler-alist, tramp-file-name-for-operation):
	Add entry for `file-remote-p'.
	(tramp-handle-file-remote-p): New defun.
	(top): Remove setting of `file-remote-p'.  Don't set
	`inhibit-file-name-handlers' and `inhibit-file-name-operation'.

	* tramp-smb.el (tramp-smb-file-name-handler-alist): Add entry for
	`file-remote-p'.

	* tramp-uu.el (tramp-uuencode-region): Padding characters aren't
	counted for (last) line.  [They should or they shouldn't?  --Stef]
	Reported by Aaron Ucko <ucko@ncbi.nlm.nih.gov>.

2004-05-29  Kai Grossjohann  <kai.grossjohann@gmx.net>

	* tramp.el (tramp-initial-commands): Add "unset HISTFILE"; this is
	not really necessary but seems to keep the shell history smaller
	in some cases.  It is no substitute for setting HISTFILE and
	HISTSIZE from tramp-open-connection-setup-interactive-shell,
	though.  Suggested by Luc Teirlinck.
	(tramp-open-connection-setup-interactive-shell): Export variables
	HISTFILE and HISTSIZE, do not just set them.  From Luc Teirlinck.
	(tramp-set-process-query-on-exit-flag): New compat function.
	(tramp-open-connection-multi, tramp-open-connection-su)
	(tramp-open-connection-rsh, tramp-open-connection-telnet)
	(tramp-do-copy-or-rename-file-out-of-band): Use it.
	(tramp-let-maybe): New macro, let-binds a variable only if it
	isn't obsolete.
	(tramp-check-ls-commands, tramp-handle-expand-file-name)
	(tramp-handle-file-truename): Use it.
	(tramp-completion-file-name-regexp-unified): Avoid matching
	filenames starting with "/:" -- those are reserved for
	file-name-non-special.

	* tramp-smb.el (tramp-smb-open-connection):
	Use tramp-set-process-query-on-exit-flag compat function.

2004-05-29  Richard M. Stallman  <rms@gnu.org>

	* net/browse-url.el (browse-url-interactive-arg): Doc fix.

	* emacs-lisp/lisp-mode.el (prin1-char): Catch errors from `string'.
	(eval-last-sexp-print-value): Print char equivalent regardless
	of standard-output value.

	* thumbs.el (thumbs-subst-char-in-string): Delete.
	(thumbs-thumbname): Use subst-char-in-string.
	(thumbs-resize-image): Use condition-case, not ignore-errors.
	(thumbs-kill-buffer): Likewise.

	* thumbs.el: Don't include cl.  Don't bother with old Emacs versions.
	(thumbs-mode): Make buffer read-only.
	(thumbs-make-thumb): Unconditionally accept an existing file.
	(thumbs-insert-thumb): Add thumb-image-file property to the image.
	(thumbs-do-thumbs-insertion): Be smarter about where to put newlines.
	(thumbs-show-thumbs-list): Error if images not supported.
	(thumbs-save-current-image): Improve prompt string.
	(thumbs-mode-map): Define u, R, x.
	(thumbs-unmark): New command.
	(thumbs-emboss-image): Minor cleanup.
	(thumbs-forward-char, thumbs-backward-char): Skip chars with no image.
	(thumbs-rename-images): New command.
	(thumbs-show-image-num): Rewrite.  Don't rename the buffer.

	* thumbs.el (thumbs-current-image): New function.
	(thumbs-file-list, thumbs-file-alist): New functions.
	(thumbs-find-image): Delete arg L.
	Don't set up thumbs-fileL as buffer-local global var.
	(thumbs-find-image-at-point): Use thumbs-current-image.
	(thumbs-set-image-at-point-to-root-window): Likewise.
	(thumbs-delete-images): Use thumbs-current-image, thumbs-file-alist.
	Record and warn about errors.  Update thumbs-markedL for deletions.
	(thumbs-next-image, thumbs-previous-image): Use thumbs-file-alist.
	(thumbs-redraw-buffer): Use thumbs-file-list.
	(thumbs-mark): Use thumbs-current-image.
	(thumbs-show-name): Use thumbs-current-image.

	* imenu.el (imenu--menubar-select): Set imenu-menubar-modified-tick
	and imenu--last-menubar-index-alist.

	* subr.el (with-selected-window): Undo previous change.

2004-05-29  John Paul Wallington  <jpw@gnu.org>

	* thumbs.el (thumbs-show-name): Do nothing if no image at point.
	(thumbs-mouse-find-image): New command.
	(thumbs-mode-map): Bind it to mouse-2.
	(thumbs-mode): Make mode-class special.
	(thumbs-view-image-mode): Likewise.

2004-05-29  Pavel Kobiakov  <pk_at_work@yahoo.com>

	* flymake.el: New file.

2004-05-28  Luc Teirlinck  <teirllm@auburn.edu>

	* files.el (find-file-noselect-1): Do not bind
	`inhibit-read-only' to t during execution of
	`find-file-not-found-functions'.

2004-05-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-mcvs.el (vc-mcvs-print-log, vc-mcvs-diff):
	* vc-arch.el (vc-arch-diff): Add optional `buffer' arg.

2004-05-28  Juri Linkov  <juri@jurta.org>

	* simple.el (eval-expression-print-format): New fun.

	* simple.el (eval-expression):
	* emacs-lisp/lisp-mode.el (eval-last-sexp-print-value):
	* emacs-lisp/edebug.el (edebug-compute-previous-result)
	(edebug-eval-expression): Print additionally the value returned by
	`eval-expression-print-format'.

	* emacs-lisp/lisp.el (insert-pair-alist): New var.
	(insert-pair): Make arguments optional.  Find character pair
	from `insert-pair-alist' according to the last input event.
	(insert-parentheses): Make arguments optional.
	(raise-sexp, delete-pair): New funs.

	* emacs-lisp/lisp-mode.el (indent-pp-sexp): New fun.
	(emacs-lisp-mode-map, lisp-interaction-mode-map):
	Bind C-M-q to `indent-pp-sexp'.

	* emacs-lisp/pp.el (pp-buffer): New fun created from the code in
	`pp-to-string' modified to be able to format text with newlines.
	(pp-to-string): Move the buffer-formatting part of the code to
	`pp-buffer'.  Call `pp-buffer'.

	* info.el (Info-desktop-buffer-misc-data): Don't save information
	about virtual files.
	(Info-restore-desktop-buffer): Restore Info buffers in prepared
	buffers with names obtained from the desktop file instead of the
	default *info* buffer.

2004-05-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* subr.el (with-selected-window): Only save/restore the selected window.

	* progmodes/compile.el (compilation-error-regexp-alist):
	Use expand-file-name and data-directory.

	* progmodes/grep.el (grep-tree): Rework previous fix.

	* mouse.el (mouse-set-region-1): Use temporary transient-mark-mode
	after the user marked text with the mouse.

	* startup.el (command-line): Keep the first regexp of
	auto-save-file-name-transforms intact.

2004-05-28  Juanma Barranquero  <lektu@terra.es>

	* cus-edit.el (customize-face, customize-face-other-window)
	(custom-face-edit-delete): Make arguments match their use in
	docstring.
	(custom-unloaded-symbol-p, custom-unloaded-widget-p): Fix typo in
	docstring.

	* cvs-status.el (cvs-tree-merge, cvs-tags->tree): Use `butlast',
	not `cvs-butlast'.

	* pcvs-util.el (cvs-butlast, cvs-nbutlast): Remove (`butlast' and
	`nbutlast' are in subr.el).

	* w32-fns.el (w32-using-nt, w32-shell-dos-semantics)
	(set-w32-system-coding-system): Doc fixes.

	* textmodes/artist.el (artist-last, artist-remove-nulls): Simplify.
	(artist-draw-ellipse-general, artist-draw-ellipse-with-0-height):
	Make arguments match their use in docstring.
	(artist-draw-region-trim-line-endings)
	(artist-mouse-choose-operation): Fix typo in docstring.
	(artist-key-set-point-common): Doc fix.

2004-05-28  Simon Josefsson  <jas@extundo.com>

	* mail/smtpmail.el (smtpmail-open-stream):
	Bind starttls-extra-arguments too, if starttls.el uses GNUTLS.

2004-05-26  Simon Josefsson  <jas@extundo.com>

	* starttls.el: Merge with my GNUTLS based starttls.el.
	(starttls-gnutls-program, starttls-use-gnutls)
	(starttls-extra-arguments, starttls-process-connection-type)
	(starttls-connect, starttls-failure, starttls-success): New variables.
	(starttls-program, starttls-extra-args): Doc fix.
	(starttls-negotiate-gnutls, starttls-open-stream-gnutls): New funs.
	(starttls-negotiate, starttls-open-stream): Check `starttls-use-gnutls'
	and pass on to corresponding *-gnutls function if it is set.

2004-05-27  Luc Teirlinck  <teirllm@auburn.edu>

	* autorevert.el (auto-revert-handler): Disable auto-reverting of
	remote files.

2004-05-27  Michael Albinus  <michael.albinus@gmx.de>

	* files.el (file-name-non-special): There are more operations
	which need handling: `find-backup-file-name',
	`insert-file-contents', `verify-visited-file-modtime',
	`write-region'.  Rename t value of method to `add'.  Add new
	methods `quote' and `unquote-then-quote' to file-arg-indices.

2004-05-25  Juri Linkov  <juri@jurta.org>

	* info.el (Info-toc): Call Info-mode on intermediate buffer.
	(Info-index-nodes): Enclose code in condition-case to catch errors.
	(Info-index-node): Don't search all index nodes if request is only
	for the current node and file is not in the cache of index nodes.
	(Info-mode-map): Bind Info-copy-current-node-name to `w'
	for consistency with dired-copy-filename-as-kill.
	Bind `S' to Info-search-case-sensitively.
	(Info-copy-current-node-name): New arg.  With zero prefix arg put
	the name inside a function call to `info'.  Display copied text in
	the echo area.

2004-05-25  Sam Steingold  <sds@gnu.org>

	* emacs-lisp/lisp-mode.el (lisp-find-tag-default): New function:
	strip the package prefix from the symbol name, if any.
	Make it the `find-tag-default-function' for `lisp-mode'.

2004-05-25  John Paul Wallington  <jpw@gnu.org>

	* gs.el (gs-load-image): Use `set-process-query-on-exit-flag'
	instead of obsolete `process-kill-without-query'.

	* textmodes/texinfmt.el (texinfo-indexvar-alist):
	Declare as variable, not constant.

2004-05-25  Luc Teirlinck  <teirllm@auburn.edu>

	* files.el (find-file-noselect-1): Fix bug introduced by
	Revision 1.694.  As a side effect, `inhibit-read-only'
	is again, by default, t during execution of
	`find-file-not-found-functions'.
	(insert-directory): Check that lines were really inserted by
	the --dired switch, before erasing them.

2004-05-24  Nick Roberts  <nickrob@gnu.org>

	* progmodes/gdb-ui.el (gdb-breakpoints-mode, gdb-frames-mode)
	(gdb-locals-mode): Check gud-minor-mode in gud-comint-buffer.
	(gdb-var-update, gdb-var-update-handler, gdb-var-delete)
	(gdb-edit-value, gdb-speedbar-expand-node): Handle new value for
	gud-minor-mode (gdbmi).

2004-05-24  Yoichi NAKAYAMA  <yoichi@geiin.org>  (tiny change)

	* net/browse-url.el (browse-url-interactive-arg): Enable user to
	explicitly select the text to be taken as URL.

2004-05-23  Juri Linkov  <juri@jurta.org>

	* info.el (Info-index-nodes): New var and fun.
	(Info-goto-index, Info-index, info-apropos)
	(Info-find-emacs-command-nodes): Rewrite to use Info-index-nodes.
	(Info-index): Fix docstring.  Store and restore Info-history-list.
	(Info-complete-nodes): New var.
	(Info-complete-menu-item): Use it.
	(Info-index-node): New fun.
	(Info-final-node, Info-forward-node, Info-backward-node)
	(Info-build-toc, Info-try-follow-nearest-node, Info-fontify-node):
	Use Info-index-node.
	(Info-extract-menu-item, Info-extract-menu-counting): Set second
	arg of `Info-extract-menu-node-name' to non-nil for index nodes.
	(Info-find-node-2): If a node with period in its name not found,
	try to find a node without the name part after period.
	(Info-select-node): Call Info-fontify-node only if
	Info-fontify-maximum-menu-size is not nil.
	(info-apropos): Set Info-fontify-maximum-menu-size to nil.
	(Info-find-emacs-command-nodes, Info-goto-emacs-command-node):
	Preserve Info-history-list.
	(Info-toc): Set Info-current-file.
	(Info-build-toc): Move point to the beginning of the buffer.
	Add main-file variable.
	(Info-dir-remove-duplicates, Info-history, Info-toc, info-apropos):
	Use backslashed representation of the control character ^_.

	* textmodes/texinfmt.el (texinfo-print-index): Print index line
	numbers in the new Texinfo 4.7 format.

	* add-log.el (change-log-font-lock-keywords): Remove `:' from
	regexps for function and variable names.

	* descr-text.el (describe-property-list): Add [show] button for
	`syntax-table' property with action to pp to a separate buffer.
	(describe-char): Replace search-forward by re-search-forward with
	whitespace regexp after "character:" to not fail in too narrow windows.

	* simple.el (next-error-find-buffer): Add a rule to return
	next-error capable buffer if one window on the selected frame
	displays such buffer.

2004-05-23  Nick Roberts  <nickrob@gnu.org>

	* progmodes/gdb-ui.el (gdb-server-prefix): New variable.
	(gud-watch, gdb-send-item, gdb-breakpoints-mode, gdb-frames-mode)
	(gdb-locals-mode, gdb-send-item, gdb-toggle-breakpoint)
	(gdb-delete-breakpoint, gdb-frames-select, gdb-threads-buffer)
	(gdb-registers-buffer, gdb-reset, gdb-assembler-buffer):
	Handle new value for gud-minor-mode (gdbmi).
	(gdb-buffer-type, gdb-input-queue, gdb-prompting)
	(gdb-output-sink, gdb-current-item, gdb-pending-triggers):
	Change from local to global gdb variable set.
	(gdb-ann3): Initialize above gdb variable set.
	(gdb-var-update, gdb-var-update-handler, gdb-enqueue-input)
	(gdb-dequeue-input, gdb-source, gdb-pre-prompt, gdb-prompt)
	(gdb-subprompt, gdb-starting, gdb-stopping, gdb-frame-begin)
	(gdb-stopped, gdb-post-prompt, gdb-concat-output)
	(def-gdb-auto-update-trigger, def-gdb-auto-update-handler)
	(gdb-info-locals-handler, gdb-invalidate-assembler)
	(gdb-get-current-frame, gdb-frame-handler): Handle gdb variable
	set as global variables.
	(gdb-get-create-buffer): Don't make gud-comint buffer-local.
	Handle gdbmi.
	(gdb-info-breakpoints-custom): Fix regexp.
	(def-gdb-var): Delete.

	* progmodes/gud.el (gud-menu-map, gud-speedbar-menu-items)
	(gud-speedbar-buttons, gud-sentinel, gud-display-line)
	(gud-basic-call): Handle new value for gud-minor-mode (gdbmi) for
	a new mode.  The file (gdb-mi.el) for this mode will be included
	with the GDB distribution (6.2 onwards) and will use GDB/MI as its
	primary interface.

2004-05-23  Jesper Harder  <harder@ifa.au.dk>

	* progmodes/grep.el (grep-tree): Ensure that DIR argument is
	interpreted as a directory.

2004-05-22  Richard M. Stallman  <rms@gnu.org>

	* textmodes/paragraphs.el (sentence-end): Match unicode curly quotes
	as a close quote.

	* textmodes/bibtex.el: Use assoc-string, not assoc-ignore-case.

	* progmodes/idlw-shell.el (idlwave-shell-get-object-class):
	Use assoc-string, not assoc-ignore-case.

	* progmodes/ada-mode.el: Use assoc-string, not assoc-ignore-case.

	* emacs-lisp/lisp.el (mark-defun, narrow-to-defun):
	If moving back then fwd gets a defun that ends before point,
	try again moving fwd then back.

	* files.el (file-name-non-special): Allow t in file-arg-indices
	to mean requote the return value.  Use `identity' as an element
	rather than as the whole value.

	* gs.el (gs-options): Add -dSAFER.  Mark it risky.

2004-05-22  Juanma Barranquero  <lektu@terra.es>

	* help-fns.el (help-add-fundoc-usage): Use %S only for output of
	`help-make-usage'.
	(help-highlight-arguments): Skip function name before searching
	for arguments.

2004-05-21  Juanma Barranquero  <lektu@terra.es>

	* allout.el (allout-chart-subtree, allout-rebullet-topic-grunt):
	Don't mention in the docstring these arguments meant for
	internal (recursive) use only.
	(allout-char-spec): Comment out (it's not implemented).
	(allout-old-expose-topic, allout-exposure): Fix docstring and add
	obsolescence declaration.
	(allout-flatten-exposed-to-buffer)
	(allout-indented-exposed-to-buffer): Fix typos in docstring.
	(my-mark-marker): Doc fix.
	(produce-allout-mode-map, allout-sibling-index)
	(allout-isearch-expose, allout-distinctive-bullet)
	(allout-open-topic, allout-reindent-body)
	(allout-rebullet-heading, allout-process-exposed)
	(allout-insert-listified, allout-latex-verb-quote)
	(allout-insert-latex-header, allout-insert-latex-trailer):
	Make arguments match their use in docstring.
	(allout-primary-bullet, allout-old-style-prefixes)
	(allout-inhibit-protection, allout-init, allout-mode)
	(allout-before-change-protect, allout-flag-region):
	Use "Emacs" instead of "emacs" in docstrings.

2004-05-21  Masayuki Ataka  <ataka@milk.freemail.ne.jp>  (tiny change)

	* international/characters.el: Modify syntax of more characters.

2004-05-21  Masatake YAMATO  <jet@gyve.org>

	* progmodes/etags.el (tags-apropos, list-tags): Require apropos.
	(etags-tags-completion-table): Show parsing progress.

2004-05-20  Luc Teirlinck  <teirllm@auburn.edu>

	* locate.el (locate-prompt-for-command): Shorten first line of
	docstring.
	(locate-mode): Expand docstring and include keymap summary.

	* files.el (find-file-noselect-1): Limit the scope of the
	`inhibit-read-only' binding.  Make sure that `inhibit-read-only'
	is, by default, nil during the execution of
	`find-file-not-found-functions' and `find-file-hook'.

2004-05-20  Michael Mauger  <mmaug@yahoo.com>

	* facemenu.el (facemenu-color-name-equal): New function.
	(list-colors-display): Use it to compare colors instead of
	facemenu-color-equal.

2004-05-20  Dan Nicolaescu  <dann@ics.uci.edu>

	* compare-w.el (compare-windows-face): Use min-colors instead of
	checking for tty or pc types.

2004-05-19  Stefan Monnier  <monnier@iro.umontreal.ca>

	* simple.el (do-auto-fill): Remove unused vars `bol' and `opoint'.
	(completion-setup-function): Use with-current-buffer.
	Properly save excursion.  Simplify.
	Don't assume there is necessarily a `mouse-face' property somewhere.

	* progmodes/gud.el (gud-reset): Use unless & with-current-buffer.

	* progmodes/gdb-ui.el (gdb-reset): Use unless.  Fix regexp.

	* emacs-lisp/bytecomp.el (byte-compile-log): Use backquotes.
	(byte-compile-log-1): Don't call (byte-goto-log-buffer).
	Use with-current-buffer.
	(byte-goto-log-buffer): Delete.
	(byte-compile-log-file): Call compilation-forget-errors.

2004-05-19  Takaaki Ota  <Takaaki.Ota@am.sony.com>  (tiny change)

	* net/ldap.el (ldap-search-internal): Avoid mixing standard error
	output messages into the search result.

2004-05-19  Masatake YAMATO  <jet@gyve.org>

	* wid-edit.el (widget-radio-button-notify): Revert my last
	change.  Reported by Katsumi Yamaoka <yamaoka@jpl.org>.

2004-05-19  Kenichi Handa  <handa@m17n.org>

	* international/characters.el: Fix syntax (open/close) of CJK chars.

2004-05-18  Karl Chen  <quarl@hkn.eecs.berkeley.edu>  (tiny change)

	* help-mode.el (help-go-back): Don't depend on position of back button.

2004-05-18  Stefan Monnier  <monnier@iro.umontreal.ca>

	* files.el (auto-save-file-name-transforms): Make sure ange-ftp temp
	files don't contain an accidental additional /.

	* textmodes/tex-mode.el (tex-compilation-parse-errors): Save excursion
	in source buffer.

2004-05-18  Masatake YAMATO  <jet@gyve.org>

	* wid-edit.el (widget-radio-button-notify): Don't pass `widget'
	to widget-apply.  :action method assumes 2 arguments, not 3.

2004-05-17  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* progmodes/f90.el (f90-end-block-re, f90-start-block-re):
	New constants.
	(hs-special-modes-alist): Add an f90-mode entry.

2004-05-17  Sam Steingold  <sds@gnu.org>

	* emacs-lisp/cl-indent.el (common-lisp-indent-function-1):
	Indent "without-" forms just like "with-" and "do-".  Use regexp-opt.

2004-05-16  Kim F. Storm  <storm@cua.dk>

	* emacs-lisp/timer.el (timer-event-handler): Fix last change.

2004-05-15  John Wiegley  <johnw@newartisans.com>

	* eshell/esh-io.el (eshell-get-target): Whitespace changes.
	(eshell-output-object-to-target): Improve output speed 20% by not
	calling `eshell-stringify' if something is already known to be a string.

2004-05-15  Alex Ott  <ott@jet.msk.su>

	* textmodes/ispell.el (ispell-local-dictionary-alist):
	Add windows-1251 to the choice of coding systems.
	(ispell-dictionary-alist-6): Add support for "russianw.aff",
	encoded in cp1251.

2004-05-15  Dan Nicolaescu  <dann@ics.uci.edu>

	* progmodes/compile.el (compilation-warning-face)
	(compilation-info-face): Use min-colors.

2004-05-15  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* toolbar/close.pbm, toolbar/close.xpm, toolbar/copy.pbm
	* toolbar/copy.xpm, toolbar/cut.pbm, toolbar/cut.xpm
	* toolbar/help.pbm, toolbar/help.xpm, toolbar/home.pbm
	* toolbar/home.xpm, toolbar/index.pbm, toolbar/index.xpm
	* toolbar/jump_to.pbm, toolbar/jump_to.xpm, toolbar/left_arrow.pbm
	* toolbar/left_arrow.xpm, toolbar/new.pbm, toolbar/new.xpm
	* toolbar/open.pbm, toolbar/open.xpm, toolbar/paste.pbm
	* toolbar/paste.xpm, toolbar/preferences.pbm, toolbar/preferences.xpm
	* toolbar/print.pbm, toolbar/print.xpm, toolbar/right_arrow.pbm
	* toolbar/right_arrow.xpm, toolbar/save.pbm, toolbar/save.xpm
	* toolbar/saveas.pbm, toolbar/saveas.xpm, toolbar/search.pbm
	* toolbar/search.xpm, toolbar/spell.pbm, toolbar/spell.xpm
	* toolbar/undo.pbm, toolbar/undo.xpm, toolbar/up_arrow.pbm
	* toolbar/up_arrow.xpm: New icons from GTK+ version 2.

2004-05-15  Kim F. Storm  <storm@cua.dk>

	* emacs-lisp/timer.el (timer-activate): Add optional arg triggered-p.
	Use it to set triggered-p element of timer.
	(timer-event-handler): Set triggered-p element non-nil while running
	the timer function.

2004-05-14  Stefan Monnier  <monnier@iro.umontreal.ca>

	* descr-text.el (describe-char-unicode-data)
	(describe-char-unicodedata-file): Re-enable the unicode code now that
	the licensing issues have been cleared in the unicode-4 license.
	(describe-text-properties-1): Remove unused `overlay' var.
	(describe-char): Remove unused var `buffer'.

2004-05-14  David Ponce  <david@dponce.com>

	* tree-widget.el: New file.

2004-05-13  Marcelo Toledo  <marcelo@gnu.org>

	* language/european.el ("Brazilian Portuguese"): Add support for
	Brazilian Portuguese.

2004-05-13  John Wiegley  <johnw@newartisans.com>

	* iswitchb.el (iswitchb-use-virtual-buffers): Only turn on
	`recentf-mode' if this variable has been customized to t.

	* eshell/esh-test.el (eshell-test): Call the function
	`emacs-version' rather than trying to build a custom version string.

2004-05-13  Stefan Monnier  <monnier@iro.umontreal.ca>

	* net/telnet.el (telnet-mode): Use define-derived-mode.
	Don't modify the global value of comint-prompt-regexp.

2004-05-13  John Paul Wallington  <jpw@gnu.org>

	* version.el (emacs-version): Check for `gtk' feature before
	`x-toolkit' feature.

2004-05-13  Juanma Barranquero  <lektu@terra.es>

	* files.el (file-truename): Don't mention COUNTER and PREV-DIRS
	arguments in the docstring, they're used only in recursive calls.

	* help-fns.el (help-arg-highlighting-function)
	(help-argument-name): Delete.
	(help-default-arg-highlight): New function.
	(help-do-arg-highlighting): Use it.

2004-05-13  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* calendar/appt.el (appt-disp-window):
	Use `calendar-set-mode-line' for a centered mode-line.

2004-05-13  Takaaki Ota  <Takaaki.Ota@am.sony.com>  (tiny change)

	* calendar/appt.el (appt-disp-window): Do not split window
	excessively when `split-height-threshold' is low.

2004-05-12  Nick Roberts  <nickrob@gnu.org>

	* progmodes/gud.el (gud-mode): Add gud-kill-buffer-hook to
	kill-buffer-hook here and make it local.
	(gud-kill-buffer-hook): Use kill-process for a sure kill.

2004-05-12  Daniel Pfeiffer  <occitan@esperanto.org>

	* progmodes/compile.el (compilation-set-window-height):
	Use save-excursion to protect against misplaced marker.

2004-05-12  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* custom.el (defface): Document that type can have value gtk.

	* faces.el (face-spec-set-match-display): Handle type gtk in display.

2004-05-12  Kenichi Handa  <handa@m17n.org>

	* descr-text.el: Require quail at compile time.
	(describe-char): If an input method is on and it supports the
	character, show how to input it.

	* international/quail.el (quail-install-decode-map): Accept a
	char-table whose subtype is `quail-decode-map'.
	(quail-store-decode-map-key, quail-gen-decode-map1)
	(quail-gen-decode-map, quail-find-key1, quail-find-key)
	(quail-show-key): New functions.

2004-05-12  Juanma Barranquero  <lektu@terra.es>

	* generic.el (define-generic-mode): Remove redundant arglist info.

	* help-fns.el (help-split-fundoc, help-add-fundoc-usage):
	Make arguments match their use in docstring.
	(help-arg-highlighting-function): New variable.
	(help-argument-name): Mention it in the docstring.
	(help-do-arg-highlight): Use it.  Expand regexp to accept also
	ARG-xxx and xxx-ARG references.

2004-05-11  Yoichi NAKAYAMA  <yoichi@geiin.org>  (tiny change)

	* mail/rfc2368.el (rfc2368-parse-mailto-url): Make the results of
	parsing "mailto:addr1%2C%20addr2", "mailto:?to=addr1%2C%20addr2",
	and "mailto:addr1?to=addr2" equal.

2004-05-11  Alexander Pohoyda  <alexander.pohoyda@gmx.net>  (tiny change)

	* man.el (Man-getpage-in-background): Use shell-file-name
	and shell-command-switch variables instead of hard-coded values.

2004-05-11  Eli Zaretskii  <eliz@gnu.org>

	* iimage.el: New file.

2004-05-11  Juanma Barranquero  <lektu@terra.es>

	* custom.el (custom-initialize-default, defcustom):
	Fix typo in docstring.

	* files.el (set-visited-file-name, file-expand-wildcards):
	Fix docstring.

2004-05-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/lisp-mode.el (prin1-char): Use eventp.

	* subr.el (eventp): Be more discriminating with integers.

2004-05-10  Daniel Pfeiffer  <occitan@esperanto.org>

	* progmodes/compile.el (compile): Add universal prefix arg.
	(compilation-error-regexp-alist-alist): Add edg patterns.

2004-05-10  Sam Steingold  <sds@gnu.org>

	* textmodes/ispell.el (ispell-message):
	Use `message-cite-prefix-regexp' instead of `message-yank-prefix'.

2004-05-10  Dave Love  <fx@gnu.org>

	* progmodes/python.el (help-buffer): Autoload when compiling.
	(python-after-info-look): Don't assume Info-goto-node returns non-nil.
	(run-python): Prepend to any existing PYTHONPATH.

2004-05-10  Nick Roberts  <nick@nick.uklinux.net>

	* progmodes/gdb-ui.el (gdb-annotation-rules): Add nquery annotation
	for pending breakpoints.

2004-05-10  Richard M. Stallman  <rms@gnu.org>

	* mail/unrmail.el (unrmail): Mostly rewritten.  Parses the file
	directly without calling any functions in Rmail.
	(unrmail-unprune): Function deleted.

2004-05-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/python.el (inferior-python-mode-map): Remove erroneous
	C-c C-z binding.

2004-05-10  Kenichi Handa  <handa@m17n.org>

	* descr-text.el (describe-char): Fix previous change.  Don't make
	a unibyte character to multibyte in the *Help* buffer.

2004-05-10  Miles Bader  <miles@gnu.org>

	* lisp/progmodes/gud.el (gud-common-init): Only consider an existing
	buffer an error if the debugger process is actually running.

2004-05-10  Juanma Barranquero  <lektu@terra.es>

	* help-fns.el (help-argument-name): Default to italic.
	(help-highlight-arguments): Return always (usage . doc), even when
	usage is nil.

	* ibuf-macs.el (define-ibuffer-column, define-ibuffer-sorter)
	(define-ibuffer-filter): Add usage info.
	(define-ibuffer-op): Add usage info (but CL-style defaults for
	keyword args are not shown).

	* subr.el (remove-overlays, read-passwd): Fix docstring.
	(start-process-shell-command): Fix docstring.  Put usage info in a
	format usable by `describe-function'.
	(open-network-stream, open-network-stream-nowait)
	(open-network-stream-server): Fix docstring.

2004-05-09  Jason Rumney  <jasonr@gnu.org>

	* international/code-pages (cp932, cp936, cp949, c950): Remove.
	Only define cp125* if windows-125* is already defined.

	* language/korean.el (cp949): Add alias.

	* language/chinese.el (cp936, cp950): Add aliases.

	* language/japanese.el (cp932): Add alias.

	* term/w32-win.el: Require code-pages.

	* international/mule-cmds.el (set-locale-environment):
	On MS-Windows use ansi code-page for default coding-systems.
	Set up paper sizes for Windows 3 letter languages.

	* international/code-pages.el (cp932, cp936, cp949, cp950):
	Add aliases.  Also add cp125* if not already defined.

2004-05-09  Juanma Barranquero  <lektu@terra.es>

	* help-fns.el (help-highlight-arguments): Don't try to highlight
	missing or autoloaded arglists.  Accept structured arguments, like
	the first ones of `do' and `flet'.

	* pcvs.el (cvs-mode-run, cvs-is-within-p): Fix typo in docstring.
	(cvs-get-marked): Remove redundant arglist info.

	* net/quickurl.el (quickurl, quickurl-browse-url, quickurl-read):
	Don't use CL-style default args.

2004-05-08  Andreas Schwab  <schwab@suse.de>

	* emacs-lisp/checkdoc.el (checkdoc-minor-mode): Doc fix.

	* international/subst-ksc.el: Fix references to utf-translate-cjk
	into utf-translate-cjk-mode.
	* international/subst-big5.el: Likewise.
	* international/subst-gb2312.el: Likewise.
	* international/subst-jis.el: Likewise.
	* international/utf-16.el: Likewise.
	* international/utf-8.el: Likewise.

2004-05-08  John Wiegley  <johnw@newartisans.com>

	* iswitchb.el (iswitchb-use-virtual-buffers): Add support for
	"virtual buffers" (off by default), which makes it possible to
	switch to the "virtual" buffers of recently visited files.  When a
	buffer name search fails, and this option is on, iswitchb will
	look at the list of recently visited files, and permit matching
	against those names.  When the user hits RET on a match, it will
	revisit that file.
	(iswitchb-read-buffer): Add two optional arguments, which makes
	isearchb.el possible.
	(iswitchb-completions, iswitchb-set-matches, iswitchb-prev-match)
	(iswitchb-next-match): Add support for virtual buffers.

	* isearchb.el: This module extends iswitchb to provide "as you
	type" buffer selection.

	* textmodes/flyspell.el (flyspell-highlight-incorrect-region):
	Ignore the read-only property when flyspell highlighting is on.
	Not ignoring it leads to a series of confusing errors.
	(flyspell-highlight-duplicate-region): Ignore read-only, as above,
	but also make sure to call flyspell-incorrect-hook.
	(flyspell-maybe-correct-transposition): Perform transposition test
	by bit twiddling a string, rather than using a temp buffer.
	(flyspell-maybe-correct-doubling): Use a string rather than a temp
	buffer.  This is also the original version of the code, which
	could not be checked in before due to a previous lack of
	assignment papers.  This version has seen heavy usage on my system
	for several years now.

	* calendar/cal-bahai.el: New file, which adds support for the
	Baha'i calendar to Emacs.  This calendar is based on a solar year
	of 19 months of 19 days, with 4 intercalary days.  Each year
	begins on March 21, with the calendar starting in 1844.

	* calendar/cal-menu.el, calendar/calendar.el
	* calendar/diary-lib.el, calendar/holidays.el:
	Added support for using cal-bahai.el.

	* eshell/em-glob.el (eshell-glob-initialize): Move initialization
	of `eshell-glob-chars-regexp' into `eshell-glob-regexp', so that
	function can be used outside of eshell buffers.
	(eshell-glob-regexp): Initialize `eshell-glob-chars-regexp' here.

2004-05-08  Juanma Barranquero  <lektu@terra.es>

	* help-fns.el (help-do-arg-highlight): Temporarily set ?\- to be a
	word constituent so FOO-ARG is not recognized as an arg.
	(help-highlight-arguments): Don't skip lists in mandatory arguments.

	* simple.el (next-error): Fix typo in docstring.
	(open-line): Make argument names match their use in docstring.
	(split-line): Fix docstring.

	* emacs-lisp/cl-macs.el (do, do*): Put usage info in a format
	usable by `describe-function'.
	(gensym, gentemp, typep, ignore-errors): Make argument names match
	their use in docstring.

	* progmodes/python.el (python-describe-symbol): Pass INTERACTIVE-P
	argument to `help-setup-xref'.

2004-05-07  Kai Grossjohann  <kai@emptydomain.de>

	Version 2.0.40 of Tramp released.

	* net/tramp.el (tramp-completion-mode, tramp-md5-function):
	Use symbol-function to invoke functions only known on some Emacs
	flavors.  This avoids byte-compiler warnings.  Reported by Kevin
	Scaldeferri <kevin@scaldeferri.com>.
	(tramp-do-copy-or-rename-file-via-buffer): Rename from
	tramp-do-copy-or-rename-via-buffer (without `file'), to make it
	consistent with the other tramp-do-* functions.
	(tramp-do-copy-or-rename-file): Calls adjusted.
	(tramp-process-initial-commands): Avoid liveness check on shell --
	we know that it must be alive since we're opening a connection at
	this moment.
	(tramp-last-cmd): New internal variable.
	(tramp-process-echoes): New tunable.
	(tramp-send-command): Set tramp-last-cmd.
	(tramp-wait-for-output): Delete echo, if applicable.
	(tramp-read-passwd): Construct the key for the password cache in a
	way that works for multi methods, too.
	(tramp-bug): Add backup-directory-alist and
	bkup-backup-directory-info to bug reports, with Tramp counterparts.

2004-05-07  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp*.el: Suppress byte-compiler warnings where possible.

	* net/tramp.el (tramp-out-of-band-prompt-regexp)
	(tramp-actions-copy-out-of-band): New defcustoms.
	(tramp-do-copy-or-rename-file-out-of-band): Asynchronous process
	used instead of a synchronous one.  Allows password entering.
	(tramp-action-out-of-band): New defun.
	(tramp-open-connection-rsh, tramp-method-out-of-band-p):
	Remove restriction with password from doc string.
	(tramp-bug): Add variables `tramp-terminal-prompt-regexp',
	`tramp-out-of-band-prompt-regexp',
	`tramp-actions-copy-out-of-band', `password-cache' and
	`password-cache-expiry'.
	(toplevel): Remove todo item wrt ssh-agent.  Obsolete due to
	password caching.
	(tramp-touch): FILE can be a local file, too.
	(TODO): Remove items done.
	(tramp-handle-insert-directory): Properly quote file name also if
	not full-directory-p.  Handle wildcard case.  Reported by Andreas
	Schwab <schwab@suse.de>.
	(tramp-do-copy-or-rename-file-via-buffer): Set permissions of the
	new file.
	(tramp-handle-file-local-copy, tramp-handle-write-region):
	The permissions of the temporary file are set if filename exists.
	Reported by Ted Stern <stern@cray.com>.
	(tramp-backup-directory-alist)
	(tramp-bkup-backup-directory-info): New defcustoms.
	(tramp-file-name-handler-alist): Add entry for `find-backup-file-name'.
	(tramp-handle-find-backup-file-name): New function.
	Implements Tramp's find-backup-file-name.

	* net/tramp-smb.el (tramp-smb-file-name-handler-alist): Add entry
	for `find-backup-file-name'.

	* net/tramp-vc.el (tramp-vc-workfile-unchanged-p): Correct typo
	("file" -> "filename").  Reported by Kim F. Storm <storm@cua.dk>.

2004-05-07  Lars Hansen  <larsh@math.ku.dk>

	* desktop.el (desktop-buffer-mode-handlers): Fix docstring.

2004-05-07  Juanma Barranquero  <lektu@terra.es>

	* subr.el (lambda): Add arglist description to docstring.
	(declare): Fix typo in docstring.
	(open-network-stream): Fix docstring.
	(process-kill-without-query): Fix docstring and add obsolescence info.
	(last, butlast, nbutlast): Make arguments match their use in docstring.
	(insert-buffer-substring-no-properties): Likewise.
	(insert-buffer-substring-as-yank): Likewise.
	(split-string): Fix docstring.

	* emacs-lisp/byte-run.el (make-obsolete, make-obsolete-variable):
	Make argument names match their use in docstring.

	* emacs-lisp/re-builder.el (reb-auto-update): Fix typo in docstring.

2004-05-06  Nick Roberts  <nickrob@gnu.org>

	* progmodes/gdb-ui.el: Improve/extend documentation strings.
	Fit first sentence on one line for apropos-command.

2004-05-06  Stefan Monnier  <monnier@iro.umontreal.ca>

	Changes largely merged in from Dave Love's code.
	* progmodes/python.el: Doc fixes.
	(python-mode-map): Add python-complete-symbol.
	(python-comment-line-p, python-beginning-of-string): Use syntax-ppss.
	(python-comment-indent, python-complete-symbol)
	(python-symbol-completions, python-partial-symbol)
	(python-try-complete): New.
	(python-indent-line): Remove optional arg.  Use python-block-end-p.
	(python-check): Bind compilation-error-regexp-alist.
	(inferior-python-mode): Use rx.  Move keybindings to top level.
	Set comint-input-filter.
	(python-preoutput-filter): Use rx.
	(python-input-filter): Re-introduce.
	(python-proc): Start new process if necessary.
	Check python-buffer non-nil.
	(view-return-to-alist): Defvar.
	(python-send-receive): New.
	(python-eldoc-function): Use it.
	(python-mode-running): Don't defvar.
	(python-mode): Set comment-indent-function.
	Maybe update hippie-expand-try-functions-list.
	(python-indentation-levels): Initialize differently.
	(python-block-end-p): New.
	(python-indent-line): Use it.
	(python-compilation-regexp-alist): Augment.
	(run-python): Import `emacs' module to Python rather than loading
	code directly.  Set python-buffer differently.
	(python-send-region): Use emacs.eexecfile.  Fix orig-start calculation.
	Use python-proc.
	(python-send-command): Go to end of comint buffer.
	(python-load-file): Use python-proc, emacs.eimport.
	(python-describe-symbol): Simplify interactive form.
	Use emacs.help.  Do use temp-buffer-show-hook.
	Call print-help-return-message.
	(hippie-exp): Require when compiling.
	(python-preoutput-continuation): Use rx.

	* diff-mode.el (diff-make-unified): Fix regexp.

2004-05-06  Romain Francoise  <romain@orebokech.com>  (tiny change)

	* ibuffer.el (ibuffer-redisplay-engine): Do not remove folded
	filter groups from the buffer when rebuilding the Ibuffer buffer
	and `ibuffer-show-empty-filter-groups' is nil.

2004-05-06  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-print.el (ps-print-quote): Call ps-value-string.
	(ps-setup): Call ps-comment-string.
	(ps-value-string, ps-comment-string): New funs.

2004-05-06  Juanma Barranquero  <lektu@terra.es>

	* ehelp.el (electric-help-command-loop): Check whether the last
	character is visible, not (point-max).

	* help-fns.el (help-argument-name): Default to bold; don't inherit
	from font-lock-variable-name-face.
	(help-do-arg-highlight): Grok also ARGth occurrences in the docstring.

2004-05-05  Kenichi Handa  <handa@m17n.org>

	* descr-text.el (describe-char): Copy the character with text
	properties and overlays into the first line, and call
	describe-text-properties on it.

2004-05-05  Stephen Eglen  <stephen@anc.ed.ac.uk>

	* iswitchb.el (iswitchb-global-map): Fix typo.
	Remove unwanted ###autoloads from source file.

2004-05-05  Lars Hansen  <larsh@math.ku.dk>

	* wdired.el (wdired-change-to-wdired-mode): Quote wdired-mode-hook
	in run-hooks.  Use substitute-command-keys in message.
	(wdired-abort-changes): Add message.

2004-05-03  Michael Mauger  <mmaug@yahoo.com>

	* emacs/lisp/progmodes/sql.el (sql-xemacs-p, sql-emacs19-p)
	(sql-emacs20-p): Remove.
	(sql-mode-syntax-table): Use shared GNU Emacs/XEmacs syntax.
	(sql-builtin-face, sql-doc-face): Remove.
	(sql-mode-ansi-font-lock-keywords)
	(sql-mode-oracle-font-lock-keywords)
	(sql-mode-postgres-font-lock-keywords)
	(sql-mode-linter-font-lock-keywords)
	(sql-mode-ms-font-lock-keywords)
	(sql-mode-mysql-font-lock-keywords): Use standard fonts.
	(sql-product-font-lock): Fix font-lock reset when font rules change.
	(sql-highlight-product): Remove incorrect font-lock reset logic.

2004-05-04  Jonathan Yavner  <jyavner@member.fsf.org>

	* ses.el (ses-set-parameter): Fix typo.

2004-05-04  Kim F. Storm  <storm@cua.dk>

	* ido.el (ido-read-internal): Fix call to read-file-name for edit.
	Must expand directory for completion to work; and don't mess with
	process-environment.
	(ido-read-file-name): If command has ido property, don't use ido
	if value is ignore, or read as directory if value is dir.
	Set ido ignore property for dired-do-rename command.

2004-05-04  Juanma Barranquero  <lektu@terra.es>

	* ehelp.el (electric-help-command-loop, electric-help-undefined)
	(electric-help-help): Check against unmapped commands.

	* help-fns.el (help-argument-name): New face, inheriting from
	font-lock-variable-name-face, to highlight function arguments in
	`describe-function' and `describe-key'.
	(help-do-arg-highlight): Auxiliary function to highlight a given
	list of arguments in a string.
	(help-highlight-arguments): Highlight the function arguments and
	all uses of them in the docstring.
	(describe-function-1): Use it.  Do docstring output via `insert',
	not 'princ', so text attributes are preserved.

	* winner.el (winner-mode-map): Move `winner-undo' and
	`winner-redo' to C-c <left> and C-c <right>, respectively (the
	previous bindings conflict with `prev-buffer', `next-buffer').

2004-05-03  Roland Winkler  <Roland.Winkler@physik.uni-erlangen.de>

	* textmodes/bibtex.el (bibtex-progress-message): Fix docstring.
	(bibtex-entry-update): New command bound to C-c C-u.
	(bibtex-text-in-string): Fix regexp.
	(bibtex-assoc-of-regexp): Remove.
	(bibtex-progress-message): Fix docstring.
	(bibtex-inside-field): Use if.
	(bibtex-assoc-regexp): New function.
	(bibtex-format-entry): Make code more robust so that it formats
	also old entries.
	(bibtex-autokey-demangle-title): Merge with obsolete function
	bibtex-assoc-of-regexp.
	(bibtex-field-list): New function.
	(bibtex-entry): Use bibtex-field-list.
	(bibtex-parse-entry): Fix docstring.
	(bibtex-print-help-message): Use bibtex-field-list.
	(bibtex-make-field): Use bibtex-field-list.
	(bibtex-entry-index): Bugfix.  Return crossref key if required.
	(bibtex-lessp): Fix docstring.

2004-05-03  Luc Teirlinck  <teirllm@auburn.edu>

	* select.el (xselect-convert-to-string): Move comment to intended line.

2004-05-03  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* toolbar/tool-bar.el (tool-bar-setup): Use lookup-key for
	cut/copy/paste in case menu-bar-enable-clipboard is in effect.

2004-05-03  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* term/x-win.el (x-clipboard-yank): Don't exit on error from
	x-get-selection.

2004-05-03  Jason Rumney  <jasonr@gnu.org>

	* makefile.nt: Remove.

2004-05-03  Kim F. Storm  <storm@cua.dk>

	* emulation/cua-base.el (cua--update-indications): Fix last change.
	(cua-mode): Deactivate mark when cua-mode is enabled.

2004-05-02  Luc Teirlinck  <teirllm@auburn.edu>

	* select.el (xselect-convert-to-string): Bind `inhibit-read-only' to t.

2004-05-03  Nick Roberts  <nickrob@gnu.org>

	* progmodes/gdb-ui.el (gud-watch, gdb-display-buffer)
	(gdb-display-source-buffer, gdb-put-breakpoint-icon)
	(gdb-remove-breakpoint-icons, gdb-assembler-custom): Look for
	window over visible frames.
	(gdb-goto-breakpoint): Make buffer display file at breakpoint.

2004-05-02  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/compile.el (compilation-gcpro): New var.
	(compilation-fake-loc): Use it.
	(compilation-forget-errors): Reset it.

2004-05-02  Dan Nicolaescu  <dann@ics.uci.edu>

	* diff-mode.el (diff-header-face, diff-file-header-face):
	Use min-colors.

2004-05-02  Roland Winkler  <Roland.Winkler@physik.uni-erlangen.de>

	* textmodes/bibtex.el (bibtex-sort-buffer): Remove error message.
	(bibtex-clean-entry): Disentangle code.
	(bibtex-realign): New function.
	(bibtex-reformat): Use mapcar and bibtex-realign.  Do not use
	bibtex-beginning-of-first-entry and bibtex-skip-to-valid-entry.
	Remove undocumented optional arg called-by-convert-alien.
	(bibtex-convert-alien): Use bibtex-realign.  Use bibtex-reformat
	for sorting instead of bibtex-sort-buffer.

2004-05-02  Eli Zaretskii  <eliz@gnu.org>

	* progmodes/compile.el (compilation-start): In the
	no-async-subprocesses branch, call sit-for to give redisplay a
	chance to show the updated process status in the mode line, and
	fontify the buffer explicitly after the process exits.

2004-05-01  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/python.el (python-compilation-line-number): Remove.
	(python-compilation-regexp-alist): Don't use it any more.
	(python-orig-start, python-input-filter): Remove.
	(inferior-python-mode): Don't set up comint-input-filter-functions.
	(python-send-region): Use compilation-fake-loc.

	* progmodes/compile.el (compilation-messages-start): New var.
	(compilation-mode): Don't setup next-error-function here.
	(compilation-setup): Set it up here instead (for minor modes as well).
	Make compilation-messages-start buffer local.
	(compilation-next-error-function): Use it.
	(compilation-forget-errors): Set compilation-messages-start.

2004-05-01  Luc Teirlinck  <teirllm@auburn.edu>

	* ielm.el (ielm-prompt-read-only): Update docstring.

	* comint.el (comint-prompt-read-only): Update docstring.
	(comint-update-fence, comint-kill-whole-line)
	(comint-kill-region): New functions.

	* simple.el (kill-whole-line): Use "p" instead of "P" in
	interactive form.

2004-05-01  Juanma Barranquero  <lektu@terra.es>

	* help-fns.el (help-add-fundoc-usage): Use %S instead of %s to
	format arglist so default values in CL-style argument lists are
	correctly shown.

2004-05-01  Jason Rumney  <jasonr@gnu.org>

	* term/w32-win.el (w32-drag-n-drop): Use x-dnd.el functions.

2004-05-01  Kenichi Handa  <handa@m17n.org>

	* international/titdic-cnv.el (miscdic-convert): Don't generate a
	quail file if it is up to date.

2004-04-30  Juri Linkov  <juri@jurta.org>

	* cus-edit.el (custom-mode-map):
	Add key binding `C-x C-s' to `Custom-save'.

	* outline.el (outline-blank-line): New var.
	(outline-next-preface, outline-show-heading)
	(outline-end-of-subtree): Use it.

	* dired-aux.el (dired-touch-initial): New fun.
	(dired-do-chxxx): Call it for op-symbol `touch'.
	(dired-diff): Use `dired-dwim-target-directory'
	if current dired buffer has no buffer mark.

	* bindings.el (propertized-buffer-identification):
	Replace `(:weight bold)' by `Buffer-menu-buffer-face'.
	Add C-M-arrow keys for consistency.

	* files.el (confirm-kill-emacs):
	Change group from top-level `emacs' to `convenience'.

	* emacs-lisp/lisp.el (beginning-of-defun, end-of-defun):
	Push mark on the first call of successive command calls.
	(insert-pair): New fun created from `insert-parentheses' with
	`open' and `close' arguments added.  Enclose active regions
	in paired characters.  Compare adjacent characters syntax with
	inserted characters syntax before inserting a space.
	(insert-parentheses): Call `insert-pair' with ?\( ?\).

	* delsel.el: Don't put `delete-selection' property
	on `insert-parentheses' symbol to take advantage of
	region handling in `insert-pair' function.
	Suggested by Stephan Stahl <stahl@eos.franken.de>.

2004-04-30  Kim F. Storm  <storm@cua.dk>

	* emulation/cua-base.el: Add support for changing cursor types;
	based on patch from Michael Mauger.
	(cua-normal-cursor-color, cua-read-only-cursor-color)
	(cua-overwrite-cursor-color, cua-global-mark-cursor-color):
	Customization cursor type and/or cursor color.
	(cua--update-indications): Handle cursor type changes.
	(cua-mode): Update cursor indications if enabled.

	* menu-bar.el (menu-bar-options-menu): Change menu text for CUA.

	* mouse.el (mouse-drag-copy-region): New defcustom.
	(mouse-set-region, mouse-drag-region-1): Use it.

	* simple.el (kill-ring-save): If region face background color is
	unspecified (if no highlighting), show extent of fully visible
	region even if transient-mark-mode is enabled.

	* emulation/cua-base.el (cua--standard-movement-commands):
	Add cua-scroll-up and cua-scroll-down.
	(cua-scroll-up, cua-scroll-down): New commands.
	(cua--init-keymaps): Remap scroll-up and scroll-down.

	* emulation/cua-rect.el (cua--convert-rectangle-as):
	New defmacro.
	(cua-upcase-rectangle, cua-downcase-rectangle): Use it.
	(cua-upcase-initials-rectangle, cua-capitalize-rectangle):
	New commands (suggested by Jordan Breeding).

2004-04-30  Juanma Barranquero  <lektu@terra.es>

	* smerge-mode.el (smerge-diff-switches): Fix typo in docstring.

2004-04-30  Mario Lang  <mlang@delysid.org>

	* diff.el (diff-switches): Fix typo in docstring.

2004-04-30  Alex Schroeder  <alex@gnu.org>

	* xml.el (xml-debug-print-internal): Don't add newline and
	indentation to text nodes and write empty elements as empty tags
	instead of opening and closing tags.
	(xml-debug-print): Take optional indent-string argument.
	(xml-print): Alias for xml-debug-print.

2004-04-30  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* progmodes/fortran.el (fortran-fill): Use local var `bol' rather
	than duplicate call to `line-beginning-position'.

	* progmodes/f90.el (f90-get-present-comment-type):
	Return whitespace, as well as comment chars, for consistent filling
	of comment blocks.  Use `match-string-no-properties'.
	(f90-break-line): Trim trailing whitespace when filling comments.

2004-04-30  Dave Love  <fx@gnu.org>

	* calendar/diary-lib.el (diary-outlook-formats): New variable.
	(diary-from-outlook-internal, diary-from-outlook)
	(diary-from-outlook-gnus, diary-from-outlook-rmail):
	New functions to import diary entries from Outlook-format
	appointments in mail messages.

2004-04-29  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/python.el (python-send-command): New fun.
	(python-send-region, python-load-file): Use it.

	* progmodes/compile.el (compilation-last-buffer): Add var alias.

	* help-fns.el (help-C-file-name): Use new subr-name.
	Prepend `src/' to the file name.
	(help-C-source-directory, help-subr-name, help-find-C-source): Remove.
	(describe-function-1, describe-variable): Only find a C source file
	name if DOC is already loaded.

	* help-mode.el (help-function-def, help-variable-def):
	Use the new find-function-search-for-symbol functionality.
	Allow FILE to be `C-source'.

	* emacs-lisp/find-func.el (find-function-C-source-directory): New var.
	(find-function-C-source): New fun.
	(find-function-search-for-symbol): Use it.

2004-03-29  Michael Mauger  <mmaug@yahoo.com>

	* progmodes/sql.el (sql-product-alist): Rename variable
	`sql-product-support'.  Add Postgres login parameters.
	(sql-set-product, sql-product-feature): Update with renamed variable.
	(sql-connect-postgres): Add username prompt.
	(sql-imenu-generic-expression, sql-mode-font-lock-object-name):
	Make patterns less product specific.
	(sql-xemacs-p, sql-emacs19-p): Add flags for Emacs variants.
	(sql-mode-abbrev-table): Modify initialization.
	(sql-builtin-face): Add variable.
	(sql-keywords-re): Add macro.
	(sql-mode-ansi-font-lock-keywords): Update for ANSI-92.
	(sql-mode-oracle-font-lock-keywords): Update for Oracle 9i.
	(sql-mode-postgres-font-lock-keywords): Update for Postgres 7.3.
	(sql-mode-mysql-font-lock-keywords): Update for MySql 4.0.
	(sql-mode-linter-font-lock-keywords)
	(sql-mode-ms-font-lock-keywords): Use `sql-keywords-re' macro.
	(sql-mode-sybase-font-lock-keywords)
	(sql-mode-informix-font-lock-keywords)
	(sql-mode-interbase-font-lock-keywords)
	(sql-mode-ingres-font-lock-keywords)
	(sql-mode-solid-font-lock-keywords)
	(sql-mode-sqlite-font-lock-keywords)
	(sql-mode-db2-font-lock-keywords): Default to nil.
	(sql-product-font-lock): Always highlight ANSI keywords.
	(sql-add-product-keywords): Made similar to `font-lock-add-keywords'.
	(sql-send-string): Add function.

2004-04-29  Dave Love  <fx@gnu.org>

	* progmodes/cfengine.el (cfengine-beginning-of-defun)
	(cfengine-end-of-defun): Ensure progress through buffer.

	* info-look.el (cfengine-mode): Accept a terminal ().

2004-04-29  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-mode-map): Bind \C-w to isearch-yank-word
	instead of isearch-yank-word-or-char.  Add new key bindings for
	isearch-yank-char to \C-f, and isearch-del-char to \C-b.
	(isearch-del-char): New fun.
	(isearch-forward, isearch-edit-string): Update docstring.
	(isearch-yank-char): Doc fix.
	(isearch-other-meta-char): Restore point after scrolling.

	* progmodes/compile.el (compilation-context-lines): Add nil option
	to disable compilation output window scrolling.
	(compilation-set-window): Use it.

	* outline.el (outline-next-preface, outline-show-heading):
	Don't leave unhidden blank line before heading.
	(outline-end-of-subtree): Include last newline into subtree.
	(hide-entry): Leave point at beginning of heading instead of end.
	(outline-up-heading): Push mark for the first call of successive
	command calls.

2004-04-28  Luc Teirlinck  <teirllm@auburn.edu>

	* comint.el (comint-prompt-read-only): New variable.
	(comint-output-filter): Implement it.

	* ielm.el (ielm-prompt-read-only, ielm-prompt): Update docstring.
	(ielm-prompt-internal): New variable.
	(ielm-font-lock-keywords): Remove irrelevant ielm-prompt keyword.
	(ielm-send-input): Delete unused variable `buf'.
	(ielm-eval-input): Use `ielm-prompt-internal'.
	(inferior-emacs-lisp-mode): Use new variables
	`comint-prompt-read-only' and `ielm-prompt-internal'.
	Get rid of obsolete variable `directory-sep-char'.
	(ielm): Use `zerop'.

2004-04-29  John Paul Wallington  <jpw@gnu.org>

	* thumbs.el (toplevel): Require cl at compile time.
	Remove conditional definitions of `ignore-errors' and `caddar'
	because they occur at run time.

2004-04-28  Nick Roberts  <nickrob@gnu.org>

	* progmodes/gdb-ui.el (gdb-frame-breakpoints-buffer)
	(gdb-frame-assembler-buffer, gdb-frame-threads-buffer)
	(gdb-frame-registers-buffer, gdb-frame-locals-buffer)
	(gdb-frame-gdb-buffer, gdb-frame-stack-buffer): Use selected-window.

	* progmodes/gud.el (gud-common-init): Throw an error if program is
	already running under gdb.

2004-04-28  John Paul Wallington  <jpw@gnu.org>

	* thumbs.el (thumbs-delete-images): Fix formatting of prompt.
	(thumbs-show-image-num): Move assignment of
	`thumbs-current-image-filename' within scope of `i'.
	(thumbs-emboss-image): Don't use `evenp'.

2004-04-28  Richard M. Stallman  <rms@gnu.org>

	* progmodes/compile.el (compilation-context-lines): Default now 0.

2004-04-28  Juanma Barranquero  <lektu@terra.es>

	Use `time-less-p' from calendar/time-date.el instead of defining
	custom versions of it.

	* pcomplete.el (pcomplete-time-less-p): Remove.

	* thumbs.el (time-less-p): Remove.

	* calendar/timeclock.el (timeclock-time-less-p): Remove.
	(timeclock-generate-report): Use `time-less-p'.

	* emacs-lisp/autoload.el (autoload-before-p): Remove.
	(update-file-autoloads, update-directory-autoloads): Use `time-less-p'.

2004-04-28  Masatake YAMATO  <jet@gyve.org>

	* subr.el (remove-overlays): Make arguments optional.

	* wid-edit.el (widget-specify-button): Put evaporate to the
	overlay for sample.
	(widget-specify-sample): Put evaporate to the overlay for sample.
	(widget-specify-doc): Put evaporate to the overlay for documentation.

2004-04-27  Jesper Harder  <harder@ifa.au.dk>

	* info.el (info-apropos): Make it an index node.  Align node names
	like makeinfo.

2004-04-27  Eli Zaretskii  <eliz@gnu.org>

	* net/browse-url.el (browse-url-netscape-sentinel)
	(browse-url-mozilla-sentinel, browse-url-galeon-sentinel)
	(browse-url-epiphany-sentinel, browse-url-mosaic):
	Use browse-url-*-program instead of a literal program name.

2004-04-27  Kevin Ryde  <user42@zip.com.au>

	* eshell/em-alias.el:
	* eshell/em-dirs.el:
	* eshell/em-hist.el:
	* eshell/em-unix.el: Add "(require 'eshell)", to get necessary
	features when M-x customize-group loads modules before the main
	eshell.el.

2004-04-27  Matthew Mundell  <matt@mundell.ukfsn.org>

	* subr.el (momentary-string-display): Support EXIT-CHAR that is
	either a character representation of an event or an event
	description list.

	* type-break.el: Capitalize Emacs and Lisp.
	(type-break-good-break-interval, type-break-demo-boring-stats)
	(type-break-terse-messages, type-break-file-name): New defcustoms.
	(type-break-post-command-hook)
	(type-break-warning-countdown-string): Quote variable names in doc.
	(type-break-interval-start, type-break-auto-save-file-name): New vars.
	(type-break-mode): Document type-break-good-break-interval and the
	"session" file.  Schedule break according to the session file.
	Kill session file buffer on exit.  Organize for save-some-buffers
	to always save the session file.
	(type-break-mode-line-message-mode, type-break-query-mode):
	Uppercase arguments.
	(type-break-file-time, type-break-file-keystroke-count, timep)
	(type-break-choose-file, type-break-get-previous-time)
	(type-break-get-previous-count): New defuns.
	(type-break): Avoid break querying after a completed break in the
	case where the query was initiated during user invocation of the
	break.  Optional terse messages.
	Use type-break-good-break-interval if type-break-good-rest-interval is
	nil.  File the break time.
	(type-break-schedule): New optional args for overriding the use of
	the current time.
	(type-break-cancel-time-warning-schedule): Avoid leftover warnings
	after a break.
	(type-break-check): File the keystroke count.
	(type-break-do-query): Prevent a second query when the break is
	interrupted.  Optional terse message.
	(type-break-keystroke-reset): Record the start of a typing interval.
	(type-break-demo-boring): Optional terse messages.  Display word
	per minute and keystroke counts according to
	type-break-demo-boring-stats.

2004-04-27  Daniel M Coffman  <coffmand@us.ibm.com>  (tiny change)

	* arc-mode.el (archive-maybe-copy): If ARCHIVE includes leading
	directories, make sure they exist under archive-tmpdir.

2004-04-27  Juri Linkov  <juri@jurta.org>

	* help.el (view-emacs-news): With argument, display info for the
	selected version by finding it among different NEWS files, and
	narrowing the buffer to the selected version.

	* info.el: Add *info*<[0-9]+> to same-window-regexps instead of
	same-window-buffer-names.
	(info): New arg `buffer'.  Use it.  Doc fix.  Read file name for
	non-numeric prefix argument, append the number to the buffer name
	for numeric prefix argument.
	(info-other-window): Bind same-window-regexps to nil.
	(Info-reference-name): Rename to Info-point-loc.
	(Info-find-node-2): Call forward-line for numeric Info-point-loc,
	and Info-find-index-name for stringy Info-point-loc.
	(Info-extract-menu-node-name): New arg `index-node'.  Use regexp
	without middle `.', but with final `.' and optional line number
	for it.  Set Info-point-loc for index nodes.
	(Info-index): Remove middle `.' from index entry regexp.
	Modify line number regexp.
	(Info-index-next): Decrement line number.
	(info-apropos): Remove middle `.' from index entry regexp.
	Add optional line number regexp at the end.  Add matched value
	for line number to the result list and insert it to the buffer.
	Replace match-string by match-string-no-properties.
	Reorder result list.
	(Info-fontify-node): Hide index line numbers.
	(Info-goto-node): Replace "\\s *\\'" by "\\s +\\'" to not trim
	empty matches.
	(Info-follow-reference): Use `str' instead of
	Info-following-node-name-re.
	(Info-toc): Use full file names.  Set Info-current-node to "Top".
	(Info-fontify-node): Compare file names without directory name.
	(Info-try-follow-nearest-node): Don't set Info-reference-name.
	Set second arg of Info-extract-menu-node-name for index nodes.
	(info-xref-visited): Use magenta3 instead of magenta4.
	(Info-mode): Add info-apropos to docstring.

	* log-view.el (log-view-diff): Replace interactive code "r"
	by a list to allow to call it even if region is not active.

	* paren.el (show-paren-highlight-openparen): New var.
	(show-paren-function): Turn on openparen highlighting when
	matching forward if show-paren-highlight-openparen is non-nil.

	* simple.el (kill-ring-save): Use blink-matching-delay instead of
	the constant value 1.
	(completions-common-part): Expand docstring.

	* textmodes/picture.el (picture-mode-map): Add arrow keys.

2004-04-27  Kim F. Storm  <storm@cua.dk>

	* image.el (insert-sliced-image): Use line-height instead of
	line-spacing property on newline.

2004-04-26  Lars Hansen  <larsh@math.ku.dk>

	* desktop.el (desktop-buffer-misc-data-function): Rename to
	desktop-save-buffer and change docstring.
	(desktop-buffer-modes-to-save): Delete.
	(desktop-save-buffer-p): Use desktop-save-buffer instead of
	desktop-buffer-modes-to-save.
	(desktop-save): Rename desktop-buffer-misc-data-function to
	desktop-save-buffer and allow non-function value.
	(desktop-missing-file-warning): Correct docstring.

	* dired.el (dired-mode): Rename desktop-buffer-misc-data-function
	to desktop-save-buffer.

	* info.el (Info-mode): Rename desktop-buffer-misc-data-function	to
	desktop-save-buffer.

	* mail/rmail.el (rmail-variables): Bind desktop-save-buffer to t.

	* mh-e/mh-e.el (mh-folder-mode): Bind desktop-save-buffer to t.

2004-04-26  Eli Zaretskii  <eliz@gnu.org>

	* progmodes/gud.el (gud-pdb-command-name): Change default to "pydb".

2004-04-25  Luc Teirlinck  <teirllm@auburn.edu>

	* ielm.el (ielm-prompt-read-only, ielm-prompt): Expand docstring.
	(ielm): Only go to the end of the buffer when starting a new process.

2004-04-25  Juanma Barranquero  <lektu@terra.es>

	* ielm.el (inferior-emacs-lisp-mode): Display working buffer on the
	mode line.  Bind `inhibit-read-only' to t before modifying
	properties of text in the buffer.
	(ielm): Force point to the end of buffer, even when running ielm
	from inside itself.

2004-04-25  Jesper Harder  <harder@ifa.au.dk>

	* info.el (info-apropos): Reset Info-complete-cache.

2004-04-25  Daniel Pfeiffer  <occitan@esperanto.org>

	* progmodes/compile.el (compilation-error-regexp-alist-alist):
	Also recognize severe Irix et al. messages.
	(compilation-normalize-filename, compile-abbreviate-directory):
	Delete functions.
	(compilation-get-file-structure): New function inherits
	functionality of the two preceding ones.
	(compilation-internal-error-properties, compilation-fake-loc):
	Use it so that different paths to the same file share the same
	markers.  Also optimize finding adjacent marker slightly.

2004-04-25  Kim F. Storm  <storm@cua.dk>

	* image.el (insert-sliced-image): Add line-spacing t property
	to newlines separating image lines.

2004-04-24  Luc Teirlinck  <teirllm@auburn.edu>

	* comint.el (comint-delete-output): Bind inhibit-read-only to t.

	* ielm.el (ielm-prompt-read-only): New user option.
	(ielm-prompt): Expand docstring to describe new behavior.
	(inferior-emacs-lisp-mode): Implement ielm-prompt-read-only and
	mention it in the docstring.

2004-04-24  Andreas Schwab  <schwab@suse.de>

	* progmodes/sh-script.el (sh-leading-keywords) <sh>: Add "!".

	* diff.el (diff): Set default-directory in diff buffer.

2004-04-24  Eli Zaretskii  <eliz@gnu.org>

	* mail/sendmail.el (mail-bury): Don't delete the frame where the
	mail was being composed if the terminal cannot display more than
	one frame; instead, switch to previous frame.

	* mail/rmail.el (rmail-mail-new-frame): Doc fix.
	(rmail-start-mail): Support rmail-mail-new-frame even on
	terminals that can display only one frame at a time.

2004-04-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/checkdoc.el (checkdoc-output-error-regex-alist): New var.
	(checkdoc-output-font-lock-keywords): Remove error regexp.
	(checkdoc-output-mode-map): Remove.
	(checkdoc-output-mode): Derive from compilation-mode.
	(checkdoc-find-error-mouse, checkdoc-find-error): Remove.

	* dired.el (dired-mode-map): Add a menu entry for wdired.

	* emacs-lisp/rx.el (rx-syntax): Move sregex style syntax to code.
	(rx-bracket, rx-check-any, rx-any): Clean up name space.

	* wdired.el (wdired-mode-map): Move init into declaration.
	Fix `return' binding.
	(wdired-change-to-wdired-mode, wdired-change-to-dired-mode):
	Use force-mode-line-update.
	(wdired-get-filename): Use `unless'.
	(wdired-preprocess-files): Don't assume names have no \n and use / for
	dir separator.
	(wdired-normalize-filename): Use replace-regexp-in-string.
	(wdired-load-hooks): Remove.
	(wdired-mode-hooks): Rename to wdired-mode-hook.

	* info-look.el: Add support for cfengine-mode.
	(info-lookup-setup-mode): Use dolist.

2004-04-23  Juan Le,As(Bn Lahoz Garc,Am(Ba  <juan-leon.lahoz@tecsidel.es>

	* wdired.el: New file.

2004-04-23  Juanma Barranquero  <lektu@terra.es>

	* ielm.el (inferior-emacs-lisp-mode): Fix docstring.

	* pcomplete.el (pcomplete-opt, pcomplete-actual-arg)
	(pcomplete-match-string, pcomplete-comint-setup, pcomplete-here)
	(pcomplete--help, pcomplete--here): Doc fixes.

2004-04-23  Andre Spiegel  <spiegel@gnu.org>

	* vc-hooks.el (vc-default-workfile-unchanged-p): Fix code that
	handles wrong-number-of-arguments in backend call.

	* vc.el (vc-print-log): Likewise.

2004-04-20  Dave Love  <fx@gnu.org>

	* emacs-lisp/rx.el: Doc fixes.
	(rx-constituents): Add/extend many forms.
	(rx-check): Check form is a list.
	(bracket): Defvar.
	(rx-check-any, rx-any, rx-check-not): Modify.
	(rx-not): Simplify.
	(rx-trans-forms, rx-=, rx->=, rx-**, rx-not-char, rx-not-syntax): New.
	(rx-kleene): Use rx-trans-forms.
	(rx-quote-for-set): Delete.
	(rx): Allow multiple args.

2004-04-23  Kenichi Handa  <handa@m17n.org>

	* international/mule-util.el (char-displayable-p): Simplify by
	using internal-char-font.

2004-04-23  Juanma Barranquero  <lektu@terra.es>

	* makefile.w32-in: Add "-*- makefile -*-" mode tag.

2004-04-22  Stefan Monnier  <monnier@iro.umontreal.ca>

	* diff-mode.el (diff-next-error): New fun.
	(diff-mode): Use it.

	* simple.el (next-error): Change arg name.
	Add support for the documented C-u C-x ` usage.

	* frame.el (special-display-popup-frame, next-multiframe-window)
	(previous-multiframe-window): Only consider frames on same display.

2004-04-22  Lars Hansen  <larsh@math.ku.dk>

	* info.el (Info-restore-desktop-buffer): Delete with-no-warnings.
	* mh-e/mh-e.el (mh-restore-desktop-buffer): Delete with-no-warnings.

2004-04-22  Kim F. Storm  <storm@cua.dk>

	* net/telnet.el (telnet): Add optional port arg.

2004-04-21  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/compile.el (compilation-mode-font-lock-keywords):
	Minor sanity check on the `hyperlink' slot.

	* Makefile.in (recompile): Compile new files.

	* emacs-lisp/bytecomp.el (batch-byte-recompile-directory):
	Add byte-recompile-directory's optional `arg'.

	* cvs-status.el (cvs-tree-use-charset): New var.
	(cvs-tree-char-space, cvs-tree-char-hbar, cvs-tree-char-vbar)
	(cvs-tree-char-branch, cvs-tree-char-eob, cvs-tree-char-bob)
	(cvs-status-cvstrees): Use it.

	* emacs-lisp/checkdoc.el (checkdoc-output-mode):
	Make it a normal major mode.
	(checkdoc-buffer-label): Make sure the file name is meaningful.
	(checkdoc-output-to-error-buffer): Remove.
	(checkdoc-error, checkdoc-start-section): Rewrite.

	* info.el (info-node, info-menu-5, info-xref, info-header-node)
	(Info-title-1-face, Info-title-2-face, Info-title-3-face)
	(Info-title-4-face): Use new syntax.
	(info-xref-visited): Inherit from info-xref.

	* progmodes/python.el (python-maybe-jython): Don't assume point-min==1.

2004-04-21  Teodor Zlatanov  <tzz@lifelogs.com>

	* simple.el (next-error-last-buffer, next-error-function):
	New variables for the next-error framework.
	(next-error-buffer-p): New function.
	(next-error-find-buffer): Generalize compilation-find-buffer.
	(next-error, previous-error, first-error, next-error-no-select)
	(previous-error-no-select): Move from compile.el.

	* replace.el (occur-next-error, occur-1): Hook into the next-error
	framework.

	* progmodes/compile.el (compilation-start):
	Set next-error-last-buffer so next-error knows where to jump.
	(compilation-setup): Set the buffer-local variable
	next-error-function to 'compilation-next-error-function.
	(compilation-buffer-p, compilation-buffer-internal-p): Use an
	alternate way to find if a buffer is a compilation buffer, for
	next-error convenience.
	(next-error-no-select, previous-error-no-select, next-error)
	(previous-error, first-error): Move to simple.el.
	(compilation-find-buffer): Move to next-error-find-buffer in simple.el.
	(compilation-last-buffer): Remove.
	(compilation-start, compilation-next-error, compilation-setup)
	(compilation-next-error-function, compilation-find-buffer):
	Remove compilation-last-buffer use.

2004-04-21  Juanma Barranquero  <lektu@terra.es>

	* font-lock.el (font-lock-preprocessor-face): Remove spurious quote.
	(font-lock-warning-face): Fix spacing.

	* makefile.w32-in (WINS): Add url/ directory.

2004-04-21  Lars Hansen  <larsh@math.ku.dk>

	* desktop.el (desktop-buffer-mode-handlers): New variable.
	Alist of major mode specific functions to restore a desktop buffer.
	(desktop-buffer-handlers): Make variable obsolete.
	(desktop-create-buffer): Use desktop-buffer-mode-handlers.
	Catch errors signaled in handlers.  Update buffer count.
	Evaluate desktop-buffer-point.
	(desktop-buffer-dired): Rename to dired-restore-desktop-buffer and
	move to dired.el.
	(desktop-buffer-info): Rename to Info-restore-desktop-buffer and
	move to info.el.
	(desktop-buffer-rmail): Rename to rmail-restore-desktop-buffer and
	move to mail/rmail.el.
	(desktop-buffer-mh): Rename to mh-restore-desktop-buffer and move
	to mh-e/mh-e.el.
	(desktop-buffer-file): Rename to desktop-restore-file-buffer.
	On fail, print message (to message buffer) even if
	desktop-missing-file-warning is nil.
	(desktop-buffer-misc-data-function): New buffer local variable.
	Function returning major mode specific data.
	(desktop-buffer-misc-functions): Make variable obsolete.
	(desktop-save): Use desktop-buffer-misc-data-function.
	(desktop-buffer-dired-misc-data): Rename to
	dired-desktop-buffer-misc-data and move to dired.el.
	(desktop-buffer-info-misc-data): Rename to
	Info-desktop-buffer-misc-data and move to info.el.
	(desktop-read): Add message about number of buffers restored/failed.

	* dired.el (dired-restore-desktop-buffer) Move from desktop.el.
	Add parameters.  Pause to display error only when
	desktop-missing-file-warning is non-nil.
	(dired-desktop-buffer-misc-data): Move from desktop.el.  Add parameter.
	(dired-mode): Bind desktop-buffer-misc-data-function.

	* info.el (Info-restore-desktop-buffer): Move from desktop.el.
	Add Parameters.
	(Info-desktop-buffer-misc-data): Move from desktop.el.  Add parameter.
	(Info-mode): Bind desktop-buffer-misc-data-function.

	* mail/rmail.el (rmail-restore-desktop-buffer): Move from desktop.el.
	Add Parameters.

	* mh-e/mh-e.el (mh-restore-desktop-buffer): Move from desktop.el.
	Add Parameters.

2003-04-21  Paul Pogonyshev  <pogonyshev@gmx.net>

	* dabbrev.el (dabbrev--substitute-expansion): Don't lose
	the case of letters in case-insensitive expansions when the
	abbrev is preceded by characters with letter syntax.

2004-04-21  Richard M. Stallman  <rms@gnu.org>

	* progmodes/cperl-mode.el (cperl-putback-char):
	Delete Emacs 18 definition.

	* international/mule.el (ctext-post-read-conversion):
	Use assoc-string, not assoc-ignore-case.

	* international/mule-cmds.el: Use assoc-string, not assoc-ignore-case.

	* emacs-lisp/easymenu.el (easy-menu-add):
	Do call x-popup-menu, but only if it's defined.

	* emacs-lisp/disass.el (disassemble): Handle lambda-exp as arg.

	* emacs-lisp/bytecomp.el (byte-compile-no-warnings):
	Handle multiple args: compile like progn.

	* emacs-lisp/byte-run.el (with-no-warnings): Simplify:
	take all args as &rest arg.

	* autoinsert.el (auto-insert-alist): Insert the user's name in
	copyright notice, rather than Free Software Foundation.

2004-04-21  Kenichi Handa  <handa@m17n.org>

	* descr-text.el (describe-char): Make it work on *Help* buffer.

2004-04-21  Kim F. Storm  <storm@cua.dk>

	* image.el (insert-image): Add optional SLICE arg.
	(insert-sliced-image): New defun.

2004-04-20  Lawrence Mitchell  <wence@gmx.li>  (tiny change)

	* subr.el (read-number): Check whether `default' is nil.

2004-04-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/compile.el (compilation-error-properties):
	Split into two.
	(compilation-internal-error-properties): New one.
	(compilation-compat-error-properties): Use it.  Fix the non-marker case.

2004-04-20  Richard M. Stallman  <rms@gnu.org>

	* window.el (split-window-save-restore-data):
	Don't update the data if OLD-INFO is nil.

	* view.el (view-return-to-alist): Mark it permanent local.

	* subr.el (event-modifiers): Fix the criterion for ASCII control chars.

	* recentf.el (recentf-save-list): Catch and warn about errors.

	* menu-bar.el (menu-bar-update-buffers): Call copy-sequence
	so "Buffers" won't be pure.

	* help-mode.el (help-mode-finish): Set help-return-alist first
	thing, setting only the entry for the selected window.

	* help-fns.el (describe-function-1): If many non-control non-meta
	keys run the command, don't list all of them.

2004-04-20  Juanma Barranquero  <lektu@terra.es>

	* vc-svn.el (vc-svn-print-log, vc-svn-diff): Add optional BUFFER
	arg.  Copied from Andre Spiegel's patch of 2004-03-21.

	* calendar/time-date.el (time-to-day-in-year): Fix docstring.

2004-04-20  Kenichi Handa  <handa@m17n.org>

	* international/quail.el (quail-lookup-key): New optional arg
	NOT-RESET-INDICES.
	(quail-get-translations): Call quail-lookup-key with
	NOT-RESET-INDICES t.
	(quail-completion): Likewise.
	(quail-lookup-map-and-concat): Likewise.

2004-04-20  Kenichi Handa  <handa@m17n.org>

	* international/quail.el (quail-update-translation): Don't insert
	such an unsupported multibyte char in a unibyte buffer.

2004-04-20  Nick Roberts  <nick@nick.uklinux.net>

	* progmodes/gdb-ui.el (gdb-frame-parameters): New constant.
	(gdb-frame-breakpoints-buffer, gdb-frame-stack-buffer)
	(gdb-frame-threads-buffer, gdb-frame-registers-buffer)
	(gdb-frame-locals-buffer, gdb-frame-gdb-buffer)
	(gdb-frame-assembler-buffer): Improve behavior with
	multiple frames.
	(gdb-display-buffer): Extend search to all visible frames.

2004-04-19  Eli Zaretskii  <eliz@gnu.org>

	* mail/rmail.el (rmail-convert-to-babyl-format): Don't remove ^M
	characters left after base64 decoding.
	(rmail-decode-region): Use -dos variety of `coding', to remove any
	^M characters left after qp or base64 decoding.

2004-04-19  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* x-dnd.el (x-dnd-open-local-file, x-dnd-open-file): Improve error
	messages.

2004-04-19  Stephen Eglen  <stephen@gnu.org>

	* add-log.el (add-change-log-entry): Update doc string to mention
	add-log-full-name and add-log-mailing-address.

2004-04-18  Juri Linkov  <juri@jurta.org>

	* info.el (Info-find-file, Info-find-node-2): Add history and toc.
	(Info-find-node-2): Simplify error message.
	(Info-insert-dir): Use Info-following-node-name.
	(Info-goto-node): Remove *info-history* and *info-toc*.
	(Info-history): Create a node of the virtual history file.
	(Info-toc): Create a node of the virtual toc file.
	(Info-insert-toc): New arg `curr-file' for reference file names.
	(info-apropos): Remove redundant var binding for temp-file.
	(Info-index, Info-index-next, Info-mode): Doc fix.
	(Info-goto-emacs-command-node): Don't jump to *info* from
	non-*info* Info buffers.
	(Info-fontify-node): Don't show the file name of external
	references if `Info-hide-note-references' is `hide'.  Don't hide
	newlines at the end of paragraphs.

	* international/mule-diag.el (list-input-methods):
	Fix args to help-xref-button.

	* help-fns.el (help-with-tutorial): Call `hack-local-variables'
	to put into effect local variables from TUTORIAL files.

	* textmodes/paragraphs.el (sentence-end) <function>: New fun
	with default value taken from the variable `sentence-end'.
	(sentence-end) <defcustom>: Set default to nil.  Doc fix.
	Add nil const to :type.
	(sentence-end-without-period, sentence-end-double-space)
	(sentence-end-without-space): Doc fix.

	* textmodes/paragraphs.el (forward-sentence):
	* textmodes/fill.el (canonically-space-region, fill-nobreak-p)
	(fill-delete-newlines):
	* progmodes/cc-cmds.el (c-beginning-of-statement):
	Use function `sentence-end' instead of variable `sentence-end'.

2004-04-18  Andreas Schwab  <schwab@suse.de>

	* progmodes/compile.el (compilation-start): Set window start to
	point-min if compilation-scroll-output is nil.

2004-04-18  John Wiegley  <johnw@newartisans.com>

	* iswitchb.el (iswitchb-completions): Remove dependency on cl.

2004-04-18  Nick Roberts  <nick@nick.uklinux.net>

	* progmodes/gdb-ui.el (gdb-goto-info): Require 'info.
	(gdb-info-breakpoints-custom): Revert previous change.
	(gdb-view-assembler): Update assembler if necessary.
	(gdb-frame-handler): Parse correctly for gdb-current-frame.
	(gdb-display-source-buffer): Update properly when both source and
	assembler are visible.

2004-04-17  John Wiegley  <johnw@newartisans.com>

	* iswitchb.el (iswitchb-max-to-show): Add a new config variable
	which limits the number of names shown in the minibuffer.  Off by
	default.
	(iswitchb-completions): Use `iswitchb-max-to-show'.  This speeds
	up iswitchb for users with a multitude of open buffers by showing
	only the first and last N/2 buffers in the completion list (which
	is enough to aid C-s/C-r, and to know that more characters are
	needed to refine the completion list).

2004-04-17  Richard M. Stallman  <rms@gnu.org>

	* files.el (locate-file-completion): Handle nil in path-and-suffixes.
	(file-truename): Expand all ~ constructs directly.
	(insert-directory): Delete any error msg output by the
	`insert-directory-program'.

	* allout.el (allout-mode-exposure-menu, allout-mode-editing-menu):
	(allout-mode-navigation-menu, allout-mode-misc-menu): New defvars.
	(allout-prior-bindings, allout-added-bindings): Defvars deleted.
	(allout-init): Use find-file-hook, not find-file-hooks.
	(allout-mode): Eliminate Emacs 18 support.
	Use write-contents-functions, not local-write-file-hooks.

2004-04-17  Daniel Pfeiffer  <occitan@esperanto.org>

	* progmodes/compile.el (compilation-error-properties): Fix for
	adding messages when there are already markers for their file.
	(compilation-fake-loc): New function.

2004-04-16  Dave Love  <fx@gnu.org>

	* progmodes/python.el (python-compilation-line-number): Fix braindamage.
	(python-load-file): Fix python-orig-start setting.

	* progmodes/compile.el: Doc fixes.
	(compilation-error-regexp-alist-alist)
	(compilation-mode-font-lock-keywords): Allow non-ASCII where possible.
	(compilation-assq): Wrap in eval-when-compile.
	(compilation-mode-font-lock-keywords): Don't use list*.
	(compilation-start): Avoid warning.
	(compilation-compat-error-properties)
	(compilation-directory-properties): Add keymap property.
	(compilation-parsing-end): Make it a marker for better compatibility.

	* progmodes/python.el (python-after-info-look): Use with-no-warnings.

2004-04-16  Mark A. Hershberger  <mah@everybody.org>

	* xml.el: Doc fixes.
	(xml-get-children): Only looks at sub-tags and ignore strings.

	* xml.el (xml-parse-tag): Avoid overwriting node-name.

2004-04-16  Stefan Monnier  <monnier@iro.umontreal.ca>

	* diff-mode.el (diff-end-of-hunk): Be more careful with unified hunks.

2004-04-16  Andre Spiegel  <spiegel@gnu.org>

	* vc-hooks.el (vc-default-workfile-unchanged-p): Quote signal.

	* vc.el (vc-print-log): Likewise.

2004-04-16  Masatake YAMATO  <jet@gyve.org>

	* simple.el (completion-setup-function): Set an initial value
	to `element-common-end' before entering loop.  Set a value
	to `element-common-end' at the end of loop.
	The bug is reported by Juri Linkov <juri@jurta.org> in emacs-devel list.
	(completions-common-part): Rename from completion-de-emphasis.
	(completions-first-difference): Rename from completion-emphasis.
	Suggested by RMS.

2004-04-16  Juanma Barranquero  <lektu@terra.es>

	* bookmark.el (bookmark-send-edited-annotation): Fix docstring.
	(bookmark-edit-annotation-mode): Add mode name.

2004-04-15  Stefan Monnier  <monnier@iro.umontreal.ca>

	* smerge-mode.el (smerge-match-conflict): Try to do something sensible
	for nested conflict markers.
	(smerge-find-conflict): Better handle errors in smerge-match-conflict.

2004-04-15  Nick Roberts  <nick@nick.uklinux.net>

	* progmodes/gdb-ui.el (gdb-goto-info): New function.

	* progmodes/gud.el (gud-menu-map, gud-tool-bar-map): Add help button.

2004-04-14  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/bytecomp.el (batch-byte-compile-file):
	Give a backtrace if requested.

	* progmodes/ada-mode.el (ada-create-menu): Remove redundant call.

	* progmodes/python.el (python-mouse-2-command, python-RET-command):
	Remove unused functions.
	(python-orig-start-line, python-orig-file): Remove.
	(python-orig-start): New var.
	(python-input-filter, python-compilation-line-number)
	(python-send-region, python-load-file): Use it.

	* info.el (info): Always jump to *info*.

	* subr.el (posn-set-point): New function.

	* mouse.el (mouse-set-point): Use it.

	* progmodes/compile.el (compile-goto-error): Use it.
	(compilation-button-map): New keymap.
	(compilation-error-properties): Use it.
	(compilation-shell-minor-mode-map): Don't bind mouse-2.

	* smerge-mode.el (smerge-popup-context-menu): Use it.

	* emacs-lisp/checkdoc.el (checkdoc-output-mode-map)
	(checkdoc-find-error-mouse, checkdoc-find-error): Use it to merge the
	mouse and non-mouse case.

	* diff-mode.el (diff-goto-source): Make it work for mouse bindings.
	(diff-mouse-goto-source): Make it an alias of diff-goto-source.

	* pcvs.el (cvs-mode-toggle-mark): Rename from cvs-mouse-toggle-mark.
	Make it work for non-mouse events.

	* pcvs-info.el (cvs-status-map): Update binding name.

2004-04-14  Mark A. Hershberger  <mah@everybody.org>

	* xml.el (xml-maybe-do-ns): New function to handle namespace
	parsing of both attribute and element names.
	(xml-ns-parse-ns-attrs, xml-ns-expand-el, xml-ns-expand-attr)
	(xml-intern-attrlist): Remove in favor of xml-maybe-do-ns.
	(xml-parse-tag): Update assumed namespaces.  Clean up namespace parsing.
	(xml-parse-attlist): Make it do its own namespace parsing.

2004-04-14  Dave Love  <fx@gnu.org>

	* progmodes/python.el (run-python): Fix use of \n.
	(python-load-file): Remove `try' from Python fragment.
	(python-describe-symbol): Fix message.

	* comint.el: Doc fixes.
	(comint-last-input-start, comint-last-input-end)
	(comint-last-output-start): Give them values.
	(comint-arguments): Avoid warning.
	(comint-skip-prompt): Use line-end-position.
	(comint-backward-matching-input): Rename arg to agree with doc.
	(comint-extract-string): Use syntax-ppss.
	(comint-dynamic-simple-complete): Delete useless list construction.
	(comint-redirect-subvert-readonly): New.
	(comint-redirect-preoutput-filter): Use it.

	* emacs-lisp/lisp.el (beginning-of-defun-raw, end-of-defun):
	Correctly handle negative arguments when calling hook functions.

2004-04-14  Jesper Harder  <harder@ifa.au.dk>

	* info.el (info-apropos): Don't clobber Info-history-list.

2004-04-14  Daniel Pfeiffer  <occitan@esperanto.org>

	* progmodes/compile.el (compilation-setup):
	Localize overlay-arrow-position.
	(compilation-sentinel): Restructure code equivalently.
	(compilation-next-error): Find message on same line after point if
	not found before point.
	(compile-mouse-goto-error): Restore function so that compilation
	buffer need not be current and use compile-goto-error.
	(compile-goto-error): Restore function.
	(next-error): Set overlay-arrow-position.
	(compilation-forget-errors): Don't localize already local
	compilation-locs and remove FIXME about refontifying.

2004-04-14  Kim F. Storm  <storm@cua.dk>

	* startup.el (emacs-quick-startup): New defvar (set by -Q).
	(command-line): New option -Q.  Like -q --no-site-file, but
	in addition it also disables menu-bar, tool-bar, scroll-bars,
	tool-tips, and the blinking cursor.
	(command-line-1): Skip startup screen if -Q.
	(fancy-splash-head): Use ":align-to center" prop to center splash image.

	* emulation/cua-base.el (cua-read-only-cursor-color)
	(cua-overwrite-cursor-color, cua-global-mark-cursor-color): Doc fix.

2004-04-13  Dave Love  <fx@gnu.org>

	* progmodes/python.el: Doc fixes.  Changes for compiler warnings.
	(syntax): Don't require.
	(python) <defgroup>: Add :version.
	(python-quote-syntax): Re-written.
	(inferior-python-mode): Move stuff here from run-python and add
	some more.
	(python-preoutput-continuation, python-preoutput-result)
	(python-dotty-syntax-table): New.
	(python-describe-symbol): Use them.
	(run-python): Move stuff to inferior-python-mode.  Modify code
	loaded into Python.
	(python-send-region): Use python-proc, python-send-string.
	(python-send-string): Send newlines too.  Callers changed.
	(python-load-file): Re-written.
	(python-eldoc-function): New.
	(info-look): Don't require.
	(python-after-info-look): New.  A modified version of former
	top-level code for use with eval-after-load.
	(python-maybe-jython, python-guess-indent): Use widened buffer.
	(python-fill-paragraph): Re-written.
	(python-mode): Fix outline-regexp.  Set outline-heading-end-regexp,
	eldoc-print-current-symbol-info-function.  Add to eldoc-mode-hook.

2004-04-13  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/python.el (run-python): Use compilation-shell-minor-mode.
	Set compilation-error-regexp-alist earlier.

	* progmodes/compile.el (compilation-minor-mode-map)
	(compilation-shell-minor-mode-map, compile-mouse-goto-error)
	(compile-goto-error): Re-merge the mouse and non-mouse commands.

2004-04-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/compile.el (compile-goto-error): Select the buffer/window
	corresponding to the event.

2004-04-12  Joe Buehler  <jbuehler@hekiman.com>

	* loadup.el: Add cygwin to system-type list, for unexec() support.

2004-04-12  John Paul Wallington  <jpw@gnu.org>

	* ibuffer.el (ibuffer-delete-window-on-quit): Remove.
	(ibuffer-restore-window-config-on-quit): New variable to replace
	`ibuffer-delete-window-on-quit'.  Update all references.
	(ibuffer-prev-window-config): New variable.
	(ibuffer-quit): Restore previous window configuration instead of
	deleting window.
	(ibuffer): Save window configuration before showing Ibuffer buffer.

	* help.el (describe-mode): Doc fix.

2004-04-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/compile.el (compilation-mode-font-lock-keywords): Fix test
	not to treat nil as a function.

	* vc-arch.el (vc-arch-root): Be a bit more careful.
	(vc-arch-register): Save the buffer if we modified it.
	(vc-arch-delete-rej-if-obsolete): Save excursion.
	(vc-arch-find-file-hook): Use the simpler after-save-hook.
	(vc-arch-responsible-p, vc-arch-init-version): New functions.

	* net/ldap.el (ldap-search): Use list*.

2004-04-12  Juri Linkov  <juri@jurta.org>

	* info.el (Info-follow-reference): Allow multiline reference name.

2004-04-11  Dave Love  <fx@gnu.org>

	* emacs-lisp/bytecomp.el (byte-compile-cond): Fix last change.

	* progmodes/python.el: New file.

2004-04-11  Andre Spiegel  <spiegel@gnu.org>

	* vc-hooks.el (vc-arg-list): Function removed.
	(vc-default-workfile-unchanged-p): Use condition-case to check for
	backward compatibility.

	* vc.el (vc-print-log): Use condition-case to check for backward
	compatibility.

2004-04-11  Juri Linkov  <juri@jurta.org>

	* dired.el (dired-faces): New defgroup.
	(dired-header, dired-mark, dired-marked, dired-flagged)
	(dired-warning, dired-directory, dired-symlink, dired-ignored):
	New faces.
	(dired-header-face, dired-mark-face, dired-marked-face)
	(dired-flagged-face, dired-warning-face, dired-directory-face)
	(dired-symlink-face, dired-ignored-face): New face variables.
	(dired-font-lock-keywords): Use them instead of font-lock faces.
	Split the rule for dired marks into 3 separate rules: for marks,
	marked file names and flagged file names.

	* help-mode.el (help-make-xrefs): Add a final newline to the
	*Help* buffer.

2004-04-11  John Paul Wallington  <jpw@gnu.org>

	* replace.el (occur-engine): Distinguish between one and several
	matches in the matches per buffer heading.

2004-04-11  Kim F. Storm  <storm@cua.dk>

	* ido.el (ido-confirm-unique-completion): New defcustom.
	(ido-complete): Use it.
	(ido-write-file): Set it to t unconditionally.

2004-04-10  Miles Bader  <miles@gnu.org>

	RCS keyword removal (only non-comment changes are enumerated here):

	* emacs-lisp/bytecomp.el (byte-compile-version): Variable removed.
	(byte-compile-insert-header): Don't use `byte-compile-version'.
	* forms.el (forms-version): Variable removed.
	(forms-mode): Don't use `forms-version'.
	* recentf.el (recentf-version): Variable removed.
	* progmodes/delphi.el (delphi-version): Variable removed.
	* progmodes/ada-mode.el (ada-mode): RCS keyword removed from docstring.

2004-04-09  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/easymenu.el (easy-menu-add): Make it work in non-X Emacs.

2004-04-09  Jesper Harder  <harder@ifa.au.dk>

	* info.el (info-apropos): Improve menu item regexp.

2004-04-09  Simon Josefsson  <jas@extundo.com>

	* mail/smtpmail.el: Add comment, based on report by
	kdc@rcn.com (Kevin D. Clark).

2004-04-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/compile.el (compilation-mode-font-lock-keywords):
	Redo one more thing that I didn't notice Daniel had undone.

2004-04-08  Nick Roberts  <nick@nick.uklinux.net>

	* progmodes/gdb-ui.el (gdb-source-window): Remove variable.
	(gdb-goto-breakpoint, gdb-display-buffer)
	(gdb-display-source-buffer, gdb-view-source-function)
	(gdb-view-assembler, gdb-setup-windows, gdb-restore-windows)
	(gdb-source-info, gdb-frame-handler): Don't specify a window
	for display.
	(gdb-info-breakpoints-custom): Remove superfluous update of
	assembler buffer.
	(gdb-many-windows): Make settable outside gdb.

2004-04-08  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* calendar/diary-lib.el (diary-mode, fancy-diary-display-mode):
	Derive from fundamental-mode rather than text-mode.

2004-04-08  Juri Linkov  <juri@jurta.org>

	* info.el (Info-history): Doc fix.
	(Info-history-list): New var.
	(info-xref): Change magenta4 to blue, remove bold for dark and
	light backgrounds, change bold to underline for non-color classes.
	(info-xref-visited): New face.
	(Info-fontify-visited-nodes): New custom.
	(Info-hide-note-references): Add new value `hide'.  Doc fix.
	(Info-reference-name): New var.
	(Info-selection-hook): New custom.
	(Info-edit-mode-hook): New var.
	(Info-find-file): New fun.
	(Info-find-node): Move part of code to Info-find-file.
	(Info-find-node-2): Add anchors to Info-history-list.  Move point
	to the place with the reference name if name is defined.
	(Info-select-node): Add current node to Info-history-list.
	(Info-goto-node): Switch to *info* from *info-history* *info-toc*.
	(Info-search-whitespace-regexp): New custom.
	(Info-search-case-fold): New var.
	(Info-search): Add "case-sensitively" to the prompt.
	Use Info-search-whitespace-regexp.  Set Info-search-case-fold.
	(Info-search-case-sensitively, Info-search-next): New fun.
	(Info-up): Move point to the menu item of the current node.
	(Info-history): New fun.  Add *info-history* to
	same-window-buffer-names.
	(Info-toc): New fun.  Add *info-toc* to same-window-buffer-names.
	(Info-insert-toc): New fun.
	(Info-build-toc): New fun.
	(Info-follow-reference): Add new arg `fork'.  Doc fix.
	Replace [ \n\t]* by [ \n\t]+ in the *Note regexp.  For references
	with the same name prefer the reference closest to point.
	(Info-next-reference): Replace * by + in the *Note regexp.
	Add regexp for http:// and ftp://.  Skip the *Note prefix.
	(Info-prev-reference): Replace * by + in the *Note regexp.
	Add regexp for http:// and ftp://.  Skip the *Note prefix.
	(Info-follow-nearest-node): Add new arg `fork'.
	(Info-try-follow-nearest-node): Add new arg `fork'.
	Call browse-url for http:// and ftp:// references.
	Set Info-reference-name for index entries.
	(Info-mode-menu): Add menu items for Info-search-case-sensitively,
	Info-search-next, Info-history, Info-toc, clone-buffer.
	(Info-menu-update): Replace * by + in the *Note regexp.
	(Info-mode): Add documentation for Info-history, Info-toc,
	Info-search-case-sensitively, Info-search-next, clone-buffer.
	(Info-fontify-menu-headers): Remove fun.  Move code to
	Info-fontify-node.
	(Info-fontify-node): Add docstring.  Add local vars
	fontify-visited-p and not-fontified-p.  If not-fontified-p is t
	then fontify header line, titles, menu headers, http and ftp
	references, refill paragraphs.  If not-fontified-p is t or
	fontify-visited-p is t then fontify cross references, menu items.
	Fontify menu headers.  Fontify http and ftp references.
	Change regexp for cross references to require whitespace after *Note,
	add matching groups for file and node names.  Remove hack for quote.
	Use display property for Info-hide-note-references=t.  Use fifth
	or fourth match for help-echo.  Display visited nodes in a
	different face.  Unhide file names of external references.
	Unhide newlines.  Display visited menu items in a different face.

2004-04-07  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/compile.el: Require CL.
	(compilation-mode-font-lock-keywords): Re-install the "line as
	function" patch.

	* help-fns.el (help-C-source-directory): New var.
	(help-subr-name, help-C-file-name, help-find-C-source): New funs.
	(describe-function-1, describe-variable): Use them.

	* help-mode.el (help-function-def, help-variable-def): Handle hyperrefs
	to C source files specially.

2004-04-07  Jan Nieuwenhuizen  <janneke@gnu.org>

	* info.el (Info-hide-cookies-node): New function.
	(Info-select-node): Use it.
	(Info-display-images-node): Remove message with image file name.

2004-04-07  Daniel Pfeiffer  <occitan@esperanto.org>

	* progmodes/compile.el (compilation-warning-face)
	(compilation-info-face, compilation-skip-threshold)
	(compilation-skip-visited, compilation-context-lines):
	Declare :version when added to Emacs.
	(compilation-error-regexp-alist-alist): Extend caml and irix.
	(compilation-setup): Fix if font-locked w/o font-lock-defaults.
	(compilation-mode-font-lock-keywords): Temporarily undo line as
	function patch, which wasn't ready.

2004-04-07  Kenichi Handa  <handa@m17n.org>

	* international/latin1-disp.el (latin1-display-setup): Check each
	character is displayable or not instead of calling
	latin1-display-check-font.

2004-04-06  Kenichi Handa  <handa@m17n.org>

	* language/ethio-util.el (ethio-sera-being-called-by-w3):
	New variable.
	(ethio-sera-to-fidel-ethio): Check ethio-sera-being-called-by-w3
	instead of sera-being-called-by-w3.
	(ethio-fidel-to-sera-buffer): Likewise.
	(ethio-find-file): Bind ethio-sera-being-called-by-w3 to t
	instead of sera-being-called-by-w3.
	(ethio-write-file): Likewise.

2004-04-05  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* printing.el: Doc fix.

2004-04-05  Nick Roberts  <nick@nick.uklinux.net>

	* progmodes/gdb-ui.el (gdb-use-inferior-io-buffer): New option.
	(gdb-ann3, gdb-send, gdb-starting, gdb-stopping)
	(gdb-setup-windows): Only use separate IO buffer if required.

2004-04-06  Kim F. Storm  <storm@cua.dk>

	* term.el (term-is-xemacs): Remove.
	(term-if-xemacs, term-ifnot-xemacs): Test (featurep 'xemacs).
	(term-window-width): New function.
	(term-mode, term-check-size): Use it.
	(term-mode): Disable overflow-newline-into-fringe in term buffer.

2004-04-05  Per Abrahamsen  <abraham@dina.kvl.dk>

	* cus-edit.el (custom-add-parent-links): Change unbound variable
	`symbol' to `name'.

2004-04-05  Jesper Harder  <harder@ifa.au.dk>
	* info.el (info-apropos): New function.
	(Info-mode-menu): Add it.
	(Info-find-node, Info-find-node-2): Grok apropos virtual file.

	* help-mode.el (help-make-xrefs): Recognize aliased variable with
	inherited docstring.

	* play/gamegrid.el (gamegrid-add-score-insecure): Use sort-fields.

2004-04-04  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/fill.el (fill-comment-paragraph): Obey indent-tabs-mode.

	* progmodes/compile.el (font-lock): Don't require any more.
	(compilation-error-properties, compilation-start, compilation-sentinel)
	(compilation-filter, next-error): Use with-current-buffer.
	(compilation-skip-to-next-location, compilation-skip-threshold)
	(compilation-skip-visited): Move to silence the byte-compiler.
	(compilation-setup): Simplify.
	(compilation-next-error): Use line-(beginning|end)-position.
	Make sure `pt' is non-nil before using compilation-loop.
	(compile-goto-error): Add optional event arg.  Use it.
	(compile-mouse-goto-error): Make it an alias of compile-goto-error.
	(compilation-minor-mode-map, compilation-shell-minor-mode-map):
	Update the binding for mouse-2.
	(first-error): Set compilation-current-error to nil rather than bob.
	(compilation-parsing-end, compilation-parse-errors-function)
	(compilation-error-list, compilation-old-error-list):
	"New" compatibility variables.
	(compile-buffer-substring, compilation-compat-error-properties)
	(compilation-compat-parse-errors, compilation-forget-errors):
	New compatibility functions.
	(compilation-mode-font-lock-keywords): Use them.

2004-04-04  Luc Teirlinck  <teirllm@auburn.edu>

	* autorevert.el (auto-revert-handler): If point (or a window
	point) is at the end of the buffer, keep it there after
	reverting.  This allows to tail a file.
	Mention this in the `Commentary'.

	* format.el (format-write-file): Add optional argument CONFIRM
	and make it behave like the analogous argument to `write-file'.

2004-04-04  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* progmodes/ebnf2ps.el: Doc fix.
	(ebnf-version): New version number (4.2).
	(ebnf-syntax): Customization and docstring fix.
	(ebnf-eliminate-empty-rules, ebnf-optimize, ebnf-otz-initialize):
	Put autoloaded funs before first use.
	(ebnf-style-database): Add dtd entry.
	(ebnf-syntax-alist): Add dtd initialization.
	(ebnf-token-sequence): New fun.
	(ebnf-comment-table): Add new comment action character.
	(ebnf-dtd-parser, ebnf-dtd-initialize): Autoload funs from ebnf-dtd.

	* progmodes/ebnf-dtd.el: New file, implement a parser for DTD (Data
	Type Definition for XML).

	* progmodes/ebnf-abn.el (ebnf-abn-concatenation):
	* progmodes/ebnf-bnf.el (ebnf-sequence):
	* progmodes/ebnf-ebx.el (ebnf-ebx-concatenation):
	* progmodes/ebnf-iso.el (ebnf-iso-single-definition):
	* progmodes/ebnf-yac.el (ebnf-yac-sequence):
	Code simplification: call ebnf-token-sequence.

2004-04-04  Eli Zaretskii  <eliz@gnu.org>

	* calendar/timeclock.el (timeclock-relative)
	(timeclock-get-project-function, timeclock-get-workday-function)
	(timeclock-query-out, timeclock-when-to-leave)
	(timeclock-when-to-leave-string, timeclock-log-data)
	(timeclock-generate-report, timeclock-in): Doc fixes.

2004-04-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	* url/: New dir.  Import the URL package from its repository.

2004-04-03  Andreas Schwab  <schwab@suse.de>

	* diff-mode.el (diff-mode): Fix missing quote.

2004-04-03  Juri Linkov  <juri@jurta.org>

	* descr-text.el (describe-property-list): Add `font-lock-face'.

	* dired.el (dired-font-lock-keywords): Fix permission regexps.

2004-04-02  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* x-dnd.el (x-dnd-handle-moz-url, x-dnd-insert-utf16-text):
	Use utf-16le on little endian machines and utf-16be otherwise.

2004-04-02  David Kastrup  <dak@gnu.org>

	* net/browse-url.el (browse-url-generic): Use call-process
	instead of start-process to allow browsers that fork and detach.

2004-04-01  Daniel Pfeiffer  <occitan@esperanto.org>

	* compile.el (compilation-current-error): New var.
	(compilation-setup, compile-mouse-goto-error)
	(compile-goto-error, next-error): Use it.
	(compilation-skip-to-next-location): Default to t, which gives
	contiguous skipping like old compile (where this was redundant).
	(compilation-next-error): Prevent previous-* commands from moving
	back to message at or just before point.

2004-04-01  Nick Roberts  <nick@nick.uklinux.net>

	* progmodes/gdb-ui.el (gdb-view-source-function, gdb-view-assembler)
	(gdb-source-info): Don't display source at startup, if required.
	(gdb-show-main): New option.
	(gdba): Update documentation.
	(gdb-source): Cover case of auto-display output.

2004-03-31  Luc Teirlinck  <teirllm@auburn.edu>

	* autorevert.el: Delete obsolete autoloads and defvars.
	(auto-revert-check-vc-info): New user option.
	(auto-revert-vc-cvs-file-version, auto-revert-vc-buffer-p)
	(auto-revert-handler-vc): Delete.
	(auto-revert-handler): Treat return value `fast' of
	buffer-stale-function specially.  Check `auto-revert-check-vc-info'.

	* buff-menu.el (Buffer-menu-mode): Make the buffer-stale-function
	return `fast'.

	* files.el (buffer-stale-function): Doc change.

2004-03-31  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* printing.el: New tip on Tips section.
	(pr-version): New version number (6.7.4).
	(pr-shell-file-name): Initialization fix.

2004-03-31  Juri Linkov  <juri@jurta.org>

	* dired.el: Add autoload for `dired-do-touch'.
	(dired-touch-program): New var.
	(dired-mode-map): Bind `dired-do-touch' to T and add menu-item.
	(dired-no-confirm): Add `touch' to docstring.

	* dired-aux.el (dired-do-touch): New fun.
	(dired-do-chxxx): Add argument -t for touch operation.

	* dired-x.el (dired-mark-sexp): Replace hard-coded month names by
	`dired-move-to-filename-regexp'.

2004-03-31  H,Ae(Bkan Granath  <hakan.granath@kau.se>  (tiny change)

	* dired.el (dired-move-to-filename-regexp): Add `.' to HH:MM.

2004-03-30  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* progmodes/ebnf2ps.el (ebnf-eps-finish-and-write): Write a buffer if
	and only if the buffer was modified.

2004-03-30  Kenichi Handa  <handa@m17n.org>

	* international/characters.el: Delete pairs for U+2308..U+230B.

2004-03-29  Nick Roberts  <nick@nick.uklinux.net>

	* progmodes/gud.el (gud-gdb-marker-filter): Include "\n" in regexp
	to detect the beginning of a level 2 or 3 annotation.

2004-03-29  Kenichi Handa  <handa@m17n.org>

	* international/ucs-tables.el (ucs-insert): Fix the error message.

2004-03-29  Kenichi Handa  <handa@m17n.org>

	* international/mule-util.el (char-displayable-p): Fix generation
	of XLFD file name.

	* Makefile.in (setwins, setwins_almost): Change directory to $wd
	before finding directories by `find'.

2004-03-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* subr.el (interactive-form): Delete.  Now implemented in C.

	* pcvs.el (cvs-parse-process): Workaround for Darwin.

	* vc.el (vc-version-diff, vc-default-diff-tree): Change `rel' -> `rev'.
	(vc-diff-label): New fun.
	(vc-diff-internal): Use it.

	* progmodes/gdb-ui.el (gdb-post-prompt): Fix test.

2004-03-28  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* progmodes/ebnf-abn.el (ebnf-abn-parser): Handle initial comments.

	* progmodes/ebnf-ebx.el: New file, implement a parser for EBNF used to
	specify XML (EBNFX).

	* progmodes/ebnf2ps.el: Doc fix.
	(ebnf-version): New version number (4.1).
	(ebnf-syntax): Adjust customization.
	(ebnf-style-database): Add ebnfx entry.
	(ebnf-syntax-alist): Add ebnfx initialization.
	(ebnf-ebx-parser, ebnf-ebx-initialize): Autoload funs from ebnf-ebx.

	* printing.el: Doc fix.
	(pr-version): New version number (6.7.3).
	(pr-menu-position): Adjust X and Y positions when mouse-pixel-position
	returns nil for mouse position.  Reported by Drew Adams
	<drew.adams@oracle.com>.
	(pr-update-menus): Modify interactive declaration.  Reported by Drew
	Adams <drew.adams@oracle.com>.

2004-03-28  Nick Roberts  <nick@nick.uklinux.net>

	* progmodes/gdb-ui.el (gdb-ann3, gdb-send-item)
	(gud-gdba-marker-filter): Log the process input and output, if
	required.  From Stefan Monnier.
	(gdb-debug-log, gdb-enable-debug-log): New variables.
	(gdb-post-prompt): Don't do gdb-var-update on Mac OS X.

2004-03-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-hooks.el (vc-file-not-found-hook): Fix typo.
	From lorentey@elte.hu (L$,1 q(Brentey K,Aa(Broly).

2004-03-27  Luc Teirlinck  <teirllm@auburn.edu>

	* autorevert.el (auto-revert-handler): Handle auto-revert-mode.
	Call vc-find-file-hook here instead of in auto-revert-buffers.
	(auto-revert-buffers): Delete call to vc-find-file-hook.
	(auto-revert-verbose, global-auto-revert-non-file-buffers)
	(global-auto-revert-mode, auto-revert-set-timer)
	(auto-revert-handler, auto-revert-buffers): Doc fixes.

2004-03-27  Francis J. Wright  <F.J.Wright@qmul.ac.uk>

	* woman.el (woman-change-fonts): Rename local variable
	woman-font-alist to font-alist to avoid a compiler warning.

2004-03-27  Dave Love  <fx@gnu.org>

	* emacs-lisp/rx.el (rx): Doc fix.
	Fix copyright years.

	* strokes.el (strokes-global-set-stroke-string): New function.
	(strokes-list-strokes): Cope with strings, not just commands.
	Set foreground color of image.
	(strokes-global-set-stroke): Doc fix.

2004-03-26  Luc Teirlinck  <teirllm@auburn.edu>

	* buff-menu.el (Buffer-menu-revert-function): Make it suitable for
	Auto Revert mode.
	(Buffer-menu-files-only): New variable.
	(Buffer-menu-toggle-files-only): New function.
	(Buffer-menu-mode-map): Bind it to `T'.
	(Buffer-menu-mode): Mention `T' in docstring.
	Set buffer-stale-function.
	(list-buffers-noselect): Mark buffer non-modified and set
	Buffer-menu-files-only.

	* dired.el (buffer-stale-function): Remove no longer needed defvar.

	* autorevert.el (auto-revert-handler): Print revert message
	before, rather than after, reverting.
	(buffer-stale-function): Move to files.el.

	* files.el (buffer-stale-function): Move here from autorevert.el.

2004-03-26  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc.el (vc-maybe-resolve-conflicts): Don't prompt the user.

	* calc/calc.el (calc-mode-map): Use mapc.

	* apropos.el (apropos-mode): Don't autoload.
	(apropos-symbols-internal): New fun.  Extracted from `apropos'.
	(apropos): Use it.
	(apropos-print): Add optional `text' argument.
	(apropos-describe-plist): Use help-buffer and hexlp-setup-xref.
	Don't assume point-min == 1.

	* bs.el (bs-buffer-list): Use buffer-local-value.
	(bs--set-toggle-to-show): Use with-current-buffer.

	* buff-menu.el (Buffer-menu-sort, Buffer-menu-make-sort-button):
	New funs.
	(list-buffers-noselect): Use them.  Adjust :align-to to new style.

	* cvs-status.el (cvs-tree-use-jisx0208): Use char-displayable-p.

	* dabbrev.el (dabbrev-expand): Fix regexp construction.
	(dabbrev--find-expansion): Use pop.
	(dabbrev--search): Use match-string-no-properties.

	* dired.el (dired-mode): Use run-mode-hooks.
	(dired-move-to-end-of-filename): Use match-string.

	* ediff-init.el (ediff-hide-face): Check that facemenu-unlisted-faces
	is bound before using it.
	(ediff-verbose-p): Make it into a var since it's not constant.

	* electric.el (Electric-pop-up-window): Avoid popping up a new frame.

	* faces.el (read-face-font): Don't cons up unnecessarily.
	(header-line, tool-bar): Share common parts.

	* files.el (file-relative-name): Use compare-strings.

	* finder.el (finder-mode): Follow coding convention.

	* subr.el (read-number): New function.

	* ses.el (ses-read-number): Move to subr.el.
	(ses-set-header-row): Use read-number.

2004-03-26  Andre Spiegel  <spiegel@gnu.org>

	* vc-hooks.el (vc-arg-list): New function, which handles both
	compiled and uncompiled code.
	(vc-default-workfile-unchanged-p): Use it.

	* vc.el (vc-print-log): Undo prev change, use new function
	vc-arg-list from vc-hooks.el.

2004-03-26  Masatake YAMATO  <jet@gyve.org>

	* simple.el (completion-setup-function): Emphasize the
	first uncommon characters in the completions; and de-emphasize
	the common prefix substrings.
	(completion-emphasis): New face.
	(completion-de-emphasis): New face.

2004-03-25  Juanma Barranquero  <lektu@terra.es>

	* progmodes/cperl-mode.el (cperl-indent-alist, cperl-where-am-i):
	Comment out (it's unused and unfinished code).

2004-03-25  Sam Steingold  <sds@gnu.org>

	* vc.el (vc-print-log): Fix a bug in the last patch:
	backend-function may be a byte-compiled object, not a lambda.

2004-03-25  Juri Linkov  <juri@jurta.org>

	* descr-text.el (describe-property-list): Add a button
	for `face' property that calls `describe-face'.
	Suggested by Luis Fernandes <elf@ee.ryerson.ca>

	* international/mule.el (keyboard-coding-system):
	* kmacro.el (kmacro-call-macro): Fix docstring.

	* dired.el: Fix comments.

	* textmodes/fill.el (fill): Fix Info link.

	* font-lock.el (fast-lock, lazy-lock):
	* jit-lock.el (jit-lock): Remove links to removed Support Modes
	Info node.

	* eshell/eshell.el (eshell): Fix broken info-link.

	* eshell/em-alias.el (eshell-alias, eshell-bad-command-tolerance):
	* eshell/em-banner.el (eshell-banner):
	* eshell/em-smart.el (eshell-smart):
	* eshell/esh-cmd.el (eshell-cmd):
	Comment out broken info-links to incomplete Info manual.

	* info-xref.el: Fix commentary.

2004-03-25  Kevin Ryde  <user42@zip.com.au>

	* info-xref.el (info-xref-check-buffer): Report empty filename parts.
	Remove spurious node duplicate suppression, doesn't work, not wanted.
	(info-xref-output): Take format style args, add "sit-for 0" to let
	user see the results as they progress.
	(info-xref-check-all-custom): New function.

2004-03-25  Nick Roberts  <nick@nick.uklinux.net>

	* gdb-ui.el: Moved to progmodes.

2004-03-24  Stefan Monnier  <monnier@iro.umontreal.ca>

	* diff-mode.el (diff-font-lock-keywords): Disable yank-handler.

2004-03-24  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* calendar/appt.el (appt-check): Remove superfluous progn.
	When finished with diary buffer: if it was not being displayed
	before, kill it; otherwise restore its original state.
	Suggested by Matthew Mundell <matt@mundell.ukfsn.org>.

	* calendar/calendar.el (calendar-set-mode-line): Use total
	available mode-line width, rather than frame-width.

	* calendar/diary-lib.el (fancy-diary-display): Set mode-line
	after mode change so effect not lost.

2004-03-23  Dave Love  <fx@gnu.org>

	* dired.el (dired) <defgroup>: Add link to manual.
	(dired-font-lock-keywords): Add highlighting on unusual permissions.
	(dired-revert): Use dolist.
	(dired-mode-map): Add U binding.
	(dired-mode): Add font-lock-beginning-of-syntax-function.
	(dired-garbage-files-regexp): Make it a defcustom.

2004-03-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-arch.el (vc-arch-diff): Handle the special case where `newvers'
	is equivalent to nil.
	(vc-arch-diff3-rej-p): Be a bit more flexible in what we accept.
	(vc-arch-mode-line-string): Accept `added' state.
	(vc-arch-state): Use inode-sigs if available.
	(vc-arch-add-tagline): Rename from vc-arch-add-tag.
	Copy&delete existing id file if any.  Fallback if uuidgen is absent.
	(vc-arch-tagline-re): New var.
	(vc-arch-file-source-p, vc-arch-file-id, vc-arch-tagging-method):
	New functions.
	(vc-arch-find-file-not-found-hook, vc-arch-register): New backend ops.
	(vc-arch-registered): Try our best guess using vc-arch-file-source-p.

	* vc-hooks.el (vc-default-find-file-not-found-hook): New fun.
	(vc-file-not-found-hook): Use it.

	* diff-mode.el (diff-default-read-only): Change default.
	(diff-mode-hook): Make it a defcustom.  Add some options.
	(diff-mode-map): Bind diff-refine-hook.
	(diff-yank-handler): New var.
	(diff-yank-function): New fun.
	(diff-font-lock-keywords): Use them.
	(diff-end-of-file): Handle case where file-header looks like diff text.
	(diff-hunk-kill): Adjust to "new" hunk-next behavior.
	(diff-file-kill): Delete a subsequent empty line, if applicable.
	(diff-hunk-file-names): New fun, extracted from diff-tell-file-name.
	(diff-find-file-name): Use it.
	(diff-tell-file-name): New command.
	(diff-mode): Be careful with view-mode.
	(diff-delete-if-empty, diff-delete-empty-files, diff-make-unified):
	New functions, for use in diff-mode-hook.
	(diff-find-source-location): Catch "regex too large" errors.
	(diff-apply-hunk, diff-test-hunk): Go to old or new file.
	(diff-refine-hunk): New command.

	* smerge-mode.el (smerge-mode-menu): Fix activate pred for resolve.
	(smerge-context-menu-map): Remove unused var.
	(smerge-keep-all): Preserve markers.
	(smerge-keep-n): New fun.
	(smerge-keep-base, smerge-keep-other, smerge-keep-mine)
	(smerge-keep-current, smerge-ediff): Use it.
	(smerge-kill-current): Use it.  Make it work on some 3-part conflicts.
	(smerge-popup-context-menu): Also use context-menu on 3-part conflicts.
	(smerge-resolve): Resolve trivial 3-part conflicts.

2004-03-23  Juri Linkov  <juri@jurta.org>

	* man.el (Man-width): New var.
	(Man-getpage-in-background): Use it.
	(Man-support-local-filenames): New var and fun.
	(Man-build-man-command): Don't add a second %s.
	(Man-fontify-manpage): Clean up message.
	(Man-mode): Set outline-regexp, outline-level,
	imenu-generic-expression.

	* woman.el (woman-fill-frame): Doc fix.
	(woman-decode-region): Use window-width instead of frame-width.

	* abbrevlist.el (list-one-abbrev-table):
	* descr-text.el (describe-char):
	* international/mule-diag.el (describe-current-coding-system):
	* international/quail.el (quail-insert-decode-map):
	Use window-width instead of frame-width.

	* jka-compr.el (jka-compr-compression-info-list): Add tbz and dz.
	(jka-compr-mode-alist-additions): Add tbz.
	(jka-compr-write-region, jka-compr-insert-file-contents):
	Add message for undefined compress-program.
	(jka-compr-write-region): Remove redundant var bindings.

	* dired-x.el (dired-guess-shell-alist-default): Add choices for
	extracting files into subdirectory.  Add tbz and dz.  Fix regexps.
	Add extensions .[0-9] for man and nroff, and .pod for perldoc.
	(dired-man): Use dired-guess-shell-command.
	(dired-guess-shell-case-fold-search): Change defvar to defcustom.
	Change default nil to t.

	* dired-aux.el (dired-compress-file-suffixes): Add dz and tbz.
	(dired-compare-directories): Add default value for empty input.

	* help-at-pt.el: Move suggestions for key bindings to Commentary.

	* time.el (display-time-string-forms): Fix help-echo date format.

2004-03-22  Luc Teirlinck  <teirllm@auburn.edu>

	* autorevert.el (global-auto-revert-non-file-buffers): Expand docstring.
	(buffer-stale-function): New variable.
	(auto-revert-list-diff, auto-revert-dired-file-list)
	(auto-revert-dired-changed-p, auto-revert-buffer-p): Delete.
	(auto-revert-handler): Take over some functionality of deleted
	functions.
	(auto-revert-buffers): Delete call to auto-revert-buffer-p.

	* dired.el (dired-directory-changed-p): New fun, extracted from
	dired-internal-noselect.
	(dired-buffer-stale-p): New fun.
	(dired-internal-noselect): Use dired-directory-changed-p.
	Eliminate revert messages.
	(dired-mode): Set buffer-stale-function to dired-buffer-stale-p.

2004-03-23  Kenichi Handa  <handa@m17n.org>

	* international/characters.el: Setup syntaxes for more parentheses
	Unicode characters.

	* international/mule-cmds.el (select-safe-coding-system):
	Merge coding-system and auto-cs before comparing them.

2004-03-22  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/pp.el (pp-eval-expression): Simplify.

	* emacs-lisp/lisp-mode.el (lisp-mode-variables): Don't set
	normal-auto-fill-function and comment-indent-function.
	The default values now work just as well.
	Don't set font-lock-beginning-of-syntax-function since we already set
	syntax-begin-function.
	(lisp-outline-level): Put ;;;###autoload at same level as (.
	(prin1-char): Quote special chars.

	* emacs-lisp/lisp-mnt.el (lm-keywords-finder-p): Use defvar rather
	than with-no-warnings.

	* emacs-lisp/edebug.el (edebug-display): Bring up a debug trace
	if the source location can't be found.
	(edebug-compute-previous-result): Use prin1-char.

	* emacs-lisp/checkdoc.el (checkdoc-error): Don't assume point-min == 1.
	(debug-ignored-errors): Add an entry.

	* emacs-lisp/bytecomp.el (byte-recompile-directory): Ignore hidden dir.
	(byte-compile-file): Output warning when deleting a file.

	* emacs-lisp/byte-run.el (defsubst): Add edebug spec and use backquote.
	(dont-compile, eval-when-compile, eval-and-compile): Add edebug spec.

	* emacs-lisp/byte-opt.el (byte-compile-log-lap)
	(byte-compile-inline-expand): Use backquote.
	(byte-optimize-pure-func): Rename from byte-optimize-concat.
	(symbol-name, regexp-opt, regexp-quote): Mark as pure.

	* emacs-lisp/backquote.el (backquote-list*-macro): Use nreverse.

	* emacs-lisp/advice.el (ad-subr-arglist): Simplify.

2004-03-22  Juri Linkov  <juri@jurta.org>

	* finder.el (finder-known-keywords): Fix data, tex, unix.

	* play/landmark.el: Fix keywords.

	* language/ethio-util.el (ethio-find-file): Doc fix.

	* emacs-lisp/warnings.el: Doc fix.

	* textmodes/ispell.el (ispell-help): Doc fix.

2004-03-21  Luc Teirlinck  <teirllm@auburn.edu>

	* format.el (format-insert-file): Always return a list of two
	elements, like insert-file-contents does.

2004-03-21  Andre Spiegel  <spiegel@gnu.org>

	* vc.el: Add new optional BUFFER argument to vc-BACKEND-print-log
	and vc-BACKEND-diff.
	(vc-print-log): If the print-log implementation supports it, use
	the new BUFFER argument to direct output to *vc-change-log*, not *vc*.
	(vc-version-diff, vc-diff-internal): Doc fixes.

	* vc-hooks.el (vc-default-workfile-unchanged-p): If the
	implementation supports it, let diff output go to *vc*,
	not *vc-diff*, since this is an internal call.

	* vc-cvs.el (vc-cvs-print-log, vc-cvs-diff): Add optional BUFFER arg.

	* vc-rcs.el (vc-rcs-print-log, vc-rcs-diff): Likewise.

	* vc-sccs.el (vc-sccs-print-log, vc-sccs-diff): Likewise.

2004-03-21  Dave Love  <fx@gnu.org>

	* progmodes/cfengine.el (cfengine-mode):
	Set parse-sexp-ignore-comments.

	* emacs-lisp/rx.el (rx): Work at compile time, not run time.

2004-03-21  Juanma Barranquero  <lektu@terra.es>

	* allout.el (allout-mode): Fix docstring.

2004-03-20  Luc Teirlinck  <teirllm@auburn.edu>

	* files.el (insert-directory): Fix bug if SWITCHES is a list.

	* autorevert.el (auto-revert-interval): Make new value take
	effect immediately when set through Custom.
	(auto-revert-set-timer): Add interactive declaration.

2004-03-19  David Ponce  <david@dponce.com>

	* ruler-mode.el (ruler-mode-header-line-format-old):
	Don't `make-variable-buffer-local'.
	(ruler-mode-ruler-function): Default to `ruler-mode-ruler'.
	(ruler-mode-header-line-format): Simply funcall the above.
	(ruler-mode): Use `make-local-variable' and `kill-local-variable'
	to save/restore a previous header line format.
	(ruler-mode-space): Don't depend on a numeric WIDTH value.
	(ruler-mode-ruler): Use symbolic display elements for scrollbar,
	fringes and margins width.
	(ruler-mode-ruler-function): Default to ruler-mode-ruler.

2004-03-18  Stefan Monnier  <monnier@iro.umontreal.ca>

	* log-edit.el (log-edit-font-lock-keywords): Typo.

	* textmodes/tex-mode.el (tex-shell): Set error parsing function here.
	(tex-send-tex-command): Rather than here.
	(tex-compilation-parse-errors): Simplify.

	* info.el (Info-default-dirs): Don't ignore last part of I-d-d-l.

	* time.el (display-time-string-forms): Add help-echo with date on time.

	* composite.el (compose-region): Use restore-buffer-modified-p.

	* disp-table.el (standard-display-8bit): Simplify.

	* server.el (server-process-filter): Delete temp frame.

	* add-log.el (add-change-log-entry): Simplify.

2004-03-19  Kim F. Storm  <storm@cua.dk>

	* hexl.el (hexl-mode-ruler): Adapt to new :align-to semantics.
	(hexl-follow-line): Don't require 'fringe.

	* progmodes/compile.el (compilation-start): Always set
	compilation-last-buffer and return it.

2004-03-17  Luc Teirlinck  <teirllm@auburn.edu>

	* simple.el (clone-buffer): Doc fix.

2004-03-18  Juanma Barranquero  <lektu@terra.es>

	* emacs-lisp/byte-run.el (make-obsolete-variable): Fix docstring.

2004-03-17  Stefan Monnier  <monnier@iro.umontreal.ca>

	* log-edit.el (log-edit-font-lock-keywords): New var.
	(log-edit-mode): Use it.

2004-03-17  Nick Roberts  <nick@nick.uklinux.net>

	* gdb-ui.el (gdb-var-list-children-handler): Handle C++ classes
	properly for watching in speedbar.

2004-03-17  Masatake YAMATO  <jet@gyve.org>

	* smerge-mode.el (smerge-popup-context-menu):
	Put `unwind-protect' around `overlay-put' and `popup-menu'.

2004-03-16  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-arch.el (vc-arch-workfile-unchanged-p): Define to avoid dup-diff.
	(vc-arch-workfile-version, vc-arch-mode-line-rewrite):
	Take sealed revisions into account.
	(vc-arch-checkin): Extract a summary line from the message.

2004-03-16  Masatake YAMATO  <jet@gyve.org>

	* register.el (register): Provide `register' feature.

2004-03-15  Masatake YAMATO  <jet@gyve.org>

	Added context menu support in smerge mode.
	Most of the part is written by Stefan Monnier.

	* smerge-mode.el (smerge-context-menu-map, smerge-context-menu):
	New keymap and menu.
	(smerge-text-properties): New function.
	(smerge-remove-props): New function.
	(smerge-popup-context-menu): New function.
	(smerge-resolve): Call `smerge-remove-props'.
	(smerge-keep-base, smerge-keep-other, smerge-keep-mine): Ditto.
	(smerge-keep-current): Ditto.
	(smerge-kill-current): New function.
	(smerge-match-conflict): Put text properties.
	Detect the file as `same-diff conflict' if the filename is "ANCESTOR".

2004-03-15  David Ponce  <david@dponce.com>

	* ruler-mode.el (ruler-mode-left-fringe-cols)
	(ruler-mode-right-fringe-cols, ruler-mode-left-scroll-bar-cols)
	(ruler-mode-right-scroll-bar-cols): Remove.
	(ruler-mode-window-col, ruler-mode-mouse-set-left-margin)
	(ruler-mode-mouse-set-right-margin, ruler-mode-ruler):
	Use fringe-columns and scroll-bar-columns.

2004-03-15  Masatake YAMATO  <jet@gyve.org>

	* hl-line.el (hl-line-range-function): New variable.
	(hl-line-move): New function.
	(global-hl-line-highlight): Use `hl-line-move'.
	(hl-line-highlight): Ditto.

	* scroll-bar.el (scroll-bar-columns):
	* fringe.el (fringe-columns): New function derived from ruler-mode.el.

	* ruler-mode.el (top-level): Require scroll-bar and fringe.
	(ruler-mode-left-fringe-cols)
	(ruler-mode-right-fringe-cols): Use `fringe-columns'.
	(ruler-mode-right-scroll-bar-cols)
	(ruler-mode-left-scroll-bar-cols): Use `scroll-bar-columns'.
	(ruler-mode-ruler-function): New variable.
	(ruler-mode-header-line-format): Call `ruler-mode-ruler-function'
	if the value for `ruler-mode-ruler-function' is given.

	* hexl.el (hexl-mode-hook): Make the hook customizable.
	(hexl-address-area, hexl-ascii-area): New customize variables.
	(hexlify-buffer): Put font-lock-faces on the address area and
	the ascii area.
	(hexl-activate-ruler): New function.
	(hexl-follow-line): New function.
	(hexl-highlight-line-range): New function.
	(hexl-mode-ruler): New function.

2004-03-14  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-hooks.el (vc-handled-backends): Add Arch.  Move MCVS down.
	(vc-default-find-file-hook): New fun.
	(vc-find-file-hook): Call new find-file-hook operation.

	* vc-arch.el: New file.

2004-03-12  Jesper Harder  <harder@ifa.au.dk>

	* info-look.el (info-lookup): Reuse an existing Info window.

2004-03-12  Francis J. Wright  <F.J.Wright@qmul.ac.uk>

	* woman.el (woman-preserve-ascii): Default value changed to t and
	doc string revised.

2004-03-12  Richard M. Stallman  <rms@gnu.org>

	* pcvs.el (cvs-mode-add-change-log-entry-other-window):
	Fix minor bug.

	* replace.el (occur-engine): Change message for count of matches.

	* emacs-lisp/bytecomp.el (byte-compile-get-constant):
	For strings, do compare text properties.

2004-03-11  Daniel Pfeiffer  <occitan@esperanto.org>

	* progmodes/compile.el (compile-auto-highlight)
	(compilation-error-list, compilation-old-error-list)
	(compilation-parse-errors-function, compilation-parsing-end)
	(compilation-error-message, compilation-directory-stack)
	(compilation-enter-directory-regexp-alist)
	(compilation-leave-directory-regexp-alist)
	(compilation-file-regexp-alist, compilation-nomessage-regexp-alist)
	(compilation-current-file, compilation-regexps): Remove vars.

	(compile-error-at-point, compilation-error-filedata)
	(compilation-error-filedata-file-name, compile-reinitialize-errors)
	(compilation-next-error-locus, compilation-forget-errors)
	(count-regexp-groupings, compilation-parse-errors)
	(compile-collect-regexps, compile-buffer-substring): Remove funs.

	(compile-internal): Make obsolete.

	(compilation-first-column, compilation-error)
	(compilation-directory-matcher, compilation-page-delimiter)
	(compilation-mode-font-lock-keywords, compilation-debug)
	(compilation-error-face, compilation-warning-face)
	(compilation-info-face, compilation-line-face)
	(compilation-column-face, compilation-enter-directory-face)
	(compilation-leave-directory-face, compilation-skip-threshold)
	(compilation-skip-visited, compilation-context-lines): New vars.

	(compilation-warning-face, compilation-info-face)
	(compilation-message-face): New faces.

	(compilation-error-regexp-alist-alist): New constant.

	(compilation-face, compilation-directory-properties)
	(compilation-assq, compilation-error-properties, compilation-start)
	(define-compilation-mode, compilation-loop)
	(compilation-set-window): New functions.

	(compile): Additional argument for interactive compiles like TeX.

	* progmodes/grep.el (kill-grep): Move here from compile.el
	(grep-error, grep-hit-face, grep-error-face)
	(grep-mode-font-lock-keywords): New variables.
	(grep-regexp-alist): Simplify regexp and add `binary' case.
	(grep-mode): New mode.
	(grep-process-setup): Simplify.

2004-03-11  Jason Rumney  <jasonr@gnu.org>

	* net/ldap.el (ldap-search-internal): Handle file URLs with drive
	letters on DOS/Windows.

2004-03-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* server.el (server-name): New var.
	(server-socket-dir): New var to replace server-socket-name.
	(server-start): Use them.

2004-03-11  Simon Josefsson  <jas@extundo.com>

	* mail/smtpmail.el (smtpmail-read-response): Abort if process has
	died to avoid infloop.  Reported by Jonathan Glauner
	<jglauner@sbum.org>.

2004-03-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* smerge-mode.el (smerge-check-cache, smerge-check): New var and fun.
	(smerge-mode-menu): Use it to deactivate menu entries.
	(smerge-keep-current): New fun.
	(smerge-keep-current): Use it.

2004-03-10  John Paul Wallington  <jpw@gnu.org>

	* foldout.el (foldout-fold-list, foldout-modeline-string):
	Declare them as variables, not constants.

2004-03-10  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-print.el: Modification to print *Messages* buffer.
	(ps-print-version): New version 6.6.4.
	(ps-message-log-max): New fun.
	(ps-spool-without-faces, ps-spool-with-faces)
	(ps-count-lines-preprint): Code fix.

	* printing.el: New tips in Tips section.

2004-03-09  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* delim-col.el: Doc fix.

	* printing.el: Doc fix.  New doc section (Tips).

2004-03-09  Stefan Monnier  <monnier@iro.umontreal.ca>

	* type-break.el (type-break-emacs-variant): Remove.
	(type-break-run-at-time, type-break-cancel-function-timers):
	Use fboundp rather than version name and number.

2004-03-09  Masatake YAMATO  <jet@gyve.org>

	* hexl.el (hexl-mode): Use `make-local-variable' instead of
	`make-variable-buffer-local'.

2004-03-08  Michael Albinus  <Michael.Albinus@alcatel.de>

	* find-dired.el (find-dired): Call `shell-command' instead of
	`start-process-shell-command'.  By this, Tramp takes over
	handling of remote directories.

2004-03-07  Stefan Monnier  <monnier@iro.umontreal.ca>

	* newcomment.el (comment-use-global-state): New var.
	(comment-search-forward): Use it.

	* emacs-lisp/lisp-mode.el (lisp-mode-variables): Set it.

	* cus-edit.el (fill) <defgroup>: Move to fill.el.

	* textmodes/fill.el (fill) <defgroup>: Move from cus-edit.el.
	(enable-kinsoku): Make it a defcustom.
	(fill-comment-paragraph): Don't rely on fill-prefix to bound the
	paragraph to same-comment-start-marker.

2004-03-07  Dave Love  <fx@gnu.org>

	* net/browse-url.el (rfc2368-parse-mailto-url): Autoload.
	(browse-url-mail): Use it.

	* mail/rfc2368.el (rfc2368-unhexify-char): Delete.
	(rfc2368-unhexify-string): Use replace-regexp-in-string.

2004-03-07  Francis J. Wright  <F.J.Wright@qmul.ac.uk>

	* woman.el (woman-man.conf-path): Doc fix.
	(woman-parse-man.conf): Also parse OPTIONAL_MANPATH.

2004-03-07  Eli Zaretskii  <eliz@gnu.org>

	* sort.el (sort-columns): Remove ms-dos from the list of systems
	where the external `sort' command is not used.

2004-03-07  Kim F. Storm  <storm@cua.dk>

	* gdb-ui.el (gdb-overlay-arrow-position): Add defvar.
	(gdb-reset): Reset gdb-overlay-arrow-position marker and remove it
	from overlay-arrow-variable-list.
	(gdb-assembler-mode): Use add-to-list for gdb-overlay-arrow-position.

2004-03-06  Nick Roberts  <nick@nick.uklinux.net>

	* gdb-ui.el (gdb-assembler-mode, gdb-assembler-custom): Set up
	overlay arrow string properly for the assembler buffer.

2004-03-05  Stefan Monnier  <monnier@iro.umontreal.ca>

	* mail/sendmail.el (mail-mode): Fix last change.

2004-03-05  Nick Roberts  <nick@nick.uklinux.net>

	* gdb-ui.el (gdb-assembler-mode): Create a second overlay arrow
	for the assembler buffer.
	(gdb-assembler-custom): Position the overlay arrow.
	(gdb-put-arrow, gdb-remove-arrow): Delete functions.

2004-03-04  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/sh-script.el (sh-font-lock-paren): Add @ in case patterns.

	* pcvs-info.el (cvs-fileinfo->backup-file): Use a more constraining
	regexp to distinguish .#ChangeLog.9.1.400 and .#ChangeLog.1.400.

	* mail/sendmail.el (mail-mode): Set comment-start-skip.

	* newcomment.el (uncomment-region): Allow non-terminated comment.
	(comment-normalize-vars): Check the user-specified comstart marker.

2004-03-04  Jesper Harder  <harder@ifa.au.dk>

	* sort.el (sort-columns): Don't use external 'sort' on ms-windows.
	Otherwise, do use it if the region only contains font-lock text
	properties.

2004-03-04  Masatake YAMATO  <jet@gyve.org>

	* hexl.el (hexl-mode): Set `hexl-print-current-point-info'
	as the callback function for eldoc.
	(hexl-print-current-point-info): New function.
	(hexl-current-address): Print the address in both decimal
	and hexadecimal format.

2004-03-04  Richard M. Stallman  <rms@gnu.org>

	* mail/rmail.el (rmail-convert-to-babyl-format):
	Specify t for UNIBYTE when calling mail-unquote-printable-region.

	* mail/mail-utils.el (mail-unquote-printable-region):
	New arg UNIBYTE.

	* startup.el (command-switch-alist): Doc fix.

	* simple.el (undo): Temporarily set this-command to `undo-start',
	then set it to `undo' once undo-start returns without error.

	* simple.el (minibuffer-history-sexp-flag): Doc fix.

	* simple.el (kill-line): Don't disregard trailing whitespace
	in eol condition, if show-trailing-whitespace is set.

	* mouse-sel.el (mouse-sel-has-been-enabled): New var.
	(mouse-sel-mode): When enabling, set mouse-sel-has-been-enabled.
	When disabling, restore old values only if mouse-sel-has-been-enabled.

	* isearch.el (isearch-*-char): New arg WANT-BACKSLASH.
	(isearch-{-char): New function.
	(isearch-mode-map): Bind { to isearch-{-char.

	* font-lock.el (lisp-font-lock-keywords-2):
	Turn off the CL with-... and do-... general patterns.
	Instead, recognize several specific with... and do... constructs.

	* files.el (switch-to-buffer-other-window):
	Bind same-window-buffer-names and same-window-regexps to nil.
	(switch-to-buffer-other-frame): Likewise.

2004-03-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/fill.el (fill-comment-paragraph): Be more careful when
	recognizing leading comment on code line.

2004-03-02  Stefan Monnier  <monnier@iro.umontreal.ca>

	* Makefile.in (setwins, setwins_almost): Skip .arch-ids and other
	hidden files/directories.

2004-03-02  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/fill.el (fill-paragraph): Don't check comment-start-skip,
	only comment-start (in case the mode hasn't set it).

	* Makefile.in (AUTOGENEL): New var.
	(bootstrap-prepare): Rename from bootstrap-clean.
	Don't remove elc files.
	(maintainer-clean): New target.

	* xml.el (xml-get-attribute-or-nil): Simplify.

2004-03-02  Juri Linkov  <juri@jurta.org>

	* net/browse-url.el (browse-url-netscape, browse-url-mozilla)
	(browse-url-galeon, browse-url-epiphany): Encode dollar signs in
	URL to prevent their substitution with the environment variable
	values by browsers.

2004-03-03  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-print.el: Doc fix.
	(ps-print-version): New version number (6.6.3).
	(ps-right-header, ps-right-footer, ps-left-header, ps-left-footer):
	Docstring fix.
	(ps-kill-emacs-check): Check if ps-print temporary buffer is killed
	before printing.
	(ps-time-stamp-yyyy-mm-dd): New fun.
	(ps-time-stamp-iso8601): Alias for ps-time-stamp-yyyy-mm-dd.

2004-03-02  Kim F. Storm  <storm@cua.dk>

	* gdb-ui.el (gdb-mouse-toggle-breakpoint): Remove debug message.

2004-03-01  Juanma Barranquero  <lektu@terra.es>

	* allout.el (allout-rebullet-heading): Fix typo in docstring.

	* desktop.el (desktop-file-version)
	(desktop-after-read-hook): Fix typos.
	(desktop-clear-preserve-buffers): Remove redundant info in
	docstring already shown by the obsolescence message.
	(desktop-truncate, desktop-internal-v2s)
	(desktop-value-to-string): Change argument name to match docstring.

	* emulation/tpu-edt.el (tpu-set-mark): Fix typo in docstring.

	* eshell/em-smart.el (eshell-smart-maybe-jump-to-end): Fix typo in
	docstring.

2004-02-29  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* printing.el: Replace "As Is..." in PostScript file print/preview by
	"No Preprocessing...".  Suggested by Colin Marquardt
	<_marquardt_@zmd.de>.
	(pr-insert-section-4): Adjust buffer interface.

2004-02-29  Kai Grossjohann  <kai.grossjohann@gmx.net>

	Version 2.0.39 of Tramp released.

	* net/tramp.el (tramp-handle-file-local-copy)
	(tramp-handle-write-region, tramp-open-connection-rsh):
	Variable name typo.  Small change.  From Patrick Tullmann
	<tullmann@flux.utah.edu>.
	(tramp-process-connection-type): New variable.
	(tramp-maybe-open-connection): Use it.
	(tramp-do-copy-or-rename-via-buffer): Handle KEEP-DATE arg if possible.
	(tramp-touch): Set last-modified time of a remote file.
	(tramp-handle-write-region): Say which function is used when encoding.

2004-02-29  Michael Albinus  <Michael.Albinus@alcatel.de>

	* net/tramp-smb.el (tramp-smb-handle-file-writable-p): Handle the
	case of non-existing filename, too.  Reported by Christoph Bauer
	<c_bauer@informatik.uni-kl.de>.
	(tramp-smb-get-file-entries): The directory in question should
	have permissions "drwxrwxrwx".  Just virtual, because we don't
	know the real permissions.  Don't we know?
	(tramp-smb-prompt): Add virtual prompt from listing shares, too.
	(tramp-smb-errors): Add "NT_STATUS_ACCOUNT_LOCKED_OUT".
	(tramp-smb-wait-for-output): Optimize algorithm getting pending
	output.  If it was received chunkwise, there have been problems.
	Remove the "prompt not found" error message; it is obvious.
	Simplify algorithm.
	(tramp-smb-process-running): Remove.  Since we acknowledge the
	virtual prompt for shares, there's no need for distinction of
	reading shares (process ends afterwards) and interactive mode of
	smblient.
	(tramp-smb-open-connection): Setting process sentinel removed.
	(tramp-smb-errors): Add "NT_STATUS_WRONG_PASSWORD" and
	"NT_STATUS_NETWORK_ACCESS_DENIED".
	(tramp-smb-maybe-open-connection): Set `process-connection-type'
	to 'pty.  Suggested by Piet van Oostrum <piet@cs.uu.nl>.
	(top-level): Setting default value in `tramp-default-method-alist'
	corrected.  Order of USER and HOST have been wrong.
	Nobody complained for months ...
	(tramp-smb-maybe-open-connection): Use `tramp-process-connection-type'.
	(tramp-smb-open-connection): Clear password cache if login has failed.

	* net/tramp.el (tramp-completion-mode) Don't check for 'xemacs' but
	`tramp-unified-filenames'.
	(tramp-completion-mode): Make test for XEmacs explicitly.
	`event-to-character' can exists in Emacs packages too.
	Reported by Matt Swift <swift@alum.mit.edu>.
	(tramp-buffer-name): Buffer name must contain the user if exists.
	Reported by Adrian Phillips <a.phillips@met.no>.
	(tramp-do-copy-or-rename-file): Handle out-of-band methods.
	Call `tramp-do-copy-or-rename-file-out-of-band' this case.
	(tramp-do-copy-or-rename-file-out-of-band): Rename from
	`tramp-do-copy-or-rename-file-one-local', because it handles also
	the case both files use the same out-of-band method.
	Implementation added.
	(tramp-handle-file-local-copy, tramp-handle-write-region):
	Out-of-band handling removed.  `copy-file' called instead, which
	calls `tramp-do-copy-or-rename-file-out-of-band'.
	(tramp-action-password): Check for out-of-band method removed.
	This function is used for 'login-program.
	(tramp-post-connection): Use `tramp-method-out-of-band-p' when
	appropriate.
	(tramp-completion-function-alist-ssh): Add `tramp-parse-shostkeys'
	and `tramp-parse-sknownhosts'.
	(tramp-completion-function-alist): It's a defvar now, because we
	want to apply the optimized `tramp-set-completion-function'
	instead of a static list.
	(tramp-set-completion-function): Implementation tuned.
	Avoid double entries, and entries where the function or the
	file/directory doesn't exist.
	(tramp-parse-shostkeys, tramp-parse-sknownhosts): New functions
	for SSH2.
	(tramp-file-name-handler-alist): Add `dired-compress-file' entry.
	(tramp-handle-dired-compress-file): New function.
	(tramp-async-proc): New variable.
	(tramp-handle-shell-command): Adding asynchronous processes.
	They are far from being perfect, but it works at least for
	`find-grep-dired' and `find-name-dired' in Emacs 22.1.
	(top-level): Require password.el if visible.  Should be mandatory
	once No Gnus has found its way into (X)Emacs.
	(tramp-read-passwd): Invoke `password-read' if available,
	`read-passwd' otherwise.  `ange-ftp-read-passwd' isn't used as
	fallback any longer.
	(tramp-clear-passwd): New function.
	(tramp-process-actions, tramp-process-multi-actions):
	Clear password cache if login has failed.

	* net/tramp-ftp.el (Commentary): Remove pointer to EFS.  It has
	its own module.
	(tramp-ftp-file-name-handler): Unset `ange-ftp-ftp-name-arg' and
	`ange-ftp-ftp-name-res'.  There could be incorrect values from
	previous calls in case the "ftp" method is used in the Tramp file
	name.  Reported by Katsumi Yamaoka <yamaoka@jpl.org>.

2004-02-28  Richard M. Stallman  <rms@gnu.org>

	* term.el (term-mouse-paste): Call mouse-set-point.

	* thumbs.el: New file.

2004-02-28  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* progmodes/ebnf-abn.el: Doc fix.

	* progmodes/ebnf-bnf.el: Doc fix.
	(ebnf-repeat): Code fix.

	* progmodes/ebnf2ps.el: Doc fix.
	(ebnf-syntax-directory, ebnf-syntax-file): New funs.

2004-02-28  Juri Linkov  <juri@jurta.org>

	* ffap.el (dired-at-point): Additional writability test for
	relative directory names.
	(dired-at-point-prompter): Treat directories as a directory, get
	the directory component from files.
	(ffap-string-at-point): Return string from region if region is active.
	(ffap-file-at-point): Remove redundant code.

2004-02-28  Kim F. Storm  <storm@cua.dk>

	* gdb-ui.el (breakpoint-enabled-icon, breakpoint-disabled-icon):
	Initialize margin area images to nil.
	(breakpoint-bitmap): New defvar for breakpoint fringe bitmaps.
	(breakpoint-enabled-bitmap-face)
	(breakpoint-disabled-bitmap-face): New faces for bpt in fringe.
	(gdb-info-breakpoints-custom): Use gdb-remove-breakpoint-icons.
	(gdb-info-breakpoints-custom): Use gdb-put-breakpoint-icon.
	(gdb-mouse-toggle-breakpoint): Handle bpt in fringe.
	(gdb-reset): Use gdb-remove-breakpoint-icons.
	(gdb-put-string): Add dprop arg to specify alternative display
	property (for setting fringe bitmap).
	(gdb-remove-strings): Doc fix.
	(gdb-put-breakpoint-icon): New defun which displays a breakpoint
	icon in fringe (if available), or else as icon or text in display
	margin.  Creates necessary icons in breakpoint-bitmap,
	breakpoint-enabled-icon, and/or breakpoint-disabled-icon.
	Also make left window margin if required.
	(gdb-remove-breakpoint-icons): New defun to remove breakpoint
	icons inserted by gdb-put-breakpoint-icon.  Remove left margin if
	no longer needed.
	(gdb-assembler-custom): Use gdb-remove-breakpoint-icons and
	gdb-put-breakpoint-icon.
	(gdb-assembler-mode): Don't set left-margin-width here.

2004-02-27  Kevin Ryde  <user42@zip.com.au>

	* info-look.el: In scheme-mode symbol regexp, disallow backquote and
	comma, so that it DTRT in macros.

2004-02-27  Markus Rost  <rost@mathematik.uni-bielefeld.de>

	* progmodes/sh-script.el (sh-shell-arg)
	(sh-require-final-newline, sh-assignment-regexp, sh-builtins)
	(sh-leading-keywords, sh-other-keywords): Fix custom type.

2004-02-27  Dan Nicolaescu  <dann@ics.uci.edu>

	* faces.el (face-spec-set-match-display): Add a new attribute,
	`min-colors'.
	(region, highlight, secondary-selection): Use `min-colors'.

	* custom.el (defface): Add documentation for `min-colors'.

	* font-lock.el (font-lock-comment-face, font-lock-string-face)
	(font-lock-keyword-face, font-lock-function-name-face)
	(font-lock-variable-name-face, font-lock-constant-face):
	Use `min-colors'.

	* isearch.el (isearch, isearch-lazy-highlight-face): Use `min-colors'.

2004-02-25  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* progmodes/ebnf2ps.el: Doc fix.  For compatibility with Emacs 20,
	define assq-delete-all if it's not defined.
	(ebnf-generate-region): Code fix.

	* printing.el: Doc fix.
	(pr-version): New version number (6.7.2).
	(pr-command): Return empty string if command is an empty string.

2004-02-24  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* progmodes/ebnf-abn.el: New file, implements an ABNF parser.

	* progmodes/ebnf2ps.el: Doc fix.  Accept ABNF (Augmented BNF).  New
	arrow shapes: semi-up-hollow, semi-up-full, semi-down-hollow and
	semi-down-full.  Fix a bug on productions like test = {"test"}* | (
	"tt" ["test"] ).  Reported by Markus Dreyer
	<mdreyer@ix.urz.uni-heidelberg.de>.
	(ebnf-version): New version number (4.0).
	(ebnf-print-directory, ebnf-print-file, ebnf-spool-directory)
	(ebnf-spool-file, ebnf-eps-directory, ebnf-eps-file)
	(ebnf-delete-style): New commands.
	(ebnf-directory, ebnf-file): New funs.
	(ebnf-special-show-delimiter, ebnf-file-suffix-regexp)
	(ebnf-production-name-p, ebnf-stop-on-error): New options.
	(ebnf-syntax-alist): New var.
	(ebnf-element-width): New fun replacing ebnf-list-width.
	(ebnf-arrow-shape, ebnf-syntax): Custom fix.
	(ebnf-style-custom-list, ebnf-style-database, ebnf-arrow-shape-alist)
	(ebnf-prologue): Adjust vars.
	(ebnf-setup, ebnf-insert-style, ebnf-merge-style, ebnf-apply-style)
	(ebnf-reset-style, ebnf-push-style, ebnf-pop-style)
	(ebnf-check-style-values, ebnf-generate-production)
	(ebnf-generate-region, ebnf-production-dimension, ebnf-justify-list)
	(ebnf-make-terminal1, ebnf-make-or-more1, ebnf-make-repeat)
	(ebnf-token-repeat): Code fix.

	* progmodes/ebnf-yac.el: Doc fix.  Handle Bison pragmas %nonassoc,
	%right, %left and %prec.  Suggested by Matthew K. Junker
	<junker@alum.mit.edu>.
	(ebnf-yac-definitions, ebnf-yac-lex): Code fix.

	* progmodes/ebnf-iso.el: Doc fix.
	(ebnf-iso-token-table, ebnf-iso-non-terminal-chars): Adjust vars.
	(ebnf-iso-lex): Code fix.

	* progmodes/ebnf-bnf.el: Doc fix.
	(ebnf-bnf-lex): Code fix.

	* progmodes/ebnf-otz.el: Doc fix.

2004-02-23  Luc Teirlinck  <teirllm@auburn.edu>

	* abbrev.el (write-abbrev-file): Make argument optional.  Doc fix.
	(abbrev-prefix-mark): Doc fix.

2004-02-23  Nick Roberts  <nick@nick.uklinux.net>

	* gdb-ui.el (gud-watch): Load tooltip, if necessary.
	(gdb-var-create-handler): Force speedbar-update-flag to be non-nil.
	(gdb-var-delete): Make interactive (really).
	(gdb-edit-value): Make non-interactive.

	* progmodes/gud.el (gud-speedbar-menu-items):
	Add gdb-var-delete and, indirectly, gdb-edit-value.
	(gud-install-speedbar-variables): Bind gdb-var-delete to "D".
	(gud-speedbar-buttons): Remove gdb-var-delete from tag-line.
	(gud-gdb-marker-filter): Add comment for annotations.

2004-02-23  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* calendar/calendar.el (generate-calendar)
	(calendar-read-date): Prevent display of BC calendars once more -
	reverts 2003-10-01 change.
	(generate-calendar-month): Doc fix.

2004-02-03  Matthew Mundell  <matt@mundell.ukfsn.org>  (tiny change)

	* calendar/diary-lib.el (fancy-diary-display): Don't rely on
	return value of increment-calendar-month.

2004-02-21  Stephen Compall  <s11@member.fsf.org>

	* saveplace.el (save-place-forget-unreadable-files)
	(save-place-save-skipped, save-place-skip-check-regexp): New vars.
	(save-place-forget-unreadable-files): New function.
	(save-place-alist-to-file): Use it to filter out files that are
	no longer readable.

	* textmodes/texinfo.el (texinfo-insert-@item): Look for the
	current Texinfo environment, using the same method as in
	`texinfo-insert-@end', and insert a space rather than a newline if
	point in a @table environment.

2004-02-21  Juri Linkov  <juri@jurta.org>

	* ffap.el (ffap-file-at-point): Try parent directories.

2004-02-21  Klaus Zeitler  <kzeitler@lucent.com>

	* vcursor.el (vcursor-modifiers): New defcustom.
	(vcursor-cs-binding): Use vcursor-modifiers instead of a
	hard-coded list.

2004-02-21  Masatake YAMATO  <jet@gyve.org>

	* play/animate.el (animate-birthday-present): Accept names other
	than `Sarah', too.

2004-02-21  Juri Linkov  <juri@jurta.org>

	* startup.el: Remove table of command line arguments from the
	Commentary section.

2004-02-20  John Wiegley  <johnw@newartisans.com>

	* eshell/em-pred.el (eshell-modifier-alist): Change the "eval
	again" modifier from 'e' to 'E', since 'e' is also used by the
	"file extension" modifier.

2004-02-19  Luc Teirlinck  <teirllm@auburn.edu>

	* help-fns.el (describe-categories): Doc fix.

2003-02-19  Michael Kifer  <kifer@cs.stonybrook.edu>

	* ediff-util.el (ediff-compute-custom-diffs-maybe): Avoid creating
	temporary file for buffer already visiting one.  This change makes
	output likely to be directly usable by patch program.
	Suggested by Adrian Aichner  <adrian@xemacs.org>

2004-02-20  Nick Roberts  <nick@nick.uklinux.net>

	* gdb-ui.el (gdb-use-colon-colon-notation): Set default to nil for
	case of variables defined in compound statements.
	(gdb-setup-windows, gdb-source-info, gdb-source-info):
	Simplify constructions using switch-to-buffer.

2004-02-19  Simon Josefsson  <jas@extundo.com>

	* play/morse.el: Fix typo.
	(morse-code): Add @.

2004-02-19  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* calendar/appt.el (appt-display-format): Change default to
	'ignore, for backwards compatibility.
	(appt-display-message): If appt-display-format is 'ignore,
	respect old vars appt-msg-window and appt-visible.
	(appt-activate): Don't depend on return value of cancel-timer.

	* calendar/calendar.el (calendar-holidays): Doc fix.

	* calendar/cal-coptic.el (coptic-prompt-for-date):
	Use assoc-string instead of assoc-ignore-case.
	* calendar/cal-french.el (calendar-goto-french-date): Ditto.
	* calendar/cal-hebrew.el (calendar-goto-hebrew-date)
	(mark-hebrew-diary-entries, list-yahrzeit-dates): Ditto.
	* calendar/cal-islam.el (calendar-goto-islamic-date)
	(mark-islamic-diary-entries): Ditto.
	* calendar/cal-julian.el (calendar-goto-julian-date): Ditto.
	* calendar/cal-mayan.el (calendar-read-mayan-haab-date)
	(calendar-read-mayan-tzolkin-date): Ditto.
	* calendar/calendar.el (calendar-read-date): Ditto.
	* calendar/diary-lib.el (mark-diary-entries): Ditto.

2004-02-18  Markus Rost  <rost@mathematik.uni-bielefeld.de>

	* progmodes/executable.el (executable-command-find-posix-p):
	Fix choice of the directory.

2004-02-17  Luc Teirlinck  <teirllm@auburn.edu>

	* simple.el (interprogram-cut-function)
	(interprogram-paste-function, kill-new, kill-append):
	Doc fixes.
	(kill-region): Make it return nil.  Doc fix.
	(yank-pop): Make its argument optional.
	(yank): Make ARG `-' equivalent to `-1'.

2004-02-17  Eli Zaretskii  <eliz@gnu.org>

	* mail/rmail.el (rmail-get-new-mail): Don't reference
	rmail-use-spam-filter if rmail-spam-filter is not loaded.

2004-02-16  Luc Teirlinck  <teirllm@auburn.edu>

	* autorevert.el (auto-revert-buffer-p): Only revert dired buffers
	if one of global-auto-revert-non-file-buffers or autorevert-mode
	is non-nil.

2004-02-16  Eli Zaretskii  <eliz@gnu.org>

	* subr.el (delete-dups): A better implementation from Karl Heuer
	<kwzh@gnu.org>.

2004-02-16  Matt Hodges  <matt@stchem.bham.ac.uk>  (tiny change)

	* net/telnet.el (telnet-interrupt-subjob): Move doc string to the
	correct place.
	* progmodes/icon.el (icon-indent-command): Ditto.
	* textmodes/paragraphs.el (repunctuate-sentences): Ditto.

2004-02-16  Eli Zaretskii  <eliz@gnu.org>

	* progmodes/grep.el (grep-compute-defaults): Undo change from
	2004-01-29: don't use executable-command-find-posix-p.

2004-02-16  Richard Sharman  <rsharman@pobox.com>

	* hilit-chg.el: Use require instead of eval-and-compile.
	(highlight-compare-buffers): New function.

2004-02-16  John Basrai  <jbasrai@comcast.net>  (tiny change)

	* man.el (Man-fontify-manpage): Render section headings in
	`Man-overstrike-face' even when overstrike was not used by man
	formatter for section headings.

2004-02-16  Eli Tziperman  <eli@deas.harvard.edu>

	* rmail-spam-filter.el (vm-use-spam-filter)
	(rsf-min-region-length-added-to-spam-list): New	variables.
	(rsf-bbdb-auto-delete-spam-bbdb-entries): Rename from
	rmail-bbdb-auto-delete-spam-entries.  Add cc: to recipients for
	spam testing.  Don't delete spam message if automatic deletion
	after output via variable rmail-delete-after-output is turned on.
	(rsf-bbdb-dont-create-entries-for-deleted-messages): Rename from
	rsf-bbdb-dont-create-entries-for-spam.
	(check-field): New function, extracted from code in
	rmail-spam-filter to ease addition of header fields like content-type.
	(message-content-type): New variable to check the content-type:
	field added, also in defcustom of rsf-definitions-alist.
	(rmail-spam-filter): Replace repeated test code for header fields
	by calls to check-field; change the call to
	rmail-output-to-rmail-file such that rmail-current-message stays
	the same to avoid wrong deletion of unseen flags.
	(rsf-add-contents-type): New function to convert old format
	of rmail-spam-definitions-alist into new one.
	Change prefixes of all variables and functions from
	rmail-spam-filter- or spam-filter- or rmail-spam- to rsf-.

2004-02-16  Eli Zaretskii  <eliz@gnu.org>

	* loadhist.el (unload-hook-features-list): New defvar.

2004-02-16  Dave Love  <fx@gnu.org>

	* loadhist.el (unload-feature): Doc fix.  Rename flist to
	unload-hook-features-list.

2004-02-16  Jay Belanger  <belanger@truman.edu>  (tiny change)

	* calc/calc-embed.el (calc-do-embedded-activate): Add autoload
	cookie.  Don't check if we are looking-at open-formula.

2004-02-16  Jesper Harder  <harder@ifa.au.dk>  (tiny change)

	* subr.el (match-string-no-properties): Use substring-no-properties.

2004-02-16  Eli Zaretskii  <eliz@gnu.org>

	* emacs-lisp/rx.el (rx-check, rx-check-any, rx-check-not)
	(rx-repeat, rx-check-backref, rx-syntax, rx-to-string):
	Use lower-case "rx" in all error message.

2004-02-16  Dave Love  <fx@gnu.org>

	* emacs-lisp/rx.el (rx-or): Put group around result.
	(rx-constituents): Add backref.
	(rx-syntax): Add string-delimiter, comment-delimiter.
	(rx-categories): Add combining-diacritic.
	(rx-check-not, rx-greedy, rx): Doc fix.
	(rx-backref, rx-check-backref): New.

2004-02-16  Jesper Harder  <harder@ifa.au.dk>

	* newcomment.el (uncomment-region): Allow eob as comment end.

2004-02-16  Jari Aalto  <jari.aalto@poboxes.com>

	* filecache.el: All message and error commands now use prefix
	"Filecache:" to make it easy to read *Messages* buffer.

2004-02-16  Jari Aalto  <jari.aalto@poboxes.com>

	* autorevert.el: Add support to detect changed dired and VC buffers.
	(auto-revert-active-p, auto-revert-list-diff)
	(auto-revert-dired-file-list, auto-revert-dired-changed-p)
	(auto-revert-handler, auto-revert-active-p): New functions.
	(auto-revert-buffers): Move revert logic to `auto-revert-handler'
	and `auto-revert-active-p'.
	(eval-when-compile): Defvar dired-directory and vc-mode.
	(auto-revert-vc-cvs-file-version, auto-revert-vc-buffer-p)
	(auto-revert-handler-vc): New functions.

2004-02-16  Alfred M. Szmidt  <ams@kemisten.nu>  (tiny change)

	* progmodes/compile.el (compilation-directory): New defvar.
	(compile): Save current directory in compilation-directory.
	(recompile): Bind default-directory to compilation-directory if
	that is non-nil.

2004-02-16  Dave Love  <fx@gnu.org>

	* newcomment.el (comment-insert-comment-function)
	(comment-region-function, uncomment-region-function): New.
	(comment-indent): Use comment-insert-comment-function.
	(uncomment-region): Use uncomment-region-function.
	(comment-region): Use comment-region-function.

	* emacs-lisp/rx.el (rx-not): Bind case-fold-search to nil.

2004-02-16  Richard Stallman  <rms@gnu.org>

	* Makefile.in (TAGS, TAGS-LISP): Filter out of `els' only
	loaddefs* and ldefs-boot*.

2004-02-16  Eli Zaretskii  <eliz@gnu.org>

	* mail/mail-utils.el (rmail-dont-reply-to): Anchor user login name
	and email address at the beginning and end of the address.

	* mail/rmail.el (rmail-default-dont-reply-to-names): Make "info-"
	anchored at the beginning of the email address.

2004-02-16  TAKAI Kousuke  <tak@kmc.gr.jp>  (tiny change)

	* international/ccl.el (ccl-compile-write): Pass `left' to
	ccl-embed-code to generate correct code of write-expr-register.

2004-02-15  Dan Nicolaescu  <dann@ics.uci.edu>  (tiny change)

	* progmodes/grep.el (grep-compute-defaults): Fix typos.

2004-02-15  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* x-dnd.el: Mention support for Motif in commentary.
	(x-dnd-handle-drag-n-drop-event): Ditto.

2004-02-14  Jonathan Yavner  <jyavner@member.fsf.org>

	* ses.el: Use "ses--" prefixes for buffer-local variables.
	Use (point-min) instead of 1, even when we know the buffer
	is unnarrowed.
	(ses-build-load-map): Delete.  Distribute its content to defconsts for
	the three maps.
	(ses-menu, ses-header-line-menu): New menus.
	(ses-mode-map): Use them.
	(ses-read-number) New fun.  Duplicates code from interactive "N" spec.

2004-02-14  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* Makefile.in: Fix the CC Mode recompile kludge so it works
	when building in a different directory.

2004-02-13  Luc Teirlinck  <teirllm@auburn.edu>

	* simple.el (kill-new): Put yank-handler property on the entire string.

2004-02-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* diff.el: Don't use compile any more, use diff-mode instead.
	(diff-regexp-alist, diff-old-file, diff-new-file)
	(diff-parse-differences, diff-process-setup): Remove.
	(diff-sentinel): New fun.
	(diff): Use it.  Run the process ourselves.
	Use diff-mode for the rest of the processing.

	* diff.el (diff): Simplify code handling `switch'.

2004-02-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* pcvs-defs.el (cvs-menu): Add `tag'.

2004-02-11  Luc Teirlinck  <teirllm@auburn.edu>

	* simple.el (kill-append): Doc fix.

	* emacs-lisp/lisp-mode.el (lisp-mode-variables):
	Adapt outline-regexp to the new conventions for commenting out code.

2004-02-11  John Paul Wallington  <jpw@gnu.org>

	* mail/smtpmail.el (smtpmail-try-auth-methods): Fix typo.

2004-02-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* diff.el (diff-switches): New fun.
	(diff, diff-backup): Use it.
	(diff): Clean up the args construction.  Use backquote.
	Use listp instead of consp to avoid putting a nil arg.
	(diff): Add a revert-buffer function.

2004-02-10  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* x-dnd.el (x-dnd-types-alist): Add COMPOUND_TEXT, FILE_NAME
	handled by x-dnd-handle-file-name.
	(x-dnd-known-types): Add COMPOUND_TEXT.
	(x-dnd-init-frame): Call x-dnd-init-motif-for-frame.
	(x-dnd-get-state-cons-for-frame): Must do copy-sequence on
	x-dnd-empty-state.
	(x-dnd-forget-drop): Ditto.
	(x-dnd-save-state): Add optional parameter extra-data (for Motif).
	(x-dnd-handle-one-url): Return private when inserting text.
	(x-dnd-insert-ctext): New function.
	(x-dnd-handle-file-name): New function for FILE_NAME.
	(x-dnd-handle-drag-n-drop-event): Add Motif, remove call to error.
	(x-dnd-init-motif-for-frame, x-dnd-get-motif-value)
	(x-dnd-motif-value-to-list, x-dnd-handle-motif): New functions.

2004-02-10  Kenichi Handa  <handa@m17n.org>

	* term/x-win.el (x-select-utf8-or-ctext): Use compare-strings
	instead of while loop.

2004-02-10  Miles Bader  <miles@gnu.org>

	* emacs-lisp/macroexp.el: New file, implements `macroexpand-all'.

2004-02-09  Kenichi Handa  <handa@m17n.org>

	* tar-mode.el (tar-extract): Fix for the case that a file doesn't
	have end-of-line.

2004-02-09  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* Makefile.in: Added extra dependencies in the recompile target
	needed to cope with the compile time macro expansions in CC Mode.

2004-02-09  Kim F. Storm  <storm@cua.dk>

	* fringe.el (no-fringe-bitmap, undef-fringe-bitmap)
	(left-truncation-fringe-bitmap, right-truncation-fringe-bitmap)
	(up-arrow-fringe-bitmap, down-arrow-fringe-bitmap)
	(continued-line-fringe-bitmap, continuation-line-fringe-bitmap)
	(overlay-arrow-fringe-bitmap, top-left-angle-fringe-bitmap)
	(top-right-angle-fringe-bitmap, bottom-left-angle-fringe-bitmap)
	(bottom-right-angle-fringe-bitmap, left-bracket-fringe-bitmap)
	(right-bracket-fringe-bitmap, filled-box-cursor-fringe-bitmap)
	(hollow-box-cursor-fringe-bitmap, hollow-square-fringe-bitmap)
	(bar-cursor-fringe-bitmap, hbar-cursor-fringe-bitmap)
	(empty-line-fringe-bitmap): Define standard fringe bitmaps id's.

2004-02-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* window.el (window-safely-shrinkable-p): Don't change the buffer-list.
	Don't allow shrink if there's a window on our right.

	* progmodes/prolog.el (prolog-program-name): Use gprolog if available.
	(prolog-mode-syntax-table, prolog-mode-abbrev-table, prolog-mode-map):
	Bring together declaration and initialization.
	(prolog-mode-variables): Don't set the syntax table.
	Don't set paragraph-start and comment-indent-function.
	Add /*..*/ to the comment regexps.
	(prolog-mode-commands): Remove.  Do it during init of prolog-mode-map.
	(prolog-mode-map): Don't bind TAB.
	(prolog-mode): Set the syntax table.
	(prolog-comment-indent): Remove.
	(inferior-prolog-mode-map): Initialize in the declaration.
	(inferior-prolog-mode-syntax-table)
	(inferior-prolog-mode-abbrev-table): New vars.
	(inferior-prolog-mode): Derive from comint-mode.
	(run-prolog): Avoid switch-to-buffer which can fail in dedicated and
	minibuffer windows.

	* progmodes/grep.el (grep-regexp-alist): Allow :, \t and (
	in file names, as long as it is unambiguous.

2004-02-08  Andreas Schwab  <schwab@suse.de>

	* textmodes/reftex-toc.el
	(reftex-toc-load-all-files-for-promotion): Remove useless use of
	format.  Doc fix.

	* textmodes/refer.el (refer-find-entry-internal): Remove extra
	format string arguments.

	* tar-mode.el (tar-parse-octal-integer-safe): Add missing format
	string argument.

	* progmodes/xscheme.el (verify-xscheme-buffer): Fix format strings.

	* play/zone.el (zone-call): Fix format string.

	* net/webjump.el (webjump-builtin): Add missing format string argument.

	* midnight.el (midnight-delay-set): Remove extra format string argument.

	* mail/rmail.el (rmail-get-new-mail): Remove useless use of format.

	* hexl.el (hexl-insert-char): Add missing format string argument.

	* format.el (format-decode): Fix format string.

	* emulation/vi.el (vi-mode): Remove extra format string argument.
	(vi-repeat-last-search): Likewise.
	(vi-reverse-last-search): Likewise.
	(vi-goto-mark): Likewise.
	(vi-reverse-last-find-char): Likewise.
	(vi-repeat-last-find-char): Likewise.
	(vi-locate-def): Likewise.

	* emacs-lisp/lisp-mnt.el (lm-verify): Remove useless use of format.

	* ediff-util.el (ediff-toggle-read-only): Remove extra format
	string argument.
	(ediff-toggle-regexp-match): Likewise.

	* dired-aux.el (dired-do-query-replace-regexp): Add missing
	format string argument.

	* calc/calc-map.el (calc-get-operator): Remove extra format
	string argument.

	* calc/calc-forms.el (calc-convert-time-zones): Fix format string.

	* calc/calc-ext.el (calc-do-prefix-help): Remove extra format
	string argument.

	* eshell/esh-mode.el (eshell-send-invisible): Fix format string.

	* eshell/em-hist.el (eshell-hist-word-reference): Fix format string.

	* emulation/viper-ex.el (ex-mark): Remove extra format string argument.

	* emacs-lisp/cl-macs.el (defstruct): Remove extra format string arg.
	(cl-struct-setf-expander): Likewise.

	* vc.el (with-vc-file): Fix unsafe uses of error.
	(vc-cancel-version): Likewise.

2004-02-08  Jan Nieuwenhuizen  <jan.nieuwenhuizen@aspiratie.nl>  (tiny change)

	* progmodes/gud.el (gud-jdb-marker-filter): Add period as optional
	thousands separator; fixes <class>:<line-number> regexp for
	non-english locales.

2004-02-08  Andreas Schwab  <schwab@suse.de>

	* view.el (view-mode-enable): Revert previous change.

2004-02-07  Kim F. Storm  <storm@cua.dk>

	* simple.el (line-number-at-pos): Rename from line-at-pos.
	Uses changed (what-line and vc-annotate-warp-version).

2004-02-06  Stefan Monnier  <monnier@iro.umontreal.ca>

	* diff-mode.el (diff-file-regexp-alist, diff-error-regexp-alist)
	(diff-mode): Remove aborted attempt at support for compile.el.
	(diff-mode, diff-minor-mode): Avoid obsolete write-contents-hooks.

2004-02-06  Andreas Schwab  <schwab@suse.de>

	* view.el (view-mode-enable): Add view-mode-map to
	minor-mode-overriding-map-alist.

2004-02-05  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* x-dnd.el (x-dnd-get-local-file-name): Fix byte compiler warning

2004-02-04  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/cperl-mode.el (cperl-fill-paragraph): Call fill-paragraph
	with point inside rather than after the paragraph.

2004-02-04  Sam Steingold  <sds@gnu.org>

	* mail/smtpmail.el (smtpmail-try-auth-methods):
	Do not try authentication when no mechanism is available.
	Pass port-name as defaultport to `netrc-machine'.

2004-02-04  Stephen Eglen  <stephen@gnu.org>

	* iswitchb.el (iswitchb-minibuffer-setup-hook): Update doc string
	to show how minibuffer height can be constrained.

2004-02-04  John Paul Wallington  <jpw@gnu.org>

	* files.el (auto-mode-alist): Fix .scm, .stk, .ss, .sch entry.

2004-02-03  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* x-dnd.el: New file for drag and drop.

	* term/x-win.el: require x-dnd, set after-make-frame-functions
	to x-dnd-init-frame, let x-dnd-handle-drag-n-drop-event handle
	drag-n-drop event.

	* dired.el (dired-dnd-test-function, dired-dnd-popup-notice)
	(dired-dnd-do-ask-action, dired-dnd-handle-local-file)
	(dired-dnd-handle-file): New functions for drag and drop support.
	(dired-mode): Initialize drag and drop if x-dnd present.

2004-02-02  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/cperl-mode.el (cperl-mode-map, cperl-do-auto-fill)
	(cperl-menu): Use fill-paragraph, not cperl-fill-paragraph.
	(cperl-mode): Set fill-paragraph-function.
	(cperl-fill-paragraph): Make it non-interactive.

2004-02-02  Benjamin Rutt  <brutt@bloomington.in.us>

	* diff-mode.el (diff-mode-shared-map): Bind q to `quit-window'.

2004-02-02  David Kastrup  <dak@gnu.org>

	* replace.el (perform-replace): Allow 'literal argument in
	regexp-flag to indicate literal replacement.
	(query-replace-regexp-eval): Use it.

2004-02-01  Andreas Schwab  <schwab@suse.de>

	* progmodes/executable.el (executable-command-find-posix-p): Doc fix.

2004-02-01  Stephen Eglen  <stephen@gnu.org>

	* info-look.el: Add support for maxima-mode.  Update commentary
	because info-lookup-symbol is now bound to C-h S.

2004-01-31  Luc Teirlinck  <teirllm@auburn.edu>

	* simple.el (edit-and-eval-command): Bind print-level and
	minibuffer-history-sexp-flag around call to read-from-minibuffer.
	Correct initial position in command-history.

2004-01-30  Luc Teirlinck  <teirllm@auburn.edu>

	* files.el (read-directory-name): Adapt the docstring to recent
	change in Fread_file_name.

2004-01-30  Jonathan Yavner  <jyavner@member.fsf.org>

	* ses.el (ses-print-cell): If print format too wide for column
	width, truncate decimal places if that helps to avoid "#####" fill.
	* ses.el (ses-initial-column-width): Revert previous change.

2004-01-29  Stefan Monnier  <monnier@iro.umontreal.ca>

	* jit-lock.el (jit-lock-context-time, jit-lock-context-timer): New var.
	(with-buffer-unmodified, with-buffer-prepared-for-jit-lock):
	Add edebug info.
	(jit-lock-mode): Setup/cancel the new timer.
	(jit-lock-context-fontify): New fun.  Extracted from
	context fontification code of jit-lock-stealth-fontify.
	(jit-lock-stealth-fontify): Don't do context fontification any more.

	* jit-lock.el (jit-lock-stealth-fontify): Allow quit.
	(jit-lock-fontify-now): Handle the `quit' case.
	(jit-lock-contextually): Rename from jit-lock-defer-contextually.

2004-01-29  Jari Aalto  <jari.aalto@poboxes.com>

	* progmodes/executable.el (executable-command-find-posix-p):
	New.  Check if find handles arguments Posix-style.

	* progmodes/grep.el (grep-compute-defaults):
	Use executable-command-find-posix-p.
	(grep-find): Check `grep-find-command'.

	* filecache.el (file-cache-find-posix-p): Delete.
	(file-cache-add-directory-using-find):
	Use `executable-command-find-posix-p'.

2004-01-29  Dave Love  <fx@gnu.org>

	* emacs-lisp/lisp.el (beginning-of-defun-raw, end-of-defun):
	Iterate the hook function if arg is given.
	(mark-defun, narrow-to-defun): Change order of finding the limits.

	* emacs-lisp/bytecomp.el (byte-compile-compatibility): Doc fix.
	(byte-compile-format-warn): New.
	(byte-compile-callargs-warn): Use it.
	(Format, message, error): Add byte-compile-format-like property.
	(byte-compile-maybe-guarded): New.
	(byte-compile-if, byte-compile-cond): Use it.
	(byte-compile-lambda): Compile interactive forms,
	just to make warnings about them.

2004-01-29  Jonathan Yavner  <jyavner@member.fsf.org>

	* ses.el (ses-initial-column-width): Increase to 14, so it will
	work well with the default printer of "%.7g" for extreme values
	like "-1.234567e+07".

2004-01-29  Kenichi Handa  <handa@m17n.org>

	* term/x-win.el (x-selection-value): Optimize for ASCII only case.

2004-01-28  Peter 'Luna' Runestig  <peter@runestig.com>

	* dos-w32.el: Added support for the `default-printer-name' function.

2004-01-27  Stefan Monnier  <monnier@iro.umontreal.ca>

	* server.el (server-socket-name): Don't use the hostname in the
	socket name since /tmp is local to the host anyway.

	* emacs-lisp/easy-mmode.el (easy-mmode-define-navigation): Use a more
	robust check of widening and fix var-naming.

2004-01-27  Eli Tziperman  <eli@deas.harvard.edu>

	* rmail-spam-filter.el: Change rmail-spam-filter- or spam-filter-
	or rmail-spam- to rsf- in all function and variable names.
	(rsf-min-region-to-spam-list): New variable.
	(rsf-bbdb-auto-delete-spam-entries): Rename from
	rmail-bbdb-auto-delete-spam-bbdb-entries.  The cc: field is
	scanned together with the recipients field for spam testing; Don't
	delete spam message if rmail-delete-after-output is non-nil;
	(rsf-check-field): New function, extracted from code in
	rmail-spam-filter to ease addition of header fields like
	content-type:;
	(message-content-type): New variable.  The content-type: field was
	added also in defcustom of rsf-definitions-alist;
	(rmail-spam-filter): Replace repeated test code for header fields
	by calls to check-field; change the call to
	rmail-output-to-rmail-file such that rmail-current-message stays
	the same to avoid wrong deletion of unseen flags.
	(rmail-use-spam-filter): Add autoload cookie.

2004-01-27  Jari Aalto  <jari.aalto@poboxes.com>

	* filecache.el (file-cache-find-posix-p): New function.  Detect Cygwin.
	(file-cache-add-directory-using-find): Add Cygwin support.
	(file-cache-find-command-posix-flag): New user variable.

	* filecache.el (file-cache-add-directory): Check for
	directories an remove them from dir-files.

2004-01-27  Richard M. Stallman  <rms@gnu.org>

	* man.el (Man-fontify-manpage): Clean up message.

2004-01-27  Kenichi Handa  <handa@m17n.org>

	* textmodes/paragraphs.el (sentence-end-without-space): New variable.
	(sentence-end): Define using sentence-end-without-space.

	* textmodes/fill.el (fill-delete-newlines): Don't add a space if
	a sentence ends with one of a character in sentence-end-without-space.

2004-01-26  Stefan Monnier  <monnier@iro.umontreal.ca>

	* font-lock.el (font-lock): Add jit-lock as explicit group member.
	(jit-lock): Group declaration moved to jit-lock.el.
	(toplevel): Don't explicitly require jit-lock, since it's autoloaded
	when necessary.

	* jit-lock.el (jit-lock): Move group declaration from font-lock.el.
	(jit-lock-context-unfontify-pos): Rename from
	jit-lock-first-unfontify-pos.
	(jit-lock-defer-buffers): Rename from jit-lock-buffers.

2004-01-25  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* progmodes/fortran.el (fortran-break-before-delimiters): Doc fix.
	(fortran-break-delimiters-re, fortran-no-break-re): New consts.
	(fortran-fill): When filling a string, adjust re-search-backward
	argument for special case of string just on fill-column.
	When filling non-string, allow one extra char if
	fortran-break-before-delimiters is non-nil.
	Suggested by Michael Hagemann <michael.hagemann@unibas.ch>.
	Use fortran-break-delimiters-re and fortran-no-break-re to
	correctly handle cases such as "**".

	* progmodes/f90.el (f90-break-delimiters): Doc fix.
	(f90-no-break-re): Add some extra tokens.  Doc fix.

2004-01-24  Thien-Thi Nguyen  <ttn@gnu.org>

	* mail/rmail-spam-filter.el:
	Use two semicolons as Commentary line prefix.
	Add ";;; Code:" stylized comment.
	Delete end-of-line whitespace.
	Wrap (require 'cl) with `eval-when-compile'.

2004-01-23  Benjamin Rutt  <brutt@bloomington.in.us>

	* vc.el (vc-annotate): Fix improper use of `make-local-variable'
	at the top level of vc.el.

2004-01-23  Andre Spiegel  <spiegel@gnu.org>

	* vc.el (vc-current-line): Function removed.  This is now done by
	the new function line-at-pos in simple.el.
	(vc-annotate-warp-version): Use line-at-pos instead of
	vc-current-line.

2004-01-22  Kim F. Storm  <storm@cua.dk>

	* simple.el (line-at-pos): New defun.
	(what-line): Use it.  Optimize by only counting lines in narrowed
	region once.

2004-01-22  Kenichi Handa  <handa@m17n.org>

	* language/cyrillic.el (ccl-encode-windows-1251-font): Rearrange code
	point (register r1) only for charset mule-unicode-0100-24ff.

2004-01-21  Markus Rost  <rost@mathematik.uni-bielefeld.de>

	* mail/rmail.el (rmail-convert-to-babyl-format): Avoid deleting
	trailing white space and ensure a final newline.

	* mail/rmail-spam-filter.el (rmail-use-spam-filter):
	Add autoload cookie.

2004-01-21  Benjamin Rutt  <brutt@bloomington.in.us>

	* vc.el (vc-annotate-mode): Inherit from fundamental-mode and
	activate view-mode explicitly.

2004-01-21  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* term/x-win.el (x-clipboard-yank, menu-bar-edit-menu): Call
	menu-bar-enable-clipboard and make Paste use clipboard first.

2004-01-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-mcvs.el (vc-mcvs-mode-line-string): Remove.  Does not work.
	(vc-mcvs-workfile-version): Manually macro expand vc-mcvs-cvs.
	(vc-mcvs-cvs): Remove.
	(vc-mcvs-command): Remove use of assert.

	* outline.el (outline-insert-heading): Tighten up match.
	(outline-demote, outline-move-subtree-down): Don't assume anything
	about outline-regexp.

	* textmodes/texinfo.el (texinfo-mode): Remove ^ from outline-regexp.
	(texinfo-show-structure): Explicitly add ^, and simplify.

2004-01-20  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* calendar/appt.el (appt-check): Restore usage of
	appt-issue-message deleted in previous change.
	(top-level): Activate package when loaded (needed for backwards
	compatibility).

2004-01-20  Jesper Harder  <harder@ifa.au.dk>

	* mail/smtpmail.el (smtpmail-via-smtp): No need to add two bytes
	following previous change to smtpmail-send-data.

2004-01-20  Benjamin Rutt  <brutt@bloomington.in.us>

	* vc.el (vc-default-previous-version): Doc enhancement.
	(vc-default-next-version): New function.
	(vc-print-log): New arg FOCUS-REV.
	(vc-annotate-mode): Derive from view-mode.
	(vc-annotate): New args REVISION, DISPLAY-MODE.
	(vc-annotate-workfile-version, vc-annotate-extract-revision-at-line)
	(vc-annotate-revision-at-line, vc-annotate-revision-previous-to-line)
	(vc-annotate-show-log-revision-at-line, vc-annotate-warp-version)
	(vc-annotate-show-diff-revision-at-line, vc-current-line)
	(vc-annotate-prev-version, vc-annotate-next-version): New functions.

	* vc-cvs.el (vc-cvs-annotate-extract-revision-at-line): New function.

2004-01-19  Karl Berry  <karl@gnu.org>

	* textmodes/texinfo.el: Use "Texinfo" consistently, no "TeXinfo"
	or "TexInfo".

2004-01-19  Luc Teirlinck  <teirllm@auburn.edu>

	* subr.el (delete-dups): New function.

2004-01-19  Karl Berry  <karl@gnu.org>

	* textmodes/texinfo.el (texinfo-mode): Define outline-regexp to start
	with ^, since that's what texinfo-show-structure
	documentation says (plus it works much better in texinfo.txi).

2004-01-18  Jesper Harder  <harder@ifa.au.dk>

	* mail/smtpmail.el (smtpmail-send-data): Don't append spurious newline.

2004-01-18  David Ponce  <david@dponce.com>  (tiny change)

	* progmodes/which-func.el (which-function-mode): Don't cancel
	which-func-update-timer if not set.

2004-01-17  Thien-Thi Nguyen  <ttn@gnu.org>

	* calendar/diary-lib.el (diary-entry-time): Fix typo/bug:
	Remove spurious left square bracket in XX:XXam regexp.

2004-01-16  Luc Teirlinck  <teirllm@auburn.edu>

	* progmodes/cc-defs.el: Do not require cl at run time.

2004-01-16  Richard M. Stallman  <rms@gnu.org>

	* emacs-lisp/cl.el (cl-cannot-unload): New function.
	(cl-unload-hook): Defvar this to run cl-cannot-unload.

	* mail/rmail.el (rmail-get-new-mail): New local rsf-number-of-spam.
	Call rmail-spam-filter.  Delete and expunge spam.
	Print number of spam messages deleted.
	Save and restore the deletion status of old messages when reading
	new mail with spam filter, so that expunging spam does not expunge
	msgs deleted by the user.
	(rmail-only-expunge): Add an optional argument dont-show to
	prevent showing message after expunge.

2004-01-15  Luc Teirlinck  <teirllm@auburn.edu>

	* emacs-lisp/cl.el (declare): Add `fmakunbound' for `declare'.
	* subr.el (declare): New macro.

2004-01-15  Thien-Thi Nguyen  <ttn@gnu.org>

	* progmodes/scheme.el (scheme-font-lock-keywords-2): Add "force".

2004-01-14  Stefan Monnier  <monnier@iro.umontreal.ca>

	* mwheel.el (mouse-wheel-down-event, mouse-wheel-up-event):
	Test window-system rather than system-type (for X11/Mac).

2004-01-12  Luc Teirlinck  <teirllm@auburn.edu>

	* emacs-lisp/bytecomp.el (compile-defun): Doc fix.

2004-01-12  Richard M. Stallman  <rms@gnu.org>

	* mail/rmail.el (rmail-convert-to-babyl-format):
	Use mail-unquote-printable-region.
	(rmail-hex-string-to-integer, rmail-decode-quoted-printable):
	(rmail-hex-char-to-integer): Functions deleted.

	* mail/mail-utils.el (mail-unquote-printable-hexdigit): Upcase CHAR.
	(mail-unquote-printable-region): New arg NOERROR.
	For invalid encoding, either signal an error to just return nil.

2004-01-11  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* calendar/appt.el: Update copyright and commentary.
	(appt-issue-message): Make obsolete.
	(appt-visible, appt-msg-window): Make obsolete, in favor of
	appt-display-format.
	(appt-display-mode-line, appt-display-duration)
	(appt-display-diary, appt-time-msg-list, appt-mode-string)
	(appt-prev-comp-time, appt-display-count, appt-timer)
	(appt-convert-time): Doc change.
	(appt-disp-window-function, appt-delete-window-function):
	Use defcustom rather than defvar.
	(appt-display-format): New variable.
	(appt-display-message): New function with display code from appt-check.
	(appt-check): Add optional FORCE argument.  Doc change.
	Add appt-make-list to diary-hook if displaying diary.
	Remove checking of view-diary-entries-initially.
	Message display section removed to new function appt-display-message.
	(appt-display-window): Doc change.  Remove unused internal var
	this-buffer.  Do not beep, since appt-display-message does that.
	(appt-make-list): Doc change.  Use caar.
	(appt-sort-list): Simplify by using builtin sort function.
	(appt-update-list): New function for updating appts when diary is
	saved.
	(appt-activate): New autoloaded function to toggle package
	functionality.

	* calendar/cal-x.el: (calendar-one-frame-setup)
	(calendar-only-one-frame-setup, calendar-two-frame-setup): Doc change.

	* calendar/calendar.el: Update copyright.
	(view-diary-entries-initially, european-calendar-style): Doc change.
	(calendar-setup): Make defcustom rather than defvar.
	(mark-visible-calendar-date): Initialize temp-face and faceinfo
	in let binding so local to function.

	* calendar/diary-lib.el: Update copyright.
	(diary, diary-entry-time): Doc change.
	(list-diary-entries): Doc change.  Trivial logic change.
	(fancy-diary-display): Restore make-face command mistakenly
	deleted 2003-05-08.
	(show-all-diary-entries): Allow to pop-up frame if needed.

2004-01-09  John Paul Wallington  <jpw@gnu.org>

	* bindings.el (mode-line-change-eol): Add EVENT parameter.
	Temporarily select EVENT's window for changing eol type.

2004-01-09  Deepak Goel  <deego@gnufans.org>

	* calendar/diary-lib.el (diary-entry-time):
	Also accept time in the form XX[.XX][am/pm/AM/PM].
	(fancy-diary-font-lock-keywords): Likewise.
	(diary-font-lock-keywords): Likewise.
	* calendar/appt.el (appt-add): Likewise.
	(appt-make-list): Likewise.
	(appt-convert-time): Likewise.

2004-01-08  Nick Roberts  <nick@nick.uklinux.net>

	* gdb-ui.el (gdb-ann3): Revert previous change.
	(gdb-source-info): Allow for case of where compilation directory
	is not recorded.

2004-01-08  John Paul Wallington  <jpw@gnu.org>

	* emerge.el (emerge-restore-buffer-characteristics): Doc fix.

2004-01-07  Nick Roberts  <nick@nick.uklinux.net>

	* progmodes/gud.el (gdb-first-prompt): Rename from gdb-first-pre-prompt

	* gdb-ui.el (gdba): Avoid duplication, use gdb-ann3.
	(gdb-ann3): Use GDB command "set width 0" to prevent word wrapping
	problems.
	(gdb-prompt): Set (renamed) gdb-first-prompt to nil in gdb-ann3.

2004-01-07  Luc Teirlinck  <teirllm@auburn.edu>

	* files.el (write-file-functions, write-contents-functions):
	Clarify docstrings.

2004-01-07  Kenichi Handa  <handa@m17n.org>

	* international/mule.el (set-auto-coding): Fix for the case that
	end-of-line is only CR.

2004-01-07  Kim F. Storm  <storm@cua.dk>

	* subr.el (event-start, event-end): Doc fix.
	(posn-string, posn-image): New defuns.
	(posn-object): Return either image or string object.
	(posn-object-x-y): Return 8th element of position.
	(posn-object-width-height): New defun.

2004-01-06  Andreas Schwab  <schwab@suse.de>

	* gdb-ui.el (gdb-frame-handler): Handle word wrapping anywhere in
	output.

2004-01-05  Karl Berry  <karl@gnu.org>

	* emacs-lisp/copyright.el (copyright-regexp): Might as well allow
	/ and *, too.

2003-12-31  Simon Josefsson  <jas@extundo.com>

	* files.el (before-save-hook): Add.
	(basic-save-buffer): Use before-save-hook.

	* emacs-lisp/copyright.el: Fix comment to recommend
	before-save-hook instead of write-file-functions.

2004-01-05  Richard M. Stallman  <rms@gnu.org>

	* finder.el (finder-commentary): Call delete-other-windows.

	* net/ange-ftp.el (ange-ftp-file-attributes):
	Pass 2 args to ange-ftp-real-file-attributes only if ID-FORMAT non-nil.

2004-01-04  Karl Berry  <karl@gnu.org>

	* emacs-lisp/copyright.el (copyright-regexp): Allow the common
	comment characters % and # in the copyright year notice,
	as well as ;.

2004-01-04  Per Abrahamsen  <abraham@dina.kvl.dk>

	* wid-edit.el (default): Define dummy :value-delete.
	Reported by Jesper Harder <harder@ifa.au.dk>.

2004-01-03  Richard M. Stallman  <rms@gnu.org>

	* progmodes/compile.el (compile-internal): Use point, not point-min,
	for set-window-point.

	* textmodes/tex-mode.el (latex-find-indent): Avoid error at end of buf.

	* emacs-lisp/lisp-mnt.el (lm-section-end): Require outline.

	* progmodes/grep.el (grep-mode-map):
	Don't remap next-line, previous-line.

2004-01-03  Eric M. Ludlam  <eric@siege-engine.com>

	* speedbar.el (speedbar-edit-line): Change regexp to position
	the cursor on the first character of this line's button.

2004-01-03  Luc Teirlinck  <teirllm@auburn.edu>

	* subr.el (functionp): Doc fix.

2004-01-03  Jesper Harder  <harder@ifa.au.dk>  (tiny change)

	* progmodes/idlwave.el (idlwave-make-tags):
	* textmodes/flyspell.el (flyspell-large-region):.
	* progmodes/make-mode.el (makefile-query-by-make-minus-q):
	* emulation/viper-util.el (viper-glob-unix-files):
	* emacs-lisp/shadow.el (shadow-same-file-or-nonexistent):
	* man.el (Man-init-defvars):
	* jka-compr.el (jka-compr-call-process):
	* files.el (get-free-disk-space,insert-directory):
	* ediff-ptch.el (ediff-test-patch-utility):
	* ediff-diff.el (ediff-test-utility):
	* dired-aux.el (dired-check-process):
	* mail/sendmail.el (sendmail-send-it): Don't use = or zerop to
	test the return value of call-process, because it can be a string.

2003-12-31  John Paul Wallington  <jpw@gnu.org>

	* bindings.el (completion-ignored-extensions): Add .pfsl.

2003-12-31  Kim F. Storm  <storm@cua.dk>

	* ido.el (ido-nonreadable-directory-p): New defun to check for
	nonreadable directory without activating tramp (to avoid problems
	with checking incomplete tramp paths).
	(ido-set-current-directory, ido-file-internal)
	(ido-file-name-all-completions1): Use it.

2003-12-30  Luc Teirlinck  <teirllm@auburn.edu>

	* help-mode.el (help-xref-info-regexp): Make hyperlinks to Info
	documentation if the anchor (or node) name is preceded by `info
	anchor' or `Info anchor' in addition to earlier `info node' and
	`Info node'.
	(help-make-xrefs): Adapt to new value of `help-xref-info-regexp'.

2003-12-30  Eli Zaretskii  <eliz@gnu.org>

	* mail/rmail.el (rmail-convert-to-babyl-format): Fix off-by-one
	error in arguments to base64-decode-region.  Remove ^M characters
	after decoding base64.

2003-12-30  Simon Josefsson  <jas@extundo.com>

	* textmodes/texinfo.el: Change maintainer to FSF.  Suggested by
	karl@freefriends.org (Karl Berry), since the Texinfo Elisp files
	have only been distributed with Emacs for some years.
	(texinfo-mode-hook): Customize.

2003-12-30  Eli Zaretskii  <eliz@gnu.org>

	* mail/rmail.el (rmail-convert-to-babyl-format): Make the code
	cleaner (suggested by Richard Stallman).

	* progmodes/gud.el (gud-tool-bar-map): Modify names of icon files
	for gud-next, gud-nexti, gud-step and gud-stepi to prevent
	file-name clashes on 8+3 DOS filesystems.

	* toolbar/gud-next.pbm, toolbar/gud-next.xpm
	* toolbar/gud-nexti.pbm, toolbar/gud-nexti.xpm
	* toolbar/gud-step.pbm, toolbar/gud-step.xpm
	* toolbar/gud-stepi.pbm, toolbar/gud-stepi.xpm: Renamed to
	gud-n.*, gud-ni.*, gud-s.*, and gud-si.*, respectively, to avoid
	file-name clashes on 8+3 filesystems.

	* emacs-lisp/tcover-unsafep.el, emacs-lisp/tcover-ses.el:
	Renamed from testcover-unsafep.el and testcover-ses.el to avoid
	file-name clashes on 8+3 DOS filesystems.

2003-12-29  Richard M. Stallman  <rms@gnu.org>

	* mail/mail-utils.el (mail-unquote-printable-hexdigit):
	Upcase the character.

	* textmodes/flyspell.el (mail-mode-flyspell-verify):
	Search for header separator alone on a line, literally,
	and search for it backward, not forward.
	(flyspell-abbrev-table): Always use global-abbrev-table
	if there is no local one.

	* progmodes/sh-script.el (sh-get-indent-info):
	Don't move point back if at bob.

	* progmodes/antlr-mode.el (save-buffer-state-x): Use with-no-warnings.

	* play/handwrite.el (handwrite): Make the handwrite credit message
	a comment rather than an output command.

	* obsolete/sc.el: Display message that this file is obsolete.

	* net/ange-ftp.el (ange-ftp-start-process): Copy the environment.

	* mail/rfc822.el (rfc822-address-start): Declare variable.
	Renamed from address-start.  All uses changed.

	* term.el (term-exec): Set up sentinel.
	(term-sentinel): New function.
	(term-handle-exit): New function.

	* subr.el (assoc-ignore-case, assoc-ignore-representation):
	Use assoc-string, and mark them obsolete.
	(delay-mode-hooks): Mark as permanent local.

	* simple.el (sendmail-user-agent-compose): Use assoc-string.

	* register.el (copy-rectangle-to-register): Doc fix.

	* info.el (Info-insert-dir): Use assoc-string.

	* info-look.el (info-lookup): Use assoc-string.

	* frame.el (pop-up-frame-function): Use quote, not `function'.
	(frame-notice-user-settings): Calculate ADJUSTED-TOP
	copying with lists as coordinate values.

	* font-lock.el (font-lock-after-change-function): Bind inhibit-quit.

	* find-dired.el (kill-find): New command.
	(find-dired): Make buffer read-only.
	Set up a keymap with C-c C-k running kill-find.
	(find-dired-filter, find-dired-sentinel): Bind inhibit-read-only.

	* files.el (backup-buffer-copy): If MODES is nil, don't set modes.

	* filecache.el (file-cache-ignore-case): New variable.
	(file-cache-assoc-function): Var deleted.  Use assoc-string instead.

	* comint.el (comint-arguments): Set COUNT after ARGS is complete.
	(comint-dynamic-complete-as-filename): Rename local vars.
	(comint-dynamic-list-filename-completions): Likewise.

	* comint.el (comint-dynamic-list-completions-config): New var.
	(comint-dynamic-list-completions): Handle both SPC and TAB right.

	* comint.el (comint-file-name-chars): Add [].
	(comint-word): Use skip-chars-backward, not search.

	* shell.el (shell-file-name-chars): Add [].

	* shell.el (shell-dynamic-complete-as-command): Rename local vars.

	* bookmark.el (bookmark-get-bookmark): Use assoc-string.

	* generic.el (define-generic-mode): Doc fix.

2003-12-29  Eli Zaretskii  <eliz@gnu.org>

	* files.el (kill-some-buffers): Doc fix.

2003-12-29  David Herring  <sdh6@ra.msstate.edu>  (tiny change)

	* comint.el (comint-watch-for-password-prompt): Pass `string' as
	arg to send-invisible
	(send-invisible): Doc fix.  The argument is now a prompt, not the
	string to send.
	(comint-read-noecho): Doc fix.

2003-12-29  Michael R. Wolf  <MichaelRWolf@att.net>  (tiny change)

	* net/ange-ftp.el (ange-ftp-name-format): Allow USER to contain
	"@", as required by some ISP hosting service.  Fix defcustom
	argument syntax errors that prevented use of customization.

2003-12-29  Eli Zaretskii  <eliz@gnu.org>

	* xml.el (xml-get-attribute-or-nil): Doc fix.

2003-12-29  Peter 'Luna' Runestig  <peter@runestig.com>

	* net/zone-mode.el (zone-mode): Use write-file-functions, not
	write-file-hooks.

2003-12-29  Eric Hanchrow  <offby1@blarg.net>  (tiny change)

	* autorevert.el (auto-revert-interval): Doc fix.

2003-12-29  Mark A. Hershberger  <mah@everybody.org>

	* xml.el (xml-get-attribute-or-nil): New function, like
	xml-get-attribute, but returns nil if the attribute was not found.
	(xml-get-attribute): Convert to defsubst, uses
	xml-get-attribute-or-nil.

2003-12-29  Eli Zaretskii  <eliz@gnu.org>

	* emacs-lisp/easymenu.el (easy-menu-define): Doc fix.

2003-12-29  Alex Schroeder  <alex@emacswiki.org>  (tiny change)

	* custom.el (custom-declare-theme): Use `value' when putting
	properties on `theme'.

2003-12-29  Takaaki Ota  <Takaaki.Ota@am.sony.com>

	* subr.el (insert-for-yank): Call insert-for-yank-1 repetitively
	for each yank-handler segment.
	(insert-for-yank-1): New function, with the body of the previous
	insert-for-yank.

	* textmodes/table.el (table-yank-handler): New defcustom.
	(table--put-cell-indicator-property): Put yank-handler property
	that indicates the yank handler for the table cell.

2003-12-29  Jesper Harder  <harder@ifa.au.dk>  (tiny change)

	* generic-x.el (etc-modules-conf-generic-mode): A more complete
	set of keywords.

2003-12-29  Eli Zaretskii  <eliz@gnu.org>

	* international/mule-cmds.el (reset-language-environment)
	(set-language-environment): Don't invoke fontset-related functions
	if fontset-list is not fboundp.

2003-12-29  Kenichi Handa  <handa@m17n.org>

	* international/mule-cmds.el (reset-language-environment):
	Call set-overriding-fontspec-internal with nil.
	(set-language-environment): Call set-overriding-fontspec-internal
	if the language environment specify `overriding-fontspec'.
	(language-info-alist): Doc added.

	* language/cyrillic.el (ccl-encode-koi8-font): Make it work for
	characters of mule-unicode-0100-24ff.
	(ccl-encode-windows-1251-font): New CCL program.
	("Bulgarian"): Specify overriding-fontspec.
	("Belarusian"): Likewise.

2003-12-28  Sam Steingold  <sds@gnu.org>

	* net/ange-ftp.el (ange-ftp-file-attributes): Add new optional
	parameter ID-FORMAT to conform with the 2003-11-30 patch.

2003-12-28  Nick Roberts  <nick@nick.uklinux.net>

	* progmodes/gud.el (gud-gdb-command-name): Set default to
	"gdb --annotate=3".
	(gud-gdb-marker-filter): Look out for annotations.
	(gdb-first-pre-prompt): New variable.
	Remove trailing white space.

	* gdb-ui.el (gdb-prompt): Change filter for level 3 annotations,
	if necessary.
	(gdb-ann3): New function.  Initialize M-x gdb as for M-x gdba if
	annotations are detected.
	(gud-gdba-marker-filter): Use global variable gud-marker-acc
	instead of a local one to allow transition from
	gud-gdb-marker-filter.
	Remove trailing white space.

2003-12-27  Kim F. Storm  <storm@cua.dk>

	* ido.el: Handle non-readable directories.
	(ido-decorations): Add 9th element for non-readable directory.
	(ido-directory-nonreadable): New dynamic var.
	(ido-set-current-directory): Set it.
	(ido-read-buffer, ido-file-internal):
	(ido-read-file-name, ido-read-directory-name): Let-bind it.
	(ido-file-name-all-completions1): Return empty list for
	non-readable directory.
	(ido-exhibit): Print [Not readable] if directory is not readable.
	(ido-expand-directory): New defun (based on tiny fix from Karl Chen).
	(ido-read-file-name, ido-file-internal, ido-read-directory-name):
	Use it.

2003-12-27  Lars Hansen  <larsh@math.ku.dk>

	* ls-lisp.el (ls-lisp-insert-directory): Add parameter 'string in
	calls to directory-files-and-attributes and file-attributes.
	(ls-lisp-format): Remove system dependent handling of user and
	group id's.

2003-12-25  Luc Teirlinck  <teirllm@auburn.edu>

	* ffap.el (ffap-read-file-or-url): Revert previous change.

2003-12-25  Robert J. Chassell  <bob@rattlesnake.com>

	* textmodes/texnfo-upd.el (texinfo-multi-file-update): Create a
	new list of included files called `files-with-node-lines', that
	only have node lines.  This way @include commands can include any
	file, such as version and update files without node lines, not
	just files that are chapters.

2003-12-25  Andreas Schwab  <schwab@suse.de>

	* jka-compr.el (jka-compr-insert-file-contents): Avoid error when
	file not found.

2003-12-08  Miles Bader  <miles@gnu.org>

	* dired.el (dired-between-files): Always use dired-move-to-filename,
	which is more robust in non-english locales.

2003-12-25  Markus Rost  <rost@mathematik.uni-bielefeld.de>

	* vc.el (vc-dired-purge): Avoid error from `kill-line'.

2003-12-24  Andreas Schwab  <schwab@suse.de>

	* shell.el (shell-file-name-quote-list): Add backslash.

	* comint.el (comint-quote-filename): Correctly handle backslash
	in comint-file-name-quote-list.

2003-12-24  Kenichi Handa  <handa@m17n.org>

	* international/mule-cmds.el (set-default-coding-systems):
	Call ucs-set-table-for-input for all buffers that don't have local
	value of buffer-file-coding-system.

	* international/ucs-tables.el (ucs-set-table-for-input):
	If translation-table-for-encode is a symbol, get its
	translation-table property.

2003-12-23  Luc Teirlinck  <teirllm@auburn.edu>

	* ffap.el (ffap-read-file-or-url): Eliminate reliance of the call
	to `completing-read' on a recently fixed bug.

	* fringe.el (fringe-query-style): Suggest `?' in minibuffer prompt,
	instead of SPACE, to get the list of possible fringe modes.
	SPACE only works if both `partial-completion-mode' and
	`completion-auto-help' are nil.

	* complete.el (PC-is-complete-p): Delete.
	(PC-do-completion): Replace all calls to `PC-is-complete-p' with
	calls to `test-completion'.

2003-12-23  Nick Roberts  <nick@nick.uklinux.net>

	* progmodes/gud.el (gud-speedbar-buttons): Use speed-bar-edit-line
	to edit values when there are no children.

	* gdb-ui.el (gdba, gdb-assembler-mode): Call the mode "Machine" as
	a mode called "Assembler" already exists.
	(gdb-use-colon-colon-notation, gdb-show-changed-values): New options.
	(gud-watch): Use format option.  Remove font properties from string.
	(gdb-var-create-handler, gdb-var-list-children-handler):
	Don't bother about properties as there are none.
	(gdb-var-create-handler, gdb-var-list-children-handler)
	(gdb-var-update-handler): Call gdb-var-evaluate-expression-handler
	with two arguments.
	(gdb-var-evaluate-expression-handler, gdb-post-prompt):
	Let speedbar show value changes with a different font.
	(gdb-edit-value): New defun.
	(gdb-clear-partial-output, gdb-clear-inferior-io)
	(def-gdb-auto-update-handler): Use erase-buffer.
	(gdb-frame-handler): Display watch expressions in
	FUNCTION::VARIABLE format if required.

2003-12-23  John Paul Wallington  <jpw@gnu.org>

	* info.el (Info-unescape-quotes, Info-split-parameter-string)
	(Info-goto-emacs-command-node): Doc fixes.

2003-12-12  Jesper Harder  <harder@ifa.au.dk>

	* cus-edit.el (custom-add-parent-links): Define "many".

2003-12-08  Per Abrahamsen  <abraham@dina.kvl.dk>

	* wid-edit.el (widget-child-value-get, widget-child-value-inline)
	(widget-child-validate, widget-type-value-create)
	(widget-type-default-get, widget-type-match): New functions.
	(lazy): New widget.
	(menu-choice, checklist, radio-button-choice, editable-list)
	(group, documentation-string): Remove redundant (per 2003-10-25
	change) calls to `widget-children-value-delete'.
	(widget-choice-value-get, widget-choice-value-inline): Remove.
	(menu-choice): Update widget.

2003-12-03  Kenichi Handa  <handa@m17n.org>

	* language/cyrillic.el: Register "microsoft-cp1251" in
	ctext-non-standard-encodings-alist.
	("Bulgarian"): Add ctext-non-standard-encodings.
	("Belarusian"): Likewise.

	* international/mule-conf.el (compound-text-with-extensions):
	Change the type to 2 (iso-2022 base).

	* international/mule.el (ctext-non-standard-encodings-alist):
	Change the format.
	(ctext-non-standard-encodings): New variable.
	(ctext-post-read-conversion): Fully re-written.
	(ctext-non-standard-designations-alist): Delete it.
	(ctext-non-standard-encodings-table): New function.
	(ctext-pre-write-conversion): Fully re-written.

2003-11-30  Per Abrahamsen  <abraham@dina.kvl.dk>

	* cus-edit.el (custom-add-parent-links): Add documentation links
	for parent, if the item has none of its own.

2003-11-30  Richard M. Stallman  <rms@gnu.org>

	* dired-aux.el (dired-do-query-replace-regexp):
	Report files visited read-only.

2003-11-30  Juri Linkov  <juri@jurta.org>

	* dired-aux.el (dired-compare-directories): New command.
	(dired-file-set-difference, dired-files-attributes): New functions.

2003-11-30  Kai Grossjohann  <kai.grossjohann@gmx.net>
	Version 2.0.38 of Tramp released.

	* net/tramp.el (tramp-chunksize): Extend docstring.  Suggested by
	Charles Curley <charlescurley@charlescurley.com>.
	(tramp-multi-connection-function-alist): Add ssht entry which adds
	"-e none -t -t" to the list of ssh args.  Suggested by Adrian
	Aichner.
	(tramp-get-method-parameter): New function to retrieve a method
	parameter.  This allows for omission of method parameters.
	Callers adjusted.

2003-11-30  Michael Albinus  <Michael.Albinus@alcatel.de>

	* net/tramp.el: Add new optional parameter ID-FORMAT to
	`file-attributes'.  Calls of `file-attributes' won't use this
	parameter for backward compatibility reasons.
	(tramp-perl-file-attributes): Add a new parameter to Perl script
	in order to handle uid/gid as strings, if desired.
	(tramp-handle-file-truename, tramp-handle-file-symlink-p):
	Apply `file-attributes' instead of `tramp-handle-file-attributes' in
	order to make the function more general.
	(tramp-handle-file-attributes): Replace proprietary optional
	parameter NONNUMERIC by the recently (Emacs 22.1) introduced ID-FORMAT.
	(tramp-handle-file-attributes-with-perl): Handle parameter
	NONNUMERIC if set.  This wasn't done in the past.
	(tramp-post-connection): Apply second parameter "$2" if
	`tramp-remote-perl' is called.

	* net/tramp-smb.el (tramp-smb-handle-delete-file):
	Correct cut'n'waste error (`filename' instead of `directory').
	(tramp-smb-handle-directory-files-and-attributes)
	(tramp-smb-handle-file-attributes): Add recently (Emacs 22.1)
	introduced parameter ID-FORMAT.
	(tramp-smb-handle-make-directory-internal): Correct cut'n'waste
	error (`directory' instead of `ldir').

	* net/tramp-vc.el (tramp-handle-vc-user-login-name): Check if
	`file-attributes' has a second parameter.  If yes, apply it with
	value "'integer".  Otherwise, don't use that parameter (default is
	integer format).

2003-11-30  Luc Teirlinck  <teirllm@auburn.edu>

	* help.el (help-map): Bind `display-local-help' to `C-h .'.
	(help-for-help): Add `C-h .' to the listed Help options.
	Remove trailing whitespace.

	* help-at-pt.el: New file.

2003-11-30  Jonathan Yavner  <jyavner@member.fsf.org>

	* subr.el (noreturn, 1value): New macros for test coverage.
	See `testcover.el'.

	* emacs-lisp/edebug.el: Add def-edebug-spec for `noreturn' and `1value'.

	* emacs-lisp/testcover.el (testcover-reinstrument): Special case
	for macro `1value'.
	(testcover-1value): New function.  Checks that a 1value form
	actually returns only one value.  Requested by RMS.

2003-11-29  Nick Roberts  <nick@nick.uklinux.net>

	* gdb-ui.el (gud-watch, gdb-var-create-handler)
	(gdb-var-list-children, gdb-var-list-children-handler)
	(gdb-var-update-handler, gdb-var-delete): Add server prefix to the
	gdb commands that use mi to keep them out of the command history.

2003-11-29  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* cus-start.el (all): Add use-file-dialog.

2003-11-27  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/tex-mode.el (latex-mode): `tex-trailer' is not a regexp.

2003-11-27  Kim F. Storm  <storm@cua.dk>

	* subr.el (posn-object-x-y): New defun.

2003-11-26  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/make-mode.el (makefile-font-lock-syntactic-keywords):
	Don't use `space' for \\\n.
	Be more selective as to which # are comment-starters.

2003-11-26  Luc Teirlinck  <teirllm@auburn.edu>

	* subr.el (number-sequence): Improve handling of floating point
	arguments (suggested by Kim Storm).  Allow negative arguments.

2003-11-26  Kenichi Handa  <handa@m17n.org>

	* international/mule-cmds.el (standard-display-european-internal):
	Cancel the standard-display-table setting for ` and '.

2003-11-26  Kim F. Storm  <storm@cua.dk>

	* ido.el (ido-use-filename-at-point, ido-use-url-at-point):
	New defcustoms to add ffap-like functionality to ido.
	(ido-saved-vc-hb): Rename from ido-saved-vc-mt.  Uses changed.
	(ido-no-final-slash): New defun.
	(ido-make-prompt, ido-file-internal, ido-toggle-vc)
	(ido-read-file-name): ): Toggle VC checking via
	vc-handled-backends instead of vc-master-templates.
	(ido-file-internal): Handle ido-use-url-at-point and
	ido-use-filename-at-point via code borrowed from ffap-guesser.
	Handle new ido-exit code ffap.
	(ido-sort-list): Ignore final slash when sorting file names.

2003-11-25  Kim F. Storm  <storm@cua.dk>

	* emulation/cua-base.el (cua--standard-movement-commands):
	Add forward-sentence and backward-sentence.

2003-11-25  Stephen Eglen  <stephen@gnu.org>

	* iswitchb.el (iswitchb-read-buffer,iswitchb-exit-minibuffer):
	iswitchb-exit is set to 'usefirst when user selects buffer at head
	of list using RET.  (Selecting buffers at the head of the list was
	broken if the substring was also a complete buffername.)

2003-11-23  Kim F. Storm  <storm@cua.dk>

	* progmodes/compile.el (grep-command, grep-use-null-device)
	(grep-find-command, grep-tree-command, grep-tree-files-aliases)
	(grep-tree-ignore-case, grep-tree-ignore-CVS-directories)
	(grep-regexp-alist, grep-program, find-program)
	(grep-find-use-xargs, grep-history, grep-find-history)
	(grep-process-setup, grep-compute-defaults)
	(grep-default-command, grep, grep-tag-default, grep-find)
	(grep-expand-command-macros, grep-tree-last-regexp)
	(grep-tree-last-files, grep-tree): Move grep variables, functions
	and commands to new file grep.el.
	(compilation-mode-map): Remove grep commands from Compile sub-menu.
	(compilation-process-setup-function): Doc fix.
	(compilation-highlight-regexp, compilation-highlight-overlay): New
	defvars used for highlighting current compile error in source buffer.
	(compile-internal): New optional args HIGHLIGHT-REGEXP and
	LOCAL-MAP which overrides compilation-highlight-regexp and
	compilation-mode-map for this compilation.
	Delay calling compilation-set-window-height until after running
	compilation-process-setup-function so it can buffer-local override
	compilation-window-height.
	Check buffer-local value of compilation-scroll-output.
	(compilation-set-window-height): Use buffer-local value of
	compilation-window-height.
	(compilation-revert-buffer): Don't pass (undefined)
	preserve-modes arg to revert-buffer.
	(next-error-no-select, previous-error-no-select): New commands.
	(compilation-goto-locus): Temporarily highlight current match in
	source buffer using compilation-highlight-regexp.

	* progmodes/grep.el: New file with grep code from compile.el.
	(grep): New defcustom group.
	(grep-window-height): New defcustom, like compilation-window-height.
	(grep-auto-highlight): New defcustom, like compile-auto-highlight.
	(grep-scroll-output): New defcustom, like compilation-scroll-output.
	(grep-command, grep-use-null-device, grep-find-command)
	(grep-tree-files-aliases, grep-tree-ignore-case)
	(grep-tree-ignore-CVS-directories): Move to grep custom group.
	(grep-setup-hook): New hook variable.
	(grep-mode-map): New keymap for grep commands.  Add Grep menu.
	(grep-last-buffer): New defvar, override compilation-last-buffer.
	(grep): Add optional arg HIGHLIGHT-REGEXP.  Doc fix.
	Call compile-internal with args highlight-regexp and grep-mode-map.

2003-11-23  Kim F. Storm  <storm@cua.dk>

	* subr.el (event-start, event-end): Doc fix.
	(posn-window, posn-x-y, posn-timestamp): Simplify doc.
	(posn-area, posn-actual-col-row, posn-object): New defuns.
	(posn-col-row): Simplify doc.  Rewrite to use cond.
	(posn-point): Also return buffer position for events outside text
	area (that info is now present in the event position).

	* mouse.el: Bind mouse-1 on left-fringe and right-fringe to
	mouse-set-point so that hscroll still works now that clicks on
	fringes generate specific mouse events.
	(mouse-set-point): Note that it now works in fringes and margins
	too due to new semantics of posn-point in fringes and margins.

	* gdb-ui.el (gdb-mouse-toggle-breakpoint): New defun.
	(gdba): Bind it to [left-margin mouse-1] and [left-fringe mouse-1].

2003-11-20  Kim F. Storm  <storm@cua.dk>

	* gdb-ui.el (gud-gdba-command-name): Find gdb command via PATH.
	(breakpoint-xpm-data, breakpoint-enabled-pbm-data): Make smoother.
	(breakpoint-enabled-icon, breakpoint-disabled-icon): Set :ascent
	to 100 for icons to avoid increasing line height when shown.

2003-11-17  Jesper Harder  <harder@ifa.au.dk>  (tiny change)

	* newcomment.el (comment-normalize-vars): Initialize properly if
	comment-start was nil.

2003-11-19  Andreas Schwab  <schwab@suse.de>

	* simple.el (set-variable): Fix indentation.

2003-11-17  Kenichi Handa  <handa@m17n.org>

	* international/latin1-disp.el (latin1-display-ucs-per-lynx):
	Fix docstring.

2003-11-17  Jesper Harder  <harder@ifa.au.dk>  (tiny change)

	* international/latin1-disp.el (latin1-display): Fix docstring.

2003-11-16  John Wiegley  <johnw@newartisans.com>

	* eshell/em-ls.el (eshell-ls-file): There are times with
	size-width is nil and uncomputed (when directories are created in
	dired, for example); in this case, 4 is reasonable default value,
	although it may caused skewed new entries (which could be avoided
	by returning the original value of 8 in all cases, but 99% of the
	time this is a waste of whitespace).

2003-11-16  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* cc-engine.el (c-guess-continued-construct)
	(c-guess-basic-syntax): Check a little more carefully if it's a
	function declaration when an unknown construct followed by a block
	is found inside a statement context.  This avoids macros followed
	by blocks to be taken as function declarations.

	(c-guess-continued-construct): Change the analysis of a statement
	continuation with a brace open to `substatement-block', for
	consistency with recognized statements.

	(c-add-stmt-syntax): Don't continue to the surrounding sexp if the
	start is in a position so that `c-beginning-of-statement-1' jumped
	to the beginning of the same statement.

	* cc-fonts.el, cc-engine.el (c-forward-<>-arglist-recur):
	Don't accept binary operators in the arglist if we're in a function
	call context, i.e. if `c-restricted-<>-arglists' is set.  That avoids
	template recognition in cases like "if (a < b || c > d)".

	(c-restricted-<>-arglists): New more appropriate name for
	`c-disallow-comma-in-<>-arglists'.

	Accessing functions updated for the variable name change.

	* cc-engine.el (c-syntactic-re-search-forward): Fix bug where the
	match data could get clobbered if NOT-INSIDE-TOKEN is used.

	* cc-engine.el (c-beginning-of-statement-1): Don't allow parens in
	labels.

	(c-backward-to-decl-anchor): Use `c-beginning-of-statement-1'
	instead of duplicating parts of it.  This fixes bogus label
	recognition.

	* cc-align.el (c-gnu-impose-minimum): Revert to the old method
	of checking the context in which to apply the minimum indentation,
	so that it isn't enforced in e.g. namespace blocks.

	* cc-vars.el (c-inside-block-syms): New constant used by
	`c-gnu-impose-minimum'.  It's defined close to `c-offsets-alist'
	to somewhat reduce the risk of becoming stale.

	* cc-cmds.el, cc-engine.el (c-shift-line-indentation): Move from
	cc-cmds to cc-engine to allow use from cc-align.

	* cc-engine.el (c-beginning-of-inheritance-list): Cope with fully
	qualified identifiers containing "::".

	* cc-defs.el (c-make-keywords-re): Add kludge for bug in
	`regexp-opt' in Emacs 20 and XEmacs when strings contain newlines.

	* cc-vars.el (c-emacs-features): Use a space in front of the name
	of the temporary buffer.  That also avoids dumping problems in
	XEmacs due to undo info being left around after the buffer is killed.

	* cc-engine.el (c-in-knr-argdecl): Look closer at the function
	arglist to see if it's a K&R style declaration.

	(c-guess-basic-syntax): CASE 5B.2: Check with `c-in-knr-argdecl'
	before returning `knr-argdecl-intro'.

2003-11-16  John Wiegley  <johnw@newartisans.com>

	* eshell/em-ls.el (eshell-ls-file): Instead of making the size
	field in a long-listing always 8 characters, use `size-width',
	which has already been computed.

2003-11-15  Thien-Thi Nguyen  <ttn@gnu.org>

	* subr.el (minor-mode-list): Add `hs-minor-mode'.

2003-11-14  Thien-Thi Nguyen  <ttn@gnu.org>

	* diff-mode.el (diff-hunk-prev, diff-hunk-next):
	Support operation while narrowed, with `diff-restrict-view'.

2003-11-14  Thien-Thi Nguyen  <ttn@gnu.org>

	* emacs-lisp/easy-mmode.el (easy-mmode-define-navigation):
	Take additional optional arg NARROWFUN.  For the generated functions:
	Add local var `was-narrowed-p'.  Also, if NARROWFUN is specified,
	include frags that arrange to check for and save narrowing state before
	the move and then conditionally call NARROWFUN after the move.

2003-11-14  John Wiegley  <johnw@newartisans.com>

	* eshell/esh-var.el (eshell-parse-variable-ref): Add a backslash
	that was optional, but obviously missing based on surrounding code.

	* eshell/esh-cmd.el (eshell-lisp-command): Do not late-convert
	string arguments to numbers unless the whole argument was seen as
	a number.

2003-11-14  Kenichi Handa  <handa@m17n.org>

	* international/mule.el (ctext-non-standard-encodings-alist):
	Fix coding systems.

2003-11-10  Kenichi Handa  <handa@m17n.org>

	* language/kannada.el ("Kannada"): Add sample-text.

	* language/knd-util.el (kannada-compose-region)
	(kannada-compose-string, kannada-post-read-conversion):
	Add autoload cookie.

	* international/quail.el (quail-completion): Change the message
	"corresponding translations" to "corresponding characters".

2003-11-09  Markus Rost  <rost@mathematik.uni-bielefeld.de>

	* descr-text.el (describe-char): Fix typo.

2003-11-08  Kailash C. Chowksey  <klchxbec@m-net.arbornet.org>

	These changes are to support Kannada language/script.

	* Makefile.in (DONTCOMPILE): Add kannada.el.

	* makefile.w32-in (DONTCOMPILE): Add kannada.el.

	* loadup.el: Preload kannada.el.

	* language/ind-util.el (ucs-kannada-to-is13194-alist)
	(is13194-to-ucs-kannada-hashtbl, is13194-to-ucs-kannada-regexp):
	New variables.

	* language/kannada.el: New file.

	* language/knd-util.el: New file.

2003-11-07  Andreas Schwab  <schwab@suse.de>

	* progmodes/autoconf.el (autoconf-font-lock-keywords):
	Also highlight AH_*.

	* xml.el (xml-parse-dtd): Fix misplaced paren.

2003-11-07  Kenichi Handa  <handa@m17n.org>

	* language/european.el (windows-1252): Fix table (0x8F and 0x9E).

2003-11-05  Juri Linkov  <juri@jurta.org>

	* desktop.el (desktop-locals-to-save): Add buffer-file-coding-system.
	(desktop-buffer-file): Use saved buffer-file-coding-system
	for file reading.  Set auto-insert to nil to prevent automatic
	insertion into restored empty files.

2003-11-04  Luc Teirlinck  <teirllm@auburn.edu>

	* files.el (risky-local-variable-p): Make second argument optional.

2003-11-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	* subr.el (add-hook): Fix last change.

2003-11-03  Eli Zaretskii  <eliz@gnu.org>

	* mail/rmail.el (rmail-convert-to-babyl-format):
	If base64-decode-region signals an error, catch it and silently
	ignore it.

2003-11-01  Mark A. Hershberger  <mah@everybody.org>

	* xml.el (xml-parse-region): Allow comments to appear after the
	topmost element has closed.
	(xml-ns-parse-ns-attrs, xml-ns-expand-el)
	(xml-ns-expand-attr): New functions to do namespace handling.
	(xml-intern-attrlist): Back-compatible handling of attribute names.
	(xml-parse-tag): Move namespace handling to separate functions.
	Now produces elements in the form ((:ns . "element") (attr-list)
	children) instead of ('ns:element (attr-list) children).
	(xml-parse-attlist): Fix attribute parsing.
	(xml-parse-dtd): Change parsing so that it produces strings
	instead of interned symbols.

2003-11-01  era@iki.fi  <era@iki.fi>  (tiny change)

	* dired.el (dired-ls-sorting-switches): Doc fix.

2003-11-01  Oliver Scholz  <epameinondas@gmx.de>

	* emacs-lisp/rx.el (rx-or): Fix the case of
	"(rx (and ?a (or ?b ?c) ?d))".

2003-11-01  Christoph Wedler  <wedler@users.sourceforge.net>  (tiny change)

	* textmodes/texinfmt.el (texinfo-pre-format-hook): New variable.
	(texinfo-format-region): Use it.
	(texinfo-format-buffer-1): Ditto.

2003-11-01  Alan Mackenzie  <acm@muc.de>

	Changes to allow scrolling whilst in isearch mode:
	* isearch.el (isearch-unread-key-sequence): New function,
	extracted from isearch-other-meta-char.
	(top level): (put 'foo 'isearch-scroll) on all Emacs's
	"scrollable" standard functions.
	(isearch-allow-scroll): New customizable variable.
	(isearch-string-out-of-window, isearch-back-into-window)
	(isearch-reread-key-sequence-naturally)
	(isearch-lookup-scroll-key): New functions.
	(isearch-other-meta-char): Doc string and functionality enhanced.
	Now accepts a prefix argument.
	(isearch-lazy-highlight-window-end): New variable.
	(isearch-lazy-highlight-new-loop): Pay attention to the window's
	end (thru isearch-lazy-highlight-window-end), not only its start.

	* simple.el (overriding-map-is-bound, saved-overriding-map): New vars.
	(ensure-overriding-map-is-bound, restore-overriding-map): New funs.
	(universal-argument, universal-argument-more, negative-argument)
	(digit-argument, universal-argument-other-key): Minor changes.

2003-11-01  Alexander Pohoyda  <alexander.pohoyda@gmx.net>  (tiny change)

	* mail/rmailsum.el (rmail-summary-goto-msg): Don't call itself
	recursively if the last message is deleted, thus avoiding an
	infinite loop.

2003-10-30  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/tex-mode.el (tex-compile-commands): Add `yap' and `ps2pdf'.
	(tex-main-file): Don't add .tex if the extension is already present.
	(tex-uptodate-p): Don't recurse indefinitely with symlinks.

2003-10-29  Lute Kamstra  <lute@gnu.org>

	* progmodes/octave-inf.el (inferior-octave-prompt):
	Recognize version number in prompt.

2003-10-28  Dave Love  <fx@gnu.org>

	* international/characters.el: Fix some Unicode ranges.

2003-10-28  Kenichi Handa  <handa@m17n.org>

	* disp-table.el (standard-display-8bit)
	(standard-display-default, standard-display-ascii)
	(standard-display-g1, standard-display-graphic)
	(standard-display-underline): Assure that standard-display-table
	is a display table.

2003-10-27  Stefan Monnier  <monnier@iro.umontreal.ca>

	* simple.el (reindent-then-newline-and-indent): Delete space *after*
	reindenting the first line.

2003-10-25  Per Abrahamsen  <abraham@dina.kvl.dk>

	* wid-edit.el (widget-default-delete): Always delete child widgets.

2003-10-24  Stefan Monnier  <monnier@iro.umontreal.ca>

	* newcomment.el (comment-indent): Don't call indent-according-to-mode
	if the line has code.
	Don't try to line up with something that's too far left.

	* progmodes/octave-mod.el (octave-comment-start): Simplify.
	(octave-mode-syntax-table): Add % as a comment starter.
	(octave-point): Remove.
	(octave-in-comment-p, octave-in-string-p)
	(octave-not-in-string-or-comment-p, calculate-octave-indent)
	(octave-blink-matching-block-open, octave-auto-fill):
	Use line-(beginning|end)-position instead.

2003-10-23  Francesco Potort,Al(B  <pot@gnu.org>

	* emacs-lisp/authors.el (authors-aliases): Add correct realname
	for Francesco Potort,Al(B.

2003-10-23  Dave Love  <fx@gnu.org>

	* international/mule-cmds.el (locale-charset-to-coding-system):
	Don't rely on nil being a coding system.

	* mail/mail-extr.el (mail-extr-ignore-single-names): Add :version.
	(mail-extr-address-syntax-table): Remove non-ASCII unibyte chars.
	(mail-extr-voodoo): Use char classes in regexps (for non-ASCII).

2003-10-21  Nick Roberts  <nick@nick.uklinux.net>

	* gdb-ui.el (gdb-current-language): New variable.
	(gdb-update-flag): Remove variable.
	(gud-watch, gdb-frame-handler): Adapt for other languages (Fortran).
	(gdb-take-last-elt): Remove function.
	(gdb-dequeue-input): Avoid recursion by not using gdb-take-last-elt.
	(gdb-post-prompt): Check for variable object changes here.

	* progmodes/gud.el (gud-speedbar-buttons): Check for variable
	object changes in gdb-ui.el.

2003-10-21  Richard M. Stallman  <rms@gnu.org>

	* emacs-lisp/edebug.el (edebug-display-freq-count): Doc fix.

	* ls-lisp.el (ls-lisp-insert-directory): Arg is now wildcard-regexp.
	Don't check for foo*/ wildcard form here.
	(insert-directory): Recognize foo*/ as a wildcard.
	Separate wildcard-regexp variable from the arg, wildcard.

	* subr.el (add-hook): Correctly detect when make-local-hook was used.
	(remove-hook): Correctly handle strange cases about local hooks.

2003-10-21  David Ponce  <david@dponce.com>

	* ruler-mode.el (ruler-mode-left-fringe-cols): Add new optional
	argument REAL, to return a real number instead of a rounded
	integer value.  Define as inline function.
	(ruler-mode-right-fringe-cols): Likewise.
	(ruler-mode-scroll-bar-cols): New function.
	(ruler-mode-left-scroll-bar-cols): Use it.  Define as macro.
	(ruler-mode-right-scroll-bar-cols): Likewise.
	(ruler-mode-space): New function.
	(ruler-mode-ruler): Use it.  Handle variations of fringe style,
	scroll bar mode and margins in a more robust way.

2003-10-21  Christoph Wedler  <Christoph.Wedler@sap.com>

	* progmodes/antlr-mode.el: Make major mode work with cc-mode-5.30+.
	(antlr-c-init-language-vars): New function.
	(antlr-mode): Use it with cc-mode before v5.29.
	(antlr-c-common-init): Don't set some local vars here.
	(antlr-mode): Set them here.
	(antlr-c-forward-sws): New function alias.
	(antlr-mode): Redefine with cc-mode before v5.30.
	(antlr-skip-sexps): Use it.
	(antlr-skip-exception-part): Ditto.
	(antlr-skip-file-prelude): Ditto.
	(antlr-outside-rule-p): Ditto.
	(antlr-end-of-body): Ditto.
	(antlr-option-kind): Ditto.
	(antlr-insert-option-area): Ditto.
	(antlr-file-dependencies): Ditto.

2003-10-21  Roland Winkler  <Roland.Winkler@physik.uni-erlangen.de>

	* textmodes/bibtex.el (bibtex-move-outside-of-entry):
	Move backward only if point was not inside an entry.

2003-10-21  Richard M. Stallman  <rms@gnu.org>

	* progmodes/compile.el (compile-auto-highlight): Undo July 7 change.

2003-10-21  Juri Linkov  <juri@jurta.org>

	* compare-w.el: Automatically skip non-matching text to resync.
	(compare-windows-whitespace): Doc fix.
	(compare-windows-sync, compare-windows-sync-string-size)
	(compare-windows-recenter, compare-ignore-whitespace)
	(compare-windows-highlight, compare-windows-face): New variables.
	(compare-windows): Use compare-windows-sync.
	(compare-windows-highlight, compare-windows-dehighlight)
	(compare-windows-sync-regexp)
	(compare-windows-sync-default-function): New functions.

2003-10-21  Juri Linkov  <juri@jurta.org>

	* diff.el (diff-parse-differences): Don't visit the files now;
	instead, just record the error locus.

2003-10-21  Dave Love  <fx@gnu.org>

	* progmodes/cfengine.el: New file.

2003-10-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* complete.el (PC-do-completion): Do not forget to use `pred' as the
	default-directory when completing file names.

2003-10-20  Luc Teirlinck  <teirllm@auburn.edu>

	* help-mode.el (help-make-xrefs): Make sure that if a symbol is
	followed by the word `face', it gets treated as a face, even if
	it is also defined as a variable or a function.

2003-10-20  Dave Love  <fx@gnu.org>

	* emacs-lisp/easy-mmode.el (easy-mmode-define-navigation):
	Avoid incf in macro expansion.

2003-10-20  John Paul Wallington  <jpw@gnu.org>

	* emacs-lisp/elint.el (elint-check-defcustom-form): Don't use
	`evenp'	so we don't implicitly require cl library at runtime.

2003-10-18  Luc Teirlinck  <teirllm@auburn.edu>

	* help-mode.el (help-xref-symbol-regexp): Treat newlines as whitespace.
	(help-make-xrefs): Only make cross-references for faces if
	preceded or followed by the word `face'.  Do not make a
	cross-reference for variables without variable documentation,
	unless preceded by the word `variable' or `option'.  Update doc
	string accordingly.

2003-10-18  Thien-Thi Nguyen  <ttn@gnu.org>

	* progmodes/hideshow.el: Rewrite one-armed `if'
	constructs using either `when' or `unless'.
	(hs-grok-mode-type): Elide superfluous `progn'; nfc.

2003-10-16  Nick Roberts  <nick@nick.uklinux.net>

	* gdb-ui.el (breakpoint-xpm-data, breakpoint-enabled-pbm-data)
	(breakpoint-disabled-pbm-data): Make breakpoint icons 10x10
	instead of 12x12.

2003-10-16  Eli Zaretskii  <eliz@gnu.org>

	* mail/rmail.el (rmail-convert-to-babyl-format): Display a
	message while converting to Babyl.

2003-10-16  Vadim Nasardinov  <vadimn@redhat.com>  (tiny change)

	* allout.el (allout-mode): Doc fix.

2003-10-16  Lute Kamstra  <lute@gnu.org>

	* subr.el (force-mode-line-update): Fix docstring.

2003-10-14  Dave Love  <fx@gnu.org>

	* international/mule-cmds.el (find-multibyte-characters): Doc fix.
	(default-input-method): Add :link, improve :type.
	(locale-charset-language-names): Fix utf-8 pattern.
	(locale-charset-match-p, locale-charset-alist)
	(locale-charset-to-coding-system): New.
	(set-locale-environment): Deal with codeset part of locale specs.

2003-10-14  Lute Kamstra  <lute@gnu.org>

	* fringe.el (fringe-mode): Use active voice in docstring.
	(set-fringe-style): Ditto.

2003-10-13  Lute Kamstra  <lute@gnu.org>

	* fringe.el (fringe-mode): Fix docstring.
	(set-fringe-style): Ditto.

2003-10-12  Michael Kifer  <kifer@cs.stonybrook.edu>

	* ediff-mult.el (ediff-filegroup-action):
	Use ediff-default-filtering-regexp.

	* ediff-util.el (ediff-recenter): Don't call
	ediff-restore-highlighting twice.
	(ediff-select-difference): Set current difference.
	(ediff-unselect-and-select-difference): Add comment.

	* ediff.el (ediff-directories,ediff-directory-revisions)
	(ediff-directories3,ediff-merge-directories)
	(ediff-merge-directories-with-ancestor)
	(ediff-merge-directory-revisions)
	(ediff-merge-directory-revisions-with-ancestor):
	Use ediff-default-filtering-regexp.

2003-10-12  Andreas Schwab  <schwab@suse.de>

	* international/mule-cmds.el (locale-charset-language-names):
	Simplify regex by removing unused grouping.

2003-10-10  Dave Love  <fx@gnu.org>

	* bindings.el: Don't bind stop.

2003-10-08  Miles Bader  <miles@gnu.org>

	* gdb-ui.el (gdb-info-frames-custom): Use proper :inverse-video
	face instead of attempting to emulate it.

2003-10-07  Kenichi Handa  <handa@m17n.org>

	* international/mule-diag.el (list-coding-systems-1): List coding
	systems that are loaded automatically.

	* international/code-pages.el (iso-8859-11): Add autoload cookie.

	* international/mule.el (autoload-coding-system): New function.

2003-10-07  Andreas Schwab  <schwab@suse.de>

	* log-edit.el (log-edit-changelog-entries): Prefer local value of
	change-log-default-name in the buffer visiting the file.

2003-10-06  Dave Love  <fx@gnu.org>

	* files.el (find-file-hook): Customize.
	(auto-mode-alist): Add .stk, .ss, .sch, .orig.

	* bindings.el (completion-ignored-extensions): Remove .log.
	(global-map): Add again, open, stop keys.

2003-10-05  Richard M. Stallman  <rms@gnu.org>

	* progmodes/sh-script.el (sh-feature): Handle sh-modify like sh-append.
	(sh-for, sh-indexed-loop, sh-function, sh-while, sh-while-getopts):
	Use sh-modify directly.
	(sh-select): Use sh-append, not eval.

	* mail/emacsbug.el (report-emacs-bug): Fix previous change.

	* info.el (Info-following-node-name): New function.

	* loadhist.el (unload-feature-special-hooks):
	Rename from loadhist-hook-functions.
	(loadhist-hook-functions): Now an alias.

2003-10-04  Eli Zaretskii  <eliz@gnu.org>

	* ldefs-boot.el: Renamed from loaddefs-boot.el, to prevent
	file-name clashes on 8+3 filesystems.

	* Makefile.in (DONTCOMPILE, bootstrap-clean):
	Rename loaddefs-boot.el to ldefs-boot.el

	* makefile.w32-in (DONTCOMPILE, bootstrap-clean-CMD)
	(bootstrap-clean-SH): Rename loaddefs-boot.el to ldefs-boot.el

2003-10-03  Lute Kamstra  <lute@gnu.org>

	* info.el (Info-mode): Revert previous change.
	(Info-escape-percent): New function.
	(Info-fontify-node): Use it.

2003-10-02  Andreas Schwab  <schwab@suse.de>

	* loaddefs-boot.el: Regenerated.

2003-10-01  Rajesh Vaidheeswarran  <rv@gnu.org>

	* ffap.el: Remove defadvice related code from CVS since `complete'
	provides a `PC-completion-as-file-name-predicate' variable that
	ffap can override.

2003-10-02  Kenichi Handa  <handa@m17n.org>

	* international/utf-8.el (ccl-decode-mule-utf-8):
	Lookup utf-subst-table-for-decode even for U+E000..U+FFFF.

	* international/subst-jis.el: Include U+FF00..U+FFEF in decode table.
	* international/subst-big5.el: Likewise.
	* international/subst-gb2312.el: Likewise.
	* international/subst-ksc.el: Likewise.

2003-10-01  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* calendar/calendar.el (increment-calendar-month)
	(calendar-leap-year-p, calendar-absolute-from-gregorian)
	(generate-calendar, calendar-read-date, calendar-interval)
	(calendar-day-of-week): Handle years BC.
	(generate-calendar-month, calendar-gregorian-from-absolute): Doc fix.

2003-10-01  Dave Love  <fx@gnu.org>

	* language/cyrillic.el (cp1251): Alias for windows-1251.

	* vc-cvs.el (vc-cvs-parse-entry): Revert last change to allow
	bootstrap.

2003-10-01  Lute Kamstra  <lute@gnu.org>

	* files.el: Fix typo.
	* imenu.el (imenu--generic-function): Docstring fix.

2003-09-30  Richard M. Stallman  <rms@gnu.org>

	* dired.el (dired-mode): Handle dired-directory as a list.

2003-09-30  Nick Roberts  <nick@nick.uklinux.net>

	* toolbar/gud-watch.xpm, toolbar/gud-watch.pbm: Add.

	* toolbar/gud-display.xpm, toolbar/gud-display.pbm: Remove.

	* progmodes/gud.el (gud-menu-map, gud-tool-bar-map):
	Replace gud-display with gud-watch.
	(gud-speedbar-buttons): Add stuff for watching expressions
	in the speedbar when using M-x gdba.  Use dolist on old part
	of this function.

	* gdb-ui.el (gdb-var-list, gdb-var-changed, gdb-update-flag)
	(gdb-update-flag): New variables.
	(gdb-var-update, gdb-var-update-handler,gdb-var-delete)
	(gdb-speedbar-expand-node, gdb-var-evaluate-expression-handler)
	(gud-watch, gdb-var-create-handler) : New functions.
	(gdb-var-list-children, gdb-var-list-children-handler)
	(gdb-var-create-regexp, gdb-var-update-regexp)
	(gdb-var-list-children-regexp): New constants.
	(gud-gdba-command-name): Don't specify -noasync so that GDB/MI works.
	(gdb-annotation-rules): Reduce annotation set (level 3).
	(gdb-pre-prompt, gdb-prompt): Call handler in gdb-prompt.
	(gdb-post-prompt): Don't update GDB buffers every time speedbar
	updates.
	(gdb-window-height, gdb-window-width, gdb-display-in-progress)
	(gdb-expression-buffer-name, gdb-display-number, gdb-point)
	(gdb-dive-display-number, gdb-nesting-level, gdb-expression)
	(gdb-annotation-arg, gdb-dive-map, gdb-values, gdb-array-start)
	(gdb-array-stop, gdb-array-slice-map, gdb-display-string)
	(gdb-array-size, gdb-display-mode-map, gdb-expressions-mode-map):
	(gdb-expressions-mode-menu, gdb-dive): Remove variables.
	(gud-display, gud-display1)
	(gdb-display-begin,gdb-display-number-end, gdb-delete-line)
	(gdb-display-end, gdb-display-go-back, gdb-array-section-end)
	(gdb-field-begin, gdb-field-end, gdb-elt,gdb-field-format-begin)
	(gdb-field-format-end, gdb-dive, gdb-dive-new-frame)
	(gdb-insert-field, gdb-array-format, gdb-mouse-array-slice)
	(gdb-array-slice, gdb-array-format1, gdb-info-display-custom)
	(gdb-delete-frames, gdb-display-mode, gdb-display-buffer-name)
	(gdb-display-display-buffer, gdb-toggle-display)
	(gdb-delete-display, gdb-expressions-popup-menu)
	(gdb-expressions-mode, gdb-array-visualise): Remove functions.
	(gdb-setup-windows, gdb-reset, gdb-source-info): Remove references
	to display buffer.

2003-09-30  Richard M. Stallman  <rms@gnu.org>

	* progmodes/ada-mode.el (ada-mode): Don't use advice.
	Instead, set which-func-functions.

	* progmodes/which-func.el (which-func-modes): Add ada-mode.
	(which-func-functions): New variable.
	(which-function): Use that.

	* info.el (Info-mode): Double each `%' in header line.

	* emacs-lisp/lisp-mnt.el (lm-with-file):
	When FILE is nil, run BODY in current buffer.

	* mail/emacsbug.el (report-emacs-bug): Mention major and minor modes.

	* help.el (describe-mode): Start with a brief list of minor modes.
	Find them thru minor-mode-list so as to find them all.
	Show them in alphabetical order.

	* mail/sendmail.el (mail-aliases): Doc fix.

	* progmodes/sh-script.el (sh-mode-syntax-table): Add defvar.

2003-09-30  Alexander Pohoyda  <alexander.pohoyda@gmx.net>  (tiny change)

	* mail/rmailsum.el (rmail-make-summary-line-1):
	Change comma after last label to a space.
	(rmail-summary-font-lock-keywords): Adapt to that change.

2003-09-30  Thien-Thi Nguyen  <ttn@gnu.org>

	* progmodes/scheme.el (scheme-mode-variables): When setting
	`font-lock-defaults', also specify that "#" should
	be interpreted with `word' syntax.
	(scheme-font-lock-keywords-2): Also interpret "#:foo" as keyword.

2003-09-30  Lars Hansen  <larsh@math.ku.dk>

	* desktop.el: A lot of comments updated.
	(desktop-save-mode): Minor mode introduced.
	(desktop-enable, desktop-clear-preserve-buffers): Make vars obsolete.
	(desktop-load-default): Function made obsolete.
	(desktop-locals-to-save): Variable made customizable.
	(desktop-read): Optional parameter `dirname' added.
	(desktop-change-dir, desktop-revert): Parameter `dirname' in
	`desktop-read' used.
	(desktop-save-in-load-dir): Rename to `desktop-save-in-desktop-dir'.

2003-09-29  Rajesh Vaidheeswarran  <rv@gnu.org>

	* whitespace.el (whitespace-clean-msg): Add user customizable message
	for displaying ``clean'' output.
	(whitespace-buffer): Use `whitespace-clean-msg'.
	(whitespace-global-mode): Fix typo.

2003-09-29  Thien-Thi Nguyen  <ttn@gnu.org>

	* pcvs.el (cvs-mode-unmark-up): Move to goal column when done.

2003-09-29  Lute Kamstra  <lute@gnu.org>

	* bindings.el (mode-line-modes): Remove superfluous :propertize
	construct in initialization.
	(mode-line-position): Change cons cell into proper list in
	initialization.

2003-09-29  SAITO Takuya  <tabmore@rivo.mediatti.net>  (tiny change)

	* international/mule.el (decode-coding-inserted-region): Use car
	of the return value of find-operation-coding-system.

2003-09-29  Kenichi Handa  <handa@m17n.org>

	* descr-text.el (describe-char): Fix previous change.

2003-09-28  Kenichi Handa  <handa@m17n.org>

	* descr-text.el (describe-char-display): New function.
	(describe-char): Pay attention to display table on describing how
	a character is displayed.

	* international/mule-cmds.el (encoded-string-description):
	Prepend "0x" to each encoded byte.

2003-09-28  Andreas Schwab  <schwab@suse.de>

	* find-file.el (ff-special-constructs): Add autoload cookie.

2003-09-28  Kevin Ryde  <user42@zip.com.au>

	* info.el (Info-find-index-name): Remove any "<n>" suffixes which
	makeinfo appends to duplicate index entries.

2003-09-28  Eli Zaretskii  <eliz@gnu.org>

	* dired-x.el (dired-clean-tex): Doc fix.

	* language/chinese.el ("Chinese-GB", "Chinese-BIG5"): Set up for
	using a Chinese tutorial.

2003-09-28  Jesper Harder  <harder@ifa.au.dk>  (tiny change)

	* mail/smtpmail.el (smtpmail-via-smtp): Don't insert a space
	between "MAIL FROM:" and "RCPT TO:" and the following address.

2003-09-28  Jesper Harder  <harder@ifa.au.dk>  (tiny change)

	* textmodes/text-mode.el (paragraph-indent-minor-mode): Doc fix.

2003-09-28  David Ponce  <david@dponce.com>

	* recentf.el (recentf-initialize-file-name-history): New defcustom.
	(recentf-load-list): When `recentf-initialize-file-name-history'
	is non-nil, initialize an empty `file-name-history' with the
	recent list.

2003-09-28  Evgeni Dobrev  <evgeni_dobrev@developer.bg>  (tiny change)

	* man.el (Man-default-man-entry): Remove the leading `*' from the
	word at point.

2003-09-26  Lute Kamstra  <lute@gnu.org>

	* bindings.el (mode-line-position): Mention size indication in
	docstring.

2003-09-26  Andre Spiegel  <spiegel@gnu.org>

	* calendar/parse-time.el (parse-time-string): Add autoload cookie.

	* vc-cvs.el (vc-cvs-parse-entry): Don't require parse-time,
	because it's autoloaded now.

2003-09-25  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* progmodes/sh-script.el (sh-builtins): Add bash `shopt' builtin.
	(sh-font-lock-keywords, sh-feature): Fix previous change of
	sh-feature to avoid infloop with sh-font-lock-keywords.

2003-09-25  Kim F. Storm  <storm@cua.dk>

	* frame.el (frame-current-scroll-bars): New defun.

	* window.el (window-current-scroll-bars): New defun.

2003-09-24  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-engine.el (c-parse-state): Fix bug that could
	cause errors when the state cache contains info on parts that have
	been narrowed out.

2003-09-24  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-vars.el (c-comment-prefix-regexp): Document that
	`c-setup-paragraph-variables' has to be used when this variable is
	changed; it doesn't work to reinitialize the mode since that
	typically clobbers the variable.

	* progmodes/cc-styles.el (c-setup-paragraph-variables):
	Make it interactive.

2003-09-24  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-fonts.el (c-font-lock-declarations):
	Fix recognition of constructors and destructors for classes whose
	names are matched by `*-font-lock-extra-types'.

	* progmodes/cc-langs.el (c-type-list-kwds): If "operator" is
	followed by an identifier in C++ then it's a type.

2003-09-24  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-fonts.el (c-font-lock-invalid-string): Fix eob
	problem that primarily affected XEmacs.  Don't use faces to find
	unterminated strings since Emacs and XEmacs fontify strings
	differently - this function should now work better in XEmacs.

2003-09-24  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-cmds.el (c-electric-brace): Fix a bug in the
	`expand-abbrev' workaround which caused braces to misbehave inside
	macros.

	* progmodes/cc-engine.el (c-forward-keyword-clause): Fix error
	handling.  This bug could cause interactive font locking to bail out.

2003-09-24  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-engine.el (c-just-after-func-arglist-p):
	Handle paren-style types in Pike.  Also fixed some cases of
	insufficient handling of unbalanced parens.

2003-09-24  Rajesh Vaidheeswarran  <rv@gnu.org>

	* ffap.el (ffap-shell-prompt-regexp): Add regexp to identify
	common shell prompts that are not common filename or URL characters.
	(ffap-file-at-point): Use the new regexp to strip the prompts from
	the file names.  This is an issue mostly for user prompts that
	don't have a trailing space and find-file-at-point is invoked from
	within a shell inside Emacs.

2003-09-24  Andre Spiegel  <spiegel@gnu.org>

	* vc-cvs.el (vc-cvs-parse-entry): Restore the code to compare time
	stamps numerically, rather than textually.

2003-09-24  Kenichi Handa  <handa@m17n.org>

	* language/devan-util.el (devanagari-post-read-conversion):
	* language/mlm-util.el (malayalam-post-read-conversion):
	* language/tml-util.el (tamil-post-read-conversion):
	Add autoload cookie.

	* international/utf-8.el (utf-8-post-read-conversion):
	Call post-read-conversion functions for Devanagari, Malayalam,
	and Tamil.

2003-09-23  Dave Love  <fx@gnu.org>

	* Makefile.in (bootstrap-clean): Fix misplaced `!'.

2003-09-22  Nick Roberts  <nick@nick.uklinux.net>

	* progmodes/gud.el (perldb): Add gud-until to list of commands.
	Update gud-remove.

2003-09-22  Richard M. Stallman  <rms@gnu.org>

	* progmodes/sh-script.el (sh-mode-default-syntax-table):
	Rename from sh-mode-syntax-table.  Call sh-mode-syntax-table directly.
	(sh-mode-syntax-table-input): New variable.
	(sh-require-final-newline): Don't use eval.
	(sh-builtins, sh-leading-keywords, sh-other-keywords)
	(sh-variables, sh-font-lock-keywords): Don't use eval.
	(sh-set-shell): When setting require-final-newline,
	treat value = `require-final-newline' as don't change it.
	Set sh-mode-syntax-table locally based on
	sh-mode-syntax-table-input and sh-mode-default-syntax-table.

	* progmodes/compile.el (compile-internal):
	Call compilation-set-window-height before setting window start.

2003-09-22  Greg Hill  <ghill@synergymicro.com>  (tiny change)

	* emacs-lisp/bytecomp.el (byte-compile-log-file):
	Clear out byte-compile-last-warned-form.

2003-09-22  Richard M. Stallman  <rms@gnu.org>

	* woman.el (woman-file-name, woman-follow-word):
	If current-word returns nil, use "".

	* simple.el (eval-expression): Bind standard-output in to-buffer case.

2003-09-22  Richard M. Stallman  <rms@gnu.org>

	* emacs-lisp/lisp-mnt.el (lm-with-file):
	Don't visit the file, just use insert-file-contents in temp buffer.

2003-09-22  Jari Aalto  <jari.aalto@poboxes.com>

	* emacs-lisp/lisp-mnt.el (lm-get-header-re):
	Add surrounding \\( and \\) around the header, as in
	for lm-history-header 'Change Log\\|History'.

2003-09-22  John Paul Wallington  <jpw@gnu.org>

	* progmodes/ld-script.el: Add Commentary section,
	minor cleanup of file header.
	(ld-script-font-lock-keywords): Doc fix.
	(toplevel): Provide `ld-script' feature.

2003-09-21  Kim F. Storm  <storm@cua.dk>

	* scroll-bar.el (set-scroll-bar-mode): Initialize to
	new built-in variable default-frame-scroll-bars.
	(scroll-bar-mode): Use default-frame-scroll-bars when enabling
	scroll-bar-mode; notably, use it instead of t when we toggle
	scroll-bars on.
	(toggle-scroll-bar): Use default-frame-scroll-bars.

2003-09-19  Masatake YAMATO  <jet@gyve.org>

	* pcvs.el (cvs-do-removal): Change the prompt depending on
	`filter' value.

2003-09-19  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* startup.el (command-line-1): Stop startup-echo-area-message
	being hidden by "Loading image..." message.
	(use-fancy-splash-screens-p, display-splash-screen):
	Move display-graphic-p test from latter to former.

	* progmodes/sh-script.el (sh-font-lock-keywords):
	Highlight escaped EOLs differently from other backslash constructs.

2003-09-19  Richard M. Stallman  <rms@gnu.org>

	* emacs-lisp/edebug.el (edebug-var-status, edebug-restore-status):
	New functions.
	(edebug-enter, edebug-outside-excursion): Use them.

	* emacs-lisp/bytecomp.el (byte-compile-warning-prefix):
	Fix the condition for whether to print "In WHERE".

2003-09-19  Jari Aalto  <jari.aalto@poboxes.com>

	* finder.el (finder-mode-hook): New variable.
	(finder-mode): Run hook finder-mode-hook

2003-09-18  Masatake YAMATO  <jet@gyve.org>

	* progmodes/ebrowse.el: Fix broken magic autoload comments.

2003-09-17  Mario Lang  <mlang@delysid.org>

	* progmodes/gud.el (perldb): Change gud-print from just "%e" to
	"p %e" to actually print the value in the GUD buffer.

2003-09-16  Miles Bader  <miles@gnu.ai.mit.edu>

	From David Ponce <david.ponce@wanadoo.fr>:
	* makefile.w32-in (DONTCOMPILE): Add loaddefs-boot.el.
	(bootstrap-clean-CMD, bootstrap-clean-SH): Recreate loaddefs.el
	from loaddefs-boot.el if necessary.

2003-09-15  Zoltan Kemenczy  <kemenczy@rogers.com>

	* progmodes/gud.el (gud-find-class): Make jdb work again since
	cc-mode changed the syntactic information.

2003-09-15  David Ponce  <david@dponce.com>

	* recentf.el: (recentf-exclude): Accept predicates too.
	(recentf-file-readable-p): New function.
	(recentf-include-p): Handle predicates in recentf-exclude.
	(recentf-add-file): Doc fix.  Use recentf-file-readable-p.
	(recentf-cleanup): Likewise.
	(recentf-save-list): Use write-file to handle backup of
	recentf-save-file.

2003-09-15  Miles Bader  <miles@gnu.ai.mit.edu>

	* loaddefs-boot.el: Renamed from `loaddefs.el'
	* Makefile.in (DONTCOMPILE): Add loaddefs-boot.el.
	(bootstrap-clean): Recreate loaddefs.el from loaddefs-boot.el if
	necessary.

2003-09-13  Thien-Thi Nguyen  <ttn@gnu.org>

	* electric.el (Electric-pop-up-window): For the `one-window' case,
	no longer disconcertingly move point in the original buffer.

2003-09-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/tq.el (tq-create): Fix mixed up unquote style.

2003-09-12  Eric Hanchrow  <offby1@blarg.net>  (tiny change)

	* dired.el (dired-mode-map): Fix typo.

2003-09-11  Richard M. Stallman  <rms@gnu.org>

	* dired.el (dired-mode-map): Bind M-g to dired-goto-file.

2003-09-11  Paul Pogonyshev  <pogonyshev@gmx.net>  (tiny change)

	* window.el (kill-buffer-and-window): Remove `yes-or-no-p' so that
	the function is less noisy.  Now only `kill-buffer' can ask questions.

2003-09-10  Mario Lang  <mlang@delysid.org>

	* battery.el: Update Commentary and Copyright.
	(battery-linux-proc-acpi): Fix a bug in %b which made "!" never
	appear due to wrong ordering of the expressions in `or'.

2003-09-09  Lute Kamstra  <lute@gnu.org>

	* misc.el (upcase-char): Fix docstring.
	(zap-up-to-char): New command.

2003-09-08  David Ponce  <david@dponce.com>

	Ensure that recentf correctly updates the menu bar.
	* recentf.el (recentf-menu-path,recentf-menu-before): Doc fix.
	(recentf-menu-bar): New function.
	(recentf-clear-data): Use it
	(recentf-update-menu): Likewise.  Use easy-menu-add-item instead
	of easy-menu-change.

2003-09-08  Lute Kamstra  <lute@gnu.org>

	* simple.el (size-indication-mode): New.
	* bindings.el (mode-line-position): Add buffer size indicator.

2003-09-04  Mario Lang  <mlang@delysid.org>

	* battery.el (battery-linux-proc-acpi): New function.
	(battery-status-function): Modify default value calculation to also
	check for availability of ACPI.
	(battery-echo-area-format): Ditto.
	(battery-mode-line-format): Ditto.

2003-09-06  Dave Love  <fx@gnu.org>

	* ielm.el (ielm-mode-hook): Add :options.

	* emacs-lisp/eldoc.el (eldoc-print-current-symbol-info-function): New.
	(eldoc-print-current-symbol-info): Use it.

2003-09-04  Nick Roberts  <nick@nick.uklinux.net>

	* gdb-ui.el (gud-display1): Use gud-call to prevent extra prompt
	being displayed in GUD buffer.
	(gdb-idle-input-queue): Remove var.  Use just one queue.
	(gdb-enqueue-idle-input,gdb-dequeue-idle-input):
	Remove functions.  Use just one queue.
	(gdb-prompt, gdb-subprompt, def-gdb-auto-update-trigger)
	(gdb-invalidate-assembler, gdb-get-current-frame):
	Modify functions.  Use just one queue.

2003-09-04  Dave Love  <fx@gnu.org>

	* cus-start.el: Add blink-cursor-alist.

	* ruler-mode.el (ruler-mode-fill-column-char)
	(ruler-mode-current-column-char): Use char-displayable-p,
	not window-system.

	* international/codepage.el ("mule-diag"): Add eval-after-load clause.

	* language/european.el (windows-1252): Move from code-pages.

	* language/cyrillic.el ("Windows-1251"): Delete.
	("Bulgarian", "Belarusian"): Remove `features'.
	(windows-1251): Move from code-pages.

	* international/mule-diag.el (non-iso-charset-alist):
	Remove `codepage' stuff.
	(print-designation, list-coding-systems-1): Output fixes.

	* international/code-pages.el (cp-make-translation-table)
	(cp-valid-codes): Made defsubsts.
	(cp-fix-safe-chars): Delete.
	(mule-diag): Don't require.
	(windows-1251, windows-1252): Remove to cyrillic.el/european.el.
	(top-level): Check for defined coding system when defining
	cp... aliases.  Change w32-add-charset-info test to avoid warning.
	(non-iso-charset-alist): Defvar when compiling.
	(cp-make-coding-system): Doc fix.

2003-09-02  Jason Rumney  <jasonr@gnu.org>

	* international/titdic-cnv.el (tsang-quick-converter): Fix broken
	line-ends from CVS before doing conversion.

2003-09-02  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* calendar/diary-lib.el (diary-header-line-flag)
	(diary-header-line-format): New variables.
	(list-diary-entries): Use them to set header line in simple diary.

	* progmodes/sh-script.el (sh-font-lock-keywords): Use something
	other than font-lock-string-face to highlight backslashes.

2003-09-01  Jason Rumney  <jasonr@gnu.org>

	* international/titdic-cnv.el (tit-read-key-value): Include \r in
	regexp.

2003-09-01  Dave Love  <fx@gnu.org>

	* mouse.el (mouse-popup-menubar, mouse-skip-word): Doc fix.

	* menu-bar.el (menu-bar-showhide-menu): Amend date and time label
	and :help; also line and column numbers labels.

	* international/mule-util.el (char-displayable-p): Move from
	latin1-disp, rename and autoload.

	* international/latin1-disp.el (latin1-char-displayable-p):
	Now obsolete alias.  Replace uses with char-displayable-p.
	(latin1-display-ucs-per-lynx): Fix last change.

	* international/mule-cmds.el (standard-display-european-internal):
	Don't use char code for Latin-1 NBSP.
	<XFree86 4>: Unfrob NBSP display table.  Set display table to use
	U+2018, U+2019 for `'.
	(select-safe-coding-system): Message fix.

2003-09-01  Kenichi Handa  <handa@m17n.org>

	* international/fontset.el (setup-default-fontset): For Thai
	font, specify "*" family.

2003-09-01  Kevin Rodgers  <ihs_4664@yahoo.com>  (tiny change)

	* progmodes/compile.el (previous-error): Accept a prefix
	argument, similarly to next-error.

2003-08-31  Masatake YAMATO  <jet@gyve.org>

	* pcvs.el (cvs-do-removal): Use = instead of eq to check
	the number of files.  Bind the number of files to a local
	variable.  Suggested by Kevin Rodgers <ihs_4664@yahoo.com>.

2003-08-30  Eli Zaretskii  <eliz@gnu.org>

	* vc-hooks.el (vc-make-version-backup): Fix the change made on
	2003-07-26: msdos-long-file-names is a function, not a variable.

2003-08-29  Richard M. Stallman  <rms@gnu.org>

	* mail/sendmail.el (sendmail-sync-aliases, mail-setup):
	Do nothing with mail-personal-alias-file if it is nil.

	* mail/mailabbrev.el (mail-abbrevs-sync-aliases):
	Do nothing if mail-personal-alias-file is nil.

	* term.el (term-exec-1): Bind coding-system-for-read.

	* dired.el (dired-mouse-find-file-other-window):
	Use dired-view-command-alist here, as in dired-view-file.
	(dired-view-command-alist): Use %s to substitute file name.
	Handle .ps_pages, .eps, .jpg, .gif, .png.

2003-08-29  Paul Pogonyshev  <pogonyshev@gmx.net>  (tiny change)

	* info.el (Info-mode-map): Bind S-tab and <backtab> to
	`Info-prev-reference', instead of M-tab.

2003-08-29  Martin Stjernholm  <mast@lysator.liu.se>

	* simple.el (blink-matching-open): Work correctly on chars that
	are designated as parens through the syntax-table text property.

2003-08-29  Thierry Emery  <thierry.emery@club-internet.fr>  (tiny change)

	* kinsoku.el (kinsoku-longer, kinsoku-shorter): Do not choose a
	line break position in the middle of a non-kinsoku (e.g. latin)
	word, making it skip until either a space or a character with
	category "|".
	(kinsoku-longer): Test for end of buffer.

2003-08-28  Eli Zaretskii  <eliz@gnu.org>

	* mail/rmail.el (rmail-convert-to-babyl-format):
	Detect quoted-printable- and base64-encoded messages and decode them
	automatically.  Set the message's encoding from the charset=
	header, if any.  Decode base64-encoded messages in Mail format as well.

2003-08-26  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* mail/smtpmail.el: Fix previous change.
	(smtpmail-send-queued-mail): Set smtpmail-mail-address before
	calling smtpmail-via-smtp.
	(smtpmail-via-smtp): Add fall-back values for envelope-from.

2003-08-26  John Paul Wallington  <jpw@gnu.org>

	* image.el (image-jpeg-p): Don't search beyond length of data.

2003-08-26  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-cmds.el (c-electric-brace): Work around for a
	misfeature in `expand-abbrev' which caused electric keywords like
	"else" to disappear if an open brace was typed directly afterwards.

2003-08-26  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-vars.el (c-extra-types-widget): The doc string is
	mandatory in `define-widget'.

	* progmodes/cc-align.el, progmodes/cc-langs.el (c-lineup-math):
	Don't align the operators "!=", "<=" and ">=" as assignment operators.

	(c-assignment-operators): New language constant that only contains
	the assignment operators.

	(c-assignment-op-regexp): New language var used by `c-lineup-math'.

2003-08-26  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-engine.el (c-just-after-func-arglist-p):
	Safeguard against unbalanced sexps.

2003-08-26  Terje Rosten  <terjeros@phys.ntnu.no>

	* version.el (emacs-version): Check for gtk.  Include gtk version info.

2003-08-25  John Paul Wallington  <jpw@gnu.org>

	* man.el (Man-default-man-entry): Don't whizz past the section
	number before looking for it.

2003-08-24  Nick Roberts  <nick@nick.uklinux.net>

	* progmodes/gud.el (gud-display-line): Don't set window-point if
	source buffer is not visible.  (Only happens with M-x gdba.)

	* gdb-ui.el (gdba): Remove gdb-quit (previously removed) from
	documentation.
	(gdb-source, gdb-source-info): Update to assembler unnecessary
	as its done after each GDB command anyway.
	(gdb-pre-prompt): Use with-current-buffer.
	(gdb-insert-field): Add help-echo text.
	(gdb-invalidate-assembler): Re-display of assembler now done in
	gdb-info-breakpoints-custom.
	(gdb-info-breakpoints-custom): Force re-display of assembler to
	happen *after* update of breakpoints buffer.
	(gdb-display-source-buffer): Don't choke if gdb-source-window
	isn't visible.
	(gdb-put-string, gdb-put-arrow): Remove free variables.

2003-08-24  John Paul Wallington  <jpw@gnu.org>

	* ibuffer.el (ibuffer-formats): Make name and size columns wider.

	* man.el (Man-default-man-entry): Strip text properties when
	snarfing parts of entry because `format' preserves properties.

2003-08-24  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* files.el (file-newest-backup): Use `expand-file-name'.

	* calendar/diary-lib.el (simple-diary-display, make-diary-entry):
	Allow the diary to pop up a new frame, if needed.

	* mail/sendmail.el (mail-specify-envelope-from): Doc change.
	* mail/smtpmail.el (smtpmail-mail-address): Doc change.
	(smtpmail-send-it): Make treatment of envelope-from consistent with
	sendmail.el.

	* progmodes/sh-script.el (sh-builtins): Add some bash builtins.
	(sh-leading-keywords): Add the bash `time' reserved word.
	(sh-variables): Add some bash variables.
	(sh-add-completer): Fix nil branch of case statement.

2003-08-24  Masatake YAMATO  <jet@gyve.org>

	* progmodes/ld-script.el: New file.

2003-08-23  Markus Rost  <rost@math.ohio-state.edu>

	* vc-hooks.el (vc-ignore-vc-files, vc-master-templates): Doc fix.

2003-08-23  Andre Spiegel  <spiegel@gnu.org>

	* vc-hooks.el (vc-ignore-vc-files, vc-master-templates):
	Better explain obsolescence, and what to use instead.

2003-08-23  Masatake YAMATO  <jet@gyve.org>

	* pcvs.el (cvs-do-removal): Show the deleted file name
	on the prompt.

2003-08-20  Dave Love  <fx@gnu.org>

	* international/mule.el (make-coding-system)
	(set-buffer-file-coding-system): Doc fix.

	* emacs-lisp/lisp-mode.el (common-lisp-mode): New.

	* emacs-lisp/lisp.el (beginning-of-defun-function): Doc fix.

	* international/utf-8.el (ucs-unicode-to-mule-cjk): Use smaller :size.

	* international/utf-16.el: Add mime-text-unsuitable coding system
	properties.

	* international/latin1-disp.el (latin1-display): Add ?$,1s"(B.

	* cus-edit.el: Add some :links.
	(bib): Remove.

	* textmodes/bib-mode.el (bib): Add :group external.

2003-08-18  Luc Teirlinck  <teirllm@mail.auburn.edu>

	* wid-edit.el (widget-echo-help): Make it handle expressions that
	evaluate to strings.

2003-08-18  Michael Mauger  <mmaug@yahoo.com>

	Version 1.8.0 of sql-mode.  (Patch submitted 2003-06-21)

	Simplify selection of SQL products to define highlighting and
	interactive mode.  Includes detailed instructions on adding
	support for new products.

	* progmodes/sql.el (sql-product): New variable.  Identifies SQL
	product for use in highlighting and interactive mode.
	(sql-interactive-product): New variable.  SQL product for
	sql-interactive-mode.
	(sql-product-support): New variable.  Specifies product-specific
	parameters to drive highlighting and interactive mode.
	(sql-imenu-generic-expression): Add more object types.
	(sql-sqlite-options): Correct comment.
	(sql-ms-program): Use "osql" rather than "isql".
	(sql-prompt-regexp, sql-prompt-length): Update comment.
	(sql-mode-menu): Add "Start SQLi session" entry.
	Replace Highlighting submenu with Product menu.  Fix Send Region entry.
	(sql-mode-abbrev-table): Add abbreviations.  Support of
	SYSTEM-FLAG on define-abbrev.  Support was removed with last
	check-in; it now handles older Emacsen without the SYSTEM-FLAG.
	(sql-mode-font-lock-object-name): Add font-lock pattern for object
	names.
	(sql-mode-ansi-font-lock-keywords): Set as default value.
	(sql-mode-oracle-font-lock-keywords): Set as default value.
	Support Oracle 9i keywords.
	(sql-mode-postgres-font-lock-keywords): Set as default value.
	(sql-mode-linter-font-lock-keywords): Set as default value.
	(sql-mode-ms-font-lock-keywords): New variable.  Support Microsoft
	SQLServer 2000.
	(sql-mode-sybase-font-lock-keywords)
	(sql-mode-interbase-font-lock-keywords)
	(sql-mode-sqlite-font-lock-keywords)
	(sql-mode-strong-font-lock-keywords)
	(sql-mode-mysql-font-lock-keywords)
	(sql-mode-db2-font-lock-keywords): New variables.  Default to ANSI
	keywords.
	(sql-mode-font-lock-defaults): Update comment.
	(sql-product-feature): New function.  Returns feature associated
	with a product from `sql-product-support' alist.
	(sql-product-font-lock): New function.  Set font-lock support
	based on `sql-product'.
	(sql-add-product-keywords): New function.  Add font-lock rules to
	product-specific keyword variables.
	(sql-set-product): New function.  Set `sql-product' and apply
	appropriate font-lock highlighting.
	(sql-highlight-product): New function.  Set font-lock support
	based on a product.  Also set mode name to include product name.
	(sql-highlight-ansi-keywords, sql-highlight-oracle-keywords)
	(sql-highlight-postgres-keywords, sql-highlight-linter-keywords):
	Use `sql-set-product'.
	(sql-highlight-ms-keywords)
	(sql-highlight-sybase-keywords)
	(sql-highlight-interbase-keywords)
	(sql-highlight-strong-keywords)
	(sql-highlight-mysql-keywords)
	(sql-highlight-sqlite-keywords)
	(sql-highlight-db2-keywords): New functions.  Use `sql-set-product'.
	(sql-get-login): Prompt in the same order as the tokens.
	(sql-mode): Uses `sql-product-highlight' and `sql-product-font-lock'.
	(sql-product-interactive): New function.  Common portions of
	product-specific interactive mode wrappers.
	(sql-interactive-mode): Rewritten to use product features.
	(sql-oracle, sql-sybase, sql-informix, sql-sqlite, sql-mysql)
	(sql-solid, sql-ingres, sql-ms, sql-postgres, sql-interbase)
	(sql-db2, sql-linter): Use `sql-product-interactive'.
	(sql-connect-oracle, sql-connect-sybase, sql-connect-informix)
	(sql-connect-sqlite, sql-connect-mysql, sql-connect-solid)
	(sql-connect-ingres, sql-connect-postgres)
	(sql-connect-interbase, sql-connect-db2, sql-connect-linter):
	New functions.  Format command line parameters and invoke comint on
	the appropriate interpreter.  Code was in the corresponding
	`sql-xyz' function before.
	(sql-connect-ms): New function.  Support -E argument to use
	operating system credentials for authentication.

2003-08-18  Kenichi Handa  <handa@m17n.org>

	* international/mule.el (encode-char): Fix for the ASCII case.

2003-08-15  Kenichi Handa  <handa@m17n.org>

	* international/fontset.el (setup-default-fontset): Change "*" to
	nil in the specifications of font family.

2003-08-18  Kim F. Storm  <storm@cua.dk>

	* kmacro.el (kmacro-keymap): Group related bindings in
	initialization for clarity.  Bind C-s to start macro.
	Remove C-r binding.
	(kmacro-initial-counter-value): New defvar to hold initial counter
	value in case we set the value before defining a macro.
	(kmacro-insert-counter): Clear kmacro-initial-counter-value..
	(kmacro-set-counter): Set kmacro-initial-counter-value if we are
	not defining or executing macro.  Doc fix.
	(kmacro-add-counter): Clear kmacro-initial-counter-value.
	(kmacro-view-last-item, kmacro-view-item-no): New defvars used to
	temporarily view older elements on the macro ring without cycling
	the ring.
	(kmacro-display): Doc fix.
	(kmacro-exec-ring-item): New helper function.
	(kmacro-call-ring-2nd): Use it.
	(kmacro-call-ring-2nd-repeat): Doc fix.
	(kmacro-start-macro): Use (and clear) kmacro-initial-counter-value.
	(kmacro-end-or-call-macro): Execute last viewed macro (using
	kmacro-exec-ring-item) from ring if this follows
	kmacro-view-macro.  This allows us to find a macro on the ring
	with C-x C-k C-v C-v ... and execute it (with C-k) without cycling
	the ring to bring it to the head of the ring.
	(kmacro-bind-to-key): Doc fix (describe reserved bindings).
	Allow binding to reserved keys without specifying C-x C-k prefix.
	Ask for confirmation if entered key sequence is already bound to
	a non-macro command.
	(kmacro-view-macro): Repeating command will show older elements
	on the macro ring; C-k will execute the last viewed macro.
	(kmacro-view-macro-repeat): Doc fix.  Change its kmacro-repeat
	property from 'ring to 'head.

2003-08-17  Alan Shutko  <ats@acm.org>

	* calendar/calendar.el (calendar-make-alist): Correct off-by-one
	keeping December out of the alist.

2003-08-17  Edward M. Reingold  <reingold@emr.cs.iit.edu>

	* calendar/cal-move.el (calendar-goto-day-of-year): New function.
	* calendar/calendar.el (calendar-mode-map): Bind it to key.
	* calendar/cal-menu.el (calendar-mode-map): Add it to menu.
	(calendar-flatten): New function.
	(calendar-mouse-view-other-diary-entries)
	(calendar-mouse-view-diary-entries): Rewritten to put any holidays
	in the menu title and to show multi-line diary entries correctly
	in the menu.

2003-08-17  Luc Teirlinck  <teirllm@mail.auburn.edu>

	* info.el (Info-scroll-prefer-subnodes): Add :version keyword to
	defcustom, because the default was recently changed.

2003-08-16  Richard M. Stallman  <rms@gnu.org>

	* net/ange-ftp.el (ange-ftp-error): Add save-excursion.

	* emacs-lisp/lisp-mode.el (eval-last-sexp-print-value):
	New subroutine, broken out of eval-last-sexp-1.
	(eval-last-sexp-1): Use eval-last-sexp-print-value.

	* custom.el (custom-load-symbol): Load cus-load and cus-start first.

	* dabbrev.el (dabbrev--safe-replace-match): Use with-no-warnings.

	* simple.el (eval-expression): Use eval-last-sexp-print-value.

2003-08-14  Jari Aalto  <jari.aalto@poboxes.com>

	* progmodes/compile.el (compilation-error-regexp-alist):
	Add Java ANt error detection as described in document
	http://ant.apache.org/faq.html

2003-08-12  Juri Linkov  <juri@jurta.org>  (tiny change)

	* simple.el (backward-word, forward-to-indentation)
	(backward-to-indentation): Argument changed to optional.
	(next-line, previous-line): Use `or' instead of `unless'.

2003-08-12  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* progmodes/ebnf-iso.el (ebnf-no-meta-identifier): Becomes a var
	instead of a constant.

2003-08-12  Markus Rost  <rost@math.ohio-state.edu>

	* shell.el (shell): With prefix-arg, suggest a new buffer name.

2003-08-12  Andre Spiegel  <spiegel@gnu.org>

	* vc-sccs.el (vc-sccs-state-heuristic): Fix parentheses.
	(vc-sccs-workfile-version): Search the entire delta table, rather
	than just the first entry, because that might be a deleted version.

2003-08-11  Karl Fogel  <kfogel@red-bean.com>

	* menu-bar.el (menu-bar-options-menu): Supply a body for the
	[save-place] binding in the Options menu.  Have it require
	'saveplace' and then toggle the variable manually, to avoid an
	unbound variable error.  Thanks to <Sebastien.Kirche@sage.com>
	for the bug report.

2003-08-11  Nick Roberts  <nick@nick.uklinux.net>

	* gdb-ui.el (gdb-insert-field, gdb-array-format1)
	(gdb-info-breakpoints-custom, gdb-info-frames-custom)
	(gdb-info-threads-custom): Add help-echo text.
	(gdb-display-back): Don't use purecopy.
	(gdb-info-breakpoints-custom, gdb-reset)
	(gdb-assembler-custom): Use display-images-p to test if breakpoint
	icons can be displayed.

2003-08-11  Markus Rost  <rost@math.ohio-state.edu>

	* textmodes/reftex-vars.el (reftex-auto-recenter-toc): Fix typo.

2003-08-11  Stefan Monnier  <monnier@cs.yale.edu>

	* bookmark.el (bookmark-completing-read):
	Return a string, instead of a list of one string.
	Use a popup menu if activated from the mouse.
	(bookmark-edit-annotation): Remove unused vars.
	(bookmark-jump, bookmark-relocate, bookmark-insert-location)
	(bookmark-rename, bookmark-insert, bookmark-delete): Adjust calls
	to bookmark-completing-read.
	(bookmark-bmenu-show-filenames, bookmark-bmenu-hide-filenames)
	(bookmark-bmenu-mark, bookmark-bmenu-select, bookmark-bmenu-unmark)
	(bookmark-bmenu-delete, bookmark-bmenu-list): Use inhibit-read-only
	and erase-buffer.
	(bookmark-menu-delete, bookmark-menu-rename, bookmark-menu-locate)
	(bookmark-menu-jump, bookmark-menu-insert)
	(bookmark-popup-menu-and-apply-function)
	(bookmark-menu-popup-paned-bookmark-menu): Remove.
	(bookmark-menu-build-paned-menu): Remove by folding it into
	bookmark-menu-popup-paned-menu.
	(menu-bar-bookmark-map): Move the define-key statements here.
	Use the "non-menu" commands since they now pop up a menu if needed.
	(bookmark-exit-hook-internal): Simplify.

2003-08-11  Carsten Dominik  <dominik@sand.science.uva.nl>

	* reftex-toc.el (reftex-toc-rename-label): New function.
	(reftex-toc-check-docstruct): New function.

	* reftex.el (reftex-region-active-p): New function.

	* reftex-parse.el (reftex-locate-bibliography-files): Improved the
	regexp to find the \bibliography macro.

	* reftex-vars.el (reftex-section-levels): Removed subsubparagraph,
	which does not exist in LaTeX.
	(reftex-cite-format-builtin): Added amsrefs support.
	(reftex-toc-confirm-promotion): New option

	* reftex-toc.el
	(reftex-toc): Use `reftex-toc-split-windows-fraction'.
	(reftex-toc-demote, reftex-toc-promote)
	(reftex-toc-do-promote, reftex-toc-promote-prepare)
	(reftex-toc-promote-action, reftex-toc-extract-section-number)
	(reftex-toc-newhead-from-alist)
	(reftex-toc-load-all-files-for-promotion): New functions.
	(reftex-toc-help): Added description of new keys.
	(reftex-toc-split-windows-fraction): New option.
	(reftex-recenter-toc-when-idle): Search *toc* window on all
	visible frames.
	(reftex-toc): Additional parameter REUSE
	(reftex-toc-recenter): Remember current frame.  Call `reftex-toc'
	with REUSE argument.
	(reftex-recenter-toc-when-idle): Reset `current-prefix-arg' for
	the call of `reftex-toc'.
	(reftex-make-separate-toc-frame): New function .
	(reftex-toc-recenter): When called with triple prefix arg, call
	`reftex-make-separate-toc-frame' first.
	(reftex-toc-toggle-dedicated-frame): New command.
	(reftex-toc-quit): Adapted to delete frame when called in
	dedicated frame.

	* reftex-index.el (reftex-index-phrase-match-is-indexed): Check
	all enclosing macros.


2003-08-08  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* progmodes/ebnf2ps.el (ebnf-total, ebnf-nprod): Move defvar before
	first use.

2003-08-07  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* progmodes/ebnf2ps.el (ebnf-begin-job): Code fix.

2003-08-06  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* calendar/calendar.el (list-diary-entries-hook)
	(diary-display-hook, nongregorian-diary-listing-hook)
	(mark-diary-entries-hook, nongregorian-diary-marking-hook):
	Add some customize options for these hooks.
	(calendar-abbrev-construct): Don't try to take a substring longer
	than the original string.

2003-08-05  Richard M. Stallman  <rms@gnu.org>

	* emacs-lisp/testcover.el (noreturn): Report error if does return.
	(testcover-reinstrument-clauses): Doc fix.

	* emacs-lisp/warnings.el: Doc fixes, args renamed.
	(warning-type-format): Rename from warning-group-format.

	* emacs-lisp/bytecomp.el (byte-compile-not-obsolete-var): New var.
	(byte-compile-variable-ref): Handle byte-compile-not-obsolete-var.
	(byte-compile-defvar): Bind byte-compile-not-obsolete-var
	to prevent warnings about defvar for an obsolete variable.

	* emacs-lisp/bytecomp.el (byte-compile-log-warning):
	warning-group-format renamed to warning-type-format.

	* subr.el (read-passwd): Use clear-string instead of fillarray.

	* edmacro.el (edmacro-format-keys): Use edmacro-sanitize-for-string.
	Use vconcat instead of concat.
	(edmacro-sanitize-for-string): New function.

2003-08-05  Dave Love  <fx@gnu.org>

	* cus-start.el: Add open-paren-in-column-0-is-defun-start,
	line-number-display-limit-width.

	* textmodes/tex-mode.el (tex-dvi-view-command): Fix quoted quotes.

2003-08-05  Kenichi Handa  <handa@m17n.org>

	* international/code-pages.el: Don't require mule-diag.

	* international/mule-diag.el (non-iso-charset-alist):
	Add autoload cookie.

	* language/devan-util.el (dev-glyph-order): Add an entry for the
	glyph code #xC4.

2003-08-03  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* calendar/calendar.el (diary-file, diary-file-name-prefix)
	(european-calendar-style, diary-date-forms)
	(calendar-day-name-array, calendar-month-name-array): Doc change.
	(generate-calendar-month): Adapt for new behavior of
	`calendar-day-name' function.
	(calendar-abbrev-length, calendar-day-abbrev-array)
	(calendar-month-abbrev-array): New variables.
	(calendar-abbrev-construct): New function.
	(calendar-day-name, calendar-month-name): Use new abbrev arrays,
	rather than fixing abbrevs at some width.  Calling syntax change.
	(calendar-make-alist): Use abbrev arrays.  Calling syntax change.
	(calendar-date-string): Adapt for new behaviors of
	`calendar-day-name' and `calendar-month-name' functions.

	* calendar/diary-lib.el (list-diary-entries): Adapt for new
	behavior of `calendar-day-name' and `calendar-month-name' functions.
	(diary-name-pattern): Use abbrev arrays, rather than fixing
	abbrevs at three chars.  Calling syntax change.
	(mark-diary-entries): Adapt for new behaviors of
	`diary-name-pattern' and `calendar-make-alist' functions.
	(fancy-diary-font-lock-keywords): Adapt for new behavior of
	`diary-name-pattern' function.
	(font-lock-diary-date-forms): Use abbrev arrays, rather than
	fixing abbrevs at three chars.  Calling syntax change.
	(cal-hebrew, cal-islam): Require when compiling.
	(diary-font-lock-keywords): Adapt for new behavior of
	`font-lock-diary-date-forms' function.

	* calendar/cal-hebrew.el: Reposition some code so defined before used.
	(calendar-hebrew-month-name-array-common-year)
	(calendar-hebrew-month-name-array-leap-year): Add doc strings.
	(list-hebrew-diary-entries): Adapt for new behaviors of
	`calendar-day-name' and `add-to-diary-list' functions.
	(mark-hebrew-diary-entries): Adapt for new behaviors of
	`diary-name-pattern' and `calendar-make-alist' functions.

	* calendar/cal-islam.el (calendar-islamic-month-name-array):
	Add doc string.
	(list-islamic-diary-entries): Adapt for new behaviors of
	`calendar-day-name' and `add-to-diary-list' functions.
	(mark-islamic-diary-entries): Adapt for new behaviors of
	`diary-name-pattern' and `calendar-make-alist' functions.

	* calendar/cal-menu.el (cal-menu-update): Adapt for new behavior of
	`calendar-month-name' function.

	* calendar/cal-coptic.el (coptic-name): defvar rather than defconst.

	* calendar/solar.el (solar-seasons-data): Move definition before use.

	* calendar/cal-tex.el (cal-tex-day-name-format): Doc fix.
	(cal-tex-LaTeX-hourbox): Move definition before use.

	* calendar/cal-china.el, cal-hebrew.el, cal-islam.el
	* cal-julian.el, cal-menu.el, cal-move.el, holidays.el
	* lunar.el, solar.el (displayed-month, displayed-year):
	Define for compiler.

2003-08-03  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-mode.el (c-init-language-vars-for): Add argument
	MODE.  Renamed from c-init-c-language-vars'.
	(c-initialize-cc-mode): Change accordingly.
	(c-common-init): Ditto.
	(c-mode): Ditto.
	(c++-mode): Use `c-init-language-vars-for'.
	(objc-mode): Ditto.
	(java-mode): Ditto.
	(idl-mode): Ditto.
	(pike-mode): Ditto.
	(awk-mode): Ditto.

2003-08-03  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-engine.el (c-end-of-current-token): Return whether
	or not the point moved.

	(c-search-decl-header-end): Don't trip up on operator identifiers
	in C++ and operators like == in all languages.

	* progmodes/cc-engine.el (c-backward-to-decl-anchor):
	Detect leading labels correctly.

2003-08-02  Andreas Schwab  <schwab@suse.de>

	* textmodes/ispell.el: Don't redo key bindings on loading, put
	them only in loaddefs.el.
	* bookmark.el: Likewise.
	* dabbrev.el: Likewise.
	* emerge.el: Likewise.

	* apropos.el (apropos-words-to-regexp): Only add `wild' if `words'
	has more than one member.

	* progmodes/sh-script.el (sh-mode): Don't set mode-class property.

2003-08-01  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* lpr.el (printify-region): It was ending conversion before the
	expected position.  Reported by Keiichi Suzuki <keiichi@nanap.org>.

2003-07-31  John Paul Wallington  <jpw@gnu.org>

	* net/browse-url.el (browse-url-epiphany): Doc fix.

2003-07-30  Kenichi Handa  <handa@m17n.org>

	* international/fontset.el (setup-default-fontset):
	Change registry names of Akurti fonts.

2003-07-29  Jesper Harder  <harder@ifa.au.dk>  (tiny change)

	* comint.el (comint-read-noecho): Use `clear-string' instead of
	`fillarray'.

2003-07-29  Thomas W Murphy  <twm@andrew.cmu.edu>  (tiny change)

	* outline.el (outline-mode-hook): Add defvar.

2003-07-28  Nick Roberts  <nick@nick.uklinux.net>

	* gdb-ui.el (gdb-setup-windows, gdb-restore-windows):
	Restore assembler in source window if that is what has been selected.
	(menu): Add gdb-restore-windows to menu.  Make gdba
	specific menus only visible from gdba.

2003-07-28  Tak Ota  <Takaaki.Ota@am.sony.com>  (tiny change)

	* progmodes/compile.el (compilation-environment): New user variable.
	(compile-internal): Respect it.

2003-07-23  Masatake YAMATO  <jet@gyve.org>

	* progmodes/gud.el (gdb-script-font-lock-keywords):
	Put `font-lock-function-name-face' on a symbol which includes
	`-' like `hook-run'.  Put font-lock-variable-name-face
	on a symbol starting with $.

2003-07-27  Markus Rost  <rost@math.ohio-state.edu>

	* files.el (set-visited-file-name): Use truename for buffer-file-name.

2003-07-26  Markus Rost  <rost@math.ohio-state.edu>

	* vc-hooks.el (vc-file-not-found-hook): Doc fix.

2003-07-26  Andre Spiegel  <spiegel@gnu.org>

	* vc-hooks.el (vc-default-registered, vc-make-version-backup):
	Use with-no-warnings.
	(vc-file-not-found-hook): Add this to find-file-not-found-functions,
	rather than to find-file-not-found-hook, which doesn't exist.

2003-07-26  Markus Rost  <rost@math.ohio-state.edu>

	* international/quail.el (quail-translate-key): Fix previous change.

2003-07-25  John Paul Wallington  <jpw@gnu.org>

	* server.el (server-start): Check `server-process' is non-nil
	before killing it to avoid killing current buffer's process.

	* simple.el (choose-completion-string): Use `minibufferp';
	test `completion-reference-buffer' if `buffer' arg is nil.
	(push-mark): Use `when' and `unless'.
	(pop-mark): Use `when'.

	* mouse-sel.el (mouse-sel-get-selection-function):
	Check `x-last-selected-text-primary'.  Don't barf if it or
	`x-last-selected-text' aren't bound.

2003-07-25  Kevin Rodgers  <ihs_4664@yahoo.com>  (tiny change)

	* menu-bar.el (menu-bar-tools-menu): Minor change in strings.

2003-07-23  Stefan Monnier  <monnier@cs.yale.edu>

	* vc-svn.el (vc-svn-diff-switches): Don't default to vc-diff-switches.

2003-07-23  John Paul Wallington  <jpw@gnu.org>

	* tooltip.el (defface tooltip): Inherit from variable-pitch.

2003-07-23  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* emacs-lisp/derived.el (define-derived-mode): Mention hook in doc
	string.  Defvar the derived hook.

	* macros.el (insert-kbd-macro): Escape double quote character.
	From Thomas W Murphy <twm@andrew.cmu.edu>.

2003-07-22  Stefan Monnier  <monnier@cs.yale.edu>

	* textmodes/fill.el (fill-comment-paragraph): Construct a regexp
	to match the specific mark rather than reusing comment-start-skip.

2003-07-22  Thien-Thi Nguyen  <ttn@gnu.org>

	* progmodes/hideshow.el (hs-special-modes-alist):
	Clarify MDATA-SELECTOR doc; nfc.  Thanks to Michael Ernst.

2003-07-21  Markus Rost  <rost@math.ohio-state.edu>

	* progmodes/idlwave.el (idlwave-comment-indent-char): Fix default
	value using ?\s.

2003-07-21  John Paul Wallington  <jpw@gnu.org>

	* subr.el (with-selected-window): Add closing paren.

2003-07-21  Richard M. Stallman  <rms@gnu.org>

	* emacs-lisp/lisp-mode.el (emacs-lisp-mode): Use run-mode-hooks.
	(lisp-mode): Likewise.

	* subr.el (with-selected-window): Copy code form save-selected-window
	so as to call select-window with norecord arg.
	(dynamic-completion-table): Doc fix.
	(lazy-completion-table): Doc fix.

	* international/mule-cmds.el (set-locale-environment):
	langinfo renamed to locale-info.

	* international/mule.el (auto-coding-functions): Doc fix.

2003-07-21  Kenichi Handa  <handa@m17n.org>

	* international/quail.el (quail-translate-key):
	Update quail-current-str correctly.

2003-07-21  Andreas Schwab  <schwab@suse.de>

	* progmodes/sh-script.el (sh-mode-syntax-table): Change syntax of
	?, to "_".

2003-07-20  Kai Gro,A_(Bjohann  <kai.grossjohann@gmx.net>
	Version 2.0.36 of Tramp released.

	* net/tramp.el (tramp-default-password-end-of-line): Rename from
	tramp-password-end-of-line.
	(tramp-password-end-of-line): New method parameter.
	(tramp-get-password-end-of-line): Function to access method
	parameter `tramp-password-end-of-line', or variable
	`tramp-default-password-end-of-line' (default value).
	(tramp-methods): Add entries for new parameter
	tramp-password-end-of-line.
	(tramp-enter-password): Use new function
	`tramp-get-password-end-of-line'.
	(tramp-handle-insert-file-contents): Do not
	unconditionally inhibit the file operation file-local-copy, only
	do that when the inhibit-file-name-operation is currently
	insert-file-contents.  This fixes finding remote CVS-controlled
	files.  (It would barf on inserting the CVS/Entries file
	literally, because the file-local-copy handler wasn't called.)
	(tramp-handle-shell-command): Support optional third arg ERROR-BUFFER.
	(tramp-sh-extra-args): Adapt defcustom type to XEmacs.
	(tramp-initial-commands): New variable.
	(tramp-process-initial-commands): New function, using the variable.
	(tramp-open-connection-setup-interactive-shell): Call the new function.
	(tramp-buffer-name, tramp-debug-buffer-name): Always put the
	method into the buffer name, never use nil.  Reported by Hanak
	David <dhanak@inf.bme.hu>.
	(tramp-open-connection-setup-interactive-shell): Erase buffer
	before sending "stty -onlcr".

	* net/tramp-vc.el (vc-workfile-unchanged-p): Add comment.

2003-07-19  Markus Rost  <rost@math.ohio-state.edu>

	* textmodes/artist.el (artist-erase-char): Fix default value using ?\s.

2003-07-19  John Paul Wallington  <jpw@gnu.org>

	* textmodes/artist.el (artist-butlast-fn, artist-draw-sline)
	(artist-draw-rect, artist-draw-square): Doc fixes.

	* textmodes/enriched.el (enriched-decode-display-prop): Doc fix.

	* textmodes/two-column.el (2C-mode-line-format): Doc fix.

2003-07-19  Kenichi Handa  <handa@m17n.org>

	* international/kkc.el (kkc-show-conversion-list-update):
	Highlight the correct candidate in the message.

2003-07-18  John Paul Wallington  <jpw@gnu.org>

	* simple.el (current-word): Don't include punctuation char when
	`really-word' arg is non-nil.

2003-07-17  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/awk-mode.el: Obsoleted by the AWK support in CC Mode -
	moved to the directory obsolete.

2003-07-16  Stefan Monnier  <monnier@cs.yale.edu>

	* info.el (Info-menu-entry-name-re): Allow newlines in
	menu entry names.

	* emacs-lisp/syntax.el (syntax-ppss-flush-cache): Rename from
	syntax-ppss-after-change-function.
	(syntax-ppss-after-change-function): New alias.  Update uses.
	(syntax-ppss): Catch the case where the buffer is narrowed.

2003-07-16  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-defs.el (c-langelem-sym, c-langelem-pos)
	(c-langelem-2nd-pos): Add accessor functions for syntactic elements.

2003-07-16  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-engine.el (c-literal-faces): Declare as a variable
	since it might be modified.

	* progmodes/cc-langs.el (c++-make-template-syntax-table)
	(c-syntactic-ws-start, c-syntactic-ws-end): Give more consistent
	names to these language constants.

2003-07-15  Kim F. Storm  <storm@cua.dk>

	* apropos.el (apropos-sort-by-scores): Rename from apropos-show-scores.
	All uses changed.

2003-07-14  Mark A. Hershberger  <mah@everybody.org>

	* xml.el (xml-parse-tag, xml-parse-file, xml-parse-region):
	Namespace support.

2003-07-13  Juanma Barranquero  <lektu@terra.es>

	* frame.el (modify-all-frames-parameters): Reinstall (copyright
	papers received).

2003-07-13  Karl Eichwalder  <ke@suse.de>

	* textmodes/po.el (po-find-charset): White space at the start of the
	Content-Type field body is non-mandatory.

2003-07-13  Masayuki Ataka  <ataka@milk.freemail.ne.jp>  (tiny change)

	* textmodes/texinfo.el (texinfo-section-list):
	Append appendixsection; a synonym for appendixsec.

2003-07-13  Jari Aalto  <jari.aalto@poboxes.com>

	* man.el (Man-translate-cleanup): New.
	(Man-translate-references): Call `Man-translate-cleanup' to clean
	leading, trailing and middle spaces.

2003-07-13  Lars Hansen  <larsh@math.ku.dk>

	* desktop.el (desktop-buffer-dired-misc-data, desktop-buffer-dired):
	Handle `dired-directory' being a list.

2003-07-13  Jesper Harder  <harder@ifa.au.dk>  (tiny change)

	* mail/smtpmail.el (smtpmail-send-it): Create smtpmail-queue-dir if
	it doesn't exist.

2003-07-12  Richard M. Stallman  <rms@gnu.org>

	* progmodes/cc-engine.el (c-declare-lang-variables): Don't use mapcan.

	* progmodes/cc-defs.el (c-make-keywords-re):
	Don't use delete-duplicates.
	(c-lang-const): Don't use mapcan.

	* apropos.el (apropos-show-scores): Make it customizable.
	Document new meaning.
	(apropos): Compute scores from symbols.
	(apropos-print): Don't sort by scores if apropos-show-scores is nil.

2003-07-11  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-bdf.el: Fix copyright line.
	(bdf-directory-list): Fix initialization code.

2003-07-11  John Paul Wallington  <jpw@gnu.org>

	* emacs-lisp/ring.el (ring-empty-p): Use `zerop'.
	(ring-p, ring-plus1, ring-minus1, ring-length, ring-index)
	(ring-empty-p, ring-size, ring-copy, ring-ref): Doc fixes.

2003-07-11  NAKAJIMA Mikio  <minakaji@namazu.org>  (tiny change)

	* emacs-lisp/ring.el (ring-elements): Doc fix.

2003-07-11  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* calendar/timeclock.el (timeclock-relative)
	(timeclock-ask-before-exiting, timeclock-use-display-time):
	Doc changes.
	(timeclock-modeline-display): Give a message if
	`timeclock-use-display-time' is non-nil but `display-time-mode'
	is not active.

2003-07-11  Kenichi Handa  <handa@m17n.org>

	* international/mule-cmds.el (set-language-environment):
	Set current-language-environment to the correct string.

2003-07-10  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-print.el: Print line number correctly in a region.  Reported by
	Tim Allen <timallen@ls83.fsnet.co.uk>.
	(ps-print-version): New version number (6.6.2).
	(ps-printing-region): Code fix.

2003-07-10  John Paul Wallington  <jpw@gnu.org>

	* progmodes/etags.el (visit-tags-table-buffer): Add autoload cookie;
	this function can be called from `add-completions-from-tags-table'.

2003-07-10  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* calendar/timeclock.el (timeclock-use-display-time)
	(timeclock-day-over-hook, timeclock-workday-remaining)
	(timeclock-status-string, timeclock-when-to-leave)
	(timeclock-when-to-leave-string, timeclock-log-data)
	(timeclock-find-discrep, timeclock-day-base)
	(timeclock-generate-report, timeclock-visit-timelog): Doc fix.
	(timeclock-modeline-display): Set the variable
	`timeclock-modeline-display'.
	(timeclock-update-modeline): Doc fix.  Respect value of
	`timeclock-relative'.

2003-07-09  Richard M. Stallman  <rms@gnu.org>

	* textmodes/reftex-parse.el (reftex-all-document-files):
	Add autoload cookie.

	* textmodes/reftex.el (reftex-all-document-files): Delete autoload.
	(reftex-scanning-info-available-p): Add autoload cookie.

	* international/mule-cmds.el
	(set-display-table-and-terminal-coding-system): Delete duplicate
	aset on standard-display-table.

	* view.el (view-file): If existing buffer's major mode is special,
	don't go into view mode.

	* dired.el (dired-move-to-filename-regexp): Allow quote in months.

2003-07-08  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-engine.el (c-guess-basic-syntax): Do not do hidden
	buffer changes; there's third party code that calls this function
	directly.

2003-07-08  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-fonts.el (javadoc-font-lock-keywords)
	(autodoc-font-lock-keywords): Don't byte compile on font lock
	initialization when running from byte compiled files.

2003-07-08  Alan Mackenzie  <bug-cc-mode@gnu.org>

	* progmodes/cc-engine.el: Fix AWK mode indentation when previous
	statement ends with auto-increment "++".

2003-07-08  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-langs.el, progmodes/cc-styles.el (c-style-alist)
	(c-lang-variable-inits, c-lang-variable-inits-tail): The values of
	these are changed, so declare them as variables and not constants.

2003-07-08  Markus Rost  <rost@math.ohio-state.edu>

	* subr.el (dolist, dotimes): Doc fix.

2003-07-08  Kim F. Storm  <storm@cua.dk>

	* international/mule-cmds.el
	(set-display-table-and-terminal-coding-system): Don't break
	bootstrap if standard-display-table isn't setup yet.

2003-07-07  Richard M. Stallman  <rms@gnu.org>

	* ehelp.el (ehelp-command): Use defalias to define ehelp-command.
	Give it a doc string, and autoload it.

	* desktop.el (desktop-buffer-info, desktop-buffer-mh):
	Use with-no-warnings.

	* info.el (Info-search): If find invisible text, search again.

	* isearch.el (search-whitespace-regexp): Add a shy group around it.

	* man.el (Man-name-regexp): Match + as part of name.

	* simple.el (visible-mode): Rename from vis-mode.
	(vis-mode-saved-buffer-invisibility-spec): Doc fix.

	* simple.el (current-word): New arg REALLY-WORD specifies
	don't include punctuation chars.

	* emacs-lisp/debug.el (debug, debugger-env-macro):
	Use with-no-warnings while accessing and binding unread-command-char.

	* international/mule-cmds.el
	(set-display-table-and-terminal-coding-system): Use explicit loop
	instead of calling standard-display-default.

	* net/ange-ftp.el (ange-ftp-file-symlink-p):
	Use condition-case to catch error in ange-ftp-get-files.

	* net/browse-url.el (browse-url-browser-function):
	Add alternative for Epiphany.
	(browse-url-epiphany-program, browse-url-epiphany-arguments)
	(browse-url-epiphany-startup-arguments)
	(browse-url-epiphany-new-window-is-tab): New variables.
	(browse-url-epiphany, browse-url-epiphany-sentinel): New functions.

	* progmodes/compile.el (compile-auto-highlight): Default now t.
	(compile): Doc fix.
	(compilation-next-error): Fix previous change.

	* textmodes/tex-mode.el (tex-main-file): Use with-no-warnings.

	* textmodes/sgml-mode.el (xml-mode): Add autoload cookie.

2003-07-07  Nick Roberts  <nick@nick.uklinux.net>

	* gdb-ui.el (gdb-source-info): Display current frame when
	attaching to an existing process.
	(gdb-setup-windows, gdb-source-info): Start with gud-comint-buffer
	while laying out windows when attaching to an existing process.

2003-07-07  Stefan Monnier  <monnier@cs.yale.edu>

	* info.el (Info-menu): Use Info-menu-entry-name-re.

2003-07-06  Stefan Monnier  <monnier@cs.yale.edu>

	* vc-hooks.el (vc-stay-local, vc-stay-local-p): Move from vc.el.
	* vc.el (vc-stay-local, vc-stay-local-p): Move to vc-hooks.el.

	* info.el (Info-menu-entry-name-re): Be careful to avoid multiple ways
	to match the same text.

2003-07-06  John Paul Wallington  <jpw@gnu.org>

	* vc.el (vc-annotate-offset): Move defvar up.

2003-07-06  Kim F. Storm  <storm@cua.dk>

	* info.el (Info-menu-entry-name-re): Add `:' to second [] part.
	This should fix the infinite loop when extracting menu names.

2003-07-05  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* files.el (auto-mode-alist, interpreter-mode-alist):
	Remove entries to CC Mode modes to avoid duplicates; they are now added
	with autoload directives in cc-mode.el.

2003-07-05  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-langs.el, progmodes/cc-styles.el (c-style-alist)
	(c-lang-variable-inits, c-lang-variable-inits-tail): The values of
	these are changed, so declare them as variables and not constants.

	* progmodes/cc-mode.el: Fix some autoload problems: Try to
	ensure that the entry for ".c" extension comes before the one for
	".C" on `auto-mode-alist', to behave better on case insensitive OS:es.
	Fix incorrect entries that were added to `interpreter-mode-alist'.
	Move the autoload directives for AWK to the top level since they
	aren't recognized anywhere else.  Do not use the new AWK mode doc
	in the autoload form for the old AWK mode.

2003-06-30  Roland Winkler  <Roland.Winkler@physik.uni-erlangen.de>

	* textmodes/bibtex.el (bibtex-sort-entry-class): New entry catch-all.
	(bibtex-sort-ignore-string-entries): Default value t.
	(bibtex-entry-kill-ring-max): Reintroduce as it was removed
	erroneously in previous version.
	(bibtex-string-files): Docstring reflects new parsing scheme.
	(bibtex-autokey-transcriptions): Merge some rewrite entries, fix
	docstring, add # as one of the chars to crush
	(bibtex-autokey-prefix-string, bibtex-autokey-names)
	(bibtex-autokey-names-stretch, bibtex-autokey-additional-names)
	(bibtex-autokey-name-change-strings)
	(bibtex-autokey-name-case-convert, bibtex-autokey-name-length)
	(bibtex-autokey-name-separator, bibtex-autokey-year-length)
	(bibtex-autokey-use-crossref, bibtex-autokey-titlewords)
	(bibtex-autokey-title-terminators)
	(bibtex-autokey-titlewords-stretch)
	(bibtex-autokey-titleword-ignore)
	(bibtex-autokey-titleword-case-convert)
	(bibtex-autokey-titleword-abbrevs)
	(bibtex-autokey-titleword-abbrevs)
	(bibtex-autokey-titleword-change-strings)
	(bibtex-autokey-titleword-length)
	(bibtex-autokey-titleword-separator)
	(bibtex-autokey-name-year-separator)
	(bibtex-autokey-year-title-separator)
	(bibtex-autokey-before-presentation-function)
	(bibtex-entry-type-history, bibtex-entry-maybe-empty-head):
	Fix docstring.
	(bibtex-strings, bibtex-reference-keys):
	Use lazy-completion-table and make-variable-buffer-local.
	(bibtex-sort-entry-class-alist): Use downcase, account for catch-all.
	(bibtex-braced-string-syntax-table)
	(bibtex-quoted-string-syntax-table): New variables.
	(bibtex-parse-nested-braces): Remove.
	(bibtex-parse-field-string): Use syntax table and forward-sexp.
	(bibtex-parse-association): Simplify.
	(bibtex-parse-field-name): Obey bibtex-autoadd-commas.
	(bibtex-parse-field-text): Simplify.
	(bibtex-search-forward-field, bibtex-search-backward-field):
	argument BOUND can take value t.
	(bibtex-start-of-field, bibtex-start-of-name-in-field)
	(bibtex-end-of-name-in-field, bibtex-end-of-field)
	(bibtex-start-of-text-in-field, bibtex-end-of-text-in-field)
	(bibtex-start-of-text-in-string, bibtex-end-of-text-in-string)
	(bibtex-end-of-string, bibtex-type-in-head): Use defsubst.
	(bibtex-skip-to-valid-entry): Return buffer position of beginning
	and ending of entry.  Update for changes of bibtex-search-entry.
	Simplify.
	(bibtex-map-entries): FUN is called with three arguments.
	(bibtex-search-entry): Return a cons pair with buffer positions of
	beginning and end of entry.
	(bibtex-enclosing-field): Simplify.
	(bibtex-format-entry): Use booktitle to set a missing title.
	(bibtex-autokey-get-names): Fiddle with regexps.
	(bibtex-generate-autokey): Use identity.
	(bibtex-parse-keys): Use simplified parsing algorithm if
	bibtex-parse-keys-fast is non-nil.  Simplify.  Change order of
	arguments.  Return alist of keys.
	(bibtex-parse-strings): Simplify.  Return alist of strings.
	(bibtex-complete-string-cleanup): Fix docstring.
	(bibtex-read-key): New function.
	(bibtex-mode): Fix docstring.  Do not parse for keys and
	strings when the mode is entered.  Set fill-paragraph-function to
	bibtex-fill-field.  Setup font-lock-mark-block-function the way
	font-lock intended.
	(bibtex-entry): Use bibtex-read-key.  Obey bibtex-autofill-types.
	(bibtex-parse-entry, bibtex-autofill-entry): New functions.
	(bibtex-print-help-message, bibtex-remove-OPT-or-ALT)
	(bibtex-Preamble): Avoid hard coded constants.
	(bibtex-make-field): Fix docstring.  Simplify.
	(bibtex-beginning-of-entry): Always return new position of point.
	(bibtex-end-of-entry): Rearrange cond clauses.
	(bibtex-count-entries, bibtex-validate, bibtex-reformat):
	Update for changes of bibtex-map-entries.
	(bibtex-ispell-abstract): Do not move point.
	(bibtex-entry-index): Use downcase.  Simplify.
	(bibtex-lessp): Handle catch-all.
	(bibtex-find-crossref): Turn into a command.
	(bibtex-find-entry): Simplify.  Use bibtex-read-key.  Fix regexp.
	(bibtex-clean-entry): Use bibtex-read-key.  Handle string and
	preamble entries.
	(bibtex-fill-field-bounds): New function.
	(bibtex-fill-field): New command.  Bound to fill-paragraph-function.
	(bibtex-fill-entry): Use bibtex-fill-field-bounds
	(bibtex-String): Use bibtex-strings.  Always obey
	bibtex-sort-ignore-string-entries.

2003-07-05  John Paul Wallington  <jpw@gnu.org>

	* cus-theme.el (customize-create-theme):
	Call `customize-create-theme' in Reset widget's notify function.

	* ibuffer.el (ibuffer-backward-line, ibuffer-forward-line)
	(ibuffer-mark-interactive): Use `or' instead of `unless'.
	(define-ibuffer-column name): Add summarizer.
	(define-ibuffer-column size): Likewise.
	(define-ibuffer-column filename): Likewise.
	(define-ibuffer-column process): Likewise.  Change BODY's output too.
	(define-ibuffer-column filename-and-process): Likewise, likewise.
	(ibuffer): Remove local vars `already-in' and `need-update'.

	* ibuf-ext.el: Don't require `derived' at compile-time.

2003-07-05  Kim F. Storm  <storm@cua.dk>

	* info.el: Disable paragraph refilling.
	(Info-refill-paragraphs): New defcustom.
	(Info-fontify-node): Use it.

2003-07-04  Stefan Monnier  <monnier@cs.yale.edu>

	* emacs-lisp/cl-macs.el (cl-transform-lambda): Strip &cl-defs
	thingies from constructors created by defstruct.

	* emacs-lisp/bytecomp.el (byte-compile-defvar): Check and set
	the default value of the variable.
	(byte-code-meter): Move declaration to top level.

	* pcvs-parse.el (cvs-parse-status): Ignore extra fields from CVSNT.

	* info.el (Info-following-node-name-re): New fun.
	(Info-following-node-name): Remove.
	(Info-insert-dir): Use the new fun.
	(Info-extract-pointer): Don't save restriction; use new fun.
	(Info-menu-entry-name-re): New const.
	(Info-menu-entry-name-re): Use it along with new fun.
	(Info-node-spec-re): Use new fun.
	(Info-complete-menu-item, Info-fontify-node): Use new const.
	(Info-goto-node, Info-follow-reference, Info-menu-update):
	Use match-string.
	(Info-follow-reference): Use assoc-string.
	Use a list of strings for the completion table.
	(Info-fontify-node): Use match-string, line-end-position.
	Limit the search for `node:' to the first line.

	* newcomment.el (uncomment-region): Remove padding coming from
	comment-start rather than just from comment-padding.

	* vc-cvs.el (vc-cvs-repository-hostname): New operation.
	(vc-cvs-stay-local-p): Use vc-stay-local-p.
	(vc-cvs-rename-file): Remove (use the default).
	(vc-cvs-register): Register parent dir if needed.
	(vc-cvs-could-register): Return non-nil if parent can be registered.
	(vc-cvs-state, vc-cvs-dir-state, vc-cvs-print-log, vc-cvs-diff)
	(vc-cvs-diff-tree, vc-cvs-make-version-backups-p): Use vc-stay-local-p.

	* vc-svn.el (vc-svn-use-edit): Make it into a const.
	(vc-svn-update): Fix the arguments to `svn'.
	(vc-svn-diff-tree): Just use `vc-svn-diff'.
	(vc-svn-create-snapshot, vc-svn-retrieve-snapshot):
	Simple implementations, assuming `name' is a URL.

	* progmodes/sh-script.el (sh-font-lock-paren): Add [ and ] to the
	set of chars allowed unquoted in a case pattern.

	* font-core.el (font-lock-defaults-alist): Remove obsolete entries.

	* font-lock.el (font-lock-extra-types-widget)
	(c-font-lock-extra-types, c++-font-lock-extra-types)
	(objc-font-lock-extra-types, java-font-lock-extra-types)
	(c-font-lock-keywords-1, c-font-lock-keywords-2, c-font-lock-keywords)
	(c-font-lock-keywords-3, c-font-lock-syntactic-face-function)
	(font-lock-match-c++-style-declaration-item-and-skip-to-next)
	(font-lock-match-c++-structor-declaration)
	(c++-font-lock-keywords-1, c++-font-lock-keywords-2)
	(c++-font-lock-keywords-3, c++-font-lock-keywords)
	(objc-font-lock-keywords-1, objc-font-lock-keywords-2)
	(objc-font-lock-keywords-3, objc-font-lock-keywords)
	(java-font-lock-keywords-1, java-font-lock-keywords-2)
	(java-font-lock-keywords-3, java-font-lock-keywords)
	(java-font-lock-syntactic-face-function): Remove obsolete code
	and constants.  It's all in cc-fonts.el now.

2003-07-04  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* mail/sendmail.el (mail-specify-envelope-from)
	(mail-envelope-from): Doc fix.

2003-07-04  Martin Stjernholm  <mast@lysator.liu.se>

	* generic-x.el: Do away with the dependency on `c-emacs-features'
	when populating `rul-generic-mode-syntax-table'; we already know
	this isn't XEmacs.

See ChangeLog.10 for earlier changes.

;; Local Variables:
;; coding: iso-2022-7bit
;; End:

    Copyright (C) 2001, 02, 04  Free Software Foundation, Inc.
  Copying and distribution of this file, with or without modification,
  are permitted provided the copyright notice and this notice are preserved.

;;; arch-tag: e39939be-dab3-400e-86f5-0e2701a883c1
